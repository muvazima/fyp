@&#MAIN-TITLE@&#A discriminative and sparse topic model for image classification and annotation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The label information is enforced in the generation of visual and annotation terms.


                        
                        
                           
                           The zero-mean Laplace distribution is added to a topic generative process.


                        
                        
                           
                           The sparse image representation is helpful to learn a training model.


                        
                        
                           
                           A series of experiments on four data sets demonstrate the performance of DSTM.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Graphical model

Discriminative topic

Sparsity

Image classification

Image annotation

@&#ABSTRACT@&#


               
               
                  Image classification is to assign a category of an image and image annotation is to describe individual components of an image by using some annotation terms. These two learning tasks are strongly related. The main contribution of this paper is to propose a new discriminative and sparse topic model (DSTM) for image classification and annotation by combining visual, annotation and label information from a set of training images. The essential features of DSTM different from existing approaches are that (i) the label information is enforced in the generation of both visual words and annotation terms such that each generative latent topic corresponds to a category; (ii) the zero-mean Laplace distribution is employed to give a sparse representation of images in visual words and annotation terms such that relevant words and terms are associated with latent topics. Experimental results demonstrate that the proposed method provides the discrimination ability in classification and annotation, and its performance is better than the other testing methods (sLDA-ann, abc-corr-LDA, SupDocNADE, SAGE and MedSTC) for LabelMe, UIUC, NUS-WIDE and PascalVOC07 images.
               
            

@&#INTRODUCTION@&#

Image classification and annotation are important problems in computer vision. Image classification is to assign a category of an image, and the purpose is to describe an image globally. Traditional supervised learning methods are widely used for image classification, including support vector machine [9,33], random forest [7,26], and probabilistic graphic model [6,14,23,34,29]. Image annotation is to describe individual components of an image by using some annotation terms. Matrix factorization [36], multi-label learning [39,34] and generative techniques [2,4,15,16,28] have been developed.

Image classification and image annotation are strongly related. For examples, an image labeled as a coast scene is likely to be annotated with “boat” and “beach”, but is unlikely to be annotated with “door” and “window”. An image annotated with “door” and “window” is likely to be labeled as a street scene, but is unlikely to be labeled as a coast scene. Label information can be used to enhance the performance of image annotation, and annotation information can be employed to increase classification accuracy. Therefore, it would be an interesting and challenging research problem how to combine both label and annotation information to design efficient and effective methods for image classification and annotation simultaneously.

Recently, graph model [8,11], neural network model [38], supervised non-negative matrix factorization model [21], regression model [19], and generative graphical model [32,24] are adopted here. Among them, the graph model and the neural network model have higher complexities for the process of building graph or network. The ideas of other models are to identify latent topical bases and represent images in the topical space for later image classification and annotation. However, the learned topics are not discriminative enough to identify the image category because they are related to all visual and annotation terms. An ideal situation is that each topic has its own relevant visual words and annotation terms as shown in Fig. 1
                     .

In this paper, we propose a discriminative and sparse topic model (DSTM) to generate latent topics such that relevant visual words and annotation terms can be identified and irrelevant words and terms can be ignored. The essential features of DSTM include:
                        
                           (i)
                           The label information is enforced in the generation of visual words and annotation terms, which guarantees that each latent topic consists of visual words or annotation terms which closely corresponding to a category, i.e., the learned topics are more discriminative.

The zero-mean Laplace distribution is added to a topic generative process, which makes each topic contain a few visual words and annotation terms, and then an image can be represented sparsely by the latent topics.

The sparse image representation in the identified topic space is helpful to learn a training model and then to improve classification and annotation performance. A series of experiments on LabelMe, UIUC, NUS-WIDE and PascalVOC07 images are conducted to demonstrate the performance of DSTM is better than the other testing methods (sLDA-ann, abc-corr-LDA, SupDocNADE, SAGE and MedSTC).

The rest of this paper is organized as follows. In Section 2, we describe related work. In Section 3, we introduce DSTM model and its parameter estimation algorithm. In Section 4, experimental results are presented to show the DSTM is effective. Finally, some concluding remarks are given in Section 5.

@&#RELATED WORK@&#

Probabilistic graphical model has become popular in the data mining community due to its solid theoretical foundation and promising performance. Latent Dirichlet allocation (LDA) [5] is a hierarchical Bayesian model that projects a data point into a latent low dimensional space spanned by a set of automatically learned topical bases. Each topic is a multinomial distribution over the original features. A wide variety of its extensions has been proposed in different contexts for different modeling purposes [35,18,29,34]. In the area of image processing, the final understanding performance benefits from the graphical model based on its ability to integrate multi-resource. For instance, Li and Fei-Fei [23] proposed an integrative model to classify the types of the events and object components of images.

Traditional methods handle image classification and annotation as two dependent tasks. Wang et al. [34] proposed the max-margin latent Dirichlet allocation model (MMLDA) for image classification and annotation. However, they also conduct these two tasks separately. Wang et al. [32] firstly proposed a joint probabilistic graphical model (sLDA-ann) to simultaneously classify and annotate images. sLDA-ann assumes that image annotation and classification share the same latent topic space as shown in Fig. 2(a), where each topic is a distribution over a vocabulary containing all image visual words or annotation terms. As shown in Fig. 3(a), a topic learned by sLDA-ann from LabelMe training data [30] contains terms “sand beach”, “sea water”, “door”, “window”, and “skyscraper” with high probabilities. In this case, it is hard to identify whether this topic is related to “coast”, “tall building” or “street” category, i.e., the learned topics have no ability to distinguish the category. Li et al. [24] presented an annotation-by-class corr-LDA (abc-corr-LDA) model by enforcing the label information in the annotation term generative process, as shown in Fig. 2(b). This model narrows the scope of annotation terms for the training images, and then improves the annotation performance. However, abc-corr-LDA ignores the explicit relation between categories and visual words. This will result in that each topic is represented by many visual words distributed over all the dictionary for a testing image as shown in Fig. 4(a) and (b) (this image comes from the LabelMe testing dataset [30]). From these figures, we can find that the topics are not sparse and it is hard to identify the proper category for the testing image.

Zheng et al. [38] proposed the supervised document neural autoregressive distribution estimator (SupDocNADE) model to simultaneously deal with the image classification and annotation tasks. It obtains the hidden topic features by using the neural network on the mixed representation with all visual and annotation words, and learns the connection between hidden layer and the class label. SupDocNADE uses both visual and annotation words to learn the topics, but it does not consider the sparsity of topic and make use of the label information during topic learning process.

In data mining and statistical community, sparse learning becomes a significant research direction to learn parsimonious models. For identifying latent topic, sparsity is a good choice to shrink the vocabulary range of each topic. The existing sparsity-favoring models include L
                     1 norm, Normal-Gamma, Laplace, spike-and-slab distributions, Student's t 
                     [27,31,25]. Among them, only the Laplace distribution is log-concave, which leads to a posterior whose log density is a concave function, then it has a single local maximum [31]. Thus, the Laplace distribution is often used in Bayesian models where sparsity is desired such as the sparse additive generative model (SAGE) [12]. Recently, Zhu and Xing [40] presented the maximum margin supervised sparse topical coding model (MedSTC) which adopted L
                     1 norm strategy to learn sparse topics via a constrained optimization process, later Zhang et al. [37] extended it to the online version. These two models only consider single task (image classification), i.e., the learned topics are related to only one resource (image visual information), which cannot be used to simultaneously classify and annotate images.

In this work, we propose a new discriminative topic model which employs the category information to learn the latent topics. Then each class-specific topic has good representation ability to the training images from the associated category but poor representation ability for other classes. Meanwhile, the zero-mean Laplace distribution is imposed on the topic-visual word and topic-annotation term distribution, so that the learned topics are sparse, i.e., only the relevant visual words/annotation terms are related to each topic while the irrelevant or redundant visual words/annotation terms are ignored. More details will be given in the next sections.

Let 
                           I
                           =
                           
                              
                                 I
                                 1
                              
                              
                                 I
                                 2
                              
                              …
                              
                                 I
                                 D
                              
                           
                         be the training set of D labeled images, where each image I
                        
                           d
                         can be represented via the bag-of-words model [14] for both visual and annotation information. Let N be the total number of visual words, M be the total number of annotation terms, and C be the number of classes in 
                           I
                        . Let x
                        
                           d
                           ,
                           n
                         (d
                        ∈{1,…,
                        D},
                        n
                        ∈{1,…,
                        N}) be the frequency of the n-th visual word v
                        
                           d
                           ,
                           n
                        , and s
                        
                           d
                           ,
                           m
                         (m
                        ∈{1,…,
                        M}) be the frequency of the m-th annotation term w
                        
                           d
                           ,
                           m
                         in I
                        
                           d
                        . Also we let c
                        
                           d
                         be a category or class of I
                        
                           d
                        . Our goal is to classify and annotate the testing images by a generative model learned from the training set.

The DSTM model depicts a generative process of visual words and annotation terms based on a latent space consisting of K topics for each category. The motivation behind this model is to represent and relate all the observed and hidden variables in a mathematical framework. The DSTM is illustrated in Fig. 2(c).

In the generative model, the topic assignment z
                        
                           d
                           ,
                           n
                         is generated by a multinomial distribution (i.e., z
                        
                           d
                           ,
                           n
                        
                        ~Multinomial(
                           θ
                        
                        
                           d
                        ), where 
                           θ
                        
                        
                           d
                         is a topic mixing proportion vector and 
                           θ
                        
                        
                           d
                         ~ Dirichlet (
                           α
                        ) (
                           α
                         is a Dirichlet prior). Here 
                           θ
                        
                        
                           d
                        
                        ={θ
                        
                           d
                           ,
                           k
                        }, 
                           α
                        
                        ={α
                        
                           k
                        } (k
                        ∈{1,…,
                        K}). The identifier y
                        
                           d
                           ,
                           m
                         is generated by an empirical measure (i.e., p(y
                        
                           d
                           ,
                           m
                        
                        =
                        n) =
                           x
                        
                           d
                           ,
                           n
                        / ∑
                           n
                           =1
                        
                           N
                        
                        ‍x
                        
                           d
                           ,
                           n
                        ).

DSTM assumes that each visual word and annotation term are drawn from both latent topic and category. Thus, parameters 
                           η
                        
                        
                           k
                        
                        ={η
                        
                           k
                           ,
                           n
                        }, 
                           ω
                        
                        
                           k
                        
                        ={ω
                        
                           k
                           ,
                           m
                        }, 
                           η
                        
                        
                           c
                        
                        ={η
                        
                           c
                           ,
                           n
                        } and 
                           ω
                        
                        
                           c
                        
                        ={ω
                        
                           c
                           ,
                           m
                        } (c
                        ∈{1,…,
                        C}) are introduced in the generative process. Among them, η
                        
                           k
                           ,
                           n
                         and η
                        
                           c
                           ,
                           n
                         refer to the logarithm frequency derivations of the n-th visual word on the corresponding k-th latent topic and the c-th category respectively. ω
                        
                           k
                           ,
                           m
                         and ω
                        
                           c
                           ,
                           m
                         refer to the logarithm frequency derivations of the m-th annotation term on the corresponding k-th latent topic and the c-th category respectively.

In order to construct relevant visual words and annotation terms for each topic, the sparsity constraint is enforced on 
                           η
                        
                        
                           k
                        , 
                           ω
                        
                        
                           k
                        , 
                           η
                        
                        
                           c
                         and 
                           ω
                        
                        
                           c
                        . Laplace prior concentrates more coefficients close to zero, and it is log-concave which leads to the unimodal posterior [31,1]. Then, zero-mean Laplace distribution [20] is adopted in the learning process. The zero-mean Laplace distribution is equivalent to a two-level hierarchical Bayes model [17,12] containing a zero-mean Gaussian distribution and a parameter-free Jeffrey's prior: 
                           η
                        
                        
                           k
                        
                        ~Normal(0,diag(
                           τ
                        
                        
                           k
                        )) with p(
                           τ
                        
                        
                           k
                        )∝1/
                           τ
                        
                        
                           k
                         (
                           τ
                        
                        
                           k
                        
                        ={τ
                        
                           k
                           ,
                           n
                        }); 
                           ω
                        
                        
                           k
                        
                        ~Normal(0,diag(
                           π
                        
                        
                           k
                        )) and p(
                           π
                        
                        
                           k
                        )∝1/
                           π
                        
                        
                           k
                         (
                           π
                        
                        
                           k
                        
                        ={π
                        
                           k
                           ,
                           m
                        }); and 
                           η
                        
                        
                           c
                         and 
                           ω
                        
                        
                           c
                         are defined similarly. Here diag(⋅) denotes a diagonal matrix with its main diagonal.

Since each visual word in DSTM is determined by its latent topic k and the corresponding image label c, the probability distribution of v
                        
                           n
                         can be formulated via a softmax function as follows:
                           
                              (1)
                              
                                 p
                                 
                                    
                                       v
                                       n
                                    
                                    f
                                    
                                       η
                                       k
                                    
                                    
                                       η
                                       c
                                    
                                 
                                 :
                                 =
                                 
                                    
                                       exp
                                       
                                          
                                             
                                                f
                                                n
                                             
                                             +
                                             
                                                η
                                                
                                                   k
                                                   ,
                                                   n
                                                
                                             
                                             +
                                             
                                                η
                                                
                                                   c
                                                   ,
                                                   n
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       ‍
                                       exp
                                       
                                          
                                             
                                                f
                                                i
                                             
                                             +
                                             
                                                η
                                                
                                                   k
                                                   ,
                                                   i
                                                
                                             
                                             +
                                             
                                                η
                                                
                                                   c
                                                   ,
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

In Eq. (1), we assume that 
                           f
                        
                        ={f
                        
                           n
                        } is the background distribution of visual words in the logarithm domain and f
                        
                           n
                         is given by
                           
                              (2)
                              
                                 
                                    f
                                    n
                                 
                                 :
                                 =
                                 log
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                d
                                                =
                                                1
                                             
                                             D
                                          
                                          ‍
                                          
                                             x
                                             
                                                d
                                                ,
                                                n
                                             
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                d
                                                =
                                                1
                                             
                                             D
                                          
                                          ‍
                                          
                                             ∑
                                             
                                                n
                                                =
                                                1
                                             
                                             N
                                          
                                          ‍
                                          
                                             x
                                             
                                                d
                                                ,
                                                n
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Let ρ
                        
                           c
                           ,
                           k
                           ,
                           n
                        
                        =
                        p(v
                        
                           n
                        
                        |
                        
                           f
                        ,
                        
                           η
                        
                        
                           k
                        ,
                        
                           η
                        
                        
                           c
                        ) and 
                           ρ
                        
                        
                           c
                           ,
                           k
                        
                        ={ρ
                        
                           c
                           ,
                           k
                           ,
                           n
                        } which indicates the probability distribution over all visual words of the k-th topic in the c-th category. The probability of a visual word appearing in I
                        
                           d
                         is determined by its latent topic and the image label c
                        
                           d
                        , p(v
                        
                           d
                           ,
                           n
                        
                        |
                        c
                        
                           d
                        ,
                        z
                        
                           d
                           ,
                           n
                        
                        =
                        k,
                        
                           f
                        ,
                        
                           η
                        
                        
                           k
                        ,
                        
                           η
                        
                        
                           c
                           
                              d
                           
                        ) =
                           p(v
                        
                           d
                           ,
                           n
                        
                        |
                        c
                        
                           d
                        ,
                        z
                        
                           d
                           ,
                           n
                        
                        =
                        k,
                        ρ
                        
                           c
                           
                              d
                           
                           ,
                           k
                           ,
                           n
                        )~ Multinomial(ρ
                        
                           c
                           
                              d
                           
                           ,
                           k
                           ,
                           n
                        ).

Similarly, an annotation term is determined by its latent topic and the image label. The probability distribution of w
                        
                           m
                         can be formulated as
                           
                              (3)
                              
                                 p
                                 
                                    
                                       w
                                       m
                                    
                                    g
                                    
                                       ω
                                       k
                                    
                                    
                                       ω
                                       c
                                    
                                 
                                 :
                                 =
                                 
                                    
                                       exp
                                       
                                          
                                             
                                                g
                                                m
                                             
                                             +
                                             
                                                ω
                                                
                                                   k
                                                   ,
                                                   m
                                                
                                             
                                             +
                                             
                                                ω
                                                
                                                   c
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          M
                                       
                                       ‍
                                       exp
                                       
                                          
                                             
                                                g
                                                i
                                             
                                             +
                                             
                                                ω
                                                
                                                   k
                                                   ,
                                                   i
                                                
                                             
                                             +
                                             
                                                ω
                                                
                                                   c
                                                   ,
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           g
                        
                        ={g
                        
                           m
                        } is the background distribution of annotation terms in the logarithm domain and g
                        
                           m
                         is modeled by
                           
                              (4)
                              
                                 
                                    g
                                    m
                                 
                                 :
                                 =
                                 log
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                d
                                                =
                                                1
                                             
                                             D
                                          
                                          ‍
                                          
                                             s
                                             
                                                d
                                                ,
                                                m
                                             
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                d
                                                =
                                                1
                                             
                                             D
                                          
                                          ‍
                                          
                                             ∑
                                             
                                                m
                                                =
                                                1
                                             
                                             M
                                          
                                          ‍
                                          
                                             s
                                             
                                                d
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Let ξ
                        
                           c
                           ,
                           k
                           ,
                           m
                        
                        =
                        p(w
                        
                           m
                        
                        |
                        
                           g
                        ,
                        
                           ω
                        
                        
                           k
                        ,
                        
                           ω
                        
                        
                           c
                        ) and 
                           ξ
                        
                        
                           c
                           ,
                           k
                        
                        ={ξ
                        
                           c
                           ,
                           k
                           ,
                           m
                        } which indicates the probability distribution over all annotation terms of the k-th topic in the c-th category. The probability of an annotation term appearing in I
                        
                           d
                         is determined by its latent topic and the image label c
                        
                           d
                        , p(w
                        
                           d
                           ,
                           m
                        
                        |
                        c
                        
                           d
                        ,
                        y
                        
                           d
                           ,
                           m
                        
                        =
                        n,
                        z
                        
                           d
                           ,
                           n
                        
                        =
                        k,
                        
                           g
                        ,
                        
                           ω
                        
                        
                           k
                        ,
                        
                           ω
                        
                        
                           c
                           
                              d
                           
                        ) =
                           p(w
                        
                           d
                           ,
                           m
                        
                        |
                           c
                        
                           d
                        , y
                        
                           d
                           ,
                           m
                        
                        =
                        n, z
                        
                           d
                           ,
                           n
                        
                        =
                        k, ξ
                        
                           c
                           
                              d
                           
                           ,
                           k
                           ,
                           m
                        )~ Multinomial(ξ
                        
                           c
                           
                              d
                           
                           ,
                           k
                           ,
                           m
                        ).

In summary, DSTM assumes the following generative process:
                           
                              1.
                              Draw the background distribution 
                                    f
                                  and 
                                    g
                                  via Eqs. (2) and (4) respectively.

For each class c and each topic k:
                                    
                                       (a)
                                       For each visual word v
                                          
                                             n
                                          :
                                             
                                                i.
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      k
                                                   
                                                   ~Normal(0,diag(
                                                      τ
                                                   
                                                   
                                                      k
                                                   )), p(
                                                      τ
                                                   
                                                   
                                                      k
                                                   )∝1/
                                                      τ
                                                   
                                                   
                                                      k
                                                   ;


                                                   
                                                      η
                                                   
                                                   
                                                      c
                                                   
                                                   ~Normal(0,diag(
                                                      τ
                                                   
                                                   
                                                      c
                                                   )), p(
                                                      τ
                                                   
                                                   c)∝1/
                                                      τ
                                                   
                                                   
                                                      c
                                                   ;

Draw ρ
                                                   
                                                      c
                                                      ,
                                                      k
                                                      ,
                                                      n
                                                    via Eq. (1).

For each annotation term w
                                          
                                             m
                                          :
                                             
                                                i.
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      k
                                                   
                                                   ~Normal(0,diag(
                                                      π
                                                   
                                                   
                                                      k
                                                   )), p(
                                                      π
                                                   
                                                   
                                                      k
                                                   )∝1/
                                                      π
                                                   
                                                   
                                                      k
                                                   ;


                                                   
                                                      ω
                                                   
                                                   
                                                      c
                                                   
                                                   ~Normal(0,diag(
                                                      π
                                                   
                                                   
                                                      c
                                                   )), p(
                                                      π
                                                   
                                                   
                                                      c
                                                   )∝1/
                                                      π
                                                   
                                                   
                                                      c
                                                   ;

Draw ξ
                                                   
                                                      c
                                                      ,
                                                      k
                                                      ,
                                                      m
                                                    via Eq. (3).

For each image I
                                 
                                    d
                                 :
                                    
                                       (a)
                                       
                                          
                                             θ
                                          
                                          
                                             d
                                          
                                          ~Dirichlet(
                                             α
                                          ).

For each visual word v
                                          
                                             d
                                             ,
                                             n
                                          :
                                             
                                                i.
                                                
                                                   z
                                                   
                                                      d,n
                                                   
                                                   ~Multinomial(
                                                      θ
                                                   
                                                   
                                                      d
                                                   );


                                                   v
                                                   
                                                      d,n
                                                   
                                                   ~Multinomial(ρ
                                                   
                                                      c
                                                      
                                                         d
                                                      
                                                      ,
                                                      z
                                                      
                                                         d
                                                         ,
                                                         n
                                                      
                                                      ,
                                                      n
                                                   ).

For each text term w
                                          
                                             d
                                             ,
                                             m
                                          :
                                             
                                                i.
                                                
                                                   y
                                                   
                                                      d,m
                                                   
                                                   ~Empirical(x
                                                   
                                                      d,n
                                                   );


                                                   w
                                                   
                                                      d,m
                                                   
                                                   ~Multinomial(ξ
                                                   
                                                      c
                                                      
                                                         d
                                                      
                                                      ,
                                                      z
                                                      
                                                         d
                                                         ,
                                                         y
                                                         
                                                            d
                                                            ,
                                                            m
                                                         
                                                      
                                                      ,
                                                      m
                                                   ).

We remark that there are significant differences between the DSTM and the existing models sLDA-ann [32] and abc-corr-LDA [24] for simultaneous image classification and annotation. Before showing the differences, several basic concepts in sLDA-ann (Fig. 2(a)) and abc-corr-LDA (Fig. 2(b)) models are given as follows.

The goal of sLDA-ann is to learn three parameters, 
                           π
                        
                        ∈
                        R
                        
                           K
                           ×
                           N
                        , 
                           β
                        
                        ∈
                        R
                        
                           K
                           ×
                           M
                         and 
                           η
                        
                        ∈
                        R
                        
                           C
                           ×
                           K
                        . Among them, 
                           π
                        
                        ={
                           π
                        
                        1,…,
                        
                           π
                        
                        
                           K
                        } denotes the topic distribution based on visual words, where each 
                           π
                        
                        
                           k
                        
                        ={π
                        
                           k
                           ,
                           n
                        } is a topic-specific multinomial visual word distribution. 
                           β
                        
                        ={
                           β
                        
                        1,…,
                        
                           β
                        
                        
                           K
                        } (
                           β
                        
                        
                           k
                        
                        ={β
                        
                           k
                           ,
                           m
                        }) denotes the topic distribution based on annotation terms. Each 
                           η
                        
                        
                           c
                        
                        ={η
                        
                           c
                           ,
                           k
                        } in 
                           η
                        
                        ={
                           η
                        
                        1,…,
                        
                           η
                        
                        
                           C
                        } is the class distribution over K topics. Given an image I
                        
                           d
                        , its category c
                        
                           d
                         is drawn from a softmax distribution given by the topic distribution over the image visual words. Each visual word (v
                        
                           d
                           ,
                           n
                        )/annotation term (w
                        
                           d
                           ,
                           m
                        ) is generated via the latent topic z
                        
                           d
                           ,
                           n
                         according to the multinomial distribution on parameters 
                           π
                         and 
                           β
                         respectively.

In abc-corr-LDA, the label information c
                        
                           d
                         is enforced in the annotation term generative process, so that the parameter 
                           β
                         on annotation terms becomes a three-dimension matrix, i.e, 
                           β
                        
                        ∈
                        R
                        
                           C
                           ×
                           K
                           ×
                           M
                        . Similar to sLDA-ann, only the multinomial distribution is considered when generating each visual word (v
                        
                           d
                           ,
                           n
                        )/annotation term (w
                        
                           d
                           ,
                           m
                        ).

In the DSTM, both the latent topic variable z
                        
                           d
                           ,
                           n
                         and the class variable c
                        
                           d
                         are used to generate relevant visual word (v
                        
                           d
                           ,
                           n
                        ) and annotation term (w
                        
                           d
                           ,
                           m
                        ). This kind of generative process can make sure that each generative latent topic corresponds to a category, i.e., the learned topics are more discriminative.

Furthermore, the zero-mean Laplace distribution (which can lead to a sparse representation [20]) is used in DSTM model to effectively identify the relevant visual words or annotation terms, and ignore the irrelevant visual words or annotation terms for each topic. However, in sLDA-ann and abc-corr-LDA, only the multinomial distribution is used, which results in that each topic is related to all visual words and annotation terms.

In this paper, we employ the expectation maximization (EM) algorithm [5] to estimate the hidden variables and their required parameters in the model. The main idea of this variational inference is to select the Jensen's inequality to obtain an adjustable lower bound on the log-likelihood. Given an image I
                        
                           d
                         with the label c
                        
                           d
                        , the log-likelihood can be converted into a lower bound as follows:
                           
                              (5)
                              
                                 
                                    
                                       
                                          log
                                          p
                                          
                                             
                                                
                                                   v
                                                   d
                                                
                                                ,
                                                
                                                   w
                                                   d
                                                
                                                ,
                                                
                                                   c
                                                   d
                                                
                                             
                                             Ω
                                          
                                          ≥
                                          L
                                          
                                             
                                                θ
                                                d
                                             
                                             
                                                z
                                                d
                                             
                                             
                                                y
                                                d
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          :
                                          =
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                ⁡
                                                p
                                                
                                                   
                                                      
                                                         v
                                                         d
                                                      
                                                      ,
                                                      
                                                         w
                                                         d
                                                      
                                                      ,
                                                      
                                                         c
                                                         d
                                                      
                                                      ,
                                                      
                                                         θ
                                                         d
                                                      
                                                      ,
                                                      
                                                         z
                                                         d
                                                      
                                                      ,
                                                      
                                                         y
                                                         d
                                                      
                                                   
                                                   Ω
                                                
                                             
                                          
                                          -
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                ⁡
                                                q
                                                
                                                   
                                                      θ
                                                      d
                                                   
                                                   
                                                      z
                                                      d
                                                   
                                                   
                                                      y
                                                      d
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                       
                                       
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                       
                                       
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           v
                        
                        
                           d
                        
                        ={v
                        
                           d
                           ,
                           n
                        }, 
                           w
                        
                        
                           d
                        
                        ={w
                        
                           d
                           ,
                           m
                        }, 
                           z
                        
                        
                           d
                        
                        ={z
                        
                           d
                           ,
                           n
                        }, 
                           y
                        
                        
                           d
                        
                        ={y
                        
                           d
                           ,
                           m
                        }, Ω is a set of parameters containing 
                           α
                        , 
                           η
                        
                        
                           c
                        , 
                           η
                        
                        
                           k
                        , 
                           ω
                        
                        
                           c
                         
                        and 
                        
                           ω
                        
                        
                           k
                        , and 
                           
                              E
                              q
                           
                           
                              ⋅
                           
                         is the expectation over the probability distribution of q. 
                           L
                           
                              
                                 θ
                                 d
                              
                              
                                 z
                                 d
                              
                              
                                 y
                                 d
                              
                           
                         can be estimated by the E-step and the parameters in Ω can be estimated by the M-step of the EM algorithm.

We first note that
                           
                              
                                 
                                    
                                       
                                          
                                          p
                                          
                                             
                                                v
                                                d
                                             
                                             
                                                w
                                                d
                                             
                                             
                                                c
                                                d
                                             
                                             
                                                θ
                                                d
                                             
                                             
                                                z
                                                d
                                             
                                             
                                                y
                                                d
                                             
                                             Ω
                                          
                                       
                                    
                                    
                                       
                                          =
                                          
                                             ∏
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          ‍
                                          p
                                          
                                             
                                                θ
                                                d
                                             
                                             α
                                          
                                          
                                             ∏
                                             
                                                n
                                                =
                                                1
                                             
                                             N
                                          
                                          ‍
                                          
                                             ∏
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          ‍
                                          
                                             
                                                
                                                   p
                                                   
                                                      
                                                         
                                                            z
                                                            
                                                               d
                                                               ,
                                                               n
                                                            
                                                         
                                                         =
                                                         k
                                                      
                                                      
                                                         θ
                                                         d
                                                      
                                                   
                                                   p
                                                   
                                                      v
                                                      
                                                         d
                                                         ,
                                                         n
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   d
                                                   ,
                                                   n
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          
                                             ∏
                                             
                                                m
                                                =
                                                1
                                             
                                             M
                                          
                                          ‍
                                          
                                             ∏
                                             
                                                n
                                                =
                                                1
                                             
                                             N
                                          
                                          ‍
                                          
                                             ∏
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          ‍
                                          
                                             
                                                
                                                   p
                                                   
                                                      
                                                         
                                                            y
                                                            
                                                               d
                                                               ,
                                                               m
                                                            
                                                         
                                                         =
                                                         n
                                                      
                                                   
                                                   p
                                                   
                                                      w
                                                      
                                                         d
                                                         ,
                                                         m
                                                         ,
                                                         n
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                             
                                             
                                                s
                                                
                                                   d
                                                   ,
                                                   m
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        where the probability pv
                        
                           d
                           ,
                           n
                           ,
                           k
                        
                        =
                        p(v
                        
                           d
                           ,
                           n
                        
                        |
                        c
                        
                           d
                        ,
                        z
                        
                           d
                           ,
                           n
                        
                        =
                        k,
                        
                           f
                        ,
                        
                           η
                        
                        
                           k
                        ,
                        
                           η
                        
                        
                           c
                           
                              d
                           
                        ), and pw
                        
                           d
                           ,
                           m
                           ,
                           n
                           ,
                           k
                        
                        =
                        p(w
                        
                           d
                           ,
                           m
                        
                        |
                        c
                        
                           d
                        ,
                        y
                        
                           d
                           ,
                           m
                        
                        =
                        n,
                        z
                        
                           d
                           ,
                           n
                        
                        =
                        k,
                        
                           g
                        ,
                        
                           ω
                        
                        
                           k
                        ,
                        
                           ω
                        
                        
                           c
                           
                              d
                           
                        ). The posterior distribution of q is defined by
                           
                              
                                 
                                    
                                       
                                          
                                          q
                                          
                                             
                                                θ
                                                d
                                             
                                             
                                                z
                                                d
                                             
                                             
                                                y
                                                d
                                             
                                          
                                       
                                    
                                    
                                       
                                          :
                                          =
                                          
                                             ∏
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          ‍
                                          q
                                          
                                             
                                                θ
                                                d
                                             
                                             
                                                γ
                                                d
                                             
                                          
                                          
                                             ∏
                                             
                                                n
                                                =
                                                1
                                             
                                             N
                                          
                                          ‍
                                          
                                             ∏
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          ‍
                                          q
                                          
                                             
                                                
                                                   
                                                      z
                                                      
                                                         d
                                                         ,
                                                         n
                                                      
                                                   
                                                   =
                                                   k
                                                
                                                
                                                   ϕ
                                                   
                                                      d
                                                      ,
                                                      n
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   d
                                                   ,
                                                   n
                                                
                                             
                                          
                                          
                                             ∏
                                             
                                                m
                                                =
                                                1
                                             
                                             M
                                          
                                          ‍
                                          
                                             ∏
                                             
                                                n
                                                =
                                                1
                                             
                                             N
                                          
                                          ‍
                                          q
                                          
                                             
                                                
                                                   
                                                      y
                                                      
                                                         d
                                                         ,
                                                         m
                                                      
                                                   
                                                   =
                                                   n
                                                
                                                
                                                   λ
                                                   
                                                      d
                                                      ,
                                                      m
                                                   
                                                
                                             
                                             
                                                s
                                                
                                                   d
                                                   ,
                                                   m
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        where 
                           γ
                        
                        
                           d
                        
                        ={γ
                        
                           d
                           ,
                           k
                        }, ϕ
                        
                           d
                           ,
                           n
                        
                        ={ϕ
                        
                           d
                           ,
                           n
                           ,
                           k
                        } and 
                           λ
                        
                        
                           d
                           ,
                           m
                        
                        ={λ
                        
                           d
                           ,
                           m
                           ,
                           n
                        } are the variational parameters of q to be determined. Here γ
                        
                           d
                           ,
                           k
                         depicts the probability distribution of I
                        
                           d
                         on the k-th topic (∑
                           k
                           =1
                        
                           K
                        
                        ‍γ
                        
                           d
                           ,
                           k
                        
                        =1), ϕ
                        
                           d
                           ,
                           n
                           ,
                           k
                         depicts the probability distribution of the n-th visual word of I
                        
                           d
                         on the k-th topic (∑
                           k
                           =1
                        
                           K
                        
                        ‍ϕ
                        
                           d
                           ,
                           n
                           ,
                           k
                        
                        =1), and λ
                        
                           d
                           ,
                           m
                           ,
                           n
                         depicts the probability distribution of the m-th annotation term of I
                        
                           d
                         on the n-th visual word (∑
                           n
                           =1
                        
                           N
                        
                        ‍λ
                        
                           d
                           ,
                           m
                           ,
                           n
                        
                        =1).

The main aim of E-step is to estimate these variational parameters γ
                           
                              d
                              ,
                              k
                           , ϕ
                           
                              d
                              ,
                              n
                              ,
                              k
                            and λ
                           
                              d
                              ,
                              m
                              ,
                              n
                            based on 
                              L
                            in Eq. (5). γ
                           
                              d
                              ,
                              k
                            is the variational parameter of θ
                           
                              d
                              ,
                              k
                           . By using the Dirichlet distribution on 
                              θ
                           
                           
                              d
                            and the multinomial distribution on z
                           
                              d
                              ,
                              n
                           , and setting 
                              
                                 
                                    ∂
                                    L
                                 
                                 
                                    ∂
                                    
                                       γ
                                       
                                          d
                                          ,
                                          k
                                       
                                    
                                 
                              
                              =
                              0
                           , we have
                              
                                 (6)
                                 
                                    
                                       γ
                                       
                                          d
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       α
                                       k
                                    
                                    +
                                    
                                       ∑
                                       
                                          n
                                          =
                                          1
                                       
                                       N
                                    
                                    ‍
                                    
                                       x
                                       
                                          d
                                          ,
                                          n
                                       
                                    
                                    
                                       ϕ
                                       
                                          d
                                          ,
                                          n
                                          ,
                                          k
                                       
                                    
                                    .
                                 
                              
                           
                        

Similarly, by using pv
                           
                              d
                              ,
                              n
                              ,
                              k
                            and pw
                           
                              d
                              ,
                              m
                              ,
                              n
                              ,
                              k
                            with parameters ρ
                           
                              c
                              
                                 d
                              
                              ,
                              k
                              ,
                              n
                            and ξ
                           
                              c
                              
                                 d
                              
                              ,
                              k
                              ,
                              m
                            respectively, and setting 
                              
                                 
                                    ∂
                                    L
                                 
                                 
                                    ∂
                                    
                                       ϕ
                                       
                                          d
                                          ,
                                          n
                                          ,
                                          k
                                       
                                    
                                 
                              
                              =
                              0
                           , we obtain the estimation of ϕ
                           
                              d
                              ,
                              n
                              ,
                              k
                            as follows:
                              
                                 (7)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                   ϕ
                                                
                                                
                                                   d
                                                   ,
                                                   n
                                                   ,
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             ∝
                                             
                                                ρ
                                                
                                                   
                                                      c
                                                      d
                                                   
                                                   ,
                                                   k
                                                   ,
                                                   n
                                                
                                             
                                             exp
                                             
                                                
                                                   ψ
                                                   
                                                      
                                                         γ
                                                         
                                                            d
                                                            ,
                                                            k
                                                         
                                                      
                                                   
                                                   -
                                                   ψ
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               j
                                                               =
                                                               1
                                                            
                                                            K
                                                         
                                                         ‍
                                                         
                                                            γ
                                                            
                                                               d
                                                               ,
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             exp
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         m
                                                         =
                                                         1
                                                      
                                                      M
                                                   
                                                   ‍
                                                   
                                                      s
                                                      
                                                         d
                                                         ,
                                                         m
                                                      
                                                   
                                                   
                                                      λ
                                                      
                                                         d
                                                         ,
                                                         m
                                                         ,
                                                         n
                                                      
                                                   
                                                   log
                                                   
                                                      
                                                         ξ
                                                         
                                                            
                                                               c
                                                               d
                                                            
                                                            ,
                                                            k
                                                            ,
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           where ψ(⋅) is the digamma function given in [5]. Moreover, set 
                              
                                 
                                    ∂
                                    L
                                 
                                 
                                    ∂
                                    
                                       λ
                                       
                                          d
                                          ,
                                          m
                                          ,
                                          n
                                       
                                    
                                 
                              
                              =
                              0
                           , then λ
                           
                              d
                              ,
                              m
                              ,
                              n
                            can be obtained by
                              
                                 (8)
                                 
                                    
                                       λ
                                       
                                          d
                                          ,
                                          m
                                          ,
                                          n
                                       
                                    
                                    ∝
                                    exp
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          ‍
                                          
                                             ϕ
                                             
                                                d
                                                ,
                                                n
                                                ,
                                                k
                                             
                                          
                                          log
                                          
                                             
                                                ξ
                                                
                                                   
                                                      c
                                                      d
                                                   
                                                   ,
                                                   k
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

Let ζ
                           
                              d
                              ,
                              m
                              ,
                              k
                           
                           =∑
                              n
                              =1
                           
                              N
                           
                           ‍λ
                           
                              d
                              ,
                              m
                              ,
                              n
                           
                           ×
                           ϕ
                           
                              d
                              ,
                              n
                              ,
                              k
                            and ζ
                           
                              d
                              ,
                              m
                              ,
                              k
                            expresses the relationship of the m-th annotation term and the k-th topic in the d-th image. ζ
                           
                              d
                              ,
                              m
                              ,
                              k
                            and ϕ
                           
                              d
                              ,
                              n
                              ,
                              k
                            will be used in the M-step. The details of the derivative processes are shown in Appendix A.

Based on Eq. (5), the M-step is to maximize the lower bound on the log-likelihood to model parameters in Ω. Here we give the estimation process for 
                              η
                           
                           
                              k
                           , the processes for 
                              η
                           
                           
                              c
                           , 
                              ω
                           
                           
                              k
                           , 
                              ω
                           
                           
                              c
                            are shown in Appendix B.

To estimate the parameter 
                              η
                           
                           
                              k
                           , the log-likelihood 
                              L
                              
                                 
                                    η
                                    k
                                 
                              
                            should be maximized and this task can be done by using the Newton method. The calculation of the gradient 
                              
                                 
                                    ∂
                                    L
                                 
                                 
                                    ∂
                                    
                                       η
                                       k
                                    
                                 
                              
                            is obtained by
                              
                                 (9)
                                 
                                    
                                       
                                          ∂
                                          L
                                       
                                       
                                          ∂
                                          
                                             η
                                             k
                                          
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          d
                                          =
                                          1
                                       
                                       D
                                    
                                    ‍
                                    
                                       x
                                       
                                          d
                                          ,
                                          n
                                       
                                    
                                    
                                       ϕ
                                       
                                          d
                                          ,
                                          k
                                       
                                    
                                    -
                                    
                                       μ
                                       k
                                    
                                    
                                       β
                                       k
                                    
                                    -
                                    diag
                                    
                                       
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                τ
                                                k
                                                
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       η
                                       k
                                    
                                    ,
                                 
                              
                           and then the Newton direction Δ
                              η
                           
                           
                              k
                            is
                              
                                 (10)
                                 
                                    Δ
                                    
                                       η
                                       k
                                    
                                    =
                                    -
                                    
                                       A
                                       k
                                    
                                    
                                       
                                          ∂
                                          L
                                       
                                       
                                          ∂
                                          
                                             η
                                             k
                                          
                                       
                                    
                                    +
                                    
                                       
                                          μ
                                          
                                             A
                                             k
                                          
                                          
                                             β
                                             k
                                          
                                       
                                       
                                          1
                                          +
                                          μ
                                          
                                             β
                                             k
                                             T
                                          
                                          
                                             A
                                             k
                                          
                                          
                                             β
                                             k
                                          
                                       
                                    
                                    
                                       β
                                       k
                                       T
                                    
                                    
                                       A
                                       k
                                    
                                    
                                       
                                          ∂
                                          L
                                       
                                       
                                          ∂
                                          
                                             η
                                             k
                                          
                                       
                                    
                                    ,
                                 
                              
                           where μ
                           
                              k
                           
                           =∑
                              d
                              =1
                           
                              D
                           
                           ‍∑
                              n
                              =1
                           
                              N
                           
                           ‍x
                           
                              d
                              ,
                              n
                           
                           ϕ
                           
                              d
                              ,
                              n
                              ,
                              k
                           , μ
                           =∑
                              k
                              =1
                           
                              K
                           
                           ‍μ
                           
                              k
                           , 
                              β
                           
                           
                              k
                           
                           ={β
                           
                              k
                              ,
                              n
                           }=∑
                              c
                              =1
                           
                              C
                           
                           ‍
                           
                              ρ
                           
                           
                              c
                              ,
                              k
                            and 
                              
                                 A
                                 k
                              
                              =
                              
                                 
                                    A
                                    
                                       k
                                       ,
                                       n
                                    
                                 
                              
                              =
                              diag
                              
                                 
                                    -
                                    
                                       
                                          
                                             μ
                                             
                                                β
                                                k
                                             
                                             +
                                             
                                                E
                                                q
                                             
                                             
                                                
                                                   τ
                                                   k
                                                   
                                                      -
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          -
                                          1
                                       
                                    
                                 
                              
                           . 
                              diag
                              
                                 
                                    
                                       E
                                       q
                                    
                                    
                                       
                                          τ
                                          k
                                          
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                            is a diagonal matrix where its main diagonal entry is given by 
                              
                                 E
                                 q
                              
                              
                                 
                                    τ
                                    k
                                    
                                       -
                                       1
                                    
                                 
                              
                           , and ·
                              T
                            denotes a transpose of a vector.


                           
                              
                                 E
                                 q
                              
                              
                                 
                                    τ
                                    k
                                    
                                       -
                                       1
                                    
                                 
                              
                            should be calculated in Eqs. (9) and (10) by using the variational bound 
                              L
                              
                                 
                                    τ
                                    k
                                 
                              
                           . we first factor the posterior distribution q(
                              τ
                           
                           
                              k
                           )=∏
                              n
                              =1
                           
                              N
                           
                           ‍q(τ
                           
                              k
                              ,
                              n
                           ), then follow [20] and introduce Gamma distribution for q(τ
                           
                              k
                              ,
                              n
                           ) as
                              
                                 
                                    q
                                    
                                       
                                          τ
                                          
                                             k
                                             ,
                                             n
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             τ
                                             
                                                k
                                                ,
                                                n
                                             
                                             
                                                a
                                                -
                                                1
                                             
                                          
                                          exp
                                          
                                             
                                                -
                                                
                                                   τ
                                                   
                                                      k
                                                      ,
                                                      n
                                                   
                                                
                                                /
                                                b
                                             
                                          
                                       
                                       
                                          Γ
                                          
                                             a
                                          
                                          
                                             b
                                             a
                                          
                                       
                                    
                                    ,
                                 
                              
                           where a and b are the parameters of Gamma distribution and Γ(·) is the Gamma function. As the prior on τ
                           
                              k
                              ,
                              n
                            is Jeffrey's prior, and according to the properties of Gamma distribution, we have 
                              
                                 E
                                 q
                              
                              
                                 
                                    τ
                                    
                                       k
                                       ,
                                       n
                                    
                                 
                              
                              =
                              ab
                           , 
                              
                                 E
                                 q
                              
                              
                                 
                                    τ
                                    
                                       k
                                       ,
                                       n
                                    
                                    
                                       -
                                       1
                                    
                                 
                              
                              =
                              
                                 1
                                 
                                    
                                       
                                          a
                                          -
                                          1
                                       
                                    
                                    b
                                 
                              
                           , 
                              
                              
                                 E
                                 q
                              
                              
                                 
                                    log
                                    
                                       τ
                                       
                                          k
                                          ,
                                          n
                                       
                                    
                                 
                              
                              =
                              ψ
                              
                                 a
                              
                              +
                              log
                              
                                 b
                              
                              .
                            By setting 
                              
                                 
                                    ∂
                                    L
                                 
                                 
                                    ∂
                                    b
                                 
                              
                              =
                              0
                           , we can get the closed form solution of b as 
                              b
                              =
                              
                                 
                                    η
                                    
                                       k
                                       ,
                                       n
                                    
                                    2
                                 
                                 
                                    a
                                    -
                                    1
                                 
                              
                           . It implies that 
                              
                                 E
                                 q
                              
                              
                                 
                                    τ
                                    
                                       k
                                       ,
                                       n
                                    
                                    
                                       -
                                       1
                                    
                                 
                              
                              =
                              
                                 1
                                 
                                    
                                       
                                          a
                                          -
                                          1
                                       
                                    
                                    b
                                 
                              
                              =
                              
                                 1
                                 
                                    η
                                    
                                       k
                                       ,
                                       n
                                    
                                    2
                                 
                              
                            and then 
                              
                                 E
                                 q
                              
                              
                                 
                                    τ
                                    k
                                    
                                       -
                                       1
                                    
                                 
                              
                              =
                              
                                 1
                                 
                                    η
                                    k
                                    2
                                 
                              
                           . According to this computation, the gradient 
                              
                                 
                                    ∂
                                    L
                                 
                                 
                                    ∂
                                    
                                       η
                                       k
                                    
                                 
                              
                            and the Newton direction Δ
                              η
                           
                           
                              k
                            can be directly computed.

Similarly, 
                              η
                           
                           
                              c
                           , 
                              ω
                           
                           
                              k
                            and 
                              ω
                           
                           
                              c
                            can be obtained which the details are shown in Appendix B. Finally, ρ
                           
                              c
                              ,
                              k
                              ,
                              n
                            and ξ
                           
                              c
                              ,
                              k
                              ,
                              m
                            can be calculated via Eqs. (1) and (3) respectively based on the learned parameters 
                              η
                           
                           
                              k
                           , 
                              η
                           
                           
                              c
                           , 
                              ω
                           
                           
                              k
                            and 
                              ω
                           
                           
                              c
                           .

The output of the estimated parameters can be used to predict the category and annotation information for a testing image. In the testing set 
                           
                              I
                              *
                           
                           =
                           
                              
                                 I
                                 
                                    1
                                    *
                                 
                              
                              
                                 I
                                 
                                    2
                                    *
                                 
                              
                              …
                              
                                 I
                                 
                                    D
                                    *
                                 
                              
                           
                        , each image I
                        
                           d
                           ⁎
                         is only represented as a frequency vector 
                           x
                        
                        
                           d
                           ⁎
                        
                        ={x
                        
                           d
                           ⁎
                           ,
                           n
                        } of visual features 
                           v
                        
                        
                           d
                           ⁎
                        
                        ={v
                        
                           d
                           ⁎
                           ,
                           n
                        }. The task is to predict one category and annotation terms of this image.

According to the estimation on training set, the parameters ρ
                        
                           c
                           ,
                           k
                           ,
                           n
                         and ξ
                        
                           c
                           ,
                           k
                           ,
                           m
                         have been obtained. And we can compute ϕ
                        
                           d
                           ⁎
                           ,
                           n
                           ,
                           k
                         and λ
                        
                           d
                           ⁎
                           ,
                           m
                           ,
                           n
                         with Eqs. (7) and (8) by maximizing the posterior q(
                           θ
                        
                        
                           d
                           ⁎
                        ,
                        
                           z
                        
                        
                           d
                           ⁎
                        ,
                        
                           y
                        
                        
                           d
                           ⁎
                        ) on the testing image I
                        
                           d
                           ⁎
                        .

To classify the testing image I
                        
                           d
                           ⁎
                        , the proposed prediction rule is given by
                           
                              
                                 
                                    c
                                    *
                                 
                                 =
                                 
                                    
                                       arg
                                       max
                                    
                                    
                                       c
                                       ∈
                                       
                                          1
                                          …
                                          C
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 ‍
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 ‍
                                 
                                    
                                       
                                          x
                                          
                                             
                                                d
                                                *
                                             
                                             ,
                                             n
                                          
                                       
                                       
                                          ϕ
                                          
                                             
                                                d
                                                *
                                             
                                             ,
                                             n
                                             ,
                                             k
                                          
                                       
                                       
                                          ρ
                                          
                                             c
                                             ,
                                             k
                                             ,
                                             n
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Once obtaining the predicted label c
                        ⁎, the probability of each annotation term w
                        
                           d
                           ⁎
                           ,
                           m
                         of the testing image can be calculated via
                           
                              
                                 p
                                 
                                    
                                       w
                                       
                                          
                                             d
                                             *
                                          
                                          ,
                                          m
                                       
                                    
                                    
                                       v
                                       
                                          d
                                          *
                                       
                                    
                                    
                                       c
                                       *
                                    
                                 
                                 ≈
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 ‍
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 ‍
                                 
                                    
                                       
                                          x
                                          
                                             
                                                d
                                                *
                                             
                                             ,
                                             n
                                          
                                       
                                       
                                          λ
                                          
                                             
                                                d
                                                *
                                             
                                             ,
                                             m
                                             ,
                                             n
                                          
                                       
                                       
                                          ϕ
                                          
                                             
                                                d
                                                *
                                             
                                             ,
                                             n
                                             ,
                                             k
                                          
                                       
                                       
                                          ξ
                                          
                                             
                                                c
                                                *
                                             
                                             ,
                                             k
                                             ,
                                             m
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Here ρ
                        
                           c
                           ,
                           k
                           ,
                           n
                         and ξ
                        
                           c
                           ⁎
                           ,
                           k
                           ,
                           m
                         are learned from the training data set with the above parameter estimation algorithm.

@&#EXPERIMENTAL RESULTS@&#

@&#METHODOLOGY@&#

Two small natural image sets and two large sets are used to test the performance of DSTM by comparing with several existing methods. The first data set is LabelMe [30] including 8 categories and 2366 images. The second set is UIUC [23] containing 1792 images belonging to 8 classes. The third set is a subset of NUS-WIDE [13] including 10 categories and 6458 images. The last set is a subset of PascalVOC07 [10] including 20 categories and 6146 images.

For LabelMe and UIUC, the 128-dimensional SIFT region descriptors are extracted by selecting a sliding grid (5×5), and then the k-means algorithm are applied to obtain the 240 codewords to represent the image visual information. The annotation terms occurred less than 3 times are removed, and the left terms are used to represent the image semantic information. Finally, the numbers of image annotation terms in LabelMe and UIUC are 357 and 206 respectively. For PascalVOC07 and NUS-WIDE, 1024 and 500 words are used to express the visual information, 986 and 804 annotation terms consist of the text vocabulary respectively.

The proposed method is compared on image classification with the following five methods: sLDA-ann [32], abc-corr-LDA [24], SupDocNADE [38], SAGE [12] and MedSTC [37]. Although SAGE and MedSTC only consider image visual information, they add constraints to topic model for obtaining sparse topics, we compare their results for image classification. The classification performance is measured via
                           
                              
                                 accuracy
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       D
                                       *
                                    
                                 
                                 ‍
                                 δ
                                 
                                    
                                       c
                                       i
                                    
                                    
                                       c
                                       i
                                       *
                                    
                                 
                                 /
                                 
                                    D
                                    *
                                 
                                 .
                              
                           
                        Here, c
                        
                           i
                         denotes the true label of image I
                        
                           i
                        , c
                        
                           i
                        
                        ⁎ denotes its predicted label, D
                        ⁎ is the number of testing images. δ(c
                        
                           i
                        ,
                        c
                        
                           i
                        
                        ⁎)=1 if c
                        
                           i
                        
                        =
                        c
                        
                           i
                        
                        ⁎, otherwise δ(c
                        
                           i
                        ,
                        c
                        
                           i
                        
                        ⁎)=0. The larger the accuracy, the better the classification performance.

The performance of annotation is compared with sLDA-ann, abc-corr-LDA and SupDocNADE. Following [32], the top-5 F-measure is used as the evaluation metric.
                           
                              
                                 F
                                 -
                                 measure
                                 =
                                 
                                    
                                       2
                                       ×
                                       Precision
                                       ×
                                       Recall
                                    
                                    
                                       Precision
                                       +
                                       Recall
                                    
                                 
                                 .
                              
                           
                        
                     

Here “Precision” is the percentage of correct annotation terms out of the top 5 propagated terms, and “Recall” is the percentage of annotation terms propagated out of all the ground-truth terms of the image.

In order to analyze the performance of DSTM, we investigate the topic detection process. As described in Section 3, DSTM can learn the relationship (ρ
                        
                           c
                           ,
                           k
                           ,
                           n
                         and ξ
                        
                           c
                           ,
                           k
                           ,
                           m
                        ) between categories, topics and visual words/annotation terms given training data. We randomly select the k-th topic 
                           ξ
                        
                        
                           c
                           ,
                           k
                        
                        ={ξ
                        
                           c
                           ,
                           k
                           ,
                           m
                        } on annotation terms learned by DSTM from LabelMe training set in the category “mountain” (c
                        =
                        mountain) as shown in Fig. 3(b). This topic contains five terms “rock”, “snowy mountain”, “mountain”, “sky”, and “trees” with high probabilities, which obviously associates with the category “mountain”. This is reasonable because the label information directly conducts the annotation term generative process, and then the topics can be grouped by categories. Compared with the topic learned by sLDA-ann as shown in Fig. 3(a), DSTM is able to identify topics with clear semantic meaning which provides discriminative ability to distinguish the category information for the testing image.

To evaluate the intrinsic quality of topics on annotation terms, we adopt the word intrusion method proposed in [22]. Among them, the annotation terms of one image are considered as a document, and all documents are used to form the reference corpus. Then, the intruder words are randomly injects into the topics. In this case, if the intruder words can be correctly identified, the topic is pretty good otherwise the topic is confusing, i.e., its meaning is not clear.

Since SAGE and MedSTC only consider the visual information, and SupDocNADE outputs topics mixing both visual and annotation information, we compare the topics learned by DSTM, sLDA-ann and abc-corr-LDA. The word association of each topic with top-5 terms is measured via word intrusion based on normalised pointwise mutual information (WI-Auto-NPMI). Finally, the WI-Auto-NPMI values of 24 topics learned by DSTM, sLDA-ann and abc-corr-LDA are 0.875, 0.667 and 0.75 respectively. Obviously, DSTM outperforms other methods in terms of topic coherence. Table 1
                         lists nine example topics with top-5 terms.

From Table 1, we can see that the topics output by DSTM are pretty good. These three topics are clearly related to category “street”, “highway” and “coast” respectively. The intruder words can be correctly identified in the first two topics. For the third topic, “rock” is taken as an intruder word, however, it is semantically related to the category “coast”. Thus, the low-frequency co-occurred word “boat-cropped” is identified as intruder word.

The topics learned by sLDA-ann and abc-corr-LDA are confused. For example, the first topic from sLDA-ann is related to both “coast” and “mountain” categories. The intruded words cannot be correctly identified in most cases. The main reason is that this model has no discriminative ability to distinguish the category information. Meanwhile, the top-5 terms in the topics learned by abc-corr-LDA always have high frequency in the whole corpus such as “sky”and “cloud”. It is because the sparsity is not considered in this model.

DSTM can return the probability distribution of each topic in each category over all visual words, denoted as ρ
                        
                           c
                           ,
                           k
                           ,
                           n
                        . Thus, when demonstrating the relationship between topic and visual words, we organize the topics according to their corresponding category information as shown in Fig. 5(a). For sLDA-ann and MedSTC, the probability distribution of each topic over all visual words is obtained without category information, as shown in Fig. 5(b) and (c) respectively. The results in Fig. 5 are recorded at training size being 50% of LabelMe set and the number of topics being 24 for sLDA-ann and MedSTC, while there are 3 topics in each category for DSTM (the total number of topics is also 24). Note here each topic is related to one category in DSTM, the topics are grouped according to the corresponding category in the Y-axis of Fig. 5(a). The related visual words of each topic are sorted along the X-axis, while the words shared by most topics are put in the end. The orders of the visual words in Fig. 5(b) and (c) are consistent with in Fig. 5(a).

It is easy to see that each learned topic identified by DSTM is only related to few visual words, while the topic corresponds to many visual words in sLDA-ann model. This result indicates that the zero-mean Laplace distribution is useful to narrow the scope of visual words for each topic in DSTM model. Even though the topic learned by MedSTC has a sparse representation, it is not directly related to the category. The block structure in Fig. 5(a) indicates that each topic is obviously related to one category, which make the topics learned by DSTM more discriminative for the category information.

Given a testing image I
                        
                           d
                           ⁎
                        , DSTM will perform the posterior inference to obtain the probability distribution (ϕ
                        
                           d
                           ⁎
                           ,
                           n
                           ,
                           k
                        ) of the learned topics on N visual words. Fig. 4(c) and (d) show the topic distribution and assignment (ϕ
                        
                           d
                           ⁎
                           ,
                           n
                           ,
                           k
                        ) for the visual words of one testing image (the same image with Fig. 4(b)). From these two figures, it can be seen that almost of all the topics are related with fewer visual words in DSTM model. While the topics are related to more visual words in abc-corr-LDA model and the same situation will happen in sLDA-ann and MedSTC model for the absence of label information in the process of topic generation.

Based on the prediction model, we can calculate its distribution on the k-th topic via ∑
                           n
                           =1
                        
                           N
                        
                        ‍(x
                        
                           d
                           ⁎
                           ,
                           n
                        
                        ϕ
                        
                           d
                           ⁎
                           ,
                           n
                           ,
                           k
                           
                        
                        ρ
                        
                           c
                           ,
                           k
                           ,
                           n
                        ) for each category c. Since DSTM learned K topics for each category, we organize topics of this testing image (the same image with Fig. 4(b)) according to category and show the topic distribution in Fig. 6(a). The higher the value, the deeper the color. Fig. 6(b) gives the probability distribution by adding up the values of K topics in one category. Obviously, the image belongs to “mountain” with the highest probability. Compared with DSTM, we compute the distribution of the k-th topic learned by abc-corr-LDA via ∑
                           n
                           =1
                        
                           N
                        
                        ‍(ϕ
                        
                           d
                           ⁎
                           ,
                           n
                           ,
                           k
                        
                        
                        μ
                        
                           c
                           ,
                           n
                        ) for each category c. The results are shown in Fig. 6(c) and (d). It can be seen that the image is related closely with “mountain” and “open country”. For the larger probability of “open country”, this image will be mistakenly classified into “open country”. The results in Fig. 6 further demonstrate that DSTM model is useful to decide the category information of the testing image.

In graphical models, the number of topics has to be predefined. Usually, the researchers [4,32,24] empirically selected the proper topic size for good final performance. In order to investigate the effects of K on DSTM, we conduct a series of experiments and try to tune K with training data.

When there are plenty of labeled data, it is a good way to separate them into two parts, one for training data and one for held-out data. In many applications, however, the labeled data are often limited. Meanwhile, once the splitting is not good, the held-out data may not work well on tuning parameters. Thus, we use cross-validation [3] on training data to tune the parameters. The results are obtained at evenly splitting each category to create training and testing data for all data sets. To ameliorate the unfortunate splits, we randomly sample ten times for each data set and the average classification accuracies on the testing data are recorded as shown in Fig. 7
                        . There are 8 categories in LabelMe and UIUC sets, and K topics will be learned for each category, then the total number of topics is 8K. While the numbers of categories are 10 and 20 in NUS-WIDE and PascalVOC07, and the total numbers of topics are 10K and 20K respectively.

It can be seen that sLDA-ann, abc-corr-LDA, SupDocNADE, and MedSTC cannot perform well when the number of topics is small, while the performance of DSTM does not change significantly according to the number of topics. The main reason is that small topics will limit the identification of latent topics in sLDA-ann, abc-corr-LDA and MedSTC. DSTM can identify K topics for each category, in this case, each topic has ability to distinguish the category information, so that the final classification performance is good even though K is small.

Because the SAGE and MedSTC models only deal with single task (image classification) without combining annotation information, the annotation performances of DSTM, sLDA-ann, abc-corr-LDA and SupDocNADE are compared as shown in Fig. 8
                        . It can be seen that abc-corr-LDA outperforms sLDA-ann because the label information is enforced in the annotation term generative process, which is consistent with the results in [24]. SupDocNADE can learn the better hidden topic features by using neural networks, so its performance is better than abc-corr-LDA. In DSTM, the annotation term is drawn from label and topic, the learned topic in DSTM is more discriminative than in abc-corr-LDA and SupDocNADE. That is why DSTM is superior to abc-corr-LDA and SupDocNADE on image annotation.


                        Table 2
                         demonstrates the computation time to build the DSTM, sLDA-ann, abc-corr-LDA, SupDocNADE, SAGE and MedSTC models. Fig. 9
                         demonstrates the computation time under varying number of topics on LabelMe data. Obviously, the computation time of all methods increases with the increasing of topic numbers. The best classification result for each method is highlighted. It can be seen that DSTM and SAGE perform best with 24 topics, MedSTC and sLDA-ann with 88 topics, abc-corr-LDA and SupDocNADE with 104 topics. Fortunately, fewer topics are helpful to decrease the computational complexity in learning process. Thus, DSTM costs less computational time.

Usually, the prediction performance changes with respect to the size of training data. In this subsection, a series of experiments have been conducted to show how training size affects the classification and annotation results. We sample 10%-90% of the whole data as the training data respectively for all data sets. For a given percentage, a desired number of data are randomly sampled ten times, finally the average accuracies are recorded.

The classification results are shown in Fig. 10
                        . From these four figures, it can be seen that DSTM is better than SAGE and MedSTC. The main reason is that SAGE and MedSTC do not consider annotation information. It also demonstrates that incorporating annotation information can improve the performance of image classification. Even though both sLDA-ann and abc-corr-LDA combine visual words and annotation terms to build the image classifier, they generate visual word without supervision of label information, so that the visual word distribution on the learned topics cannot help to distinguish category information. SupDocNADE does not directly introduce the label information in the visual and annotation words. While in DSTM, the label information is directly enforced into the visual word generative process, thus the visual word distribution has ability to effectively classify the testing images. That is why DSTM has higher classification accuracies than sLDA-ann, abc-corr-LDA and SupDocNADE on four data sets. Fig. 11 gives the image annotation results. Obviously, DSTM obtains better annotation performance than sLDA-ann because the label information supervises the generative process of annotation term. And the performance of DSTM is better than abc-corr-LDA and SupDocNADE, this is because that the sparse representation of topics can contribute to make the topics with clear semantic meanings and then to enhance the annotation performance. (See Fig. 11.)

These results indicate that image visual words, annotation terms and category information are all helpful to do image classification and annotation. The image classification benefits from the good annotation and the image annotation benefits from the good classification.

@&#CONCLUSION@&#

In this paper, a discriminative and sparse topic model, DSTM, is proposed for simultaneous image classification and image annotation. The new model has two properties: (i) it uses label information to supervise the generative process of each visual word and annotation term, (ii) it adopts zero-mean Laplace distribution to constrain the sparsity of topic distribution over visual word and annotation term. DSTM benefits from these characteristics to learn the discriminative topics and effectively predict the label and annotation information for testing images. On real-world image data sets, a series of experiments are conducted and the results have shown that the proposed method outperforms the related image classification and annotation methods.

DSTM can only manage the image with a single label rather than multiple labels, we will focus on automatically identifying the correspondence between multiple labels and visual words/annotation terms, and then applying to handle the images with multiple labels in the future. The proposed model focus on the sparsity of each topic. It is interesting to consider structured sparsity among topics in the future.


                        
                           γ
                        
                        
                           d
                         is the variational parameter of 
                           θ
                        
                        
                           d
                         and the relevant parts are given by
                           
                              
                                 
                                    
                                       
                                          L
                                          
                                             
                                                γ
                                                d
                                             
                                          
                                          =
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          ‍
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                ⁡
                                                p
                                                
                                                   
                                                      θ
                                                      d
                                                   
                                                   α
                                                
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          ‍
                                          
                                             ∑
                                             
                                                n
                                                =
                                                1
                                             
                                             N
                                          
                                          ‍
                                          
                                             x
                                             
                                                d
                                                ,
                                                n
                                             
                                          
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                ⁡
                                                p
                                                
                                                   
                                                      
                                                         z
                                                         
                                                            d
                                                            ,
                                                            n
                                                         
                                                      
                                                      =
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   θ
                                                   d
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          -
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          ‍
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                q
                                                
                                                   
                                                      θ
                                                      d
                                                   
                                                   
                                                      γ
                                                      d
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

Use the Dirichlet distribution on 
                           θ
                        
                        
                           d
                         and the multinomial distribution on z
                        
                           d
                           ,
                           n
                        ,
                           
                              
                                 
                                    
                                       
                                          L
                                          
                                             
                                                γ
                                                
                                                   d
                                                   ,
                                                   k
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   α
                                                   k
                                                
                                                -
                                                1
                                             
                                          
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                
                                                   
                                                      γ
                                                      
                                                         d
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                n
                                                =
                                                1
                                             
                                             N
                                          
                                          ‍
                                          
                                             x
                                             
                                                d
                                                ,
                                                n
                                             
                                          
                                          
                                             ϕ
                                             
                                                d
                                                ,
                                                n
                                                ,
                                                k
                                             
                                          
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                
                                                   
                                                      γ
                                                      
                                                         d
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          +
                                          log
                                          Γ
                                          
                                             
                                                γ
                                                
                                                   d
                                                   ,
                                                   k
                                                
                                             
                                          
                                          -
                                          log
                                          Γ
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   K
                                                
                                                ‍
                                                
                                                   γ
                                                   
                                                      d
                                                      ,
                                                      j
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   γ
                                                   
                                                      d
                                                      ,
                                                      k
                                                   
                                                
                                                -
                                                1
                                             
                                          
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                
                                                   
                                                      γ
                                                      
                                                         d
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        where 
                           
                              E
                              q
                           
                           
                              
                                 log
                                 
                                    
                                       γ
                                       
                                          d
                                          ,
                                          k
                                       
                                    
                                 
                              
                           
                           =
                           ψ
                           
                              
                                 γ
                                 
                                    d
                                    ,
                                    k
                                 
                              
                           
                           -
                           ψ
                           
                              
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    K
                                 
                                 ‍
                                 
                                    γ
                                    
                                       d
                                       ,
                                       j
                                    
                                 
                              
                           
                         and ψ(⋅) is the digamma function.
                           
                              
                                 
                                    
                                       
                                          L
                                          
                                             
                                                γ
                                                
                                                   d
                                                   ,
                                                   k
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   α
                                                   k
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      n
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                ‍
                                                
                                                   x
                                                   
                                                      d
                                                      ,
                                                      n
                                                   
                                                
                                                
                                                   ϕ
                                                   
                                                      d
                                                      ,
                                                      n
                                                      ,
                                                      k
                                                   
                                                
                                                -
                                                
                                                   γ
                                                   
                                                      d
                                                      ,
                                                      k
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ψ
                                                
                                                   
                                                      γ
                                                      
                                                         d
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                -
                                                ψ
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         K
                                                      
                                                      ‍
                                                      
                                                         γ
                                                         
                                                            d
                                                            ,
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          +
                                          log
                                          Γ
                                          
                                             
                                                γ
                                                
                                                   d
                                                   ,
                                                   k
                                                
                                             
                                          
                                          -
                                          log
                                          Γ
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   K
                                                
                                                ‍
                                                
                                                   γ
                                                   
                                                      d
                                                      ,
                                                      j
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

We take the derivative with each γ
                        
                           d
                           ,
                           k
                        ,
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                L
                                             
                                             
                                                ∂
                                                
                                                   γ
                                                   
                                                      d
                                                      ,
                                                      k
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             ψ
                                             '
                                          
                                          
                                             
                                                γ
                                                
                                                   d
                                                   ,
                                                   k
                                                
                                             
                                          
                                          
                                             
                                                
                                                   α
                                                   k
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      n
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                ‍
                                                
                                                   x
                                                   
                                                      d
                                                      ,
                                                      n
                                                   
                                                
                                                
                                                   ϕ
                                                   
                                                      d
                                                      ,
                                                      n
                                                      ,
                                                      k
                                                   
                                                
                                                -
                                                
                                                   γ
                                                   
                                                      d
                                                      ,
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          -
                                          ψ
                                          '
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   K
                                                
                                                ‍
                                                
                                                   γ
                                                   
                                                      d
                                                      ,
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             K
                                          
                                          ‍
                                          
                                             
                                                
                                                   α
                                                   j
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      n
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                ‍
                                                
                                                   x
                                                   
                                                      d
                                                      ,
                                                      n
                                                   
                                                
                                                
                                                   ϕ
                                                   
                                                      d
                                                      ,
                                                      n
                                                      ,
                                                      j
                                                   
                                                
                                                -
                                                
                                                   γ
                                                   
                                                      d
                                                      ,
                                                      j
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

By taking the derivative 
                           
                              
                                 ∂
                                 L
                              
                              
                                 ∂
                                 
                                    γ
                                    
                                       d
                                       ,
                                       k
                                    
                                 
                              
                           
                           =
                           0
                        , we have
                           
                              
                                 
                                    γ
                                    
                                       d
                                       ,
                                       k
                                    
                                 
                                 =
                                 
                                    α
                                    k
                                 
                                 +
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 ‍
                                 
                                    x
                                    
                                       d
                                       ,
                                       n
                                    
                                 
                                 
                                    ϕ
                                    
                                       d
                                       ,
                                       n
                                       ,
                                       k
                                    
                                 
                                 .
                              
                           
                        
                     

The relevant parts about ϕ
                        
                           d
                           ,
                           n
                         are given by
                           
                              
                                 
                                    
                                       
                                          L
                                          
                                             
                                                ϕ
                                                
                                                   d
                                                   ,
                                                   n
                                                
                                             
                                          
                                          =
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          ‍
                                          
                                             ∑
                                             
                                                n
                                                =
                                                1
                                             
                                             N
                                          
                                          ‍
                                          
                                             x
                                             
                                                d
                                                ,
                                                n
                                             
                                          
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                p
                                                
                                                   
                                                      
                                                         z
                                                         
                                                            d
                                                            ,
                                                            n
                                                         
                                                      
                                                      =
                                                      k
                                                   
                                                   
                                                      θ
                                                      d
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          ‍
                                          
                                             ∑
                                             
                                                n
                                                =
                                                1
                                             
                                             N
                                          
                                          ‍
                                          
                                             x
                                             
                                                d
                                                ,
                                                n
                                             
                                          
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                
                                                   
                                                      p
                                                      
                                                         v
                                                         
                                                            d
                                                            ,
                                                            n
                                                            ,
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          ‍
                                          
                                             ∑
                                             
                                                n
                                                =
                                                1
                                             
                                             N
                                          
                                          ‍
                                          
                                             ∑
                                             
                                                m
                                                =
                                                1
                                             
                                             M
                                          
                                          ‍
                                          
                                             x
                                             
                                                d
                                                ,
                                                n
                                             
                                          
                                          
                                             s
                                             
                                                d
                                                ,
                                                m
                                             
                                          
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                
                                                   
                                                      p
                                                      
                                                         w
                                                         
                                                            d
                                                            ,
                                                            m
                                                            ,
                                                            n
                                                            ,
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          ‍
                                          
                                             ∑
                                             
                                                n
                                                =
                                                1
                                             
                                             N
                                          
                                          ‍
                                          
                                             x
                                             
                                                d
                                                ,
                                                n
                                             
                                          
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                q
                                                
                                                   
                                                      
                                                         z
                                                         
                                                            d
                                                            ,
                                                            n
                                                         
                                                      
                                                      =
                                                      k
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

Use the multinomial distribution on z
                        
                           d
                           ,
                           n
                        , and put the parameters ρ
                        
                           c
                           
                              d
                           
                           ,
                           k
                           ,
                           n
                         and ξ
                        
                           c
                           
                              d
                           
                           ,
                           k
                           ,
                           m
                         into pv
                        
                           d
                           ,
                           n
                           ,
                           k
                         and pw
                        
                           d
                           ,
                           m
                           ,
                           n
                           ,
                           k
                         respectively,
                           
                              
                                 
                                    
                                       
                                          L
                                          
                                             
                                                ϕ
                                                
                                                   d
                                                   ,
                                                   n
                                                   ,
                                                   k
                                                
                                             
                                          
                                          =
                                          
                                             ϕ
                                             
                                                d
                                                ,
                                                n
                                                ,
                                                k
                                             
                                          
                                          
                                             
                                                ψ
                                                
                                                   
                                                      γ
                                                      
                                                         d
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                -
                                                ψ
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         K
                                                      
                                                      ‍
                                                      
                                                         γ
                                                         
                                                            d
                                                            ,
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             ϕ
                                             
                                                d
                                                ,
                                                n
                                                ,
                                                k
                                             
                                          
                                          log
                                          
                                             
                                                ρ
                                                
                                                   
                                                      c
                                                      d
                                                   
                                                   ,
                                                   k
                                                   ,
                                                   n
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          +
                                          
                                             ϕ
                                             
                                                d
                                                ,
                                                n
                                                ,
                                                k
                                             
                                          
                                          
                                             ∑
                                             
                                                m
                                                =
                                                1
                                             
                                             M
                                          
                                          ‍
                                          
                                             
                                                
                                                   s
                                                   
                                                      d
                                                      ,
                                                      m
                                                   
                                                
                                                
                                                   λ
                                                   
                                                      d
                                                      ,
                                                      m
                                                      ,
                                                      n
                                                   
                                                
                                                log
                                                
                                                   
                                                      ξ
                                                      
                                                         
                                                            c
                                                            d
                                                         
                                                         ,
                                                         k
                                                         ,
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             ϕ
                                             
                                                d
                                                ,
                                                n
                                                ,
                                                k
                                             
                                          
                                          log
                                          
                                             ϕ
                                             
                                                d
                                                ,
                                                n
                                                ,
                                                k
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

Taking the derivative with respect to ϕ
                        
                           d
                           ,
                           n
                           ,
                           k
                        , we obtain
                           
                              
                                 
                                    
                                       ∂
                                       L
                                    
                                    
                                       ∂
                                       
                                          ϕ
                                          
                                             d
                                             ,
                                             n
                                             ,
                                             k
                                          
                                       
                                    
                                 
                                 =
                                 ψ
                                 
                                    
                                       γ
                                       
                                          d
                                          ,
                                          k
                                       
                                    
                                 
                                 -
                                 ψ
                                 
                                    
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          K
                                       
                                       ‍
                                       
                                          γ
                                          
                                             d
                                             ,
                                             j
                                          
                                       
                                    
                                 
                                 +
                                 log
                                 
                                    
                                       ρ
                                       
                                          
                                             c
                                             d
                                          
                                          ,
                                          k
                                          ,
                                          n
                                       
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       m
                                       =
                                       1
                                    
                                    M
                                 
                                 ‍
                                 
                                    s
                                    
                                       d
                                       ,
                                       m
                                    
                                 
                                 
                                    λ
                                    
                                       d
                                       ,
                                       m
                                       ,
                                       n
                                    
                                 
                                 log
                                 
                                    
                                       ξ
                                       
                                          
                                             c
                                             d
                                          
                                          ,
                                          k
                                          ,
                                          m
                                       
                                    
                                 
                                 -
                                 log
                                 
                                    ϕ
                                    
                                       d
                                       ,
                                       n
                                       ,
                                       k
                                    
                                 
                                 .
                              
                           
                        
                     

Similarly, by setting 
                           
                              
                                 ∂
                                 L
                              
                              
                                 ∂
                                 
                                    ϕ
                                    
                                       d
                                       ,
                                       n
                                       ,
                                       k
                                    
                                 
                              
                           
                           =
                           0
                        , we obtain the estimation of ϕ
                        
                           d
                           ,
                           n
                           ,
                           k
                         as follows:
                           
                              
                                 
                                    ϕ
                                    
                                       d
                                       ,
                                       n
                                       ,
                                       k
                                    
                                 
                                 ∝
                                 
                                    ρ
                                    
                                       
                                          c
                                          d
                                       
                                       ,
                                       k
                                       ,
                                       n
                                    
                                 
                                 exp
                                 
                                    
                                       ψ
                                       
                                          
                                             γ
                                             
                                                d
                                                ,
                                                k
                                             
                                          
                                       
                                       -
                                       ψ
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                K
                                             
                                             ‍
                                             
                                                γ
                                                
                                                   d
                                                   ,
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                                 exp
                                 
                                    
                                       
                                          ∑
                                          
                                             m
                                             =
                                             1
                                          
                                          M
                                       
                                       ‍
                                       
                                          s
                                          
                                             d
                                             ,
                                             m
                                          
                                       
                                       
                                          λ
                                          
                                             d
                                             ,
                                             m
                                             ,
                                             n
                                          
                                       
                                       log
                                       
                                          
                                             ξ
                                             
                                                
                                                   c
                                                   d
                                                
                                                ,
                                                k
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

The relevant parts about λ
                        
                           d
                           ,
                           m
                           ,
                           n
                         are given by
                           
                              
                                 L
                                 
                                    
                                       λ
                                       
                                          d
                                          ,
                                          m
                                          ,
                                          n
                                       
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 ‍
                                 
                                    x
                                    
                                       d
                                       ,
                                       n
                                    
                                 
                                 
                                    s
                                    
                                       d
                                       ,
                                       m
                                    
                                 
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       
                                          
                                             p
                                             
                                                w
                                                
                                                   d
                                                   ,
                                                   m
                                                   ,
                                                   n
                                                   ,
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    x
                                    
                                       d
                                       ,
                                       n
                                    
                                 
                                 
                                    s
                                    
                                       d
                                       ,
                                       m
                                    
                                 
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       q
                                       
                                          
                                             λ
                                             
                                                d
                                                ,
                                                m
                                                ,
                                                n
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Use the multinomial distribution on λ
                        
                           d
                           ,
                           m
                           ,
                           n
                         and put ξ
                        
                           c
                           
                              d
                           
                           ,
                           k
                           ,
                           m
                         into pw
                        
                           d
                           ,
                           m
                           ,
                           n
                           ,
                           k
                        ,
                           
                              
                                 L
                                 
                                    
                                       λ
                                       
                                          d
                                          ,
                                          m
                                          ,
                                          n
                                       
                                    
                                 
                                 =
                                 
                                    λ
                                    
                                       d
                                       ,
                                       m
                                       ,
                                       n
                                    
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 ‍
                                 
                                    ϕ
                                    
                                       d
                                       ,
                                       n
                                       ,
                                       k
                                    
                                 
                                 log
                                 
                                    
                                       ξ
                                       
                                          
                                             c
                                             d
                                          
                                          ,
                                          k
                                          ,
                                          m
                                       
                                    
                                 
                                 -
                                 
                                    λ
                                    
                                       d
                                       ,
                                       m
                                       ,
                                       n
                                    
                                 
                                 log
                                 
                                    λ
                                    
                                       d
                                       ,
                                       m
                                       ,
                                       n
                                    
                                 
                                 .
                              
                           
                        
                     

By taking the derivative with respect to λ
                        
                           d
                           ,
                           m
                           ,
                           n
                        , we obtain
                           
                              
                                 
                                    
                                       ∂
                                       L
                                    
                                    
                                       ∂
                                       
                                          λ
                                          
                                             d
                                             ,
                                             m
                                             ,
                                             n
                                          
                                       
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 ‍
                                 
                                    ϕ
                                    
                                       d
                                       ,
                                       n
                                       ,
                                       k
                                    
                                 
                                 log
                                 
                                    
                                       ξ
                                       
                                          
                                             c
                                             d
                                          
                                          ,
                                          k
                                          ,
                                          m
                                       
                                    
                                 
                                 -
                                 log
                                 
                                    λ
                                    
                                       d
                                       ,
                                       m
                                       ,
                                       n
                                    
                                 
                                 .
                              
                           
                        
                     

Moreover, by setting 
                           
                              
                                 ∂
                                 L
                              
                              
                                 ∂
                                 
                                    λ
                                    
                                       d
                                       ,
                                       m
                                       ,
                                       n
                                    
                                 
                              
                           
                           =
                           0
                        , we have
                           
                              
                                 
                                    λ
                                    
                                       d
                                       ,
                                       m
                                       ,
                                       n
                                    
                                 
                                 ∝
                                 exp
                                 
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          K
                                       
                                       ‍
                                       
                                          ϕ
                                          
                                             d
                                             ,
                                             n
                                             ,
                                             k
                                          
                                       
                                       log
                                       
                                          
                                             ξ
                                             
                                                
                                                   c
                                                   d
                                                
                                                ,
                                                k
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Let ζ
                        
                           d
                           ,
                           m
                           ,
                           k
                        
                        =∑
                           n
                           =1
                        
                           N
                        
                        ‍λ
                        
                           d
                           ,
                           m
                           ,
                           n
                        
                        ×
                        ϕ
                        
                           d
                           ,
                           n
                           ,
                           k
                         and ζ
                        
                           d
                           ,
                           m
                           ,
                           k
                         describe the relationship of the m-th annotation term and the k-th topic in the d-th image, ζ
                        
                           d
                           ,
                           m
                           ,
                           k
                         and ϕ
                        
                           d
                           ,
                           n
                           ,
                           k
                         will be used in the M-step.


                        
                           
                              
                                 L
                                 
                                    
                                       η
                                       k
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       d
                                       =
                                       1
                                    
                                    D
                                 
                                 ‍
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 ‍
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       
                                          
                                             p
                                             
                                                v
                                                
                                                   d
                                                   ,
                                                   n
                                                   ,
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 ‍
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       p
                                       
                                          
                                             η
                                             k
                                          
                                          
                                             τ
                                             k
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Use the normal distribution assumption on 
                           η
                        
                        
                           k
                        ,
                           
                              
                                 
                                    
                                       
                                          L
                                          
                                             
                                                η
                                                k
                                             
                                          
                                          =
                                          
                                             ∑
                                             
                                                d
                                                =
                                                1
                                             
                                             D
                                          
                                          ‍
                                          
                                             ∑
                                             
                                                n
                                                =
                                                1
                                             
                                             N
                                          
                                          ‍
                                          
                                             x
                                             
                                                d
                                                ,
                                                n
                                             
                                          
                                          
                                             ϕ
                                             
                                                d
                                                ,
                                                n
                                                ,
                                                k
                                             
                                          
                                          
                                             η
                                             
                                                k
                                                ,
                                                n
                                             
                                          
                                          -
                                          
                                             μ
                                             k
                                          
                                          
                                             ∑
                                             
                                                c
                                                =
                                                1
                                             
                                             C
                                          
                                          ‍
                                          log
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                ‍
                                                exp
                                                
                                                   
                                                      
                                                         f
                                                         i
                                                      
                                                      +
                                                      
                                                         η
                                                         
                                                            c
                                                            ,
                                                            i
                                                         
                                                      
                                                      +
                                                      
                                                         η
                                                         
                                                            k
                                                            ,
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          -
                                          
                                             η
                                             k
                                             T
                                          
                                          diag
                                          
                                             
                                                
                                                   E
                                                   q
                                                
                                                
                                                   
                                                      τ
                                                      k
                                                      
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             η
                                             k
                                          
                                          /
                                          2
                                          ,
                                       
                                    
                                 
                              
                           
                        where μ
                        
                           k
                        
                        =∑
                           d
                           =1
                        
                           D
                        
                        ‍∑
                           n
                           =1
                        
                           N
                        
                        ‍x
                        
                           d
                           ,
                           n
                        
                        ϕ
                        
                           d
                           ,
                           n
                           ,
                           k
                        , 
                           diag
                           
                              
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       τ
                                       k
                                       
                                          -
                                          1
                                       
                                    
                                 
                              
                           
                         is a diagonal matrix where its main diagonal entry is given by 
                           
                              E
                              q
                           
                           
                              
                                 τ
                                 k
                                 
                                    -
                                    1
                                 
                              
                           
                        , and ·
                           T
                         denotes a transpose of a vector.


                        
                           L
                           
                              
                                 η
                                 k
                              
                           
                         should be maximized, the calculation of the gradient 
                           
                              
                                 ∂
                                 L
                              
                              
                                 ∂
                                 
                                    η
                                    k
                                 
                              
                           
                         is given by
                           
                              
                                 
                                    
                                       ∂
                                       L
                                    
                                    
                                       ∂
                                       
                                          η
                                          k
                                       
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       d
                                       =
                                       1
                                    
                                    D
                                 
                                 ‍
                                 
                                    x
                                    
                                       d
                                       ,
                                       n
                                    
                                 
                                 
                                    ϕ
                                    
                                       d
                                       ,
                                       k
                                    
                                 
                                 -
                                 
                                    μ
                                    k
                                 
                                 
                                    β
                                    k
                                 
                                 -
                                 diag
                                 
                                    
                                       
                                          E
                                          q
                                       
                                       
                                          
                                             τ
                                             k
                                             
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    η
                                    k
                                 
                                 ,
                              
                           
                        where 
                           β
                        
                        
                           k
                        
                        ={β
                        
                           k
                           ,
                           n
                        }=∑
                           c
                           =1
                        
                           C
                        
                        ‍
                        
                           ρ
                        
                        
                           c
                           ,
                           k
                        . The Hessian matrix 
                           H
                        (
                           η
                        
                        
                           k
                        ) and inverse matrix 
                           H
                        
                        -1(
                           η
                        
                        
                           k
                        ) are
                           
                              
                                 
                                    
                                       
                                          H
                                          
                                             
                                                η
                                                k
                                             
                                          
                                          =
                                          
                                             μ
                                             k
                                          
                                          
                                             β
                                             k
                                          
                                          
                                             β
                                             k
                                             T
                                          
                                          -
                                          diag
                                          
                                             
                                                
                                                   μ
                                                   k
                                                
                                                
                                                   β
                                                   k
                                                
                                                +
                                                
                                                   E
                                                   q
                                                
                                                
                                                   
                                                      τ
                                                      k
                                                      
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             H
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                η
                                                k
                                             
                                          
                                          =
                                          
                                             A
                                             k
                                          
                                          -
                                          
                                             
                                                μ
                                                
                                                   A
                                                   k
                                                
                                                
                                                   β
                                                   k
                                                
                                             
                                             
                                                1
                                                +
                                                μ
                                                
                                                   β
                                                   k
                                                   T
                                                
                                                
                                                   A
                                                   k
                                                
                                                
                                                   β
                                                   k
                                                
                                             
                                          
                                          
                                             β
                                             k
                                             T
                                          
                                          
                                             A
                                             k
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        where μ
                        =∑
                           k
                           =1
                        
                           K
                        
                        ‍μ
                        
                           k
                         and 
                           
                              A
                              k
                           
                           =
                           diag
                           
                              
                                 -
                                 
                                    
                                       
                                          μ
                                          
                                             β
                                             k
                                          
                                          +
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                τ
                                                k
                                                
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                              
                           
                        . And then the Newton direction Δ
                           η
                        
                        
                           k
                         is
                           
                              
                                 Δ
                                 
                                    η
                                    k
                                 
                                 =
                                 -
                                 
                                    A
                                    k
                                 
                                 
                                    
                                       ∂
                                       L
                                    
                                    
                                       ∂
                                       
                                          η
                                          k
                                       
                                    
                                 
                                 +
                                 
                                    
                                       μ
                                       
                                          A
                                          k
                                       
                                       
                                          β
                                          k
                                       
                                    
                                    
                                       1
                                       +
                                       μ
                                       
                                          β
                                          k
                                          T
                                       
                                       
                                          A
                                          k
                                       
                                       
                                          β
                                          k
                                       
                                    
                                 
                                 
                                    β
                                    k
                                    T
                                 
                                 
                                    A
                                    k
                                 
                                 
                                    
                                       ∂
                                       L
                                    
                                    
                                       ∂
                                       
                                          η
                                          k
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

We should compute 
                           
                              E
                              q
                           
                           
                              
                                 τ
                                 k
                                 
                                    -
                                    1
                                 
                              
                           
                         in 
                           
                              
                                 ∂
                                 L
                              
                              
                                 ∂
                                 
                                    η
                                    k
                                 
                              
                           
                         and Δ
                           η
                        
                        
                           k
                        . The posterior distribution q(
                           τ
                        
                        
                           k
                        ) can be factored by q(
                           τ
                        
                        
                           k
                        )=∏
                           n
                           =1
                        
                           N
                        
                        ‍q(τ
                        
                           k
                           ,
                           n
                        ), and Gamma distribution for q(τ
                        
                           k
                           ,
                           n
                        ) can be introduced as [20],
                           
                              
                                 q
                                 
                                    
                                       τ
                                       
                                          k
                                          ,
                                          n
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          τ
                                          
                                             k
                                             ,
                                             n
                                          
                                          
                                             a
                                             -
                                             1
                                          
                                       
                                       exp
                                       
                                          
                                             -
                                             
                                                τ
                                                
                                                   k
                                                   ,
                                                   n
                                                
                                             
                                             /
                                             b
                                          
                                       
                                    
                                    
                                       Γ
                                       
                                          a
                                       
                                       
                                          b
                                          a
                                       
                                    
                                 
                                 ,
                              
                           
                        where a and b are the parameters of Gamma distribution. The variational bound with respect to τ
                        
                           k
                           ,
                           n
                         is given by
                           
                              
                                 L
                                 
                                    
                                       τ
                                       
                                          k
                                          ,
                                          n
                                       
                                    
                                 
                                 =
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       p
                                       
                                          
                                             η
                                             
                                                k
                                                ,
                                                n
                                             
                                          
                                          0
                                          
                                             τ
                                             
                                                k
                                                ,
                                                n
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       p
                                       
                                          
                                             τ
                                             
                                                k
                                                ,
                                                n
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       q
                                       
                                          
                                             τ
                                             
                                                k
                                                ,
                                                n
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

As the prior on τ
                        
                           k
                           ,
                           n
                         is Jeffrey's prior,
                           
                              
                                 
                                    
                                       
                                          L
                                          
                                             
                                                τ
                                                
                                                   k
                                                   ,
                                                   n
                                                
                                             
                                          
                                          ∝
                                          -
                                          
                                             1
                                             2
                                          
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                
                                                   τ
                                                   
                                                      k
                                                      ,
                                                      n
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             1
                                             2
                                          
                                          
                                             η
                                             
                                                k
                                                ,
                                                n
                                             
                                             2
                                          
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                τ
                                                
                                                   k
                                                   ,
                                                   n
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                          
                                          -
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                
                                                   τ
                                                   
                                                      k
                                                      ,
                                                      n
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                a
                                                -
                                                1
                                             
                                          
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                
                                                   τ
                                                   
                                                      k
                                                      ,
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          +
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                τ
                                                
                                                   k
                                                   ,
                                                   n
                                                
                                             
                                          
                                          /
                                          b
                                          +
                                          log
                                          Γ
                                          
                                             a
                                          
                                          +
                                          a
                                          log
                                          b
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

According to the properties of Gamma distribution, we have 
                           
                              E
                              q
                           
                           
                              
                                 τ
                                 
                                    k
                                    ,
                                    n
                                 
                              
                           
                           =
                           ab
                        , 
                           
                              E
                              q
                           
                           
                              
                                 τ
                                 
                                    k
                                    ,
                                    n
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                           =
                           
                              1
                              
                                 
                                    
                                       a
                                       -
                                       1
                                    
                                 
                                 b
                              
                           
                        , 
                           
                           
                              E
                              q
                           
                           
                              
                                 log
                                 
                                    τ
                                    
                                       k
                                       ,
                                       n
                                    
                                 
                              
                           
                           =
                           ψ
                           
                              a
                           
                           +
                           log
                           
                              b
                           
                           .
                        
                        
                           
                              
                                 L
                                 
                                    
                                       τ
                                       
                                          k
                                          ,
                                          n
                                       
                                    
                                 
                                 ∝
                                 -
                                 
                                    
                                       a
                                       +
                                       
                                          1
                                          2
                                       
                                    
                                 
                                 
                                    
                                       ψ
                                       
                                          a
                                       
                                       +
                                       log
                                       b
                                    
                                 
                                 -
                                 
                                    1
                                    2
                                 
                                 
                                    η
                                    
                                       k
                                       ,
                                       n
                                    
                                    2
                                 
                                 
                                    
                                       
                                          
                                             
                                                a
                                                -
                                                1
                                             
                                          
                                          b
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 +
                                 a
                                 +
                                 log
                                 Γ
                                 
                                    a
                                 
                                 +
                                 a
                                 log
                                 b
                                 .
                              
                           
                        
                     

By setting 
                           
                              
                                 ∂
                                 L
                              
                              
                                 ∂
                                 b
                              
                           
                           =
                           0
                        , we can get the closed form solution of b as 
                           b
                           =
                           
                              
                                 η
                                 
                                    k
                                    ,
                                    n
                                 
                                 2
                              
                              
                                 a
                                 -
                                 1
                              
                           
                        . It implies that 
                           
                              E
                              q
                           
                           
                              
                                 τ
                                 
                                    k
                                    ,
                                    n
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                           =
                           
                              1
                              
                                 
                                    
                                       a
                                       -
                                       1
                                    
                                 
                                 b
                              
                           
                           =
                           
                              1
                              
                                 η
                                 
                                    k
                                    ,
                                    n
                                 
                                 2
                              
                           
                         and then 
                           
                              E
                              q
                           
                           
                              
                                 τ
                                 k
                                 
                                    -
                                    1
                                 
                              
                           
                           =
                           
                              1
                              
                                 η
                                 k
                                 2
                              
                           
                         . According to this computation, 
                           
                              
                                 ∂
                                 L
                              
                              
                                 ∂
                                 
                                    η
                                    k
                                 
                              
                           
                         and Δ
                           η
                        
                        
                           k
                         can be directly computed.


                        
                           
                              
                                 L
                                 
                                    
                                       η
                                       c
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       d
                                       =
                                       1
                                       ∧
                                       
                                          c
                                          d
                                       
                                       =
                                       c
                                    
                                    D
                                 
                                 ‍
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 ‍
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 ‍
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       
                                          
                                             p
                                             
                                                v
                                                
                                                   d
                                                   ,
                                                   n
                                                   ,
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 ‍
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       p
                                       
                                          
                                             η
                                             c
                                          
                                          
                                             τ
                                             c
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Use the normal distribution assumption on 
                           η
                        
                        
                           c
                        ,
                           
                              
                                 
                                    
                                       
                                          L
                                          
                                             
                                                η
                                                c
                                             
                                          
                                          =
                                          
                                             ∑
                                             
                                                d
                                                =
                                                1
                                                ∧
                                                
                                                   c
                                                   d
                                                
                                                =
                                                c
                                             
                                             D
                                          
                                          ‍
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          ‍
                                          
                                             ∑
                                             
                                                n
                                                =
                                                1
                                             
                                             N
                                          
                                          ‍
                                          
                                             x
                                             
                                                d
                                                ,
                                                n
                                             
                                          
                                          
                                             ϕ
                                             
                                                d
                                                ,
                                                n
                                                ,
                                                k
                                             
                                          
                                          
                                             η
                                             
                                                c
                                                ,
                                                n
                                             
                                          
                                          -
                                          
                                             e
                                             c
                                          
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          ‍
                                          log
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                ‍
                                                exp
                                                
                                                   
                                                      
                                                         f
                                                         i
                                                      
                                                      +
                                                      
                                                         η
                                                         
                                                            c
                                                            ,
                                                            i
                                                         
                                                      
                                                      +
                                                      
                                                         η
                                                         
                                                            k
                                                            ,
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          -
                                          
                                             η
                                             c
                                             T
                                          
                                          diag
                                          
                                             
                                                
                                                   E
                                                   q
                                                
                                                
                                                   
                                                      τ
                                                      c
                                                      
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             η
                                             c
                                          
                                          /
                                          2
                                          ,
                                       
                                    
                                 
                              
                           
                        where e
                        
                           c
                        
                        =∑
                           d
                           =1∧
                           c
                           
                              d
                           
                           =
                           c
                        
                        
                           D
                        
                        ‍∑
                           k
                           =1
                        
                           K
                        
                        ‍∑
                           n
                           =1
                        
                           N
                        
                        ‍x
                        
                           d
                           ,
                           n
                        
                        ϕ
                        
                           d
                           ,
                           n
                           ,
                           k
                        . 
                           L
                           
                              
                                 η
                                 c
                              
                           
                         should be maximized, the calculation of the gradient 
                           
                              
                                 ∂
                                 L
                              
                              
                                 ∂
                                 
                                    η
                                    c
                                 
                              
                           
                         and Δ
                           η
                        
                        
                           c
                         are given by
                           
                              
                                 
                                    
                                       ∂
                                       L
                                    
                                    
                                       ∂
                                       
                                          η
                                          c
                                       
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       d
                                       =
                                       1
                                       ∧
                                       
                                          c
                                          d
                                       
                                       =
                                       c
                                    
                                    D
                                 
                                 ‍
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 ‍
                                 
                                    x
                                    
                                       d
                                       ,
                                       n
                                    
                                 
                                 
                                    ϕ
                                    
                                       d
                                       ,
                                       k
                                    
                                 
                                 -
                                 
                                    e
                                    c
                                 
                                 
                                    β
                                    c
                                 
                                 -
                                 diag
                                 
                                    
                                       
                                          E
                                          q
                                       
                                       
                                          
                                             τ
                                             c
                                             
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    η
                                    c
                                 
                              
                           
                        and
                           
                              
                                 Δ
                                 
                                    η
                                    c
                                 
                                 =
                                 -
                                 
                                    A
                                    c
                                 
                                 
                                    
                                       ∂
                                       L
                                    
                                    
                                       ∂
                                       
                                          η
                                          c
                                       
                                    
                                 
                                 +
                                 
                                    
                                       e
                                       
                                          A
                                          c
                                       
                                       
                                          β
                                          c
                                       
                                    
                                    
                                       1
                                       +
                                       e
                                       
                                          β
                                          c
                                          T
                                       
                                       
                                          A
                                          c
                                       
                                       
                                          β
                                          c
                                       
                                    
                                 
                                 
                                    β
                                    c
                                    T
                                 
                                 
                                    A
                                    c
                                 
                                 
                                    
                                       ∂
                                       L
                                    
                                    
                                       ∂
                                       
                                          η
                                          c
                                       
                                    
                                 
                                 ,
                              
                           
                        where e
                        =∑
                           c
                           =1
                        
                           C
                        
                        ‍e
                        
                           c
                        , 
                           β
                        
                        
                           c
                        
                        =∑
                           k
                           =1
                        
                           K
                        
                        ‍
                        
                           ρ
                        
                        
                           c
                           ,
                           k
                         and 
                           
                              A
                              c
                           
                           =
                           diag
                           
                              
                                 -
                                 
                                    
                                       
                                          e
                                          
                                             β
                                             c
                                          
                                          +
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                τ
                                                c
                                                
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                              
                           
                        .

To compute the term 
                           
                              E
                              q
                           
                           
                              
                                 τ
                                 c
                                 
                                    -
                                    1
                                 
                              
                           
                        , we first factor the distribution q(
                           η
                        
                        
                           c
                        )=∏
                           n
                           =1
                        
                           N
                        
                        ‍q(τ
                        
                           c
                           ,
                           n
                        ), and introduce Gamma distribution for q(τ
                        
                           c
                           ,
                           n
                        )
                           
                              
                                 q
                                 
                                    
                                       τ
                                       
                                          c
                                          ,
                                          n
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          τ
                                          
                                             c
                                             ,
                                             n
                                          
                                          
                                             h
                                             -
                                             1
                                          
                                       
                                       exp
                                       
                                          
                                             -
                                             
                                                τ
                                                
                                                   c
                                                   ,
                                                   n
                                                
                                             
                                             /
                                             l
                                          
                                       
                                    
                                    
                                       Γ
                                       
                                          h
                                       
                                       
                                          l
                                          h
                                       
                                    
                                 
                                 ,
                              
                           
                        where h and l are the parameters of Gamma distribution. The variational bound with respect to τ
                        
                           c
                           ,
                           n
                         is given by
                           
                              
                                 L
                                 
                                    
                                       τ
                                       
                                          c
                                          ,
                                          n
                                       
                                    
                                 
                                 =
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       p
                                       
                                          
                                             η
                                             
                                                c
                                                ,
                                                n
                                             
                                          
                                          0
                                          
                                             τ
                                             
                                                c
                                                ,
                                                n
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       p
                                       
                                          
                                             τ
                                             
                                                c
                                                ,
                                                n
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       q
                                       
                                          
                                             τ
                                             
                                                c
                                                ,
                                                n
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

As the prior on τ
                        
                           c
                           ,
                           n
                         is Jeffrey's prior,
                           
                              
                                 
                                    
                                       
                                          L
                                          
                                             
                                                τ
                                                
                                                   c
                                                   ,
                                                   n
                                                
                                             
                                          
                                          ∝
                                          -
                                          
                                             1
                                             2
                                          
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                
                                                   τ
                                                   
                                                      c
                                                      ,
                                                      n
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             1
                                             2
                                          
                                          
                                             η
                                             
                                                c
                                                ,
                                                n
                                             
                                             2
                                          
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                τ
                                                
                                                   c
                                                   ,
                                                   n
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                          
                                          -
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                
                                                   τ
                                                   
                                                      c
                                                      ,
                                                      n
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                h
                                                -
                                                1
                                             
                                          
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                
                                                   τ
                                                   
                                                      c
                                                      ,
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          +
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                τ
                                                
                                                   c
                                                   ,
                                                   n
                                                
                                             
                                          
                                          /
                                          l
                                          +
                                          log
                                          Γ
                                          
                                             h
                                          
                                          +
                                          h
                                          log
                                          l
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

According to the properties of Gamma distribution, we have 
                           
                              E
                              q
                           
                           
                              
                                 τ
                                 
                                    c
                                    ,
                                    n
                                 
                              
                           
                           =
                           hl
                        , 
                           
                              E
                              q
                           
                           
                              
                                 τ
                                 
                                    c
                                    ,
                                    n
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                           =
                           
                              1
                              
                                 
                                    
                                       h
                                       -
                                       1
                                    
                                 
                                 l
                              
                           
                        , 
                           
                           
                              E
                              q
                           
                           
                              
                                 log
                                 
                                    τ
                                    
                                       c
                                       ,
                                       n
                                    
                                 
                              
                           
                           =
                           ψ
                           
                              h
                           
                           +
                           log
                           
                              l
                           
                           .
                        
                        
                           
                              
                                 L
                                 
                                    
                                       τ
                                       
                                          c
                                          ,
                                          n
                                       
                                    
                                 
                                 ∝
                                 -
                                 
                                    
                                       h
                                       +
                                       
                                          1
                                          2
                                       
                                    
                                 
                                 
                                    
                                       ψ
                                       
                                          h
                                       
                                       +
                                       log
                                       l
                                    
                                 
                                 -
                                 
                                    1
                                    2
                                 
                                 
                                    η
                                    
                                       c
                                       ,
                                       n
                                    
                                    2
                                 
                                 
                                    
                                       
                                          
                                             
                                                h
                                                -
                                                1
                                             
                                          
                                          l
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 +
                                 h
                                 +
                                 log
                                 Γ
                                 
                                    h
                                 
                                 +
                                 h
                                 log
                                 l
                                 .
                              
                           
                        
                     

By setting 
                           
                              
                                 ∂
                                 L
                              
                              
                                 ∂
                                 l
                              
                           
                           =
                           0
                        , we can get the closed form solution of l as 
                           l
                           =
                           
                              
                                 η
                                 
                                    c
                                    ,
                                    n
                                 
                                 2
                              
                              
                                 h
                                 -
                                 1
                              
                           
                        . 
                           
                              E
                              q
                           
                           
                              
                                 τ
                                 
                                    c
                                    ,
                                    n
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                           =
                           
                              1
                              
                                 
                                    
                                       h
                                       -
                                       1
                                    
                                 
                                 l
                              
                           
                           =
                           
                              1
                              
                                 η
                                 
                                    c
                                    ,
                                    n
                                 
                                 2
                              
                           
                        , and then 
                           
                              E
                              q
                           
                           
                              
                                 τ
                                 c
                                 
                                    -
                                    1
                                 
                              
                           
                           =
                           
                              1
                              
                                 η
                                 c
                                 2
                              
                           
                        . According to this computation, the gradient 
                           
                              
                                 ∂
                                 L
                              
                              
                                 ∂
                                 
                                    η
                                    c
                                 
                              
                           
                         and the Newton direction Δ
                           η
                        
                        
                           c
                         can be directly computed.


                        
                           
                              
                                 L
                                 
                                    
                                       ω
                                       k
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       d
                                       =
                                       1
                                    
                                    D
                                 
                                 ‍
                                 
                                    ∑
                                    
                                       m
                                       =
                                       1
                                    
                                    M
                                 
                                 ‍
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       
                                          
                                             p
                                             
                                                w
                                                
                                                   d
                                                   ,
                                                   m
                                                   ,
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       m
                                       =
                                       1
                                    
                                    M
                                 
                                 ‍
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       p
                                       
                                          
                                             ω
                                             k
                                          
                                          
                                             π
                                             k
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Use the normal distribution assumption on 
                           ω
                        
                        
                           k
                        ,
                           
                              
                                 
                                    
                                       
                                          L
                                          
                                             
                                                ω
                                                k
                                             
                                          
                                          =
                                          
                                             ∑
                                             
                                                d
                                                =
                                                1
                                             
                                             D
                                          
                                          ‍
                                          
                                             ∑
                                             
                                                m
                                                =
                                                1
                                             
                                             M
                                          
                                          ‍
                                          
                                             s
                                             
                                                d
                                                ,
                                                m
                                             
                                          
                                          
                                             ζ
                                             
                                                d
                                                ,
                                                m
                                                ,
                                                k
                                             
                                          
                                          
                                             ω
                                             
                                                k
                                                ,
                                                m
                                             
                                          
                                          -
                                          
                                             o
                                             k
                                          
                                          
                                             ∑
                                             
                                                c
                                                =
                                                1
                                             
                                             C
                                          
                                          ‍
                                          log
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   M
                                                
                                                ‍
                                                exp
                                                
                                                   
                                                      
                                                         g
                                                         i
                                                      
                                                      +
                                                      
                                                         ω
                                                         
                                                            
                                                               c
                                                               d
                                                            
                                                            ,
                                                            i
                                                         
                                                      
                                                      +
                                                      
                                                         ω
                                                         
                                                            k
                                                            ,
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          -
                                          
                                             ω
                                             k
                                             T
                                          
                                          d
                                          iag
                                          
                                             
                                                
                                                   E
                                                   q
                                                
                                                
                                                   
                                                      π
                                                      k
                                                      
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ω
                                             k
                                          
                                          /
                                          2
                                          ,
                                       
                                    
                                 
                              
                           
                        where o
                        
                           k
                        
                        =∑
                           d
                           =1
                        
                           D
                        
                        ‍∑
                           m
                           =1
                        
                           M
                        
                        ‍s
                        
                           d
                           ,
                           m
                        
                        ζ
                        
                           d
                           ,
                           m
                           ,
                           k
                        . 
                           L
                           
                              
                                 ω
                                 k
                              
                           
                         should be maximized, the calculation of the gradient 
                           
                              
                                 ∂
                                 L
                              
                              
                                 ∂
                                 
                                    ω
                                    k
                                 
                              
                           
                         and the Newton direction Δ
                           ω
                        
                        
                           k
                         are given by
                           
                              
                                 
                                    
                                       ∂
                                       L
                                    
                                    
                                       ∂
                                       
                                          ω
                                          k
                                       
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       d
                                       =
                                       1
                                    
                                    D
                                 
                                 ‍
                                 
                                    s
                                    
                                       d
                                       ,
                                       m
                                    
                                 
                                 
                                    ζ
                                    
                                       d
                                       ,
                                       k
                                    
                                 
                                 -
                                 
                                    o
                                    k
                                 
                                 
                                    σ
                                    k
                                 
                                 -
                                 diag
                                 
                                    
                                       
                                          E
                                          q
                                       
                                       
                                          
                                             π
                                             k
                                             
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    ω
                                    k
                                 
                              
                           
                        and
                           
                              
                                 Δ
                                 
                                    ω
                                    k
                                 
                                 =
                                 -
                                 
                                    B
                                    k
                                 
                                 
                                    
                                       ∂
                                       L
                                    
                                    
                                       ∂
                                       
                                          ω
                                          k
                                       
                                    
                                 
                                 +
                                 
                                    
                                       o
                                       
                                          B
                                          k
                                       
                                       
                                          β
                                          k
                                       
                                    
                                    
                                       1
                                       +
                                       o
                                       
                                          β
                                          k
                                          T
                                       
                                       
                                          B
                                          k
                                       
                                       
                                          β
                                          k
                                       
                                    
                                 
                                 
                                    β
                                    k
                                    T
                                 
                                 
                                    B
                                    k
                                 
                                 
                                    
                                       ∂
                                       L
                                    
                                    
                                       ∂
                                       
                                          ω
                                          k
                                       
                                    
                                 
                                 ,
                              
                           
                        where o
                        =∑
                           k
                           =1
                        
                           K
                        
                        ‍o
                        
                           k
                        , 
                           σ
                        
                        
                           k
                        
                        =∑
                           c
                           =1
                        
                           C
                        
                        ‍
                        
                           ξ
                        
                        
                           c
                           ,
                           k
                         and 
                           
                              B
                              k
                           
                           =
                           diag
                           
                              
                                 -
                                 
                                    
                                       
                                          o
                                          
                                             σ
                                             k
                                          
                                          +
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                π
                                                k
                                                
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                              
                           
                        .

To compute 
                           
                              E
                              q
                           
                           
                              
                                 π
                                 k
                                 
                                    -
                                    1
                                 
                              
                           
                        , we first factor the distribution q(
                           π
                        
                        
                           k
                        )=∏
                           m
                           =1
                        
                           M
                        
                        ‍q(π
                        
                           k
                           ,
                           m
                        ), and introduce Gamma distribution for q(π
                        
                           k
                           ,
                           m
                        )
                           
                              
                                 q
                                 
                                    
                                       π
                                       
                                          k
                                          ,
                                          m
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          π
                                          
                                             k
                                             ,
                                             m
                                          
                                          
                                             r
                                             -
                                             1
                                          
                                       
                                       exp
                                       
                                          
                                             -
                                             
                                                π
                                                
                                                   k
                                                   ,
                                                   m
                                                
                                             
                                             /
                                             t
                                          
                                       
                                    
                                    
                                       Γ
                                       
                                          r
                                       
                                       
                                          t
                                          r
                                       
                                    
                                 
                                 ,
                              
                           
                        where r and t are the parameters of Gamma distribution. The variational bound with respect to π
                        
                           k
                           ,
                           m
                         is given by
                           
                              
                                 L
                                 
                                    
                                       π
                                       
                                          k
                                          ,
                                          m
                                       
                                    
                                 
                                 =
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       p
                                       
                                          
                                             ω
                                             
                                                k
                                                ,
                                                m
                                             
                                          
                                          0
                                          
                                             π
                                             
                                                k
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       p
                                       
                                          
                                             π
                                             
                                                k
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       q
                                       
                                          
                                             π
                                             
                                                k
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

As the prior on π
                        
                           k
                           ,
                           m
                         is Jeffrey's prior,
                           
                              
                                 
                                    
                                       
                                          L
                                          
                                             
                                                π
                                                
                                                   k
                                                   ,
                                                   m
                                                
                                             
                                          
                                          ∝
                                          -
                                          
                                             1
                                             2
                                          
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                
                                                   π
                                                   
                                                      k
                                                      ,
                                                      m
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             1
                                             2
                                          
                                          
                                             ω
                                             
                                                k
                                                ,
                                                m
                                             
                                             2
                                          
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                π
                                                
                                                   k
                                                   ,
                                                   m
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                          
                                          -
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                
                                                   
                                                      
                                                      π
                                                   
                                                   
                                                      k
                                                      ,
                                                      m
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                r
                                                -
                                                1
                                             
                                          
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                
                                                   π
                                                   
                                                      k
                                                      ,
                                                      m
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          +
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                π
                                                
                                                   k
                                                   ,
                                                   m
                                                
                                             
                                          
                                          /
                                          t
                                          +
                                          log
                                          Γ
                                          
                                             r
                                          
                                          +
                                          r
                                          log
                                          t
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

According to the properties of Gamma distribution, we have 
                           
                              E
                              q
                           
                           
                              
                                 π
                                 
                                    k
                                    ,
                                    m
                                 
                              
                           
                           =
                           rt
                        , 
                           
                              E
                              q
                           
                           
                              
                                 π
                                 
                                    k
                                    ,
                                    m
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                           =
                           
                              1
                              
                                 
                                    
                                       r
                                       -
                                       1
                                    
                                 
                                 t
                              
                           
                        , 
                           
                           
                              E
                              q
                           
                           
                              
                                 log
                                 
                                    π
                                    
                                       k
                                       ,
                                       m
                                    
                                 
                              
                           
                           =
                           ψ
                           
                              r
                           
                           +
                           log
                           
                              t
                           
                           .
                        
                        
                           
                              
                                 L
                                 
                                    
                                       π
                                       
                                          k
                                          ,
                                          m
                                       
                                    
                                 
                                 ∝
                                 -
                                 
                                    
                                       r
                                       +
                                       
                                          1
                                          2
                                       
                                    
                                 
                                 
                                    
                                       ψ
                                       
                                          r
                                       
                                       +
                                       log
                                       t
                                    
                                 
                                 
                                    1
                                    2
                                 
                                 
                                    ω
                                    
                                       k
                                       ,
                                       m
                                    
                                    2
                                 
                                 
                                    
                                       
                                          
                                             
                                                r
                                                -
                                                1
                                             
                                          
                                          t
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 +
                                 r
                                 +
                                 log
                                 Γ
                                 
                                    r
                                 
                                 +
                                 r
                                 log
                                 t
                                 .
                              
                           
                        
                     

By setting 
                           
                              
                                 ∂
                                 L
                              
                              
                                 ∂
                                 t
                              
                           
                           =
                           0
                        , we can get the closed form solution of t as 
                           t
                           =
                           
                              
                                 ω
                                 
                                    k
                                    ,
                                    m
                                 
                                 2
                              
                              
                                 r
                                 -
                                 1
                              
                           
                        . 
                           
                              E
                              q
                           
                           
                              
                                 π
                                 
                                    k
                                    ,
                                    m
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                           =
                           
                              1
                              
                                 
                                    
                                       r
                                       -
                                       1
                                    
                                 
                                 t
                              
                           
                           =
                           
                              1
                              
                                 ω
                                 
                                    k
                                    ,
                                    m
                                 
                                 2
                              
                           
                        , then 
                           
                              E
                              q
                           
                           
                              
                                 π
                                 k
                                 
                                    -
                                    1
                                 
                              
                           
                           =
                           
                              1
                              
                                 ω
                                 k
                                 2
                              
                           
                        . According to this computation, the gradient 
                           
                              
                                 ∂
                                 L
                              
                              
                                 ∂
                                 
                                    ω
                                    k
                                 
                              
                           
                         and the Newton direction Δ
                           ω
                        
                        
                           k
                         can be directly computed.


                        
                           
                              
                                 L
                                 
                                    
                                       ω
                                       c
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       d
                                       =
                                       1
                                       ∧
                                       
                                          c
                                          d
                                       
                                       =
                                       c
                                    
                                    D
                                 
                                 ‍
                                 
                                    ∑
                                    
                                       m
                                       =
                                       1
                                    
                                    M
                                 
                                 ‍
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 ‍
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       
                                          
                                             p
                                             
                                                w
                                                
                                                   d
                                                   ,
                                                   m
                                                   ,
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       m
                                       =
                                       1
                                    
                                    M
                                 
                                 ‍
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       p
                                       
                                          
                                             ω
                                             c
                                          
                                          
                                             π
                                             c
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Use the normal distribution assumption on 
                           ω
                        
                        
                           c
                        ,
                           
                              
                                 
                                    
                                       
                                          L
                                          
                                             
                                                ω
                                                c
                                             
                                          
                                          =
                                          
                                             ∑
                                             
                                                d
                                                =
                                                1
                                                ∧
                                                
                                                   c
                                                   d
                                                
                                                =
                                                c
                                             
                                             D
                                          
                                          ‍
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          ‍
                                          
                                             ∑
                                             
                                                m
                                                =
                                                1
                                             
                                             M
                                          
                                          ‍
                                          
                                             s
                                             
                                                d
                                                ,
                                                m
                                             
                                          
                                          
                                             ζ
                                             
                                                d
                                                ,
                                                m
                                                ,
                                                k
                                             
                                          
                                          
                                             ω
                                             
                                                c
                                                ,
                                                m
                                             
                                          
                                          -
                                          
                                             u
                                             c
                                          
                                          log
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          ‍
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   M
                                                
                                                ‍
                                                exp
                                                
                                                   
                                                      
                                                         g
                                                         i
                                                      
                                                      +
                                                      
                                                         ω
                                                         
                                                            c
                                                            ,
                                                            i
                                                         
                                                      
                                                      +
                                                      
                                                         ω
                                                         
                                                            k
                                                            ,
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          -
                                          
                                             ω
                                             c
                                             T
                                          
                                          diag
                                          
                                             
                                                
                                                   E
                                                   q
                                                
                                                
                                                   
                                                      π
                                                      c
                                                      
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ω
                                             c
                                          
                                          /
                                          2
                                          ,
                                       
                                    
                                 
                              
                           
                        where u
                        
                           c
                        
                        =∑
                           d
                           =1∧
                           c
                           
                              d
                           
                           =
                           c
                        
                        
                           D
                        
                        ‍∑
                           k
                           =1
                        
                           K
                        
                        ‍∑
                           m
                           =1
                        
                           M
                        
                        ‍s
                        
                           d
                           ,
                           m
                        
                        ζ
                        
                           d
                           ,
                           m
                           ,
                           k
                        . 
                           L
                           
                              
                                 ω
                                 c
                              
                           
                         should be maximized, the calculation of the gradient 
                           
                              
                                 ∂
                                 L
                              
                              
                                 ∂
                                 
                                    ω
                                    c
                                 
                              
                           
                         and the Newton direction Δ
                           ω
                        
                        
                           c
                         are given by
                           
                              
                                 
                                    
                                       ∂
                                       L
                                    
                                    
                                       ∂
                                       
                                          ω
                                          c
                                       
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       d
                                       =
                                       1
                                       ∧
                                       
                                          c
                                          d
                                       
                                       =
                                       c
                                    
                                    D
                                 
                                 ‍
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 ‍
                                 
                                    s
                                    
                                       d
                                       ,
                                       m
                                    
                                 
                                 
                                    ζ
                                    
                                       d
                                       ,
                                       k
                                    
                                 
                                 -
                                 
                                    u
                                    c
                                 
                                 
                                    σ
                                    c
                                 
                                 -
                                 diag
                                 
                                    
                                       
                                          E
                                          q
                                       
                                       
                                          
                                             π
                                             c
                                             
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    ω
                                    c
                                 
                              
                           
                        and
                           
                              
                                 Δ
                                 
                                    ω
                                    c
                                 
                                 =
                                 -
                                 
                                    B
                                    c
                                 
                                 
                                    
                                       ∂
                                       L
                                    
                                    
                                       ∂
                                       
                                          ω
                                          c
                                       
                                    
                                 
                                 +
                                 
                                    
                                       u
                                       
                                          B
                                          c
                                       
                                       
                                          β
                                          c
                                       
                                    
                                    
                                       1
                                       +
                                       u
                                       
                                          β
                                          c
                                          T
                                       
                                       
                                          B
                                          c
                                       
                                       
                                          β
                                          c
                                       
                                    
                                 
                                 
                                    β
                                    c
                                    T
                                 
                                 
                                    B
                                    c
                                 
                                 
                                    
                                       ∂
                                       L
                                    
                                    
                                       ∂
                                       
                                          η
                                          c
                                       
                                    
                                 
                                 ,
                              
                           
                        where u
                        =∑
                           c
                           =1
                        
                           C
                        
                        ‍u
                        
                           c
                        , 
                           σ
                        
                        
                           c
                        
                        =∑
                           k
                           =1
                        
                           K
                        
                        ‍
                        
                           ξ
                        
                        
                           c
                           ,
                           k
                         and 
                           
                              B
                              c
                           
                           =
                           diag
                           
                              
                                 -
                                 
                                    
                                       
                                          u
                                          
                                             σ
                                             c
                                          
                                          +
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                π
                                                c
                                                
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                              
                           
                        .

To compute the term 
                           
                              E
                              q
                           
                           
                              
                                 π
                                 c
                                 
                                    -
                                    1
                                 
                              
                           
                        , we first factor the distribution q(
                           π
                        
                        
                           c
                        )=∏
                           m
                           =1
                        
                           M
                        
                        ‍q(π
                        
                           c
                           ,
                           m
                        ), and introduce Gamma distribution for q(π
                        
                           c
                           ,
                           m
                        )
                           
                              
                                 q
                                 
                                    
                                       π
                                       
                                          c
                                          ,
                                          m
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          π
                                          
                                             c
                                             ,
                                             m
                                          
                                          
                                             κ
                                             -
                                             1
                                          
                                       
                                       exp
                                       
                                          
                                             -
                                             
                                                π
                                                
                                                   c
                                                   ,
                                                   m
                                                
                                             
                                             /
                                             φ
                                          
                                       
                                    
                                    
                                       Γ
                                       
                                          κ
                                       
                                       
                                          φ
                                          κ
                                       
                                    
                                 
                                 ,
                              
                           
                        where κ and φ are the parameters of Gamma distribution. The variational bound with respect to π
                        
                           c
                           ,
                           m
                         is given by
                           
                              
                                 L
                                 
                                    
                                       π
                                       
                                          c
                                          ,
                                          m
                                       
                                    
                                 
                                 =
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       p
                                       
                                          
                                             ω
                                             
                                                c
                                                ,
                                                m
                                             
                                          
                                          0
                                          
                                             π
                                             
                                                c
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       p
                                       
                                          
                                             π
                                             
                                                c
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    E
                                    q
                                 
                                 
                                    
                                       log
                                       q
                                       
                                          
                                             π
                                             
                                                c
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

As the prior on π
                        
                           c
                           ,
                           m
                         is Jeffrey's prior,
                           
                              
                                 
                                    
                                       
                                          L
                                          
                                             
                                                π
                                                
                                                   c
                                                   ,
                                                   m
                                                
                                             
                                          
                                          ∝
                                          -
                                          
                                             1
                                             2
                                          
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                
                                                   
                                                      
                                                      π
                                                   
                                                   
                                                      c
                                                      ,
                                                      m
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             1
                                             2
                                          
                                          
                                             ω
                                             
                                                c
                                                ,
                                                m
                                             
                                             2
                                          
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                π
                                                
                                                   c
                                                   ,
                                                   m
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                          
                                          -
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                
                                                   π
                                                   
                                                      c
                                                      ,
                                                      m
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                κ
                                                -
                                                1
                                             
                                          
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                log
                                                
                                                   π
                                                   
                                                      c
                                                      ,
                                                      m
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          +
                                          
                                             E
                                             q
                                          
                                          
                                             
                                                π
                                                
                                                   c
                                                   ,
                                                   m
                                                
                                             
                                          
                                          /
                                          φ
                                          +
                                          log
                                          Γ
                                          
                                             κ
                                          
                                          +
                                          κ
                                          log
                                          φ
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

According to the properties of Gamma distribution, we have 
                           
                              E
                              q
                           
                           
                              
                                 π
                                 
                                    c
                                    ,
                                    m
                                 
                              
                           
                           =
                           κφ
                        , 
                           
                              E
                              q
                           
                           
                              
                                 π
                                 
                                    c
                                    ,
                                    m
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                           =
                           
                              1
                              
                                 
                                    
                                       κ
                                       -
                                       1
                                    
                                 
                                 φ
                              
                           
                        , 
                           
                           
                              E
                              q
                           
                           
                              
                                 log
                                 
                                    π
                                    
                                       c
                                       ,
                                       m
                                    
                                 
                              
                           
                           =
                           ψ
                           
                              κ
                           
                           +
                           log
                           
                              φ
                           
                           .
                        
                        
                           
                              
                                 L
                                 
                                    
                                       π
                                       
                                          c
                                          ,
                                          m
                                       
                                    
                                 
                                 ∝
                                 -
                                 
                                    
                                       κ
                                       +
                                       
                                          1
                                          2
                                       
                                    
                                 
                                 
                                    
                                       ψ
                                       
                                          κ
                                       
                                       +
                                       log
                                       φ
                                    
                                 
                                 -
                                 
                                    1
                                    2
                                 
                                 
                                    ω
                                    
                                       c
                                       ,
                                       m
                                    
                                    2
                                 
                                 
                                    
                                       
                                          
                                             
                                                κ
                                                -
                                                1
                                             
                                          
                                          φ
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 +
                                 κ
                                 +
                                 log
                                 Γ
                                 
                                    κ
                                 
                                 +
                                 κ
                                 log
                                 φ
                                 .
                              
                           
                        
                     

By setting 
                           
                              
                                 ∂
                                 L
                              
                              
                                 ∂
                                 φ
                              
                           
                           =
                           0
                        , we can get the closed form solution of φ as 
                           φ
                           =
                           
                              
                                 ω
                                 
                                    c
                                    ,
                                    m
                                 
                                 2
                              
                              
                                 κ
                                 -
                                 1
                              
                           
                        . 
                           
                              E
                              q
                           
                           
                              
                                 π
                                 
                                    c
                                    ,
                                    m
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                           =
                           
                              1
                              
                                 
                                    
                                       κ
                                       -
                                       1
                                    
                                 
                                 φ
                              
                           
                           =
                           
                              1
                              
                                 ω
                                 
                                    c
                                    ,
                                    m
                                 
                                 2
                              
                           
                        , and then 
                           
                              E
                              q
                           
                           
                              
                                 π
                                 c
                                 
                                    -
                                    1
                                 
                              
                           
                           =
                           
                              1
                              
                                 κ
                                 c
                                 2
                              
                           
                        . According to this computation, the gradient 
                           
                              
                                 ∂
                                 L
                              
                              
                                 ∂
                                 
                                    ω
                                    c
                                 
                              
                           
                         and the Newton direction Δ
                           ω
                        
                        
                           c
                         can be directly computed.

Finally, ρ
                        
                           c
                           ,
                           k
                           ,
                           n
                         and ξ
                        
                           c
                           ,
                           k
                           ,
                           m
                         can be calculated via Eqs. (1) and (3) respectively based on the learned parameters 
                           η
                        
                        
                           k
                        , 
                           η
                        
                        
                           c
                        , 
                           ω
                        
                        
                           k
                         and 
                           ω
                        
                        
                           c
                        .

@&#REFERENCES@&#

