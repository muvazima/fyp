@&#MAIN-TITLE@&#Risk neutral and risk averse approaches to multistage renewable investment planning under uncertainty

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We study renewable energy investment planning under uncertainty.


                        
                        
                           
                           We model the problem as a risk-averse multistage stochastic integer program.


                        
                        
                           
                           We develop a solution approach based on Stochastic Dual Dynamic Programming.


                        
                        
                           
                           Solutions obtained using the proposed approach are pareto efficient.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Stochastic programming

Renewable energy investment planning

Stochastic Dual Dynamic Programming

Integer programming

Risk averse

@&#ABSTRACT@&#


               
               
                  Strategies for investing in renewable energy projects present high risks associated with generation and price volatility and dynamics. Existing approaches for determining optimal strategies are based on real options theory, that often simplify the uncertainty process, or on stochastic programming approaches, that simplify the dynamic aspects. In this paper, we bridge the gap between these approaches by developing a multistage stochastic programming approach that includes real options such as postponing, hedging with fixed (forward) contracts and combination with other sources. The proposed model is solved by a procedure based on the Stochastic Dual Dynamic Programming (SDDP) method. The framework is extended to the risk averse setting. A specific case study in investment in hydro and wind projects in the Brazilian market is used to illustrate that the investment strategies generated by the proposed approach are efficient.
               
            

@&#INTRODUCTION@&#

Renewable energy has drawn increasing attention in the last years due to technological improvements and environmental demands. Mainly motivated by emission reduction policies, governments have been creating favorable conditions for investment in renewable sources. Those incentives may appear as special tariffs (Boomsma, Meade, & Fleten, 2012), contract environments (Street, Barroso, Flach, Pereira, & Granville, 2009) or other mechanisms. On the other hand, increases in efficiency of such renewable generators, as in the case of wind power turbines, assisted in increasing the profitability of such investments.

Despite the increased profitability, renewable investments still present high risks, since the renewable source usually has some variability and energy market prices are commonly very volatile. In some countries, special regulatory environments have been created in which the government or buyer holds some or all of the risks. The Brazilian regulation initiated in 2004 established two electric energy trading environments: the Regulated Trading Environment (RTE) and the Free Trading Environment (FTE). All agents that are net consumers must back their entire demand by contracts in either of those markets. In the RTE, contracts are negotiated by regularly held lowest price auctions where all of the energy output of a wind power source is contracted at a fixed price and penalties are only incurred if the generator does not fulfill average yearly amounts. The trade-off is that contracts in such environment are habitually low priced, reducing the investors profits. On the other hand, in the FTE contracts are bilateral and can be extensively customized. Renewable sources have special benefits for trading their energy in this free market because special customers benefit from tariff discounts when purchasing from renewable sources with installed capacity of up to 30 Megawatt. Despite opportunities to sell energy at a greater price, current contracts in FTE account for only approximately 28 percent of the total demand, while it potentially could be as high as 45 percent. This difference is largely due to risk aversion. In the RTE there are contracts that account for the variability of the renewable output guaranteeing fixed prices for the yearly average generation of the plants, similarly to feed-in tariffs in other markets. In the FTE the differences between the contracts and the generation must be cleared in the spot market, with price uncertainty, which in turn makes harder to obtain financing and discourage risk averse investors. More information on the Brazilian market can be found in Maceira, Penna, Melo, Moraes, and Duarte (2008), Shapiro, Tekaya, Paulo da Costa, and Pereira Soares (2013) and Street et al. (2012).

In order to mitigate investment risks such as those mentioned above and improve project value usually well-known strategies such as postponing the investment and trading fixed (forward) contracts are used. The value of waiting for better prices is exploited (Boomsma et al., 2012) and there is an emphasis in the value of postponement due to uncertain technological advances that may be obtained in the near future (Baringo & Conejo, 2013). A remarkable feature of renewable projects is that often there is some kind of seasonal complementarity of different sources that may provide with natural hedging opportunities (Chakrabarti, Newham, Goodwin, & Edwards, 2011; Street et al., 2009). The main approaches to finding optimal investment strategies in the literature are based on real options theory and on stochastic programming. Real options approaches typically rely on simplifications of the data process, such as a small number of uncertainty dimensions, constrained random processes and arbitrage conditions. Stochastic programming approaches on the other hand present model simplifications such as considering a two stage problem to make the problem tractable, with the disadvantage of limiting the scope of investment policies ((Kazempour & Conejo, 2012), (Kazempour, Conejo, & Ruiz, 2012) and (Street et al., 2009)).

The main contribution of this work is to bridge the gap between both approaches, by proposing a dynamic investment formulation able to model the aforementioned options that is solvable with known multi-stage stochastic programming techniques. We use an approach based on the Stochastic Dual Dynamic Programming (SDDP) algorithm to obtain solutions to the proposed model. In this setting, the uncertain random processes modeling generation and prices may not be considered stagewise independent, as required by the SDDP method. We show how to model dependency by using regression over state variables and augmenting the SDDP method with a Markov Chain. Assumption of stagewise independency of the new state variables allows us to consider equiprobable states and thus making the model implementation straightforward. We resort to the same method used in Shapiro et al. (2013) to extend the approach to account for risk aversion. Finally, we present a case study using data from the Brazilian market to illustrate our framework. Numerical results from the case study show that the proposed approach is able to generate policies that are efficient investment strategies.

The remainder of this paper is organized as follows. The proposed multi-stage stochastic programming investment model is presented in detail in Section 2. The Stochastic Dual Dynamic Programming (SDDP) based solution approach is discussed in Section 3 followed by models for the underlying stochastic processes in Section 4. Section 5 presents the implementation of the proposed framework and its extension to the risk averse setting along with numerical results from a case study. Finally, some concluding remarks are provided in Section 6.

We consider an investor planning to invest in n renewable energy projects (typically wind and hydro generation plants) over a planning horizon of T years. In each decision stage, the investor has to decide whether to invest or not. Along with the investment decision, the investor must choose not only the level of investment in each project but also how much of a fixed price (forward) power delivery contract he will sell to the market. Contracts must be backed by generation capacity, so the investment decision in the contract and all projects is done simultaneously. Since it would be unrealistic to increase (or decrease) the share in some project after the investment decision, we are ultimately deciding the optimal period to invest, as well as the level of investment in the project and contract opportunities. It is clear that, along with the benefit from evaluating the portfolio value, one may always use this approach to independently evaluate each project. The energy surplus (or shortfall) to fulfill the contract is settled in the market by the spot price. The amount of power generated by the projects, as well as the energy spot price, and therefore the forward contract price, is uncertain and modeled as random processes. The overall objective is to determine an investment time and project portfolio in order to maximize the returns given by the difference in revenues from the contract and selling power in the spot market over the planning horizon with the cost of investment. The investor may prefer to defer his investment decision if he expects to obtain better contract prices in the future.

We next develop a multistage stochastic programming formulation of the above described investment problem. We model the generation and price processes on monthly basis, however our investment decision stages are yearly periods 
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                     . We will use subscripts τ and t for monthly and yearly periods, respectively. We assume that there are no operational decisions for the generation plants in the projects. That is, plant output will be proportional to the availability of the natural resources. The amount of power (in average Megawatt), generated in a given monthly period τ, is a random data process 
                        
                           E
                           τ
                           j
                        
                      for each renewable project 
                        
                           j
                           =
                           1
                           ,
                           …
                           ,
                           n
                        
                     . The monthly energy spot price (in Dollars/Megawatt-hours) is also a random data process Pτ
                     . If at least one of the plants is located in a different market from the consumer, on circumstances of transmission congestion, prices in the markets will differ. In the considered case, we will not account for this spatial risk, which can be quantified and managed. All price data will refer to a single market. We will discuss the modeling of the stochastic generation and price processes in Section 4. The remaining data for the model are assumed to be deterministic.

At each (yearly) period t there is a binary investment decision xt
                     . If the investment decision is undertaken, one has to immediately decide what share 
                        
                           r
                           t
                           j
                        
                      of project j to purchase and also how much of the forward contracts qt
                      (as a fraction of a maximum amount of Megawatt, denoted D) to sell at the price of the forward contract in January of that year, which we denote as ft
                     . The modelling of the forward prices is discussed in Section 4. We assume that the share or contracts once determined may not be reviewed in the future. Since each project j represents an individual plant, we are considering that we may partially invest in some plants. This is likely to happen in large infrastructure investments were consortia are build by several companies interested in developing a project and sharing its profits. At least for wind power projects, scalability is not an issue, since they are very modular, given wind power plants involve several turbines in a given site. A small share suggested by the model in those projects might as well indicate that their sizing should be reevaluated.

The forward contracts are customarily backed by physical guarantees related to the output of the plants in the project portfolio. The contract maximum amount D will be associated to some statistic related to the amount of energy produced by the investor’s portfolio, typically given by the capacity factor dj
                      of a project j. Thus the contract amount Dqt
                      (given by fraction qt
                      of D) and project shares 
                        
                           r
                           t
                           j
                        
                      must satisfy the constraints

                        
                           (2.1)
                           
                              
                                 D
                                 
                                    q
                                    t
                                 
                                 ≤
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    d
                                    j
                                 
                                 
                                    r
                                    t
                                    j
                                 
                                 ,
                                 
                                 0
                                 ≤
                                 
                                    r
                                    t
                                    j
                                 
                                 ≤
                                 1
                                 ,
                                 
                                 0
                                 ≤
                                 
                                    q
                                    t
                                 
                                 ≤
                                 1
                                 ,
                                 
                                 ∀
                                 
                                 t
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 T
                                 ,
                              
                           
                        
                     where dj
                      is the physical guarantee backed by project 
                        
                           j
                           =
                           1
                           ,
                           …
                           ,
                           n
                           ,
                        
                      and 
                        
                           D
                           :
                           =
                           
                              d
                              1
                           
                           +
                           ⋯
                           +
                           
                              d
                              n
                           
                        
                     .

The costs associated with the investment may be represented by their present value at the time of the investment decision. Monthly revenues are aggregated into the respective yearly revenues by summation. Thus at the investment period t the following cash flow is observed

                        
                           (2.2)
                           
                              
                                 ϱ
                                 
                                    
                                       (
                                       1
                                       +
                                       
                                          ρ
                                          c
                                       
                                       )
                                    
                                    
                                       −
                                       b
                                    
                                 
                                 D
                                 
                                    q
                                    t
                                 
                                 
                                    f
                                    t
                                 
                                 
                                    ∑
                                    
                                       τ
                                       =
                                       12
                                       (
                                       t
                                       −
                                       1
                                       )
                                       +
                                       1
                                    
                                    
                                       τ
                                       =
                                       12
                                       t
                                    
                                 
                                 
                                    h
                                    τ
                                 
                                 −
                                 
                                    v
                                    T
                                 
                                 
                                    r
                                    t
                                 
                                 ,
                              
                           
                        
                     where 
                        
                           
                              r
                              t
                           
                           =
                           
                              (
                              
                                 r
                                 t
                                 1
                              
                              ,
                              …
                              ,
                              
                                 r
                                 t
                                 n
                              
                              )
                           
                           ,
                        
                     
                     
                        
                           v
                           =
                           (
                           
                              v
                              1
                           
                           ,
                           …
                           ,
                           
                              v
                              n
                           
                           )
                        
                      is the present value vector (in dollars) of the investment costs for each project, hτ
                      is number of hours in month τ, and ϱ is the present value of an annuity with horizon equal to the project lifetime l. The first term refers to the contract revenue. The stream of payments from the contract is only initiated after the plants in a project are in operation, so it is discounted by the appropriate rate ρc
                      by b periods, where b is the build time.

Once the plants begin their operations, the single period profits for year t are given by

                        
                           (2.3)
                           
                              
                                 
                                    ∑
                                    
                                       τ
                                       =
                                       12
                                       (
                                       t
                                       −
                                       1
                                       )
                                       +
                                       1
                                    
                                    
                                       τ
                                       =
                                       12
                                       t
                                    
                                 
                                 
                                    [
                                    
                                       P
                                       τ
                                    
                                    
                                       h
                                       τ
                                    
                                    
                                       (
                                       
                                          r
                                          t
                                          T
                                       
                                       
                                          E
                                          τ
                                       
                                       −
                                       D
                                       
                                          q
                                          t
                                       
                                       )
                                    
                                    ]
                                 
                                 ,
                              
                           
                        
                     where 
                        
                           
                              E
                              τ
                           
                           =
                           
                              (
                              
                                 E
                                 τ
                                 1
                              
                              ,
                              …
                              ,
                              
                                 E
                                 τ
                                 n
                              
                              )
                           
                        
                      and 
                        
                           
                              r
                              t
                              T
                           
                           
                              E
                              τ
                           
                           =
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              n
                           
                           
                              r
                              t
                              i
                           
                           
                              E
                              τ
                              i
                           
                        
                     .

We are now ready to present a formulation of the investment problem. Let 
                        
                           
                              y
                              t
                           
                           :
                           =
                           
                              (
                              
                                 q
                                 t
                              
                              ,
                              
                                 r
                                 t
                              
                              )
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 n
                                 +
                                 1
                              
                           
                           ,
                        
                     
                     
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                           ,
                        
                      be the continuous decision variables, and denote

                        
                           (2.4)
                           
                              
                                 
                                    a
                                    t
                                 
                                 :
                                 =
                                 
                                    (
                                    ϱ
                                    
                                       
                                          (
                                          1
                                          +
                                          
                                             ρ
                                             c
                                          
                                          )
                                       
                                       
                                          −
                                          b
                                       
                                    
                                    D
                                    
                                       f
                                       t
                                    
                                    
                                       ∑
                                       
                                          τ
                                          =
                                          12
                                          (
                                          t
                                          −
                                          1
                                          )
                                          +
                                          1
                                       
                                       
                                          τ
                                          =
                                          12
                                          t
                                       
                                    
                                    
                                       h
                                       τ
                                    
                                    ,
                                    −
                                    v
                                    )
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (2.5)
                           
                              
                                 
                                    c
                                    t
                                 
                                 :
                                 =
                                 
                                    (
                                    
                                       ∑
                                       
                                          τ
                                          =
                                          12
                                          (
                                          t
                                          −
                                          1
                                          )
                                          +
                                          1
                                       
                                       
                                          τ
                                          =
                                          12
                                          t
                                       
                                    
                                    −
                                    D
                                    
                                       P
                                       τ
                                    
                                    
                                       h
                                       τ
                                    
                                    ,
                                    
                                       ∑
                                       
                                          τ
                                          =
                                          12
                                          (
                                          t
                                          −
                                          1
                                          )
                                          +
                                          1
                                       
                                       
                                          τ
                                          =
                                          12
                                          t
                                       
                                    
                                    
                                       P
                                       τ
                                    
                                    
                                       h
                                       τ
                                    
                                    
                                       E
                                       τ
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (2.6)
                           
                              
                                 
                                    Y
                                    t
                                 
                                 :
                                 =
                                 
                                    {
                                    
                                       y
                                       t
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    :
                                    D
                                    
                                       q
                                       t
                                    
                                    ≤
                                    
                                       d
                                       T
                                    
                                    
                                       r
                                       t
                                    
                                    ,
                                    
                                    0
                                    ≤
                                    
                                       r
                                       t
                                    
                                    ≤
                                    1
                                    ,
                                    
                                    0
                                    ≤
                                    
                                       q
                                       t
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     We can write now the following multistage stochastic programming formulation of the investment problem

                        
                           (2.7)
                           
                              
                                 
                                    
                                       
                                          Max
                                          
                                             
                                                x
                                                t
                                             
                                             ,
                                             
                                                y
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                          E
                                          
                                             [
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                   −
                                                   1
                                                
                                             
                                             
                                                g
                                                t
                                             
                                             
                                                (
                                                
                                                   y
                                                   t
                                                
                                                )
                                             
                                             
                                                x
                                                t
                                             
                                             
                                                
                                                   (
                                                   1
                                                   +
                                                   
                                                      ρ
                                                      c
                                                   
                                                   )
                                                
                                                
                                                   1
                                                   −
                                                   t
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2.8)
                           
                              
                                 
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                       
                                    
                                    
                                       
                                          
                                          
                                             y
                                             t
                                          
                                          ∈
                                          
                                             Y
                                             t
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2.9)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                t
                                                =
                                                1
                                             
                                             
                                                T
                                                −
                                                1
                                             
                                          
                                          
                                             x
                                             t
                                          
                                          ≤
                                          1
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2.10)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             x
                                             t
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where

                        
                           (2.11)
                           
                              
                                 
                                    g
                                    t
                                 
                                 
                                    (
                                    
                                       y
                                       t
                                    
                                    )
                                 
                                 :
                                 =
                                 
                                    a
                                    t
                                    T
                                 
                                 
                                    y
                                    t
                                 
                                 +
                                 
                                    ∑
                                    
                                       
                                          t
                                          ′
                                       
                                       =
                                       t
                                       +
                                       b
                                    
                                    
                                       t
                                       +
                                       b
                                       +
                                       l
                                       −
                                       1
                                    
                                 
                                 
                                    c
                                    
                                       
                                          t
                                          ′
                                       
                                    
                                    T
                                 
                                 
                                    y
                                    t
                                 
                                 
                                    
                                       (
                                       1
                                       +
                                       
                                          ρ
                                          c
                                       
                                       )
                                    
                                    
                                       t
                                       −
                                       
                                          t
                                          ′
                                       
                                    
                                 
                                 .
                              
                           
                        
                     The decision variables xt, yt
                      are adapted to the respective filtration 
                        
                           F
                           t
                        
                      (the nonanticipativity constraint), and the expectation in (2.7) is taken with respect to the random data process that we will discuss later.

We mention two general applications of the above model: (i) a Genco (generation company) in the investment-planning stage deciding the optimal scale of its renewable projects and, therefore, its portfolio regarding the market conditions; and (ii) a Genco who identifies a set of candidate projects to invest, for which either a participation agreement is established among parties or the possibility to buy project shares is available, and the model provides the optimal timing to invest and the best involvement in each technology type. In both cases, additional constraints can be imposed on variables xt
                      and yt
                     . Those constraints might incorporate specific requirements on the investment levels, without jeopardizing the proposed methodology. Additional integrality constraints might in turn provide us with different results than the obtained in Section 5.

This model is an instance of the optimal stopping time problem applied to a portfolio of projects and contracts. The above formulation (2.7)–(2.10) is nonlinear and would be difficult to use in practice. We will now introduce an approximate formulation, by allowing the project lifetime to extend up to period 
                        
                           T
                           +
                           l
                           −
                           1
                           ,
                        
                      regardless of the period when the investment decision was made. This may lead in some cases to an overestimation of early investment opportunities. If this error is considered to be significant, one can adapt this framework to account for this effect, for instance, by adjusting at
                      in the first periods. The reduction in capital expenditures should be done in order to keep the internal rate of return or profitability index of the portfolio approximately unchanged.

For the sake of simplicity we will also assume for now that the build time is equal to one year,
                        3
                     
                     
                        3
                        In practice, small run-of-river hydro plants have similar build time for wind power, approximately 3 years. In the final review of commercial evaluation this build time should be considered. Our simplified model could benefit the economic assessment of an opportunity and also make it more understandable to the reader.
                      we will discuss this further in Section 3. The reformulated problem is given by

                        
                           (2.12)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             Max
                                             
                                                
                                                   x
                                                   t
                                                
                                                ,
                                                
                                                   y
                                                   t
                                                
                                                ,
                                                
                                                   z
                                                   t
                                                
                                             
                                          
                                          E
                                          
                                             [
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   t
                                                
                                                
                                                   a
                                                   t
                                                   T
                                                
                                                
                                                   y
                                                   t
                                                
                                                +
                                                
                                                   c
                                                   t
                                                   T
                                                
                                                
                                                   y
                                                   
                                                      t
                                                      −
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   (
                                                   1
                                                   +
                                                   
                                                      ρ
                                                      c
                                                   
                                                   )
                                                
                                                
                                                   1
                                                   −
                                                   t
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          +
                                          
                                          
                                             ∑
                                             
                                                t
                                                =
                                                T
                                             
                                             
                                                T
                                                +
                                                l
                                                −
                                                1
                                             
                                          
                                          
                                             c
                                             t
                                             T
                                          
                                          
                                             y
                                             T
                                          
                                          
                                             
                                                (
                                                1
                                                +
                                                
                                                   ρ
                                                   c
                                                
                                                )
                                             
                                             
                                                1
                                                −
                                                t
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2.13)
                           
                              
                                 
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                       
                                    
                                    
                                       
                                          
                                          
                                             y
                                             t
                                          
                                          ∈
                                          
                                             Y
                                             t
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2.14)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             z
                                             t
                                          
                                          =
                                          
                                             x
                                             t
                                          
                                          +
                                          
                                             z
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2.15)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             y
                                             t
                                          
                                          ≤
                                          
                                             z
                                             t
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2.16)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             y
                                             t
                                          
                                          ≥
                                          
                                             y
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2.17)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             y
                                             t
                                          
                                          ≤
                                          
                                             y
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                          +
                                          1
                                          −
                                          
                                             z
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2.18)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             x
                                             t
                                          
                                          ,
                                          
                                             z
                                             t
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     with initial conditions 
                        
                           
                              z
                              0
                           
                           =
                           0
                           ,
                        
                     
                     
                        
                           
                              y
                              0
                           
                           =
                           0
                           ,
                        
                      and with 
                        
                           
                              x
                              T
                           
                           =
                           0
                        
                     .

Note that we have introduced additional binary variables zt
                      for 
                        
                           t
                           =
                           1
                           ,
                           ⋯
                           ,
                           T
                           ,
                        
                      indicating whether an investment decision has been made in or before period t. Eq. (2.14) implies that if 
                        
                           
                              z
                              
                                 t
                                 −
                                 1
                              
                           
                           =
                           1
                           ,
                        
                      then 
                        
                           
                              x
                              t
                           
                           =
                           0
                        
                      and 
                        
                           
                              z
                              t
                           
                           =
                           1
                        
                     . This equation ensures that once xt
                      becomes equal 1, it remains equal 0 until end of the period T. Eq. (2.15) guarantees that yt
                      ≤ 1 (i.e., qt
                      ≤ 1 and rt
                      ≤ 1), and that 
                        
                           
                              y
                              t
                           
                           =
                           0
                        
                      until the investment is made, and Eqs. (2.15)–(2.17) imply that once the investment is made, i.e., xt
                      becomes equal 1, yt
                      remains the same for the remaining periods. It follows that 
                        
                           
                              x
                              t
                           
                           
                              y
                              t
                           
                           =
                           
                              y
                              t
                           
                           −
                           
                              y
                              
                                 t
                                 −
                                 1
                              
                           
                           ,
                        
                      for all t. It is not possible to invest in the last stage, this is enforced by equation 
                        
                           
                              x
                              T
                           
                           =
                           0
                        
                      in (2.18). The first part of the objective (2.12) is cash flow during the investment horizon and the second part represents the additional cost corresponding to the project lifetime l.

The stated problem has the bilinear term 
                        
                           
                              x
                              t
                           
                           
                              a
                              t
                              T
                           
                           
                              y
                              t
                           
                        
                      in the objective function, thus rendering the model nonlinear. We circumvent this nonlinearity by substituting 
                        
                           
                              x
                              t
                           
                           
                              y
                              t
                           
                           =
                           
                              y
                              t
                           
                           −
                           
                              y
                              
                                 t
                                 −
                                 1
                              
                           
                        
                     . That is, problem (2.12)–(2.18) can be written as

                        
                           (2.19)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             Max
                                             
                                                
                                                   x
                                                   t
                                                
                                                ,
                                                
                                                   y
                                                   t
                                                
                                                ,
                                                
                                                   z
                                                   t
                                                
                                             
                                          
                                          E
                                          
                                             [
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   a
                                                   t
                                                   T
                                                
                                                
                                                   (
                                                   
                                                      y
                                                      t
                                                   
                                                   −
                                                   
                                                      y
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   c
                                                   t
                                                   T
                                                
                                                
                                                   y
                                                   
                                                      t
                                                      −
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   (
                                                   1
                                                   +
                                                   
                                                      ρ
                                                      c
                                                   
                                                   )
                                                
                                                
                                                   1
                                                   −
                                                   t
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          +
                                          
                                          
                                             ∑
                                             
                                                t
                                                =
                                                T
                                             
                                             
                                                T
                                                +
                                                l
                                                −
                                                1
                                             
                                          
                                          
                                             c
                                             t
                                             T
                                          
                                          
                                             y
                                             T
                                          
                                          
                                             
                                                (
                                                1
                                                +
                                                
                                                   ρ
                                                   c
                                                
                                                )
                                             
                                             
                                                1
                                                −
                                                t
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2.20)
                           
                              
                                 
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                       
                                    
                                    
                                       
                                          
                                          
                                             y
                                             t
                                          
                                          ∈
                                          
                                             Y
                                             t
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2.21)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             z
                                             t
                                          
                                          =
                                          
                                             x
                                             t
                                          
                                          +
                                          
                                             z
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2.22)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             y
                                             t
                                          
                                          ≤
                                          
                                             z
                                             t
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2.23)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             y
                                             t
                                          
                                          ≥
                                          
                                             y
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2.24)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             y
                                             t
                                          
                                          ≤
                                          
                                             y
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                          +
                                          1
                                          −
                                          
                                             z
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2.25)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             x
                                             t
                                          
                                          ,
                                          
                                             z
                                             t
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

The optimization (maximization) in (2.19)–(2.25) is performed over (nonanticipative) policies satisfying the feasibility constraints, i.e., 
                        
                           
                              (
                              
                                 x
                                 t
                              
                              ,
                              
                                 y
                                 t
                              
                              ,
                              
                                 z
                                 t
                              
                              )
                           
                           =
                           
                              (
                              
                                 x
                                 t
                              
                              
                                 (
                                 
                                    ξ
                                    
                                       [
                                       t
                                       ]
                                    
                                 
                                 )
                              
                              ,
                              
                                 y
                                 t
                              
                              
                                 (
                                 
                                    ξ
                                    
                                       [
                                       t
                                       ]
                                    
                                 
                                 )
                              
                              ,
                              
                                 z
                                 t
                              
                              
                                 (
                                 
                                    ξ
                                    
                                       [
                                       t
                                       ]
                                    
                                 
                                 )
                              
                              )
                           
                           ,
                        
                     
                     
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                           ,
                        
                      is a function of the history 
                        
                           
                              ξ
                              
                                 [
                                 t
                                 ]
                              
                           
                           =
                           
                              (
                              
                                 ξ
                                 1
                              
                              ,
                              …
                              ,
                              
                                 ξ
                                 t
                              
                              )
                           
                        
                      of the data process. Here

                        
                           
                              
                                 
                                    
                                       
                                          
                                             ξ
                                             t
                                          
                                          :
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          (
                                          
                                             P
                                             
                                                12
                                                (
                                                t
                                                −
                                                1
                                                )
                                                +
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             P
                                             
                                                12
                                                t
                                             
                                          
                                          ,
                                          
                                             E
                                             
                                                12
                                                (
                                                t
                                                −
                                                1
                                                )
                                                +
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             E
                                             
                                                12
                                                t
                                             
                                          
                                          )
                                          ,
                                          
                                          t
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          T
                                          −
                                          1
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ξ
                                             T
                                          
                                          :
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             (
                                             (
                                             
                                                P
                                                
                                                   12
                                                   (
                                                   T
                                                   −
                                                   1
                                                   )
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                P
                                                
                                                   12
                                                   (
                                                   T
                                                   +
                                                   l
                                                   −
                                                   1
                                                   )
                                                
                                             
                                             ,
                                             
                                                E
                                                
                                                   12
                                                   (
                                                   T
                                                   −
                                                   1
                                                   )
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                E
                                                
                                                   12
                                                   (
                                                   T
                                                   +
                                                   l
                                                   −
                                                   1
                                                   )
                                                
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Note that at time 
                        
                           t
                           =
                           1
                           ,
                        
                      
                     ξ
                     1 is known (deterministic).

In this section, we presented a risk neutral formulation. In the risk averse setting, one may substitute the expectation operator in (2.19) by a conveniently chosen risk functional. Considering the uncertain nature of these investments, usually the investor will present some kind of risk aversion. A particularly undesired situation is the so-called price-quantity risk, which is the situation of positive correlation between energy shortages and spot prices positive spikes. A risk averse investor would be willing to build a portfolio with lower expected return in order to avoid those risks. In Section 5.2 we will discuss a risk averse approach to deal with this.

In this section, we discuss a solution strategy for the multi-stage stochastic program (2.19)–(2.25). Numerical approaches based on enumeration of scenarios generically are computationally intractable because of the exponential growth of the number of scenarios (cf., Shapiro & Nemirovski, 2005; Shapiro, Dentcheva, and Ruszczyński (2009)). Approaches such as in Baringo and Conejo (2013) are only applicable for limited size instances. In this work, we resort to the Stochastic Dual Dynamic Programming (SDDP) method because the method has relatively low computational complexity and, from the practical side, there are several documented successful applications to the power industry for long term planning, e.g., (Newhan, 2008),(Pereira & Pinto, 1985),(Shapiro et al., 2013). The SDDP method was proposed in Pereira and Pinto (1985); 1991). Its convergence properties have been studied in Philpott and Guan (2008) and Shapiro (2011).

The first step towards solving the multistage stochastic program (2.19)–(2.25) is to discretize the, possibly continuous, distribution of the stochastic process ξt
                     . We approach this by using Monte Carlo sampling techniques. That is, we generate a number of sample paths (called scenarios) and apply the SDDP method to the constructed, so-called Sample Average Approximation (SAA), problem. The SDDP method solves the generated SAA problem by constructing piecewise linear approximations of the corresponding cost-to-go functions in a dynamic programming formulation of the problem. An important requirement for the SDDP method is the stagewise independence of the data process since then the expected value cost-to-go functions do not depend on the data process. If the data process dependency is only related to right hand side coefficients, then a simple procedure is to augment the number of state variables which allows to transform the problem in a way to enforce the stagewise independency condition. Unfortunately, if the dependency is related to the cost coefficients, as in our case, convexity is lost in such transformation and no simple reformulation is available.

We assume throughout the rest of the paper that the process {ξt
                     } is Markovian, i.e., for every 
                        
                           t
                           =
                           2
                           ,
                           …
                           ,
                           T
                           ,
                        
                      the conditional distribution of ξt
                      given 
                        
                           ξ
                           
                              [
                              t
                              −
                              1
                              ]
                           
                        
                      is the same as the conditional distribution of ξt
                      given 
                        
                           ξ
                           
                              t
                              −
                              1
                           
                        
                     . One approach to represent dependency in this case is to approximate the corresponding Markov process by a Markov Chain, and apply a variant of the SDDP method by creating an approximation of the cost-to-go functions for each one of the discrete states. This approach was applied in Bonnans, Cen, and Christel (2012) and Gjelsvik, Belsnes, and Haugstad (1998) (see also Shapiro, 2011, section 5.2.1). One of the difficulties with this approach is in constructing the transition probabilities of the Markov Chain.

A special case is when the process {ξt
                     } is stagewise independent, i.e., random vector ξt
                      is independent of 
                        
                           ξ
                           
                              [
                              t
                              −
                              1
                              ]
                           
                        
                      and the cost coefficient is a function of ξt
                      and 
                        
                           ξ
                           
                              t
                              −
                              1
                           
                        
                     . Under this assumption an appropriate Markov Chain can be created such that the transition probabilities are equiprobable due to stagewise independency. Accordingly, each discrete state will have a corresponding cost-to-go function. We will get back to this subject in the next section.

To proceed with the description we first provide a dynamic programming reformulation of (2.19)–(2.25). At time 
                        
                           t
                           =
                           T
                        
                      we solve the problem (recall that 
                        
                           
                              x
                              T
                           
                           =
                           0
                        
                     )

                        
                           (3.1)
                           
                              
                                 
                                    
                                       
                                          
                                             Max
                                             
                                                
                                                   x
                                                   T
                                                
                                                ,
                                                
                                                   y
                                                   T
                                                
                                                ,
                                                
                                                   z
                                                   T
                                                
                                             
                                          
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                t
                                                =
                                                T
                                             
                                             
                                                T
                                                +
                                                l
                                                −
                                                1
                                             
                                          
                                          
                                             c
                                             t
                                             T
                                          
                                          
                                             y
                                             T
                                          
                                          
                                             
                                                (
                                                1
                                                +
                                                
                                                   ρ
                                                   c
                                                
                                                )
                                             
                                             
                                                T
                                                −
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                          
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             y
                                             T
                                          
                                          ∈
                                          
                                             Y
                                             T
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             z
                                             T
                                          
                                          =
                                          
                                             z
                                             
                                                T
                                                −
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             y
                                             T
                                          
                                          ≤
                                          
                                             z
                                             T
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             y
                                             T
                                          
                                          ≥
                                          
                                             y
                                             
                                                T
                                                −
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             y
                                             T
                                          
                                          ≤
                                          
                                             y
                                             
                                                T
                                                −
                                                1
                                             
                                          
                                          +
                                          1
                                          −
                                          
                                             z
                                             
                                                T
                                                −
                                                1
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     The optimal value of problem (3.1) depends on the realization of the random vector ξT
                      and decision variables 
                        
                           y
                           
                              T
                              −
                              1
                           
                        
                      and 
                        
                           
                              z
                              
                                 T
                                 −
                                 1
                              
                           
                           ,
                        
                      and it is denoted 
                        
                           
                              Q
                              T
                           
                           
                              (
                              
                                 y
                                 
                                    T
                                    −
                                    1
                                 
                              
                              ,
                              
                                 z
                                 
                                    T
                                    −
                                    1
                                 
                              
                              ,
                              
                                 ξ
                                 T
                              
                              )
                           
                        
                     . Note that this optimal value is trivially evaluated as the linear expression 
                        
                           
                              ∑
                              
                                 t
                                 =
                                 T
                              
                              
                                 T
                                 +
                                 l
                                 −
                                 1
                              
                           
                           
                              c
                              t
                              T
                           
                           
                              y
                              
                                 T
                                 −
                                 1
                              
                           
                           
                              
                                 (
                                 1
                                 +
                                 
                                    ρ
                                    c
                                 
                                 )
                              
                              
                                 T
                                 −
                                 t
                              
                           
                           ,
                        
                      i.e., 
                        
                           
                              y
                              T
                           
                           =
                           
                              y
                              
                                 T
                                 −
                                 1
                              
                           
                        
                      is the optimal solution of (3.1).

Going backward in time 
                        
                           t
                           =
                           T
                           −
                           1
                           ,
                           …
                           ,
                           2
                           ,
                        
                      the corresponding cost-to-go function 
                        
                           
                              Q
                              t
                           
                           
                              (
                              
                                 y
                                 
                                    t
                                    −
                                    1
                                 
                              
                              ,
                              
                                 z
                                 
                                    t
                                    −
                                    1
                                 
                              
                              ,
                              
                                 ξ
                                 t
                              
                              )
                           
                        
                      is given by the optimal value of the problem

                        
                           (3.2)
                           
                              
                                 
                                    
                                       
                                          
                                             Max
                                             
                                                
                                                   x
                                                   t
                                                
                                                ,
                                                
                                                   y
                                                   t
                                                
                                                ,
                                                
                                                   z
                                                   t
                                                
                                             
                                          
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             a
                                             t
                                             T
                                          
                                          
                                             (
                                             
                                                y
                                                t
                                             
                                             −
                                             
                                                y
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             c
                                             t
                                             T
                                          
                                          
                                             y
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                          +
                                          
                                             Q
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                y
                                                t
                                             
                                             ,
                                             
                                                z
                                                t
                                             
                                             ,
                                             
                                                ξ
                                                t
                                             
                                             )
                                          
                                          
                                             
                                                (
                                                1
                                                +
                                                
                                                   ρ
                                                   c
                                                
                                                )
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                          
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             y
                                             t
                                          
                                          ∈
                                          
                                             Y
                                             t
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             z
                                             t
                                          
                                          =
                                          
                                             x
                                             t
                                          
                                          +
                                          
                                             z
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             y
                                             t
                                          
                                          ≤
                                          
                                             z
                                             t
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             y
                                             t
                                          
                                          ≥
                                          
                                             y
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             y
                                             t
                                          
                                          ≤
                                          
                                             y
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                          +
                                          1
                                          −
                                          
                                             z
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             x
                                             t
                                          
                                          ,
                                          
                                             z
                                             t
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where

                        
                           (3.3)
                           
                              
                                 
                                    Q
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       y
                                       t
                                    
                                    ,
                                    
                                       z
                                       t
                                    
                                    ,
                                    
                                       ξ
                                       t
                                    
                                    )
                                 
                                 :
                                 =
                                 E
                                 
                                    [
                                    
                                       Q
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          y
                                          t
                                       
                                       ,
                                       
                                          z
                                          t
                                       
                                       ,
                                       
                                          ξ
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                    |
                                    
                                       ξ
                                       t
                                    
                                    ]
                                 
                                 ,
                              
                           
                        
                     and 
                        
                           E
                           [
                           ·
                           |
                           
                              ξ
                              t
                           
                           ]
                        
                      denotes the corresponding conditional expectation. Finally at the first stage we solve the problem (recall that 
                        
                           
                              z
                              0
                           
                           =
                           0
                        
                     )

                        
                           (3.4)
                           
                              
                                 
                                    
                                       
                                          
                                             Max
                                             
                                                
                                                   x
                                                   1
                                                
                                                ,
                                                
                                                   y
                                                   1
                                                
                                                ,
                                                
                                                   z
                                                   1
                                                
                                             
                                          
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             a
                                             1
                                             T
                                          
                                          
                                             y
                                             1
                                          
                                          +
                                          E
                                          
                                             [
                                             
                                                Q
                                                2
                                             
                                             
                                                (
                                                
                                                   y
                                                   1
                                                
                                                ,
                                                
                                                   z
                                                   1
                                                
                                                ,
                                                
                                                   ξ
                                                   2
                                                
                                                )
                                             
                                             ]
                                          
                                          
                                             
                                                (
                                                1
                                                +
                                                
                                                   ρ
                                                   c
                                                
                                                )
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                          
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             y
                                             1
                                          
                                          ∈
                                          
                                             Y
                                             1
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             z
                                             1
                                          
                                          =
                                          
                                             x
                                             1
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             y
                                             1
                                          
                                          ≤
                                          
                                             z
                                             1
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             x
                                             1
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Note that because the data process is assumed to be Markovian, the cost-to-go (value) function 
                        
                           
                              Q
                              t
                           
                           
                              (
                              
                                 y
                                 
                                    t
                                    −
                                    1
                                 
                              
                              ,
                              
                                 z
                                 
                                    t
                                    −
                                    1
                                 
                              
                              ,
                              
                                 ξ
                                 t
                              
                              )
                           
                        
                      and the expected value function 
                        
                           
                              Q
                              
                                 t
                                 +
                                 1
                              
                           
                           
                              (
                              
                                 y
                                 t
                              
                              ,
                              
                                 z
                                 t
                              
                              ,
                              
                                 ξ
                                 t
                              
                              )
                           
                        
                      depend only on ξt
                      rather than the whole history ξ
                     [t]. In the special case when the process ξt
                      is stagewise independent, then the conditional expectation in (3.3) can be replaced by the respective unconditional expectation, and the corresponding expected value function 
                        
                           
                              Q
                              
                                 t
                                 +
                                 1
                              
                           
                           
                              (
                              
                                 y
                                 t
                              
                              ,
                              
                                 z
                                 t
                              
                              )
                           
                        
                      does not depend on the data process. The resulting cost-to-go function has 
                        
                           n
                           +
                           2
                        
                      state variables and the resulting problem may be solved by the SDDP method.

The basic idea of the SDDP algorithm is to approximate the cost-to-go functions by piecewise linear functions going backward and forward in each iteration of the algorithm. We can refer to Philpott and Guan (2008),Shapiro (2011) for details. The SDDP algorithm can be considered as an approximate dynamic programming type method. Under the stagewise independency assumption, if we generate a set of 
                        
                           
                              N
                              t
                           
                           =
                           N
                        
                      of sample points per stage,
                        4
                     
                     
                        4
                        Note that the total number of scenarios grows exponentially with increase of the number of stages T, and is equal to 
                              
                                 N
                                 
                                    T
                                    −
                                    1
                                 
                              
                           .
                      the backward step of the SDDP algorithm (applied to the corresponding SAA problem) requires solving 
                        
                           N
                           ×
                           
                              (
                              T
                              −
                              1
                              )
                           
                        
                      linear programs per iteration.

On the other hand, if one must resort to a Markov Chain approximation, then there is need to build one cost-to-go function for each state, in which case the iteration now would take 
                        
                           
                              
                                 N
                              
                              2
                           
                           ×
                           
                              (
                              T
                              −
                              1
                              )
                           
                        
                      operations. The overall computational complexity of the SDDP method is determined by the number of the state variables, and typically grows linearly with respect to the number of stages. For reasonable number of state variables,
                        5
                     
                     
                        5
                        Recall that in the considered case 
                              
                                 n
                                 =
                                 2
                              
                            and the number of state variables in (yt, zt
                           ) is 4.
                      we may be able to solve it using the SDDP algorithm.

Of course, the integrality of some decision variables is incompatible with the SDDP approach. Nevertheless, there exists extensions of the method that deal with this issue, as in Bonnans et al. (2012). We use a heuristic approach to relax the integrality in the backward step, while enforcing it in the forward step of the SDDP method. This preserves necessary convexity to build new cuts in the backward step and generates feasible solutions on the forward step. We will present numerical results that support this approach.

It is very easy to use this model to simulate some desired strategy, by inclusion of additional constraints. A decision maker could switch between analysis of the model results and proposition of some strategy of his own.

To account for a general build time, one might keep track of the state variables 
                        
                           
                              y
                              
                                 t
                                 −
                                 b
                              
                           
                           ,
                        
                      but this could become infeasible even with a small number of projects. A better way to consider any build time b is to keep track of the scalar state variable 
                        
                           
                              z
                              
                                 t
                                 −
                                 b
                              
                           
                           ,
                        
                      for instance, augmenting the cost-to-go function to 
                        
                           
                              Q
                              t
                           
                           
                              (
                              
                                 y
                                 
                                    t
                                    −
                                    1
                                 
                              
                              ,
                              
                                 z
                                 
                                    t
                                    −
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 z
                                 
                                    t
                                    −
                                    b
                                 
                              
                              ,
                              
                                 ξ
                                 t
                              
                              )
                           
                        
                     . The objective term 
                        
                           
                              c
                              t
                              T
                           
                           
                              y
                              
                                 t
                                 −
                                 1
                              
                           
                        
                      would have to be exchanged by 
                        
                           
                              c
                              t
                              T
                           
                           
                              y
                              
                                 t
                                 −
                                 1
                              
                           
                           
                              z
                              
                                 t
                                 −
                                 b
                              
                           
                        
                     . This nonlinearity is avoided by a simple substitution using McCormick inequalities (McCormick, 1976).

In this section we discuss the specific stochastic models and the associated sampling methods for the random data in the multistage stochastic program (2.19)–(2.25). Recall that random data in our model are: the monthly generated power 
                        
                           
                              E
                              τ
                              j
                           
                           ,
                        
                      spot prices Pτ
                     , and the yearly forward price ft
                     . We discuss the stochastic modeling and sampling approach with respect to a specific case study in investment in the Brazilian market, in hydro and wind projects.

In our solution approach, we must be able to sample random paths of the respective data processes. Recall that we assumed that the process {ξt
                     } is Markovian. In order to build our scenarios, we first assume stagewise independence of the data process. This turns out to be a questionable assumption, so we will also consider a second approach were we introduce some sort of dependency to model the spot prices, as we will explain next.

Our approach is based on publicly available data from the Brazilian market. In the Brazilian market, the dispatch of the plants in the integrated system is controlled by the national Independent System Operator (ONS) to minimize the overall energy costs (Maceira, Terry, Costa, Damzio, & Melo, 2002). Since differences between the dispatch and the agents’ contracts exists, a clearance procedure was established considering marginal operational costs as the basis for the spot price. Weekly spot prices are calculated by CCEE (Câmara de Comercialização de Energia Elétrica, www.ccee.org.br), the clearing chamber of this market. Due to network transmission constraints, the market is divided in four regions, called submarkets. The price of all four submarkets is established primarily by using a short-term optimization model. A long-term planning model is available for all agents.

Since the Brazilian system is heavily dependent on hydro-powered plants, uncertainty is accounted by use of a stochastic optimization framework, with uncertainty modeled by water inflows (average volume of incoming water) in the different submarkets, as reported in Maceira et al. (2008). The long-term model and corresponding data is shared among the agents. A regularly provided ‘data deck’ to all market agents will contain all data necessary to run the model, as well as 2000 simulated paths of the monthly input water inflows, denoted by 
                        
                           I
                           τ
                           k
                        
                      for market k at month τ, and the output spot price Pτ
                      (for the sake of simplicity we assume that the spot price Pτ
                      does not depend on the market k). This data can be reasonably used to model generation and prices as discussed below.

For a given renewable power plant, the energy generation process is a function of the deterministic plant specifications and the random natural resource used by it. Wind-powered plants depend on wind flow on their location. Monthly average wind flow speed is a key component to predict the plant output. The wind flow hourly profile typically is approximated by a Weibull distribution with mean equal to the monthly average wind flow. The forecasted monthly energy output of a wind-powered plant is obtained by evaluating the wind profile with the turbine power curve. For simplicity, we represent the variability of the wind power generation by its monthly capacity factor. Small hydro plants usually have a small or no reservoir and the energy output is dependent on the uncertain river’s inflow and the specified plant’s head (falling height).

To account for possible correlation of the monthly spot price simulated paths and the generation of the renewable plants, we follow the work of Street et al. (2012), by modeling the wind power capacity factors and water inflows as Vector Autoregressive (VAR) processes, where each process depends on itself and the submarket inflows. For a given plant 
                           
                              j
                              =
                              1
                              ,
                              …
                              ,
                              n
                              ,
                           
                         the monthly 
                           
                              W
                              τ
                              j
                           
                         (capacity factor for wind power or water inflow for hydropower) is modeled by

                           
                              (4.1)
                              
                                 
                                    
                                       W
                                       τ
                                       j
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       12
                                    
                                    
                                       γ
                                       i
                                       j
                                    
                                    
                                       δ
                                       
                                          i
                                          τ
                                       
                                    
                                    +
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       p
                                    
                                    
                                       ϕ
                                       i
                                       j
                                    
                                    
                                       W
                                       
                                          τ
                                          −
                                          i
                                       
                                       j
                                    
                                    +
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       q
                                    
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       4
                                    
                                    
                                       η
                                       
                                          i
                                          k
                                       
                                       j
                                    
                                    
                                       I
                                       
                                          τ
                                          −
                                          i
                                       
                                       k
                                    
                                    +
                                    
                                       
                                          ɛ
                                       
                                       τ
                                       j
                                    
                                    .
                                 
                              
                           
                        Here 
                           
                              I
                              τ
                              k
                           
                         is the inflow of market k at month τ, 
                           
                              ϕ
                              i
                              j
                           
                         and 
                           
                              η
                              
                                 i
                                 k
                              
                              j
                           
                         are respective (auto)regressive coefficients and δiτ
                         is a dummy variable that assumes values 1 in the 
                           
                              i
                              −
                              t
                              h
                           
                         month of the year and 0 elsewhere, i.e., 
                           
                              
                                 δ
                                 
                                    i
                                    τ
                                 
                              
                              =
                              1
                           
                         for 
                           
                              τ
                              =
                              i
                              +
                              12
                              ℓ
                              ,
                           
                        
                        
                           
                              ℓ
                              =
                              0
                              ,
                              1
                              ,
                              …
                              ,
                           
                         and 
                           
                              
                                 δ
                                 
                                    i
                                    τ
                                 
                              
                              =
                              0
                           
                         otherwise. We assume that the errors 
                           
                              
                                 ɛ
                              
                              τ
                              j
                           
                         have normal distribution 
                           
                              N
                              (
                              0
                              ,
                              
                                 σ
                                 j
                                 2
                              
                              )
                           
                         and are independent of each other. Let us make the following remarks. The autoregressive process (4.1) is modeled on a monthly basis for 10 years, i.e., 
                           
                              τ
                              =
                              1
                              ,
                              …
                              ,
                              120
                           
                        . The inflows data 
                           
                              I
                              τ
                              k
                           
                         is summarized into 
                           
                              k
                              =
                              1
                              ,
                              …
                              ,
                              4
                           
                         markets (geographical regions), and there are 
                           
                              j
                              =
                              1
                              ,
                              2
                           
                         plants - wind and hydro inflows.

Coefficients of the autoregressive model (4.1) are estimated by monthly historical data obtained from the project sites. In our numerical experiments we consider 391 measurement periods and significant coefficients of q and p for the VAR process up to 12 lags. Forecasts are generated by Monte Carlo simulation using data from 2000 publicly available simulated paths. The model for the monthly generation, which will be an input to our optimization problem, is

                           
                              (4.2)
                              
                                 
                                    
                                       E
                                       τ
                                       j
                                    
                                    :
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                      τ
                                                   
                                                   
                                                      
                                                         [
                                                         
                                                            C
                                                            j
                                                         
                                                         
                                                            W
                                                            τ
                                                            j
                                                         
                                                         ]
                                                      
                                                      +
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                   j
                                                   =
                                                   1
                                                   
                                                   (
                                                   w
                                                   i
                                                   n
                                                   d
                                                   p
                                                   o
                                                   w
                                                   e
                                                   r
                                                   )
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      h
                                                      τ
                                                   
                                                   
                                                      
                                                         [
                                                         min
                                                         {
                                                         
                                                            C
                                                            j
                                                         
                                                         ,
                                                         κ
                                                         
                                                            W
                                                            τ
                                                            j
                                                         
                                                         }
                                                         ]
                                                      
                                                      +
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   j
                                                   =
                                                   2
                                                   
                                                   (
                                                   s
                                                   m
                                                   a
                                                   l
                                                   l
                                                   
                                                   h
                                                   y
                                                   d
                                                   r
                                                   o
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    [
                                    a
                                    ]
                                 
                                 +
                              
                              =
                              max
                              
                                 {
                                 a
                                 ,
                                 0
                                 }
                              
                           
                         for 
                           
                              a
                              ∈
                              R
                           
                        . Here hτ
                         is the total number of hours in period τ, Cj
                         is the nominal capacity of plant j, and 
                           
                              κ
                              =
                              η
                              g
                              ϕ
                              ,
                           
                         where η is the falling height, g is gravity acceleration and ϕ is an efficiency factor. The linear model of Eq. (4.1) may produce negative values of 
                           
                              W
                              τ
                              j
                           
                        . By using 
                           
                              
                                 [
                                 ·
                                 ]
                              
                              +
                           
                         in (4.2) we truncate the data to guarantee nonnegative generation.

In (4.1)
                        
                           
                              W
                              τ
                              j
                           
                         is modeled as an autoregressive process, and hence the processes 
                           
                              W
                              τ
                              j
                           
                         and 
                           
                              E
                              τ
                              j
                           
                         are not stagewise independent even if we assume that the inflow processes 
                           
                              I
                              τ
                              k
                           
                         are stagewise independent. However while aggregating months into years we could reasonably model ξt
                         as a stagewise independent process. By using Eq. (4.1) it is possible to generate a random sample of 
                           
                              W
                              τ
                              j
                           
                         by random sampling of the inflows from the publicly available 2000 sample paths.

Sampling of spot prices Pτ
                         was more involved. We tried two approaches, to which we refer as independent and dependent methods. In the independent approach we sample from the publicly available data of 2000 sample paths which contain the output Pτ
                         for each month of the years in the horizon 
                           
                              t
                              =
                              1
                              ,
                              …
                              ,
                              T
                              +
                              l
                              −
                              1
                              ,
                           
                         as well as the input inflow data 
                           
                              I
                              
                                 τ
                              
                              k
                           
                         for each market 
                           
                              k
                              =
                              1
                              ,
                              …
                              ,
                              4
                           
                        . In the dependent approach, we modeled spot prices Pτ
                         as a function of the inflows 
                           
                              I
                              τ
                              k
                           
                        . For each monthly period 
                           
                              τ
                              =
                              1
                              ,
                              …
                              ,
                              12
                           
                         in a given year t, we fit a regression of the form

                           
                              (4.3)
                              
                                 
                                    log
                                    
                                       P
                                       τ
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          
                                             I
                                             τ
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       4
                                    
                                    
                                       β
                                       
                                          i
                                          τ
                                       
                                       k
                                    
                                    
                                       I
                                       
                                          τ
                                          −
                                          i
                                       
                                       k
                                    
                                    +
                                    
                                       ϵ
                                       τ
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              β
                              
                                 i
                                 τ
                              
                              k
                           
                         is the regression coefficients of inflows for the different submarkets k and 
                           
                              
                                 I
                                 τ
                              
                              =
                              
                                 {
                                 τ
                                 ,
                                 τ
                                 −
                                 1
                                 ,
                                 .
                                 .
                                 .
                                 }
                              
                           
                         is the index set corresponding to past observations of the inflows going back to at most a year earlier. This model presents a good fit, with high adjusted R
                        2. For instance, the model for January 2016 has adjusted 
                           
                              
                                 R
                                 2
                              
                              =
                              0.8436
                           
                        .

The pricing of forward contracts is also not straightforward. If there is a future market available, on deterministic interest rates the forward price should be equal to the price of the future contract with same maturity, by arbitrage reasons. We are not interested in contracts for a given maturity, but rather in contracts that guarantee a fixed price over the whole period of plant operation. This type of forward is also called a swap contract. Thus, whenever there is an energy contract market, one may use non-arbitrage to price their contracts.

Following Dahl (2004), future prices can be represented by the expected spot price plus a market risk premium. Thus, given our deterministic interest rate, the forward price ft
                        (τ) at time t with maturity τ may be represented by

                           
                              (4.4)
                              
                                 
                                    
                                       f
                                       t
                                    
                                    
                                       (
                                       τ
                                       )
                                    
                                    :
                                    =
                                    
                                       E
                                       t
                                    
                                    
                                       [
                                       
                                          P
                                          τ
                                       
                                       ]
                                    
                                    +
                                    
                                       λ
                                       t
                                    
                                    
                                       (
                                       τ
                                       )
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 E
                                 t
                              
                              
                                 [
                                 ·
                                 ]
                              
                           
                         denotes conditional expectation given information available in time t and λt
                        (τ) is a 
                           riskpremium
                         associated with the contract ft
                        (τ).

We are not interested in contracts for a given maturity, but rather in contracts that guarantee a fixed price over the whole period of plant operation. Following Burger, Graeber, and Schindlmayr (2007), this contract ft
                        , with monthly deliveries from period t for l years, may be priced by

                           
                              (4.5)
                              
                                 
                                    
                                       f
                                       t
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                τ
                                                =
                                                12
                                                (
                                                t
                                                −
                                                1
                                                )
                                                +
                                                1
                                             
                                             
                                                τ
                                                =
                                                12
                                                (
                                                t
                                                +
                                                l
                                                −
                                                1
                                                )
                                             
                                          
                                          
                                             f
                                             t
                                          
                                          
                                             (
                                             τ
                                             )
                                          
                                          
                                             
                                                (
                                                1
                                                +
                                                
                                                   ρ
                                                   c
                                                
                                                )
                                             
                                             
                                                −
                                                (
                                                τ
                                                −
                                                12
                                                (
                                                t
                                                −
                                                1
                                                )
                                                )
                                             
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                τ
                                                =
                                                12
                                                (
                                                t
                                                −
                                                1
                                                )
                                                +
                                                1
                                             
                                             
                                                τ
                                                =
                                                12
                                                (
                                                t
                                                +
                                                l
                                                −
                                                1
                                                )
                                             
                                          
                                          
                                             
                                                (
                                                1
                                                +
                                                
                                                   ρ
                                                   c
                                                
                                                )
                                             
                                             
                                                −
                                                (
                                                τ
                                                −
                                                12
                                                (
                                                t
                                                −
                                                1
                                                )
                                                )
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

While Burger et al. (2007) argue that the risk premium will depend on the market structure and the particular interests of the market participants, Kovacevic, Pflug, and Vespucci (2013) state that there is evidence that short term contracts will have a positive risk premium, while longer term contracts will have a negative premium. This reflects the premium paid by consumers to avoid short term and seasonal volatility, while generators will pay a premium for contracts over several years that will back their investment plans. As mentioned by Povh (2009), accurate forward contract models may be seen as competitive advantage by many energy firms, so most of them would be unwilling to disclose them. We refer to Kovacevic et al. (2013), Benth, Benth, and Koekebakker (2008) and Clewlow and Strickland (2000) for more details on the subject.

Since there is no formal future market in Brazil, agents must define a forward curve based on their expectations. There is currently legislation in study to disclose prices of FTE contracts. Alternatively, one may consider two different electronic exchanges
                           6
                        
                        
                           6
                           BRIX at www.brix.com.br, BBCE at http://www.bbce.com.br/.
                         or the forward price index by DCIDE.
                           7
                        
                        
                           7
                           
                              www.dcide.combr.
                         Further aspects in contract pricing will be studied in future work. We assume that the forward price follows a known process given by (4.4) and that once the contract is signed the fixed price revenue stream may be treated as an Annuity.

In summary, all stochastic models are monthly Markov processes, which can be sampled from the 2000 publicly available simulated paths. We built a SAA problem by randomly sampling from this data assuming stagewise independency for {ξt
                        }, fulfilling the requirement for SDDP. We are ultimately interested in obtaining good investment policies. As will be seen in the numerical results, this approach fails to provide us with good policies, at least in the risk averse case. In our dependent approach, we model the spot prices as a function of the inflows of the current and previous year. This way we keep the independency assumption of the scenario generation but introduce dependency in the policies. Stagewise independency allows us to build a Markov Chain with an equiprobable transition matrix, a rather straightforward procedure.

@&#IMPLEMENTATION@&#

Next, we present the numerical results for the independent and the dependent approaches in the risk neutral setting. We evaluate convergence of the algorithm and also its out of sample performance.

In order to assess the quality of our solutions, we must point out that there are three approximation levels in our method. First, we realize that our “true” model is only an approximation of reality. Furthermore, while we solve the discretized SAA problem, we are really interested in the true problem with continuous distributions. The finite sample size and the stagewise independence assumption lead to an approximation of the true problem. Next, the SDDP method approximates the cost-to-go functions by piecewise linear functions and its convergence is only attained after a large number of iterations. We will evaluate the policies of the SAA problem on the original 2000 series, in order to estimate their optimal value of the true problem. The last approximation is due to the integrality constraint. Our approach requires the relaxation of integrality of the investment decision variable in the backward step. We present numerical evidence that this heuristic is adequate for the presented problem.

All numerical tests were performed using GUROBI 5.6 and AIMMS 3.13 on an Intel Core i7-4500U CPU @1.8Ghz, with 8 GB of RAM running Windows 64bit. We did not implement any parallel computing procedure, but there are plenty of opportunities to do so in the method. We consider one wind power project and one small hydro which we call WP and SH respectively. We are interested in the optimal scaling of the project portfolio, so no additional (integrality) constraints are necessary. The deterministic data considered in all tests is given by

                        
                           
                              
                                 
                                    
                                       T
                                    
                                    
                                       =
                                    
                                    
                                       
                                          5
                                          
                                          years
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          d
                                          
                                             S
                                             H
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          17.6
                                          
                                          M
                                          egawatt
                                          ,
                                          
                                             d
                                             
                                                W
                                                P
                                             
                                          
                                          =
                                          12.0
                                          
                                          
                                             M
                                             egawatt
                                             ,
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          v
                                          
                                             S
                                             H
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          134.9
                                          
                                          million
                                          
                                          Dollars
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          v
                                          
                                             W
                                             P
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          91.6
                                          
                                          million
                                          
                                          Dollars
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       =
                                    
                                    
                                       
                                          10
                                          
                                          years,
                                       
                                    
                                 
                                 
                                    
                                       
                                          ρ
                                          c
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          10
                                          
                                          percent
                                          ,
                                          
                                             ρ
                                             f
                                          
                                          =
                                          4
                                          
                                          percent
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             λ
                                             t
                                          
                                          
                                             (
                                             τ
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          0
                                          ,
                                          ∀
                                          t
                                          ,
                                          ∀
                                          τ
                                       
                                    
                                 
                              
                           
                        
                     
                  

In all numerical tests, we consider only one sample per iteration of the forward pass of the algorithm, since this is a best practice and performs well for the problem at hand. In this case, the confidence interval of the forward step can no longer be computed. As a stopping criterion, instead of tracking the convergence of the bounds, we observed that most of our cases had converged after a hundred iterations. This maximum number of iterations was used as the termination criteria. After convergence, to estimate a confidence interval to the lower bound of the method, we do in-sample evaluation of the forward step for a large number of samples.

We solve each case for 
                           
                              M
                              =
                              10
                           
                         different SAA instances, with 
                           
                              
                                 N
                                 t
                              
                              =
                              30
                           
                         samples per stage. Table 1
                         summarizes our findings. The Upper Bound refers to the last upper bound obtained by the first stage problem. The Forward averages and standard deviations for the in-sample evaluation of the forward step are presented next. The last two columns refer to out-of-sample evaluation, as will be explained next. All values units are in millions of dollars.

We first confirm that the SDDP algorithm indeed converged in our problem for most of the cases. The corresponding 95 percent confidence intervals are displayed
                           8
                        
                        
                           8
                           Please note that the standard deviations displayed in the following tables are given for the values rather than their averages. For the respective averages these standard deviations should be corrected by dividing by the square root of the employed sample size, i.e., by dividing these standard deviations by 
                                 
                                    
                                       2000
                                    
                                    =
                                    44.7
                                 
                              .
                         in Table 2
                        . Next, we address the relaxation of the integrality constraint in the backward step of our method.

We obtain an upper bound to the independent problem by analyzing its convex relaxation. Evaluating the relaxation policies in the same fashion as done in the integer problem, we built a comparison in Table 3
                        . One might believe that the integer policies would be far inferior, but, as our numerical results show, practically there is no gap. This is due to the bang-bang characteristic of the solutions to our problem. This feature is common in other cases in the literature (see, for instance, Dixit & Pindyck, 1994).

Recall that the obtained bounds refers to the approximated problem, built by assuming stagewise independency of randomly sampled scenarios. We are actually interested in the performance of the policies over the true problem. Fortunately, we may evaluate the policies of each SAA problem over the original 2000 series of the ‘true’ problem. We then can choose the best out-of-sample policy. Table 1 results show that most policies have expected result inferior to 46 million dollars. The best obtained policy consists of the deferral of investments, acquiring 100 percent in both projects in the third period, selling no forward contract. The second best available strategy (in instances 2, 3 and 4) delays investment only one year.

We now evaluate the performance of the dependent model. As in the independent case, Table 4
                         contains the upper bound and the in-sample and out-of-sample forward step simulations. Since the out-of-sample step now has several different cost-to-go functions to choose from, a projection onto the discrete states is necessary to recover the policy. We use an Euclidian distance criterion in this step.

The SDDP algorithm converges again, as noticed in all cases evaluated in Table 5
                        . The analysis of the convex relaxation in Table 6
                         also shows good results.

Regarding the quality of the policies out-of-sample, it is possible to see now in Tables 4 and 7
                         that most policies agree with the aforementioned deferral strategy, but with an overall improvement the longer we wait. Instances 3, 6 and 9 present out-of-sample results over 50 million dollars, all of them delaying investment but eventually investing 100 percent in both projects in any scenario.

In Instance 9, valued at 53.26 million dollars, we see that investment was postponed to the last period in all scenarios. In this last period both projects are chosen and on average 32 percent of the available contract capacity is acquired. Careful analysis shows that the model is actually searching for arbitrage opportunities, since it opts for no or maximum forwarding contracting depending on high or low observed forward prices. This behavior is expected in a risk-neutral approach.

We will consider the following risk measure

                           
                              (5.1)
                              
                                 
                                    R
                                    
                                       [
                                       Z
                                       ]
                                    
                                    :
                                    =
                                    
                                       (
                                       1
                                       −
                                       λ
                                       )
                                    
                                    E
                                    
                                       [
                                       Z
                                       ]
                                    
                                    +
                                    λ
                                    AV
                                    @
                                    
                                       R
                                       α
                                    
                                    
                                       [
                                       Z
                                       ]
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              AV
                              @
                              
                                 R
                                 α
                              
                              ,
                           
                         
                        α ∈ (0, 1), is the Average Value-at-Risk (also known as Conditional Value-at-Risk or Expected Shortfall) risk measure, and λ ∈ (0, 1). The 
                           
                              AV
                              @
                              
                                 R
                                 α
                              
                           
                         is usually defined in the context of loss random variables Street (2010). Since in our work we deal with a profit objective, we will conveniently define it as a measure of satisfaction or utility functional over a profit random variable Z as follows

                           
                              (5.2)
                              
                                 
                                    AV
                                    @
                                    
                                       R
                                       α
                                    
                                    
                                       [
                                       Z
                                       ]
                                    
                                    :
                                    =
                                    V
                                    @
                                    
                                       R
                                       α
                                    
                                    
                                       [
                                       Z
                                       ]
                                    
                                    +
                                    
                                       α
                                       
                                          −
                                          1
                                       
                                    
                                    E
                                    
                                       
                                          [
                                          Z
                                          −
                                          V
                                          @
                                          
                                             R
                                             α
                                          
                                          
                                             [
                                             Z
                                             ]
                                          
                                          ]
                                       
                                       −
                                    
                                    .
                                 
                              
                           
                        Here 
                           
                              
                                 
                                    [
                                    a
                                    ]
                                 
                                 −
                              
                              =
                              min
                              
                                 {
                                 0
                                 ,
                                 a
                                 }
                              
                           
                         and 
                           
                              
                                 V
                                 @
                                 
                                    R
                                    α
                                 
                                 
                                    
                                       [
                                       Z
                                       ]
                                    
                                    :
                                    =
                                    inf
                                    {
                                    t
                                    :
                                 
                                 
                                    F
                                    Z
                                 
                              
                              
                                 
                                    (
                                    t
                                    )
                                 
                                 ≥
                                 α
                                 }
                              
                           
                         with FZ
                        (·) being the cumulative distribution function of the random variable Z.

The dynamic programming equations associated with risk measure (5.1) are obtained from Eqs. (3.1)–(3.4) by replacing Eq. (3.3) with

                           
                              (5.3)
                              
                                 
                                    
                                       Q
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          y
                                          t
                                       
                                       ,
                                       
                                          z
                                          t
                                       
                                       ,
                                       
                                          ξ
                                          t
                                       
                                       )
                                    
                                    :
                                    =
                                    
                                       R
                                       
                                          
                                             |
                                          
                                          
                                             ξ
                                             t
                                          
                                       
                                    
                                    
                                       [
                                       
                                          Q
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             y
                                             t
                                          
                                          ,
                                          
                                             z
                                             t
                                          
                                          ,
                                          
                                             ξ
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                    ,
                                 
                              
                           
                        where

                           
                              (5.4)
                              
                                 
                                    
                                       R
                                       
                                          
                                             |
                                          
                                          
                                             ξ
                                             t
                                          
                                       
                                    
                                    
                                       [
                                       ·
                                       ]
                                    
                                    :
                                    =
                                    
                                       (
                                       1
                                       −
                                       λ
                                       )
                                    
                                    E
                                    
                                       [
                                       
                                       ·
                                       
                                       |
                                       
                                          ξ
                                          t
                                       
                                       ]
                                    
                                    +
                                    λ
                                    AV
                                    @
                                    
                                       R
                                       α
                                    
                                    
                                       [
                                       
                                       ·
                                       
                                       |
                                       
                                          ξ
                                          t
                                       
                                       ]
                                    
                                 
                              
                           
                        is the conditional analogue of the risk measure 
                           R
                        .

While in the risk neutral approach we discounted the cashflows in the real measure, using the appropriate discounting by ρc
                        , here a small adjustment is necessary. Since we are using a coherent measure of risk, 
                           
                              R
                              [
                              Z
                              ]
                           
                         corresponds to a certainty equivalent, thus we must use the risk free rate ρf
                        , as would be done in a real option pricing framework to avoid double counting the risk (see Damodaran, 2012 for more details).

As in the risk neutral case, we present Table 8
                         to summarize our findings. Here we consider 
                           
                              
                                 N
                                 t
                              
                              =
                              50
                           
                         samples per stage, for all t, 
                           
                              α
                              =
                              0.1
                           
                         and 
                           
                              λ
                              =
                              0.4
                           
                        . We can no longer use the forward pass in-sample simulation to obtain a confidence interval to the lower bound of the problem. Here, we would expect that an increase in the risk aversion (given by λ) would correspond to a reduction in the uncertainty of the policy. In Fig. 1
                         we plot the out-of-sample expected return versus expected return minus AV@R of the different samples for several different risk aversion levels. It is possible to notice that the anticipated relation between risk aversion and policy uncertainty did not occur.

We repeat the tests considering the dependent approach. As before, in-sample and out-of-sample results are displayed in Table 9
                        . Again, we cannot evaluate the convergence using the forward simulation since it is not the lower bound to the method in the risk averse case. We repeat the previous experiment and sample some problems with different values for λ. In Fig. 2
                         it is possible to see that an efficient frontier was built by sampling different problems. One would select a policy that best represents risk aversion from this set of Pareto optimal solutions.

Analysis of the solutions show that risk averse policies in general agree with postponement of the investment and acquisition of 100% shares on both projects, as in the risk-neutral case. Here, the main difference is that, the higher the risk aversion level, the bigger the amount of forward contracts is signed.This means, the proposed policies reduce the cash flow uncertainty by acquiring some amount of forward contracts.

@&#CONCLUSIONS AND FUTURE WORK@&#

Valuation of assets in an environment of high uncertainty is hard to accomplish and is under active research investigation. In the energy industry, proper valuation plays a major role due to the high volatilities associated with the sources of uncertainty of this business. The proposed approach, while somewhat heuristic, in practical instances may present near optimal solutions, due to the bang-bang feature of the problem. This may encourage its application to other classes of problems. The policies provided by the model can be compared out of sample to any strategy otherwise devised by a decision maker by introducing some additional constraints to the presented solution approach. It is thus very easy to gain insight in solution quality.

One of the involved difficulties is to build a scenario tree that approximates the true problem in a “best” way. We obtained good results with our price regression, but there is no general case approximation.

The risk neutral setting generates expected value maximizing policies that only take contracts for arbitrage purposes. The risk averse policies are consistent with investor behavior, acquiring contracts to reduce risk exposure. The risk premium associated with the forward contracts should be evaluated by any firm considering using this model, taking into account their views on the market structure and their own risk preferences.

Future work includes improvements in the stochastic models, particularly in the estimation of the risk premium and modelling of the generated power. We assumed zero market risk premium for our analysis, since we understand that practitioners would display their own market risk model preferences. There is extensive literature on estimating the market risk premium for European and other markets but, on the Brazilian market, due to the lack of publicly available future contract data, there is very limited literature. Nonetheless, even in most mature energy markets, estimation of forward curves and its associated risk premiums is still no simple task and several approaches have been considered. So far, promising results for American and European markets have been found with factor model approaches (Lucia & Schwartz, 2002) and multi-factor term structure models using the Heath, Jarrow & Morton (HJM) framework (Koekebakker & Ollmar, 2005). Renewable energy models for monthly generation using the LASSO method such as Souto et al. (2014) also show improvements over the VAR model that is generally used and applied in this work.

@&#ACKNOWLEDGMENTS@&#

We are grateful for the insightful comments and the improvements suggested by two anonymous referees.

The following notation is used throughout the paper


                     
                        
                           
                              
                              
                              
                                 
                                    
                                       
                                          
                                             n
                                             ,
                                             j
                                          
                                       
                                    
                                    Total number of investment projects, index for project
                                 
                                 
                                    
                                       
                                          
                                             T
                                             ,
                                             t
                                             ,
                                             τ
                                          
                                       
                                    
                                    Planning horizon (years), index for yearly periods, index for monthly periods
                                 
                                 
                                    
                                       
                                          
                                             h
                                             τ
                                          
                                       
                                    
                                    Hours in month 
                                          τ
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             E
                                             τ
                                             j
                                          
                                       
                                    
                                    Power (in Megawatt) generated in month 
                                          τ
                                        for project 
                                          j
                                        (random)
                                 
                                 
                                    
                                       
                                          
                                             P
                                             τ
                                          
                                       
                                    
                                    Energy spot price (in Dollars/Megawatt-hours) in month 
                                          τ
                                        (random)
                                 
                                 
                                    
                                       
                                          
                                             f
                                             t
                                          
                                       
                                    
                                    Price (in Dollars/Megawatt-hours) of forward contract in year 
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                d
                                                j
                                             
                                             ,
                                             D
                                          
                                       
                                    
                                    Physical guarantee (in Megawatt) of project 
                                          
                                             j
                                             ,
                                          
                                        maximum power under contract 
                                          
                                             D
                                             =
                                             
                                                d
                                                1
                                             
                                             +
                                             ⋯
                                             ,
                                             +
                                             
                                                d
                                                n
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             v
                                             j
                                          
                                       
                                    
                                    Present value (in Dollars) of investment cost of project 
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          ϱ
                                       
                                    
                                    Present value of an annuity with horizon equal to project lifetime
                                 
                                 
                                    
                                       
                                          
                                             ρ
                                             f
                                          
                                       
                                    
                                    Annual risk free discount rate
                                 
                                 
                                    
                                       
                                          
                                             ρ
                                             c
                                          
                                       
                                    
                                    Annual discount rate for risky cashflows
                                 
                                 
                                    
                                       
                                          l
                                       
                                    
                                    Project lifetime in years
                                 
                                 
                                    
                                       
                                          b
                                       
                                    
                                    Project build time in years
                                 
                                 
                                    
                                       
                                          
                                             a
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             n
                                             +
                                             1
                                          
                                        dimensional vector of coefficients for initial cash flow upon investment in period 
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             c
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             n
                                             +
                                             1
                                          
                                        dimensional vector of coefficients for subsequent cash flow for period 
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             x
                                             t
                                          
                                       
                                    
                                    Binary decision variable whether to invest or not in year 
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             r
                                             t
                                             j
                                          
                                       
                                    
                                    Nonnegative decision variable indicating fraction of project 
                                          j
                                        to purchase in year 
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             q
                                             t
                                          
                                       
                                    
                                    Nonnegative decision variable indicating amount of forward contract 
                                          
                                             q
                                             t
                                          
                                        (as a fraction of maximum amount 
                                          D
                                       ) to sell in year 
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             y
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             n
                                             +
                                             1
                                          
                                        dimensional vector of continuous decision variables 
                                          
                                             (
                                             
                                                q
                                                t
                                             
                                             ,
                                             
                                                r
                                                t
                                                1
                                             
                                             ,
                                             ⋯
                                             ,
                                             
                                                r
                                                t
                                                n
                                             
                                             )
                                          
                                        for period 
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             z
                                             t
                                          
                                       
                                    
                                    Binary variable taking a value of one if an investment has already been made in or before period 
                                          t
                                        and zero otherwise
                                 
                                 
                                    
                                       
                                          
                                             Y
                                             t
                                          
                                       
                                    
                                    Constraints on the continuous decisions variables for period 
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ξ
                                             t
                                          
                                       
                                    
                                    Random data for period 
                                          t
                                       
                                    
                                 
                              
                           
                        
                     
                  

Supplementary material associated with this article can be found, in the online version, at 10.1016/j.ejor.2015.10.013.


                     
                        
                           Image
                           
                        
                     
                  

@&#REFERENCES@&#

