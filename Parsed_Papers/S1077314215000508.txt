@&#MAIN-TITLE@&#A simulation based method for vehicle motion prediction

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A new methodology for an on-road vehicle motion prediction for several seconds.


                        
                        
                           
                           Our algorithm is operated on a stereo camera system mounted on a moving vehicle.


                        
                        
                           
                           We use a vehicle motion model based on the Gaussian Mixture Model (GMM).


                        
                        
                           
                           The Rapidly-Exploring Random Tree (RRT) allows to consider surrounding environments.


                        
                        
                           
                           We propose a simulation based method to combine the results of the RRT and GMM.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

On-road vehicle motion prediction

Rapidly-exploring random tree

Gaussian mixture model

Simulation

@&#ABSTRACT@&#


               
               
                  The movement of a vehicle is much affected by surrounding environments such as road shapes and other traffic participants. This paper proposes a new vehicle motion prediction method to predict future motion of an on-road vehicle which is observed by a stereo camera system mounted on a moving vehicle. Our proposed algorithm considers not only the history movement of the observed vehicle, but also the environment configuration around the vehicle. To find feasible paths under a dynamic road environment, the Rapidly-Exploring Random Tree (RRT) is used. A simulation based method is then applied to generate future trajectories by combining results from RRT and a motion prediction algorithm modelled as a Gaussian Mixture Model (GMM). Our experiments show that our approach can predict future motion of a vehicle accurately, and outperforms previous works where only motion history is considered for motion prediction.
               
            

@&#INTRODUCTION@&#

Being able to predict the future motions of vehicles is important especially in Advanced Driver Assistance Systems (ADAS) [1] and autonomous car systems [2]. Unique in a vehicle system, the motions of vehicles are constrained by a road network, steering geometry as well as their momentum in speed. Using the information as constraints, we are able to predict the future motions of a vehicle.

In current state-of-the-art technologies in vehicle motion prediction, a number of algorithms have been developed to predict the motions of vehicles captured by surveillance cameras in a static environment [3]. Besides, more and more researches are interested in predicting the motions of vehicles under dynamic environment where input video is captured by a car-mounted camera on a moving car [2,4]. By predicting the motions of surrounding vehicles around a moving car, better safety precaution can be installed in the ADAS and autonomous car.

In this paper, we propose a motion planning based algorithm to predict the motion of a vehicle observed by a stereo camera rig mounted on a moving vehicle under dynamic environments. In particular, the Rapidly-Exploring Random Tree (RRT) [5] is applied to incrementally sample the future motion of the observed vehicle based on its motion history and road configuration. Different from conventional RRT where the objective is just to find routes to a goal, we use the routes as reference paths to simulate future movement. This allows us to achieve a more accurate motion prediction, and a longer range of prediction.

In our setting, we use road networks from the Open Street Map (OSM) [6] to set possible goal points for RRT. In addition, we use the satellite map from the Google Earth [7] to configure road environments that include information about boundaries and lanes of roads. To detect and localize positions of vehicles by the camera system, we use the Deformable Part Model detector [8]. Since our focus is to predict the future motion of a vehicle, we assume the information about the road network and the surrounding environment is accurate.

We tested our algorithm using real road data sequences from the KITTI vision benchmark suite data set [9] with ground truth evaluation to estimate prediction accuracy. We have also compared our results with prior methods for vehicle motion prediction. The results show that using motion planning helps to enhance accuracy of prediction of future trajectories.

The remainder of this paper follows this outline. Section 2 reviews related works in vehicle motion prediction and motion planning. Section 3 defines our problem. Section 4 describes the configuration of our environment data. Section 5 presents our method to model motion history. Section 6 details our proposed motion prediction algorithm. Section 7 evaluates the performance of our algorithm. Finally, our paper is concluded in Section 8.

@&#RELATED WORK@&#

We review vision based approaches for vehicle motion prediction. The majority of previous works in vehicle motion prediction focus on a static setting of a surveillance camera installed at intersections of roads or highways [10–13].

In [10], Hu et al. use a chain of Gaussian distribution to represent motion patterns, and moving objects of a scene are clustered according to the estimated motion patterns. In [11], a Hidden Markov Model (HMM) is used to represent temporal sequences of sub-trajectories of moving objects. This work is later extended by Vasquez et al. [12] who proposed the growing HMM which incrementally learns and predicts the motions of moving objects. Recently, Atev et al. [13] have also presented a clustering based algorithm to estimate and predict vehicle trajectories.

There are also works that can be applied to car-mounted camera where background environments are dynamically changing. Using driving state information, such as velocity, acceleration and yaw rate, Barth and Franke [14] present a short time motion prediction algorithm based on motion extrapolation. Hermes et al. [15,16] and Wiest et al. [17] introduce methods which classify trajectory data that are represented as sequences of velocity and yaw rate. In [15,16], the quaternion-based rotationally invariant longest common subsequence (QRLCS) metric is proposed to measure similarity between motion trajectories. The QRLCS metric is then combined with a radial basis function classifier to track and predict motion hypotheses. In their method, the particle filter is applied to estimate the velocity and yaw rate of vehicles in a video. In [17], motion trajectories are approximated by the Chebyshev polynomials, and are modelled as a variational Gaussian Mixture Model. Ref. [18] introduced a threat assessment system based on the Monte Carlo Sampling.

For more information about vehicle motion prediction including non-vision based techniques, there is a recent survey paper [19] which introduces diverse motion prediction and risk assessment methods.

The Rapidly-Exploring Random Tree (RRT) [5] is one of the most representative sampling based motion planning algorithms. To plan a motion path, RRT incrementally expands a tree by randomly sampling a new path in a short time interval in a free space until a feasible path to a goal position is detected. The incremental nature of RRT facilitates fast on-line exploration under dynamic environments. From the original RRT, many variants have been emerged for various purposes. In [20,21], the availability of RRT is extended to a non-linear system with dynamic constraints. [22] proves that solutions of the original RRT are not optimal, and introduces RRT∗ which guarantees asymptotic optimality of their solutions. There are also many works which applied RRT in real platforms [23–25].

Our work provides a unique approach for vehicle motion prediction by combining motion planning in the motion prediction problem. The motion planning algorithm allows us to predict longer motion trajectories, and improves the performance of a previous algorithm by taking environment configurations into account during the motion prediction. In order to combine these two algorithms elegantly, we suggest a simulation-based method which takes into account kinematic constraints of a vehicle and environmental configurations. Using the reference paths generated by RRT, and the motion model based on the Gaussian Mixture Model (GMM), we simulate the future motion of a vehicle. Since multiple trajectories can be simulated, we evaluate the simulated trajectories by several criteria such as environment cost and distance with the reference path. The most likely trajectory is returned as our predicted vehicle motion.

We first define the vehicle motion prediction problem. In our work, we use a car-mounted camera on a moving vehicle (ego vehicle) to capture other vehicles on a road. Without loss of generality, we consider the problem to predict the future movement of a single target vehicle. Traffic participants except the target vehicle are considered as dynamic obstacles.

The input data for our problem are a history trajectory 
                           
                              
                                 
                                    T
                                 
                                 
                                    h
                                 
                              
                           
                         of the target vehicle and environment data. The history trajectory 
                           
                              
                                 
                                    T
                                 
                                 
                                    h
                                 
                              
                           
                         consists of velocities and yaw rates (details will be given in Section 3.2) of the target vehicle in past few seconds, and the environment data contains information of a road network which describes locations of roads and the connectivity among them, and a cost map which describes static and dynamic obstacles around the target vehicle. More specific definitions about the environment data will be given in Section 4. Our goal is to predict the future trajectory 
                           
                              
                                 
                                    T
                                 
                                 
                                    f
                                 
                              
                           
                         of the target vehicle in terms of velocities and yaw rates a few seconds into the future.

The trajectory of a vehicle is represented as follow
                           
                              (1)
                              
                                 T
                                 =
                                 {
                                 (
                                 v
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 ,
                                 ω
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 )
                                 ,
                                 …
                                 ,
                                 (
                                 v
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       N
                                       -
                                       1
                                    
                                 
                                 )
                                 ,
                                 ω
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       N
                                       -
                                       1
                                    
                                 
                                 )
                                 )
                                 }
                              
                           
                        where v and 
                           
                              ω
                           
                         are velocity and yaw rate at each timestamp 
                           
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                           
                        . The physical time interval between the timestamps depends on a sampling rate of data capturing. In our case, data are collected at 10 timestamps per second.

Since our data are captured on a moving vehicle, they are influenced by the ego motion of the cameras mounted on the ego vehicle. In order to avoid this problem, we transfer the observed data into fixed coordinates with respect to the environment data. In this section, we will define two coordinates, absolute coordinate and relative coordinate. Fig. 1
                         shows the relation between the absolute coordinate (super-script a) and the relative (ego) coordinate (super-script r).

Note that, because the ground is usually flat, we drop y-direction information (height information) for simplicity and use only x- and z-information, i.e. geolocation, for the remaining part of the paper.

To transform from the relative coordinate to the absolute coordinate, homogeneous transformation matrix 
                              
                                 
                                    
                                       G
                                    
                                    
                                       a
                                    
                                 
                                 (
                                 t
                                 )
                              
                            is used which is cumulatively calculated at each frame that contains translation and rotation information of the prior motion of the ego vehicle.
                              
                                 (2)
                                 
                                    
                                       
                                          G
                                       
                                       
                                          a
                                       
                                    
                                    (
                                    t
                                    )
                                    =
                                    
                                       
                                          G
                                       
                                       
                                          a
                                       
                                    
                                    (
                                    t
                                    -
                                    1
                                    )
                                    ×
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      cos
                                                      (
                                                      d
                                                      θ
                                                      )
                                                   
                                                   
                                                      sin
                                                      (
                                                      -
                                                      d
                                                      θ
                                                      )
                                                   
                                                   
                                                      dx
                                                   
                                                
                                                
                                                   
                                                      sin
                                                      (
                                                      d
                                                      θ
                                                      )
                                                   
                                                   
                                                      cos
                                                      (
                                                      d
                                                      θ
                                                      )
                                                   
                                                   
                                                      dz
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 dx
                                 ,
                                 
                                 dz
                              
                            and 
                              
                                 d
                                 θ
                              
                            are translational and rotational changes during 1 timestamp period on the relative coordinate at time t. In this paper, 
                              
                                 dx
                                 ,
                                 
                                 dz
                              
                            and 
                              
                                 d
                                 θ
                              
                            are obtained from a high-precision IMU installed on the ego vehicle (OXTS RT 3003 used in KITTI data set – velocity accuracy: 0.05km/h RMS, bias of angular rate: 
                              
                                 0.01
                                 °
                                 /
                                 s
                              
                            
                           
                              
                                 1
                                 σ
                              
                            
                           [26]).

In our problem setting, the origin of the absolute coordinate is aligned with the origin of the relative coordinate at the first frame, and we align the x- and z-axis with the east and north directions respectively. Therefore, for the first transformation matrix 
                              
                                 
                                    
                                       G
                                    
                                    
                                       a
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 ,
                                 
                                 (
                                 dx
                                 ,
                                 dz
                                 )
                              
                            is set as zero, and 
                              
                                 d
                                 θ
                              
                            can be calculated by subtracting 
                              
                                 90
                                 °
                              
                            from the heading angle of the GPS on the ego vehicle, because the z-axis of the relative coordinate is aligned with the heading direction of the ego vehicle.

In order to register GPS based environment data such as road network and obstacles into the absolute coordinate, we explain the conversion from the world coordinate, which is based on the longitude and latitude, to the absolute coordinate, which is based on the meter.

We assume the earth is a perfect sphere with constant radius 
                              
                                 
                                    
                                       R
                                    
                                    
                                       earth
                                    
                                 
                              
                            (6,371,000m) and use simple equations to convert a position on the world coordinate, 
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       w
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       w
                                    
                                 
                                 )
                              
                           , into a position on the absolute coordinate, 
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       a
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       a
                                    
                                 
                                 )
                              
                           .
                              
                                 (3)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      w
                                                   
                                                
                                                =
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      w
                                                   
                                                
                                                -
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      a
                                                      _
                                                      o
                                                   
                                                   
                                                      w
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      z
                                                   
                                                   
                                                      w
                                                   
                                                
                                                =
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      w
                                                   
                                                
                                                -
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      a
                                                      _
                                                      o
                                                   
                                                   
                                                      w
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      a
                                                   
                                                
                                                =
                                                (
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      w
                                                   
                                                
                                                
                                                ∗
                                                
                                                π
                                                ÷
                                                180
                                                )
                                                
                                                ∗
                                                
                                                (
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      earth
                                                   
                                                
                                                
                                                ∗
                                                
                                                cos
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      a
                                                      _
                                                      o
                                                   
                                                   
                                                      w
                                                   
                                                
                                                )
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      a
                                                   
                                                
                                                =
                                                (
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      z
                                                   
                                                   
                                                      w
                                                   
                                                
                                                
                                                ∗
                                                
                                                π
                                                ÷
                                                180
                                                )
                                                
                                                ∗
                                                
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      earth
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       a
                                       _
                                       o
                                    
                                    
                                       w
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       a
                                       _
                                       o
                                    
                                    
                                       w
                                    
                                 
                                 )
                              
                            is the origin of the absolute coordinate with the longitude and latitude.

We extract relative information of observed vehicles such as trajectory, set of linear and angular velocities in our definition, using the Kalman filter (Section 5) to cover sensor noise. We use the observations compensated by the IMU of the ego vehicle for the Kalman filter, which is advantageous to extract such relative information because of the usage of high-precision sensing data from the IMU.

However, there must be measurement drift for positional information on the absolute coordinate, when the ego motion is only compensated by the IMU. So, we correct the positional information after the filtering process using the GPS data of the ego vehicle (open sky localization errors 
                              
                                 <
                              
                           5cm with RTK correction signals at KITTI data set [9]). Therefore we can obtain positional information which does not have drift error.

In every frame, the corrected position 
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       c
                                    
                                    
                                       a
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       c
                                    
                                    
                                       a
                                    
                                 
                                 )
                              
                            and heading angle 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       c
                                    
                                    
                                       a
                                    
                                 
                              
                            are calculated by the homogeneous transformation matrix 
                              
                                 
                                    
                                       G
                                    
                                    
                                       c
                                    
                                 
                                 (
                                 t
                                 )
                              
                            as follow
                              
                                 (4)
                                 
                                    
                                       
                                          G
                                       
                                       
                                          c
                                       
                                    
                                    (
                                    t
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      cos
                                                      (
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            r
                                                            _
                                                            o
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      sin
                                                      (
                                                      -
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            r
                                                            _
                                                            o
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            r
                                                            _
                                                            o
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      sin
                                                      (
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            r
                                                            _
                                                            o
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      cos
                                                      (
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            r
                                                            _
                                                            o
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            r
                                                            _
                                                            o
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ×
                                    
                                       
                                          G
                                       
                                       
                                          a
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    (
                                    t
                                    )
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            c
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            c
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          G
                                       
                                       
                                          c
                                       
                                    
                                    (
                                    t
                                    )
                                    ×
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          c
                                       
                                       
                                          a
                                       
                                    
                                    =
                                    
                                       
                                          θ
                                       
                                       
                                          a
                                       
                                    
                                    +
                                    a
                                    tan
                                    2
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          c
                                       
                                    
                                    (
                                    t
                                    )
                                    (
                                    2
                                    ,
                                    1
                                    )
                                    ,
                                    
                                    
                                       
                                          G
                                       
                                       
                                          c
                                       
                                    
                                    (
                                    t
                                    )
                                    (
                                    1
                                    ,
                                    1
                                    )
                                    
                                    )
                                 
                              
                           where 
                              
                                 
                                    
                                       x
                                    
                                    
                                       r
                                       _
                                       o
                                    
                                    
                                       a
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       z
                                    
                                    
                                       r
                                       _
                                       o
                                    
                                    
                                       a
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       r
                                       _
                                       o
                                    
                                    
                                       a
                                    
                                 
                              
                            are the position and angle of the origin of the relative coordinate at the absolute coordinate at time t. 
                              
                                 
                                    
                                       x
                                    
                                    
                                       r
                                       _
                                       o
                                    
                                    
                                       a
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       z
                                    
                                    
                                       r
                                       _
                                       o
                                    
                                    
                                       a
                                    
                                 
                              
                            can be obtained from the GPS mounted on the ego vehicle using the method to convert the world coordinate to the absolute coordinate. 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       r
                                       _
                                       o
                                    
                                    
                                       a
                                    
                                 
                              
                            can be calculated by subtracting 
                              
                                 90
                                 °
                              
                            from the heading angle of the GPS. The two numbers in the parenthesis, (2,1) and (1,1), after 
                              
                                 
                                    
                                       G
                                    
                                    
                                       c
                                    
                                 
                                 (
                                 t
                                 )
                              
                            are column and row indices of 
                              
                                 
                                    
                                       G
                                    
                                    
                                       c
                                    
                                 
                                 (
                                 t
                                 )
                              
                            respectively.

This section describes our environment data and how they are converted to adequate formats for our motion prediction algorithm. We use the road network data extracted from the Open Street Map (OSM) [6]. In addition, we extract the road lanes and boundaries manually from a satellite map of the Google Earth [7] as static obstacles. The detected vehicles from a stereo depth camera are considered as dynamic obstacles. These obstacle data are encoded into a cost map.

The road network is used to estimate rough future routes of tens of meters. The potential destinations of the routes are set as goal points for the motion planning algorithm. The OSM supplies many kinds of road data. We use the locations and connectivity of roads to construct a connectivity graph. After that, any simple graph searching algorithm can be used for routing roads. Fig. 2
                         shows an example where the OSM road data are registered on the absolute coordinate. Although there are 1–2m of registration error, rough locations of goal points are sufficient to guide the motion planning algorithm.

The road boundaries and lanes are static obstacles. In a real situation, it is challenging to collect these data automatically from a mounted camera. Thus, we instead use manually labelled road boundaries and lanes on a Google Earth satellite map for simplicity. In this paper, static obstacles except road boundaries and lanes are not considered. In a real world situation, there are many dynamic obstacles such as vehicles, pedestrians, and bicycles. In this paper, we only consider vehicles as dynamic obstacles on a road. The method to localize vehicles will be described in Section 5. In our implementation, due to the high precision GPS of the KITTI data set (errors 
                           
                              <
                           
                        5cm [9]), positions of the ego vehicle and other observed vehicles are well matched with the labelled satellite map without correction.

From the detected obstacles, we need to convert them into a cost map. We represent the cost map using 10
                        
                           
                              ×
                           
                        
                        10cm grid cells for fast evaluation of paths. First, cost is assigned near the labels of road boundaries and lanes. We give smaller cost to free areas, and infinite cost to inaccessible areas. Fig. 3
                         shows an example of the labels and the corresponding cost map. Before an experiment, we construct the cost map in advance which covers all areas of the absolute coordinate around a test sequence.

To put dynamic obstacles into the cost map, we apply the Kalman filter prediction (will be described in Section 5) to roughly predict future locations of the vehicles by only considering their motion history without environment data. Note that we can also apply our motion prediction to each vehicle in a scene, but we only use the Kalman filter prediction to save computation since other vehicles are not our target.

In this section, we describe our method to extract a history trajectory 
                        
                           
                              
                                 T
                              
                              
                                 h
                              
                           
                        
                     , in the format in Eq. (1), from a vehicle trace which is a set of history positions of a vehicle. Our algorithm uses data from a stereo camera and a high precision GPS/IMU mounted on a vehicle. We use a tracking by detection algorithm [27] based on the deformable part model detector [8] to localize 2D positions of vehicles on each frame of the left camera image. After that, in order to localize vehicles in 3D, we build a stereo disparity map using the Semi-Global Matching [28]. Fig. 4
                      shows one detected vehicle enclosed by the bounding box.

A 3D location 
                        
                           (
                           
                              
                                 x
                              
                              
                                 r
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 r
                              
                           
                           ,
                           
                              
                                 z
                              
                              
                                 r
                              
                           
                           )
                        
                      of a vehicle is calculated from a 2D location 
                        
                           (
                           i
                           ,
                           j
                           )
                        
                      in a camera frame and its disparity d. In case of d, we use the median disparity within the detected bounding box.
                        
                           (5)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                r
                                             
                                          
                                          =
                                          (
                                          i
                                          -
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          
                                          ∗
                                          
                                          base
                                          /
                                          d
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                r
                                             
                                          
                                          =
                                          (
                                          j
                                          -
                                          
                                             
                                                c
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          
                                          ∗
                                          
                                          base
                                          /
                                          d
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                r
                                             
                                          
                                          =
                                          f
                                          
                                          ∗
                                          
                                          base
                                          /
                                          d
                                       
                                    
                                 
                              
                           
                        
                     The variable 
                        
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 j
                              
                           
                           )
                        
                      is the principal point of the camera. The f is the focal length of the camera and the base is the distance between two cameras. Since we assumed constant road height as described in Section 3.3, we discard the y-direction information 
                        
                           (
                           y
                           ,
                           
                              
                                 v
                              
                              
                                 y
                              
                           
                           …
                           )
                        
                     .

The trace is a set of history locations on the absolute coordinate (
                        
                           
                              
                                 x
                              
                              
                                 a
                              
                           
                           ,
                           
                              
                                 z
                              
                              
                                 a
                              
                           
                        
                     ) which are transformed from the relative locations (
                        
                           
                              
                                 x
                              
                              
                                 r
                              
                           
                           ,
                           
                              
                                 z
                              
                              
                                 r
                              
                           
                        
                     ) by the transformation matrix 
                        
                           
                              
                                 G
                              
                              
                                 a
                              
                           
                           (
                           t
                           )
                        
                      in Eq. (2).
                        
                           (6)
                           
                              trace
                              =
                              {
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              ,
                              
                                 
                                    z
                                 
                                 
                                    a
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              )
                              ,
                              …
                              ,
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    now
                                 
                              
                              )
                              ,
                              
                                 
                                    z
                                 
                                 
                                    a
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    now
                                 
                              
                              )
                              )
                              }
                           
                        
                     where 
                        
                           
                              
                                 t
                              
                              
                                 now
                              
                           
                        
                      is the timestamp of the current frame.

From now, we omit the super-script notation a (absolute) for simplicity of representation and assume everything is represented on the absolute coordinate.

We extract a history trajectory 
                        
                           
                              
                                 T
                              
                              
                                 h
                              
                           
                        
                      from the trace. Because there are some noises in the observed trace, we filter trace data using the Kalman filter. Since Kalman filter is updated as accumulative manner, the filtering is conducted once a frame using a newly added position of the trace 
                        
                           (
                           x
                           (
                           
                              
                                 t
                              
                              
                                 now
                              
                           
                           )
                           ,
                           z
                           (
                           
                              
                                 t
                              
                              
                                 now
                              
                           
                           )
                           )
                        
                     . The state model of the Kalman filter is
                        
                           (7)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                AS
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                Q
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                M
                                             
                                             
                                                k
                                             
                                          
                                          =
                                          
                                             
                                                CS
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                R
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     The vectors Q and R are process noise and measurement noise respectively.

The state vector S, the state transition model A and the measurement model C are given below
                        
                           (8)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                k
                                             
                                          
                                          =
                                          
                                             
                                                [
                                                x
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                                
                                                z
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      x
                                                   
                                                
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      z
                                                   
                                                
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                                ]
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          A
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            Δ
                                                            t
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            Δ
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          C
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     The state consists of the positions and velocities in the x and z directions. The Euclidean norm of the two velocity components (
                        
                           
                              
                                 v
                              
                              
                                 x
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           )
                           ,
                           
                              
                                 v
                              
                              
                                 z
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           )
                        
                     ) from the filtered state is used for a linear velocity 
                        
                           v
                           (
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           )
                        
                     .

The yaw rate 
                        
                           ω
                           (
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           )
                        
                      is also extracted from the filtered positions 
                        
                           (
                           x
                           (
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           )
                           ,
                           z
                           (
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           )
                           )
                        
                     . Firstly, a heading angle 
                        
                           θ
                           (
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           )
                        
                      of a vehicle is estimated from a 2m before point as shown in Fig. 5
                     . We do not use the direct differentiation to the history trace because it is sensitive to noises. Another merit of this method is that calculation of the heading angle for a stopped car is also possible. Now, the yaw rate 
                        
                           ω
                           (
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           )
                        
                      can be easily calculated from a series of the heading angles. In our case, we apply one more Kalman filtering as a state which consists of the heading angle and the yaw rate.
                        
                           (9)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                k
                                             
                                          
                                          =
                                          
                                             
                                                [
                                                θ
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                                
                                                ω
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                                ]
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          A
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            Δ
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          C
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     Since the linear velocity 
                        
                           v
                           (
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           )
                        
                      and the yaw rate 
                        
                           ω
                           (
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           )
                        
                      are not affected by the drift error of the absolute coordinate, they can be used as history trajectory 
                        
                           
                              
                                 T
                              
                              
                                 h
                              
                           
                        
                      in next section without conversion. However, the current filtered position (
                        
                           x
                           (
                           
                              
                                 t
                              
                              
                                 now
                              
                           
                           )
                           ,
                           z
                           (
                           
                              
                                 t
                              
                              
                                 now
                              
                           
                           )
                        
                     ) and heading angle 
                        
                           θ
                           (
                           
                              
                                 t
                              
                              
                                 now
                              
                           
                           )
                        
                     , which will be used for the initial state of the target vehicle, need to pass through the correction process described in Section 3.3.

In this section, we introduce our motion prediction algorithm combined with the Rapidly-Exploring Random Tree (RRT) which can produce more accurate future trajectories of the target vehicle by considering surrounding environment. A simulation based method to combine motion prediction and planning is described here.
                        Algorithm 1
                        Motion Prediction with RRT 
                              
                                 
                                    
                                    
                                       
                                          
                                             1. 
                                             Estimate future velocity set 
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         f
                                                      
                                                   
                                                
                                              from history trajectory 
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          
                                             2. 
                                             Set the state of the root node of tree 
                                                
                                                   Γ
                                                
                                              as the current state of the target vehicle.
                                       
                                       
                                          
                                             3. 
                                             Set goal points using a road network.
                                       
                                       
                                          
                                             4. 
                                             Take a list of samples, 
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                             , along the road network.
                                       
                                       
                                          
                                             5. 
                                             
                                             for
                                             each sample 
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                              in order of the sample list 
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             6. 
                                             Search feasible trajectories with RRT expansion combined with simulation process. (Algorithm 2)
                                       
                                       
                                          
                                             7. 
                                             
                                             end 
                                             
                                             for
                                          
                                       
                                       
                                          
                                             8. 
                                             Evaluate each simulated trajectory 
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                              in the set 
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         set
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          
                                             9. 
                                             Select some representative trajectories from 
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         set
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                             .
                                       
                                    
                                 
                              
                           
                        


                     Algorithm 1 shows the overall flow of the motion prediction algorithm. Line 1 is about the velocity prediction from a history trajectory 
                        
                           
                              
                                 T
                              
                              
                                 h
                              
                           
                        
                      which is described in Section 6.1. A velocity set 
                        
                           
                              
                                 V
                              
                              
                                 f
                              
                           
                        
                      estimated on this stage is used in the simulation process (Line 6) as a reference velocity set. Line 2–4 are preparation processes for RRT (root node setting, goal setting, batch sampling), and they are explained in Section 6.2. In line 6, RRT and the simulation process repeatedly generate feasible trajectories, and this stage is discussed in Section 6.3. Finally, the possible simulated trajectories are evaluated (Line 8). Some representative trajectories are selected according to the evaluation result (Line 9). Section 6.4 enumerates several evaluation criteria for the evaluation.

Ref. [17] introduces how to predict future motion of a vehicle from a history trajectory. Because our work utilizes this algorithm, we briefly describe the original one here. The objective of this algorithm is to estimate a future trajectory 
                           
                              
                                 
                                    T
                                 
                                 
                                    f
                                 
                              
                           
                         of a fixed temporal length from a history trajectory 
                           
                              
                                 
                                    T
                                 
                                 
                                    h
                                 
                              
                           
                         of a fixed spatial length. Both trajectories are represented as the format of Eq. (1).
                           
                              (10)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   h
                                                
                                             
                                             =
                                             {
                                             (
                                             v
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   now
                                                   -
                                                   N
                                                   +
                                                   1
                                                
                                             
                                             )
                                             ,
                                             ω
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   now
                                                   -
                                                   N
                                                   +
                                                   1
                                                
                                             
                                             )
                                             )
                                             ,
                                             …
                                             ,
                                             (
                                             v
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   now
                                                
                                             
                                             )
                                             ,
                                             ω
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   now
                                                
                                             
                                             )
                                             )
                                             }
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   f
                                                
                                             
                                             =
                                             {
                                             (
                                             v
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   now
                                                   +
                                                   1
                                                
                                             
                                             )
                                             ,
                                             ω
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   now
                                                   +
                                                   1
                                                
                                             
                                             )
                                             )
                                             ,
                                             …
                                             ,
                                             (
                                             v
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   now
                                                   +
                                                   M
                                                
                                             
                                             )
                                             ,
                                             ω
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   now
                                                   +
                                                   M
                                                
                                             
                                             )
                                             )
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        The number of elements of 
                           
                              
                                 
                                    T
                                 
                                 
                                    h
                                 
                              
                              ,
                              
                              N
                           
                        , changes continuously according to the velocities, because it depends on a fixed spatial length. On the other hand, the number of elements of 
                           
                              
                                 
                                    T
                                 
                                 
                                    f
                                 
                              
                              ,
                              
                              M
                           
                        , is fixed, because it depends on a fixed temporal length.

After that, each trajectory is approximated as 10 degree of Chebyshev coefficients [29] 
                        
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    h
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    f
                                 
                              
                              )
                           
                        , each of which consists of a 5 degree of velocity approximation (sub-script v) and 5 degree of yaw rate approximation (sub-script 
                           
                              ω
                           
                        ).
                           
                              (11)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   h
                                                
                                             
                                             =
                                             {
                                             
                                                
                                                   C
                                                
                                                
                                                   h
                                                   ,
                                                   v
                                                
                                             
                                             ,
                                             
                                                
                                                   C
                                                
                                                
                                                   h
                                                   ,
                                                   ω
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   f
                                                
                                             
                                             =
                                             {
                                             
                                                
                                                   C
                                                
                                                
                                                   f
                                                   ,
                                                   v
                                                
                                             
                                             ,
                                             
                                                
                                                   C
                                                
                                                
                                                   f
                                                   ,
                                                   ω
                                                
                                             
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        The elements of 
                           
                              
                                 
                                    C
                                 
                                 
                                    h
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    f
                                 
                              
                           
                         are represented as below
                           
                              (12)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   h
                                                   ,
                                                   v
                                                
                                             
                                             =
                                             
                                                
                                                   F
                                                
                                                
                                                   CA
                                                
                                             
                                             (
                                             5
                                             ,
                                             {
                                             v
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   now
                                                   -
                                                   N
                                                   +
                                                   1
                                                
                                             
                                             )
                                             ,
                                             …
                                             ,
                                             v
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   now
                                                
                                             
                                             )
                                             }
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   h
                                                   ,
                                                   ω
                                                
                                             
                                             =
                                             
                                                
                                                   F
                                                
                                                
                                                   CA
                                                
                                             
                                             (
                                             5
                                             ,
                                             {
                                             ω
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   now
                                                   -
                                                   N
                                                   +
                                                   1
                                                
                                             
                                             )
                                             ,
                                             …
                                             ,
                                             ω
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   now
                                                
                                             
                                             )
                                             }
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   f
                                                   ,
                                                   v
                                                
                                             
                                             =
                                             
                                                
                                                   F
                                                
                                                
                                                   CA
                                                
                                             
                                             (
                                             5
                                             ,
                                             {
                                             v
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   now
                                                   +
                                                   1
                                                
                                             
                                             )
                                             ,
                                             …
                                             ,
                                             v
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   now
                                                   +
                                                   M
                                                
                                             
                                             )
                                             }
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   f
                                                   ,
                                                   ω
                                                
                                             
                                             =
                                             
                                                
                                                   F
                                                
                                                
                                                   CA
                                                
                                             
                                             (
                                             5
                                             ,
                                             {
                                             ω
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   now
                                                   +
                                                   1
                                                
                                             
                                             )
                                             ,
                                             …
                                             ,
                                             ω
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   now
                                                   +
                                                   M
                                                
                                             
                                             )
                                             }
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    F
                                 
                                 
                                    CA
                                 
                              
                           
                         is a approximating function as Chebyshev coefficients. The first parameter of the function is a degree of the approximation and the second one is a target data set to be approximated.

Then, a 20 dimensional Gaussian Mixture Model (GMM) 
                           
                              p
                              (
                              
                                 
                                    C
                                 
                                 
                                    h
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    f
                                 
                              
                              )
                           
                         is constructed as a set of 
                           
                              
                                 
                                    C
                                 
                                 
                                    h
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    f
                                 
                              
                           
                         from training data. When predicting a future trajectory 
                           
                              
                                 
                                    T
                                 
                                 
                                    f
                                 
                              
                           
                         from a history trajectory 
                           
                              
                                 
                                    T
                                 
                                 
                                    h
                                 
                              
                           
                         using this model, the most probable 
                           
                              
                                 
                                    C
                                 
                                 
                                    f
                                 
                              
                           
                         is calculated as the mean of the conditional mixture density 
                           
                              p
                              (
                              
                                 
                                    C
                                 
                                 
                                    f
                                 
                              
                              |
                              
                                 
                                    C
                                 
                                 
                                    h
                                 
                              
                              )
                           
                        , and the most probable future trajectory 
                           
                              
                                 
                                    T
                                 
                                 
                                    f
                                 
                              
                           
                         is estimated from the most probable 
                           
                              
                                 
                                    C
                                 
                                 
                                    f
                                 
                              
                           
                         
                        [17].

This original GMM model 
                           
                              p
                              (
                              
                                 
                                    C
                                 
                                 
                                    h
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    f
                                 
                              
                              )
                           
                         will be used for one of the evaluation criteria in Section 6.4 for our work. However, for the simulation purpose, we use another GMM model which is little modified from the original one. Different with the original model, we do not consider future yaw rates. Our GMM model 
                           
                              p
                              (
                              
                                 
                                    C
                                 
                                 
                                    h
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    f
                                    ,
                                    v
                                 
                              
                              )
                           
                         is 20 dimensions but constructed as a set of 
                           
                              
                                 
                                    C
                                 
                                 
                                    h
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    f
                                    ,
                                    v
                                 
                              
                           
                         from training data, where 
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    f
                                    ,
                                    v
                                 
                              
                           
                         is a 10 degrees of Chebyshev approximation for future velocities.
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       f
                                       ,
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       CA
                                    
                                 
                                 (
                                 10
                                 ,
                                 {
                                 v
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       now
                                       +
                                       1
                                    
                                 
                                 )
                                 ,
                                 …
                                 ,
                                 v
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       now
                                       +
                                       M
                                    
                                 
                                 )
                                 }
                                 )
                              
                           
                        Therefore, when a history trajectory 
                           
                              
                                 
                                    T
                                 
                                 
                                    h
                                 
                              
                           
                         is given, we can estimate a future velocity set 
                           
                              
                                 
                                    V
                                 
                                 
                                    f
                                 
                              
                           
                         instead of a future trajectory 
                           
                              
                                 
                                    T
                                 
                                 
                                    f
                                 
                              
                           
                         by the same way with the original model using the conditional mixture density 
                           
                              p
                              (
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    f
                                    ,
                                    v
                                 
                              
                              |
                              
                                 
                                    C
                                 
                                 
                                    h
                                 
                              
                              )
                           
                        .
                           
                              (14)
                              
                                 
                                    
                                       V
                                    
                                    
                                       f
                                    
                                 
                                 =
                                 {
                                 v
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       now
                                       +
                                       1
                                    
                                 
                                 )
                                 ,
                                 …
                                 ,
                                 v
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       now
                                       +
                                       M
                                    
                                 
                                 )
                                 }
                              
                           
                        
                     

We exclude future yaw rates in our design, because only future velocities are needed for the simulation step in Section 6.3 as reference velocities.

When training the GMM, we use the ego motion information from the IMU data of total 86 driving sequences which are supplied from the KITTI data set [9]. The number of components of the GMM is set as 75 and 500 iterations are conducted for the EM algorithm. The spatial length for a history trajectory 
                           
                              
                                 
                                    T
                                 
                                 
                                    h
                                 
                              
                           
                         is set as 15m and the temporal length for a future velocity set 
                           
                              
                                 
                                    V
                                 
                                 
                                    f
                                 
                              
                           
                         is set as 3s.

The RRT algorithm repeatedly expands a tree 
                              
                                 Γ
                              
                            while updating the state of the target vehicle at newly added nodes using the simulation. Due to the tree structure, each node of the tree 
                              
                                 Γ
                              
                            has only one vehicle state originated from the root node. The simple relation between the tree 
                              
                                 Γ
                              
                            and simulation is represented in Fig. 6
                           . The tree 
                              
                                 Γ
                              
                            serves as a reference path for the simulation, and each node of the tree 
                              
                                 Γ
                              
                            saves the simulation state.

The state of each node is composed like below
                              
                                 (15)
                                 
                                    
                                       
                                          S
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    {
                                    τ
                                    ,
                                    
                                       
                                          c
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          s
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          s
                                       
                                    
                                    }
                                 
                              
                           
                           
                              
                                 τ
                              
                            is a simulation time at a node, and 
                              
                                 
                                    
                                       c
                                    
                                    
                                       n
                                    
                                 
                              
                            saves cost which is accumulated from the root. 
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       s
                                    
                                 
                                 )
                              
                            is a simulated position, and 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       s
                                    
                                 
                              
                            is a simulated heading angle at that time.

As the first step, the tree 
                              
                                 Γ
                              
                            should be initialized by setting the state of the root node. For the root node, 0 is assigned to 
                              
                                 τ
                              
                            and 
                              
                                 
                                    
                                       c
                                    
                                    
                                       n
                                    
                                 
                              
                           . Next, the current position and heading angle of the target vehicle are assigned to 
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       s
                                    
                                 
                              
                           . The method to get the current positional information of the target vehicle is described in Sections 3.3 and 5.

As introduced in Section 4.1, we use road network from the Open Street Map (OSM) [6] to set goal points. By using a graph searching algorithm like Depth First Search (DFS), we can easily set positions in front of certain distance as you can see in Fig. 2. Before that, the proper distance to the goals should be determined. If the distance is too long, the RRT algorithm consumes additional time to reach the goals. On the other hand, if the distance is too short, the simulation is not completed when arriving at the goals. Since the maximum distance 
                              
                                 
                                    
                                       d
                                    
                                    
                                       max
                                    
                                 
                              
                            which can be reached during the simulation can be estimated by the future velocity set 
                              
                                 
                                    
                                       V
                                    
                                    
                                       f
                                    
                                 
                              
                           , we are able to set the moderate distance to goals, 
                              
                                 
                                    
                                       d
                                    
                                    
                                       goal
                                    
                                 
                              
                           .
                              
                                 (16)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      max
                                                   
                                                
                                                =
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      f
                                                   
                                                
                                                ÷
                                                fps
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      goal
                                                   
                                                
                                                =
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      max
                                                   
                                                
                                                +
                                                max
                                                (
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      f
                                                   
                                                
                                                (
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      max
                                                   
                                                
                                                )
                                                
                                                ∗
                                                
                                                1.5
                                                ,
                                                10
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           where fps is frames per second, and 
                              
                                 
                                    
                                       τ
                                    
                                    
                                       max
                                    
                                 
                              
                            is the maximum simulation (prediction) time. 
                              
                                 
                                    
                                       τ
                                    
                                    
                                       max
                                    
                                 
                              
                            is identical to the temporal length of the future velocity set 
                              
                                 
                                    
                                       V
                                    
                                    
                                       f
                                    
                                 
                              
                           , because the elements of the set are used as reference velocities for the simulation. Because the simulation refers a point of certain meters front, 
                              
                                 
                                    
                                       d
                                    
                                    
                                       goal
                                    
                                 
                              
                            should be little longer than 
                              
                                 
                                    
                                       d
                                    
                                    
                                       max
                                    
                                 
                              
                           .

Originally, setting start and goal positions is enough preparation to start the RRT algorithm. However, we are able to avoid wasteful sampling by exploiting the road network data of the OSM. Since the road network gives the rough route to the goal points, we adopt a simple strategy which takes a set of samples along the route to improve efficiency of the algorithm. Fig. 7
                            shows an example of our strategy.

We control the number of samples and the scattering width by the number of road lanes 
                              
                                 
                                    
                                       N
                                    
                                    
                                       lane
                                    
                                 
                              
                           , which can be obtained from the OSM. In our problem setting, route samples are placed based on randomly uniform distribution of 2.5
                           
                              
                                 ∗
                              
                           
                           
                           
                              
                                 
                                    
                                       N
                                    
                                    
                                       lane
                                    
                                 
                              
                            samples per each meter of the route. In addition, we deploy 25
                           
                              
                                 ∗
                              
                           
                           
                           
                              
                                 
                                    
                                       N
                                    
                                    
                                       lane
                                    
                                 
                              
                            goal samples at each goal. All the samples are laterally scattered by randomly uniform distribution within [
                              
                                 -
                                 2
                                 
                                 ∗
                                 
                                 
                                    
                                       N
                                    
                                    
                                       lane
                                    
                                 
                                 ,
                                 2
                                 
                                 ∗
                                 
                                 
                                    
                                       N
                                    
                                    
                                       lane
                                    
                                 
                              
                           ] meters.

Next, samples located on inaccessible space, which is determined by the cost map, are discarded. The remaining samples are put into a list 
                              
                                 
                                    
                                       l
                                    
                                    
                                       s
                                    
                                 
                              
                            in which the samples are sorted by their location on the route. Front samples in the route precede in 
                              
                                 
                                    
                                       l
                                    
                                    
                                       s
                                    
                                 
                              
                           , and goal samples are located last. This ordering strategy allows RRT to make diverse and good quality paths for the simulation with a limited number of samples.


                        Algorithm 2 shows steps to expand RRT with the simulation process to find feasible trajectories. This simulation based method is motivated by prior motion planning research [24]. Algorithm 2 corresponds to Line 6 of Algorithm 1. This means that Algorithm 2 repeatedly performs to generate a lot of trajectory candidates until the sample list 
                           
                              
                                 
                                    l
                                 
                                 
                                    s
                                 
                              
                           
                         is exhausted.
                           Algorithm 2
                           Tree Expansion with Simulation 
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                1. Sort the node list 
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                 in the tree 
                                                   
                                                      Γ
                                                   
                                                 according to ease of connection with the sample 
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             
                                                
                                                2. Mix the node list 
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                 little bit.
                                          
                                          
                                             
                                                
                                                3. for
                                                each node 
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                 in order of 
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                4. 
                                                Get a reference path snippet 
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                   
                                                 connecting 
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             
                                                
                                                5. 
                                                
                                                if
                                                
                                                
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                   
                                                 is not feasible.
                                          
                                          
                                             
                                                
                                                6. 
                                                
                                                
                                                continue
                                             
                                          
                                          
                                             
                                                
                                                7. 
                                                
                                                end
                                                
                                                if
                                             
                                          
                                          
                                             
                                                
                                                8. 
                                                
                                                if
                                                
                                                
                                                   
                                                      τ
                                                   
                                                 at 
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                 
                                                
                                                   
                                                      <
                                                   
                                                 max simulation (prediction) time 
                                                   
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            max
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                9. 
                                                
                                                Simulate a trajectory snippet 
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                 by following 
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                   
                                                . The simulation starts at the state of 
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             
                                                10. 
                                                
                                                
                                                if
                                                
                                                
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                 is not feasible.
                                          
                                          
                                             
                                                11. 
                                                
                                                
                                                continue
                                             
                                          
                                          
                                             
                                                12. 
                                                
                                                
                                                end
                                                
                                                if
                                             
                                          
                                          
                                             
                                                13. 
                                                
                                                end
                                                
                                                if
                                             
                                          
                                          
                                             
                                                14. 
                                                
                                                if
                                                
                                                
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                 is a route sample.
                                          
                                          
                                             
                                                15. 
                                                
                                                
                                                Add 
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                 to 
                                                   
                                                      Γ
                                                   
                                                 and save the state of 
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             
                                                16. 
                                                
                                                else
                                             
                                          
                                          
                                             
                                                17. 
                                                
                                                
                                                Extract a simulated trajectory 
                                                   
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                 accumulated from the root node to 
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                , and add it into the simulated trajectory set 
                                                   
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            set
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             
                                                18. 
                                                
                                                end
                                                
                                                if
                                             
                                          
                                          
                                             
                                                19. 
                                                
                                                break
                                             
                                          
                                          
                                             
                                                20. end 
                                                
                                                for
                                             
                                          
                                       
                                    
                                 
                              
                           

In Line 1, all nodes in the tree 
                              
                                 Γ
                              
                            are sorted about how likely the vehicle state at each node propagates to the sample 
                              
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                              
                           . Although the Euclidean distance can be used as the evaluation criterion, it is inaccurate because the movement of a vehicle highly depends on their current state, e.g. speed and heading angle. Therefore, we use the Dubins path [30] which is a simple metric considering vehicle constraints. Refer Appendix A for more detail.

In addition, we consider the cost 
                              
                                 
                                    
                                       c
                                    
                                    
                                       n
                                    
                                 
                              
                            at each node as another sorting factor in order to give a chance to expand to immature nodes, which usually have lower cost because of short history. In summary, a node which is in a good position to proceed into the sample 
                              
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                              
                            and has lower cost is sorted as a good node to expand. We define sorting factor SF for a node n as follow:
                              
                                 (17)
                                 
                                    SF
                                    =
                                    γ
                                    (
                                    
                                       
                                          L
                                       
                                       
                                          MD
                                       
                                    
                                    (
                                    n
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    )
                                    +
                                    γ
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                              
                           The function 
                              
                                 γ
                              
                            determines the ranking of a node n among all nodes in the tree 
                              
                                 Γ
                              
                            as ascending order. 
                              
                                 
                                    
                                       L
                                    
                                    
                                       MD
                                    
                                 
                                 (
                                 n
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                            is the minimum length of the Dubins path between the node n and sample 
                              
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                              
                           .

Then, the nodes of the tree 
                              
                                 Γ
                              
                            are sorted as ascending order of SF (Line 1). However, we do not use the sorted list 
                              
                                 
                                    
                                       l
                                    
                                    
                                       n
                                    
                                 
                              
                            directly as a selection order, because a small number of nodes tend to monopolize high priority. In contrast to common motion planning algorithms, our algorithm should generate not only probable paths but also diverse paths to make various simulation results. Therefore, we mix the list 
                              
                                 
                                    
                                       l
                                    
                                    
                                       n
                                    
                                 
                              
                            randomly after grouping each 20 neighbor elements (Line 2).

Within the for statement (Line 3–Line 20), it is attempted to connect the sample 
                              
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                              
                            and any node in the tree 
                              
                                 Γ
                              
                            as the order of the list 
                              
                                 
                                    
                                       l
                                    
                                    
                                       n
                                    
                                 
                              
                           . Firstly, a reference path snippet 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       r
                                    
                                 
                              
                            is generated by joining 
                              
                                 
                                    
                                       n
                                    
                                    
                                       k
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                              
                           , and checked whether it is feasible on the cost map (Line 4–Line 7). The feasibility means that the path does not pass through any inaccessible areas with infinite cost. If 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       r
                                    
                                 
                              
                            is not feasible, the for statement passes to a next node.

Next, only if the simulation time 
                              
                                 τ
                              
                            of 
                              
                                 
                                    
                                       n
                                    
                                    
                                       k
                                    
                                 
                              
                            does not exceed the maximum simulation (prediction) time 
                              
                                 
                                    
                                       τ
                                    
                                    
                                       max
                                    
                                 
                              
                           , a trajectory snippet 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       s
                                    
                                 
                              
                            is generated by the simulation which follows 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       r
                                    
                                 
                              
                            (Line 8–Line 13). In other words, if there is no more reference velocity at the future velocity set 
                              
                                 
                                    
                                       V
                                    
                                    
                                       f
                                    
                                 
                              
                           , the simulation step is omitted. The detail method of the simulation is described in the next paragraph. The feasibility of 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       s
                                    
                                 
                              
                            is also examined by the same way for 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       r
                                    
                                 
                              
                           .

Next, the process reaches Line 14 where 
                              
                                 
                                    
                                       n
                                    
                                    
                                       k
                                    
                                 
                              
                            is demonstrated as a proper node to be connected to 
                              
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                              
                           . If 
                              
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                              
                            is a route sample, 
                              
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                              
                            becomes a new node of the tree 
                              
                                 Γ
                              
                           , and its simulation state is updated to the node. In contrast, if 
                              
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                              
                            is a goal sample, one complete trajectory 
                              
                                 
                                    
                                       T
                                    
                                    
                                       s
                                    
                                 
                              
                           , which is simulated along the root node to 
                              
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                              
                           , is extracted and added into the simulated trajectory set 
                              
                                 
                                    
                                       T
                                    
                                    
                                       set
                                    
                                    
                                       s
                                    
                                 
                              
                           .

When updating the cost 
                              
                                 
                                    
                                       c
                                    
                                    
                                       n
                                    
                                 
                              
                            of a node state, if the simulation step (Line 8–Line 13) was conducted at the current loop, cost along 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       s
                                    
                                 
                              
                            is added to 
                              
                                 
                                    
                                       c
                                    
                                    
                                       n
                                    
                                 
                              
                           . However, if the simulation was omitted, cost along 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       r
                                    
                                 
                              
                            is added to 
                              
                                 
                                    
                                       c
                                    
                                    
                                       n
                                    
                                 
                              
                           , because 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       s
                                    
                                 
                              
                            was not generated.

In Line 9, the simulation is conducted by following the reference path snippet 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       r
                                    
                                 
                              
                            with the future(reference) velocity set 
                              
                                 
                                    
                                       V
                                    
                                    
                                       F
                                    
                                 
                              
                            estimated in Line 1 of Algorithm 1. This simulation generates a trajectory snippet 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       s
                                    
                                 
                              
                            which does not violate the constraints of vehicle kinematics and follows 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       r
                                    
                                 
                              
                            similarly.

We use the pure pursuit model represented on [24] to follow the reference path. The bicycle model which is a simplified kinematic model of a vehicle, as represented in Fig. 8
                           , is used for the pure pursuit. The motion of the bicycle model is formulated by
                              
                                 (18)
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ̇
                                       
                                    
                                    =
                                    v
                                    cos
                                    θ
                                    ,
                                    
                                    
                                       
                                          z
                                       
                                       
                                          ̇
                                       
                                    
                                    =
                                    v
                                    sin
                                    θ
                                    ,
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          ̇
                                       
                                    
                                    =
                                    
                                       
                                          v
                                       
                                       
                                          B
                                       
                                    
                                    tan
                                    α
                                 
                              
                           where 
                              
                                 (
                                 x
                                 ,
                                 z
                                 )
                              
                            is the position of the rear wheel, 
                              
                                 θ
                              
                            is the vehicle heading, B is the wheelbase, and 
                              
                                 α
                              
                            is the steer angle. Because B is usually known constant, if the future velocities and steer angles are known, we can predict the future movement of this bicycle model from a original state.

By the pure pursuit algorithm, the steer angle following a reference path is calculated as follow:
                              
                                 (19)
                                 
                                    α
                                    =
                                    
                                       
                                          tan
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   B
                                                   sin
                                                   β
                                                
                                                
                                                   L
                                                   /
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 L
                                 >
                                 0.717
                                 v
                              
                            is the stabilization condition.

The look-ahead distance L is usually set to the smallest possible value which satisfies the stabilization condition. Then, the look-ahead line (the yellow line in Fig. 8) connects the rear wheel of the bicycle model and the look-ahead point 
                              
                                 
                                    
                                       P
                                    
                                    
                                       LA
                                    
                                 
                              
                            on the reference path. However, L should be large enough in order that 
                              
                                 
                                    
                                       P
                                    
                                    
                                       LA
                                    
                                 
                              
                            is not set on the already referred path at a prior simulation time, which keeps the uniqueness of the simulation state of each point on the reference path. For example, in Fig. 9
                           , there are two simulated trajectories which have the same reference velocity set. However, the look-ahead distance 
                              
                                 L
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       d
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       τ
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            is longer than 
                              
                                 L
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       u
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       τ
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                           , even if they are in same simulation time 
                              
                                 
                                    
                                       τ
                                    
                                    
                                       1
                                    
                                 
                              
                           . This is because the look-ahead point 
                              
                                 
                                    
                                       P
                                    
                                    
                                       LA
                                    
                                 
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       d
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       τ
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            should be located at the rear of the prior look-ahead point 
                              
                                 
                                    
                                       P
                                    
                                    
                                       LA
                                    
                                 
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       d
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       τ
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                           .

Once L and 
                              
                                 
                                    
                                       P
                                    
                                    
                                       LA
                                    
                                 
                              
                            are determined, the look-ahead angle 
                              
                                 β
                              
                            is also determined. Then, the steer angle 
                              
                                 α
                              
                            can be determined by 
                              
                                 L
                                 ,
                                 β
                              
                           , and B with Eq. (19). Because there is a limit to the movement of the steer, two constraints are necessary.
                              
                                 (20)
                                 
                                    ∥
                                    α
                                    ∥
                                    ⩽
                                    
                                       
                                          α
                                       
                                       
                                          max
                                       
                                    
                                    
                                    ∥
                                    
                                       
                                          α
                                       
                                       
                                          ̇
                                       
                                    
                                    ∥
                                    ⩽
                                    
                                       
                                          
                                             
                                                α
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          max
                                       
                                    
                                 
                              
                           Now, we can simulate the movement of the bicycle model along 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       r
                                    
                                 
                              
                           , because the velocity set 
                              
                                 
                                    
                                       V
                                    
                                    
                                       f
                                    
                                 
                              
                            is given and the steer angle 
                              
                                 α
                              
                            can be calculated by the pure pursuit algorithm.

In our experiment, the parameters are set as 
                              
                                 B
                                 =
                                 2.885
                                 
                                 m,
                                 
                                 
                                    
                                       α
                                    
                                    
                                       max
                                    
                                 
                                 =
                                 0.5435
                                 
                                 rad
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       max
                                    
                                 
                                 =
                                 0.3294
                                 
                                 rad
                                 /
                                 s
                              
                           , which follow the setting of [24].

There may be a lot of simulated trajectories in 
                           
                              
                                 
                                    T
                                 
                                 
                                    set
                                 
                                 
                                    s
                                 
                              
                           
                         after the repeated tree expansion and simulation processes end. As a final stage of the motion prediction algorithm (Line 8 of Algorithm 1), these trajectories are evaluated by three criteria.
                           
                              (a)
                              
                                 Cost: Cost along a trajectory 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             s
                                          
                                       
                                    
                                  tells whether 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             s
                                          
                                       
                                    
                                  is a good path to drive. It also gives a penalty to the length of a path. The cost of 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             s
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             c
                                          
                                          
                                             T
                                          
                                       
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             s
                                          
                                       
                                       )
                                    
                                 , is same with the cost 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             n
                                          
                                       
                                    
                                  at the goal node of 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             s
                                          
                                       
                                    
                                 .


                                 Evaluation of yaw rates with GMM: We can estimate plausibility of a simulated trajectory 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             s
                                          
                                       
                                    
                                  about the history trajectory 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             h
                                          
                                       
                                    
                                  using the GMM model 
                                    
                                       p
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             h
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             f
                                          
                                       
                                       )
                                    
                                  described in Section 6.1. Because the velocity components of all 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             s
                                          
                                       
                                    
                                  in 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             set
                                          
                                          
                                             s
                                          
                                       
                                    
                                  are fixed as the reference velocity set 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             f
                                          
                                       
                                    
                                 , it is evaluation for the yaw rates of each 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             s
                                          
                                       
                                    
                                 . 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             h
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             f
                                          
                                       
                                    
                                  can be calculated by the Chebyshev approximation of 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             h
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             s
                                          
                                       
                                    
                                 . Then, the validity of 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             s
                                          
                                       
                                       ,
                                       
                                       Λ
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             s
                                          
                                       
                                       )
                                    
                                 , is evaluated by the value of 
                                    
                                       p
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             h
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             f
                                          
                                       
                                       )
                                    
                                 .


                                 Similarity with reference path: That a simulated trajectory 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             s
                                          
                                       
                                    
                                  is not similar with it’s reference path means that the reference path is difficult to be followed by the current state of the target vehicle. Therefore, we can interpret that 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             s
                                          
                                       
                                    
                                  which is similar with the reference path is more reasonable than the dissimilar one. For example, the simulation of a fast moving vehicle cannot follow U-turn path well, and the dissimilarity between the simulated trajectory and the U-turn path tells us that it is not a proper path to follow.

Now, we explain how to measure the similarity with the reference path. As in Fig. 8, the pure pursuit algorithm designates a look-ahead point 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             LA
                                          
                                       
                                    
                                  and follow it repeatedly. If a vehicle exactly reaches 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             LA
                                          
                                       
                                    
                                  after running as much as distance L, it is the best case in terms of similarity. However, vehicle cannot reach 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             LA
                                          
                                       
                                    
                                  usually.

In Fig. 9, there are two simulations which follow the same reference path. Although they have a same reference velocity set 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             f
                                          
                                       
                                    
                                 , the difference of the initial heading angles makes the different results. We can easily recognize that the upper one is more similar with the reference path than the lower one. To measure the similarity with the reference path, we use the distance between 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             LA
                                          
                                       
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             s
                                          
                                       
                                       ,
                                       
                                          
                                             τ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                  and 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             F
                                          
                                       
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             s
                                          
                                       
                                       ,
                                       
                                          
                                             τ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                  like below
                                    
                                       (21)
                                       
                                          Φ
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                s
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                
                                                   K
                                                   -
                                                   1
                                                
                                             
                                          
                                          ∥
                                          
                                             
                                                P
                                             
                                             
                                                LA
                                             
                                          
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                s
                                             
                                          
                                          ,
                                          
                                             
                                                τ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          -
                                          
                                             
                                                P
                                             
                                             
                                                F
                                             
                                          
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                s
                                             
                                          
                                          ,
                                          
                                             
                                                τ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ∥
                                       
                                    
                                 where all 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             F
                                          
                                       
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             s
                                          
                                       
                                       ,
                                       
                                          
                                             τ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                  for 
                                    
                                       0
                                       ⩽
                                       i
                                       ⩽
                                       K
                                       -
                                       1
                                    
                                  have to be located on the simulated trajectory.

High 
                                    
                                       Φ
                                    
                                  means high dissimilarity. For example, in Fig. 9, the distances between 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             F
                                          
                                       
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             s
                                          
                                       
                                       ,
                                       
                                          
                                             τ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                  and 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             LA
                                          
                                       
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             s
                                          
                                       
                                       ,
                                       
                                          
                                             τ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                  are generally shorter at the upper one compared to the lower one, so the upper one has lower 
                                    
                                       Φ
                                    
                                 .

Now, we can evaluate the plausibility of each trajectory by the combination of the three criteria. Because the scales of the criteria are different each other, we evaluate relative rankings among the trajectory set 
                           
                              
                                 
                                    T
                                 
                                 
                                    set
                                 
                                 
                                    s
                                 
                              
                           
                        .
                           
                              (22)
                              
                                 Ψ
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       s
                                    
                                 
                                 )
                                 =
                                 γ
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       s
                                    
                                 
                                 )
                                 )
                                 +
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                                 
                                 ∗
                                 
                                 γ
                                 (
                                 -
                                 Λ
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       s
                                    
                                 
                                 )
                                 )
                                 +
                                 
                                    
                                       m
                                    
                                    
                                       2
                                    
                                 
                                 
                                 ∗
                                 
                                 γ
                                 (
                                 Φ
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       s
                                    
                                 
                                 )
                                 )
                              
                           
                        where 
                           
                              γ
                           
                         is a function which determines ranking as ascending order. 
                           
                              
                                 
                                    m
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                           
                         are weights among three criteria, and low 
                           
                              Ψ
                           
                         means high plausibility of a trajectory. In our problem setting, we use 0.3 for both 
                           
                              
                                 
                                    m
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                           
                        .

Finally, it is necessary to select some representative trajectories (Line 9 of Algorithm 1), because there are a lot of trajectory outputs. There can be many strategies to extract such as the most probable one among all trajectories or the most probable one among each trajectory set which has a same goal.

@&#EXPERIMENTAL RESULTS@&#

We conduct experiments using the KITTI vision benchmark suite data set [9]. The data set provides rectified stereo images of a moving car-mounted camera on common road situations. Because each sequence is recorded at 10frames/s, our algorithm is also set to operate at the same frame rate. The data set also provides GPS and IMU data, and we use them to compensate camera motion. We evaluate our results with ground truth positions of a target vehicle which are extracted from a manual label in a 2D image and corresponding stereo information in a disparity map. Ground truth for heading angle, linear velocity and angular velocity can be also extracted using the filtering method to extract trajectories in Section 5.

In our experiments, four sequences from the KITTI dataset are used for the ground truth evaluation. The characteristics of the sequences are arranged in Table 1
                     , and the behavior of the target vehicles on each sequence is represented in Fig. 10
                     .

In Fig. 11
                     , the process to generate predicted driving trajectories is visualized. In the camera view (upper), the location of the target vehicle is marked as the bounding box and the history trace is drawn as the red
                        1
                        For interpretation of color in Fig. 11, the reader is referred to the web version of this article.
                     
                     
                        1
                      line. The white dotted line indicates a road network of near future from the OSM. In the bird eye view (lower), the satellite map from the Google Earth forms a background, and road boundaries and lanes are drawn over it. The blue rectangle is the target vehicle. In the left bird eye view, the cyan circles are sampling points to expand the tree of RRT, and magenta lines are branches of the tree which serve as reference paths for the simulation. In the right bird eye view, the green lines are feasible trajectories which are generated by the 3s simulation. Among them, two red trajectories are selected as the most probable trajectories for each goal route.

You can see that some magenta lines towards the right road are generated in the RRT step, but three is no feasible trajectories to the direction. This is because trajectories are blocked by obstacle regions during the simulation step, which means the propagation to the right road is impossible under the current vehicle state and predicted velocities.

@&#PERFORMANCE EVALUATION@&#

First, we evaluate position errors compared to the ground truth for fixed 3s prediction. Our results (GMM+RRT) are compared with the results from the pure GMM motion prediction [17] and the linear Kalman prediction. Since our method can generate more than one possible trajectory, the most probable trajectory among all predicted trajectories is chosen for the comparison. The plausibility of each simulated trajectory is calculated by Eq. (22). In every frame of the sequences, the target vehicle is observed by our camera system.


                        Fig. 12
                         shows overall position errors at the four test sequences. The predicted position for the 3s future at each frame and the ground truth position at the frame after 3s are compared. This plot shows the aspect of prediction performance across the whole video sequences. Because a history trajectory of a fixed spatial length is necessary to predict a future trajectory using the GMM model, the initial part of the plots is vacant for the methods which use the GMM models. The overall frame lengths in Fig. 12 are less than the original frame lengths of the sequences, because the predictions at last 30frames do not have future ground truth data for comparisons.

In all sequences, our model shows good performance compared to other methods. The high speed sequences (seq 2, 3) have higher overall errors compared to the low speed sequences (seq 1, 4). Especially, it is more obvious that our approach performs much better than other methods in highly curved sequences (seq 2, 4) since our approach considers environment information in the simulation while the previous approaches do not. Sometimes, the Kalman model generates very small errors when the speed variation is low and the movement is straight like the front part of the sequence 3 (before frame 110). However, it is a limited situation and the error increases at the rear part of the sequence 3, because the target vehicle meets an intersection and turns to the left.

Sometimes, very high errors occur in our model when the chosen trajectory, which was evaluated the best, goes a different goal with the ground truth trajectory. However, in a real practice, our algorithm can provide multiple predictions with different probabilities assigned to each prediction. This makes our approach better fit to a real world complicated situation.

The performance comparison among the algorithms is more easily observed in Fig. 13
                        . The mean performance of the error distribution of each sequence is represented as a box plot. Our model gives the best performance for all sequences. We can see the effect of environment perception in Fig. 14
                        . Because our model knows obstacle regions, the better results which avoid obstacles are generated. However, predictions by the pure GMM model often invade infeasible regions and this tendency is higher as prediction time is longer.

We have also evaluated mean errors of positions and yaw angles for several prediction intervals in Table 2
                        . We compare results for 1s prediction, 2s prediction, and 3s prediction. This result shows the characteristic of each method about different prediction intervals. For most cases, our model (GMM+RRT) shows minimum position errors compared to other methods, and the difference with other methods tends to go up over prediction time. As expected, the largest errors occur in the 3s prediction. However, when observing the increase tendency of the errors over prediction time, our algorithm is the most stable. In the sequence 1, the Kalman prediction shows better performance for the yaw angle errors. However, this is because of the characteristic of the sequence 1, which contains mostly straight roads. Besides, it should be considered that our model sometimes selects a trajectory to a wrong goal at an intersection, and it generates a high error. In contrast, on the highly curved sequences like sequence 2 and 4, the yaw angle errors of the Kalman prediction increase dramatically while our model shows the stable yaw angle errors regardless of the characteristic of a sequence.

Finally, we checked computational time for each method. Our computer environment is made up of Intel i7-3770 (3.4GHz) CPU and 16GB RAM, and the program is made by Matlab. We assumed that the process to gain the environment information and history trajectory is completed priorly, and measured pure motion prediction process in Section 6 only. As a result of the average computational time for whole test sequences, 0.0338s/frame and 0.7668s/frame came out for pure GMM model and our model (GMM+RRT) respectively. Due to the usage of the motion planning and simulation, a lot of additional loads are added to our method. However, more optimization and conversion to native language may enable our algorithm to operate in real environment.

@&#CONCLUSION@&#

In this paper, we have proposed a method for a vehicle motion prediction for several seconds. In contrast with previous algorithms which only use motion history to predict future motion, our approach exploits a motion planning to generate adequate future trajectories in a complicated dynamic environment through simulation. We have also evaluated the performance of our method using real world data captured from a on-road car-mounted camera. Our experimental results show that our approach (GMM+RRT) is effective and has better and more stable performance compared to predictions from the pure GMM model and Kalman filter.

The analytical solution for the minimum length of the Dubins path is obtained from [24]. When calculating the distance between two points, the heading angle at the prior point is also considered. Now, the solution for the minimum length from the origin (0,0) of the xz-coordinate with zero heading angle to a point q(
                        
                           
                              
                                 q
                              
                              
                                 x
                              
                           
                           ,
                           
                              
                                 q
                              
                              
                                 z
                              
                           
                        
                     ) is described. If we know the solution of this format, the minimum length of other arbitrary two points can be also calculated after transforming to this format. The minimum length 
                        
                           
                              
                                 L
                              
                              
                                 MD
                              
                           
                        
                      is
                        
                           (A.1)
                           
                              
                                 
                                    L
                                 
                                 
                                    MD
                                 
                              
                              (
                              q
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      a
                                                   
                                                
                                                (
                                                q
                                                )
                                                ,
                                             
                                             
                                                for
                                                
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      a
                                                   
                                                
                                                (
                                                q
                                                )
                                                ⩾
                                                η
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      b
                                                   
                                                
                                                (
                                                q
                                                )
                                                ,
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           η
                        
                      is the minimum turning radius, 
                        
                           
                              
                                 d
                              
                              
                                 a
                              
                           
                           (
                           q
                           )
                           =
                           ∥
                           (
                           
                              
                                 q
                              
                              
                                 x
                              
                           
                           ,
                           ∣
                           
                              
                                 q
                              
                              
                                 z
                              
                           
                           ∣
                           )
                           -
                           (
                           0
                           ,
                           η
                           )
                           ∥
                        
                      and
                        
                           (A.2)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                a
                                             
                                          
                                          (
                                          q
                                          )
                                          =
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                q
                                                )
                                                -
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          +
                                          η
                                          
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                   (
                                                   q
                                                   )
                                                   -
                                                   
                                                      
                                                         cos
                                                      
                                                      
                                                         -
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         
                                                            
                                                               d
                                                            
                                                            
                                                               a
                                                            
                                                         
                                                         (
                                                         q
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                b
                                             
                                          
                                          (
                                          q
                                          )
                                          =
                                          η
                                          
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         b
                                                      
                                                   
                                                   (
                                                   q
                                                   )
                                                   +
                                                   
                                                      
                                                         sin
                                                      
                                                      
                                                         -
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               d
                                                            
                                                            
                                                               b
                                                            
                                                         
                                                         (
                                                         q
                                                         )
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         sin
                                                      
                                                      
                                                         -
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         η
                                                         sin
                                                         (
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               b
                                                            
                                                         
                                                         (
                                                         q
                                                         )
                                                         )
                                                      
                                                      
                                                         
                                                            
                                                               d
                                                            
                                                            
                                                               b
                                                            
                                                         
                                                         (
                                                         q
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 d
                              
                              
                                 b
                              
                           
                           (
                           q
                           )
                           =
                           ∥
                           (
                           
                              
                                 q
                              
                              
                                 x
                              
                           
                           ,
                           ∣
                           
                              
                                 q
                              
                              
                                 z
                              
                           
                           ∣
                           )
                           -
                           (
                           0
                           ,
                           -
                           η
                           )
                           ∥
                           ,
                           
                              
                                 θ
                              
                              
                                 a
                              
                           
                           (
                           q
                           )
                           =
                           a
                           tan
                           2
                        
                     (
                        
                           
                              
                                 q
                              
                              
                                 x
                              
                           
                           ,
                           η
                           -
                           ∣
                           
                              
                                 q
                              
                              
                                 z
                              
                           
                           ∣
                        
                     ), and 
                        
                           
                              
                                 θ
                              
                              
                                 b
                              
                           
                           (
                           q
                           )
                           =
                           2
                           π
                           -
                           
                              
                                 cos
                              
                              
                                 -
                                 1
                              
                           
                           (
                           (
                           5
                           
                              
                                 η
                              
                              
                                 2
                              
                           
                           -
                           
                              
                                 d
                              
                              
                                 b
                              
                              
                                 2
                              
                           
                           (
                           q
                           )
                           )
                           /
                           4
                           
                              
                                 η
                              
                              
                                 2
                              
                           
                           )
                        
                     . The range of 
                        
                           a
                           tan
                           2
                        
                      is 
                        
                           [
                           0
                           ,
                           2
                           π
                           ]
                        
                      and that of 
                        
                           
                              
                                 cos
                              
                              
                                 -
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 sin
                              
                              
                                 -
                                 1
                              
                           
                        
                      is 
                        
                           [
                           0
                           ,
                           π
                           ]
                        
                     . We can observe that the sign of 
                        
                           
                              
                                 q
                              
                              
                                 z
                              
                           
                        
                      does not affect the solution. This is natural because the paths from the origin with zero heading angle to the arbitrary symmetric points to the x-axis are also symmetric. In our experiment setting, we use a turning radius 
                        
                           η
                           =
                           4.77
                           
                           m
                        
                     .

When we calculate a minimum length of the Dubins path from a node n to a sample s in our RRT tree model (Section 6.3), the heading angle at n is set by the direction from the it’s parent node. Only when n is the root node of the tree, the simulated heading angle 
                        
                           
                              
                                 θ
                              
                              
                                 s
                              
                           
                        
                      in the state of n is used. It is reasonable because corresponding nodes on reference path and simulation path are located in a same place when they are root node. (refer Fig. 6).

@&#REFERENCES@&#

