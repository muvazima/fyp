@&#MAIN-TITLE@&#Symbolic execution based on language transformation

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We propose a language-independent symbolic execution framework for languages.


                        
                        
                           
                           The proposed language-independent approach is based on language transformations.


                        
                        
                           
                           We prove that the expected formal properties of symbolic execution.


                        
                        
                           
                           We present a prototype and we use it on several languages.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Symbolic execution

Formal semantics

Programming languages

Program analysis

@&#ABSTRACT@&#


               
               
                  We propose a language-independent symbolic execution framework for languages endowed with a formal operational semantics based on term rewriting. Starting from a given definition of a language, a new language definition is generated, with the same syntax as the original one, but whose semantical rules are transformed in order to rewrite over logical formulas denoting possibly infinite sets of program states. Then, the symbolic execution of concrete programs is, by definition, the execution of the same programs with the symbolic semantics. We prove that the symbolic execution thus defined has the properties naturally expected from it (with respect to concrete program execution). A prototype implementation of our approach was developed in the 
                        K
                      framework. We demonstrate the tool׳s genericity by instantiating it on several languages, and illustrate it on the reachability analysis and model checking of several programs.
               
            

@&#INTRODUCTION@&#

Symbolic execution is a well-known program analysis technique introduced in 1976 by King [19]. Since then, it has proved its usefulness for testing, verifying, and debugging programs. Symbolic execution consists of executing programs with symbolic inputs, instead of concrete ones, and it involves the processing of expressions involving symbolic values [25]. The main advantage of symbolic execution is that it allows reasoning about multiple concrete executions of a program, and its main disadvantage is the state-space explosion determined by decision statements and loops. Recently, the technique has found renewed interest in the formal methods community due to new algorithmic developments and progress in decision procedures. Current applications of symbolic execution are diverse and include automated test input generation [20,38], invariant detection [24], model checking [18], and proving program correctness [37,12].

The state of a symbolic program execution typically contains the next statement to be executed, symbolic values of program variables, and the path condition, which constrains past and present values of the variables (i.e., constraints on the symbolic values are accumulated on the path taken by the execution for reaching the current instruction). The states, and the transitions between them induced by the program instructions generate a symbolic execution tree. When the control flow of a program is determined by symbolic values (e.g., the next instruction to be executed is a conditional one, whose Boolean condition depends on symbolic values) then there is a branching in the tree. The path condition can then be used to distinguish between different branches.


                     Our contribution: The main contribution of the paper is a formal, language-independent theory and tool for symbolic execution, based on a language׳s operational semantics defined by term-rewriting.
                        1
                     
                     
                        1
                        Most existing operational semantics styles (small-step, big-step, reduction with evaluation contexts, etc.) have been shown to be faithfully representable by rewriting [36].
                      On the theoretical side, we define a transformation of languages such that the symbolic execution of programs in the source language is, by definition, the concrete execution in the transformed language. We prove that the symbolic execution thus defined has the following properties, which relate it to concrete execution in a natural way: 
                        
                           
                              
                              
                                 
                                    
                                       Coverage: To every concrete execution there corresponds a feasible symbolic one;
                                 
                                 
                                    
                                       Precision: To every feasible symbolic execution there corresponds a concrete one.
                                 
                              
                           
                        
                     where two executions are said to be corresponding if they take the same path, and a symbolic execution is feasible if the path conditions along it are satisfiable. These theoretical properties have practical consequences, since they ensure that analyses based on symbolic program execution (reachability analysis, model checking, etc.) can be soundly transferred to concrete executions.

On the practical side, we present the prototype implementation of our approach in 
                        K
                      
                     [29] (version 3.4), a framework dedicated to defining formal operational semantics of languages. A 
                        K
                      language definition is compiled into a Maude rewrite theory. Our prototype is based on several transformations which are encoded as compilation steps in the 
                        K
                      definition compiler. The relationships between 
                        K
                      language definitions and their compilation into Maude, and between the transformed 
                        K
                      definitions and their Maude encodings are investigated in [4]. In this paper we briefly describe our implementation as a language-engineering tool, and demonstrate its genericity by instantiating it on nontrivial languages defined in 
                        K
                     .

We emphasise that the tool uses the 
                        K
                      language-definitions as they are, without requiring modifications, and automatically harnesses them for symbolic execution. The examples illustrate reachability analysis, Linear Temporal Logic model checking, and bounded model checking using our tool.

The proposed approach uses a generic theoretical framework, which abstracts away details from the 
                        K
                      implementation. In fact, 
                        K
                      definitions are particular examples of the abstract notion of language definition presented in Section 3.4.

A restriction of our approach is that it requires a clear distinction between code and data. We only deal with symbolic data (e.g., integers, Booleans, etc.), but not with symbolic code. This excludes, for example, higher-order functional languages in which code can be passed as data between functions. The main goal of this work is to provide a language-independent symbolic execution framework on top of which different analysis tools can be developed (i.e., test case generators, program verification tools, etc.). This framework is intended to capture the central concepts of symbolic execution (e.g., symbolic values, path conditions, symbolic execution trees) which are completely independent of the chosen programming language. In practice, up to now, the framework has been successfully used for general purpose languages such as imperative, object-oriented, and scripting languages (as shown in Section 7.2), and for domain specific languages (e.g., OCL [3]).


                     Related work: There is a substantial number of tools performing symbolic execution available in the literature. However, most of them have been developed for specific programming languages and are based on informal semantics. Here we mention some of them that are strongly related to our approach.

Java PathFinder [26] is a complex symbolic execution tool which uses a model checker to explore different symbolic execution paths. The approach is applied to Java programs and it can handle recursive input data structures, arrays, preconditions, and multithreading. Java PathFinder can access several Satisfiability Modulo Theories (SMT) solvers and the user can also choose between multiple decision procedures. We anticipate that by instantiating our generic approach to a formal definition of Java (currently being defined in the 
                        K
                      framework) we obtain some of Java PathFinder׳s features for free.

Another approach consists in combining concrete and symbolic execution, also known as concolic execution. First, some concrete values given as input determine an execution path. When the program encounters a decision point, the paths not taken by concrete execution are explored symbolically. This type of analysis has been implemented by several tools: DART [16], CUTE [34], EXE [8], PEX [10]. We note that our approach allows mixed concrete/symbolic execution; it can be the basis for language-independent implementations of concolic execution.

Symbolic execution has initially been used in automated test generation [19]. It can also be used for proving program correctness. There are several tools (e.g. Smallfoot [6,39]) which use symbolic execution together with separation logic to prove Hoare triples. There are also approaches that attempt to automatically detect invariants in programs [24,33]. Another useful application of symbolic execution is the static detection of runtime errors. The main idea is to perform symbolic execution on a program until a state is reached where an error occurs, e.g., null-pointer dereference or division by zero. We show that the implementation prototype we developed is also suitable for such static code analyses.

Another body of related work is symbolic execution in term-rewriting systems. The technique called narrowing, initially used for solving equation systems in abstract datatypes, has been extended for solving reachability problems in term-rewriting systems and has successfully been applied to the analysis of security protocols [23]. Such analyses rely on powerful unification-modulo-theories algorithms [14], which work well for security protocols since there are unification algorithms modulo theories involved there (exclusive-or, …). This is not always the case for programming languages with arbitrarily complex datatypes.


                     Rewriting modulo SMT 
                     [27] is a recently introduced technique for performing symbolic execution on rewrite theories. Their approach and ours have some common features: a built-in subtheory (for data, in our case) in which constraints are handled by SMT solving; the notion of constrained terms (in our case, Matching Logic patterns); and soundness and completeness results (in our case, precision and coverage). The main difference is that they focus on rewriting-logic specifications, whereas we focus on language definitions.

The present paper is an extended version of our SLE 2013 paper [2]. It relies on a more general way of defining programming languages, consisting in using (Topmost) Matching Logic to denote sets of program states and Reachability Logic for the operational semantics of languages. The two logics are briefly introduced in the paper; for details readers can consult [30]. This results in better definitions for essential notions such as symbolic domain (the domain over which symbolic execution “computes”). The new definitions are more suitable because they faithfully capture the essence of what symbolic execution is about: computing with logical constraints denoting sets of program states. By contrast, in [2] the corresponding definitions were purely axiomatic: they required certain abstract diagrams to be commutative. The new approach also extends the range of language definitions for which symbolic execution can be defined: the previous approach [2] is now an instance of the current one. Among the extensions we mention axiomatically defined structures (sets, bags, lists, etc.), with axioms such as associativity, commutativity, unity and combinations thereof. Such structures are intensively used in real-life language definitions in the 
                        K
                      framework (C [13], Java [7], etc.). Finally, a technical improvement is that our new definition of the symbolic transition relation does not distinguish among semantically equivalent symbolic states.


                     Structure of the paper: Section 2 introduces our running example (the imperative language imp) and its definition in 
                        K
                     .


                     Section 3 introduces a framework for language definitions, making our approach generic in both the language-definition framework and the language being defined; 
                        K
                      and imp are just instances for the former and latter, respectively.


                     Section 4 introduces the notion of symbolic domain, which formalises the domain in which symbolic execution takes place.


                     Section 5 then shows how the definition of a language 
                        L
                      can be transformed into the definition of a language 
                        
                           
                              L
                           
                           
                              s
                           
                        
                      by replacing the concrete domain with the symbolic one, and by providing the semantical rules of 
                        L
                      with means to operate in the new, symbolic domain. The coverage and precision results are proved.


                     Section 6 then gives two instances of the framework introduced in the previous section. The first one is isomorphic to that presented in [2], whereas the second strictly generalises the first one by including axiomatically defined structures which, as previously mentioned, are intensively used in real-life language definitions.


                     Section 7 describes an implementation of our approach in the 
                        K
                      framework and shows how it is automatically instantiated to nontrivial languages defined in 
                        K
                     . Applications to program analysis are given.


                     Section 8 concludes and discusses future work.

Our running example is imp, a simple imperative language intensively used in research papers (e.g., [31,28]). The syntax of imp is described in Fig. 1
                      and is mostly self-explanatory since it uses a BNF notation. The statements of the language are either assignments, if statements, while loops, skip (i.e., the empty statement), or blocks of statements. The attribute strict in some production rules means the arguments of the annotated expression/statement are evaluated before the expression/statement itself. If strict is followed by a list of natural numbers then it only concerns the arguments whose positions are present in the list.

The operational semantics of imp is given as a set of (possibly conditional) rewrite rules. The terms to which rules are applied are called configurations. Configurations typically contain the program to be executed, together with any additional information required for program execution. The structure of a configuration depends on the language being defined; for imp, it consists only of the program code to be executed and an environment mapping variables to values.

Configurations are written in 
                        K
                      as nested structures of cells: for imp this consists of a top cell 
                        
                           cfg
                        
                     , having a subcell 
                        
                           k
                        
                      containing the code and a subcell 
                        
                           env
                        
                      containing the environment (cf. Fig. 2
                     ). The code inside the 
                        
                           k
                        
                      cell is represented as a list of computation tasks 
                        
                           
                              C
                           
                           
                              1
                           
                        
                        ↷
                        
                           
                              C
                           
                           
                              2
                           
                        
                        ↷
                        …
                      to be executed in the given order. Computation tasks are typically statements and expressions. The environment in the 
                        
                           env
                        
                      cell is a multiset of bindings of identifiers to values, e.g., 
                        
                           a
                        
                        ↦
                        3
                     , 
                        
                           b
                        
                        ↦
                        1
                     .

The semantics of imp is shown in Fig. 3
                     . Each rewrite rule from the semantics specifies how the configuration evolves when the first computation task from the 
                        
                           k
                        
                      cell is executed. Dots in a cell mean that the rest of the cell remains unchanged. Most syntactical constructions require only one semantical rule. The exceptions are the conjunction operation and the 
                        
                           if
                        
                      statement, which have Boolean arguments and require two rules each (one rule per Boolean value).

In addition to the rules shown in Fig. 3 the semantics of imp includes additional rules induced by the strict attribute. We show only the case of the 
                        
                           if
                        
                      statement, which is strict in the first argument. The evaluation of this argument is achieved by executing the following rules: 
                        
                           
                              
                                 
                                    
                                 
                              
                           
                        
                     
                  

Here, BE ranges over Boolean expressions, B ranges over the Boolean values 
                        {
                        false
                        ,
                        true
                        }
                     , and □ is a special variable, destined to receive the value of BE once it is computed, typically, by the other rules in the semantics.

Creating a language-independent symbolic execution framework requires specifications of programming languages, which, for each language, define the meanings of the programs in that language. The idea behind our approach is to pass such specifications as parameters to our symbolic execution framework.

This section presents some background used in the rest of the paper. We start by giving a brief description of the basics of algebraic specifications, of many-sorted First Order Logic (fol), and of Matching Logic (ml) [30], together with the notation and conventions that we are going to use throughout the paper. Then, we present the general notion of language definition using Matching Logic and Reachability Logic (rl) [30]. The syntax of programming languages and the data types used in their semantics are given using algebraic specifications, while their semantics is given using rl.

In this section we briefly introduce some basic definitions and notations regarding algebraic specifications that we use in the paper.

The use of algebraic specifications to model computer programs is motivated by the fact that they can manipulate several kinds of sorts of data, in the same way as programs do. For instance, the name Int is a sort and it is part of the syntax. The syntax is called signature, and it consists of a set of sorts. Formally, given S a set of sorts, an S-sorted signature 
                        
                           Σ
                         is an 
                           
                              
                                 S
                              
                              
                                 ⁎
                              
                           
                           ×
                           S
                           -
                           indexed
                         family of sets 
                           {
                           
                              
                                 Σ
                              
                              
                                 w
                                 ,
                                 s
                              
                           
                           ∣
                           w
                           ∈
                           
                              
                                 S
                              
                              
                                 ⁎
                              
                           
                           ,
                           s
                           ∈
                           S
                           }
                         whose elements are called operation symbols. If 
                           
                              
                                 S
                              
                              
                                 ′
                              
                           
                           ⊆
                           S
                        , an 
                           
                              
                                 S
                              
                              
                                 ′
                              
                           
                           -
                           sorted
                         signature 
                           
                              
                                 Σ
                              
                              
                                 ′
                              
                           
                         is a subsignature of an S-sorted signature 
                           Σ
                         if 
                           
                              
                                 Σ
                              
                              
                                 ′
                              
                           
                           ⊆
                           Σ
                         as 
                           
                              
                                 S
                              
                              
                                 ⁎
                              
                           
                           ×
                           S
                           -
                           indexed
                         sets.

The BNF syntax of imp (Fig. 1) has a corresponding 
                           
                              
                                 S
                              
                              
                                 
                                    imp
                                 
                              
                           
                           -
                           sorted
                         signature 
                           
                              
                                 Σ
                              
                              
                                 
                                    imp
                                 
                              
                           
                        . Nonterminals in the grammar (e.g. Int, Bool, AExp, etc.) are sorts in 
                           
                              
                                 S
                              
                              
                                 
                                    imp
                                 
                              
                           
                        , while each grammar production has a corresponding operation symbol in 
                           
                              
                                 Σ
                              
                              
                                 
                                    imp
                                 
                              
                           
                        . For instance, the production 
                           AExp
                           ::=
                           AExp
                           
                              +
                           
                           AExp
                         has a corresponding operation symbol 
                           _
                           
                              +
                           
                           _
                           :
                           AExp
                           ×
                           AExp
                           →
                           AExp
                         having two arguments of sort AExp and result of sort AExp. An operational symbols without arguments is called constant; e.g., true and false are constants of sort Bool.

The meaning of algebraic signatures 
                           Σ
                         is given by Σ-algebras, called also Σ-models. A Σ-algebra M consists of an S-indexed set (also denoted M), i.e., a carrier set M
                        
                           s
                         for each sort 
                           s
                           ∈
                           S
                        ; an element 
                           
                              
                                 M
                              
                              
                                 c
                              
                           
                           ∈
                           
                              
                                 M
                              
                              
                                 s
                              
                           
                         interpreting each constant symbol c as an actual element; and a function 
                           
                              
                                 M
                              
                              
                                 f
                              
                           
                           :
                           
                              
                                 M
                              
                              
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           ×
                           ⋯
                           ×
                           
                              
                                 M
                              
                              
                                 
                                    
                                       s
                                    
                                    
                                       n
                                    
                                 
                              
                           
                           →
                           
                              
                                 M
                              
                              
                                 s
                              
                           
                         interpreting each operation symbol f as a function. The interpretation of a constant can be seen as a particular (constant) function.

An example of Σ-algebra M for imp, used in this paper, interprets the sort Int by the set 
                           
                              
                                 M
                              
                              
                                 Int
                              
                           
                         of integers, the sort Bool by the set of Booleans 
                           
                              
                                 M
                              
                              
                                 Bool
                              
                           
                           =
                           {
                           false
                           ,
                           true
                           }
                        , and the other nonterminals by their corresponding syntactical categories, e.g. 
                           
                              
                                 M
                              
                              
                                 AExp
                              
                           
                         is the set of arithmetical expressions. M also interprets all operation symbols by functions, i.e. the symbol 
                           _
                           
                              
                                 +
                              
                              
                                 Int
                              
                           
                           _
                         is interpreted by a function 
                           
                              
                                 M
                              
                              
                                 _
                                 
                                    
                                       +
                                    
                                    
                                       Int
                                    
                                 
                                 _
                              
                           
                           :
                           
                              
                                 M
                              
                              
                                 Int
                              
                           
                           ×
                           
                              
                                 M
                              
                              
                                 Int
                              
                           
                           →
                           
                              
                                 M
                              
                              
                                 Int
                              
                           
                         which is the addition over integers, and 
                           _
                           
                              +
                           
                           _
                         is interpreted by a function 
                           
                              
                                 M
                              
                              
                                 _
                                 
                                    +
                                 
                                 _
                              
                           
                           :
                           
                              
                                 M
                              
                              
                                 AExp
                              
                           
                           ×
                           
                              
                                 M
                              
                              
                                 AExp
                              
                           
                           →
                           
                              
                                 M
                              
                              
                                 AExp
                              
                           
                         which is the expression constructor.

Let Var be an S-indexed set of variables. The S-indexed set 
                           
                              
                                 T
                              
                              
                                 Σ
                              
                           
                           (
                           Var
                           )
                           =
                           {
                           
                              
                                 T
                              
                              
                                 Σ
                                 ,
                                 s
                              
                           
                           (
                           Var
                           )
                           ∣
                           s
                           ∈
                           S
                           }
                         of Σ-terms t is defined by 
                           
                              
                                 t
                                 ::=
                                 c
                                 ∣
                                 x
                                 ∣
                                 f
                                 (
                                 t
                                 ,
                                 …
                                 ,
                                 t
                                 )
                                 ,
                              
                           
                        where c is a constant, 
                           x
                           ∈
                           Var
                        , and f is an operation symbol with n arguments. The term Σ-algebra 
                        
                           
                              
                                 T
                              
                              
                                 Σ
                              
                           
                           (
                           Var
                           )
                         has Σ-terms 
                           
                              
                                 T
                              
                              
                                 Σ
                              
                           
                           (
                           Var
                           )
                         as carrier sets and interprets each constant symbol c by itself and each operation symbol 
                           f
                           :
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                           …
                           
                              
                                 s
                              
                              
                                 n
                              
                           
                           →
                           s
                         by the term constructor function 
                           
                              
                                 T
                              
                              
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           ×
                           ⋯
                           ×
                           
                              
                                 T
                              
                              
                                 
                                    
                                       s
                                    
                                    
                                       n
                                    
                                 
                              
                           
                           →
                           
                              
                                 T
                              
                              
                                 s
                              
                           
                         that maps 
                           (
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                           )
                         into the term 
                           f
                           (
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                           )
                        . If Var is ∅, then 
                           
                              
                                 T
                              
                              
                                 Σ
                              
                           
                           (
                           ∅
                           )
                         is the algebra of ground terms (terms without variables), which we denote it by 
                           
                              
                                 T
                              
                              
                                 Σ
                              
                           
                        .

Examples of 
                           Σ
                         terms are 
                           _+_
                           
                           (
                           2
                           ,
                           3
                           )
                        , and 
                           _⁎_
                           
                           (
                           _+_
                           
                           (
                           2
                           ,
                           3
                           )
                           ,
                           x
                           )
                        , where 
                           x
                           ∈
                           
                              
                                 Var
                              
                              
                                 AExp
                              
                           
                        . We often use the mixfix notation for terms, e.g. the above ones are written as 
                           
                              2 + 3
                           
                        , respectively, 
                           (2 + 3)⁎
                           x
                        .

A valuation ρ is a function 
                           ρ
                           :
                           Var
                           →
                           M
                         that maps variables to values from a Σ-model M. A substitution is a mapping 
                           σ
                           :
                           X
                           →
                           
                              
                                 T
                              
                              
                                 Σ
                              
                           
                           (
                           Var
                           )
                         for some 
                           X
                           ⊆
                           Var
                        . We often denote by σ (resp. ρ) the homomorphic extension of the substitution σ (resp. the valuation ρ) to terms. The composition of substitutions, and of a valuation and a substitution, is denoted by ○ and coincides with the standard notion of function composition. The restriction of a valuation 
                           ρ
                           :
                           Var
                           →
                           M
                         to a subset 
                           X
                           ⊆
                           Var
                         is denoted by 
                           ρ
                           
                              
                                 |
                              
                              
                                 X
                              
                           
                         and coincides with the standard notion of function restriction. Note that if M is the algebra of terms, then 
                           ρ
                           
                              
                                 |
                              
                              
                                 X
                              
                           
                         is a substitution. Domains and ranges of functions are denoted as usual, i.e., for 
                           f
                           :
                           A
                           →
                           B
                         we have 
                           dom
                           (
                           f
                           )
                           =
                           A
                        , 
                           ran
                           (
                           f
                           )
                           =
                           B
                        . A congruence ≅(over terms) is an equivalence relation, which is compatible with the operations, i.e., for every operation f with n arguments, and arguments 
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                        , 
                           
                              
                                 t
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 n
                              
                              
                                 ′
                              
                           
                        , if 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           ≅
                           
                              
                                 t
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                         for all i, then 
                           f
                           (
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                           )
                           ≅
                           f
                           (
                           
                              
                                 t
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 n
                              
                              
                                 ′
                              
                           
                           )
                        .

Given a set S of sorts, an S-sorted first order signature Φ is a pair 
                           (
                           Σ
                           ,
                           Π
                           )
                        , where 
                           Σ
                         is an algebraic S-sorted signature and 
                           Π
                         is an indexed set of the form 
                           {
                           
                              
                                 Π
                              
                              
                                 w
                              
                           
                           ∣
                           w
                           ∈
                           
                              
                                 S
                              
                              
                                 ⁎
                              
                           
                           }
                         whose elements are called predicate symbols, where 
                           p
                           ∈
                           
                              
                                 Π
                              
                              
                                 w
                              
                           
                         is said to have arity w. A Φ-model consists of a Σ-algebra M together with a subset 
                           
                              
                                 M
                              
                              
                                 p
                              
                           
                           ⊆
                           
                              
                                 M
                              
                              
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           ×
                           ⋯
                           ×
                           
                              
                                 M
                              
                              
                                 
                                    
                                       s
                                    
                                    
                                       n
                                    
                                 
                              
                           
                         for each predicate 
                           p
                           ∈
                           
                              
                                 Π
                              
                              
                                 w
                              
                           
                        , where 
                           w
                           =
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                           …
                           
                              
                                 s
                              
                              
                                 n
                              
                           
                        . For instance, we may define 
                           
                              
                                 <
                              
                              
                                 Int
                              
                           
                         as a predicate symbol in 
                           
                              
                                 Π
                              
                              
                                 Int
                                 ,
                                 Int
                              
                           
                         interpreted by the set of integer pairs (a, b) with a less than b (i.e., 
                           a
                           
                              
                                 <
                              
                              
                                 Int
                              
                           
                           b
                        ).

We now define the syntax of fol formulas over a first order signature 
                           Φ
                           =
                           (
                           Σ
                           ,
                           Π
                           )
                         and a possibly infinite set of variables Var. Given a fol signature 
                           Φ
                           =
                           (
                           Σ
                           ,
                           Π
                           )
                        , the set of Φ-formulas is defined by 
                           
                              
                                 ϕ
                                 ::=
                                 ⊤
                                 ∣
                                 p
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 ∣
                                 ¬
                                 ϕ
                                 ∣
                                 ϕ
                                 ∧
                                 ϕ
                                 ∣
                                 (
                                 ∃
                                 V
                                 )
                                 ϕ
                              
                           
                        where p ranges over predicate symbols 
                           Π
                        , each t
                        
                           i
                         ranges over 
                           
                              
                                 T
                              
                              
                                 Σ
                              
                           
                           (
                           Var
                           )
                         of appropriate sort, and V over finite subsets of Var.

Given a first order Φ-model M, a Φ-formula ϕ, V a set of S-sorted variables, and a valuation 
                           ρ
                           :
                           Var
                           →
                           M
                        , the satisfaction relation 
                           ρ
                           ⊨
                           ϕ
                         is defined as follows:
                           
                              1.
                              
                                 
                                    ρ
                                    ⊨
                                    ⊤
                                 ;


                                 
                                    ρ
                                    ⊨
                                    p
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                    )
                                  iff 
                                    (
                                    ρ
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    ,
                                    …
                                    ,
                                    ρ
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    )
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          p
                                       
                                    
                                 ;


                                 
                                    ρ
                                    ⊨
                                    ¬
                                    ϕ
                                  iff 
                                    ρ
                                    ⊨
                                    ϕ
                                  does not hold;


                                 
                                    ρ
                                    ⊨
                                    
                                       
                                          ϕ
                                       
                                       
                                          1
                                       
                                    
                                    ∧
                                    
                                       
                                          ϕ
                                       
                                       
                                          2
                                       
                                    
                                  iff 
                                    ρ
                                    ⊨
                                    
                                       
                                          ϕ
                                       
                                       
                                          1
                                       
                                    
                                  and 
                                    ρ
                                    ⊨
                                    
                                       
                                          ϕ
                                       
                                       
                                          2
                                       
                                    
                                 ;


                                 
                                    ρ
                                    ⊨
                                    (
                                    ∃
                                    V
                                    )
                                    ϕ
                                  iff there is 
                                    
                                       
                                          ρ
                                       
                                       
                                          ′
                                       
                                    
                                    :
                                    Var
                                    →
                                    M
                                  with 
                                    
                                       
                                          ρ
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    x
                                    )
                                    =
                                    ρ
                                    (
                                    x
                                    )
                                  for all 
                                    x
                                    ∉
                                    V
                                 , such that 
                                    
                                       
                                          ρ
                                       
                                       
                                          ′
                                       
                                    
                                    ⊨
                                    ϕ
                                 .

Let 
                           (
                           
                              
                                 Σ
                              
                              
                                 d
                              
                           
                           ,
                           
                              
                                 Π
                              
                              
                                 d
                              
                           
                           )
                         be a subsignature of 
                           (
                           Σ
                           ,
                           Π
                           )
                         and M be a 
                           (
                           Σ
                           ,
                           Π
                           )
                           -
                           model
                        . Then 
                           M
                           
                              
                                 ↾
                              
                              
                                 (
                                 
                                    
                                       Σ
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 
                                    
                                       Π
                                    
                                    
                                       d
                                    
                                 
                                 )
                              
                           
                         is the 
                           (
                           
                              
                                 Σ
                              
                              
                                 d
                              
                           
                           ,
                           
                              
                                 Π
                              
                              
                                 d
                              
                           
                           )
                           -
                           model
                         
                        
                           
                              
                                 M
                              
                              
                                 d
                              
                           
                         defined as follows:
                           
                              •
                              
                                 
                                    
                                       
                                          M
                                       
                                       
                                          s
                                       
                                       
                                          d
                                       
                                    
                                    =
                                    
                                       
                                          M
                                       
                                       
                                          s
                                       
                                    
                                  for each 
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                    
                                    -
                                    sort
                                 ;


                                 
                                    
                                       
                                          M
                                       
                                       
                                          f
                                       
                                       
                                          d
                                       
                                    
                                    =
                                    
                                       
                                          M
                                       
                                       
                                          f
                                       
                                    
                                  for each functional symbol f in 
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                    
                                 ;


                                 
                                    
                                       
                                          M
                                       
                                       
                                          p
                                       
                                       
                                          d
                                       
                                    
                                    =
                                    
                                       
                                          M
                                       
                                       
                                          p
                                       
                                    
                                  for each predicate symbol p in 
                                    
                                       
                                          Π
                                       
                                       
                                          d
                                       
                                    
                                 .

We recall from [30] the (topmost) ml and rl concepts and results used in this paper. First, we present the definition of ml formulas and the corresponding satisfaction relation, and then, the definition of rl formulas and the transition system generated by a set of rl formulas.
                           Definition 1
                           
                              ml formula


                           An ml 
                              signature 
                              
                                 Φ
                                 =
                                 (
                                 Σ
                                 ,
                                 Π
                                 ,
                                 Cfg
                                 )
                               is a first-order signature 
                                 (
                                 Σ
                                 ,
                                 Π
                                 )
                               together with a distinguished sort Cfg for states. The set of ml-formulas over Φ is defined by 
                                 
                                    
                                       φ
                                       ::=
                                       π
                                       ∣
                                       ⊤
                                       ∣
                                       p
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             n
                                          
                                       
                                       )
                                       ∣
                                       ¬
                                       φ
                                       ∣
                                       φ
                                       ∧
                                       φ
                                       ∣
                                       (
                                       ∃
                                       V
                                       )
                                       φ
                                    
                                 
                              where the basic pattern π ranges over 
                                 
                                    
                                       T
                                    
                                    
                                       Σ
                                       ,
                                       Cfg
                                    
                                 
                                 (
                                 Var
                                 )
                              , p ranges over predicate symbols 
                                 Π
                              , each t
                              
                                 i
                               ranges over 
                                 
                                    
                                       T
                                    
                                    
                                       Σ
                                    
                                 
                                 (
                                 Var
                                 )
                               of appropriate sorts, and V over finite subsets of Var. The sort Cfg is intended to model program states. We often call the ml formulas patterns.

The free occurrences of variables in ml formulas is defined as usual (i.e., like in fol) and we let 
                           var
                           (
                           φ
                           )
                         denote the set of variables freely occurring in φ.
                           Example 1
                           Let 
                                 φ
                                 ≜
                                 (
                                 ∃
                                 Z
                                 )
                                 
                                    
                                       〈
                                       
                                          
                                             〈
                                             x
                                             =
                                             y
                                             ;
                                             
                                             skip
                                             〉
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〈
                                             x
                                             
                                             ↦
                                             X
                                             
                                             y
                                             ↦
                                             Y
                                             〉
                                          
                                          
                                             env
                                          
                                       
                                       〉
                                    
                                    
                                       cfg
                                    
                                 
                                 ∧
                                 (
                                 X
                                 ≤
                                 Z
                                 ∧
                                 Z
                                 <
                                 Y
                                 )
                              . We have 
                                 var
                                 (
                                 φ
                                 )
                                 =
                                 {
                                 X
                                 ,
                                 Y
                                 }
                              . Program variables 
                                 x
                              , 
                                 y
                               should not be confused with logical variables X, Y; program variables are constants of sort Id.

Excepting the basic patterns, the semantics of ml formulas is similar to that of fol ones:
                           Definition 2
                           
                              ml satisfaction relation


                           Given 
                                 Φ
                                 =
                                 (
                                 Σ
                                 ,
                                 Π
                                 ,
                                 Cfg
                                 )
                               an ml signature, M a 
                                 (
                                 Σ
                                 ,
                                 Π
                                 )
                                 -
                                 model
                              , φ an ml formula, 
                                 γ
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       Cfg
                                    
                                 
                               a state, V a (S-sorted) set of variables, and 
                                 ρ
                                 :
                                 Var
                                 →
                                 M
                               a valuation, the satisfaction relation 
                                 (
                                 γ
                                 ,
                                 ρ
                                 )
                                 ⊨
                                 φ
                               is defined as follows:
                                 
                                    1.
                                    
                                       
                                          (
                                          γ
                                          ,
                                          ρ
                                          )
                                          ⊨
                                          π
                                        iff 
                                          ρ
                                          (
                                          π
                                          )
                                          =
                                          γ
                                       ;


                                       
                                          (
                                          γ
                                          ,
                                          ρ
                                          )
                                          ⊨
                                          ⊤
                                       ;


                                       
                                          (
                                          γ
                                          ,
                                          ρ
                                          )
                                          ⊨
                                          p
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                n
                                             
                                          
                                          )
                                        iff 
                                          var
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                n
                                             
                                          
                                          )
                                          ⊆
                                          X
                                        and 
                                          (
                                          ρ
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          ,
                                          …
                                          ,
                                          ρ
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                n
                                             
                                          
                                          )
                                          )
                                          ∈
                                          
                                             
                                                M
                                             
                                             
                                                p
                                             
                                          
                                       ;


                                       
                                          (
                                          γ
                                          ,
                                          ρ
                                          )
                                          ⊨
                                          ¬
                                          φ
                                        iff 
                                          (
                                          γ
                                          ,
                                          ρ
                                          )
                                          ⊨
                                          φ
                                        does not hold;


                                       
                                          (
                                          γ
                                          ,
                                          ρ
                                          )
                                          ⊨
                                          
                                             
                                                φ
                                             
                                             
                                                1
                                             
                                          
                                          ∧
                                          
                                             
                                                φ
                                             
                                             
                                                2
                                             
                                          
                                        iff 
                                          (
                                          γ
                                          ,
                                          ρ
                                          )
                                          ⊨
                                          
                                             
                                                φ
                                             
                                             
                                                1
                                             
                                          
                                        and 
                                          (
                                          γ
                                          ,
                                          ρ
                                          )
                                          ⊨
                                          
                                             
                                                φ
                                             
                                             
                                                2
                                             
                                          
                                       ; and


                                       
                                          ρ
                                          ⊨
                                          (
                                          ∃
                                          V
                                          )
                                          ϕ
                                        iff there is 
                                          
                                             
                                                ρ
                                             
                                             
                                                ′
                                             
                                          
                                          :
                                          Var
                                          →
                                          M
                                        with 
                                          
                                             
                                                ρ
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          x
                                          )
                                          =
                                          ρ
                                          (
                                          x
                                          )
                                       , for all 
                                          x
                                          ∉
                                          V
                                       , such that 
                                          
                                             
                                                ρ
                                             
                                             
                                                ′
                                             
                                          
                                          ⊨
                                          ϕ
                                       .

The denotational semantics of an ml formula consists of all concrete configurations that match it:
                           Definition 3
                           Let φ be an ml formula. Then 
                                 〚
                                 φ
                                 〛
                               denotes the set of configurations 
                                 {
                                 γ
                                 ∣
                                 (
                                 ∃
                                 ρ
                                 )
                                 (
                                 γ
                                 ,
                                 ρ
                                 )
                                 ⊨
                                 φ
                                 }
                              .

Let 
                                 φ
                                 ≜
                                 
                                    
                                       〈
                                       
                                          
                                             〈
                                             x
                                             =
                                             y
                                             ;
                                             
                                             skip
                                             〉
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〈
                                             x
                                             ↦
                                             X
                                             
                                             y
                                             ↦
                                             Y
                                             〉
                                          
                                          
                                             env
                                          
                                       
                                       〉
                                    
                                    
                                       cfg
                                    
                                 
                                 ∧
                                 (
                                 X
                                 ≥
                                 0
                                 ∧
                                 Y
                                 ≤
                                 X
                                 )
                               and 
                                 γ
                                 ≜
                                 
                                    
                                       〈
                                       
                                          
                                             〈
                                             x
                                             =
                                             y
                                             ;
                                             
                                             skip
                                             〉
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〈
                                             x
                                             ↦
                                             7
                                             
                                             y
                                             ↦
                                             3
                                             〉
                                          
                                          
                                             env
                                          
                                       
                                       〉
                                    
                                    
                                       cfg
                                    
                                 
                              . Then 
                                 γ
                                 ∈
                                 〚
                                 φ
                                 〛
                              , since there exists ρ, with 
                                 ρ
                                 (
                                 X
                                 )
                                 =
                                 7
                               and 
                                 ρ
                                 (
                                 Y
                                 )
                                 =
                                 3
                              , such that 
                                 (
                                 γ
                                 ,
                                 ρ
                                 )
                                 ⊨
                                 φ
                              .

We now recall the definition of rl formulas, which are pairs of ml formulas, and of the transition system induced by a set of rl formulas. We consider a fixed ml signature 
                           Φ
                           =
                           (
                           Σ
                           ,
                           Π
                           ,
                           Cfg
                           )
                        , a set of variables Var, and a fixed Φ-model M.
                           Definition 4
                           
                              rl formula, rl system


                           An rl formula is a pair 
                                 φ
                                 
                                    
                                       
                                    
                                 
                                 
                                    
                                       φ
                                    
                                    
                                       ′
                                    
                                 
                               of ml formulas. An rl 
                              system is a set 
                                 S
                               of rl formulas. The transition system defined by 
                                 S
                               over M is 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       Cfg
                                    
                                 
                                 ,
                                 
                                    
                                       ⇒
                                    
                                    
                                       S
                                    
                                    
                                 
                                 )
                              , where 
                                 
                                    
                                       ⇒
                                    
                                    
                                       S
                                    
                                    
                                 
                                 =
                                 {
                                 (
                                 γ
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ∣
                                 (
                                 ∃
                                 φ
                                 
                                    
                                       
                                    
                                 
                                 
                                    
                                       φ
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 S
                                 )
                                 (
                                 ∃
                                 ρ
                                 )
                                 (
                                 γ
                                 ,
                                 ρ
                                 )
                                 ⊨
                                 φ
                                 ∧
                                 (
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 ρ
                                 )
                                 ⊨
                                 
                                    
                                       φ
                                    
                                    
                                       ′
                                    
                                 
                                 }
                              . We write 
                                 γ
                                 
                                    
                                       ⇒
                                    
                                    
                                       S
                                    
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                               for 
                                 (
                                 γ
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ∈
                                 
                                    
                                       ⇒
                                    
                                    
                                       S
                                    
                                    
                                 
                              .

Let 
                                 φ
                                 ≜
                                 
                                    
                                       〈
                                       
                                          
                                             〈
                                             x
                                             =
                                             y
                                             ;
                                             
                                             skip
                                             〉
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〈
                                             x
                                             ↦
                                             X
                                             
                                             y
                                             ↦
                                             Y
                                             〉
                                          
                                          
                                             env
                                          
                                       
                                       〉
                                    
                                    
                                       cfg
                                    
                                 
                                 ∧
                                 (
                                 X
                                 ≥
                                 0
                                 ∧
                                 Y
                                 ≤
                                 X
                                 )
                              , 
                                 
                                    
                                       φ
                                    
                                    
                                       ′
                                    
                                 
                                 ≜
                                 
                                    
                                       〈
                                       
                                          
                                             〈
                                             skip
                                             〉
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〈
                                             x
                                             ↦
                                             Y
                                             
                                             y
                                             ↦
                                             Y
                                             〉
                                          
                                          
                                             env
                                          
                                       
                                       〉
                                    
                                    
                                       cfg
                                    
                                 
                                 ∧
                                 (
                                 X
                                 ≥
                                 0
                                 ∧
                                 Y
                                 ≤
                                 X
                                 )
                              , and assume 
                                 φ
                                 
                                    
                                       
                                    
                                 
                                 
                                    
                                       φ
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 S
                              . Let 
                                 γ
                                 ≜
                                 
                                    
                                       〈
                                       
                                          
                                             〈
                                             x
                                             =
                                             y
                                             ;
                                             
                                             skip
                                             〉
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〈
                                             x
                                             ↦
                                             7
                                             
                                             y
                                             ↦
                                             3
                                             〉
                                          
                                          
                                             env
                                          
                                       
                                       〉
                                    
                                    
                                       cfg
                                    
                                 
                               and 
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                                 ≜
                                 
                                    
                                       〈
                                       skip
                                       〉
                                    
                                    
                                       cfg
                                    
                                 
                                 
                                    
                                       〈
                                       x
                                       ↦
                                       3
                                       
                                       y
                                       ↦
                                       3
                                       〉
                                    
                                    
                                       env
                                    
                                 
                              . Then, 
                                 (
                                 γ
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ∈
                                 
                                    
                                       ⇒
                                    
                                    
                                       S
                                    
                                    
                                 
                              , using the same valuation ρ as in Example 2.

In this section we present the abstract notion of language definition used in the rest of the paper. 
                           K
                         language definitions are particular examples of that. In a nutshell, a language definition consists of an ml signature Φ (including the syntax of the language and the configuration), a model for Φ, and a set of rl formulas for the semantics.
                           Definition 5
                           A language definition is a tuple 
                                 L
                                 =
                                 (
                                 (
                                 Σ
                                 ,
                                 Π
                                 ,
                                 Cfg
                                 )
                                 ,
                                 M
                                 ,
                                 S
                                 )
                               where:
                                 
                                    •
                                    
                                       
                                          (
                                          Σ
                                          ,
                                          Π
                                          ,
                                          Cfg
                                          )
                                        is a ML signature,


                                       M is a model of 
                                          (
                                          Σ
                                          ,
                                          Π
                                          ,
                                          Cfg
                                          )
                                       ,


                                       
                                          S
                                        is a finite set of RL formulas, of the form 
                                          
                                             
                                                π
                                             
                                             
                                                1
                                             
                                          
                                          ∧
                                          
                                             
                                                ϕ
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                
                                             
                                          
                                          
                                             
                                                π
                                             
                                             
                                                2
                                             
                                          
                                          ∧
                                          
                                             
                                                ϕ
                                             
                                             
                                                2
                                             
                                          
                                       , where the ml formulas 
                                          
                                             
                                                π
                                             
                                             
                                                1
                                             
                                          
                                          ∧
                                          
                                             
                                                ϕ
                                             
                                             
                                                1
                                             
                                          
                                       , 
                                          
                                             
                                                π
                                             
                                             
                                                2
                                             
                                          
                                          ∧
                                          
                                             
                                                ϕ
                                             
                                             
                                                2
                                             
                                          
                                        are over the signature 
                                          (
                                          Σ
                                          ,
                                          Π
                                          ,
                                          Cfg
                                          )
                                       .

We emphasise that the model M is part of a language definition. It may includes operations over primitive data types as integers and Booleans, and data structures and their operations used to represent semantical ingredients.

In the following, we assume a (strict) subsignature 
                           (
                           
                              
                                 Σ
                              
                              
                                 d
                              
                           
                           ,
                           
                              
                                 Π
                              
                              
                                 d
                              
                           
                           )
                         of 
                           (
                           Σ
                           ,
                           Π
                           )
                         for the language׳s data types (integers, lists, etc.) and a 
                           (
                           
                              
                                 Σ
                              
                              
                                 d
                              
                           
                           ,
                           
                              
                                 Π
                              
                              
                                 d
                              
                           
                           )
                           -
                           model
                         
                        
                           D
                         such that M restricted to 
                           (
                           
                              
                                 Σ
                              
                              
                                 d
                              
                           
                           ,
                           
                              
                                 Π
                              
                              
                                 d
                              
                           
                           )
                         equals 
                           D
                        , i.e., 
                           M
                           
                              
                                 ↾
                              
                              
                                 (
                                 
                                    
                                       Σ
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 
                                    
                                       Π
                                    
                                    
                                       d
                                    
                                 
                                 )
                              
                           
                           =
                           D
                        . The sort Cfg is not a data sort. We sometimes call language definitions languages for simplicity. A language definition 
                           L
                         induces a transition system 
                           (
                           
                              
                                 M
                              
                              
                                 Cfg
                              
                           
                           ,
                           
                              
                                 ⇒
                              
                              
                                 S
                              
                              
                           
                           )
                        , where 
                           
                              
                                 ⇒
                              
                              
                                 S
                              
                              
                           
                         is given by Definition 4. The next example illustrates all these concepts on imp.
                           Example 4
                           In the case of imp, nonterminals in the syntax (Id, Int, Bool, etc.) are sorts in 
                                 Σ
                              . Each production from the syntax defines an operation in 
                                 Σ
                              ; e.g, the production 
                                 AExp
                                 ::=
                                 AExp
                                 
                                    +
                                 
                                 AExp
                               defines the operation 
                                 _
                                 
                                    +
                                 
                                 _
                                 :
                                 AExp
                                 ×
                                 AExp
                                 →
                                 AExp
                              . These operations define the constructors of the result sort. For the sort Cfg, the only constructor is 
                                 
                                    
                                       〈
                                       
                                          
                                             〈
                                             _
                                             〉
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〈
                                             _
                                             〉
                                          
                                          
                                             env
                                          
                                       
                                       〉
                                    
                                    
                                       cfg
                                    
                                 
                                 :
                                 Code
                                 ×
                                 
                                    
                                       Map
                                    
                                    
                                       Id
                                       ,
                                       Int
                                    
                                 
                                 →
                                 Cfg
                              . The expression 
                                 
                                    
                                       〈
                                       
                                          
                                             〈
                                             X
                                             =
                                             I
                                             ↷
                                             C
                                             〉
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〈
                                             X
                                             ↦
                                             0
                                             
                                             Env
                                             〉
                                          
                                          
                                             env
                                          
                                       
                                       〉
                                    
                                    
                                       cfg
                                    
                                 
                               is a term of 
                                 
                                    
                                       T
                                    
                                    
                                       Cfg
                                    
                                 
                                 (
                                 Var
                                 )
                              , where X is a variable of sort Id, I is a variable of sort Int, C is a variable of sort Code (the rest of the computation), and 
                                 Env
                               is a variable of sort 
                                 
                                    
                                       Map
                                    
                                    
                                       Id
                                       ,
                                       Int
                                    
                                 
                               (the rest of the environment). The data algebra 
                                 D
                               interprets Int as the set of integers, the operations like 
                                 
                                    
                                       +
                                    
                                    
                                       Int
                                    
                                 
                               (cf. Fig. 3) as the corresponding usual operation on integers, Bool as the set of Boolean values 
                                 {
                                 false
                                 ,
                                 true
                                 }
                              , the operation like ∧ as the usual Boolean operations, the sort 
                                 
                                    
                                       Map
                                    
                                    
                                       Id
                                       ,
                                       Int
                                    
                                 
                               as the multiset of maps 
                                 X
                                 ↦
                                 I
                              , where X ranges over identifiers Id and I over the integers Int. The value of an identifier X in an environment E is obtained by calling 
                                 lookup
                                 (
                                 X
                                 ,
                                 E
                                 )
                              , and it is updated by calling 
                                 update
                                 (
                                 X
                                 ,
                                 E
                                 ,
                                 I
                                 )
                              . Here, 
                                 lookup
                                 (
                                 )
                               and 
                                 update
                                 (
                                 )
                               are operations in 
                                 
                                    
                                       Σ
                                    
                                    
                                       d
                                    
                                 
                              . The other sorts, AExp, BExp, Stmt, and Code, are interpreted in the algebra M as ground terms over the signature 
                                 Σ
                              , in which data subterms are replaced by their interpretations in 
                                 D
                              . For instance, the term 
                                 
                                    if
                                 
                                 
                                 1
                                 
                                    
                                       >
                                    
                                    
                                       Int
                                    
                                 
                                 0
                                 
                                 
                                    then
                                 
                                 
                                 
                                    skip
                                 
                                 
                                 
                                    else
                                 
                                 
                                 
                                    skip
                                 
                               of sort Stmt is interpreted as 
                                 
                                    if
                                 
                                 
                                 
                                    
                                       D
                                    
                                    
                                       true
                                    
                                 
                                 
                                 
                                    then
                                 
                                 
                                 
                                 
                                    skip
                                 
                                 
                                 
                                    else
                                 
                                 
                                 
                                    skip
                                 
                              .

This section is dedicated to defining the symbolic domain, in which symbolic execution takes place. Intuitively, symbolic execution deals with (possibly infinite) sets of concrete configurations, denoted by ml formulas. Since (possibly, infinitely) many ml formulas may denote the same set of concrete configurations, we shall be working with the following equivalence relation on ml formulas:
                        Definition 6
                        Equivalence relation on ml formulas


                        Let φ and 
                              
                                 
                                    φ
                                 
                                 
                                    ′
                                 
                              
                            be two ml formulas. Then 
                              φ
                              ~
                              
                                 
                                    φ
                                 
                                 
                                    ′
                                 
                              
                            iff 
                              〚
                              φ
                              〛
                              =
                              〚
                              
                                 
                                    φ
                                 
                                 
                                    ′
                                 
                              
                              〛
                           .

Note that 
                        φ
                        ~
                        
                           
                              φ
                           
                           
                              ′
                           
                        
                      does not imply, in general, 
                        M
                        ⊨
                        φ
                        ↔
                        
                           
                              φ
                           
                           
                              ′
                           
                        
                     . For instance, consider patterns 
                        φ
                        ≜
                        
                           
                              〈
                              
                                 
                                    〈
                                    
                                       x=
                                    
                                    A
                                    
                                       
                                          +
                                       
                                       
                                          Int
                                       
                                    
                                    1
                                    〉
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    〈
                                    〈
                                    
                                       x
                                    
                                    ↦
                                    B
                                    
                                       
                                          +
                                       
                                       
                                          Int
                                       
                                    
                                    5
                                    〉
                                 
                                 
                                    env
                                 
                              
                              〉
                           
                           
                              cfg
                           
                        
                        ∧
                        A
                        
                           
                              <
                           
                           
                              Int
                           
                        
                        B
                      and 
                        
                           
                              φ
                           
                           
                              ′
                           
                        
                        ≜
                        
                           
                              〈
                              
                                 
                                    〈
                                    
                                       x=
                                    
                                    
                                       
                                          A
                                       
                                       
                                          ′
                                       
                                    
                                    〉
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    〈
                                    
                                       x
                                    
                                    ↦
                                    
                                       
                                          B
                                       
                                       
                                          ′
                                       
                                    
                                    〉
                                 
                                 
                                    env
                                 
                              
                              〉
                           
                           
                              cfg
                           
                        
                        ∧
                        (
                        
                           
                              A
                           
                           
                              ′
                           
                        
                        
                           
                              =
                           
                           
                              Int
                           
                        
                        A
                        
                           
                              +
                           
                           
                              Int
                           
                        
                        1
                        ∧
                        
                           
                              B
                           
                           
                              ′
                           
                        
                        
                           
                              =
                           
                           
                              Int
                           
                        
                        B
                        
                           
                              +
                           
                           
                              Int
                           
                        
                        5
                        ∧
                        A
                        
                           
                              <
                           
                           
                              Int
                           
                        
                        B
                        )
                     . We can easily observe that 
                        φ
                        ~
                        
                           
                              φ
                           
                           
                              ′
                           
                        
                     . However, 
                        M
                        ⊭
                        φ
                        ↔
                        
                           
                              φ
                           
                           
                              ′
                           
                        
                     : if 
                        γ
                        ≜
                        
                           
                              〈
                              
                                 
                                    〈
                                    
                                       x=
                                    
                                    3
                                    〉
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    〈
                                    
                                       x
                                    
                                    ↦
                                    8
                                    〉
                                 
                                 
                                    env
                                 
                              
                              〉
                           
                           
                              cfg
                           
                        
                      and 
                        ρ
                        (
                        A
                        )
                        =
                        2
                     , 
                        ρ
                        (
                        B
                        )
                        =
                        3
                     , then 
                        (
                        γ
                        ,
                        ρ
                        )
                        ⊨
                        φ
                      but 
                        (
                        γ
                        ,
                        ρ
                        )
                        ⊭
                        
                           
                              φ
                           
                           
                              ′
                           
                        
                      because 
                        ρ
                        (
                        
                           
                              A
                           
                           
                              ′
                           
                        
                        )
                      can be different from 3 and/or 
                        ρ
                        (
                        
                           
                              B
                           
                           
                              ′
                           
                        
                        )
                      can be different from 8.

For symbolic execution we shall be needing to unify equivalence classes. This notion of unifier builds upon a standard notion of unification for terms. Hereafter we consider a given congruence relation 
                        ≅
                      on 
                        
                           
                              T
                           
                           
                              Σ
                           
                        
                        (
                        Var
                        )
                     . 
                        Definition 7
                        Unifier modulo congruence


                        A 
                              ≅
                              -
                              unifier
                            of two terms 
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                            is a substitution 
                              σ
                              :
                              var
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                              →
                              
                                 
                                    T
                                 
                                 
                                    Σ
                                 
                              
                              (
                              Var
                              )
                            such that 
                              σ
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                              ≅
                              σ
                              (
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                           .

A set of 
                        ≅
                        -
                        unifiers
                      for two terms is complete if every valuation that equates the two terms is an instance of at least one substitution in the set, and a 
                        ≅
                        -
                        unification
                      algorithm computes complete sets of 
                        ≅
                        -
                        unifiers
                      for its inputs:
                        Definition 8
                        Complete set of unifiers


                        A set S of 
                              ≅
                              -
                              unifiers
                            of two terms 
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                           , 
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                            is complete if for each valuation 
                              ρ
                              :
                              Var
                              →
                              M
                            such that 
                              ρ
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                              =
                              ρ
                              (
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                           , there exist 
                              σ
                              ∈
                              S
                            and 
                              η
                              :
                              Var
                              →
                              M
                            such that 
                              ρ
                              
                                 
                                    |
                                 
                                 
                                    dom
                                    (
                                    σ
                                    )
                                 
                              
                              =
                              η
                              ○
                              σ
                           .

The existence of unification algorithms is essential in the definition of the symbolic execution:
                        Definition 9
                        A ≅-unification algorithm is a function that takes two terms and returns a finite (possibly empty) and complete set of 
                              ≅
                              -
                              unifiers
                            for the terms.

Since the unification modulo a congruence is undecidable in general, we work under the following assumption:
                        Assumption 1
                        We assume a congruence 
                              ≅
                            on 
                              
                                 
                                    T
                                 
                                 
                                    Σ
                                 
                              
                              (
                              Var
                              )
                            such that for all 
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                           , 
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    Σ
                                 
                              
                              (
                              Var
                              )
                           , if 
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ≅
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                            then 
                              ρ
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                              =
                              ρ
                              (
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                            for all valuations ρ.

We also assume a 
                              ≅
                              -
                              unification
                            algorithm, hereafter denoted by 
                              
                                 
                                    unif
                                 
                                 
                                    ≅
                                 
                              
                              (
                              _
                              ,
                              _
                              )
                           .

Unification is now extended to equivalence classes of ml formulas of the form 
                        φ
                        ≜
                        π
                        ∧
                        ϕ
                     , 
                        
                           
                              φ
                           
                           
                              ′
                           
                        
                        ≜
                        
                           
                              π
                           
                           
                              ′
                           
                        
                        ∧
                        
                           
                              ϕ
                           
                           
                              ′
                           
                        
                     . The extension consists in considering ml formulas 
                        (
                        ∃
                        X
                        )
                        
                           
                              π
                           
                           
                              ˜
                           
                        
                        ∧
                        
                           
                              ϕ
                           
                           
                              ˜
                           
                        
                      and 
                        (
                        ∃
                        
                           
                              X
                           
                           
                              ′
                           
                        
                        )
                        
                           
                              
                                 
                                    π
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              ′
                           
                        
                        ∧
                        
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              ′
                           
                        
                      that are ml-equivalent to φ and 
                        
                           
                              φ
                           
                           
                              ′
                           
                        
                     , respectively, such that 
                        
                           
                              unif
                           
                           
                              ≅
                           
                        
                        (
                        
                           
                              π
                           
                           
                              ˜
                           
                        
                        ,
                        
                           
                              
                                 
                                    π
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              ′
                           
                        
                        )
                      is nonempty; and to define symbolic unifiers as follows:
                        Definition 10
                        Unification on equivalence classes


                        An abstraction of the pattern 
                              π
                              ∧
                              ϕ
                            is a pattern 
                              (
                              ∃
                              X
                              )
                              
                                 
                                    π
                                 
                                 
                                    ˜
                                 
                              
                              ∧
                              
                                 
                                    ϕ
                                 
                                 
                                    ˜
                                 
                              
                            with the property that 
                              M
                              ⊨
                              π
                              ∧
                              ϕ
                              ↔
                              (
                              ∃
                              X
                              )
                              
                                 
                                    π
                                 
                                 
                                    ˜
                                 
                              
                              ∧
                              
                                 
                                    ϕ
                                 
                                 
                                    ˜
                                 
                              
                           . Given abstractions 
                              
                                 
                                    φ
                                 
                                 
                                    ˜
                                 
                              
                              ≜
                              (
                              ∃
                              X
                              )
                              
                                 
                                    π
                                 
                                 
                                    ˜
                                 
                              
                              ∧
                              
                                 
                                    ϕ
                                 
                                 
                                    ˜
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              ≜
                              (
                              ∃
                              X
                              )
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    ˜
                                 
                              
                              ∧
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    ˜
                                 
                              
                            of φ and 
                              
                                 
                                    φ
                                 
                                 
                                    ′
                                 
                              
                           , respectively, a symbolic unifier of the equivalence classes 
                              
                                 
                                    [
                                    φ
                                    ]
                                 
                                 
                                    ~
                                 
                              
                              ,
                              
                                 
                                    [
                                    
                                       
                                          φ
                                       
                                       
                                          ′
                                       
                                    
                                    ]
                                 
                                 
                                    ~
                                 
                              
                            is the fol formula 
                              
                                 
                                    (
                                    ∃
                                    X
                                    ∪
                                    
                                       
                                          X
                                       
                                       
                                          ′
                                       
                                    
                                    ∪
                                    var
                                    (
                                    ran
                                    (
                                    σ
                                    )
                                    )
                                    )
                                    
                                       
                                          ϕ
                                       
                                       
                                          σ
                                       
                                    
                                    ∧
                                    
                                       
                                          ϕ
                                       
                                       
                                          ˜
                                       
                                    
                                    ∧
                                    
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           where 
                              σ
                              ∈
                              
                                 
                                    unif
                                 
                                 
                                    ≅
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    ˜
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              )
                            and 
                              
                                 
                                    ϕ
                                 
                                 
                                    σ
                                 
                              
                            denotes the fol formula 
                              
                                 
                                    ⋀
                                 
                                 
                                    x
                                    ∈
                                    dom
                                    (
                                    σ
                                    )
                                 
                              
                              (
                              x
                              =
                              σ
                              (
                              x
                              )
                              )
                           .

The set of symbolic unifiers of 
                              
                                 
                                    [
                                    φ
                                    ]
                                 
                                 
                                    ~
                                 
                              
                            and 
                              
                                 
                                    [
                                    
                                       
                                          φ
                                       
                                       
                                          ′
                                       
                                    
                                    ]
                                 
                                 
                                    ~
                                 
                              
                            is denoted by 
                              unif
                              (
                              
                                 
                                    [
                                    φ
                                    ]
                                 
                                 
                                    ~
                                 
                              
                              ,
                              
                                 
                                    [
                                    
                                       
                                          φ
                                       
                                       
                                          ′
                                       
                                    
                                    ]
                                 
                                 
                                    ~
                                 
                              
                              )
                           .

Unlike unifiers of terms, which are substitutions σ, unifiers of equivalence classes are fol formulas that have 
                        
                           
                              ϕ
                           
                           
                              σ
                           
                        
                      as a subformula. Intuitively, 
                        
                           
                              ϕ
                           
                           
                              σ
                           
                        
                      plays for equivalence classes of ml formulas the role that σ plays for terms. The following sequence of implications/equivalences formalises this observation: 
                        
                           
                              
                                 
                                    
                                       σ
                                       (
                                       π
                                       )
                                       ≅
                                       σ
                                       (
                                       
                                          
                                             π
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    
                                       ⟶
                                    
                                 
                                 
                                    
                                       σ
                                       (
                                       π
                                       )
                                       ~
                                       σ
                                       (
                                       
                                          
                                             π
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    
                                       
                                       ⟺
                                       
                                    
                                 
                                 
                                    
                                       π
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             σ
                                          
                                       
                                       ~
                                       
                                          
                                             π
                                          
                                          
                                             ′
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             σ
                                          
                                       
                                    
                                    
                                       ⟶
                                    
                                 
                                 
                                    
                                       π
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             σ
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                       ∧
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ~
                                       
                                          
                                             π
                                          
                                          
                                             ′
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             σ
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                       ∧
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                 
                              
                           
                        
                     
                     
                        Example 5
                        Consider the following patterns:
                              
                                 
                                    π
                                    ∧
                                    ϕ
                                    =
                                    
                                       
                                          〈
                                          
                                             
                                                〈
                                                I
                                                
                                                   +
                                                
                                                3
                                                〉
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                〈
                                                M
                                                〉
                                             
                                             
                                                env
                                             
                                          
                                          〉
                                       
                                       
                                          cfg
                                       
                                    
                                    ∧
                                    I
                                    
                                       
                                          >
                                       
                                       
                                          Int
                                       
                                    
                                    0
                                    ,
                                    
                                       
                                          π
                                       
                                       
                                          ˜
                                       
                                    
                                    ∧
                                    
                                       
                                          ϕ
                                       
                                       
                                          ˜
                                       
                                    
                                    =
                                    
                                       
                                          〈
                                          
                                             
                                                〈
                                                I
                                                
                                                   +
                                                
                                                J
                                                〉
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                〈
                                                M
                                                〉
                                             
                                             
                                                env
                                             
                                          
                                          〉
                                       
                                       
                                          cfg
                                       
                                    
                                    ∧
                                    (
                                    I
                                    
                                       
                                          >
                                       
                                       
                                          Int
                                       
                                    
                                    0
                                    ∧
                                    J
                                    
                                       
                                          =
                                       
                                       
                                          Int
                                       
                                    
                                    3
                                    )
                                    .
                                 
                              
                           Then 
                              M
                              ⊨
                              π
                              ∧
                              ϕ
                              ↔
                              (
                              ∃
                              J
                              )
                              
                                 
                                    π
                                 
                                 
                                    ˜
                                 
                              
                              ∧
                              
                                 
                                    ϕ
                                 
                                 
                                    ˜
                                 
                              
                           , where M is the model for imp (cf. Example 4). Consider also
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ′
                                       
                                    
                                    ∧
                                    
                                       
                                          ϕ
                                       
                                       
                                          ′
                                       
                                    
                                    ≜
                                    
                                       
                                          〈
                                          
                                             
                                                〈
                                                (
                                                A
                                                
                                                   
                                                      +
                                                   
                                                   
                                                      Int
                                                   
                                                
                                                A
                                                )
                                                
                                                   +
                                                
                                                (
                                                B
                                                
                                                   
                                                      +
                                                   
                                                   
                                                      Int
                                                   
                                                
                                                1
                                                )
                                                〉
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                〈
                                                M
                                                〉
                                             
                                             
                                                env
                                             
                                          
                                          〉
                                       
                                       
                                          cfg
                                       
                                    
                                    ∧
                                    A
                                    
                                       
                                          >
                                       
                                       
                                          Int
                                       
                                    
                                    0
                                    ,
                                    
                                       
                                          
                                             
                                                π
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    ∧
                                    
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    ≜
                                    
                                       
                                          〈
                                          
                                             
                                                〈
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   +
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                〉
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                〈
                                                M
                                                〉
                                             
                                             
                                                env
                                             
                                          
                                          〉
                                       
                                       
                                          cfg
                                       
                                    
                                    ∧
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          =
                                       
                                       
                                          Int
                                       
                                    
                                    A
                                    
                                       
                                          +
                                       
                                       
                                          Int
                                       
                                    
                                    A
                                    
                                    ∧
                                    A
                                    
                                       
                                          >
                                       
                                       
                                          Int
                                       
                                    
                                    0
                                    ∧
                                    
                                       
                                          B
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          =
                                       
                                       
                                          Int
                                       
                                    
                                    B
                                    
                                       
                                          +
                                       
                                       
                                          Int
                                       
                                    
                                    1
                                    )
                                    .
                                 
                              
                           For 
                              ≅
                            being the syntactical equality, we have 
                              
                                 
                                    unif
                                 
                                 
                                    ≅
                                 
                              
                              (
                              π
                              ,
                              
                                 
                                    π
                                 
                                 
                                    ′
                                 
                              
                              )
                              =
                              ∅
                            but 
                              
                                 
                                    unif
                                 
                                 
                                    ≅
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    ˜
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              )
                              ≠
                              ∅
                           . In particular, 
                              σ
                              =
                              {
                              I
                              ↦
                              
                                 
                                    A
                                 
                                 
                                    ′
                                 
                              
                              ,
                              J
                              ↦
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              }
                              ∈
                              
                                 
                                    unif
                                 
                                 
                                    ≅
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    ˜
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              )
                            and a symbolic unifier 
                              ψ
                              ∈
                              unif
                              (
                              
                                 
                                    [
                                    π
                                    ∧
                                    ϕ
                                    ]
                                 
                                 
                                    ~
                                 
                              
                              ,
                              
                                 
                                    [
                                    
                                       
                                          π
                                       
                                       
                                          ′
                                       
                                    
                                    ∧
                                    
                                       
                                          ϕ
                                       
                                       
                                          ′
                                       
                                    
                                    ]
                                 
                                 
                                    ~
                                 
                              
                              )
                            is 
                              (
                              I
                              
                                 
                                    =
                                 
                                 
                                    Int
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    ′
                                 
                              
                              ∧
                              J
                              
                                 
                                    =
                                 
                                 
                                    Int
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              )
                              ∧
                              (
                              I
                              
                                 
                                    >
                                 
                                 
                                    Int
                                 
                              
                              0
                              ∧
                              J
                              
                                 
                                    =
                                 
                                 
                                    Int
                                 
                              
                              3
                              )
                              ∧
                              (
                              
                                 
                                    A
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    =
                                 
                                 
                                    Int
                                 
                              
                              A
                              
                                 
                                    +
                                 
                                 
                                    Int
                                 
                              
                              A
                              ∧
                              A
                              
                                 
                                    >
                                 
                                 
                                    Int
                                 
                              
                              0
                              ∧
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    =
                                 
                                 
                                    Int
                                 
                              
                              B
                              
                                 
                                    +
                                 
                                 
                                    Int
                                 
                              
                              1
                              )
                           .


                           Example 5 emphasises the role of pattern-abstractions for overcoming some problems raised by unification. During symbolic execution, programs may generate expressions such as 
                              B
                              
                                 
                                    +
                                 
                                 
                                    Int
                                 
                              
                              1
                            in the example. These are problematic for the unification process (and ultimately, for the symbolic execution itself), because expressions cannot be unified – only variables can. An abstraction 
                              (
                              ∃
                              X
                              )
                              
                                 
                                    π
                                 
                                 
                                    ˜
                                 
                              
                              ∧
                              
                                 
                                    ϕ
                                 
                                 
                                    ˜
                                 
                              
                            of 
                              π
                              ∧
                              ϕ
                            is meant to deal with this issue. For instance, 
                              (
                              ∃
                              X
                              )
                              
                                 
                                    π
                                 
                                 
                                    ˜
                                 
                              
                              ∧
                              
                                 
                                    ϕ
                                 
                                 
                                    ˜
                                 
                              
                            can be obtained from 
                              π
                              ∧
                              ϕ
                            by linearising the basic pattern π, replacing the non-data subterms with variables from X, and then adding the equalities between variables in X and the corresponding subterms to 
                              
                                 
                                    ϕ
                                 
                                 
                                    ˜
                                 
                              
                            
                           [2,27]. This is exactly what happened in the above example. This issue is discussed further in Section 6.

We now define the notion of unifiability by a valuation ρ, both for patterns and for equivalence classes.
                        Definition 11
                        Concrete and symbolic ρ-unifiability


                        Let 
                              ρ
                              :
                              Var
                              →
                              M
                            be a valuation. Two formulas 
                              π
                              ∧
                              ϕ
                           , 
                              
                                 
                                    π
                                 
                                 
                                    ′
                                 
                              
                              ∧
                              
                                 
                                    ϕ
                                 
                                 
                                    ′
                                 
                              
                            are said to be concretely ρ-unifiable if there is γ such that 
                              (
                              γ
                              ,
                              ρ
                              )
                              ⊨
                              (
                              π
                              ∧
                              ϕ
                              )
                              ∧
                              (
                              
                                 
                                    π
                                 
                                 
                                    ′
                                 
                              
                              ∧
                              
                                 
                                    ϕ
                                 
                                 
                                    ′
                                 
                              
                              )
                           . Two equivalence classes 
                              
                                 
                                    [
                                    π
                                    ∧
                                    ϕ
                                    ]
                                 
                                 
                                    ~
                                 
                              
                           , 
                              
                                 
                                    [
                                    
                                       
                                          π
                                       
                                       
                                          ′
                                       
                                    
                                    ∧
                                    
                                       
                                          ϕ
                                       
                                       
                                          ′
                                       
                                    
                                    ]
                                 
                                 
                                    ~
                                 
                              
                            are said to be symbolically ρ-unifiable if 
                              ρ
                              ⊨
                              ψ
                            for some 
                              ψ
                              ∈
                              unif
                              (
                              
                                 
                                    [
                                    π
                                    ∧
                                    ϕ
                                    ]
                                 
                                 
                                    ~
                                 
                              
                              ,
                              
                              
                                 
                                    [
                                    
                                       
                                          π
                                       
                                       
                                          ′
                                       
                                    
                                    ∧
                                    
                                       
                                          ϕ
                                       
                                       
                                          ′
                                       
                                    
                                    ]
                                 
                                 
                                    ~
                                 
                              
                              )
                           .

Let 
                              π
                              ∧
                              ϕ
                              ≜
                              
                                 
                                    〈
                                    
                                       
                                          〈
                                          X
                                          
                                             =
                                          
                                          0
                                          〉
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          〈
                                          M
                                          〉
                                       
                                       
                                          env
                                       
                                    
                                    〉
                                 
                                 
                                    cfg
                                 
                              
                            and 
                              
                                 
                                    π
                                 
                                 
                                    ′
                                 
                              
                              ∧
                              
                                 
                                    ϕ
                                 
                                 
                                    ′
                                 
                              
                              ≜
                              
                                 
                                    〈
                                    
                                       
                                          〈
                                          
                                             n=
                                          
                                          A
                                          〉
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          〈
                                          
                                             
                                                M
                                             
                                             
                                                ′
                                             
                                          
                                          〉
                                       
                                       
                                          env
                                       
                                    
                                    〉
                                 
                                 
                                    cfg
                                 
                              
                           . If we consider a valuation ρ, such that 
                              ρ
                              (
                              X
                              )
                              =
                              n
                           , 
                              ρ
                              (
                              A
                              )
                              =
                              0
                           , and 
                              ρ
                              (
                              M
                              )
                              =
                              ρ
                              (
                              
                                 
                                    M
                                 
                                 
                                    ′
                                 
                              
                              )
                           , then 
                              π
                              ∧
                              ϕ
                            and 
                              
                                 
                                    π
                                 
                                 
                                    ′
                                 
                              
                              ∧
                              
                                 
                                    ϕ
                                 
                                 
                                    ′
                                 
                              
                            are ρ-unifiable. Next, let 
                              (
                              ∃
                              I
                              )
                              
                                 
                                    〈
                                    
                                       
                                          〈
                                          X
                                          
                                             =
                                          
                                          I
                                          〉
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          〈
                                          M
                                          〉
                                       
                                       
                                          env
                                       
                                    
                                    〉
                                 
                                 
                                    cfg
                                 
                              
                              ∧
                              I
                              
                                 
                                    =
                                 
                                 
                                    Int
                                 
                              
                              0
                            be an abstraction of 
                              π
                              ∧
                              ϕ
                            and 
                              (
                              ∃
                              Y
                              )
                              
                                 
                                    〈
                                    
                                       
                                          〈
                                          Y
                                          
                                             =
                                          
                                          A
                                          〉
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          〈
                                          
                                             
                                                M
                                             
                                             
                                                ′
                                             
                                          
                                          〉
                                       
                                       
                                          env
                                       
                                    
                                    〉
                                 
                                 
                                    cfg
                                 
                              
                              ∧
                              Y
                              
                                 
                                    =
                                 
                                 
                                    Id
                                 
                              
                              n
                            be an abstraction of 
                              
                                 
                                    π
                                 
                                 
                                    ′
                                 
                              
                              ∧
                              
                                 
                                    ϕ
                                 
                                 
                                    ′
                                 
                              
                           . If 
                              σ
                              (
                              X
                              )
                              =
                              σ
                              (
                              Y
                              )
                              =
                              U
                           , 
                              σ
                              (
                              A
                              )
                              =
                              σ
                              (
                              I
                              )
                              =
                              V
                           , then 
                              ρ
                              ⊨
                              (
                              ∃
                              I
                              ,
                              Y
                              ,
                              U
                              ,
                              V
                              )
                              
                                 
                                    ϕ
                                 
                                 
                                    σ
                                 
                              
                            because there exists 
                              
                                 
                                    ρ
                                 
                                 
                                    ′
                                 
                              
                           , defined by 
                              
                                 
                                    ρ
                                 
                                 
                                    ′
                                 
                              
                              (
                              I
                              )
                              =
                              
                                 
                                    ρ
                                 
                                 
                                    ′
                                 
                              
                              (
                              V
                              )
                              =
                              0
                           , 
                              
                                 
                                    ρ
                                 
                                 
                                    ′
                                 
                              
                              (
                              Y
                              )
                              =
                              
                                 
                                    ρ
                                 
                                 
                                    ′
                                 
                              
                              (
                              U
                              )
                              =
                              n
                           , 
                              
                                 
                                    ρ
                                 
                                 
                                    ′
                                 
                              
                              (
                              X
                              )
                              =
                              ρ
                              (
                              X
                              )
                           , and 
                              
                                 
                                    ρ
                                 
                                 
                                    ′
                                 
                              
                              (
                              A
                              )
                              =
                              ρ
                              (
                              A
                              )
                            such that 
                              
                                 
                                    ρ
                                 
                                 
                                    ′
                                 
                              
                              ⊨
                              
                                 
                                    ϕ
                                 
                                 
                                    σ
                                 
                              
                              ≜
                              X
                              =
                              U
                              ∧
                              Y
                              =
                              U
                              ∧
                              I
                              =
                              0
                              ∧
                              V
                              =
                              0
                           . Also, 
                              ψ
                              ≜
                              (
                              ∃
                              I
                              ,
                              Y
                              ,
                              U
                              ,
                              V
                              )
                              ∧
                              I
                              
                                 
                                    =
                                 
                                 
                                    Int
                                 
                              
                              0
                              ∧
                              Y
                              
                                 
                                    =
                                 
                                 
                                    Id
                                 
                              
                              n
                              ∧
                              
                                 
                                    ϕ
                                 
                                 
                                    σ
                                 
                              
                            is a symbolic unifier of 
                              
                                 
                                    [
                                    π
                                    ∧
                                    ϕ
                                    ]
                                 
                                 
                                    ~
                                 
                              
                           , 
                              
                                 
                                    [
                                    
                                       
                                          π
                                       
                                       
                                          ′
                                       
                                    
                                    ∧
                                    
                                       
                                          ϕ
                                       
                                       
                                          ′
                                       
                                    
                                    ]
                                 
                                 
                                    ~
                                 
                              
                           .

The following assumption relates concrete and symbolic unifiability. Since concrete unifiability concerns the concrete model M and symbolic unifiability concerns the chosen symbolic model 
                        
                           
                              M
                           
                           
                              s
                           
                        
                     , the assumption restricts the way M is related to 
                        
                           
                              M
                           
                           
                              s
                           
                        
                     . We will see in Section 6 actual examples of pairs of concrete and symbolic models satisfying this assumption.
                        Assumption 2
                        Completeness


                        For all concretely ρ-unifiable patterns 
                              π
                              ∧
                              ϕ
                            and 
                              
                                 
                                    π
                                 
                                 
                                    ′
                                 
                              
                              ∧
                              
                                 
                                    ϕ
                                 
                                 
                                    ′
                                 
                              
                           , the classes 
                              
                                 
                                    [
                                    π
                                    ∧
                                    ϕ
                                    ]
                                 
                                 
                                    ~
                                 
                              
                            and 
                              
                                 
                                    [
                                    
                                       
                                          π
                                       
                                       
                                          ′
                                       
                                    
                                    ∧
                                    
                                       
                                          ϕ
                                       
                                       
                                          ′
                                       
                                    
                                    ]
                                 
                                 
                                    ~
                                 
                              
                            are symbolically ρ-unifiable.

In this section we show how a new definition 
                        (
                        (
                        
                           
                              Σ
                           
                           
                              s
                           
                        
                        ,
                        
                           
                              Π
                           
                           
                              s
                           
                        
                        )
                        ,
                        
                           
                              M
                           
                           
                              s
                           
                        
                        ,
                        
                           
                              S
                           
                           
                              s
                           
                        
                        )
                      of a language 
                        
                           
                              L
                           
                           
                              s
                           
                        
                      is automatically generated from a given definition 
                        (
                        Σ
                        ,
                        M
                        ,
                        S
                        )
                      of a language 
                        L
                     . The new language 
                        
                           
                              L
                           
                           
                              s
                           
                        
                      has the same syntax as 
                        L
                     , but its model 
                        
                           
                              M
                           
                           
                              s
                           
                        
                      is the symbolic model defined in the previous section, and its semantical rules 
                        
                           
                              S
                           
                           
                              s
                           
                        
                      adapts the semantical rules 
                        S
                      to deal with the new domain. Then, the symbolic execution of 
                        L
                        -
                        programs
                      is defined to be the concrete execution of the corresponding 
                        
                           
                              L
                           
                           
                              s
                           
                        
                     -programs. Building the definition of 
                        
                           
                              L
                           
                           
                              s
                           
                        
                      amounts to:
                        
                           1.
                           extending the signature 
                                 (
                                 Σ
                                 ,
                                 Π
                                 )
                               to a symbolic signature 
                                 (
                                 
                                    
                                       Σ
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       Π
                                    
                                    
                                       s
                                    
                                 
                                 )
                              ;

extending the 
                                 (
                                 Σ
                                 ,
                                 Π
                                 )
                                 -
                                 model
                               
                              M to a 
                                 (
                                 
                                    
                                       Σ
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       Π
                                    
                                    
                                       s
                                    
                                 
                                 )
                                 -
                                 model
                               
                              
                                 
                                    
                                       M
                                    
                                    
                                       s
                                    
                                 
                              ;

turning the concrete rules 
                                 S
                               into symbolic rules 
                                 
                                    
                                       S
                                    
                                    
                                       s
                                    
                                 
                              .


                        
                           
                              
                                 Σ
                              
                              
                                 s
                              
                           
                         contains two new sorts: 
                           
                              
                                 Cfg
                              
                              
                                 s
                              
                           
                         and Bool. The operations of sort Bool include the usual propositional items 
                           (
                           ⊤
                           ,
                           ∧
                           ,
                           ¬
                           )
                        , the existential quantifier, as well as an operation 
                           p
                           :
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                           …
                           
                              
                                 s
                              
                              
                                 n
                              
                           
                           →
                           Bool
                         for each predicate 
                           p
                           ∈
                           
                              
                                 Π
                              
                              
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       n
                                    
                                 
                              
                           
                        . The unique operation of sort 
                           
                              
                                 Cfg
                              
                              
                                 s
                              
                           
                         is its constructor 
                           _
                           ∧
                           _
                           :
                           Cfg
                           ×
                           Bool
                           →
                           
                              
                                 Cfg
                              
                              
                                 s
                              
                           
                        . The sort 
                           
                              
                                 Cfg
                              
                              
                                 s
                              
                           
                         is used to represent ml formulas 
                           π
                           ∧
                           ϕ
                         as terms. We naturally identify 
                           
                              
                                 Σ
                              
                              
                                 s
                              
                           
                           -
                           terms
                         of the sort Bool with the corresponding FOL 
                           (
                           Σ
                           ,
                           Π
                           )
                           -
                           formulas
                        . 
                           
                              
                                 Π
                              
                              
                                 s
                              
                           
                         consist of one predicate 
                           sat
                        , which takes one argument of sort Bool.

For the sake of presentation, for the imp example we assume that the new sort Bool extends the existing one with the new operations.

The notation 
                           〚
                           _
                           〛
                         is extended to arbitrary terms: 
                           〚
                           t
                           〛
                           ≜
                           {
                           ρ
                           (
                           t
                           )
                           ∣
                           ρ
                           
                           a
                           
                           valuation
                           }
                        . Then, the definition of the equivalence ~ is extended over arbitrary terms: 
                           t
                           ~
                           
                              
                                 t
                              
                              
                                 ′
                              
                           
                         iff 
                           〚
                           t
                           〛
                           =
                           〚
                           
                              
                                 t
                              
                              
                                 ′
                              
                           
                           〛
                        .


                        
                           
                              
                                 M
                              
                              
                                 s
                              
                           
                         interprets the elements of 
                           
                              
                                 Σ
                              
                              
                                 s
                              
                           
                         and 
                           
                              
                                 Π
                              
                              
                                 s
                              
                           
                         as follows:
                           
                              1.
                              sorts s in 
                                    Σ
                                  are interpreted as 
                                    ~
                                    -
                                    equivalence
                                  classes of terms in 
                                    
                                       
                                          T
                                       
                                       
                                          Σ
                                          (
                                          D
                                          )
                                          ,
                                          s
                                       
                                    
                                    (
                                    
                                       
                                          Var
                                       
                                       
                                          d
                                       
                                    
                                    )
                                 , where 
                                    
                                       
                                          Var
                                       
                                       
                                          d
                                       
                                    
                                    ⊊
                                    Var
                                  is the (strict) subset of variables having data sorts, and the signature 
                                    Σ
                                    (
                                    D
                                    )
                                  is the extension of the signature 
                                    Σ
                                  in which elements of the data domain 
                                    D
                                  are declared as constants of the respective sorts;

the sort 
                                    
                                       
                                          Cfg
                                       
                                       
                                          s
                                       
                                    
                                  is interpreted as 
                                    ~
                                    -
                                    equivalence
                                  classes of terms of sort 
                                    
                                       
                                          Cfg
                                       
                                       
                                          s
                                       
                                    
                                 , of the form 
                                    
                                       
                                          [
                                          π
                                          ∧
                                          ϕ
                                          ]
                                       
                                       
                                          ~
                                       
                                    
                                 , where 
                                    π
                                    ∈
                                    
                                       
                                          T
                                       
                                       
                                          Σ
                                          (
                                          D
                                          )
                                          ,
                                          Cfg
                                       
                                    
                                    (
                                    
                                       
                                          Var
                                       
                                       
                                          d
                                       
                                    
                                    )
                                  and 
                                    ϕ
                                    ∈
                                    
                                       
                                          T
                                       
                                       
                                          
                                             
                                                Σ
                                             
                                             
                                                s
                                             
                                          
                                          (
                                          D
                                          )
                                          ,
                                          Bool
                                       
                                    
                                    (
                                    
                                       
                                          Var
                                       
                                       
                                          d
                                       
                                    
                                    )
                                 ;

operations in 
                                    
                                       
                                          Σ
                                       
                                       
                                          s
                                       
                                    
                                  are interpreted syntactically, i.e. as term constructors;

the (unique) predicate 
                                    
                                       sat
                                    
                                    ∈
                                    
                                       
                                          Π
                                       
                                       
                                          s
                                       
                                    
                                  is interpreted as the theoretical satisfiability predicate for fol formulas.

If 
                                 I
                                 ∈
                                 
                                    
                                       Var
                                    
                                    
                                       d
                                    
                                 
                              , then 
                                 
                                    
                                       M
                                    
                                    
                                       s
                                    
                                 
                               interprets 
                                 I
                                 
                                    
                                       +
                                    
                                    
                                       Int
                                    
                                 
                                 3
                               as the equivalence class 
                                 
                                    
                                       [
                                       I
                                       
                                          
                                             +
                                          
                                          
                                             Int
                                          
                                       
                                       3
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                              . For instance, 
                                 1
                                 
                                    
                                       +
                                    
                                    
                                       Int
                                    
                                 
                                 I
                                 
                                    
                                       +
                                    
                                    
                                       Int
                                    
                                 
                                 2
                                 ∈
                                 
                                    
                                       [
                                       I
                                       
                                          
                                             +
                                          
                                          
                                             Int
                                          
                                       
                                       3
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                              . If 
                                 B
                                 ∈
                                 
                                    
                                       Var
                                    
                                    
                                       d
                                    
                                 
                              , then the symbolic configuration 
                                 
                                    
                                       
                                          
                                             〈
                                             if
                                             
                                             B
                                             
                                             
                                                then
                                             
                                             
                                             
                                                x=1;
                                             
                                             
                                             
                                                else
                                             
                                             
                                             
                                                x=0;
                                             
                                             〉
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〈
                                             
                                                x
                                             
                                             ↦
                                             7
                                             〉
                                          
                                          
                                             env
                                          
                                       
                                       ∧
                                       B
                                       
                                          
                                             =
                                          
                                          
                                             Bool
                                          
                                       
                                       true
                                    
                                 
                              is interpreted as 
                                 
                                    
                                       [
                                       π
                                       ∧
                                       ϕ
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                              , where 
                                 
                                    
                                       π
                                       ≜
                                       
                                          
                                             〈
                                             if
                                             
                                             B
                                             
                                             
                                                then
                                             
                                             
                                             
                                                x=1;
                                             
                                             
                                             
                                                else
                                             
                                             
                                             
                                                x=0;
                                             
                                             〉
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〈
                                             
                                                x
                                             
                                             ↦
                                             7
                                             〉
                                          
                                          
                                             env
                                          
                                       
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             Σ
                                             (
                                             D
                                             )
                                             ,
                                             Cfg
                                          
                                       
                                       (
                                       
                                          
                                             Var
                                          
                                          
                                             d
                                          
                                       
                                       )
                                    
                                 
                              and 
                                 
                                    
                                       ϕ
                                       ≜
                                       B
                                       
                                          
                                             =
                                          
                                          
                                             Bool
                                          
                                       
                                       true
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             
                                                
                                                   Σ
                                                
                                                
                                                   s
                                                
                                             
                                             (
                                             D
                                             )
                                             ,
                                             Bool
                                          
                                       
                                       (
                                       
                                          
                                             Var
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       .
                                    
                                 
                              For instance, 
                                 
                                    
                                       
                                          
                                             〈
                                             if
                                             
                                             I
                                             
                                                
                                                   <
                                                
                                                
                                                   Int
                                                
                                             
                                             8
                                             
                                             
                                                then
                                             
                                             
                                             
                                                x=1;
                                             
                                             
                                             
                                                else
                                             
                                             
                                             
                                                x=0;
                                             
                                             〉
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〈
                                             
                                                x
                                             
                                             ↦
                                             I
                                             
                                                
                                                   +
                                                
                                                
                                                   Int
                                                
                                             
                                             1
                                             〉
                                          
                                          
                                             env
                                          
                                       
                                       ∧
                                       I
                                       
                                          
                                             =
                                          
                                          
                                             Int
                                          
                                       
                                       6
                                       ∈
                                       
                                          
                                             [
                                             π
                                             ∧
                                             ϕ
                                             ]
                                          
                                          
                                             ~
                                          
                                       
                                       .
                                    
                                 
                              
                           

The set 
                           
                              
                                 S
                              
                              
                                 s
                              
                           
                         consists of a rule 
                           
                              
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 ξ
                                 
                                    
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 ξ
                              
                           
                        for each rule 
                           
                              
                                 π
                              
                              
                                 1
                              
                           
                           ∧
                           
                              
                                 ϕ
                              
                              
                                 1
                              
                           
                           
                              
                                 
                              
                           
                           
                              
                                 π
                              
                              
                                 2
                              
                           
                           ∧
                           
                              
                                 ϕ
                              
                              
                                 2
                              
                           
                           ∈
                           S
                         and each abstraction 
                           (
                           ∃
                           X
                           )
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                           ∧
                           
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                         of 
                           
                              
                                 π
                              
                              
                                 1
                              
                           
                           ∧
                           
                              
                                 ϕ
                              
                              
                                 1
                              
                           
                         (cf. Definition 10). Note that both the left-hand side and the right-hand side of the above rule are terms of sorts 
                           
                              
                                 Cfg
                              
                              
                                 s
                              
                           
                        .

If one is interested only in feasible executions, then the rules in 
                           
                              
                                 S
                              
                              
                                 s
                              
                           
                         will be of the form 
                           
                              
                                 (
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 ξ
                                 )
                                 ∧
                                 sat
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 ξ
                                 )
                                 
                                    
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 ξ
                              
                           
                        Now, the left-hand side of the rule is an ml formula, where 
                           sat
                           (
                           
                              
                                 ϕ
                              
                              
                                 2
                              
                           
                           ∧
                           
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                           ∧
                           ξ
                           )
                         is the condition.

We shall see later in this section that for practical cases it is enough to consider only one abstraction for each left-hand side of a rule in 
                           S
                        , and hence we obtain a one-to-one correspondence between 
                           S
                         and 
                           
                              
                                 S
                              
                              
                                 s
                              
                           
                        .
                           Example 8
                           Let 
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 ∈
                                 S
                               be 
                                 
                                    
                                       
                                          
                                             〈
                                             
                                                
                                                   〈
                                                   if
                                                   
                                                   true
                                                   
                                                   then
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                   else
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   〉
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   〈
                                                   E
                                                   〉
                                                
                                                
                                                   env
                                                
                                             
                                             〉
                                          
                                          
                                             cfg
                                          
                                       
                                       
                                          
                                             
                                          
                                       
                                       
                                          
                                             〈
                                             
                                                
                                                   〈
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   〉
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   〈
                                                   E
                                                   〉
                                                
                                                
                                                   env
                                                
                                             
                                             〉
                                          
                                          
                                             cfg
                                          
                                       
                                    
                                 
                              and consider the abstraction 
                                 (
                                 ∃
                                 X
                                 )
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                               of 
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                              : 
                                 
                                    
                                       (
                                       ∃
                                       B
                                       )
                                       
                                          
                                             〈
                                             
                                                
                                                   〈
                                                   if
                                                   
                                                   B
                                                   
                                                   then
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                   else
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   〉
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   〈
                                                   E
                                                   〉
                                                
                                                
                                                   env
                                                
                                             
                                             〉
                                          
                                          
                                             cfg
                                          
                                       
                                       ∧
                                       (
                                       B
                                       
                                          
                                             =
                                          
                                          
                                             Bool
                                          
                                       
                                       true
                                       )
                                       .
                                    
                                 
                              Then, the corresponding rule in 
                                 
                                    
                                       S
                                    
                                    
                                       s
                                    
                                 
                               is 
                                 
                                    
                                       
                                          
                                             〈
                                             
                                                
                                                   〈
                                                   if
                                                   
                                                   B
                                                   
                                                   then
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                   else
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   〉
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   〈
                                                   E
                                                   〉
                                                
                                                
                                                   env
                                                
                                             
                                             〉
                                          
                                          
                                             cfg
                                          
                                       
                                       ∧
                                       ξ
                                       
                                          
                                             
                                          
                                       
                                       
                                          
                                             〈
                                             
                                                
                                                   S
                                                
                                                
                                                   1
                                                
                                             
                                             〉
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〈
                                             E
                                             〉
                                          
                                          
                                             env
                                          
                                       
                                       ∧
                                       (
                                       B
                                       
                                          
                                             =
                                          
                                          
                                             Bool
                                          
                                       
                                       true
                                       )
                                       ∧
                                       ξ
                                    
                                 
                              To obtain only feasible executions we use of the satisfiability predicate:
                                 
                                    
                                       
                                          
                                             〈
                                             
                                                
                                                   〈
                                                   if
                                                   
                                                   B
                                                   
                                                   then
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                   else
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   〉
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   〈
                                                   E
                                                   〉
                                                
                                                
                                                   env
                                                
                                             
                                             〉
                                          
                                          
                                             cfg
                                          
                                       
                                       ∧
                                       ξ
                                       ∧
                                       sat
                                       (
                                       (
                                       B
                                       
                                          
                                             =
                                          
                                          
                                             Bool
                                          
                                       
                                       true
                                       )
                                       ∧
                                       ξ
                                       )
                                       
                                          
                                             
                                          
                                       
                                       
                                       
                                          
                                             〈
                                             
                                                
                                                   〈
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   〉
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   〈
                                                   E
                                                   〉
                                                
                                                
                                                   env
                                                
                                             
                                             〉
                                          
                                          
                                             cfg
                                          
                                       
                                       ∧
                                       (
                                       B
                                       
                                          
                                             =
                                          
                                          
                                             Bool
                                          
                                       
                                       true
                                       )
                                       ∧
                                       ξ
                                    
                                 
                              
                           

In this section we prove the Coverage and Precision results that relate 
                           
                              
                                 ⇒
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       s
                                    
                                 
                              
                              
                                 
                                    
                                       M
                                    
                                    
                                       s
                                    
                                 
                              
                           
                         (defined by 
                           
                              
                                 L
                              
                              
                                 s
                              
                           
                        ) with 
                           
                              
                                 ⇒
                              
                              
                                 S
                              
                              
                                 M
                              
                           
                         (defined by 
                           L
                        ). Since we defined the symbolic transition based on unification, and the semantics of programming languages is based on rewriting, we have, in general, only a weaker coverage result. However, if the unification can be achieved by matching, as is the case in practically relevant cases discussed in Section 6, then we have the expected coverage result as stated in the Introduction (Section 1): to every concrete execution there corresponds a feasible symbolic one.
                           Assumption 3
                           Hereafter, whenever a rule 
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                               is applied to a pattern 
                                 π
                                 ∧
                                 ϕ
                               with a unifier σ, we assume, w.l.o.g., that the variable names are chosen s.t. 
                                 var
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ∩
                                 var
                                 (
                                 π
                                 ,
                                 ϕ
                                 )
                                 =
                                 ∅
                              , and the unifier σ is chosen s.t. 
                                 var
                                 (
                                 ran
                                 (
                                 σ
                                 )
                                 )
                                 ∩
                                 var
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 ∅
                              . This is assumed for the symbolic rules as well.


                              Let 
                              
                                 σ
                                 :
                                 X
                                 →
                                 
                                    
                                       T
                                    
                                    
                                       Σ
                                    
                                 
                                 (
                                 Var
                                 )
                              . Then for all 
                              
                                 t
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       Σ
                                    
                                 
                                 (
                                 X
                                 )
                               
                              and all valuations 
                              
                                 ρ
                                 :
                                 Var
                                 →
                                 M
                              , if 
                              
                                 ρ
                                 ⊨
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                               
                              then 
                              
                                 ρ
                                 (
                                 σ
                                 (
                                 t
                                 )
                                 )
                                 =
                                 ρ
                                 (
                                 t
                                 )
                              .

By structural induction on t.

If t is a variable then 
                                 t
                                 ∈
                                 X
                               and from 
                                 ρ
                                 ⊨
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                                 (
                                 ≜
                                 
                                    
                                       ⋀
                                    
                                    
                                       x
                                       ∈
                                       X
                                    
                                 
                                 x
                                 =
                                 σ
                                 (
                                 x
                                 )
                                 )
                               we obtain 
                                 ρ
                                 (
                                 t
                                 )
                                 =
                                 ρ
                                 (
                                 σ
                                 (
                                 t
                                 )
                                 )
                              , which proves the base step.

Assume that 
                                 t
                                 =
                                 f
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                               with 
                                 n
                                 ≥
                                 0
                               and 
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       Σ
                                    
                                 
                                 (
                                 X
                                 )
                               for 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              . From the induction hypothesis we know that 
                                 ρ
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 ρ
                                 (
                                 σ
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 )
                               for all 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              . Thus, 
                                 ρ
                                 (
                                 t
                                 )
                                 =
                                 f
                                 (
                                 ρ
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ,
                                 …
                                 ,
                                 ρ
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 )
                                 =
                                 f
                                 (
                                 ρ
                                 (
                                 σ
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 )
                                 ,
                                 …
                                 ,
                                 ρ
                                 (
                                 σ
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 )
                                 )
                                 =
                                 f
                                 (
                                 (
                                 ρ
                                 ○
                                 σ
                                 )
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ,
                                 …
                                 ,
                                 (
                                 ρ
                                 ○
                                 σ
                                 )
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 )
                                 =
                                 (
                                 ρ
                                 ○
                                 σ
                                 )
                                 (
                                 f
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 )
                                 =
                                 ρ
                                 (
                                 σ
                                 (
                                 f
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 )
                                 )
                              , which proves the inductive step and the lemma.□


                              Let 
                              
                                 σ
                                 :
                                 X
                                 →
                                 
                                    
                                       M
                                    
                                    
                                       Σ
                                    
                                 
                                 (
                                 Var
                                 )
                               
                              be such that 
                              
                                 X
                                 ∩
                                 var
                                 (
                                 ran
                                 (
                                 σ
                                 )
                                 )
                                 =
                                 ∅
                              . Then for all 
                              fol 
                              formulas ϕ and all valuations ρ, if 
                              
                                 ρ
                                 ⊨
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                               
                              then (
                                 ρ
                                 ⊨
                                 σ
                                 (
                                 ϕ
                                 )
                               
                              iff 
                              
                                 ρ
                                 ⊨
                                 ϕ
                              ).

We proceed by structural induction on ϕ. The base case (
                                 ϕ
                                 =
                                 ⊤
                              ) is trivial, so we only focus on the remaining cases:
                                 
                                    (1)
                                    
                                       ϕ is 
                                          p
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                n
                                             
                                          
                                          )
                                        with 
                                          p
                                          ∈
                                          Π
                                       . Then 
                                          
                                             
                                                ρ
                                                ⊨
                                                σ
                                                (
                                                ϕ
                                                )
                                                
                                                ⟺
                                                
                                                ρ
                                                ⊨
                                                p
                                                (
                                                σ
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                ,
                                                …
                                                ,
                                                σ
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      n
                                                   
                                                
                                                )
                                                )
                                                
                                                ⟺
                                                
                                                (
                                                ρ
                                                (
                                                σ
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                )
                                                ,
                                                …
                                                ,
                                                ρ
                                                (
                                                σ
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      n
                                                   
                                                
                                                )
                                                )
                                                )
                                                ∈
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      p
                                                   
                                                
                                                
                                                ⟺
                                                
                                                (
                                                ρ
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                ,
                                                …
                                                ,
                                                ρ
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      n
                                                   
                                                
                                                )
                                                )
                                                ∈
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      p
                                                   
                                                
                                                
                                                (
                                                by
                                                
                                                Lemma
                                                1
                                                )
                                                
                                                ⟺
                                                
                                                ρ
                                                ⊨
                                                p
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      n
                                                   
                                                
                                                )
                                                
                                                ⟺
                                                
                                                ρ
                                                ⊨
                                                ϕ
                                                .
                                             
                                          
                                       
                                    


                                       ϕ is 
                                          ¬
                                          
                                             
                                                ϕ
                                             
                                             
                                                1
                                             
                                          
                                       . Then 
                                          
                                             
                                                ρ
                                                ⊨
                                                σ
                                                (
                                                ϕ
                                                )
                                                
                                                ⟺
                                                
                                                ρ
                                                ⊭
                                                σ
                                                (
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                
                                                ⟺
                                                
                                                ρ
                                                ⊭
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                (
                                                by
                                                
                                                the
                                                
                                                induction
                                                
                                                hypothesis
                                                )
                                                
                                                ⟺
                                                
                                                ρ
                                                ⊨
                                                ¬
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                ⟺
                                                
                                                ρ
                                                ⊨
                                                ϕ
                                                .
                                             
                                          
                                       
                                    


                                       ϕ is 
                                          
                                             
                                                ϕ
                                             
                                             
                                                1
                                             
                                          
                                          ∧
                                          
                                             
                                                ϕ
                                             
                                             
                                                2
                                             
                                          
                                       . The proof is similar to that of case (2), using (
                                          ρ
                                          ⊨
                                          σ
                                          (
                                          
                                             
                                                ϕ
                                             
                                             
                                                1
                                             
                                          
                                          )
                                        iff ρ⊨ϕ
                                       1) and (
                                          ρ
                                          ⊨
                                          σ
                                          (
                                          
                                             
                                                ϕ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                        iff ρ⊨ϕ
                                       2) as inductive hypotheses.


                                       ϕ is 
                                          (
                                          ∃
                                          Y
                                          )
                                          
                                             
                                                ϕ
                                             
                                             
                                                1
                                             
                                          
                                       . We may assume w.l.o.g. that 
                                          Y
                                          ∩
                                          (
                                          X
                                          ∪
                                          var
                                          (
                                          ran
                                          (
                                          σ
                                          )
                                          )
                                          )
                                          =
                                          ∅
                                       . We have 
                                          σ
                                          (
                                          ϕ
                                          )
                                          =
                                          (
                                          ∃
                                          Y
                                          )
                                          σ
                                          (
                                          
                                             
                                                ϕ
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       . Then 
                                          
                                             
                                                ρ
                                                ⊨
                                                σ
                                                (
                                                ϕ
                                                )
                                                
                                                ⟺
                                                
                                                (
                                                ∃
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ⊨
                                                σ
                                                (
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                
                                                ⟺
                                                
                                                (
                                                ∃
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ⊨
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                (
                                                by
                                                
                                                the
                                                
                                                induction
                                                
                                                hypothesis
                                                )
                                                
                                                ⟺
                                                
                                                ρ
                                                ⊨
                                                ϕ
                                                .
                                             
                                          
                                       where 
                                          
                                             
                                                ρ
                                             
                                             
                                                ′
                                             
                                          
                                        satisfies 
                                          
                                             
                                                ρ
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          x
                                          )
                                          =
                                          ρ
                                          (
                                          x
                                          )
                                        for all 
                                          x
                                          ∉
                                          Y
                                       , which implies 
                                          ρ
                                          (
                                          σ
                                          (
                                          x
                                          )
                                          )
                                          =
                                          ρ
                                          (
                                          x
                                          )
                                        by the hypotheses of the lemma and 
                                          Y
                                          ∩
                                          (
                                          X
                                          ∪
                                          var
                                          (
                                          ran
                                          (
                                          σ
                                          )
                                          )
                                          )
                                          =
                                          ∅
                                       .□


                        Lemmas 3 and 4 are essential for proving our weak coverage result.
                           Lemma 3
                           
                              If 
                              
                                 σ
                                 :
                                 X
                                 →
                                 
                                    
                                       T
                                    
                                    
                                       Σ
                                    
                                 
                                 (
                                 Var
                                 )
                               
                              such that 
                              
                                 X
                                 ∩
                                 var
                                 (
                                 ran
                                 (
                                 σ
                                 )
                                 )
                                 =
                                 ∅
                               
                              and 
                              
                                 var
                                 (
                                 π
                                 ∧
                                 ϕ
                                 )
                                 ⊆
                                 X
                              , then 
                              
                                 σ
                                 (
                                 π
                                 ∧
                                 ϕ
                                 )
                                 ~
                                 π
                                 ∧
                                 ϕ
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                              .

By Definition 6 of the ~ relation, we have to prove that 
                                 〚
                                 σ
                                 (
                                 π
                                 ∧
                                 ϕ
                                 )
                                 〛
                                 =
                                 〚
                                 π
                                 ∧
                                 ϕ
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                                 〛
                              . We distinguish two cases:


                              
                                 ⊆
                              . Assume 
                                 γ
                                 ∈
                                 〚
                                 σ
                                 (
                                 π
                                 ∧
                                 ϕ
                                 )
                                 〛
                              . Then there exists ρ such that 
                                 γ
                                 =
                                 ρ
                                 (
                                 σ
                                 (
                                 π
                                 )
                                 )
                               and 
                                 ρ
                                 ⊨
                                 σ
                                 (
                                 π
                                 )
                              . Let 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                               denote the valuation given by 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 ρ
                                 (
                                 σ
                                 (
                                 x
                                 )
                                 )
                              , if 
                                 x
                                 ∈
                                 X
                              , and 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 ρ
                                 (
                                 x
                                 )
                              , if 
                                 x
                                 ∉
                                 X
                              . We obviously have 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 π
                                 )
                                 =
                                 ρ
                                 (
                                 σ
                                 (
                                 π
                                 )
                                 )
                                 =
                                 γ
                              . Since 
                                 X
                                 ∩
                                 var
                                 (
                                 ran
                                 (
                                 σ
                                 )
                                 )
                                 =
                                 ∅
                               and 
                                 var
                                 (
                                 π
                                 ∧
                                 ϕ
                                 )
                                 ⊆
                                 X
                              , we obtain 
                                 X
                                 ∩
                                 var
                                 (
                                 σ
                                 (
                                 ϕ
                                 )
                                 )
                                 =
                                 ∅
                              , which implies 
                                 ρ
                                 ⊨
                                 σ
                                 (
                                 ϕ
                                 )
                               iff 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 ⊨
                                 σ
                                 (
                                 ϕ
                                 )
                              . We obtain that 
                                 (
                                 γ
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊨
                                 π
                                 ∧
                                 ϕ
                              . We also have 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 ρ
                                 (
                                 σ
                                 (
                                 x
                                 )
                                 )
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 σ
                                 (
                                 x
                                 )
                                 )
                               for all 
                                 x
                                 ∈
                                 X
                               thanks again to 
                                 X
                                 ∩
                                 var
                                 (
                                 ran
                                 (
                                 σ
                                 )
                                 )
                                 =
                                 ∅
                               and to the definition of 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                              , which implies 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 ⊨
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                              . We may conclude now that 
                                 γ
                                 ∈
                                 〚
                                 π
                                 ∧
                                 ϕ
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                                 〛
                              . Since γ was arbitrarily chosen, we obtain 
                                 〚
                                 σ
                                 (
                                 π
                                 ∧
                                 ϕ
                                 )
                                 〛
                                 ⊆
                                 〚
                                 π
                                 ∧
                                 ϕ
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                                 〛
                              .


                              
                                 ⊇
                              . Assume 
                                 γ
                                 ∈
                                 〚
                                 π
                                 ∧
                                 ϕ
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                                 〛
                              . Then there exists ρ such that 
                                 γ
                                 =
                                 ρ
                                 (
                                 π
                                 )
                               and 
                                 ρ
                                 ⊨
                                 ϕ
                               and 
                                 ρ
                                 ⊨
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                              . We obtain 
                                 ρ
                                 ⊨
                                 σ
                                 (
                                 ϕ
                                 )
                               by Lemma 2 and 
                                 ρ
                                 (
                                 π
                                 )
                                 =
                                 ρ
                                 (
                                 σ
                                 (
                                 π
                                 )
                                 )
                               by Lemma 1. Hence 
                                 γ
                                 ∈
                                 〚
                                 σ
                                 (
                                 π
                                 ∧
                                 ϕ
                                 )
                                 〛
                              . Since γ was arbitrarily chosen, we obtain 
                                 〚
                                 π
                                 ∧
                                 ϕ
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                                 〛
                                 ⊆
                                 〚
                                 σ
                                 (
                                 π
                                 ∧
                                 ϕ
                                 )
                                 〛
                              .□


                              Let 
                              
                                 (
                                 ∃
                                 X
                                 )
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                               
                              be an abstraction of the pattern 
                              
                                 π
                                 ∧
                                 ϕ
                              . Then 
                              
                                 π
                                 ∧
                                 ϕ
                                 ~
                                 (
                                 ∃
                                 X
                                 )
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                              .

We have to prove that 
                                 〚
                                 π
                                 ∧
                                 ϕ
                                 〛
                                 =
                                 〚
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                                 〛
                              . Let σ be the substitution such that 
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                               is 
                                 ϕ
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                              . Then: 
                                 
                                    
                                       
                                          
                                             
                                                γ
                                                ∈
                                                〚
                                                π
                                                ∧
                                                ϕ
                                                〛
                                             
                                             
                                                
                                                ⟺
                                                
                                             
                                          
                                          
                                             
                                                (
                                                ∃
                                                ρ
                                                )
                                                (
                                                γ
                                                ,
                                                ρ
                                                )
                                                ⊨
                                                π
                                                ∧
                                                ϕ
                                             
                                             
                                                
                                                ⟺
                                                
                                             
                                          
                                          
                                             
                                                (
                                                ∃
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                                (
                                                γ
                                                ,
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                                ⊨
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                                ∧
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                          
                                       
                                    
                                 
                              where 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 ρ
                                 (
                                 σ
                                 (
                                 x
                                 )
                                 )
                               for each 
                                 x
                                 ∈
                                 X
                               (
                                 =
                                 dom
                                 (
                                 σ
                                 )
                              ) and 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 ρ
                                 (
                                 x
                                 )
                               otherwise. We obviously have 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                                 )
                                 =
                                 ρ
                                 (
                                 σ
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                                 )
                                 )
                                 =
                                 ρ
                                 (
                                 π
                                 )
                                 =
                                 γ
                              . Since 
                                 X
                                 ∩
                                 var
                                 (
                                 ran
                                 (
                                 σ
                                 )
                                 )
                                 =
                                 ∅
                               we obtain 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 σ
                                 (
                                 x
                                 )
                                 )
                                 =
                                 ρ
                                 (
                                 σ
                                 (
                                 x
                                 )
                                 )
                               for all 
                                 x
                                 ∈
                                 X
                              , which implies 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 ⊨
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                              .□

The next theorem says that every concrete transition 
                           γ
                           
                              
                                 ⇒
                              
                              
                                 S
                              
                              
                           
                           
                              
                                 γ
                              
                              
                                 ′
                              
                           
                         such that 
                           γ
                           ∈
                           〚
                           π
                           ∧
                           ϕ
                           〛
                         is simulated by a symbolic transition step. We call the result “weak” because in the symbolic transition step does not start exactly in 
                           
                              
                                 [
                                 π
                                 ∧
                                 ϕ
                                 ]
                              
                              
                                 ~
                              
                           
                        , but in a subset of it.
                           Theorem 5
                           One-step Weak Coverage


                           
                              If 
                              
                                 γ
                                 
                                    
                                       ⇒
                                    
                                    
                                       S
                                    
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                               
                              and 
                              
                                 γ
                                 ∈
                                 〚
                                 π
                                 ∧
                                 ϕ
                                 〛
                              , then there exist a 
                              fol 
                              formula 
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                               
                              and a pattern 
                              
                                 
                                    
                                       π
                                    
                                    
                                       ′
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ′
                                    
                                 
                               
                              such that 
                              
                                 γ
                                 ∈
                                 〚
                                 π
                                 ∧
                                 ϕ
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                                 〛
                              , 
                                 
                                    
                                       [
                                       π
                                       ∧
                                       ϕ
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             σ
                                          
                                       
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                                 
                                    
                                       ⇒
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 
                                    
                                       [
                                       
                                          
                                             π
                                          
                                          
                                             ′
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             ′
                                          
                                       
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 〚
                                 
                                    
                                       π
                                    
                                    
                                       ′
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ′
                                    
                                 
                                 〛
                              .

Assume that 
                                 γ
                                 
                                    
                                       ⇒
                                    
                                    
                                       S
                                    
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                              . There exist 
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 ∈
                                 S
                               and a valuation ρ such that 
                                 (
                                 γ
                                 ,
                                 ρ
                                 )
                                 ⊨
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 (
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 ρ
                                 )
                                 ⊨
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                               by the definition of 
                                 
                                    
                                       ⇒
                                    
                                    
                                       S
                                    
                                    
                                 
                              . From 
                                 γ
                                 ∈
                                 〚
                                 π
                                 ∧
                                 ϕ
                                 〛
                               we obtain a valuation 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                               such that 
                                 (
                                 γ
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊨
                                 π
                                 ∧
                                 ϕ
                              . Assumption 3 allows us to take 
                                 ρ
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                               since the two valuations affect disjoint sets of variables. Thus, 
                                 (
                                 γ
                                 ,
                                 ρ
                                 )
                                 ⊨
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 (
                                 γ
                                 ,
                                 ρ
                                 )
                                 ⊨
                                 π
                                 ∧
                                 ϕ
                              , meaning that and 
                                 π
                                 ∧
                                 ϕ
                               are concretely ρ-unifiable. By Assumption 2, there is 
                                 ψ
                                 ∈
                                 unif
                                 (
                                 
                                    
                                       [
                                       
                                          
                                             π
                                          
                                          
                                             1
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             1
                                          
                                       
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                                 ,
                                 
                                    
                                       [
                                       π
                                       ∧
                                       ϕ
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                                 )
                               such that 
                                 ρ
                                 ⊨
                                 ψ
                              . We assume that 
                                 ψ
                                 ≜
                                 (
                                 ∃
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 ∪
                                 X
                                 ∪
                                 var
                                 (
                                 ran
                                 (
                                 σ
                                 )
                                 )
                                 )
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                              , where 
                                 M
                                 ⊨
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 ↔
                                 (
                                 ∃
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                               and 
                                 M
                                 ⊨
                                 π
                                 ∧
                                 ϕ
                                 ↔
                                 (
                                 ∃
                                 X
                                 )
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                              .

We have 
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 ξ
                                 
                                    
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 ξ
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       s
                                    
                                 
                               by the definition of 
                                 
                                    
                                       S
                                    
                                    
                                       s
                                    
                                 
                              . Let 
                                 
                                    
                                       ρ
                                    
                                    
                                       s
                                    
                                 
                                 :
                                 Var
                                 →
                                 
                                    
                                       M
                                    
                                    
                                       s
                                    
                                 
                               be the symbolic valuation such that 
                                 
                                    
                                       ρ
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       [
                                       σ
                                       (
                                       x
                                       )
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                              , for all 
                                 x
                                 ∈
                                 dom
                                 (
                                 σ
                                 )
                              , and 
                                 
                                    
                                       ρ
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 ξ
                                 )
                                 =
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                              , and 
                                 
                                    
                                       ρ
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       [
                                       x
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                               otherwise. We have
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             s
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   π
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ∧
                                       ξ
                                       )
                                       =
                                       
                                          
                                             [
                                             σ
                                             (
                                             
                                                
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             ∧
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   ˜
                                                
                                             
                                             ]
                                          
                                          
                                             ~
                                          
                                       
                                       
                                       (
                                       by
                                       
                                       the
                                       
                                       def
                                       .
                                       
                                       of
                                       
                                       
                                          
                                             ρ
                                          
                                          
                                             s
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             [
                                             σ
                                             (
                                             
                                                
                                                   π
                                                
                                                
                                                   ˜
                                                
                                             
                                             )
                                             ∧
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   ˜
                                                
                                             
                                             ]
                                          
                                          
                                             ~
                                          
                                       
                                       
                                       (
                                       σ
                                       
                                       is
                                       
                                       a
                                       ≅
                                       −
                                       unifier
                                       )
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   π
                                                
                                                
                                                   ˜
                                                
                                             
                                             ∧
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   ˜
                                                
                                             
                                             ∧
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   σ
                                                
                                             
                                             ]
                                          
                                          
                                             ~
                                          
                                       
                                       
                                       (
                                       Lemma
                                       
                                       3
                                       )
                                       =
                                       
                                          
                                             [
                                             π
                                             ∧
                                             ϕ
                                             ∧
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   σ
                                                
                                             
                                             ]
                                          
                                          
                                             ~
                                          
                                       
                                       
                                       (
                                       π
                                       ∧
                                       ϕ
                                       ~
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                       
                                       (
                                       using
                                       
                                       Lemma
                                       
                                       4
                                       )
                                       )
                                    
                                 
                              and
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             s
                                          
                                       
                                       (
                                       
                                          
                                             π
                                          
                                          
                                             2
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             2
                                          
                                       
                                       ∧
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ∧
                                       ξ
                                       )
                                       =
                                       
                                          
                                             [
                                             σ
                                             (
                                             
                                                
                                                   π
                                                
                                                
                                                   2
                                                
                                             
                                             ∧
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             ∧
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             ∧
                                             ϕ
                                             ]
                                          
                                          
                                             ~
                                          
                                       
                                       
                                       (
                                       by
                                       
                                       the
                                       
                                       def
                                       .
                                       
                                       of
                                       
                                       
                                          
                                             ρ
                                          
                                          
                                             s
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   π
                                                
                                                
                                                   2
                                                
                                             
                                             ∧
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             ∧
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             ∧
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   σ
                                                
                                             
                                             ∧
                                             ϕ
                                             ]
                                          
                                          
                                             ~
                                          
                                       
                                       
                                       (
                                       using
                                       
                                       Lemma
                                       
                                       3
                                       )
                                    
                                 
                              The above equalities imply 
                                 
                                    
                                       [
                                       π
                                       ∧
                                       ϕ
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             σ
                                          
                                       
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                                 
                                    
                                       ⇒
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 
                                    
                                       [
                                       
                                          
                                             π
                                          
                                          
                                             2
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             2
                                          
                                       
                                       ∧
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             σ
                                          
                                       
                                       ∧
                                       ϕ
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                              , so we can take 
                                 
                                    
                                       π
                                    
                                    
                                       ′
                                    
                                 
                                 ≜
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                               and 
                                 
                                    
                                       ϕ
                                    
                                    
                                       ′
                                    
                                 
                                 ≜
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                                 ∧
                                 ϕ
                              . It remains to prove that 
                                 γ
                                 ∈
                                 〚
                                 π
                                 ∧
                                 ϕ
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                                 〛
                               and 
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 〚
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                                 ∧
                                 ϕ
                                 〛
                              . Since 
                                 ρ
                                 ⊨
                                 ψ
                               and ψ is existentially quantified, it follows that there is 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                               such that 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 ⊨
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                              , 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 ⊨
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                              , and 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 ρ
                                 (
                                 x
                                 )
                               for all 
                                 x
                                 ∉
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 ∪
                                 X
                                 ∪
                                 var
                                 (
                                 ran
                                 (
                                 σ
                                 )
                                 )
                              . We may choose X, X
                              1, and σ such that 
                                 var
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 ϕ
                                 )
                                 ∩
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 ∪
                                 X
                                 ∪
                                 var
                                 (
                                 ran
                                 (
                                 σ
                                 )
                                 )
                                 )
                                 =
                                 ∅
                              . From 
                                 (
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 ρ
                                 )
                                 ⊨
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                              , 
                                 ρ
                                 ⊨
                                 ϕ
                              , and the definition of 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                               we obtain 
                                 (
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊨
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                               and 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 ⊨
                                 ϕ
                              , which imply 
                                 (
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊨
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                                 ∧
                                 ϕ
                              . Hence 
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 〚
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                                 ∧
                                 ϕ
                                 〛
                              . We obtain 
                                 (
                                 γ
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊨
                                 π
                                 ∧
                                 ϕ
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                               in a similar way, which implies 
                                 γ
                                 ∈
                                 〚
                                 π
                                 ∧
                                 ϕ
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                                 〛
                              , which finishes the proof.□

Recall the semantic rule for the and operator, from the semantics of imp (Fig. 3). The rule can be written as below:
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             1
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                          
                                       
                                       
                                          
                                             π
                                          
                                          
                                             2
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             2
                                          
                                       
                                       ≜
                                       
                                          
                                             〈
                                             
                                                
                                                   〈
                                                   true
                                                   
                                                   
                                                      and
                                                   
                                                   
                                                   B
                                                   ↷
                                                   C
                                                   〉
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   〈
                                                   M
                                                   〉
                                                
                                                
                                                   env
                                                
                                             
                                             〉
                                          
                                          
                                             cfg
                                          
                                       
                                       ∧
                                       ⊤
                                       
                                          
                                             
                                          
                                       
                                       
                                          
                                             〈
                                             
                                                
                                                   〈
                                                   B
                                                   ↷
                                                   C
                                                   〉
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   〈
                                                   M
                                                   〉
                                                
                                                
                                                   env
                                                
                                             
                                             〉
                                          
                                          
                                             cfg
                                          
                                       
                                       ∧
                                       ⊤
                                       .
                                    
                                 
                              Let 
                                 π
                                 ∧
                                 ϕ
                                 ≜
                                 
                                    
                                       〈
                                       
                                          
                                             〈
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                             
                                             
                                             
                                                and
                                             
                                             
                                             I
                                             
                                                
                                                   <
                                                
                                                
                                                   Int
                                                
                                             
                                             0
                                             ↷
                                             
                                                
                                                   C
                                                
                                                
                                                   ′
                                                
                                             
                                             〉
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〈
                                             M
                                             〉
                                          
                                          
                                             env
                                          
                                       
                                       〉
                                    
                                    
                                       cfg
                                    
                                 
                                 ∧
                                 ⊤
                              , and ρ be a valuation which satisfies 
                                 ρ
                                 (
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 true
                                 ,
                                 ρ
                                 (
                                 I
                                 )
                                 =
                                 2
                                 ,
                                 ρ
                                 (
                                 B
                                 )
                                 =
                                 false
                              , 
                                 ρ
                                 (
                                 C
                                 )
                                 =
                                 ρ
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              . Then 
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 π
                                 ∧
                                 ϕ
                               are concretely ρ-unifiable and 
                                 γ
                                 
                                    
                                       ⇒
                                    
                                    
                                       S
                                    
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                              , where 
                                 γ
                                 =
                                 ρ
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 ρ
                                 (
                                 π
                                 )
                               and 
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 ρ
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                              . We assume that 
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                               is 
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                              . Then the substitution σ given by 
                                 σ
                                 (
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 true
                                 ,
                                 σ
                                 (
                                 B
                                 )
                                 =
                                 I
                                 
                                    
                                       <
                                    
                                    
                                       Int
                                    
                                 
                                 0
                                 ,
                                 σ
                                 (
                                 I
                                 )
                                 =
                                 2
                                 ,
                                 σ
                                 (
                                 C
                                 )
                                 =
                                 σ
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 C
                                 ″
                               is a unifier of 
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                               and π, where 
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                               is 
                                 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             =
                                          
                                          
                                             Bool
                                          
                                       
                                       true
                                       ∧
                                       B
                                       
                                          
                                             =
                                          
                                          
                                             Bool
                                          
                                       
                                       I
                                       
                                          
                                             <
                                          
                                          
                                             Int
                                          
                                       
                                       0
                                       ∧
                                       I
                                       
                                          
                                             =
                                          
                                          
                                             Int
                                          
                                       
                                       2
                                       ∧
                                       C
                                       =
                                       C
                                       ″
                                       ∧
                                       
                                          
                                             C
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       C
                                       ″
                                       ,
                                    
                                 
                              and 
                                 ρ
                                 ⊨
                                 (
                                 ∃
                                 C
                                 ″
                                 )
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                              . Since ϕ, 
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                              , ϕ
                              1, and ϕ
                              2 are all equal to 
                                 ⊤
                              , we have 
                                 π
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                                 
                                    
                                       ⇒
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                              , i.e. (we replaced 
                                 C
                                 =
                                 C
                                 ″
                                 ∧
                                 
                                    
                                       C
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 C
                                 ″
                               by 
                                 C
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       ′
                                    
                                 
                               for the sake of presentation): 
                                 
                                    
                                       
                                          
                                             
                                          
                                       
                                    
                                 
                              
                           

The “One-step Weak Coverage” property stated by Theorem 5 can be transformed into “One-step Coverage”, i.e., the symbolic step covering the concrete one starts exactly from the initial formula (and not from a strengthening of it) if the abstractions of the involved patterns can be defined such that unification reduces to matching.
                           Corollary 6
                           One-step Coverage


                           
                              Let 
                              
                                 π
                                 ∧
                                 ϕ
                               
                              be a pattern such that for each rule 
                              
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 ∈
                                 S
                               
                              there exist abstractions 
                              
                                 (
                                 ∃
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                               
                              and 
                              
                                 (
                                 ∃
                                 X
                                 )
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                               
                              of 
                              
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                               
                              and 
                              
                                 π
                                 ∧
                                 ϕ
                              , respectively, such that 
                              
                                 σ
                                 (
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                               
                              for all 
                              
                                 ≅
                                 -
                                 unifiers
                               
                              σ of 
                              
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                              . Then, for all 
                              
                                 γ
                                 
                                    
                                       ⇒
                                    
                                    
                                       S
                                    
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                               
                              with 
                              
                                 γ
                                 ∈
                                 〚
                                 π
                                 ∧
                                 ϕ
                                 〛
                               
                              there exists a pattern 
                              
                                 
                                    
                                       π
                                    
                                    
                                       ′
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ′
                                    
                                 
                               
                              such that 
                              
                                 
                                    
                                       [
                                       π
                                       ∧
                                       ϕ
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                                 
                                    
                                       ⇒
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 
                                    
                                       [
                                       
                                          
                                             π
                                          
                                          
                                             ′
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             ′
                                          
                                       
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 〚
                                 
                                    
                                       π
                                    
                                    
                                       ′
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ′
                                    
                                 
                                 〛
                              .

In the proof of Theorem 5, we use the set of equalities for 
                                 
                                    
                                       ρ
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 ξ
                                 )
                              :
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             s
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   π
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ∧
                                       ξ
                                       )
                                       =
                                       
                                          
                                             [
                                             σ
                                             (
                                             
                                                
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             ∧
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   ˜
                                                
                                             
                                             ]
                                          
                                          
                                             ~
                                          
                                       
                                       
                                       (
                                       by
                                       
                                       the
                                       
                                       def
                                       .
                                       
                                       of
                                       
                                       
                                          
                                             ρ
                                          
                                          
                                             s
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   π
                                                
                                                
                                                   ˜
                                                
                                             
                                             ∧
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   ˜
                                                
                                             
                                             ]
                                          
                                          
                                             ~
                                          
                                       
                                       
                                       (
                                       σ
                                       
                                       is
                                       
                                       a
                                       
                                       ≅
                                       -
                                       matcher
                                       )
                                       =
                                       
                                          
                                             [
                                             π
                                             ∧
                                             ϕ
                                             ]
                                          
                                          
                                             ~
                                          
                                       
                                       
                                       (
                                       π
                                       ∧
                                       ϕ
                                       ~
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                       )
                                       □
                                    
                                 
                              
                           

In Section 6 we present the general conditions under which the hypotheses of Corollary 6 hold, and thus, full coverage holds. This is illustrated in Example 10.
                           Example 10
                           We assume that the rule 
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 ∈
                                 S
                               and the pattern 
                                 π
                                 ∧
                                 ϕ
                               are those given in Example 9. If the abstraction 
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                               of 
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                               is 
                                 
                                    
                                       〈
                                       
                                          
                                             〈
                                             
                                                
                                                   B
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                             
                                                and
                                             
                                             
                                             B
                                             ↷
                                             C
                                             〉
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〈
                                             M
                                             〉
                                          
                                          
                                             env
                                          
                                       
                                       〉
                                    
                                    
                                       cfg
                                    
                                 
                                 ∧
                                 
                                    
                                       B
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 true
                              , then the substitution σ given by 
                                 σ
                                 (
                                 
                                    
                                       B
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 σ
                                 (
                                 B
                                 )
                                 =
                                 I
                                 
                                    
                                       <
                                    
                                    
                                       Int
                                    
                                 
                                 0
                              , 
                                 σ
                                 (
                                 I
                                 )
                                 =
                                 
                                    
                                       I
                                    
                                    
                                       ′
                                    
                                 
                              , 
                                 σ
                                 (
                                 C
                                 )
                                 =
                                 σ
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 C
                                 ″
                               is a unifier of 
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                               and π, 
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                               is 
                                 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             =
                                          
                                          
                                             Bool
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       ∧
                                       B
                                       
                                          
                                             =
                                          
                                          
                                             Bool
                                          
                                       
                                       I
                                       
                                          
                                             <
                                          
                                          
                                             Int
                                          
                                       
                                       0
                                       ∧
                                       I
                                       
                                          
                                             =
                                          
                                          
                                             Int
                                          
                                       
                                       
                                          
                                             I
                                          
                                          
                                             ′
                                          
                                       
                                       ∧
                                       C
                                       =
                                       C
                                       ″
                                       ∧
                                       
                                          
                                             C
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       C
                                       ″
                                       ,
                                    
                                 
                              and 
                                 ρ
                                 ⊨
                                 (
                                 ∃
                                 
                                    
                                       I
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 C
                                 ″
                                 )
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                              . Since σ just renames the variables of π, there exists 
                                 
                                    
                                       σ
                                    
                                    
                                       ′
                                    
                                 
                               such that 
                                 
                                    
                                       σ
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 π
                               and we have 
                                 π
                                 
                                    
                                       ⇒
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              , i.e.:
                                 
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   〈
                                                   
                                                      
                                                         〈
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         
                                                         
                                                            and
                                                         
                                                         
                                                         I
                                                         
                                                            
                                                               <
                                                            
                                                            
                                                               Int
                                                            
                                                         
                                                         0
                                                         ↷
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         〉
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   
                                                      
                                                         〈
                                                         M
                                                         〉
                                                      
                                                      
                                                         env
                                                      
                                                   
                                                   〉
                                                
                                                
                                                   cfg
                                                
                                             
                                             ∧
                                             C
                                             =
                                             
                                                
                                                   C
                                                
                                                
                                                   ′
                                                
                                             
                                             ]
                                          
                                          
                                             ~
                                          
                                       
                                       
                                          
                                             ⇒
                                          
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   s
                                                
                                             
                                          
                                          
                                             
                                                
                                                   M
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   〈
                                                   
                                                      
                                                         〈
                                                         B
                                                         ↷
                                                         C
                                                         〉
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   
                                                      
                                                         〈
                                                         M
                                                         〉
                                                      
                                                      
                                                         env
                                                      
                                                   
                                                   〉
                                                
                                                
                                                   cfg
                                                
                                             
                                             ∧
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   =
                                                
                                                
                                                   Bool
                                                
                                             
                                             true
                                             ∧
                                             B
                                             
                                                
                                                   =
                                                
                                                
                                                   Bool
                                                
                                             
                                             I
                                             
                                                
                                                   <
                                                
                                                
                                                   Int
                                                
                                             
                                             0
                                             ∧
                                             C
                                             =
                                             
                                                
                                                   C
                                                
                                                
                                                   ′
                                                
                                             
                                             ]
                                          
                                          
                                             ~
                                          
                                       
                                       .
                                    
                                 
                              
                           

Now we formulate the coverage result relating concrete and symbolic executions.
                           Corollary 7
                           Coverage


                           
                              Under the hypothesis of 
                              
                                 Corollary 6, for each concrete execution 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       ⇒
                                    
                                    
                                       S
                                    
                                    
                                 
                                 ⋯
                                 
                                    
                                       ⇒
                                    
                                    
                                       S
                                    
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ⇒
                                    
                                    
                                       S
                                    
                                    
                                 
                                 ⋯
                               
                              with 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       0
                                    
                                 
                                 ∈
                                 〚
                                 
                                    
                                       π
                                    
                                    
                                       0
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       0
                                    
                                 
                                 〛
                              , there is a symbolic execution 
                              
                                 
                                    
                                       [
                                       
                                          
                                             π
                                          
                                          
                                             0
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             0
                                          
                                       
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                                 
                                    
                                       ⇒
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 ⋯
                                 
                                    
                                       ⇒
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 
                                    
                                       [
                                       
                                          
                                             π
                                          
                                          
                                             i
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                       
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                                 
                                    
                                       ⇒
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 ⋯
                               
                              such that for all 
                              
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                              , 
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 〚
                                 
                                    
                                       π
                                    
                                    
                                       i
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 〛
                              .

By induction on i using Corollary 6.□

Note that a similar coverage result based on Theorem 5 (instead of its Corollary 6) does not hold, because the symbolic steps given by this theorem cannot be “connected” into a symbolic execution.

The coverage property is one of the two properties expected from symbolic execution. It relates concrete steps to symbolic ones. The second one, stated by the next result, relates “feasible” symbolic steps to concrete ones.
                           Theorem 8
                           One-step Precision


                           
                              If 
                              
                                 
                                    
                                       [
                                       π
                                       ∧
                                       ϕ
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                                 
                                    
                                       ⇒
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 
                                    
                                       [
                                       
                                          
                                             π
                                          
                                          
                                             ′
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             ′
                                          
                                       
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 〚
                                 
                                    
                                       π
                                    
                                    
                                       ′
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ′
                                    
                                 
                                 〛
                               
                              then there exists a configuration γ such that 
                              
                                 γ
                                 
                                    
                                       ⇒
                                    
                                    
                                       S
                                    
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                               
                              and 
                              
                                 γ
                                 ∈
                                 〚
                                 π
                                 ∧
                                 ϕ
                                 〛
                              .

Let 
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 ξ
                                 
                                    
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 ξ
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       s
                                    
                                 
                               and 
                                 
                                    
                                       ρ
                                    
                                    
                                       s
                                    
                                 
                                 :
                                 Var
                                 →
                                 
                                    
                                       M
                                    
                                    
                                       s
                                    
                                 
                               be such that 
                                 M
                                 ⊨
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 ↔
                                 (
                                 ∃
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                               (i), 
                                 
                                    
                                       ρ
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 ξ
                                 )
                                 =
                                 
                                    
                                       [
                                       π
                                       ∧
                                       ϕ
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                               and 
                                 
                                    
                                       ρ
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 ξ
                                 )
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             π
                                          
                                          
                                             ′
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             ′
                                          
                                       
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                              . Let 
                                 
                                    
                                       σ
                                    
                                    
                                       s
                                    
                                 
                               denote a substitution such that 
                                 
                                    
                                       σ
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 x
                                 )
                               for all variables 
                                 x
                                 ∈
                                 var
                                 (
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 .
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 )
                              , and 
                                 
                                    
                                       σ
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 ξ
                                 )
                                 =
                                 ϕ
                              . Then
                                 
                                    (ii)
                                    
                                       
                                          
                                             [
                                             π
                                             ∧
                                             ϕ
                                             ]
                                          
                                          
                                             ~
                                          
                                       
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   σ
                                                
                                                
                                                   s
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             ∧
                                             ξ
                                             )
                                             ]
                                          
                                          
                                             ~
                                          
                                       
                                       
                                       (
                                       the
                                       
                                       def
                                       .
                                       
                                       of
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             s
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   σ
                                                
                                                
                                                   s
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             ∧
                                             ϕ
                                             ]
                                          
                                          
                                             ~
                                          
                                       
                                       
                                       (
                                       the
                                       
                                       def
                                       .
                                       
                                       of
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             s
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             ∧
                                             ϕ
                                             ∧
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             ~
                                          
                                       
                                       
                                       (
                                       Lemma
                                       
                                       3
                                       )
                                    
                                 
                              and
                                 
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   π
                                                
                                                
                                                   ′
                                                
                                             
                                             ∧
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   ′
                                                
                                             
                                             ]
                                          
                                          
                                             ~
                                          
                                       
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   σ
                                                
                                                
                                                   s
                                                
                                             
                                             (
                                             
                                                
                                                   π
                                                
                                                
                                                   2
                                                
                                             
                                             ∧
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             ∧
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             ∧
                                             ξ
                                             )
                                             ]
                                          
                                          
                                             ~
                                          
                                       
                                       
                                       (
                                       the
                                       
                                       def
                                       .
                                       
                                       of
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             s
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   σ
                                                
                                                
                                                   s
                                                
                                             
                                             (
                                             
                                                
                                                   π
                                                
                                                
                                                   2
                                                
                                             
                                             ∧
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             ∧
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             ∧
                                             ϕ
                                             ]
                                          
                                          
                                             ~
                                          
                                       
                                       
                                       (
                                       the
                                       
                                       def
                                       .
                                       
                                       of
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             s
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   π
                                                
                                                
                                                   2
                                                
                                             
                                             ∧
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             ∧
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             ∧
                                             ϕ
                                             ∧
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             ~
                                          
                                       
                                       
                                       (
                                       Lemma
                                       
                                       3
                                       )
                                       .
                                    
                                 
                              From 
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 〚
                                 
                                    
                                       π
                                    
                                    
                                       ′
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ′
                                    
                                 
                                 〛
                               and the above equalities we deduce that there are 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                               and 
                                 ρ
                                 ″
                               such that 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 ρ
                                 ″
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                              , 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 ⊨
                                 
                                    
                                       ϕ
                                    
                                    
                                       ′
                                    
                                 
                              , and 
                                 ρ
                                 ″
                                 ⊨
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 ϕ
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                              . Since 
                                 var
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ∩
                                 var
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 ∅
                               by Assumption 3, there exists ρ such that 
                                 ρ
                                 
                                    
                                       |
                                    
                                    
                                       var
                                       (
                                       
                                          
                                             π
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             ϕ
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                              , 
                                 ρ
                                 
                                    
                                       |
                                    
                                    
                                       var
                                       (
                                       
                                          
                                             π
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             ϕ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                                 =
                                 ρ
                                 ″
                              , and hence 
                                 (
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 ρ
                                 )
                                 ⊨
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       π
                                    
                                    
                                       ′
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ′
                                    
                                 
                              . It follows that 
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                               and 
                                 
                                    
                                       π
                                    
                                    
                                       ′
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ′
                                    
                                 
                               are ρ-unifiable and hence there is a symbolic unifier 
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                               of 
                                 
                                    
                                       [
                                       
                                          
                                             π
                                          
                                          
                                             2
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                               and 
                                 
                                    
                                       [
                                       
                                          
                                             π
                                          
                                          
                                             ′
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             ′
                                          
                                       
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                               by Assumption 2, where 
                                 σ
                                 ∈
                                 
                                    
                                       unif
                                    
                                    
                                       ≅
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       ˜
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              . We also have 
                                 ρ
                                 ⊨
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                               by Assumption 2 and hence 
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 〚
                                 
                                    
                                       π
                                    
                                    
                                       ′
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ′
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                                 〛
                              .

Let 
                                 γ
                                 ≜
                                 ρ
                                 (
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                              . We also have 
                                 var
                                 (
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ∩
                                 var
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 ∅
                               by Assumption 3, and therefore we may assume w.l.o.g. that 
                                 ρ
                                 
                                    
                                       |
                                    
                                    
                                       var
                                       (
                                       
                                          
                                             
                                                
                                                   π
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                 
                                 =
                                 ρ
                                 ″
                              , and hence 
                                 (
                                 γ
                                 ,
                                 ρ
                                 )
                                 ⊨
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                              . It follows that 
                                 (
                                 γ
                                 ,
                                 ρ
                                 )
                                 ⊨
                                 (
                                 ∃
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                              , which implies 
                                 (
                                 γ
                                 ,
                                 ρ
                                 )
                                 ⊨
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                               thanks to the equivalence (i). We have already obtained 
                                 (
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 ρ
                                 )
                                 ⊨
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                              , thus, we have the theorem׳s first conclusion: 
                                 γ
                                 
                                    
                                       ⇒
                                    
                                    
                                       S
                                    
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                              .

There remains to prove the second conclusion: 
                                 γ
                                 ∈
                                 〚
                                 π
                                 ∧
                                 ϕ
                                 〛
                              . Since 
                                 ρ
                                 
                                    
                                       |
                                    
                                    
                                       var
                                       (
                                       
                                          
                                             
                                                
                                                   π
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                 
                                 =
                                 ρ
                                 ″
                               it follows that 
                                 γ
                                 =
                                 ρ
                                 ″
                                 (
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                              . We have 
                                 ρ
                                 ″
                                 ⊨
                                 ϕ
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                               by the definition of 
                                 ρ
                                 ″
                              , hence 
                                 γ
                                 ∈
                                 〚
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 ϕ
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 〛
                               that is equal to 
                                 〚
                                 π
                                 ∧
                                 ϕ
                                 〛
                               by (ii), which proves the theorem׳s second conclusion.□

We may now formulate the precision result which follows from Theorem 8:
                           Corollary 9
                           Precision


                           
                              For every feasible symbolic execution 
                              
                                 
                                    
                                       [
                                       
                                          
                                             π
                                          
                                          
                                             0
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             0
                                          
                                       
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                                 
                                    
                                       ⇒
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 ⋯
                                 
                                    
                                       ⇒
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 
                                    
                                       [
                                       
                                          
                                             π
                                          
                                          
                                             i
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                       
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                                 
                                    
                                       ⇒
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 ⋯
                               
                              there is a concrete execution 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       ⇒
                                    
                                    
                                       S
                                    
                                    
                                 
                                 ⋯
                                 
                                    
                                       ⇒
                                    
                                    
                                       S
                                    
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ⇒
                                    
                                    
                                       S
                                    
                                    
                                 
                                 ⋯
                               
                              such that 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 〚
                                 
                                    
                                       π
                                    
                                    
                                       i
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 〛
                               
                              for all 
                              
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                               .

By induction, using Theorem 8.□

Remember that coverage and precision have practical consequences: they ensure that results of analyses performed by symbolically executing programs (reachability analysis, model checking, etc.) also hold for their concrete executions, which are, of course, the executions that one is actually interested in.

In this section we address some of the issues left open in Sections 4 and 5, in order to ensure a smooth transition between our theoretical language-transformation approach and its implementation given in Section 7. The issues are:
                        
                           1.
                           how to obtain a set of symbolic rules 
                                 
                                    
                                       S
                                    
                                    
                                       s
                                    
                                 
                               with same cardinality as 
                                 S
                               (i.e., typically, 
                                 S
                               is finite, but the theoretical construction given in Section 5 will generate an infinite 
                                 
                                    
                                       S
                                    
                                    
                                       s
                                    
                                 
                              , which is impossible to use in practice);

how to satisfy Assumption 2 (required by the Theorem 5);

how to obtain unification by matching (required by Corollary 6).

We first show in Section 6.1 how to solve the first of the above-listed issues. Then, we present two instances of the current theoretical framework, and show how we address the two remaining issues from our list:
                        
                           •
                           the first instance, presented in Section 6.2, coincides with that presented in the earlier paper [2];

the second instance, presented in Section 6.3, is an extension of the previous one. It allows one to use axiomatically defined structures (sets, bags, lists, etc.), with axioms such as associativity, commutativity, unity and combinations thereof. Such structures are intensively used in actual language definitions, such as those defined in the 
                                 K
                               framework.

The set of symbolic rules 
                           
                              
                                 S
                              
                              
                                 s
                              
                           
                        , defined in Section 5.3 is typically infinite, because of the infinitely many abstractions 
                           (
                           ∃
                           X
                           )
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                           ∧
                           
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                         of the left-hand sides 
                           
                              
                                 π
                              
                              
                                 1
                              
                           
                           ∧
                           
                              
                                 ϕ
                              
                              
                                 1
                              
                           
                         of rules in 
                           S
                        . The algorithm presented below, which we call LDA (for Linearisation and Data Abstraction) produces a unique abstraction for any pattern (and thus, a one-to-one correspondence between 
                           S
                         and 
                           
                              
                                 S
                              
                              
                                 s
                              
                           
                        ).

We present the LDA algorithm and illustrate it by examples.

1. Linearising basic patterns: Recall that a term is linear if any variable occurs at most once in its left-hand side. A pattern 
                           π
                           ∧
                           ϕ
                         is linear if π is linear. A nonlinear pattern can always be turned into an equivalent linear one, by renaming the variables occurring several times in π and adding the equalities between the renamed variables and the original ones to the condition ϕ.

For example, 
                           
                              
                                 
                                    
                                       〈
                                       
                                          
                                             〈
                                             X
                                             〉
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〈
                                             X
                                             ↦
                                             I
                                             〉
                                          
                                          
                                             env
                                          
                                       
                                       〉
                                    
                                    
                                       cfg
                                    
                                 
                                 ∧
                                 ⊤
                              
                           
                        is transformed into 
                           
                              
                                 
                                    
                                       〈
                                       
                                          
                                             〈
                                             X
                                             〉
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〈
                                             
                                                
                                                   X
                                                
                                                
                                                   ′
                                                
                                             
                                             ↦
                                             I
                                             〉
                                          
                                          
                                             env
                                          
                                       
                                       〉
                                    
                                    
                                       cfg
                                    
                                 
                                 ∧
                                 ⊤
                                 ∧
                                 X
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                              
                           
                        where we assumed that 
                           X
                           ↦
                           I
                         is not a data term.

2. Data abstraction: Let 
                           Dpos
                           (
                           t
                           )
                         be the set of positions p
                        
                           2
                        
                        
                           2
                           For the notion of position in a term and other rewriting-related notions, see, e.g., [5]. 
                                 t
                                 
                                    
                                       |
                                    
                                    
                                       p
                                    
                                 
                               denotes the subterm of t at position p.
                         of the term t such that 
                           t
                           
                              
                                 |
                              
                              
                                 p
                              
                           
                         is a maximal subterm of a data sort. The next step of our pattern transformation consists in replacing all the maximal data subterms 
                           π
                           
                              
                                 |
                              
                              
                                 p
                              
                           
                         of π by fresh variables x
                        
                           p
                         and adding the equalities between the fresh variables and the corresponding subterms to the condition ϕ. Formally, 
                           π
                           ∧
                           ϕ
                         is transformed into 
                           π
                           
                              
                                 [
                                 
                                    
                                       x
                                    
                                    
                                       p
                                    
                                 
                                 /
                                 π
                                 
                                    
                                       |
                                    
                                    
                                       p
                                    
                                 
                                 ]
                              
                              
                                 p
                                 ∈
                                 Dpos
                                 (
                                 π
                                 )
                              
                           
                           ∧
                           ϕ
                           ∧
                           
                              
                                 ⋀
                              
                              
                                 p
                                 ∈
                                 Dpos
                                 (
                                 π
                                 )
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 p
                              
                           
                           =
                           π
                           
                              
                                 |
                              
                              
                                 p
                              
                           
                           )
                           )
                        . For instance, the pattern 
                           
                              
                                 
                                    
                                       〈
                                       
                                          
                                             〈
                                             
                                                if
                                             
                                             
                                             true
                                             
                                             
                                                then
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   1
                                                
                                             
                                             
                                             
                                                else
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                             
                                             〉
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〈
                                             M
                                             〉
                                          
                                          
                                             env
                                          
                                       
                                       〉
                                    
                                    
                                       cfg
                                    
                                 
                                 ∧
                                 ⊤
                              
                           
                        is transformed into 
                           
                              
                                 
                                    
                                       〈
                                       
                                          
                                             〈
                                             
                                                if
                                             
                                             
                                             B
                                             
                                             
                                                then
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   1
                                                
                                             
                                             
                                             
                                                else
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                             
                                             〉
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〈
                                             M
                                             〉
                                          
                                          
                                             env
                                          
                                       
                                       〉
                                    
                                    
                                       cfg
                                    
                                 
                                 ∧
                                 ⊤
                                 ∧
                                 B
                                 =
                                 true
                                 .
                              
                           
                        
                     

The above transformations describe an algorithm that builds a unique (up to a renaming of the new added variables) abstraction 
                           (
                           ∃
                           X
                           )
                           
                              
                                 π
                              
                              
                                 ˜
                              
                           
                           ∧
                           
                              
                                 ϕ
                              
                              
                                 ˜
                              
                           
                         for a given pattern 
                           π
                           ∧
                           ϕ
                        . Moreover, 
                           
                              
                                 ϕ
                              
                              
                                 ˜
                              
                           
                         is of the form 
                           ϕ
                           ∧
                           
                              
                                 ϕ
                              
                              
                                 σ
                              
                           
                         for a substitution σ that sends each fresh variable 
                           
                              
                                 x
                              
                              
                                 ′
                              
                           
                         into either a variable 
                           x
                           ∈
                           var
                           (
                           π
                           )
                         (due to the linearisation) or a data subterm π
                        
                           p
                         (due to the data abstraction).

We hereafter assume that all rules in 
                           S
                         are transformed such that their left-hand sides are abstractions computed by LDA.
                           Example 11
                           The last rule from the original imp semantics (Fig. 3) could have been written as a nonlinear rule: 
                                 
                                    
                                       
                                          
                                             〈
                                             
                                                
                                                   〈
                                                   X
                                                   ⋯
                                                   〉
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   〈
                                                   X
                                                   ↦
                                                   I
                                                   ⋯
                                                   〉
                                                
                                                
                                                   env
                                                
                                             
                                             ⋯
                                             〉
                                          
                                          
                                             cfg
                                          
                                       
                                       
                                       
                                          
                                             
                                          
                                       
                                       
                                          
                                             〈
                                             
                                                
                                                   〈
                                                   I
                                                   ⋯
                                                   〉
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   〈
                                                   X
                                                   ↦
                                                   I
                                                   ⋯
                                                   〉
                                                
                                                
                                                   env
                                                
                                             
                                             ⋯
                                             〉
                                          
                                          
                                             cfg
                                          
                                       
                                    
                                 
                              in which case it would have been transformed into 
                                 
                                    
                                       
                                          
                                             〈
                                             
                                                
                                                   〈
                                                   X
                                                   ⋯
                                                   〉
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   〈
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ↦
                                                   I
                                                   ⋯
                                                   〉
                                                
                                                
                                                   env
                                                
                                             
                                             ⋯
                                             〉
                                          
                                          
                                             cfg
                                          
                                       
                                       
                                          
                                             
                                          
                                       
                                       X
                                       =
                                       
                                          
                                             X
                                          
                                          
                                             ′
                                          
                                       
                                       
                                       
                                          
                                             
                                          
                                       
                                       
                                          
                                             〈
                                             
                                                
                                                   〈
                                                   I
                                                   ⋯
                                                   〉
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   〈
                                                   X
                                                   ↦
                                                   I
                                                   ⋯
                                                   〉
                                                
                                                
                                                   env
                                                
                                             
                                             ⋯
                                             〉
                                          
                                          
                                             cfg
                                          
                                       
                                    
                                 
                              The following rule for if from the imp semantics: 
                                 
                                    
                                       
                                          
                                             〈
                                             
                                                
                                                   〈
                                                   
                                                      if
                                                   
                                                   
                                                   true
                                                   
                                                   
                                                      then
                                                   
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                   
                                                      else
                                                   
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ⋯
                                                   〉
                                                
                                                
                                                   k
                                                
                                             
                                             ⋯
                                             〉
                                          
                                          
                                             cfg
                                          
                                       
                                       
                                       
                                          
                                             
                                          
                                       
                                       
                                          
                                             〈
                                             
                                                
                                                   〈
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ⋯
                                                   〉
                                                
                                                
                                                   k
                                                
                                             
                                             ⋯
                                             〉
                                          
                                          
                                             cfg
                                          
                                       
                                    
                                 
                              is transformed into 
                                 
                                    
                                       
                                          
                                             〈
                                             
                                                
                                                   〈
                                                   
                                                      if
                                                   
                                                   
                                                   B
                                                   
                                                   
                                                      then
                                                   
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                   
                                                      else
                                                   
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ⋯
                                                   〉
                                                
                                                
                                                   k
                                                
                                             
                                             ⋯
                                             〉
                                          
                                          
                                             cfg
                                          
                                       
                                       ∧
                                       B
                                       =
                                       true
                                       
                                          
                                             
                                          
                                       
                                       
                                          
                                             〈
                                             
                                                
                                                   〈
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ⋯
                                                   〉
                                                
                                                
                                                   k
                                                
                                             
                                             ⋯
                                             〉
                                          
                                          
                                             cfg
                                          
                                       
                                       .
                                    
                                 
                              
                           

We still have to prove that the instances of our theoretical framework (presented in Sections 6.2 and 6.3 below) still satisfy coverage results (Theorem 5 and Corollary 6) when abstractions of patterns are computed by LDA instead of generating all possible abstractions. The proofs are given in the subsections below, since they depend on other results, which are specific to the particular instances. We note that precision (Theorem 8) is not affected by computing abstractions with LDA. Indeed, if all (feasible) symbolic executions generated by a larger set 
                           
                              
                                 S
                              
                              
                                 s
                              
                           
                         have corresponding concrete ones, then this also holds for a subset of those symbolic executions, generated by a smaller set 
                           
                              
                                 S
                              
                              
                                 s
                              
                           
                        .

The two instances differ with respect to their definition of the model M, which is a parameter of any language definition 
                           L
                           =
                           (
                           (
                           Σ
                           ,
                           Π
                           ,
                           Cfg
                           )
                           ,
                           M
                           ,
                           S
                           )
                        . Remember from Section 3 that we assumed a subsignature 
                           (
                           
                              
                                 Σ
                              
                              
                                 d
                              
                           
                           ,
                           
                              
                                 Π
                              
                              
                                 d
                              
                           
                           )
                         of 
                           (
                           Σ
                           ,
                           Π
                           )
                        , and a 
                           (
                           
                              
                                 Σ
                              
                              
                                 d
                              
                           
                           ,
                           
                              
                                 Φ
                              
                              
                                 d
                              
                           
                           )
                           -
                           model
                         
                        
                           D
                        , which interprets the data sorts, operations, and predicates.

For the first instance, the model M is defined as follows:
                           
                              •
                              for each item (sort, function/predicate symbol) 
                                    o
                                    ∈
                                    (
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                    
                                    ,
                                    
                                       
                                          Π
                                       
                                       
                                          d
                                       
                                    
                                    )
                                 , 
                                    
                                       
                                          M
                                       
                                       
                                          o
                                       
                                    
                                    =
                                    
                                       
                                          D
                                       
                                       
                                          o
                                       
                                    
                                 ;

for each sort s in 
                                    Σ
                                    ⧹
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                    
                                 , M
                                 
                                    s
                                  is the set of ground 
                                    (
                                    Σ
                                    ⧹
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                    
                                    )
                                    (
                                    D
                                    )
                                    -
                                    terms
                                 ;

for each function symbol f in 
                                    Σ
                                    ⧹
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                    
                                 , M
                                 
                                    f
                                  is the term constructor f such that for all 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 , 
                                    
                                       
                                          M
                                       
                                       
                                          f
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    =
                                    f
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          f
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    ,
                                    …
                                    ,
                                    
                                       
                                          M
                                       
                                       
                                          f
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    )
                                  (recall that the result sort of f does not belong to 
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                    
                                  by the hypotheses).

The ground term 
                                 
                                    
                                       〈
                                       
                                          
                                             〈
                                             y
                                             =
                                             x
                                             +
                                             3
                                             ;
                                             〉
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〈
                                             
                                                x
                                             
                                             ↦
                                             5
                                             
                                             y
                                             ↦
                                             0
                                             〉
                                          
                                          
                                             env
                                          
                                       
                                       〉
                                    
                                    
                                       cfg
                                    
                                 
                               is an element in 
                                 
                                    
                                       M
                                    
                                    
                                       Cfg
                                    
                                 
                              , while the ground term 
                                 
                                    
                                       〈
                                       
                                          
                                             〈
                                             
                                                y=x + 3
                                             
                                             〉
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〈
                                             
                                                x
                                             
                                             ↦
                                             1
                                             
                                                
                                                   +
                                                
                                                
                                                   Int
                                                
                                             
                                             2
                                             
                                             y
                                             ↦
                                             0
                                             〉
                                          
                                          
                                             env
                                          
                                       
                                       〉
                                    
                                    
                                       cfg
                                    
                                 
                               does not belong to 
                                 
                                    
                                       M
                                    
                                    
                                       Cfg
                                    
                                 
                               because it includes the non-constant data term 
                                 1
                                 
                                    
                                       +
                                    
                                    
                                       Int
                                    
                                 
                                 2
                              .

Even if the elements of M are terms, the valuations 
                           ρ
                           :
                           Var
                           →
                           M
                         are not, in general, substitutions because they involve expressions on data (e.g., 
                           1
                           
                              
                                 +
                              
                              
                                 Int
                              
                           
                           2
                         in Example 12). Therefore the valuations do not define unifiers directly.

The following result shows that Assumption 2 from Section 4 holds for this case. Moreover it ensures that Theorem 5 holds when computing abstractions with the LDA algorithm:
                           Lemma 10
                           Concrete unifiability implies symbolic unifiability


                           
                              Let 
                              
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                               
                              and 
                              
                                 π
                                 ∧
                                 ϕ
                               
                              be two patterns such that 
                              
                                 var
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ∩
                                 var
                                 (
                                 π
                                 ∧
                                 ϕ
                                 )
                                 =
                                 ∅
                              . If 
                              
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                               
                              and 
                              
                                 π
                                 ∧
                                 ϕ
                               
                              are concretely ρ-unifiable then the classes 
                              
                                 
                                    
                                       [
                                       
                                          
                                             π
                                          
                                          
                                             1
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             1
                                          
                                       
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       [
                                       π
                                       ∧
                                       ϕ
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                               
                              are symbolically ρ-unifiable, with a unifier 
                              
                                 ψ
                                 =
                                 (
                                 ∃
                                 X
                                 ∪
                                 
                                    
                                       X
                                    
                                    
                                       ′
                                    
                                 
                                 ∪
                                 var
                                 (
                                 ran
                                 (
                                 σ
                                 )
                                 )
                                 )
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                              , where 
                              
                                 σ
                                 ∈
                                 unif
                                 (
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                                 )
                              , 
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                              , and 
                              
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                               
                              are computed using the LDA algorithm.

Let ρ be a valuation such that 
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 π
                                 ∧
                                 ϕ
                               are concretely ρ-unifiable. There exists γ such that 
                                 (
                                 γ
                                 ,
                                 ρ
                                 )
                                 ⊨
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 π
                                 ∧
                                 ϕ
                              . Let 
                                 (
                                 ∃
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 (
                                 ∃
                                 X
                                 )
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                               the abstractions of 
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 π
                                 ∧
                                 ϕ
                              , respectively, computed with the algorithm LDA. There exists 
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                               such that 
                                 (
                                 γ
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 )
                                 ⊨
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                               and 
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 ρ
                                 (
                                 x
                                 )
                              , for all 
                                 x
                                 ∉
                                 X
                                 ∪
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                              . Let σ be the substitution defined by 
                                 σ
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 x
                                 )
                               for 
                                 x
                                 ∈
                                 var
                                 (
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                                 )
                              . Since 
                                 σ
                                 (
                                 x
                                 )
                                 ∈
                                 M
                               and by the particular form of 
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                               we have 
                                 σ
                                 (
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 σ
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                                 )
                              , a ground term in M. Hence σ is a unifier of 
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                               and we have 
                                 ρ
                                 ⊨
                                 (
                                 ∃
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 ∪
                                 X
                                 )
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                               because 
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 ⊨
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                              . Indeed, because 
                                 σ
                                 (
                                 x
                                 )
                               is a ground term, 
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 σ
                                 (
                                 x
                                 )
                                 )
                                 =
                                 σ
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 x
                                 )
                               because 
                                 var
                                 (
                                 ran
                                 (
                                 σ
                                 )
                                 )
                                 ∩
                                 (
                                 X
                                 ∪
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 ∅
                               by Assumption 3. Hence 
                                 ψ
                                 ≜
                                 (
                                 ∃
                                 X
                                 ∪
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                               is a symbolic ρ-unifier of 
                                 
                                    
                                       [
                                       
                                          
                                             π
                                          
                                          
                                             1
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             1
                                          
                                       
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                               and 
                                 
                                    
                                       [
                                       π
                                       ∧
                                       ϕ
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                               (note that 
                                 var
                                 (
                                 ran
                                 (
                                 σ
                                 )
                                 )
                                 =
                                 ∅
                               because σ is a ground substitution).□

Consider 
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             1
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             1
                                          
                                       
                                       ≜
                                       
                                          
                                             〈
                                             
                                                
                                                   〈
                                                   X
                                                   
                                                      +
                                                   
                                                   0
                                                   〉
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   〈
                                                   .
                                                   Map
                                                   〉
                                                
                                                
                                                   env
                                                
                                             
                                             〉
                                          
                                          
                                             cfg
                                          
                                       
                                       ∧
                                       ⊤
                                    
                                 
                              and 
                                 
                                    
                                       π
                                       ∧
                                       ϕ
                                       ≜
                                       
                                          
                                             〈
                                             
                                                
                                                   〈
                                                   2
                                                   
                                                      +
                                                   
                                                   b
                                                   
                                                      
                                                         +
                                                      
                                                      
                                                         Int
                                                      
                                                   
                                                   1
                                                   〉
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   〈
                                                   .
                                                   Map
                                                   〉
                                                
                                                
                                                   env
                                                
                                             
                                             〉
                                          
                                          
                                             cfg
                                          
                                       
                                       ∧
                                       ⊤
                                       .
                                    
                                 
                              (N.B.: the operation + is part of the imp syntax whereas 
                                 
                                    
                                       +
                                    
                                    
                                       Int
                                    
                                 
                               is addition in the integer data domain). First, note that 
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 π
                                 ∧
                                 ϕ
                               are concretely ρ-unifiable, with ρ satisfying 
                                 ρ
                                 (
                                 X
                                 )
                                 =
                                 2
                               and 
                                 ρ
                                 (
                                 b
                                 )
                                 =
                                 −
                                 1
                              . Second, there is 
                                 γ
                                 ≜
                                 
                                    
                                       〈
                                       
                                          
                                             〈
                                             2
                                             
                                                +
                                             
                                             0
                                             〉
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〈
                                             .
                                             Map
                                             〉
                                          
                                          
                                             env
                                          
                                       
                                       〉
                                    
                                    
                                       cfg
                                    
                                 
                               such that 
                                 (
                                 γ
                                 ,
                                 ρ
                                 )
                                 ⊨
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 (
                                 γ
                                 ,
                                 ρ
                                 )
                                 ⊨
                                 π
                                 ∧
                                 ϕ
                              , since 
                                 
                                    
                                       ρ
                                       (
                                       2
                                       
                                          +
                                       
                                       b
                                       
                                          
                                             +
                                          
                                          
                                             Int
                                          
                                       
                                       1
                                       )
                                       =
                                       2
                                       
                                          +
                                       
                                       
                                          
                                             D
                                          
                                          
                                             
                                                
                                                   +
                                                
                                                
                                                   Int
                                                
                                             
                                          
                                       
                                       (
                                       ρ
                                       (
                                       b
                                       )
                                       ,
                                       1
                                       )
                                       =
                                       2
                                       
                                          +
                                       
                                       
                                          
                                             D
                                          
                                          
                                             
                                                
                                                   +
                                                
                                                
                                                   Int
                                                
                                             
                                          
                                       
                                       (
                                       −
                                       1
                                       ,
                                       1
                                       )
                                       =
                                       2
                                       
                                          +
                                       
                                       0
                                       .
                                    
                                 
                              The abstractions of the two patterns computed as above are 
                                 
                                    
                                       (
                                       ∃
                                       
                                          
                                             X
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       
                                          
                                             
                                                
                                                   π
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ∧
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ≜
                                       (
                                       ∃
                                       I
                                       )
                                       
                                          
                                             〈
                                             
                                                
                                                   〈
                                                   X
                                                   +
                                                   I
                                                   〉
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   〈
                                                   .
                                                   Map
                                                   〉
                                                
                                                
                                                   env
                                                
                                             
                                             〉
                                          
                                          
                                             cfg
                                          
                                       
                                       ∧
                                       I
                                       
                                          
                                             =
                                          
                                          
                                             Int
                                          
                                       
                                       0
                                    
                                 
                              and 
                                 
                                    
                                       (
                                       ∃
                                       X
                                       )
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                       ≜
                                       (
                                       ∃
                                       A
                                       ,
                                       B
                                       )
                                       
                                          
                                             〈
                                             
                                                
                                                   〈
                                                   A
                                                   +
                                                   B
                                                   〉
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   〈
                                                   .
                                                   Map
                                                   〉
                                                
                                                
                                                   env
                                                
                                             
                                             〉
                                          
                                          
                                             cfg
                                          
                                       
                                       ∧
                                       A
                                       
                                          
                                             =
                                          
                                          
                                             Int
                                          
                                       
                                       2
                                       ∧
                                       B
                                       
                                          
                                             =
                                          
                                          
                                             Int
                                          
                                       
                                       b
                                       
                                          
                                             +
                                          
                                          
                                             Int
                                          
                                       
                                       1
                                       .
                                    
                                 
                              The valuation 
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                               is given by 
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 X
                                 )
                                 =
                                 ρ
                                 (
                                 X
                                 )
                                 =
                                 2
                              , 
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 b
                                 )
                                 =
                                 ρ
                                 (
                                 b
                                 )
                                 =
                                 −
                                 1
                              , 
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 I
                                 )
                                 =
                                 ρ
                                 (
                                 0
                                 )
                                 =
                                 0
                              , 
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 A
                                 )
                                 =
                                 ρ
                                 (
                                 2
                                 )
                                 =
                                 2
                              , 
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 B
                                 )
                                 =
                                 ρ
                                 (
                                 b
                                 
                                    
                                       +
                                    
                                    
                                       Int
                                    
                                 
                                 1
                                 )
                                 =
                                 0
                              .

Let σ be the substitution given by 
                                 σ
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 x
                                 )
                              , for all 
                                 x
                                 ∈
                                 var
                                 (
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                                 )
                              , i.e., 
                                 σ
                                 (
                                 X
                                 )
                                 =
                                 2
                                 ,
                                 σ
                                 (
                                 I
                                 )
                                 =
                                 0
                                 ,
                                 σ
                                 (
                                 A
                                 )
                                 =
                                 2
                                 ,
                                 σ
                                 (
                                 B
                                 )
                                 =
                                 0
                              . Then σ is a syntactic unifier of 
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                              : 
                                 σ
                                 (
                                 X
                                 
                                    +
                                 
                                 I
                                 )
                                 =
                                 σ
                                 (
                                 A
                                 
                                    +
                                 
                                 B
                                 )
                                 =
                                 2
                                 
                                    +
                                 
                                 0
                              . We obviously have 
                                 ρ
                                 ⊨
                                 (
                                 ∃
                                 I
                                 ,
                                 A
                                 ,
                                 B
                                 )
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                              , where 
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                               is 
                                 X
                                 
                                    
                                       =
                                    
                                    
                                       Int
                                    
                                 
                                 2
                                 ∧
                                 I
                                 
                                    
                                       =
                                    
                                    
                                       Int
                                    
                                 
                                 0
                                 ∧
                                 A
                                 
                                    
                                       =
                                    
                                    
                                       Int
                                    
                                 
                                 2
                                 ∧
                                 B
                                 
                                    
                                       =
                                    
                                    
                                       Int
                                    
                                 
                                 0
                              .

In the proof of Theorem 5 we consider a symbolic unifier ψ whose existence is given by Assumption 2. Lemma 10 is a stronger version of Assumption 2: the unifier ψ is computed using the LDA algorithm. In order to prove that Theorem 5 still holds it is enough to choose, in its proof, 
                           ψ
                           =
                           (
                           ∃
                           X
                           ∪
                           
                              
                                 X
                              
                              
                                 ′
                              
                           
                           ∪
                           var
                           (
                           ran
                           (
                           σ
                           )
                           )
                           )
                           
                              
                                 ϕ
                              
                              
                                 σ
                              
                           
                           ∧
                           
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                           ∧
                           
                              
                                 ϕ
                              
                              
                                 ˜
                              
                           
                        , where 
                           σ
                           ∈
                           unif
                           (
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 π
                              
                              
                                 ˜
                              
                           
                           )
                        , 
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                           ∧
                           
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                        , and 
                           
                              
                                 π
                              
                              
                                 ˜
                              
                           
                           ∧
                           
                              
                                 ϕ
                              
                              
                                 ˜
                              
                           
                         are computed using the LDA algorithm.

We still have to show that Corollary 6 holds for this instance. For this, we show that its hypothesis is satisfied, i.e., we have to reduce unification in M to matching. This result is proved in a more general setting by Lemma 14 in the subsection below (we take the set A of axioms to be the empty set).

This concludes the description of this instance of our language-transformation approach. This instance is isomorphic with the earlier approach [2].

Language definitions in the 
                           K
                         framework often use structures such as bags and sets in configurations. In order to symbolically execute programs in such languages, one needs to solve constraints involving bags, sets, etc. One possibility is to consider those structures as data, and to deal with the constraints involving them by SMT solving. But this is a poor solution in practice because SMT solvers have limited support for constraints over bags and sets. Hence, some structures involved in language definitions must be defined axiomatically.

Thus, we assume given a set A of structural axioms (e.g., associativity, and/or commutativity, and/or identity) for certain non-data functional symbols and for which there exists a matching algorithm modulo A that produces a finite number of A-matching solutions, whenever such solutions exist. The model M is 
                           D
                           
                              
                                 ↿
                              
                              
                                 (
                                 Σ
                                 ,
                                 Π
                                 )
                              
                           
                           /
                           A
                        . Let 
                           
                              
                                 [
                                 t
                                 ]
                              
                              
                                 A
                              
                           
                           ∈
                           M
                         denote the A-equivalence class including t.

The following lemma generalises Lemma 10 from Section 6.2.
                           Lemma 11
                           Concrete unifiability implies symbolic unifiability


                           
                              Let 
                              
                                 
                                    
                                       φ
                                    
                                    
                                       1
                                    
                                 
                                 ≜
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                               
                              and 
                              
                                 φ
                                 ≜
                                 π
                                 ∧
                                 ϕ
                               
                              be two patterns such that 
                              
                                 var
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ∩
                                 var
                                 (
                                 π
                                 ∧
                                 ϕ
                                 )
                                 =
                                 ∅
                              . If φ
                              1 
                              and φ are concretely ρ-unifiable (N.B. in M) then there exists a symbolic ρ-unifier ψ of 
                              
                                 
                                    
                                       [
                                       
                                          
                                             φ
                                          
                                          
                                             1
                                          
                                       
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       [
                                       φ
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                              , where ψ is computed using the algorithm LDA.

We use the same notations as in the proof of Lemma 10. Note that there are γ such that 
                                 (
                                 γ
                                 ,
                                 ρ
                                 )
                                 ⊨
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 π
                                 ∧
                                 ϕ
                               and 
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                               such that 
                                 (
                                 γ
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 )
                                 ⊨
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                               and 
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 ρ
                                 (
                                 x
                                 )
                              , for all 
                                 x
                                 ∉
                                 X
                                 ∪
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                               (where 
                                 (
                                 ∃
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 (
                                 ∃
                                 X
                                 )
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                               are the abstractions of φ
                              1 and φ computed using LDA).

Since the elements in M are equivalence classes, the substitution σ is defined by 
                                 σ
                                 (
                                 x
                                 )
                                 ∈
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 x
                                 )
                               for 
                                 x
                                 ∈
                                 var
                                 (
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                                 )
                              . We have 
                                 
                                    
                                       [
                                       σ
                                       (
                                       
                                          
                                             
                                                
                                                   π
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       ]
                                    
                                    
                                       A
                                    
                                 
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       [
                                       σ
                                       (
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                       )
                                       ]
                                    
                                    
                                       A
                                    
                                 
                              , which implies 
                                 σ
                                 (
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       =
                                    
                                    
                                       A
                                    
                                 
                                 σ
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                                 )
                              . Hence σ is a 
                                 
                                    
                                       =
                                    
                                    
                                       A
                                    
                                 
                                 -
                                 unifier
                               of 
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                              . We prove now that 
                                 ρ
                                 ⊨
                                 (
                                 ∃
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 ∪
                                 X
                                 )
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                                 )
                              . Since we already have 
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 ⊨
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 ⊨
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                              , it is enough to prove that 
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 ⊨
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                              . We have 
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 σ
                                 (
                                 x
                                 )
                                 )
                                 =
                                 
                                    
                                       [
                                       σ
                                       (
                                       x
                                       )
                                       ]
                                    
                                    
                                       A
                                    
                                 
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 x
                                 )
                               because 
                                 var
                                 (
                                 ran
                                 (
                                 σ
                                 )
                                 )
                                 ∩
                                 (
                                 X
                                 ∪
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 ∅
                               by Assumption 3. Hence 
                                 ψ
                                 ≜
                                 (
                                 ∃
                                 X
                                 ∪
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       ˜
                                    
                                 
                                 ∧
                                 
                                    
                                       ϕ
                                    
                                    
                                       σ
                                    
                                 
                               is a symbolic ρ-unifier of 
                                 
                                    
                                       [
                                       
                                          
                                             π
                                          
                                          
                                             1
                                          
                                       
                                       ∧
                                       
                                          
                                             ϕ
                                          
                                          
                                             1
                                          
                                       
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                               and 
                                 
                                    
                                       [
                                       π
                                       ∧
                                       ϕ
                                       ]
                                    
                                    
                                       ~
                                    
                                 
                              .□

Thus, Theorem 5 holds with the same argument employed in Section 6.2.

The last step is to prove that the conditions of Corollary 6 hold; that is, to reduce unification in M to matching. We hereafter assume that the axioms A are linear, regular, and data collapse-free; these requirements are usual for rewrite theories and all the above-mentioned axioms satisfy them. A term t is linear iff any variable occurs in t at most once, an u=v is regular iff 
                           var
                           (
                           u
                           )
                           =
                           var
                           (
                           v
                           )
                         and it is linear if both sides u and v are linear. An axiom u=v is data collapse-free iff it does not collapse a non-data term into a data term; formally, for any substitution σ neither 
                           σ
                           (
                           u
                           )
                         nor 
                           σ
                           (
                           v
                           )
                         is a variable of data sort. The next sequence of lemmas leads to the proof that unification in M reduces to matching.

In the following lemma we assume that 
                           
                              
                                 t
                              
                              
                                 ˜
                              
                           
                         is obtained from the term t using the algorithm LDA, but forgetting the condition part.
                           Lemma 12
                           
                              Let t, 
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       Σ
                                    
                                 
                              . If 
                              
                                 t
                                 
                                    
                                       =
                                    
                                    
                                       A
                                    
                                 
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                               
                              then 
                              
                                 
                                    
                                       t
                                    
                                    
                                       ˜
                                    
                                 
                                 
                                    
                                       =
                                    
                                    
                                       A
                                    
                                 
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                              .

The congruence 
                                 
                                    
                                       =
                                    
                                    
                                       A
                                    
                                 
                               is the smallest equivalence relation that include (i) 
                                 σ
                                 (
                                 u
                                 )
                                 
                                    
                                       =
                                    
                                    
                                       A
                                    
                                 
                                 σ
                                 (
                                 v
                                 )
                               for each axiom u=v in A and ground substitution σ, and (ii) 
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       [
                                       
                                          
                                             t
                                          
                                          
                                             1
                                          
                                       
                                       ]
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       =
                                    
                                    
                                       A
                                    
                                 
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       [
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                    
                                    
                                       p
                                    
                                 
                               whenever 
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       =
                                    
                                    
                                       A
                                    
                                 
                                 
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                              .

We proceed by well-founded induction. We distinguish two cases:
                                 
                                    1.
                                    
                                       
                                          t
                                          =
                                          σ
                                          (
                                          u
                                          )
                                        and 
                                          
                                             
                                                t
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          σ
                                          (
                                          v
                                          )
                                        for certain u=v in A. Let 
                                          
                                             
                                                σ
                                             
                                             
                                                ˜
                                             
                                          
                                        the substitution defined by 
                                          
                                             
                                                σ
                                             
                                             
                                                ˜
                                             
                                          
                                          (
                                          x
                                          )
                                          =
                                          
                                             
                                                σ
                                                (
                                                x
                                                )
                                             
                                             
                                                ˜
                                             
                                          
                                        for all 
                                          x
                                          ∈
                                          var
                                          (
                                          u
                                          )
                                          =
                                          var
                                          (
                                          v
                                          )
                                        (we have 
                                          var
                                          (
                                          u
                                          )
                                          =
                                          var
                                          (
                                          v
                                          )
                                        because u=v is regular). Since u and v include only non-data functional symbols (u=v is regular and data collapse-free) and are linear, we obtain 
                                          
                                             
                                                σ
                                                (
                                                u
                                                )
                                             
                                             
                                                ˜
                                             
                                          
                                          =
                                          
                                             
                                                σ
                                             
                                             
                                                ˜
                                             
                                          
                                          (
                                          u
                                          )
                                        and 
                                          
                                             
                                                σ
                                                (
                                                v
                                                )
                                             
                                             
                                                ˜
                                             
                                          
                                          =
                                          
                                             
                                                σ
                                             
                                             
                                                ˜
                                             
                                          
                                          (
                                          v
                                          )
                                       . From (i) we have 
                                          
                                             
                                                σ
                                             
                                             
                                                ˜
                                             
                                          
                                          (
                                          u
                                          )
                                          
                                             
                                                =
                                             
                                             
                                                A
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                ˜
                                             
                                          
                                          (
                                          v
                                          )
                                       , which implies 
                                          
                                             
                                                σ
                                                (
                                                u
                                                )
                                             
                                             
                                                ˜
                                             
                                          
                                          
                                             
                                                =
                                             
                                             
                                                A
                                             
                                          
                                          
                                             
                                                σ
                                                (
                                                v
                                                )
                                             
                                             
                                                ˜
                                             
                                          
                                       .


                                       
                                          t
                                          =
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                [
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ]
                                             
                                             
                                                p
                                             
                                          
                                        and 
                                          
                                             
                                                t
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                [
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ]
                                             
                                             
                                                p
                                             
                                          
                                        for certain t
                                       0, 
                                          
                                             
                                                t
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                =
                                             
                                             
                                                A
                                             
                                          
                                          
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                       , and position p in t
                                       0. We have 
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                =
                                             
                                             
                                                A
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                        by the induction hypothesis. Since 
                                          
                                             
                                                t
                                             
                                             
                                                ˜
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ]
                                             
                                             
                                                p
                                             
                                          
                                        and 
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ]
                                             
                                             
                                                p
                                             
                                          
                                        we obtain 
                                          
                                             
                                                t
                                             
                                             
                                                ˜
                                             
                                          
                                          
                                             
                                                =
                                             
                                             
                                                A
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                ′
                                             
                                          
                                        using the definition of 
                                          
                                             
                                                =
                                             
                                             
                                                A
                                             
                                          
                                       .□


                              Let t be a linear term whose all data subterms are variables and these are the only variables occurring in t (hence 
                              
                                 
                                    
                                       t
                                    
                                    
                                       ˜
                                    
                                 
                                 =
                                 t
                              ). If σ is a ground substitution then there exists a variable renaming η such that 
                              
                                 η
                                 (
                                 
                                    
                                       σ
                                       (
                                       t
                                       )
                                    
                                    
                                       ˜
                                    
                                 
                                 )
                                 =
                                 t
                              .

The set 
                                 dom
                                 (
                                 σ
                                 )
                               includes only data variables by the hypotheses of the lemma. We proceed by structural induction on t.
                                 
                                    1.
                                    
                                       t is a variable. Then t has a data sort and 
                                          
                                             
                                                σ
                                                (
                                                t
                                                )
                                             
                                             
                                                ˜
                                             
                                          
                                        is a variable as well. Thus, we consider η such that 
                                          η
                                          (
                                          
                                             
                                                σ
                                                (
                                                t
                                                )
                                             
                                             
                                                ˜
                                             
                                          
                                          )
                                          =
                                          t
                                       .


                                       
                                          t
                                          =
                                          f
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                n
                                             
                                          
                                          )
                                       , 
                                          n
                                          ≥
                                          0
                                       . Then f is a non-data functional symbol 
                                          
                                             
                                                σ
                                                (
                                                t
                                                )
                                             
                                             
                                                ˜
                                             
                                          
                                          =
                                          f
                                          (
                                          
                                             
                                                σ
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                ˜
                                             
                                          
                                          ,
                                          …
                                          
                                             
                                                σ
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      n
                                                   
                                                
                                                )
                                             
                                             
                                                ˜
                                             
                                          
                                          )
                                       . From the inductive hypothesis, there are the variable renamings 
                                          
                                             
                                                η
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                η
                                             
                                             
                                                n
                                             
                                          
                                        such that 
                                          
                                             
                                                η
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          
                                             
                                                σ
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             
                                                ˜
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                t
                                             
                                             
                                                i
                                             
                                          
                                       , 
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                       . Since t is linear, it follows that the substitution η, given by 
                                          η
                                          (
                                          x
                                          )
                                          =
                                          
                                             
                                                η
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          x
                                          )
                                        iff 
                                          x
                                          ∈
                                          var
                                          (
                                          
                                             
                                                σ
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                ˜
                                             
                                          
                                        for some 
                                          1
                                          ≤
                                          i
                                          ≤
                                          n
                                        is a variable renaming as well. We have 
                                          η
                                          (
                                          
                                             
                                                σ
                                                (
                                                t
                                                )
                                             
                                             
                                                ˜
                                             
                                          
                                          )
                                          =
                                          f
                                          (
                                          
                                             
                                                η
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                σ
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                ˜
                                             
                                          
                                          )
                                          ,
                                          …
                                          
                                             
                                                η
                                             
                                             
                                                n
                                             
                                          
                                          (
                                          
                                             
                                                σ
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      n
                                                   
                                                
                                                )
                                             
                                             
                                                ˜
                                             
                                          
                                          )
                                          )
                                          =
                                          f
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                n
                                             
                                          
                                          )
                                          =
                                          t
                                       .

The proof by induction is finished and the lemma is proved.□

Finally, we show that, under certain conditions, the unification (in M) reduces to matching:
                           Lemma 14
                           Unification by matching


                           
                              Let π
                              1 
                              be a linear basic pattern whose data subterms are all variables (and hence 
                              
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                              ) and π a linear basic pattern whose all variables are of data sort and whose all data subterms are variables (and hence 
                              
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                                 =
                                 π
                              ). We further assume that 
                              
                                 var
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ∩
                                 var
                                 (
                                 π
                                 )
                                 =
                                 ∅
                              . If σ is a 
                              
                                 
                                    
                                       =
                                    
                                    
                                       A
                                    
                                 
                                 -
                                 unifier
                              , i.e. σ is a ground substitution satisfying 
                              
                                 σ
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       =
                                    
                                    
                                       A
                                    
                                 
                                 σ
                                 (
                                 π
                                 )
                              , then there exists a variable renaming η such that 
                              
                                 η
                                 (
                                 σ
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 )
                                 
                                    
                                       =
                                    
                                    
                                       A
                                    
                                 
                                 π
                              .

We have 
                                 
                                    
                                       σ
                                       (
                                       
                                          
                                             π
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       ˜
                                    
                                 
                                 
                                    
                                       =
                                    
                                    
                                       A
                                    
                                 
                                 
                                    
                                       σ
                                       (
                                       π
                                       )
                                    
                                    
                                       ˜
                                    
                                 
                               by Lemma 12 and 
                                 η
                                 (
                                 
                                    
                                       σ
                                       (
                                       π
                                       )
                                    
                                    
                                       ˜
                                    
                                 
                                 )
                                 =
                                 π
                               by Lemma 13.□

Since every 
                           
                              
                                 =
                              
                              
                                 A
                              
                           
                           -
                           unifier
                         
                        σ is a 
                           
                              
                                 =
                              
                              
                                 A
                              
                           
                           -
                           matching
                        , it follows that Corollary 6 (Coverage) holds. If there exists a matching algorithm modulo A that produces a finite number of A-matching solutions, we obtain that a left-hand side of a rule 
                           
                              
                                 π
                              
                              
                                 1
                              
                           
                           ∧
                           
                              
                                 ϕ
                              
                              
                                 1
                              
                           
                         and symbolic configuration 
                           π
                           ∧
                           ϕ
                         are ρ-unifiable iff there exists a matching solution σ such that 
                           ρ
                           (
                           x
                           )
                           =
                           
                              
                                 [
                                 σ
                                 (
                                 x
                                 )
                                 ]
                              
                              
                                 A
                              
                           
                         and 
                           
                              
                                 σ
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              
                                 ˜
                              
                           
                           
                              
                                 =
                              
                              
                                 A
                              
                           
                           
                              
                                 π
                              
                              
                                 ˜
                              
                           
                        .

There are several similarities between our approach in that given in [27]: their built in theory is equivalent to the specification of data, constrained terms are patterns 
                           π
                           ∧
                           ϕ
                        , and the abstraction of built-ins for a configuration term π is the same with our 
                           
                              
                                 t
                              
                              
                                 ˜
                              
                           
                        . According to the paragraph preceding Lemma 4 (Matching Lemma) in [27], by A-matching a configuration term π, including only data variables, against a left-hand side 
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                         of a rule in 
                           S
                         provides a complete unifiability algorithm for ground A-unification of π and 
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                         (the claim was adapted to our notation). More technically, the Matching Lemma in [27] claims that if π and 
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                         are ground A-unifiable, then there is a matching substitution σ such that 
                           σ
                           (
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                           )
                           
                              
                                 =
                              
                              
                                 A
                              
                           
                           π
                         (note the equality modulo A). Since ground A-unifiability is the same with concrete unifiability in the model M, we show below that we may take 
                           
                              
                                 unif
                              
                              
                                 ≅
                              
                           
                           (
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           π
                           )
                         to be the set of substitutions given by the matching algorithm. However, we cannot apply directly the Matching Lemma in [27] because it does not establish a direct relationship between unifiers and matchers.

This concludes the presentation of the practically relevant instances of our language-transformation approach.

@&#IMPLEMENTATION@&#

In this section we present a prototype tool implementing our approach. In Section 7.1 we briefly present our tool and its integration within the 
                        K
                      framework (version 3.4). In Section 7.2 we illustrate the most significant features of the tool by means of use cases involving nontrivial languages and programs.

Our tool is part of 
                           K
                         
                        [29,35], a semantic framework for defining operational semantics of programming languages. Specifically, our implementation is part of version 3.4 of the 
                           K
                         compiler.
                           3
                        
                        
                           3
                           A virtual machine running 
                                 K
                               (version 3.4) can be downloaded from http://www.kframework.org/imgs/releases/kvm-3.4.zip.
                         A 
                           K
                         definition of a language, say, 
                           L
                        , is compiled into a Maude rewrite theory. Then, the 
                           K
                         runner executes programs in 
                           L
                         by applying the resulting rewrite rules to configurations containing programs.

Our tool follows the same process. The main difference is that our new 
                           K
                         compiler includes the transformations presented in Section 6.2. The effect is that the compiled definition corresponds to the symbolic semantics of 
                           L
                         instead of its concrete semantics. We note that the symbolic semantics can execute programs with concrete inputs as well. In this case it behaves like the concrete semantics. The theoretical relationships between 
                           K
                         language definitions and their compilation to Maude, and between symbolic transformations of 
                           K
                         definitions and their Maude encodings are investigated in [4].

The tool provides symbolic support for some of the most standard 
                           K
                         data types: Booleans, integers, as well as arrays whose size, indices, and contents can be symbolic. The symbolic semantics is in general nondeterministic: when presented with symbolic inputs, a program can take several paths. Therefore the 
                           K
                         runner can be called with several options: it can execute one nondeterministically chosen path, or all possible paths, up to a given depth; it can also be run in a step-by-step manner. During the execution, the path conditions (which are computed by the symbolic semantics) are checked for satisfiability using ad hoc simplification rules and possibly, calls to the Z3 SMT solver [11].

In practice, path conditions may contain constraints over structures such as bags or sets. Unfortunately, SMT solvers have poor support for constraints over such structures, and thus, we always apply axioms of the symbolic domains to simplify the formulas before sending it to the solver. Then, for efficiency reasons, the SMT solver is called only if the rules adds non-trivial formula to path conditions, which cannot be simplified to true or false by the axioms of the symbolic domains.

We show three use cases for our tool: the first one illustrates the execution and LTL model checking for imp programs extended with I/O instructions, the second one demonstrates the use of symbolic arrays in the simple language – an extension of imp with functions, arrays, threads and several other features, and the third one shows symbolic execution in an object-oriented language called kool 
                        [17]. The simple and kool languages have existed almost as long as the 
                           K
                         framework and have intensively been used for teaching programming language concepts. All the examples presented below can be tested using the online interface at http://fmse.info.uaic.ro/tools/Symbolic/.

We first enrich the imp language (Fig. 1) with read and print operations. This enables the execution of imp programs with symbolic input data. We then compile the resulting definition by calling the 
                              K
                            compiler with an option telling it to generate the symbolic semantics of the language by applying the transformations described in Section 5.3.

Programs such as sum.imp shown in Fig. 4
                            can now be run with the 
                              K
                            runner in the following ways:
                              
                                 1.
                                 with symbolic or with concrete inputs;

on one arbitrary execution path, or on all paths up to a given bound;

in a step-wise manner, or by letting the program completely execute a given number of paths.


                           LTL model checking: The 
                              K
                            runner includes a hook to the Maude LTL (Linear Temporal Logic) model checker [9]. Thus, one can model check LTL formulas on programs having a finite state space (or by restricting the verification to a finite subset of the state space). This requires an extension of the syntax and semantics of a language for including labels that are used as atomic propositions in the LTL formulas. Assertions (predicates) on the program׳s variables can be used as propositions in the formulas as well, using the approach outlined in [22]. For instance, a guess for a while-loop invariant of the program log.imp in Fig. 5
                            can be expressed by an atomic proposition: 
                              
                                 
                                    Prop
                                    ::=
                                    logInv
                                    (
                                    Id
                                    ,
                                    Id
                                    ,
                                    Id
                                    )
                                 
                              
                           having the following semantics:
                              
                                 
                                    
                                       
                                          〈
                                          
                                             
                                                〈
                                                _
                                                〉
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                〈
                                                E
                                                〉
                                             
                                             
                                                env
                                             
                                          
                                          〉
                                       
                                       
                                          cfg
                                       
                                    
                                    
                                       
                                          ⊨
                                       
                                       
                                          Ltl
                                       
                                    
                                    logInv
                                    (
                                    A
                                    ,
                                    X
                                    ,
                                    K
                                    )
                                    ⇒
                                    lookup
                                    (
                                    X
                                    ,
                                    E
                                    )
                                    ⁎
                                    
                                       
                                          2
                                       
                                       
                                          lookup
                                          (
                                          X
                                          ,
                                          K
                                          )
                                       
                                    
                                    
                                       
                                          ≤
                                       
                                       
                                          Int
                                       
                                    
                                    lookup
                                    (
                                    X
                                    ,
                                    A
                                    )
                                    ∧
                                    lookup
                                    (
                                    X
                                    ,
                                    A
                                    )
                                    
                                       
                                          <
                                       
                                       
                                          Int
                                       
                                    
                                    (
                                    lookup
                                    (
                                    X
                                    ,
                                    E
                                    )
                                    
                                       
                                          +
                                       
                                       
                                          Int
                                       
                                    
                                    1
                                    )
                                    ⁎
                                    
                                       
                                          2
                                       
                                       
                                          lookup
                                          (
                                          X
                                          ,
                                          K
                                          )
                                       
                                    
                                 
                              
                           where 
                              α
                              ≜
                              logInv
                              (
                              
                                 a
                              
                              ,
                              
                                 x
                              
                              ,
                              
                                 k
                              
                              )
                            is equivalent to the assertion 
                              
                                 x
                              
                              ⁎
                              
                                 
                                    2
                                 
                                 
                                    
                                       k
                                    
                                 
                              
                              ≤
                              
                                 a
                              
                              <
                              (
                              
                                 x
                              
                              +
                              1
                              )
                              ⁎
                              
                                 
                                    2
                                 
                                 
                                    
                                       k
                                    
                                 
                              
                           . The relation 
                              π
                              
                                 
                                    ⊨
                                 
                                 
                                    Ltl
                                 
                              
                              α
                            expresses the fact that the current configuration π satisfies the assertion α. The labels of the statements can be seen as LTL atomic propositions as well: 
                              
                                 
                                    Prop
                                    ::=
                                    Id
                                 
                              
                           with the semantics: 
                              
                                 
                                    
                                       
                                          〈
                                          
                                             
                                                〈
                                                L
                                                
                                                
                                                   :
                                                
                                                
                                                S
                                                ↷
                                                _
                                                〉
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                〈
                                                _
                                                〉
                                             
                                             
                                                env
                                             
                                          
                                          〉
                                       
                                       
                                          cfg
                                       
                                    
                                    
                                       
                                          ⊨
                                       
                                       
                                          Ltl
                                       
                                    
                                    L
                                    ⇒
                                    true
                                 
                              
                           i.e., 
                              π
                              
                                 
                                    ⊨
                                 
                                 
                                    Ltl
                                 
                              
                              L
                            whenever the first statement in the cell 
                              k
                            (that follows to be executed) is labelled with the label L.

We have enriched the 
                              K
                            definition of imp with syntax and semantics for LTL support. Consider for instance the program log.imp in Fig. 5, which computes the integer binary logarithm of an integer read from the input. We prove that whenever the loop visits the label L, the invariant 
                              logInv
                              (
                              
                                 a
                              
                              ,
                              
                                 x
                              
                              ,
                              
                                 k
                              
                              )
                            holds. The while-loop invariant can be checked for concrete executions given by concrete input values: 
                              
                                 
                                    
                                       
                                          
                                       
                                    
                                 
                              
                           Above the symbolic version of the language is used for concrete inputs; this is possible because the only feasible executions in this case are the concrete ones.

However, when the input is symbolic, then the evaluation of the LTL atomic propositions becomes tricky because the relation 
                              
                                 
                                    ⊨
                                 
                                 
                                    Ltl
                                 
                              
                            is now between symbolic configurations and atomic propositions: 
                              π
                              ∧
                              ϕ
                              
                                 
                                    ⊨
                                 
                                 
                                    Ltl
                                 
                              
                              α
                            and its evaluation depends on the path condition ϕ. A correct solution for such cases is to split the executions into two branches: one with the path condition 
                              ϕ
                              ∧
                              α
                            and the other one for the case 
                              ϕ
                              ∧
                              ¬
                              α
                           . This is not practically reasonable when we work with an external model-checker because at least of the following reasons: (1) the set of assertions α is infinite; (2) if we restrict the approach only to atomic propositions occurring in the checked formula, we have to recompile the definition each time a new formula is checked; (3) the state space could explode more. We opted for a more experimental solution that works fine whenever the model-checker returns a positive answer: 
                              π
                              ∧
                              ϕ
                              
                                 
                                    ⊨
                                 
                                 
                                    Ltl
                                 
                              
                              α
                            holds whenever 
                              ϕ
                              ∧
                              ¬
                              α
                            is unsatisfiable, i.e., 
                              ϕ
                              ⟶
                              α
                            is valid. This covers the cases when all concrete configurations in 
                              〚
                              π
                              ∧
                              ϕ
                              〛
                            satisfies α. This means that if an LTL formula holds for all symbolic executions, then it holds for all concrete executions covered by the symbolic ones. If the formula does not hold and a counter-example is reported, then the concrete executions covered by the counter-example must be analysed. For instance, checking the program 
                              
                                 
                                    
                                       int x; x=read
                                    
                                    (
                                    )
                                    ;
                                    
                                    
                                       x=x + 1;
                                    
                                 
                              
                           against 
                              
                                 
                                    ♢
                                 
                                 
                                    Ltl
                                 
                              
                              odd
                              (
                              
                                 x
                              
                              )
                            and the symbolic input a returns a counterexample because the prover cannot deduce that one of a or 
                              a
                              
                                 
                                    +
                                 
                                 
                                    Int
                                 
                              
                              1
                            satisfies 
                              odd
                              (
                              
                                 x
                              
                              )
                           , which holds whenever the value of the program variable 
                              
                                 x
                              
                            given as argument is odd.

Another issue with the LTL model-checking is given by the fact that the 
                              K
                            tool usually implements only an approximation of the language definition, see [4] for a detailed discussion on this aspect. This approximation is propagated to the symbolic version and therefore the results of an LTL model-checking must be interpreted with respect this approximation.

Here we describe how the LTL model-checker can be called to check formulas over the space of symbolic executions using the experimental prototype, which can be accessed with the online interface https://fmse.info.uaic.ro/tools/Symbolic/. We let a be a symbolic value and restrict it in the interval (0..10) to obtain a finite state space. We prove that the above property, denoted by logInv(a,x,k) holds whenever the label L is visited and a is in the given interval, using the following command (again, slightly edited for better readability): 
                              
                                 
                                    
                                       
                                          
                                       
                                    
                                 
                              
                           The 
                              K
                            runner executes the command by calling the Maude LTL model-checker for the LTL formula 
                              
                                 
                                    □
                                 
                                 
                                    Ltl
                                 
                              
                              (
                              
                                 L 
                              
                              
                                 
                                    →
                                 
                                 
                                    Ltl
                                 
                              
                              
                              
                                 logInv
                              
                              (
                              
                                 a
                              
                              ,
                              
                                 x
                              
                              ,
                              
                                 k
                              
                              )
                              )
                            and the initial configuration having the program log.imp in the computation cell k, the symbolic value a in the input cell 
                              in
                           , and the constraint 
                              a
                              
                                 
                                    >
                                 
                                 
                                    Int
                                 
                              
                              0
                              
                                 
                                    ∧
                                 
                                 
                                    Bool
                                 
                              
                              a
                              
                                 
                                    <
                                 
                                 
                                    Int
                                 
                              
                              10
                            in the path condition. The result returned by the tool is that the above LTL formula holds.

We illustrate symbolic arrays in the simple language and show how the 
                              K
                            runner can directly be used for performing bounded model checking. In the program in Fig. 6
                           , the init method assigns the value x to the array a at an index j, then fills the array with ascending even numbers until it encounters x in the array; it prints error if the index i went beyond j in that process. The array and the indexes i, j are parameters to the function, passed to it by the main function which reads them from the input. In [1] it has been shown, using model-checking and abstractions on arrays, that this program never prints error.

We obtain the same result by running the program with symbolic inputs and using the 
                              K
                            runner as a bounded model checker: 
                              
                                 
                                    
                                       
                                          
                                       
                                    
                                 
                              
                           The initial path condition is 
                              n
                              
                                 
                                    >
                                 
                                 
                                    Int
                                 
                              
                              0
                           . The symbolic inputs for n,j,x are entered as n j x, and the array elements 
                              a
                              1
                            
                           
                              a
                              2
                            
                           
                              a
                              3
                            are also symbolic. The -pattern option specifies a pattern to be searched in the final configuration: the text error should be in the configuration׳s output buffer. The above command thus performs a bounded model-checking with symbolic inputs (the bound is implicitly set by the number of array elements given as inputs – 3). It does not return any solution, meaning that the program will never print error.

The result was obtained using symbolic execution without any additional tools or techniques. We note that array sizes are symbolic as well, a feature that, to our best knowledge, is not present in other symbolic execution frameworks.

Our last example (Fig. 7
                           ) is a program in the kool object-oriented language. It implements lists and ordered lists of integers using arrays. We use symbolic execution to check the well-known virtual method call mechanism of object-oriented languages: the same method call, applied to two objects of different classes, may have different outcomes.

The List class implements (plain) lists. It has methods for creating, copying, and testing the equality of lists, as well as for inserting and deleting elements in a list. Fig. 7 shows only a part of them. The class OrderedList inherits from List. It redefines the insert method in order to ensure that the sequences of elements in lists are sorted in increasing order. The Main class creates a list l1, initialises l1 and an integer variable x with input values, copies l1 to a list l2 and then inserts and deletes x in l1. Finally it compares l1 to l2 element by element, and prints error if it finds them different. We use symbolic execution to show that the above sequence of method calls results in different outcomes, depending on whether l1 is a List or an OrderedList. We first try the case where l1 is a List, by issuing the following command to the 
                              K
                            runner: 
                              
                                 
                                    
                                       
                                          
                                       
                                    
                                 
                              
                           The command initialises l1 with two symbolic values 
                              (
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    2
                                 
                              
                              )
                            and sets x to the symbolic value x. It searches for configurations that contain error in the output. The tool finds one solution, with 
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                              =
                              x
                            and 
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                              ≠
                              
                                 
                                    e
                                 
                                 
                                    2
                                 
                              
                            in the path condition. Since insert of List appends x at the end of the list and deletes the first instance of x from it, l1 consists of 
                              (
                              
                                 
                                    e
                                 
                                 
                                    2
                                 
                              
                              ,
                              x
                              )
                            when the two lists are compared, in contrast to l2, which consists of 
                              (
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    2
                                 
                              
                              )
                           . The path condition implies that the lists are different.

The same command on the same program but where l1 is an OrderedList finds no solution. This is because insert in OrderedList inserts an element in a unique place (up to the positions of the elements equal to it) in an ordered list, and delete removes either the inserted element or one with the same value. Hence, inserting and then deleting an element leaves an ordered list unchanged.

Thus, virtual method call mechanism worked correctly in the tested scenarios. An advantage of using our symbolic execution tool is that the condition on the inputs that differentiated the two scenarios was discovered by the tool. This feature can be exploited in other applications such as test-case generation.

The examples illustrated in this section are meant to exhibit some features of our implementation, but also to show that our approach is language independent. The 
                              K
                            definitions of the three languages that we use (i.e., imp, simple, and kool) have different sizes and they capture some essential features that can be found in programming languages today. Besides these examples, our tool can be used for real-life language definitions too (see, for instance, PHP [15]).

Another advantage of our approach is that it is formal. The coverage and precision properties ensure that results of different analyses performed on symbolic executions also hold for concrete executions. On the downside, some programs cause efficiency issues because of the large number of states to explore. In order to reduce the state space, we have implemented a mechanism which allows users to choose which semantical rules generate new states (see Section 7.3).

Our tool was developed as an extension of the 
                           K
                         3.5 compiler. A part of the connection to the Z3 SMT solver was done in 
                           K
                         itself, and the rest of the code is written in Java. The 
                           K
                         compiler (kompile) is organised as a list of transformations applied to the abstract syntax tree of a 
                           K
                         definition. Our compiler inserts additional transformations (formally described in Sections 5.3 and 6.2) when the 
                           K
                         compiler is called with the -backend symbolic option.

The compiler adds syntax declarations for each sort, which allows users to use symbolic values written as, e.g., #symSort(x) in their programs. The tool also generates predicates used to distinguish between concrete and symbolic values.

For handling the path condition, a new configuration cell, 
                           <path−condition>
                         is automatically added to the configuration. The transformations of rules discussed in Section 5.3 are also implemented as transformers applied to rules. There is a transformer for linearising rules, which collects all the variables that appear more than once in the left hand side of a rule, generates new variables for each one, and adds an equality in the side condition. There is also a transformer that replaces data subterms with variables, following the same algorithm as the previous one, and a transformer that adds rule׳s conditions in the symbolic configuration׳s path conditions. In practice, building the path condition blindly may lead to exploration of program paths which are not feasible. Therefore, at each step, the tool has to check whether the next symbolic state is satisfiable and it does that by connecting to the Z3 SMT solver. For this reason, the transformer that collects the path condition also adds, as a side condition to 
                           K
                         rules, a call to the SMT solver of the form 
                           
                              checkSat
                           
                           (
                           ϕ
                           )
                           ≠
                           “
                           
                              unsat
                           
                           ”
                        , where the checkSat function calls the SMT solver over the current path condition ϕ. When the path condition is found unsatisfiable the current path is not explored any longer. Note that we use 
                           
                              checkSat
                           
                           (
                           ϕ
                           )
                           ≠
                           “
                           
                              unsat
                           
                           ”
                         instead of 
                           
                              checkSat
                           
                           (
                           ϕ
                           )
                           =
                           “
                           
                              sat
                           
                           ”
                         because we do not want to miss possibly feasible executions. This can happen if the SMT solver cannot decide whether ϕ is satisfiable: the condition checkSat(ϕ) = “sat” becomes false, the rule does not apply, and the exploration stops even though the path is not known to be unfeasible for sure. Another problem that arises here is that, in 
                           K
                        , the condition of rules may also contain internally generated predicates needed only for matching. Those predicates should not be part of the path condition, therefore they had to be filtered out from rule׳s conditions before the latter are added to path conditions.

Not all the rules from a 
                           K
                         definition must be transformed. This is the case, e.g., of the rules computing functions or predicates. We have created a transformer that detects such rules and marks them with a tag. The tag can also be used by the user, in order to prevent the transformation of other rules if needed. Finally, in order to allow passing symbolic inputs to programs we generated a variable 
                           $IN
                           
                        , initialised at runtime by krun with the value of the option -cIN.

Regarding performances, our generic and formal tool is, quite understandably, not in the same league as existing pragmatic tools, which are dedicated to specific languages (e.g. Java PathFinder for Java, PEX for C#, KLEE for LLVM) and are focused on specific applications of symbolic execution. Our purpose is to automatically generate, from a formal definition of any language, a symbolic semantics capable of symbolically executing programs in that language, and to provide users with means for building their applications on top of our tool. For instance, our symbolic execution was used in combination with the 
                           K
                         model-checker for verifying some LTL properties over PHP programs [15]. Formal verification of programs based on deductive methods is also currently being built on top of our tool [21].

In this paper we present a language-independent approach to symbolic execution. The approach is based on language transformations. Starting from the formal definition of a language 
                        L
                     , whose operational semantics is defined by rewriting (specifically, by Reachability Logic rules [30]), a so-called symbolic language 
                        
                           
                              L
                           
                           
                              s
                           
                        
                      is constructed, by changing the model underlying 
                        L
                      into a symbolic model, and by adapting the semantical rules to compute over the symbolic model. The symbolic model consists of equivalence classes of formulas of Matching Logic [30] denoting possibly infinite sets of concrete program states.

The symbolic execution of programs in 
                        L
                      is defined to be the (usual, i.e., concrete) execution of the corresponding programs in 
                        
                           
                              L
                           
                           
                              s
                           
                        
                     . We prove that the notion of symbolic execution thus defined has the properties of coverage, meaning that for each concrete execution there is corresponding feasible symbolic one on the same path of instructions, and precision, meaning that each feasible symbolic execution has a corresponding concrete execution on the same path.

These theoretical results have practical consequences. They ensure that results of, e.g., reachability analyses or model checking performed on symbolic executions (a natural thing to do, since one symbolic execution encodes a possibly infinite sets of concrete executions) also hold on concrete program executions (which are the executions one is ultimately interested in analysing). We have implemented our approach in the 
                        K
                      framework and have applied to the model checking and reachability analysis of programs from several languages.

The key difference between our work and existing ones is that our approach is both formal and generic. There are many language-specific symbolic execution approaches and tools, a relevant sample of which is presented in the related works section. By being language-specific, tools can obtain high performances on programs of the language in question; but when a new version of the language arrives, the tool may become obsolete. Tools not formally grounded on formal semantics can also obtain high performances; but to trust their analyses one has to trust that the tool implicitly implements a correct language semantics.

Our approach focuses on genericity and formality, in order to avoid the above-mentioned drawbacks of language-specific and/or semantics-agnostic tools.


                     Future work: We are planning to use symbolic execution as the basic verification mechanism for program logics also developed in the 
                        K
                      framework (such as reachability logic [30]. We have already made some progress in this direction, by proposing a procedure which uses symbolic execution for verifying Reachability Logic specifications [21]. More generally, our symbolic execution approach can be used for program testing, debugging, and verification, following the ideas presented in related work, but with the added value of being language independent and being grounded in formal operational semantics.

@&#ACKNOWLEDGEMENTS@&#

The results presented in this paper would not have been possible without the valuable support from the 
                     K
                   tool development team (http://k-framework.org). The work presented here was supported in part by Romanian Contracts 161/15.06.2010, SMIS-CSNR 602-12516 (DAK) and POSDRU/159/1.5/S/137750, and by Région Nord Pas-de-Calais, via a CPER Contract with Inria Lille Nord-Europe.

@&#REFERENCES@&#

