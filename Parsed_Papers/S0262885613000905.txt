@&#MAIN-TITLE@&#Improved background modeling for real-time spatio-temporal non-parametric moving object detection strategies

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Real-time dynamic bandwidth estimation that reduces the amount of false detections.


                        
                        
                           
                           Selective update mechanism that significantly reduces the number of misdetections.


                        
                        
                           
                           The quality provided by previous background modeling strategies is improved.


                        
                        
                           
                           The computational cost of the simplest modeling strategy is barely increased.


                        
                        
                           
                           The proposed methods can be used by any spatio-temporal non-parametric strategy.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Dynamic bandwidth estimation

Moving object detection

Non-parametric background modeling

Selective update

Spatio-temporal data

@&#ABSTRACT@&#


               Graphical abstract
               
                  
                     
                        
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

The recent significant growth of electronic devices endowed with video cameras [1] has resulted in an important demand for new machine vision application tools [2]. To perform high-level tasks (e.g., tracking, classification, event analysis, or augmented reality) these tools include, as a key step, a moving object detection strategy [3]. Owing to the importance of these strategies, several approaches have been proposed [4] to efficiently detect moving objects.

Some algorithms aim to reduce the memory requirements and to maximize the speed [5], providing successful results for short sequences with simple backgrounds [6]. However, they do not provide satisfactory results in complex scenarios with illumination changes, shadows, or dynamic backgrounds [7].

To improve the quality of the detections in complex scenarios, several multimodal strategies have been proposed [8]. One key multimodal method is the Mixture of Gaussians (MoGs) model proposed by Stauffer and Grimson [9], which makes use of a mixture of several Gaussians to obtain an adaptive model of each image pixel [10]. Other popular multimodal methods are those using Hidden Markov Models (HMMs) [11], which model the background variations by representing the changes in the scene with different states (day or night, lights on or lights off, etc.).

Although these methods are able to provide high-quality detections in many scenarios, they fail in environments where the pixel statistics cannot be described parametrically [12]. To improve the quality of the results in these environments, several moving object detection strategies using non-parametric kernel density estimation methods have been developed [13]. Instead of considering the values of the pixels as a particular distribution, these methods obtain probabilistic models from sets of recent reference samples [14].

Among non-parametric strategies, a significant number of spatio-temporal background–foreground modeling approaches [15] have been recently proposed to improve the quality of the detections in sequences recorded with non-completely static cameras or containing non-static background regions [16]. These approaches construct both models (background and foreground) by using spatio-temporal reference data [17]. In this way, they improve the quality of the detections provided by other non-parametric methods [18]. However, since these strategies have associated very high memory and computational costs [19], they carry out some simplifications that reduce the quality of the background modeling. They model the background with fixed bandwidth matrices [16], decreasing the quality of the estimations and forcing to manually set appropriate bandwidth values depending on the characteristics of each sequence. Furthermore, instead of applying the selective mechanisms used by other strategies to update the background model, they use blind mechanisms [14], which significantly increase the amount of misdetections.

In this paper, we propose a real-time high-quality background modeling that is suitable for integration into any moving object detection strategy based on spatio-temporal non-parametric modeling. We robustly estimate the bandwidth of the kernels from spatially weighted distributions of the differences of reference samples for consecutive images. Additionally, we apply a novel mechanism to efficiently update the background model, which applies to each reference sample a weight factor determining its influence in the modeling.

The rest of the paper is organized as follows. Section 2 presents the state of the art corresponding to the most relevant work in kernel bandwidth estimation (Section 2.1) and background update (Section 2.2). Section 3 introduces the notation corresponding to the moving object detection strategies based on non-parametric modeling. Section 4 describes the method proposed to dynamically estimate the bandwidth of the kernels. Section 5 presents the algorithm proposed to update the background model. Finally, Sections 6 and 7 present, respectively, the obtained results and the conclusions.

@&#RELATED WORK@&#

Within non-parametric moving object detection strategies, the selection of adequate bandwidth matrices for the used kernels is crucial to obtain high quality results [20]. Using too small bandwidth values, the amount of false detections increases while, if too large bandwidth values are used, the multimodality can be lost. The optimal bandwidth matrix can be theoretically found by minimizing the mean-squared error between the estimated density function, 
                           
                              f
                              ^
                           
                        , and the true density, f. However, as this error depends on the unknown true density function, several heuristic strategies to dynamically estimate these matrices have been proposed [21].

In general, two formulations can be found in the literature [16]. The first one is known as balloon estimator and varies the bandwidth with the estimation point. This formulation is given by
                           
                              (1)
                              
                                 
                                    
                                       f
                                       ^
                                    
                                    
                                       x
                                    
                                    =
                                    
                                       
                                          1
                                          N
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                −
                                                
                                                   1
                                                   2
                                                
                                             
                                          
                                          K
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            −
                                                            
                                                               1
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            x
                                                            −
                                                            
                                                               x
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        where ∑(x) is the bandwidth matrix at the estimation point x, {x
                        
                           i
                        }
                           i
                           =1
                        
                           N
                         is a set of N samples from f, and K is a kernel function. The second one, which is known as sample point estimator, varies the bandwidth depending on the sample point and is given by
                           
                              (2)
                              
                                 
                                    
                                       f
                                       ^
                                    
                                    
                                       x
                                    
                                    =
                                    
                                       
                                          1
                                          N
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      
                                                         
                                                            x
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                −
                                                
                                                   1
                                                   2
                                                
                                             
                                          
                                          K
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               i
                                                            
                                                         
                                                         
                                                            −
                                                            
                                                               1
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            x
                                                            −
                                                            
                                                               x
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        where ∑(x
                        
                           i
                        ) is the bandwidth matrix at the sample point x
                        
                           i
                        .

Seeking simplicity and computational efficiency, some authors propose algorithms that use kernels with constant and global bandwidth values [22], which are able to provide good quality detections in sequences with slow background changes. However, they fail in scenarios containing backgrounds with complex or irregular densities [21].

To obtain high quality results, some strategies [7] make use of generic (non-necessarily diagonal) bandwidth matrices that are dynamically estimated at each pixel location. To construct these matrices, these approaches require to store large amounts of data and perform too many operations [14]. So, their associated computational and memory costs are very high.

Looking for a reasonable compromise between efficiency and quality, other strategies assume independency between all the characteristics used to represent the image pixels [23]. So, instead of using generic matrices, they use diagonal bandwidth matrices [24].

Regarding spatio-temporal non-parametric strategies, since no appropriate dynamic estimation scheme has been proposed for this kind of algorithms, they commonly use diagonal bandwidth matrices with fixed and global values [17]. In this way, they suppress the computational effort associated to the estimation of appropriate bandwidth matrices. However, the quality of the modeling decreases and, additionally, they require the manual setting of different bandwidth values depending on the characteristics of the sequences, which decreases their usability.

To adapt changes in the scene, non-parametric moving object detection strategies need to continuously update the sets of reference samples that are used to model the background [25]. Several mechanisms to efficiently update the background have been proposed in the literature. According to [26] they can be classified into: selective update mechanisms, which discard the samples from pixels that have been previously classified as foreground; and blind update mechanisms, which use all the samples extracted from the reference pixels.

Blind update mechanisms are easier to use, since they do not require the inclusion of additional strategies to decide if a pixel belongs to the background or to the foreground [27], which are usually complex and increase the computational cost of the modeling process. Consequently, blind update mechanisms have been used in several moving object detection strategies in recent years [12]. However, since these mechanisms include all the previously detected moving objects as part of the background model, they lead to significant amounts of misdetections.

Selective update mechanisms try to discard from the set of reference samples those samples previously classified as foreground [28]. In this way, as samples from foreground pixels are not used to estimate the background model, these mechanisms obtain final detections with less misdetections [29]. Currently, a large amount of moving object detection strategies proposing different selective update alternatives to model the background can be found in the literature [30]. However, as they require additional and complex object-level stages, they involve very high computational efforts [31] and, additionally, most of them cannot easily be included in any other moving object detection strategy.

Among selective update strategies, it is interesting to highlight that proposed in [32], since it has been extensively referred by many authors [26] and has been incorporated in several moving object detection strategies in recent years [33,34]. The update mechanism presented in [32] proposes to combine a short term model (a very recent model of the scene) with a long-term model (a more stable representation of the scene). The first model adapts to the fast changes in the background, while the second model adapts to its slow variations. By combining both models the quality of the background modeling is noticeably improved. However, this method has some important drawbacks. The length of both short-term and long-term models should be manually set accordingly to the content of the analyzed sequences (slow or fast moving objects, dynamic or stationary background variations, etc.). So, its usability is decreased. Additionally, as the estimation of two background models for each image is required, it involves very high memory and computational costs [35]. Therefore, this selective updating is not appropriate for spatio-temporal moving object detection strategies, since the main problem in this kind of strategies is the extremely high computational and memory costs to model the background [19]. Moreover, in case of sudden changes in lighting, significant amounts of pixels remain misclassified as foreground until the long term model adapts to the new illumination conditions [36]. So, this strategy is not appropriate for sequences with frequent changes in lighting.

Let p
                     
                        n
                      be a pixel in the current image I
                     
                        n
                     , at time n, defined as a D-dimensional vector 
                        
                           
                              a
                              n
                           
                           =
                           
                              
                                 
                                    a
                                    1
                                    n
                                 
                                 ,
                                 
                                    a
                                    2
                                    n
                                 
                                 …
                                 
                                    a
                                    D
                                    n
                                 
                                 ,
                              
                           
                           ∈
                           
                              R
                              D
                           
                        
                     , containing appearance information (color, gradient, depth, etc.) of p
                     
                        n
                     . Applying Gaussian kernels, the probability density function (pdf) that p
                     
                        n
                      belongs to the image background, β, can be non-parametrically estimated [7] as
                        
                           (3)
                           
                              
                                 p
                                 
                                    
                                       
                                          
                                             a
                                             n
                                          
                                       
                                       β
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       T
                                       β
                                    
                                 
                                 
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          T
                                          β
                                       
                                    
                                    
                                       
                                          1
                                          
                                             
                                                
                                                   
                                                      2
                                                      π
                                                   
                                                
                                                
                                                   D
                                                   2
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         
                                                            
                                                            
                                                               β
                                                               ,
                                                               a
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   1
                                                   2
                                                
                                             
                                          
                                       
                                       exp
                                       
                                          
                                             −
                                             
                                                1
                                                2
                                             
                                             
                                                
                                                   
                                                      
                                                         a
                                                         n
                                                      
                                                      −
                                                      
                                                         a
                                                         β
                                                         i
                                                      
                                                   
                                                
                                                T
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      β
                                                      ,
                                                      a
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                            n
                                                         
                                                         −
                                                         
                                                            a
                                                            β
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 a
                                 β
                                 i
                              
                           
                           
                              i
                              =
                              1
                           
                           
                              T
                              β
                           
                        
                      is a set of T
                     
                        β
                      reference samples extracted from the pixels at the same spatial position than p
                     
                        n
                      in the T
                     
                        β
                      previous images, and ∑
                     
                        β,a
                      is a symmetric positive-definite D
                     ×
                     D matrix determining the width of the Gaussian kernels [16].

The probability of p
                     
                        n
                      to belong to the sequence foreground, ϕ, can be computed, via Bayes' theorem, as
                        
                           (4)
                           
                              
                                 Pr
                                 
                                    
                                       ϕ
                                       
                                          
                                             a
                                             n
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       Pr
                                       
                                          ϕ
                                       
                                       p
                                       
                                          
                                             
                                                
                                                   a
                                                   n
                                                
                                             
                                             ϕ
                                          
                                       
                                    
                                    
                                       Pr
                                       
                                          β
                                       
                                       p
                                       
                                          
                                             
                                                
                                                   a
                                                   n
                                                
                                             
                                             β
                                          
                                       
                                       +
                                       Pr
                                       
                                          ϕ
                                       
                                       p
                                       
                                          
                                             
                                                
                                                   a
                                                   n
                                                
                                             
                                             ϕ
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                     where p(a
                     
                        n
                     |ϕ) is the pdf that p
                     
                        n
                      belongs to the image foreground, Pr(β) is the background prior probability, and Pr(ϕ)=1−Pr(β) is the foreground prior probability.

Several strategies describing methods to estimate p(a
                     
                        n
                     |ϕ) [24] and the prior probabilities [37] have been proposed in recent years. However, as this work focuses on the quality of the background modeling, we have considered that the foreground pdf is a constant density function and the prior probabilities are 
                        
                           Pr
                           
                              ϕ
                           
                           =
                           Pr
                           
                              β
                           
                           =
                           
                              1
                              2
                           
                        
                     .

Non-parametric estimation strategies allow the adequate modeling of background pixels in complex multimodal scenarios [7]. However, they fail if the analyzed sequences have been recorded with non-static cameras [27] (e.g. hand held cameras or fixed cameras that do not remain completely static due to common phenomena such as wind or ground vibrations). In these situations, as it is illustrated in Fig. 1.ii, the previously described non-parametric modeling results in significant amounts of false detections.

To improve the quality of the detections in sequences recorded with non-static cameras, most recent non-parametric based strategies estimate both background and foreground models from N
                        
                           β
                         spatio-temporal reference data [27], obtained from T
                        
                           β
                         (N
                        
                           β
                        
                        ≤
                        T
                        
                           β
                        ) previous images into a spatial neighborhood around the coordinates of each current pixel [19].

For this purpose, the pixel p
                        
                           n
                         is defined as a (D
                        +2)-dimensional vector 
                           
                              
                                 x
                                 n
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             a
                                             n
                                          
                                       
                                       T
                                    
                                    
                                       
                                          
                                             s
                                             n
                                          
                                       
                                       T
                                    
                                 
                                 T
                              
                              ∈
                              
                                 R
                                 
                                    D
                                    +
                                    2
                                 
                              
                           
                        , where 
                           
                              
                                 a
                                 n
                              
                              ∈
                              
                                 R
                                 D
                              
                           
                         is the appearance vector previously defined and 
                           
                              
                                 s
                                 n
                              
                              =
                              
                                 
                                    h
                                    n
                                 
                                 
                                    w
                                    n
                                 
                              
                              ∈
                              
                                 R
                                 2
                              
                           
                         is a vector containing the spatial coordinates (rows and columns) of p
                        
                           n
                        . Then, using a set of (D
                        +2)-dimensional spatio-temporal reference samples, 
                           
                              
                                 
                                    x
                                    β
                                    i
                                 
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                                 β
                              
                           
                        , and applying Gaussian kernels, the pdf that p
                        
                           n
                         belongs to the image background is estimated as
                           
                              (5)
                              
                                 
                                    p
                                    
                                       
                                          
                                             
                                                x
                                                n
                                             
                                          
                                          β
                                       
                                    
                                    =
                                    
                                       1
                                       
                                          N
                                          β
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             N
                                             β
                                          
                                       
                                       
                                          
                                             1
                                             
                                                
                                                   
                                                      
                                                         2
                                                         π
                                                      
                                                   
                                                   
                                                      
                                                         D
                                                         +
                                                         2
                                                      
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            
                                                               
                                                               
                                                                  β
                                                                  ,
                                                                  x
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                      2
                                                   
                                                
                                             
                                          
                                          exp
                                          
                                             
                                                −
                                                
                                                   1
                                                   2
                                                
                                                
                                                   
                                                      
                                                         
                                                            x
                                                            n
                                                         
                                                         −
                                                         
                                                            x
                                                            β
                                                            i
                                                         
                                                      
                                                   
                                                   T
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         β
                                                         ,
                                                         x
                                                      
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               n
                                                            
                                                            −
                                                            
                                                               x
                                                               β
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        and its probability to belong to the sequence foreground as in Eq. (3), where a
                        
                           n
                         should be replaced by x
                        
                           n
                        .

As shown in Fig. 1.iii, spatio-temporal modeling avoids most false detections in sequences recorded with non-completely static cameras, improving the quality of those strategies not using spatial information. However, their associated computational cost is a huge drawback [26]. Consequently, they apply simplifications that reduce the quality of the background modeling. As the dynamical estimation of bandwidth matrices is usually computationally expensive and, additionally, no appropriate dynamic estimation scheme has been proposed for spatio-temporal modeling, they use fixed bandwidth matrices [17]. Moreover, since selective mechanisms to update the background usually require additional and complex processing steps, they update the background with blind mechanisms [16].

In the following sections we present two novel and efficient methods to dynamically estimate adequate bandwidth matrices (Section 4) and to selectively update the background model (Section 5) in spatio-temporal based moving object detection strategies. These methods, which are applicable to any spatio-temporal non-parametric strategy, allow to significantly improve the quality of the detections provided by state of the art methods while maintaining the computational requirements of the modeling.

As generic bandwidth matrices drastically increase the complexity of the estimation, we use diagonal background matrices. Moreover, since sample point estimators (one bandwidth matrix per reference data) imply an excessive memory cost, we model the background using a balloon estimator (one bandwidth matrix per current sample). So, we use bandwidth matrices defined as
                        
                           (6)
                           
                              
                                 
                                    ∑
                                    
                                       β
                                       ,
                                       x
                                    
                                 
                                 
                                    =
                                    diag
                                    
                                       
                                          
                                             σ
                                             
                                                β
                                                ,
                                                1
                                             
                                             2
                                          
                                          ,
                                          
                                             σ
                                             
                                                β
                                                ,
                                                2
                                             
                                             2
                                          
                                          …
                                          
                                             σ
                                             
                                                β
                                                ,
                                                D
                                             
                                             2
                                          
                                          ,
                                          
                                             σ
                                             
                                                β
                                                ,
                                                H
                                             
                                             2
                                          
                                          ,
                                          
                                             σ
                                             
                                                β
                                                ,
                                                W
                                             
                                             2
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        
                     where the first D components determine the bandwidth of the appearance components and the last two components specify the spatial bandwidth (rows and columns) of the kernels. Hence, the background model can be estimated as
                        
                           (7)
                           
                              
                                 p
                                 
                                    
                                       
                                          
                                             x
                                             n
                                          
                                       
                                       β
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       
                                          N
                                          β
                                       
                                       
                                          
                                             
                                                2
                                                π
                                             
                                          
                                          
                                             1
                                             +
                                             
                                                D
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                          β
                                       
                                    
                                    
                                       
                                          
                                             ∏
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                D
                                                +
                                                2
                                             
                                          
                                          
                                             
                                                1
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               β
                                                               ,
                                                               x
                                                            
                                                         
                                                         
                                                            
                                                               j
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                      2
                                                   
                                                
                                             
                                             exp
                                             
                                                
                                                   −
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                                  n
                                                               
                                                               
                                                                  j
                                                               
                                                               −
                                                               
                                                                  x
                                                                  β
                                                                  i
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                         2
                                                      
                                                      
                                                         2
                                                         
                                                            
                                                               ∑
                                                               
                                                                  β
                                                                  ,
                                                                  x
                                                               
                                                            
                                                            
                                                               
                                                                  j
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Additionally, to prevent the evaluation of reference data not contributing significantly to the estimation of the background model, instead of using all the samples in the T
                     
                        β
                      previous images, we propose to consider only those satisfying that
                        
                           (8)
                           
                              
                                 
                                    D
                                    Mah
                                 
                                 
                                    
                                       s
                                       n
                                    
                                    
                                       s
                                       β
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                   n
                                                
                                                −
                                                
                                                   s
                                                   β
                                                   i
                                                
                                             
                                          
                                          T
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            σ
                                                            
                                                               β
                                                               ,
                                                               H
                                                            
                                                            2
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            σ
                                                            
                                                               β
                                                               ,
                                                               W
                                                            
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   s
                                                   n
                                                
                                                −
                                                
                                                   s
                                                   β
                                                   i
                                                
                                             
                                          
                                          T
                                       
                                    
                                 
                                 ≤
                                 
                                    d
                                    max
                                 
                                 ,
                              
                           
                        
                     where D
                     
                        Mah
                     (s
                     
                        n
                     ,s
                     
                        β
                     
                     
                        i
                     ) is the Mahalanobis distance between the spatial coordinates of the current sample and the spatial coordinates of the i-th reference sample, and d
                     
                        max
                      is a constant value. To consider only the reference samples falling inside the 99% of the spatial Gaussian kernels, taking into account that the values of a squared Mahalanobis distance are Chi-square distributed [38], d
                     
                        max
                      is set to 3. Fig. 2
                      illustrates an example that relates a pixel in the current image (red sphere) with the set of spatio-temporal reference samples (blue spheres) satisfying Eq. (8). The spatial Gaussian kernel that is used in the modeling is represented on the current image in the figure.

As the background reference samples are uniformly distributed in space, we have decided to use fixed spatial bandwidths on the whole image extent. However, the bandwidths corresponding to the appearance components should be dynamically estimated.

In the simplest scenarios, all the reference samples associated to each current pixel are part of a unimodal distribution (as shown in Fig. 3.a). In these situations, modeling the background with Gaussian kernels with a width defined by the variance of such set of samples (as the kernel shown on the right of the figure), it is possible to adequately estimate the true density function of the background. However, if the reference samples are part of a multimodal distribution (as shown in Fig. 3.b), using Gaussian kernels with a width defined by the variance of the full set of samples (as the purple kernel shown on the right of the figure) the multimodality is lost and, consequently, the background is erroneously estimated.

To estimate an adequate width in these multimodal situations, taking as starting point the method proposed in [24], we assume that there exists a Gaussian kernel defined as N(μ
                     3,σ
                     3
                     2) that fits adequately to each mode separately and, as shown in Fig. 3.c, we construct a distribution of differences between consecutive time samples, N(0, 2σ
                     3
                     2), from which σ
                     3
                     2 can be easily obtained.

To accomplish this purpose, the strategy in [24] estimates σ
                     3
                     2 from the median of the absolute values of N(0, 2σ
                     3
                     2), avoiding the negative influence of outliers such as those marked with red circles in Fig. 3.c. However, this strategy cannot be directly applied to spatio-temporal modeling methods, since it does not consider spatial information. Moreover, the computation of the median is too expensive [39]. So, it can be unaffordable on spatio-temporal modeling strategies, where the number of reference data is very high.

To overcome these limitations, instead of computing the median of the distributions of reference sample differences, we propose to use the variance of such distributions. Thereby, we are able to reduce very significantly the computational effort in the bandwidth estimation stage. Moreover, to include the reference sample differences at all the spatial positions, we propose the computation of a variance for each subset of reference samples at the same coordinates and, in a second stage, the estimation of the bandwidth of each appearance component from the sum of all these distributions, weighted according to its spatial distance to p
                     
                        n
                     .

Let 
                        
                           
                              
                                 Δ
                                 
                                    a
                                    β
                                    i
                                 
                              
                           
                           
                              i
                              =
                              1
                           
                           
                              N
                              β
                           
                        
                      be the set of D-dimensional appearance differences obtained from all the possible differences between consecutive reference samples at the same coordinates. Firstly, for the differences at each possible spatial position, (h,w), we compute
                        
                           (9)
                           
                              
                                 
                                    ∑
                                    
                                       β
                                       ,
                                       h
                                       ,
                                       w
                                    
                                    2
                                 
                                 
                                    =
                                    
                                       1
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                
                                                   ψ
                                                   
                                                      h
                                                      ,
                                                      w
                                                   
                                                
                                             
                                          
                                          
                                             Pr
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      x
                                                      β
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             ∈
                                             
                                                ψ
                                                
                                                   h
                                                   ,
                                                   w
                                                
                                             
                                          
                                       
                                       
                                          Pr
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   x
                                                   β
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Δ
                                                      
                                                         a
                                                         β
                                                         i
                                                      
                                                   
                                                
                                             
                                             2
                                          
                                          ∈
                                          
                                             R
                                             D
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where Pr(β|x
                     
                        β
                     
                     
                        i
                     )=1−Pr(ϕ|x
                     
                        β
                     
                     
                        i
                     ) is the probability of x
                     
                        β
                     
                     
                        i
                      to belong to the sequence background and ψ
                     
                        h,w
                      is a set defined as
                        
                           (10)
                           
                              
                                 
                                    ψ
                                    
                                       h
                                       ,
                                       w
                                    
                                 
                                 =
                                 
                                    
                                       i
                                       ∈
                                       
                                          1
                                          
                                             N
                                             β
                                          
                                       
                                       ,
                                       such
                                       
                                       that
                                       
                                       
                                          s
                                          β
                                          i
                                       
                                       =
                                       
                                          
                                             h
                                             w
                                          
                                          T
                                       
                                    
                                 
                                 .
                              
                           
                        
                     
                  

Weighting the differences by these probabilities we reduce the negative influence of outliers (such as those marked with red circles in Fig. 3.c). Additionally, as the probabilities of the reference samples to belong to the background have been obtained in the analysis of previous images, their use does not involve any increase in the computational cost.

From these values, we estimate a bandwidth for each appearance component as
                        
                           (11)
                           
                              
                                 
                                    σ
                                    
                                       β
                                       ,
                                       j
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       
                                          2
                                       
                                       
                                          
                                             ∑
                                             
                                                h
                                                ,
                                                w
                                             
                                          
                                          
                                             
                                                w
                                                Σ
                                             
                                             
                                                h
                                                w
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                       
                                          h
                                          ,
                                          w
                                       
                                    
                                    
                                       
                                          w
                                          Σ
                                       
                                       
                                          h
                                          w
                                       
                                       
                                          
                                             ∑
                                             
                                                β
                                                ,
                                                h
                                                ,
                                                w
                                             
                                          
                                          
                                             
                                                j
                                             
                                             ,
                                             such
                                             
                                             that
                                             
                                             j
                                             ∈
                                             
                                                1
                                                D
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                     where w
                     
                        Σ
                     (h,w) is a weight assigned to each subset of differences, according to its spatial distance to p
                     
                        n
                     . As the influence of the reference samples over p
                     
                        n
                      decreases with their distance to p
                     
                        n
                     , these weights are obtained through the evaluation of spatial Gaussians at these distances:
                        
                           (12)
                           
                              
                                 
                                    w
                                    Σ
                                 
                                 
                                    h
                                    w
                                 
                                 ∝
                                 exp
                                 
                                    
                                       −
                                       
                                          1
                                          2
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            h
                                                            n
                                                         
                                                         −
                                                         h
                                                      
                                                   
                                                   2
                                                
                                                
                                                   σ
                                                   
                                                      β
                                                      ,
                                                      H
                                                   
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         
                                                            w
                                                            n
                                                         
                                                         −
                                                         w
                                                      
                                                   
                                                   2
                                                
                                                
                                                   σ
                                                   
                                                      β
                                                      ,
                                                      W
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     
                  

Since the computation of these Gaussians is necessary for the evaluation of p(x
                     
                        n
                     |β) anyway, they are obtained without additional computational effort.


                     Fig. 4
                      shows some final detections obtained from the application of different bandwidth matrices to an indoor sequence containing a moving object. These results show that using bandwidth matrices with large fixed values (Fig. 4.i) the moving object in the scene is not correctly modeled and a significant number of misdetections is obtained. Furthermore, it can be observed that using bandwidth matrices with small fixed values (Fig. 4.ii) the moving object is better modeled, but there is an important amount of false positives decreasing the quality of the detection. Finally, the results in Fig. 4.iii show that estimating the appearance bandwidth values with the proposed strategy we obtain a better balance between misdetections and false detections.

The conducted experiments have shown that the method proposed to dynamically estimate the bandwidth matrices of the kernels improves the quality of the detections provided by previous approaches in most situations. A detailed analysis of these experiments is presented in Section 6.

To decrease the number of misdetections and, consequently, improve the quality of the detections, we propose an alternative and novel mechanism to efficiently update the background model, which is suitable for its application in any non-parametric strategy based on both temporal modeling and spatio-temporal modeling.

As stated in Section 2.2, blind update mechanisms give rise to large amounts of misdetections, while selective update algorithms result in persistent false detections later. To avoid these problems, we propose an alternative update mechanism that uses all the samples from the reference pixels (as in a blind update mechanism) and assigns to each sample a weight determining its influence in the modeling. In this way, we avoid the inclusion of complex selection stages to determine whether a sample should or should not be used to estimate the background model (as it is done by typical selective update mechanisms).

Stemming from Eq. (7), we propose to estimate the pdf that p
                     
                        n
                      belongs to the image background as
                        
                           (13)
                           
                              
                                 p
                                 
                                    
                                       
                                          
                                             x
                                             n
                                          
                                       
                                       β
                                    
                                 
                                 =
                                 
                                    K
                                    w
                                 
                                 
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                          β
                                       
                                    
                                    
                                       
                                          w
                                          i
                                       
                                       
                                          
                                             ∏
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                D
                                                +
                                                2
                                             
                                          
                                          
                                             exp
                                             
                                                
                                                   −
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                                  n
                                                               
                                                               
                                                                  j
                                                               
                                                               −
                                                               
                                                                  x
                                                                  β
                                                                  i
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                         2
                                                      
                                                      
                                                         2
                                                         
                                                            
                                                               ∑
                                                               
                                                                  β
                                                                  ,
                                                                  x
                                                               
                                                            
                                                            
                                                               
                                                                  j
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                     where K
                     
                        w
                      is a normalization factor defined as
                        
                           (14)
                           
                              
                                 
                                    K
                                    w
                                 
                                 =
                                 
                                    1
                                    
                                       
                                          
                                             
                                                2
                                                π
                                             
                                          
                                          
                                             1
                                             +
                                             
                                                D
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                      
                                                         β
                                                         ,
                                                         x
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                   β
                                                
                                             
                                             
                                                
                                                   w
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 ,
                              
                           
                        
                     and w
                     
                        i
                      is the weight assigned to the i-th reference sample. Our main contribution to the proposed selective update method is the unsupervised and robust estimation of these weights, which are obtained as
                        
                           (15)
                           
                              
                                 
                                    w
                                    i
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Pr
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               x
                                                               β
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         G
                                                         T
                                                      
                                                      
                                                         
                                                            Δ
                                                            
                                                               n
                                                               i
                                                            
                                                         
                                                      
                                                      Pr
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               x
                                                               β
                                                               i
                                                            
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            1
                                                            −
                                                            
                                                               G
                                                               T
                                                            
                                                            
                                                               
                                                                  Δ
                                                                  
                                                                     n
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      if
                                                   
                                                
                                                
                                                   
                                                      if
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Δ
                                                      
                                                         n
                                                         i
                                                      
                                                      ≤
                                                      
                                                         N
                                                         C
                                                      
                                                   
                                                
                                                
                                                   
                                                      Δ
                                                      
                                                         n
                                                         i
                                                      
                                                      >
                                                      
                                                         N
                                                         C
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                     where Δn
                     
                        i
                      is the temporal distance between the i-th reference sample and the current one, N
                     
                        C
                     
                     <
                     T
                     
                        β
                      is a predefined constant value, and G
                     
                        T
                     (Δn
                     
                        i
                     ) is a temporal Gaussian defined as
                        
                           (16)
                           
                              
                                 
                                    G
                                    T
                                 
                                 
                                    
                                       Δ
                                       
                                          n
                                          i
                                       
                                    
                                 
                                 =
                                 exp
                                 
                                    
                                       −
                                       
                                          1
                                          2
                                       
                                       
                                          
                                             
                                                
                                                   Δ
                                                   
                                                      n
                                                      i
                                                   
                                                   −
                                                   
                                                      N
                                                      C
                                                   
                                                
                                             
                                             2
                                          
                                          
                                             σ
                                             T
                                             2
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     
                  

To guarantee that the temporal interval covered by the Gaussian accumulates approximately the 99% of its probability (i.e. G
                     
                        T
                     (T
                     
                        β
                     )≃0), its standard deviation, σ
                     
                        T
                     , is set as (see [38])
                        
                           (17)
                           
                              
                                 
                                    σ
                                    T
                                 
                                 =
                                 
                                    
                                       
                                          T
                                          β
                                       
                                       −
                                       
                                          N
                                          C
                                       
                                    
                                    3
                                 
                                 .
                              
                           
                        
                     
                  

As the weights assigned to the reference samples belonging to recently detected foreground objects are very low, the influence of the foreground objects in the background modeling is drastically decreased. Additionally, since the samples from the N
                     
                        C
                      most recent reference images are weighted according to exclusively the probabilities of the reference samples to belong to the background, Pr(β|x
                     
                        β
                     
                     
                        i
                     ), the erroneous classification as background of foreground objects remaining static for very short periods of time or moving along the optical axis is avoided. The conducted experiments have shown that using small values of N
                     
                        C
                      (around 25 images) most of these misdetections are avoided. Therefore, since larger N
                     
                        C
                      values could result in persistent false detections when the background regions are subject to prolonged changes, we have finally decided to use N
                     
                        C
                     
                     =25 in all the experiments.

Since G
                     
                        T
                      decreases with the temporal distance from the current sample to the reference samples, all the reference samples (regardless of whether they were classified as background or foreground) have more similar weights as this distance increases. Therefore, the persistent exclusion of those reference samples that have been erroneously classified as foreground is significantly reduced, which drastically decreases the amount of false detections.


                     Fig. 5
                      illustrates some final detections, resulting from the analysis of an outdoor sequence with dynamic background and a car moving slowly, by means of different spatial bandwidths and using different update strategies: a blind update algorithm (Fig. 5.a), a selective update mechanism that discards the samples previously classified as foreground [40] (Fig. 5.b), and the proposed selective update (Fig. 5.c). The recall, precision, and F percentages [41] corresponding to these detections are shown in Fig. 6
                     .

The results obtained with the blind update show that the number of false detections due to camera shake or to small background displacements is reduced as larger spatial widths are used (the precision percentages increase). However, the number of misdetections also increases (the recall percentages decrease), leading to worse global results (lower F values).

In the case of the detections obtained through the selective update mechanism, the results in these figures show that the number of misdetections is significantly reduced (larger recall values) for all the tested spatial bandwidth values. However, as many background pixels erroneously classified as foreground in previous images are not used to model the current background, the amount of false detections is significantly larger than that obtained with the blind update mechanism, leading to smaller precision percentages.

Regarding the results corresponding to the proposed update mechanism, it can be observed that the balance between misdetections and false detections, for all the tested spatial widths, is the best of the three compared strategies: the number of misdetections is similar to that obtained with the selective update approach, while the amount of false detections is so low as that obtained with the blind update strategy. Consequently, the proposed method provides the largest F values.

Finally, Fig. 7
                      presents some results obtained with different background update strategies in an indoor scenario where a person steals a static object from the background. The first column of images (Fig. 7.a) shows three original images at different temporal instants. The second column (Fig. 7.b) contains their corresponding ground truth. The third column (Fig. 7.c) presents the results obtained with a blind update mechanism [16]. The fourth column (Fig. 7.d) shows the detections with a selective update mechanism that exclude the reference samples previously classified as foreground [40]. Finally, the last column (Fig. 7.e) illustrates the results obtained with the proposed update strategy. These results show that using the selective update in [40] (Fig. 7.d) or the proposed update (Fig. 7.e) the moving object is better detected (the amount of misdetections is lower) than using the blind update. However, as shown in the results in the last row of images (corresponding to a temporal instant after a enduring background change), the proposed update strategy provides better results (lower amount of false detections) than the typical selective mechanism, since the temporal Gaussian used in our approach avoids to completely discard the reference samples that have been erroneously classified as foreground.

A more detailed analysis of the results obtained with the proposed selective update method is presented in the Results section.

@&#RESULTS@&#

The proposed methods have been tested in a large variety of indoor and outdoor sequences containing critical situations for moving object detection strategies: dynamic backgrounds, moving objects remaining static different periods of time, illumination changes, non-static cameras, and prolonged background variations. These test sequences, whose main characteristics are shown in Table 1
                     , cover the required indoor and outdoor scenarios and have been extracted from three databases. The sequences labeled as Pets_00x have been obtained from PETS database [42]: Pets_001 from PETS2000, Pets_002 and Pets_003 from PETS2001, and Pets_004 and Pets_005 from PETS2009. The sequences labeled as Wall_00x have been taken from Wallflower database [43] and those labeled as Lab_00x are from our own database [44].

To evaluate the performance of the proposed background modeling, we have decided to compare it with those proposed in [16] and [45]. The first one could be considered the simplest and fastest background modeling for spatio-temporal non-parametric strategies, since it uses fixed diagonal bandwidth matrices and a blind update mechanism. For this reason, it has been extensively used in several spatio-temporal non-parametric approaches [17,18,27,37,46]. The second one also uses a blind update mechanism but, as we know, it describes the only previous background bandwidth estimation strategy for spatio-temporal non-parametric modeling. In this way, it improves the quality of the modeling proposed in [16]. However, since its estimation method is based on the computation of the median of multiple reference data distributions, it noticeably increases the computational cost of the modeling, which complicates its integration in applications requiring real-time processing. Note that, although there exist several background modeling strategies including selective update mechanisms [30,32], all of them only consider temporal reference data and cannot be directly applied to spatio-temporal modeling approaches. Therefore, it is not possible to compare our algorithms with previous spatio-temporal strategies selectively updating the background model.

The background modeling of the three compared strategies ([16,45], and ours) has been carried out by using T
                     
                        β
                     
                     =150 reference images. Additionally, to reduce the influence of the shadows in the detections, we have used the appearance vector proposed in [37], which is composed by the chromaticity (Rn,Gn) and the module of the gradient of the brightness, |∇
                     s|. Hence, the used appearance vector has three dimensions (D
                     =3) and is defined as a
                     =(Rn,Gn,|∇
                     s|). Regardless of the used spatio-temporal background modeling, the performed experiments have shown that a spatial neighborhood of the 8-connected pixels of each sample is enough to avoid most false detections due to small displacements of the background. However, larger spatial neighborhoods significantly increases the computational cost [19]. For this reason, the spatial widths of the Gaussian kernels used in the three compared methods have been set to consider such neighborhood. Therefore, according to Eq. (8), 
                        
                           
                              σ
                              
                                 β
                                 ,
                                 H
                              
                              2
                           
                           =
                           
                              σ
                              
                                 β
                                 ,
                                 W
                              
                              2
                           
                           =
                           
                              2
                              
                                 3
                                 2
                              
                           
                        
                     . Regarding the appearance bandwidths in [16], which is the unique tested method that does not estimate the width of the kernels, we have used the best global bandwidth value we have found for the set of test sequences: 
                        
                           
                              Σ
                              β
                           
                           
                              j
                              j
                           
                           =
                           
                              
                                 
                                    
                                       
                                          0.5
                                          100
                                       
                                       max
                                       
                                          
                                             a
                                             j
                                             n
                                          
                                       
                                    
                                 
                              
                              2
                           
                        
                     , such that j
                     ∈[1,3].

It is must be noted that the algorithms proposed in this paper are exclusively focused to improve the quality, the speed, and the usability of the background modeling in spatio-temporal non-parametric moving object detection strategies. For this reason, to help the analysis of the obtained improvements, in most of the performed experiments we have considered that there is no prior knowledge (i.e. 
                        
                           Pr
                           
                              ϕ
                           
                           =
                           Pr
                           
                              β
                           
                           =
                           
                              1
                              2
                           
                        
                     ) and that the foreground pdf is a constant density (that is, p(Rn, Gn, |∇
                     s|, h
                     
                        n
                     , w
                     
                        n
                     |ϕ)=(Rn
                     
                        max
                     
                     ×
                     Gn
                     
                        max
                     
                     ×|∇
                     s|
                        max
                     
                     ×
                     h
                     
                        max
                     
                     
                        n
                     
                     ×
                     w
                     
                        max
                     
                     
                        n
                     )−1, where Rn
                     ∈[0, Rn
                     
                        max
                     ], Gn
                     ∈[0, Gn
                     
                        max
                     ], |∇
                     s|∈[0,|∇
                     s|
                        max
                     ], h
                     
                        n
                     
                     ∈[0,h
                     
                        max
                     
                     
                        n
                     ], and w
                     
                        n
                     
                     ∈[0,w
                     
                        max
                     
                     
                        n
                     ]). However, to evaluate the improvement achieved with the proposed methods if both background and foreground are modeled, we have also analyzed the quality of the detections by combining each one of the three compared background modeling algorithms with the foreground modeling in [16], which is a reference spatio-temporal non-parametric foreground modeling that has been taken as starting point by several strategies [17,27,37].

To provide an objective measure of the quality of the obtained detections we have used the conventional recall (rec) and precision (pre) evaluation parameters:
                           
                              (18)
                              
                                 
                                    rec
                                    =
                                    100
                                    
                                       CD
                                       
                                          CD
                                          +
                                          ND
                                       
                                    
                                    %
                                    ,
                                    
                                    pre
                                    =
                                    100
                                    
                                       CD
                                       
                                          CD
                                          +
                                          FD
                                       
                                    
                                    %
                                    ,
                                 
                              
                           
                        where CD is the number of correct detections, ND is the number non-detected foreground pixels (misdetections), and FD is the amount of false detections. Moreover, we also used the F measure:
                           
                              (19)
                              
                                 
                                    F
                                    =
                                    
                                       
                                          2
                                          ×
                                          rec
                                          ×
                                          pre
                                       
                                       
                                          rec
                                          +
                                          pre
                                       
                                    
                                    %
                                    ,
                                 
                              
                           
                        which is commonly used [41] to evaluate jointly the recall and the precision parameters.

It should be noted that the sequence labeled as Pets_002 has been selected because it contains several illumination changes. However, it does not include moving objects. So, regardless of the method applied on this sequence, both the number of correct detections and the number of misdetections are always zero. Consequently, to evaluate the quality of the results obtained in this sequence, instead of using the previously defined percentages, we have only considered the amount of false detections.

In the first place, the recall and precision percentages achieved with the methods proposed to improve the quality of the classical spatio-temporal background modeling are analyzed. The summary of the obtained results is illustrated in Fig. 8
                        . In this figure, the orange bars show the results by applying the proposed dynamical bandwidth estimation, while the blue bars present those resulting from the combination of the bandwidth estimation and the selective update. It can be observed that through the method proposed to dynamically estimate the background bandwidth matrices we are able to obtain very high precision percentages in all the test sequences (most false detections are avoided). Furthermore, it can also be noted that by incorporating the proposed selective update the recall percentages are significantly increased (the number of misdetections is drastically reduced). Regarding to the false detections in Pets_002, whose results do not appear in the figure due to the previously exposed reasons, it can be observed that the amount of false detections in the two considered cases is very similar. A detailed analysis of the results obtained for this sequence is presented later.


                        Figs. 9 and 10
                        
                         show some results comparing the quality of the detections provided by the proposed background modeling and by those proposed in [16] and [45]. Table 2
                         summarizes the recall, precision, and F percentages obtained in the full set of test sequences. The last row in the table shows the results corresponding to the union of all the sequences.

It can be observed that the background modeling in [16], due to the fact that it does not estimate adequate bandwidth matrices, usually leads to more false detections (lower precision) and more misdetections (lower recall) than the other two algorithms. Consequently, the overall quality of its detections is the worst (its overall F percentage is the lowest).

Additionally, it can be noted that the strategies that dynamically estimate the bandwidth matrices (e.g. [45] and the proposed here) provide a better balance between misdetections and false detections and, therefore, they give higher F values than [16]. Moreover, the obtained results show that the background modeling described in this paper achieves better results than [45] in most sequences, since it not only estimates adequate bandwidth matrices but also selectively updates the background, which significantly reduces the amount of misdetections. Therefore, the proposed modeling obtains the best overall F percentages.

Although in most of the analyzed sequences the proposed background modeling provides the best quality detections, in the sequences labeled as Pets_004 and Pets_005 the algorithms in [16] and [45] obtain better quality. In these sequences many moving objects remain static or move along the optical axis for several seconds, which gives rise to significant amounts of misdetections in all the tested methods. Fig. 11
                         presents an example in an image of Pets_004. As it has been described in Section 4, the proposed bandwidth estimation algorithm uses information from all the samples in the T
                        
                           β
                         previous images. Consequently, the quality of the estimation decreases as the amount of misdetections increases, which explains the low quality obtained in these two sequences. However, as it is shown later, this drawback is solved by modeling both the background and the foreground, since in this way the number of misdetections is significantly reduced.

Regarding to Pets_002, as stated at the beginning of this section, instead of using the recall, precision, and F percentages, the amount of false detections is exclusively analyzed. The number of false detections accumulated along this sequence, for the three compared strategies, is illustrated in Fig. 12
                        . The graphics in this figure show that at the beginning of the sequence, due to the low amount of available reference data, the three background modeling methods contain many false detections. The number of false detections in these first images is significantly larger in the case of [45], since its bandwidth estimation method requires a larger number of reference images to provide robust estimations. Additionally, it can be also observed that in the rest of the sequence the amount of false detections using the background modeling in [16] and [45] significantly increases (this increase is slightly lower in the case of [45]). However, in the case of the proposed strategy, this increase is almost negligible.

Finally, Table 3
                         summarizes the recall, precision and F percentages by combining each one of the previously analyzed background modeling strategies with the foreground modeling in [16]. The data in this table show that by adding a foreground modeling all the results are improved, mainly due to a significant reduction in the number of misdetections. Moreover, it can also be appreciated that the best global results are those obtained with the proposed background modeling and, additionally, the obtained improvements are approximately equal to those obtained with a uniform foreground model (shown in Table 2): approximately 20% with respect to [16] and approximately 15% with respect to [45].

Note that by modeling both background and foreground, in Pets_004 and Pets_005 the number of misdetections due to moving objects remaining static for short periods of time or moving along the optical axis is significantly reduced (compared to the case of modeling exclusively the background). Consequently, the proposed bandwidth estimation strategy is able to provide much better estimations, which result in a remarkable improvement of the quality of the detections.

The evaluation of the computational efficiency of the three compared background modeling strategies has been carried out using C++ implementations on a 2.66GHz CPU with 2GB RAM.

The performed experiments have shown that the computational cost to model the background is proportional to the number of used reference images. So, this cost increases linearly along the first T
                        
                           β
                         images and, once the background model has been fully initialized (i.e. when T
                        
                           β
                         reference images are being used), it remains constant.


                        Fig. 13
                         presents the computational costs per image, once the background model has been fully initialized, obtained with the three compared strategies. The dashed lines illustrate the mean costs depending on the spatial resolution of the sequences, which have been estimated from the measures obtained from the analysis of the test sequences. These measures have been represented as dots around the dashed lines. The collected data show that the measured times are roughly proportional to the spatial resolution of the sequences. Moreover, it can be appreciated that the background modeling proposed in [45], mainly because it includes a complex stage to dynamically estimate the background bandwidth matrices, is more than three times slower than the other two analyzed methods. Additionally, it can be observed that, despite the proposed strategy is selectively updating the background model and dynamically estimating the bandwidth matrices, it barely increases the computational cost of the simplest known spatio-temporal background modeling [16] (approximately 7%).

Finally, to give a hint about the real-time processing capabilities of the proposed background modeling, it has been implemented on a general-purpose graphics processing unit (GPGPU) nVidia GTX-580 [47]. The summary of the results obtained for some sequences with different image sizes is presented in Table 4
                        . First row shows the considered image sizes. Second and third rows present, respectively, the mean processing time (in milliseconds) and the frame rate, both once the background model has been fully initialized. The results in this table demonstrate that the proposed strategy is able to obtain real-time detections in a large variety of sequences with different image sizes. So, it can be perfectly integrated into next generation of computer vision tools.

@&#CONCLUSION@&#

An improved and efficient background modeling, suitable for integration in any spatio-temporal moving object detection strategy, has been presented.

A robust strategy to dynamically estimate adequate bandwidth matrices for the kernels used in the background modeling has been proposed. The estimation of these matrices is based on the computation of spatially weighted sample variances, which are obtained from distributions of differences of reference samples for consecutive images at the same coordinates. This method improves significantly the quality of the detections provided by previous approaches while barely increasing the processing time of the modeling.

Moreover, an alternative strategy to selectively update the background model has been also proposed. The main goal of this proposal is the unsupervised and robust estimation of weights that are assigned to each reference sample. These weights are efficiently obtained as a combination of the probabilities with which the reference samples have been classified as background and a temporal Gaussian. In this way, the amount of correct detections is significantly increased while the false detections resulting from reference samples erroneously classified as foreground are drastically reduced. Additionally, as the inclusion of complex selection stages to determine whether a sample should or should not be used to estimate the background model is avoided, the increase of the computational cost in negligible.

The obtained results have shown that the combination of the two proposed algorithms is perfectly suitable for integration in any non-parametric background modeling technique based on spatio-temporal reference data, since they noticeably improve the results provided by previous strategies while maintaining the computational requirements of the modeling.

@&#ACKNOWLEDGMENTS@&#

This work was supported in part by the Ministerio de Economía y Competitividad of the Spanish Government under project TEC2010-20412 (Enhanced 3DTV).

@&#REFERENCES@&#

