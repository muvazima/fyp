@&#MAIN-TITLE@&#A new lossless orthogonal simplification method for 3D objects based on bounding structures

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We present a new approach to simplify binary volumes.


                        
                        
                           
                           The method produces a level-of-detail sequence of orthogonal pseudo-polyhedra.


                        
                        
                           
                           The generated sequence is encoded in a progressive and lossless way.


                        
                        
                           
                           Our method produces smaller storage sizes and good quality approximations compared with similar methods.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Simplification

LOD

Bounding volumes

Orthogonal polyhedra

Binary volumes

@&#ABSTRACT@&#


               
               
                  This paper presents a new approach to simplify 3D binary images and general orthogonal pseudo-polyhedra (OPP). The method is incremental and produces a level-of-detail sequence of OPP, where any object of this sequence bounds the previous objects and, therefore, is a bounding orthogonal approximation of them. The sequence finishes with the axis-aligned bounding box. OPP are encoded using the Extreme Vertices Model, a complete model that stores a subset of their vertices and performs fast Boolean operations. Simplification is achieved by using a new strategy, which relies on the application of 2D Boolean operations. We also present a technique, based on model continuity, for better shape preservation. Finally, we present a data structure to encode in a progressive and lossless way the generated sequence. Tests with several datasets show that the proposed method produces smaller storage sizes and good quality approximations compared with other methods that also produce bounding objects.
               
            

@&#INTRODUCTION@&#

The growing size and complexity of datasets affects not only the computation speed of their characteristics, but also their disk storage and rendering efficiency. Simplification techniques can diminish these problems. Moreover, in some situations it is advantageous to exchange an exact geometric representation of an object for an approximated one, which can be processed more efficiently. Bounding structures are widely used in model simplification to accelerate or improve some tasks such as collision detection, distance computation or any basic set membership operation. The most used bounding structure is the minimum axis-aligned bounding box (AABB) although other structures are used such as spheres, oriented boxes or convex polyhedra.

We present a new approach to simplify objects, which is restricted to orthogonal pseudo-polyhedra (OPP) and therefore it can be applied to 3D binary digital images or binary volume datasets as they can be represented by OPP. From an initial OPP, the method computes a level-of-detail (LOD) sequence of bounding volumes that are also OPP. The sequence is finite and ends with a convex OPP that is the AABB of all the sequence. We will denote as BOPP (bounding OPP) such bounding structures. BOPP satisfy basically two properties: (1) any BOPP contains the previous one and, therefore, all of them completely contain the original object and (2) all of the BOPP, as well as the original object, have the same AABB.

OPP are represented by the Extreme Vertices Model (EVM) and the simplification is achieved using a new approach we call merging faces, which displaces sets of faces and merges them by applying 2D Boolean operations. Our approach deals with general 3D orthogonal objects with any number of shells, cavities and through holes. We analyze different strategies suitable for merging faces and we also develop a technique that relies on the object continuity in order to get a better shape preservation by avoiding abrupt changes. Finally, we propose a data structure that allows encoding in a progressive and lossless way the generated BOPP sequence. The method has been tested with several datasets and compared with several methods that also produce bounding objects, showing good quality of the approximations and smaller storage sizes.

@&#RELATED WORK@&#

Model simplification has been extensively applied to triangular meshes [13]. Some of these techniques have been extended to tetrahedral meshes and use a methodology to evaluate the approximation error and the quality of the obtained mesh [12]. Methods for LOD sequences of triangular and tetrahedral meshes can also be found extensively in the literature [45,53]. There also exist methods to simplify quadrilateral meshes [25,51].

In contrast to these methods, that rely on geometric operations such as edge-collapse or clustering, the simplification can follow other strategies. Morphological operators like filleting and rounding, equivalent to opening and closing, can be used to simplify 2D binary images as well as 3D triangular meshes [58]. Alternative representations can be used such as octrees [5,48,54] in such a way that the geometry as well as the topology can be simplified, or BSP [27] obtaining a LOD sequence with a decreasing number of nodes. A carving strategy is applied to an octree model [54] as well as to a tetrahedral mesh [26] to simplify the topology. Simplification strategies have also been developed for B-Rep models [49] by removing connected sets of faces, and for point clouds [42].

There has been also an intensive research in surface simplification in a progressive and lossless way, applied specially to triangle meshes [3,23,35,39,41,43]. Early methods are called connectivity-driven, as they change progressively the connectivity [3,39]. Recent approaches for triangle meshes, called geometry-driven, perform an space partitioning by using intermediate structures as kd-trees [23] or octrees [35,41,43] in order to code the mesh. They obtain better compression rates and quality of the approximation, measured by some distance defined on the surface points [4].

Many of the aforementioned approaches provide approximations designed either to preserve the original topology between the original and the simplified object or just to obtain an approximated shape. Nevertheless, in some cases it is desirable to compute an approximation that is also a bounding volume. Bounding volumes are used in many applications such as collision detection [29], ray tracing [24,57], graphics interaction [28] and volume of interest computation [21].

Several works use classical bounding volumes, such as spheres [31,22] and AABB [50,60]. Nevertheless, other kinds of bounding volumes are used such as convex polytopes with faces oriented in a reduced set of orientations [32] or oriented polytopes that take into account the object velocity or dynamic collision detection [14]. Moreover, hybrid bounding volumes are also used. Bounding boxes are enhanced with planes computed from the intersection between two objects [56]. Slab cut balls built from a ball cut by a slab (intersection region between two parallel planes) present a good balance between tightness and testing costs [34], and an oriented bounding box tree, enhanced with bounding spheres at each node, is used to speed up collision detection applying the more efficient sphere test first to eliminate distant objects [11].

Orthogonal polyhedra have been proposed as geometric bounds for CSG because general set membership operations with them are very efficient [2]. However, in this work the authors present a Boolean operations algorithm using EVM, but do not present methods to compute bounding orthogonal polyhedra.

On the other hand, orthogonal polyhedra are used as bounding structures in a coarsening strategy [19]. In this work, orthogonal polyhedra are represented with the vertex-list representation [20], which stores a subset of vertices with a weight needed for orientation purposes. The authors present two simplification strategies. One of them, moving faces, performs face displacements but fails for objects with holes or more than one connected component. The other strategy, rectangle pairs does not have this restriction and performs a partition of the object in boxes, takes them in pairs, obtaining the AABB of this pairs, and finally performs the union of these AABB.

Some methods produce bounding volume hierarchies of polygonal meshes for fast collision detection between massive models [59] and for haptic rendering [38]. Other methods produce a hierarchy of polygonal convex volumes (a shrink-wrap around the object) [27,37]. Meanwhile, orthogonally convex polygons can be computed as orthogonal hulls for 2D images [9]. An orthogonal polygon is orthogonally convex if any axis-parallel line intersects it in at most one line segment. This problem has been extended to orthogonally convex polyhedra [8]. Such convex polygons like the convex hull, are not suitable to simplify objects that are not close to a convex shape, i.e. objects with many concavities and holes.

Methods that generate bounding approximations evaluate the quality of the approximations as the tightness of the bounding volume with respect to the volume of the original object.

In this section, three methods that produce a progressive LOD sequence of bounding volumes are described in some detail. These methods are compared with the approach presented in this paper in Section 7.1.

The first method is a technique presented by Samet and Kochut [48] to progressively approximate and compress in a lossless way binary 3D objects represented by pointerless octrees. This method is forest-based and deals with the internal nodes to progressively transmit n blocks, where n is not longer than the minimum number of either black or white blocks in the octree. This pointerless octree is represented by its leaf nodes, where each leaf q is uniquely identified by the path leading from the root to q called locational code. This path is represented as a sequence of directional codes: 1–8 for each of the eight directions in the octree (UNW, UNE, USW, USE, DNW, DNE, DSW, DSE). The locational code for any node is an integer computed by a recursive function. In this method, not all the approximations are a bounding volume of the original object.

The second method is a progressive solid simplification approach for 3D objects represented by binary space partition (BSP), presented by Huang and Wang [27]. It produces a LOD sequence with a decreasing number of nodes by using a combination of two techniques: (1) a volume bounded convex simplification that collapses parts with small volumes into a simple convex volume enclosing the volumetric cells on the input object and (2) a plane collapse method which reduces the BSP tree depth ensuring that the input object is enclosed by the simplified BSP tree. In this way, from an initial object 
                              
                                 
                                    
                                       Γ
                                    
                                    
                                       0
                                    
                                 
                              
                           , a progressive sequence of simplified BSP trees, 
                              
                                 
                                    
                                       Γ
                                    
                                    
                                       i
                                    
                                 
                              
                           , can be computed, such that 
                              
                                 Ω
                                 (
                                 
                                    
                                       Γ
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ⊆
                                 Ω
                                 (
                                 
                                    
                                       Γ
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 )
                                 ,
                                 i
                                 =
                                 0
                                 …
                                 n
                                 -
                                 1
                              
                           , where 
                              
                                 Ω
                                 (
                                 
                                    
                                       Γ
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            is the space occupied by 
                              
                                 
                                    
                                       Γ
                                    
                                    
                                       i
                                    
                                 
                              
                           .

Finally, the third method is based on a structure called bounding-planes octree (BP-O) proposed by Melero et al. [37], which is based on an octree where each node contains a set of planes taken from the input polygonal model. These planes form a convex bounding volume that includes completely the portion of the 3D object contained in the node. The nodes only contain the indices of the planes and all the planes are stored in an external data structure accessed by the octree. The same idea applies to the final geometry, stored at leaf nodes. To construct the BP-O, the polygons are classified in a 3D grid first, then, they are assigned to each leaf node and all leaf nodes are grouped in order to have a minimum number of planes per node. After selecting the bounding planes at leafs, internal nodes are built by following the path from the root node to each leaf, computing their bounding planes in a bottom-up recursion. For progressive transmission, planes contained in low levels of the BP-O are sent first, and so on until leaf level.

@&#BACKGROUND@&#

Orthogonal polyhedra are two-manifold polyhedra with all their faces oriented in the three main axes. OPP are regular orthogonal polyhedra with a possible non-manifold boundary. OPP are a restricted class of polyhedra considering its geometry, but concerning topology OPP are general, as they present any number of shells, cavities and holes. General OPP are OPP with vertex coordinates having any value in 
                           
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                           
                        . Polycubes are a subset of OPP all of whose vertices have integer coordinates, formed by joining one or more equal cubes (voxels) face to face. The continuous analog of a 3D binary digital image is an OPP [30,33].

OPP have been used in 2D to represent the extracted polygons from numerical control data [40]. Some 3D applications of OPP are: general computer graphics applications such as geometric transformations and Boolean operations [1,10,20], virtual MIP without skeleton [47], direct skeleton computation (instead of iterative peeling techniques) [18,36], and orthogonal hull computation [8,9]. OPP have been also used in theory of hybrid systems to model the solutions of reachable states [10,17].

In this paper we represent 3D binary digital images with the Extreme Vertices Model (EVM).

Let Q be a finite set of points in 
                           
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                           
                        , the ABC-sorted set of Q is the set resulting from sorting Q according to A-coordinate, then to B-coordinate, and then to C-coordinate. Let P be an OPP, a brink is the maximal uninterrupted segment built out of a sequence of collinear and contiguous two-manifold edges of P and its ending vertices are called extreme vertices (EV). An OPP can be represented in a concise way with the ABC-sorted set of its EV and such representation scheme is called EVM. EVM is an implicit B-Rep model and therefore represents OPP unambiguously [55].

EVM only needs to store EV, with no additional information such as neighboring relations among vertices, edges, or faces, since all these elements can be computed from them. Therefore, the storage requirements for an OPP P in its EVM representation is 
                           
                              O
                              (
                              n
                              )
                              ,
                              
                              n
                           
                         being the number of EV, and 
                           
                              n
                              ⩽
                              v
                           
                        , where v is the total number of vertices.

Let P be an OPP and 
                           
                              
                                 
                                    Π
                                 
                                 
                                    c
                                 
                              
                           
                         a plane whose normal is parallel, without loss of generality, to the X axis, intersecting it at 
                           
                              x
                              =
                              c
                           
                        , where c ranges from 
                           
                              -
                              ∞
                           
                         to 
                           
                              ∞
                           
                        . Then, this plane sweeps the whole space as c varies within its range, intersecting P at some intervals. Let us assume that this intersection changes at 
                           
                              c
                              =
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              …
                              
                              ,
                              
                              
                                 
                                    c
                                 
                                 
                                    n
                                 
                              
                           
                        . More formally, 
                           
                              P
                              ∩
                              
                                 
                                    Π
                                 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    δ
                                 
                              
                              
                              ≠
                              
                              P
                              ∩
                              
                                 
                                    Π
                                 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    δ
                                 
                              
                              ,
                              
                              ∀
                              i
                              =
                              1
                              ,
                              
                              …
                              
                              ,
                              
                              n
                           
                        , where 
                           
                              δ
                           
                         is an arbitrarily small quantity. Then, 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              (
                              P
                              )
                              =
                              P
                              ∩
                              
                                 
                                    Π
                                 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         is called a cut of P and 
                           
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              (
                              P
                              )
                              =
                              P
                              ∩
                              
                                 
                                    Π
                                 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          s
                                       
                                    
                                 
                              
                              ,
                              
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              <
                              
                                 
                                    c
                                 
                                 
                                    s
                                 
                              
                              <
                              
                                 
                                    c
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                           
                        , is called a section of P. Two cuts bounding a section 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                           
                         are called consecutive cuts. See Fig. 1
                        .

Sections can be computed from cuts and vice versa:
                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       P
                                       )
                                    
                                    
                                       ‾
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       P
                                       )
                                    
                                    
                                       ‾
                                    
                                 
                                 =
                                 ∅
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       P
                                       )
                                    
                                    
                                       ‾
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             i
                                             -
                                             1
                                          
                                       
                                       (
                                       P
                                       )
                                    
                                    
                                       ‾
                                    
                                 
                                 
                                    
                                       ⊗
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       P
                                       )
                                    
                                    
                                       ‾
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 =
                                 1
                                 …
                                 n
                                 -
                                 1
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       P
                                       )
                                    
                                    
                                       ‾
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             i
                                             -
                                             1
                                          
                                       
                                       (
                                       P
                                       )
                                    
                                    
                                       ‾
                                    
                                 
                                 
                                    
                                       ⊗
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       P
                                       )
                                    
                                    
                                       ‾
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 =
                                 1
                                 …
                                 n
                              
                           
                        where n is the number of cuts and 
                           
                              ⊗
                           
                         denotes the xor operation. Overline symbolizes the project operator, that projects a d-dimensional set of vertices lying on an orthogonal plane, like a cut or a section, onto the corresponding main plain, discarding their dth coordinate. The star exponent∗ denotes a regularized Boolean operation. A regularized set is defined as the closure of its interior. Regularized Boolean operations are needed to ensure 3D homogeneity [52].

Eq. (3) can be rewritten by expressing the 
                           
                              
                                 
                                    ⊗
                                 
                                 
                                    ∗
                                 
                              
                           
                         operation as the union of differences: 
                           
                              ∀
                              i
                              =
                              1
                              ,
                              
                              …
                              
                              ,
                              
                              n
                           
                        :
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       P
                                       )
                                    
                                    
                                       ‾
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             i
                                             -
                                             1
                                          
                                       
                                       (
                                       P
                                       )
                                    
                                    
                                       ‾
                                    
                                 
                                 
                                    
                                       -
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       P
                                       )
                                    
                                    
                                       ‾
                                    
                                 
                                 )
                                 
                                    
                                       ∪
                                    
                                    
                                       ∗
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       P
                                       )
                                    
                                    
                                       ‾
                                    
                                 
                                 
                                    
                                       -
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             i
                                             -
                                             1
                                          
                                       
                                       (
                                       P
                                       )
                                    
                                    
                                       ‾
                                    
                                 
                                 )
                              
                           
                        and any cut can be decomposed into its forward difference (FD) and backward difference (BD):
                           
                              (5)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         FD
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   (
                                                   P
                                                   )
                                                
                                                
                                                   ‾
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         i
                                                         -
                                                         1
                                                      
                                                   
                                                   (
                                                   P
                                                   )
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   -
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   (
                                                   P
                                                   )
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         BD
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   (
                                                   P
                                                   )
                                                
                                                
                                                   ‾
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   (
                                                   P
                                                   )
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   -
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         i
                                                         -
                                                         1
                                                      
                                                   
                                                   (
                                                   P
                                                   )
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        
                           
                              
                                 
                                    FD
                                 
                                 
                                    i
                                 
                              
                              (
                              P
                              )
                           
                         is the set of 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              (
                              P
                              )
                           
                         faces whose normal vector points to the positive side of the coordinate axis perpendicular to 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              (
                              P
                              )
                           
                        , and 
                           
                              
                                 
                                    BD
                                 
                                 
                                    i
                                 
                              
                              (
                              P
                              )
                           
                         is the set of faces whose normal vector points to the negative side (see Fig. 1 top). This property guarantees the correct orientation of faces and the computation of the non-EV.

General EVM Boolean operations are carried out by applying recursively (in nD) the same Boolean operation over the (n
                        −1) D OPP sections. The base case performs this operation in 1D. The xor operation is even faster, 
                           
                              EVM
                              (
                              P
                              
                                 
                                    ⊗
                                 
                                 
                                    ∗
                                 
                              
                              Q
                              )
                              =
                              EVM
                              (
                              P
                              )
                              
                                 
                                    ⊗
                                 
                                 
                                    ∗
                                 
                              
                              EVM
                              (
                              Q
                              )
                           
                        , i.e., it is a simple point-wise xor, without section computation. For more details concerning EVM see [2,46]. Although EVM has been extended to nD [44], in this paper we deal with dimension 
                           
                              n
                              ⩽
                              3
                           
                        .

The idea of the merging faces strategy is to work with pairs of consecutive cuts of an OPP, where for each cut of a pair, a displacement of its faces in the direction of their corresponding normal vector is applied and, then, the displaced faces are merged with those faces of the other cut with the same normal vector. We define as 
                           
                              B
                              (
                              P
                              )
                           
                        , the bounding OPP (BOPP) of an OPP P obtained with the merging faces strategy.

Formally, let P be an OPP and let 
                           
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                           
                         be two consecutive cuts of P and 
                           
                              
                                 
                                    FD
                                 
                                 
                                    A
                                 
                              
                              ,
                              
                              
                                 
                                    BD
                                 
                                 
                                    A
                                 
                              
                              ,
                              
                              
                                 
                                    FD
                                 
                                 
                                    B
                                 
                              
                           
                         and 
                           
                              
                                 
                                    BD
                                 
                                 
                                    B
                                 
                              
                           
                         their corresponding forward and backward differences (see Eq. (5)). To obtain a coarsened OPP, the merging faces process displaces 
                           
                              
                                 
                                    BD
                                 
                                 
                                    B
                                 
                              
                           
                         to the position of 
                           
                              
                                 
                                    BD
                                 
                                 
                                    A
                                 
                              
                           
                         and displaces 
                           
                              
                                 
                                    FD
                                 
                                 
                                    A
                                 
                              
                           
                         to the position of 
                           
                              
                                 
                                    FD
                                 
                                 
                                    B
                                 
                              
                           
                        . Then, the new cuts 
                           
                              
                                 
                                    newC
                                 
                                 
                                    A
                                 
                              
                           
                         and 
                           
                              
                                 
                                    newC
                                 
                                 
                                    B
                                 
                              
                           
                         that represent the merged faces and replace 
                           
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                           
                         respectively in the input object, are computed according to the next equation:
                           
                              (6)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         newC
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         BD
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   ∪
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         BD
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         newC
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         FD
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   ∪
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         FD
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The merging process displaces faces in the direction of their respective normal vector, i.e., outward of the object, but only those faces in which this displacement goes to the consecutive cut (faces 
                           
                              
                                 
                                    FD
                                 
                                 
                                    A
                                 
                              
                           
                         of 
                           
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                           
                         and 
                           
                              
                                 
                                    BD
                                 
                                 
                                    B
                                 
                              
                           
                         of 
                           
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                           
                        ) and then performs the union of these displaced faces with the remaining faces of each cut which have the same normal vector (
                           
                              
                                 
                                    FD
                                 
                                 
                                    B
                                 
                              
                           
                         of 
                           
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                           
                         and 
                           
                              
                                 
                                    BD
                                 
                                 
                                    A
                                 
                              
                           
                         of 
                           
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                           
                        , respectively).

If P is represented as an ABC-sorted EVM, for a single traversal of cuts the application of this process only will coarsen P in the A-coordinate. Therefore, to obtain 
                           
                              B
                              (
                              P
                              )
                           
                         the process must be repeated for the other two main directions. Fig. 2
                         shows a 2D example where the process is applied for the two main directions. Observe that the result can be slightly different depending on the ordering in which the three main directions are selected. In order to speed up the computation, the best first candidate would be the ABC-ordering with A-axis having less number of cuts, but as EVM does not report this value, it can be approximated by 
                           
                              
                                 
                                    c
                                 
                                 
                                    n
                                 
                              
                              -
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    c
                                 
                                 
                                    n
                                 
                              
                           
                         being respectively the coordinates of the first and last cut in this direction.

Although non-extreme vertices are not stored in EVM, when cuts are decomposed in forward and backward differences, they appear and the merging faces strategy deals correctly with them. For instance, Fig. 2(a) has a non-extreme vertex in 
                           
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                           
                         that shows up when 
                           
                              
                                 
                                    BD
                                 
                                 
                                    B
                                 
                              
                           
                         and 
                           
                              
                                 
                                    FD
                                 
                                 
                                    B
                                 
                              
                           
                         are computed and that appears in 
                           
                              
                                 
                                    newC
                                 
                                 
                                    B
                                 
                              
                           
                         (Fig. 2(b)).

Since the displacements are done outward of the object, and are restricted by the cuts of the initial object, the resulting OPP will never extend beyond these cuts and, therefore, will contain the initial object. This process satisfies the subset property for bounding structures, i.e. 
                           
                              P
                              ⊆
                              B
                              (
                              P
                              )
                           
                        .

An OPP may have any number of rings on faces, through holes and shells (cavities or connected components). In a general OPP, Eq. (6) does not give the desirable result. For example, applying this equation to the pair of cuts depicted in Fig. 3
                        (a), the same OPP without coarsening is obtained. Notice that a hole in 2D is equivalent to a cavity in 3D. To deal with this issue, we first detect and then close the void spaces.

Given the pair of consecutive cuts 
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                           
                        ), 
                           
                              
                                 
                                    BD
                                 
                                 
                                    A
                                 
                              
                           
                         and 
                           
                              
                                 
                                    BD
                                 
                                 
                                    B
                                 
                              
                           
                         are sets of faces whose normal vectors point to the opposite direction of 
                           
                              
                                 
                                    FD
                                 
                                 
                                    A
                                 
                              
                           
                         and 
                           
                              
                                 
                                    FD
                                 
                                 
                                    B
                                 
                              
                           
                        , but only the pair formed by 
                           
                              
                                 
                                    FD
                                 
                                 
                                    A
                                 
                              
                           
                         and 
                           
                              
                                 
                                    BD
                                 
                                 
                                    B
                                 
                              
                           
                         can represent a void space between the cuts. Therefore, a void space (vS) is given by the intersection of their projections, i.e.:
                           
                              (7)
                              
                                 vS
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       A
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       B
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             FD
                                          
                                          
                                             A
                                          
                                       
                                    
                                    
                                       ‾
                                    
                                 
                                 
                                    
                                       ∩
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       
                                          
                                             BD
                                          
                                          
                                             B
                                          
                                       
                                    
                                    
                                       ‾
                                    
                                 
                              
                           
                        
                     

The removal of vS from both 
                           
                              
                                 
                                    newC
                                 
                                 
                                    A
                                 
                              
                           
                         and 
                           
                              
                                 
                                    newC
                                 
                                 
                                    B
                                 
                              
                           
                        , closes the void space between 
                           
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                           
                        . Then, Eq. (6) is extended with Eq. (7):
                           
                              (8)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         newC
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  BD
                                                               
                                                               
                                                                  A
                                                               
                                                            
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                      
                                                         
                                                            ∪
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  BD
                                                               
                                                               
                                                                  B
                                                               
                                                            
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   -
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  FD
                                                               
                                                               
                                                                  A
                                                               
                                                            
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                      
                                                         
                                                            ∩
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  BD
                                                               
                                                               
                                                                  B
                                                               
                                                            
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         newC
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  FD
                                                               
                                                               
                                                                  A
                                                               
                                                            
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                      
                                                         
                                                            ∪
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  FD
                                                               
                                                               
                                                                  B
                                                               
                                                            
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   -
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  FD
                                                               
                                                               
                                                                  A
                                                               
                                                            
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                      
                                                         
                                                            ∩
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  BD
                                                               
                                                               
                                                                  B
                                                               
                                                            
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

When 
                           
                              vS
                              =
                              ∅
                           
                        , Eqs. (8) and (6) are equivalent. As this last operation contributes just to close interior void spaces, the subset property is still guaranteed. Fig. 3 shows an example with a single hole. In Fig. 3(a) 
                           
                              
                                 
                                    
                                       
                                          FD
                                       
                                       
                                          A
                                       
                                    
                                 
                                 
                                    ‾
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          BD
                                       
                                       
                                          B
                                       
                                    
                                 
                                 
                                    ‾
                                 
                              
                           
                         and 
                           
                              vS
                              (
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       
                                          FD
                                       
                                       
                                          A
                                       
                                    
                                 
                                 
                                    ‾
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          BD
                                       
                                       
                                          B
                                       
                                    
                                 
                                 
                                    ‾
                                 
                              
                           
                        . Then, applying Eq. (8), 
                           
                              
                                 
                                    newC
                                 
                                 
                                    B
                                 
                              
                              =
                              ∅
                           
                         and the hole is closed (Fig. 3(b)). As shows Eq. (8), basic merging and void space removal are performed at once. Note that the simple removal of the void space would have the same effect that the closing morphological operation.

In 3D, all types of void space between cuts are detected as those shown in Fig. 4
                        . There are cases in which the void space is not detected in all three directions, but is always detected in one or two of them. For example, in Fig. 4(a) and (b) the void space is not detected in Y-direction but is detected either in X or Z-direction. However, there are other cases in which the void space is detected in all directions. In Fig. 4(c) a void space is detected in X or Y-direction and the through hole is partially closed, i.e., only the space between the processed cuts gets closed, and the whole through hole will be closed in the next direction; but, if we begin with Z-direction, the detected void space allows to close the whole through hole. The cavity depicted in Fig. 4(d) will be closed in any direction.

Although there are cases, as the simple concavity in Fig. 4(a), that could be solved with the application of Eq. (6), for general void spaces, as those in Fig. 4(b)–(d), Eq. (8) must be applied in order to completely close the hole. Fig. 5
                        (a) shows a 3D example with through holes. Applying Eq. (8) in X-direction, the computed new cuts, 
                           
                              
                                 
                                    newC
                                 
                                 
                                    A
                                 
                              
                              =
                              ∅
                           
                         and 
                           
                              
                                 
                                    newC
                                 
                                 
                                    B
                                 
                              
                           
                         (Fig. 5(c)) partially close the hole, resulting in an object with a concavity (Fig. 5(d)), which will be closed in the next direction.

Two EVM properties, that state that for two special cases union and difference consist in simple point-wise xor operations [2], together with two EVM theorems, permit to rewrite Eq. (8) in a way faster to compute.
                           
                              •
                              
                                 Property 1: Let P and Q be two OPP such that 
                                    
                                       P
                                       
                                          
                                             ∩
                                          
                                          
                                             ∗
                                          
                                       
                                       Q
                                       =
                                       ∅
                                    
                                 , having 
                                    
                                       EVM
                                       (
                                       P
                                       )
                                    
                                  and 
                                    
                                       EVM
                                       (
                                       Q
                                       )
                                    
                                  as their models, then 
                                    
                                       EVM
                                       (
                                       P
                                       
                                          
                                             ∪
                                          
                                          
                                             ∗
                                          
                                       
                                       Q
                                       )
                                       =
                                       EVM
                                       (
                                       P
                                       )
                                       
                                          
                                             ⊗
                                          
                                          
                                             ∗
                                          
                                       
                                       EVM
                                       (
                                       Q
                                       )
                                    
                                 .


                                 Property 2: Let P and Q be two OPP such that 
                                    
                                       P
                                       ⊇
                                       Q
                                    
                                 , with 
                                    
                                       EVM
                                       (
                                       P
                                       )
                                    
                                  and 
                                    
                                       EVM
                                       (
                                       Q
                                       )
                                    
                                  as their models, then 
                                    
                                       EVM
                                       (
                                       P
                                       
                                          
                                             -
                                          
                                          
                                             ∗
                                          
                                       
                                       Q
                                       )
                                       =
                                       EVM
                                       (
                                       P
                                       )
                                       
                                          
                                             ⊗
                                          
                                          
                                             ∗
                                          
                                       
                                       EVM
                                       (
                                       Q
                                       )
                                    
                                 .


                              The projection of FD and BD of two consecutive cuts (
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          A
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          C
                                       
                                       
                                          B
                                       
                                    
                                 
                              
                              ) are quasi-disjoint sets respectively, i.e. 
                              
                                 
                                    
                                       
                                          
                                             
                                                FD
                                             
                                             
                                                A
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ∩
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                FD
                                             
                                             
                                                B
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    =
                                    ∅
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          
                                             
                                                BD
                                             
                                             
                                                A
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ∩
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                BD
                                             
                                             
                                                B
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    =
                                    ∅
                                 
                              
                              .
                           

The proof is based on the Jordan theorem and the fact that any ray crossing the boundary of the polyhedron, alternatively goes from outside to inside and vice versa. Therefore, in any OPP, assuming that 
                                 
                                    
                                       
                                          
                                             
                                                FD
                                             
                                             
                                                A
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ∩
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                FD
                                             
                                             
                                                B
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                    ≠
                                    
                                    ∅
                                 
                              , would mean that a ray could cross 
                                 
                                    
                                       
                                          FD
                                       
                                       
                                          A
                                       
                                    
                                 
                               going outside and then cross 
                                 
                                    
                                       
                                          FD
                                       
                                       
                                          B
                                       
                                    
                                 
                               going outside again, which is a contradiction. The same reasoning applies to BD.□


                              
                                 
                                    vS
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          A
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          B
                                       
                                    
                                    )
                                    ⊆
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         BD
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   ∪
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         BD
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    vS
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          A
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          B
                                       
                                    
                                    )
                                    ⊆
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         FD
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   ∪
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         FD
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           

From Eq. (7), 
                                 
                                    vS
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          A
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          B
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                FD
                                             
                                             
                                                A
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ∩
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                BD
                                             
                                             
                                                B
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                 
                              . Without loss of generality:
                                 
                                    (
                                    
                                       
                                          
                                             
                                                FD
                                             
                                             
                                                A
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ∩
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                BD
                                             
                                             
                                                B
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    )
                                    ⊆
                                    
                                       
                                          
                                             
                                                BD
                                             
                                             
                                                B
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    ⊆
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         BD
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   ∪
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         BD
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                       
                                    
                                 
                              , and thus,
                                 
                                    (
                                    
                                       
                                          
                                             
                                                FD
                                             
                                             
                                                A
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ∩
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                BD
                                             
                                             
                                                B
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    )
                                    ⊆
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         BD
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   ∪
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         BD
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                       
                                    
                                 
                              . In a similar way 
                                 
                                    vS
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          A
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          B
                                       
                                    
                                    )
                                    ⊆
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         FD
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   ∪
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         FD
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                       
                                    
                                 
                               can be proved.□

According to these theorems and the aforementioned EVM properties, Eq. (8) can be rewritten as:
                           
                              (9)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         newC
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         BD
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   ⊗
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         BD
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   ⊗
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  FD
                                                               
                                                               
                                                                  A
                                                               
                                                            
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                      
                                                         
                                                            ∩
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  BD
                                                               
                                                               
                                                                  B
                                                               
                                                            
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         newC
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         FD
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   ⊗
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         FD
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   ⊗
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  FD
                                                               
                                                               
                                                                  A
                                                               
                                                            
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                      
                                                         
                                                            ∩
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  BD
                                                               
                                                               
                                                                  B
                                                               
                                                            
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

So far, we have said that the merging faces process takes pairs of consecutive cuts for a single traversal of cuts in any main direction. However, we must establish the way and order in which such pairs are selected. We have examined four alternatives, which are explained below with 2D examples. In all of them, we consider a traversal for the XY-sorting EVM, taking cuts from lowest to highest value in the X-coordinate and supposing that there are n cuts.


                        Alternative 1. The first alternative consists in taking cuts two by two 
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                              =
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                              =
                              
                                 
                                    C
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              )
                              ,
                              
                              i
                              =
                              1
                              ,
                              
                              i
                              <
                              n
                              ,
                              
                              i
                              =
                              i
                              +
                              2
                           
                        , i.e. first the pair 
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        , then 
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    4
                                 
                              
                              )
                           
                        , and so on. This alternative seems to be the most natural and has the particularity that, although all cuts are taken into account in a single traversal, those sections between cuts that are not considered as a pair (for instance 
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    3
                                 
                              
                              )
                           
                        ) are not modified in the resulting object (see Theorem 3 at the end of this section). See Fig. 6
                        (a).


                        Alternative 2. In this alternative, pairs of cuts are taken in a chained form: 
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                              =
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                              =
                              
                                 
                                    C
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              )
                              ,
                              
                              i
                              =
                              1
                              ,
                              
                              i
                              <
                              n
                              ,
                              
                              i
                              =
                              i
                              +
                              1
                           
                        , i.e., first the pair 
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        , then 
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    3
                                 
                              
                              )
                           
                        , and so on. In this alternative as we consider each possible pair of cuts, all the cuts as well as all the sections are modified. However, this alternative fails to create a valid object after applying Eq. (9). This is due to the fact that 
                           
                              
                                 
                                    newC
                                 
                                 
                                    i
                                 
                              
                           
                         is, in general, different when it is computed from the pair 
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    i
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         than from the pair 
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              )
                           
                        .


                        Alternative 3. This case also considers pairs of cuts in a chained form, but instead of taking the i-th cut as 
                           
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                           
                        , the 
                           
                              
                                 
                                    newC
                                 
                                 
                                    B
                                 
                              
                           
                         of the last step is taken. We start taking the pair 
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        , which generates the pair 
                           
                              (
                              
                                 
                                    newC
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    newC
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        , then we take 
                           
                              (
                              
                                 
                                    newC
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    3
                                 
                              
                              )
                           
                        , then 
                           
                              (
                              
                                 
                                    newC
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    4
                                 
                              
                              )
                           
                        , and so on. Note that only in the first step this alternative is similar to the previous ones, and like Alternative 2, each possible pair of cuts is taken into account, but as 
                           
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                           
                         is the 
                           
                              
                                 
                                    newC
                                 
                                 
                                    B
                                 
                              
                           
                         of the previous step, there are no conflicts to generate a valid object. However, this alternative has a cascading effect, where some faces are dramatically extended after each step. See Fig. 6(b).


                        Alternative 4 This alternative consists in modifying sections instead of pairs of cuts. We again consider pairs of cuts in a chained form, but instead of generating two new cuts, we only compute 
                           
                              
                                 
                                    newC
                                 
                                 
                                    A
                                 
                              
                           
                         using Eq. (9) and then we compute a new section from 
                           
                              
                                 
                                    newC
                                 
                                 
                                    A
                                 
                              
                           
                         and the previous section of the original object using Eq. (2), i.e.: 
                           
                              
                                 
                                    
                                       
                                          newS
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    ‾
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    ‾
                                 
                              
                              
                                 
                                    ⊗
                                 
                                 
                                    ∗
                                 
                              
                              
                                 
                                    
                                       
                                          newC
                                       
                                       
                                          A
                                       
                                    
                                 
                                 
                                    ‾
                                 
                              
                           
                        . Although this alternative seems to preserve the morphology of the object, the result is similar to a morphological dilation operation, and therefore, the object expands, quickly losing its appearance. See Fig. 6(c).

From these four alternatives, we have chosen Alternative 1 for the following reasons: Alternative 2 is discarded for not creating a valid object. Applying Alternative 3 the object is drastically deformed due to the cascading effect. Alternative 4 seems to preserve the morphology but the object expands. Fig. 7
                         shows the results after running the different alternatives with one traversal for each one of the three main directions in the Binzilla dataset indicating the number of EV.
                           Theorem 3
                           
                              Let 
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          k
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                               
                              be two consecutive cuts of an OPP P that are not considered as a pair in the merging faces process, and let 
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          k
                                       
                                    
                                 
                               
                              be the section between them. The new section, 
                              
                                 
                                    
                                       
                                          newS
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              , between the corresponding cuts 
                              
                                 
                                    
                                       
                                          newC
                                       
                                       
                                          k
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          newC
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                               
                              is not modified, i.e. 
                              
                                 
                                    
                                       
                                          newS
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          S
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              .
                           

The chosen approach to prove it is by induction.


                              Basis. If the first modified pair is 
                                 
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              , then, the first cuts that are not considered as pair are 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          3
                                       
                                    
                                 
                              , so, we show that 
                                 
                                    
                                       
                                          
                                             
                                                newS
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                 
                              . From Eqs. (2) and (3) can be inferred that: 
                                 
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          P
                                          )
                                       
                                       
                                          ‾
                                       
                                    
                                    =
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                    
                                    
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          P
                                          )
                                       
                                       
                                          ‾
                                       
                                    
                                 
                              .


                              
                                 
                                    ⇒
                                    
                                       
                                          
                                             
                                                newS
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                newC
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                newC
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                 
                              
                           

According to Eq. (9):


                              
                                 
                                    ⇒
                                    
                                       
                                          
                                             
                                                newS
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          
                                             
                                                BD
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                BD
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    vS
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    )
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                FD
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                FD
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    vS
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    )
                                 
                              
                           


                              
                                 
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                 
                               is an associative and commutative operator in EVM:


                              
                                 
                                    ⇒
                                    
                                       
                                          
                                             
                                                newS
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          
                                             
                                                BD
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                FD
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    )
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                BD
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                FD
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    )
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    (
                                    vS
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    vS
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    )
                                 
                              
                           

By definitions of backward and forward differences:


                              
                                 
                                    ⇒
                                    
                                       
                                          
                                             
                                                newS
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                 
                              
                           


                              
                                 
                                    ⇒
                                    
                                       
                                          
                                             
                                                newS
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                 
                              
                           


                              Inductive step. Let 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          k
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                               be two consecutive cuts that are not considered as a pair, we assume that 
                                 
                                    
                                       
                                          newS
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          S
                                       
                                       
                                          k
                                       
                                    
                                 
                              . So, the next pair that can be processed is 
                                 
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          k
                                          +
                                          2
                                       
                                    
                                    )
                                 
                              , in this way, 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          k
                                          +
                                          2
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          k
                                          +
                                          3
                                       
                                    
                                 
                               will not be considered as a pair. Now we show that 
                                 
                                    
                                       
                                          
                                             
                                                newS
                                             
                                             
                                                k
                                                +
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                k
                                                +
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                 
                              .


                              
                                 
                                    
                                       
                                          
                                             
                                                newS
                                             
                                             
                                                k
                                                +
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    =
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                    
                                    
                                       
                                       
                                          k
                                          +
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                newC
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                 
                              
                           


                              
                                 
                                    ⇒
                                    
                                       
                                          
                                             
                                                newS
                                             
                                             
                                                k
                                                +
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                newS
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                newC
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                newC
                                             
                                             
                                                k
                                                +
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                 
                              .

Similar to the basis step:


                              
                                 
                                    ⇒
                                    
                                       
                                          
                                             
                                                newS
                                             
                                             
                                                k
                                                +
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                newS
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                BD
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                BD
                                             
                                             
                                                k
                                                +
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    vS
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          k
                                          +
                                          2
                                       
                                    
                                    )
                                    )
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                FD
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                FD
                                             
                                             
                                                k
                                                +
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    vS
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          k
                                          +
                                          2
                                       
                                    
                                    )
                                    )
                                 
                              
                           


                              
                                 
                                    ⇒
                                    
                                       
                                          
                                             
                                                newS
                                             
                                             
                                                k
                                                +
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                newS
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                BD
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                FD
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    )
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                BD
                                             
                                             
                                                k
                                                +
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                FD
                                             
                                             
                                                k
                                                +
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    )
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    (
                                    vS
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          k
                                          +
                                          2
                                       
                                    
                                    )
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    vS
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          k
                                          +
                                          2
                                       
                                    
                                    )
                                    )
                                 
                              
                           


                              
                                 
                                    ⇒
                                    
                                       
                                          
                                             
                                                newS
                                             
                                             
                                                k
                                                +
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    =
                                    
                                       
                                          newS
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                k
                                                +
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    )
                                 
                              
                           

As 
                                 
                                    
                                       
                                          
                                             
                                                newS
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                 
                              .


                              
                                 
                                    ⇒
                                    
                                       
                                          
                                             
                                                newS
                                             
                                             
                                                k
                                                +
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    
                                       
                                          ⊗
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                k
                                                +
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                 
                              
                           


                              
                                 
                                    ⇒
                                    
                                       
                                          
                                             
                                                newS
                                             
                                             
                                                k
                                                +
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                k
                                                +
                                                2
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                 
                              
                              □

In the presented method, merging two consecutive cuts is performed in all their extension. However, there are parts of these cuts that are isolated and merging them could result in too abrupt changes.

Let 
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                              )
                           
                         be the pair of cuts to be merged, we will refer as isolated faces those faces of 
                           
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                           
                         disjoint with 
                           
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                           
                         (on a projecting plane) and vice versa. More formally: Let 
                           
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             A
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             A
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             A
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   A
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                              
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             B
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   B
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                              
                              
                                 
                                    I
                                 
                                 
                                    A
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             A
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             I
                                          
                                          
                                             A
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             I
                                          
                                          
                                             A
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   IA
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    I
                                 
                                 
                                    B
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             I
                                          
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             I
                                          
                                          
                                             B
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   IB
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         be the sets of faces of 
                           
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                              ,
                              
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                           
                         and the isolated faces of 
                           
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                           
                         respectively. The following conditions hold for faces of sets 
                           
                              
                                 
                                    I
                                 
                                 
                                    A
                                 
                              
                           
                         and 
                           
                              
                                 
                                    I
                                 
                                 
                                    B
                                 
                              
                           
                        :
                           
                              (10)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   A
                                                
                                             
                                             ⊆
                                             
                                                
                                                   C
                                                
                                                
                                                   A
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   B
                                                
                                             
                                             ⊆
                                             
                                                
                                                   C
                                                
                                                
                                                   B
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         A
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   ∩
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             =
                                             ∅
                                             ,
                                             
                                             ∀
                                             i
                                             =
                                             1
                                             …
                                             
                                                
                                                   n
                                                
                                                
                                                   IA
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         B
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   ∩
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             =
                                             ∅
                                             ,
                                             
                                             ∀
                                             i
                                             =
                                             1
                                             …
                                             
                                                
                                                   n
                                                
                                                
                                                   IB
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Removing isolated faces of the merging process results in a better approximation. The corresponding new values 
                           
                              
                                 
                                    FD
                                 
                                 
                                    A
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                              
                                 
                                    BD
                                 
                                 
                                    A
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                              
                                 
                                    FD
                                 
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                           
                         and 
                           
                              
                                 
                                    BD
                                 
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                           
                         involved in the merging process are computed as:
                           
                              (11)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         FD
                                                      
                                                      
                                                         A
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         FD
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   -
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   
                                                      
                                                         BD
                                                      
                                                      
                                                         A
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         BD
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   -
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         FD
                                                      
                                                      
                                                         B
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         FD
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   -
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   
                                                      
                                                         BD
                                                      
                                                      
                                                         B
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         BD
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   -
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        these values are used in Eq. (9) to generate 
                           
                              
                                 
                                    newC
                                 
                                 
                                    A
                                 
                                 
                                    ′
                                 
                              
                           
                         and 
                           
                              
                                 
                                    newC
                                 
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                           
                        , such that:
                           
                              (12)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         newC
                                                      
                                                      
                                                         A
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         BD
                                                      
                                                      
                                                         A
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   ⊗
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         BD
                                                      
                                                      
                                                         B
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   ⊗
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  FD
                                                               
                                                               
                                                                  A
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                      
                                                         
                                                            ∩
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  BD
                                                               
                                                               
                                                                  B
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         newC
                                                      
                                                      
                                                         B
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         FD
                                                      
                                                      
                                                         A
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   ⊗
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         FD
                                                      
                                                      
                                                         B
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   ⊗
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  FD
                                                               
                                                               
                                                                  A
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                      
                                                         
                                                            ∩
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  BD
                                                               
                                                               
                                                                  B
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        after that, the isolated faces must be reintegrated. This process can be accomplished with a union operation, however, by definition 
                           
                              
                                 
                                    I
                                 
                                 
                                    A
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                           
                         are disjoint sets and therefore, 
                           
                              
                                 
                                    I
                                 
                                 
                                    A
                                 
                              
                           
                         and 
                           
                              
                                 
                                    newC
                                 
                                 
                                    A
                                 
                                 
                                    ′
                                 
                              
                           
                         are also disjoint sets (the same applies to 
                           
                              
                                 
                                    I
                                 
                                 
                                    B
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                           
                         and 
                           
                              
                                 
                                    newC
                                 
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                           
                        ). Then, according to the EVM Property 2, an xor operation is performed instead.
                           
                              (13)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         newC
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         newC
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   ⊗
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         newC
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         newC
                                                      
                                                      
                                                         B
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                             
                                                
                                                   ⊗
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Fig. 8
                         shows an example where an isolated face (if) is depicted. Here, if remains in place, and only those faces that share either an edge or a vertex are taken into account throughout the merging faces process. The application of this technique does not affect to the aforementioned subset property (see Section 4.1) and produces better approximations, for instance see Fig. 9
                        .

Detecting isolated faces in 2D is straightforward by displacing the brinks in both cuts and checking for intersection. In the 3D case, the sets of elements to analyze are 2D faces, i.e., general orthogonal polygons. So, a different strategy is applied to individually separate each face of 
                           
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                           
                         to detect the isolated ones.

We have used the Compact Union of Disjoint Boxes CUDB representation [16], a compact partitioning obtained from the EVM, which can be thought as a special kind of cell decomposition like octrees, bintrees and BSP. CUDB is axis aligned like octrees and bintrees but the partition is done along the object geometry like BSP. Then, cuts 
                           
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                           
                         are converted to CUDB and their faces are extracted, and to check for intersection, we have implemented a 2D adjacency detection algorithm. See Algorithm 1 for details, where in the set of faces F, a face is a 2D-CUDB with two attributes, one of them is the cut to which the face belongs and the other one indicates whether the face has been intersected or not.
                           Algorithm 1
                           getIsolatedFaces 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: 
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      ,
                                                      
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                   
                                                 {Cuts (2D-EVM) to analyze}
                                          
                                          
                                             
                                                Output: 
                                                
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      ,
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                   
                                                 {Set of Isolated faces of 
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                   
                                                }
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         
                                                            obj
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      ←
                                                      EVMtoCUDB
                                                      (
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         
                                                            obj
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      ←
                                                      EVMtoCUDB
                                                      (
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      CCL
                                                      (
                                                      
                                                         
                                                            obj
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      )
                                                   
                                                 {Connected component labeling process}
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      CCL
                                                      (
                                                      
                                                         
                                                            obj
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      F
                                                      ←
                                                      extractFaces
                                                      (
                                                      
                                                         
                                                            ojb
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      )
                                                      ∪
                                                      extractFaces
                                                      (
                                                      
                                                         
                                                            ojb
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                detectAdjacency (F)
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      ←
                                                   
                                                 Faces in 
                                                   
                                                      F
                                                      ∈
                                                      
                                                         
                                                            obj
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                   
                                                 and not intersect.
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      ←
                                                   
                                                 Faces in 
                                                   
                                                      F
                                                      ∈
                                                      
                                                         
                                                            obj
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                   
                                                 and not intersect.
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      ←
                                                      CUDBtoEVM
                                                      (
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      ←
                                                      CUDBtoEVM
                                                      (
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

According to Alternative 1 for cuts selection, merging faces strategy takes cuts two by two, first the pair 
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        , then 
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    4
                                 
                              
                              )
                           
                        , and so on. But, observe the particular case in Fig. 5(b), where if 
                           
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                              =
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                              =
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                              
                                 
                                    newC
                                 
                                 
                                    A
                                 
                              
                           
                         and 
                           
                              
                                 
                                    newC
                                 
                                 
                                    B
                                 
                              
                           
                         will be exactly the same as 
                           
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                           
                         respectively. This is due to the fact that 
                           
                              
                                 
                                    FD
                                 
                                 
                                    A
                                 
                              
                              =
                              ∅
                           
                         and 
                           
                              
                                 
                                    BD
                                 
                                 
                                    B
                                 
                              
                              =
                              ∅
                           
                        , which is the condition that results in any displacement. The direct application of this condition to Eq. (9) shows this conclusion.

On the other hand, when the shape preservation technique is applied, there may be consecutive cuts with all its faces detected as isolated (see Fig. 10
                        ), in such cases, there will be no displacement.

Moreover, the merging process is controlled by a maximum displacement allowed, in such a way that only pairs of consecutive cuts that are at a distance less or equal than a displacement parameter, d, are actually merged. However, if the increment of d is too large, far apart consecutive cuts can be merged causing abrupt changes. Therefore, given the pair of cuts 
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                              =
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                              =
                              
                                 
                                    C
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              )
                           
                         the conditions to merge them are:
                           
                              (14)
                              
                                 (
                                 
                                    
                                       FD
                                    
                                    
                                       A
                                    
                                 
                                 
                                 ≠
                                 
                                 ∅
                                 
                                 or
                                 
                                 
                                    
                                       BD
                                    
                                    
                                       B
                                    
                                 
                                 
                                 ≠
                                 
                                 ∅
                                 )
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             Not
                                             
                                             all
                                             
                                             faces
                                             
                                             of
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   A
                                                
                                             
                                             
                                             and
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   B
                                                
                                             
                                             
                                             are
                                             
                                             isolated
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             distance
                                             (
                                             
                                                
                                                   C
                                                
                                                
                                                   A
                                                
                                             
                                             ,
                                             
                                                
                                                   C
                                                
                                                
                                                   B
                                                
                                             
                                             )
                                             ⩽
                                             d
                                          
                                       
                                    
                                 
                              
                           
                        
                     

If conditions in Exp. (14) are fulfilled, the pair 
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              )
                           
                         is processed with Eq. (13) to compute 
                           
                              
                                 
                                    newC
                                 
                                 
                                    A
                                 
                              
                           
                         and 
                           
                              
                                 
                                    newC
                                 
                                 
                                    B
                                 
                              
                           
                        , and the method continues, according to the selection criteria, with the pair 
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    i
                                    +
                                    2
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    i
                                    +
                                    3
                                 
                              
                              )
                           
                        . Otherwise 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                           
                         is copied directly to the simplified object and the method continues with the pair 
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    i
                                    +
                                    2
                                 
                              
                              )
                           
                        . Note that the asseveration of 
                           
                              
                                 
                                    I
                                 
                                 
                                    A
                                 
                              
                              =
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                           
                         is enough to determine that all faces are isolated, as it implicitly means that 
                           
                              
                                 
                                    I
                                 
                                 
                                    B
                                 
                              
                              =
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                           
                        , or vice versa.

Nevertheless, there may be cases where all faces of all the possible pairs of cuts in the object are isolated (see Fig. 10), which means that the method has no effect and the complete simplification process will never end. Therefore, in order to guarantee the property of finiteness, when all faces of a given pair of cuts are isolated, we do not apply the shape preservation technique and use Eq. (9) instead of Eq. (13) for such pair.
                           Algorithm 2
                           mergingFaces 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: 
                                                P {EVM represented OPP}
                                          
                                          
                                             
                                                Input: 
                                                sorting {ABC-sorting}
                                          
                                          
                                             
                                                Input: 
                                                d {Displacement parameter}
                                          
                                          
                                             
                                                Input: 
                                                displaceIF {Flag for isolated faces}
                                          
                                          
                                             
                                                Output: 
                                                Q {EVM represented simplified OPP}
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      P
                                                      .
                                                      setSorting
                                                      (
                                                      sorting
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      Q
                                                      ←
                                                      ∅
                                                      ,
                                                      
                                                      Q
                                                      .
                                                      setSorting
                                                      (
                                                      sorting
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      ←
                                                      P
                                                      .
                                                      getNextCut
                                                      (
                                                      )
                                                      ,
                                                      
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      ←
                                                      P
                                                      .
                                                      getNextCut
                                                      (
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            D
                                                         
                                                      
                                                      ←
                                                      P
                                                      .
                                                      getReverseCut
                                                      (
                                                      )
                                                      ,
                                                      
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            C
                                                         
                                                      
                                                      ←
                                                      P
                                                      .
                                                      getReverseCut
                                                      (
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                while 
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      
                                                      ≠
                                                      
                                                      ∅
                                                   
                                                 
                                                or 
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            C
                                                         
                                                      
                                                      
                                                      ≠
                                                      
                                                      ∅
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      process
                                                      ←
                                                   
                                                
                                                false
                                             
                                          
                                          
                                             
                                                
                                                if distance
                                                   
                                                      (
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      )
                                                      <
                                                      =
                                                      d
                                                      )
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             
                                                
                                                Compute 
                                                   
                                                      
                                                         
                                                            FD
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            BD
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            FD
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      
                                                      ≠
                                                      
                                                      ∅
                                                   
                                                 
                                                or 
                                                
                                                   
                                                      
                                                         
                                                            FD
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      
                                                      ≠
                                                      
                                                      ∅
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      getIsolatedFaces
                                                      (
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      
                                                      ≠
                                                      
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                   
                                                 
                                                then {Not all faces are isolated}
                                          
                                          
                                             
                                                
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            FD
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            FD
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      
                                                         
                                                            -
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      ,
                                                      
                                                      
                                                         
                                                            BD
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            BD
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      
                                                         
                                                            -
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            FD
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      
                                                      ≠
                                                      
                                                      ∅
                                                   
                                                 
                                                or 
                                                
                                                   
                                                      
                                                         
                                                            FD
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      
                                                      ≠
                                                      
                                                      ∅
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             
                                                
                                                
                                                Compute 
                                                   
                                                      
                                                         
                                                            FD
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            BD
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            FD
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            FD
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      
                                                         
                                                            -
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      ,
                                                      
                                                      
                                                         
                                                            BD
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            BD
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      
                                                         
                                                            -
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                
                                                   
                                                      process
                                                      ←
                                                   
                                                 
                                                true
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                end if
                                             
                                          
                                          
                                             
                                                
                                                
                                                else {All faces are isolated}
                                          
                                          
                                             
                                                
                                                
                                                
                                                if 
                                                displaceIF 
                                                then
                                             
                                          
                                          
                                             
                                                
                                                
                                                Compute 
                                                   
                                                      
                                                         
                                                            FD
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            BD
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                
                                                   
                                                      process
                                                      ←
                                                   
                                                 
                                                true
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                end if
                                             
                                          
                                          
                                             
                                                
                                                
                                                end if {isolated faces condition}
                                          
                                          
                                             
                                                
                                                
                                                end if {displacement condition}
                                          
                                          
                                             
                                                
                                                end if {distance condition}
                                          
                                          
                                             
                                                
                                                if 
                                                process 
                                                then {Formula application}
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      voidSpace
                                                      ←
                                                      
                                                         
                                                            FD
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      
                                                         
                                                            ∩
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      
                                                         
                                                            BD
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            newC
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            BD
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      
                                                         
                                                            ⊗
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      
                                                         
                                                            BD
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      
                                                         
                                                            ⊗
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      voidSpace
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            newC
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            FD
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      
                                                         
                                                            ⊗
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      
                                                         
                                                            FD
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      
                                                         
                                                            ⊗
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      voidSpace
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      
                                                      ≠
                                                      
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                   
                                                 
                                                then {Not all faces are isolated}
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            newC
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            newC
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      
                                                         
                                                            ⊗
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            newC
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            newC
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      
                                                         
                                                            ⊗
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                end if
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      Q
                                                      .
                                                      insertCut
                                                      (
                                                      
                                                         
                                                            newC
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      Q
                                                      .
                                                      insertCut
                                                      (
                                                      
                                                         
                                                            newC
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      ←
                                                      P
                                                      .
                                                      getNextCut
                                                      (
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      ←
                                                      P
                                                      .
                                                      getNextCut
                                                      (
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                else {Omit and copy cut}
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      Q
                                                      .
                                                      insertCut
                                                      (
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      ←
                                                      P
                                                      .
                                                      getNextCut
                                                      (
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                end if
                                             
                                          
                                          
                                             
                                                ∗∗∗Same for descending order with 
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            C
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            D
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                end while
                                             
                                          
                                       
                                    
                                 
                              
                           

Another issue that we have considered is that, if we start to analyze cuts in descending order along one main direction, the result is barely different with respect to the result in ascending order. Therefore, for symmetry preservation purposes the object is analyzed from both sides at a time. However, this symmetrical traversal does neither improve nor reduce the performance of the method.


                        Algorithm 2 shows the steps of the merging faces using a lazy evaluation strategy to improve its performance. A given OPP P is ABC-sorted according to a given sorting and then it is processed in A-direction with a given parameter of distance and a flag to indicate if cuts with all its faces as isolated are displaced or not.

According to the merging faces algorithm, when applying the shape preservation technique, if there are pairs of cuts with all its faces isolated, we have two options, one of them preserves the shape and the other one guarantees the finiteness of the method. Therefore, in order to take advantage of the shape preservation technique and still guarantee that the method ends, we propose first to perform three times the merging faces process, once per each main direction (having previously determined the best sorting) with a given parameter of distance d, and not allowing to displace isolated faces when all the faces are detected as such. Then, we perform three additional merging faces process with the same parameter d, but now allowing to displace the isolated faces.

Besides, we have observed that after applying the merging faces process in the three main directions with a given distance d, cuts with the same distance d between them may still remain. This is because some faces of the intermediate cuts that are not considered as pairs (see Sec. 4.4) or that were marked as isolated and not displaced, were not modified after the merging in the three main directions. So, with the aforementioned three additional traversals we obtain a good quality of the approximations while guaranteeing the finiteness property.

Let 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    0
                                 
                              
                           
                         be an initial OPP. A finite sequence 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    Φ
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                              …
                              
                              ,
                              
                              
                                 
                                    Φ
                                 
                                 
                                    p
                                 
                              
                           
                         of OPP can be generated, that fulfills the following properties:
                           
                              1.
                              
                                 
                                    
                                       
                                          
                                             Φ
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       =
                                       B
                                       (
                                       
                                          
                                             Φ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ,
                                       
                                       ∀
                                       i
                                       =
                                       0
                                       …
                                       p
                                       -
                                       1
                                    
                                 .


                                 
                                    
                                       
                                          
                                             Φ
                                          
                                          
                                             i
                                          
                                       
                                       ⊆
                                       B
                                       (
                                       
                                          
                                             Φ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ,
                                       
                                       ∀
                                       i
                                       =
                                       0
                                       …
                                       p
                                       -
                                       1
                                    
                                 , and, therefore, 
                                    
                                       
                                          
                                             Φ
                                          
                                          
                                             i
                                          
                                       
                                       ⊆
                                       
                                          
                                             Φ
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       ,
                                       
                                       ∀
                                       i
                                       =
                                       0
                                       …
                                       p
                                       -
                                       1
                                    
                                 .


                                 
                                    
                                       
                                          
                                             Φ
                                          
                                          
                                             p
                                          
                                       
                                       =
                                       AABB
                                       (
                                       
                                          
                                             Φ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ,
                                       
                                       ∀
                                       i
                                       =
                                       0
                                       …
                                       p
                                    
                                 .

The first property indicates that the approach is incremental. The second one is the subset property. The last property states that the sequence is finite and that ends with the AABB that is shared by all the OPP of the sequence. The AABB property can be demonstrated by considering that the AABB of an OPP can be defined as the intersection of the six planes corresponding to the first and last cut in the three main directions and the fact that the object will never extend beyond the initial cuts, and, in particular, the first and last ones. Moreover, we can observe that the first cut only has BD faces and the last one only FD faces. Then, in each iteration the first cut of 
                           
                              B
                              (
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         will be either the same of 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                              
                           
                         or the union between the first cut and the BD of the second cut of 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                              
                           
                        . Then, in the last iteration, the first cut of 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    p
                                 
                              
                           
                        , i.e. of the AABB, will correspond to the union of all the BD of all the cuts. The same reasoning applies for the last cut.

As the method is incremental, it actually computes all the objects between 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    k
                                 
                              
                           
                         for successive values of d, 
                           
                              d
                              =
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              i
                              =
                              1
                              ,
                              
                              …
                              
                              ,
                              
                              k
                           
                        , obtaining the corresponding 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                              
                           
                        . Displacements 
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                           
                         can be in any units and incremented in any quantity. For OPP corresponding to digital images the basic unit is one voxel, i.e. 
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              =
                              i
                           
                        . For general OPP, with float coordinate values, 
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                           
                         can take any values ranging from the minimum distance between cuts and the AABB size.

The input of the method is an EVM represented OPP, P, which corresponds to the initial object 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    0
                                 
                              
                           
                        , and there can be different kinds of queries as:
                           
                              •
                              Give the maximum value for the displacement, 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             max
                                          
                                       
                                    
                                 , i.e. the method performs iteratively the merging faces process and stops when 
                                    
                                       d
                                       >
                                       
                                          
                                             d
                                          
                                          
                                             max
                                          
                                       
                                    
                                 .

Give the maximum number of EV nv in the last BOPP, i.e. the sequence ends with the object 
                                    
                                       
                                          
                                             Φ
                                          
                                          
                                             k
                                          
                                       
                                    
                                 , which has no more than nv extreme vertices. In the particular case of ending with the AABB, i.e. 
                                    
                                       
                                          
                                             o
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       
                                          
                                             o
                                          
                                          
                                             p
                                          
                                       
                                       =
                                       AABB
                                       (
                                       P
                                       )
                                       ,
                                       
                                       nv
                                    
                                  must be 8.

Steps for the two queries in the proposed simplification method are shown in Algorithm 3 (maximum value for the displacement) and Algorithm 4 (maximum number of EV), where 
                           
                              get
                              _
                              nev
                           
                         function returns the number of EV of the corresponding object and detectBestSorting detects the best sorting (see Section 4.1). Note that Algorithm 3 performs 6 times the merging faces process per each distance. But, in Algorithm 4 the method can stop even if the last three merging faces processes for the same distance are not performed, since these intermediate objects are symmetrically coherent BOPP.
                           Algorithm 3
                           EVMSimplification1 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: 
                                                P {EVM represented OPP}
                                          
                                          
                                             
                                                Input: 
                                                
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            max
                                                         
                                                      
                                                   
                                                 {Maximum value for the displacement}
                                          
                                          
                                             
                                                Output: 
                                                Q {EVM represented BOPP}
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      Q
                                                      ←
                                                      P
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      detectBestSorting
                                                      (
                                                      ABCsort
                                                      ,
                                                      BACsort
                                                      ,
                                                      CABsort
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                for 
                                                
                                                   
                                                      d
                                                      ←
                                                      1
                                                   
                                                 
                                                to 
                                                
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            max
                                                         
                                                      
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             
                                                
                                                Q
                                                ←mergingFaces (Q, 
                                                   
                                                      ABCsort
                                                      ,
                                                      d
                                                   
                                                , false)
                                          
                                          
                                             
                                                
                                                Q
                                                ←mergingFaces (Q, 
                                                   
                                                      BACsort
                                                      ,
                                                      d
                                                   
                                                , false)
                                          
                                          
                                             
                                                
                                                Q
                                                ←mergingFaces (Q, 
                                                   
                                                      CABsort
                                                      ,
                                                      d
                                                   
                                                , false)
                                          
                                          
                                             
                                                
                                                Q
                                                ←mergingFaces (Q, 
                                                   
                                                      ABCsort
                                                      ,
                                                      d
                                                   
                                                , true)
                                          
                                          
                                             
                                                
                                                Q
                                                ←mergingFaces (Q, 
                                                   
                                                      BACsort
                                                      ,
                                                      d
                                                   
                                                , true)
                                          
                                          
                                             
                                                
                                                Q
                                                ←mergingFaces (Q, 
                                                   
                                                      CABsort
                                                      ,
                                                      d
                                                   
                                                , true)
                                          
                                          
                                             
                                                
                                                if 
                                                
                                                   
                                                      Q
                                                      .
                                                      Get
                                                      _
                                                      nev
                                                      (
                                                      )
                                                      =
                                                      8
                                                   
                                                 
                                                then break endif
                                             
                                          
                                          
                                             
                                                
                                                end for
                                             
                                          
                                       
                                    
                                 
                              
                           

EVMSimplification2 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: 
                                                P {EVM represented OPP}
                                          
                                          
                                             
                                                Input: 
                                                nv {Maximum number of EV in result}
                                          
                                          
                                             
                                                Output: 
                                                Q {EVM represented BOPP}
                                          
                                          
                                             
                                                
                                                   
                                                      Q
                                                      ←
                                                      P
                                                      ,
                                                      
                                                      displaceIF
                                                      ←
                                                   
                                                
                                                false, 
                                                   
                                                      d
                                                      ←
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      detectBestSorting
                                                      (
                                                      ABCsort
                                                      ,
                                                      BACsort
                                                      ,
                                                      CABsort
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                while 
                                                
                                                   
                                                      Q
                                                      .
                                                      get
                                                      _
                                                      nev
                                                      (
                                                      )
                                                      >
                                                      nv
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             
                                                Q
                                                ←mergingFaces 
                                                   
                                                      (
                                                      Q
                                                      ,
                                                      ABCsort
                                                      ,
                                                      d
                                                      ,
                                                      displaceIF
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                Q
                                                ←mergingFaces 
                                                   
                                                      (
                                                      Q
                                                      ,
                                                      BACsort
                                                      ,
                                                      d
                                                      ,
                                                      displaceIF
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                Q
                                                ←mergingFaces 
                                                   
                                                      (
                                                      Q
                                                      ,
                                                      CABsort
                                                      ,
                                                      d
                                                      ,
                                                      displaceIF
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                if 
                                                displaceIF 
                                                then 
                                                
                                                   
                                                      d
                                                      ←
                                                      d
                                                      +
                                                      1
                                                   
                                                 
                                                endif
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      displaceIF
                                                      ←
                                                      ¬
                                                      displaceIF
                                                   
                                                
                                             
                                          
                                          
                                             
                                                if 
                                                
                                                   
                                                      Q
                                                      .
                                                      Get
                                                      _
                                                      nev
                                                      (
                                                      )
                                                      =
                                                      8
                                                   
                                                 
                                                then break endif
                                             
                                          
                                          
                                             
                                                end while
                                             
                                          
                                       
                                    
                                 
                              
                           

The presented approach generates bounding volumes, where every object 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                           
                         bounds object 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                              
                           
                         as tightly as possible. We measure the quality (tightness) 
                           
                              Θ
                              (
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         of a BOPP 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                              
                           
                         as the volume difference between 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                              
                           
                         and the original OPP 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    0
                                 
                              
                           
                        , divided by the volume difference between the volume of the AABB (
                           
                              
                                 
                                    Φ
                                 
                                 
                                    p
                                 
                              
                           
                        ) and 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    0
                                 
                              
                           
                        , i.e.:
                           
                              (15)
                              
                                 Θ
                                 (
                                 
                                    
                                       Φ
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       V
                                       (
                                       
                                          
                                             Φ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       -
                                       V
                                       (
                                       
                                          
                                             Φ
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       V
                                       (
                                       
                                          
                                             Φ
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       -
                                       V
                                       (
                                       
                                          
                                             Φ
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 =
                                 0
                                 …
                                 p
                              
                           
                        where 
                           
                              V
                              (
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         is the volume of 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                              
                           
                         computed by summing the volumes of the slices (
                           
                              
                                 
                                    S
                                 
                                 
                                    k
                                 
                              
                           
                        ) in its EVM representation using the following expression [1]:
                           
                              (16)
                              
                                 V
                                 (
                                 P
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          nc
                                          -
                                          1
                                       
                                    
                                 
                                 Area
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 P
                                 )
                                 )
                                 ·
                                 dist
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 P
                                 )
                                 ,
                                 
                                 
                                    
                                       C
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 (
                                 P
                                 )
                              
                           
                        where nc is the number of cuts and dist the distance between consecutive cuts that define a slice. The area is recursively computed in a similar way in 2D, where the perimeter is given by the length of the EVM brinks.

This function is useful for indicating the distortion of the resulting BOPP, where 
                           
                              Θ
                              (
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              0
                           
                         means that 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                              
                           
                         is the original object 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    0
                                 
                              
                           
                         and 
                           
                              Θ
                              (
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              1
                           
                         means that 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                              
                           
                         is the AABB.

In this section we describe the Progressive Extreme Vertices Encoding (PEVE), a data structure that encodes a BOPP sequence in a progressive and lossless way, with a reduced storage size.

In its raw format, EVM represents vertices as 3D points. Then, a 3D OPP is represented with a set of 
                           
                              3
                              n
                           
                         values, n being the number of extreme vertices (EV). In storage size, this set occupies 
                           
                              3
                              nb
                           
                         bits, b being the number of bits to store a vertex coordinate.

EVM allows different schemes for data compression using the fact that EV are arranged in an ordered set of cuts [1]. There is not a general scheme since for each object it depends on its shape and the ABC-ordering. Considering an ABC-ordering, common A-coordinates, for EV lying on each A-cut, and common B-coordinates, for EV lying on each AB-cut, can be factored out. This compressed EVM uses two flags (2bits) per each vertex to indicate respectively if A and B-coordinate are factored out and thus, these values are not saved. Therefore, a vertex requires at most 
                           
                              3
                              b
                              +
                              2
                           
                         bits when no coordinate is factored out, and only 
                           
                              b
                              +
                              2
                           
                        
                        bits when both A and B-coordinates are factored out.

Throughout the merging faces process, there can be EV of object 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                              
                           
                         that remain in object 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                           
                        . Let 
                           
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                           
                         be a pair of consecutive cuts, the following sets of vertices are remaining vertices:
                           
                              •
                              Vertices belonging to 
                                    
                                       (
                                       EVM
                                       (
                                       
                                          
                                             
                                                
                                                   BD
                                                
                                                
                                                   A
                                                
                                             
                                          
                                          
                                             ‾
                                          
                                       
                                       )
                                       -
                                       EVM
                                       (
                                       
                                          
                                             
                                                
                                                   BD
                                                
                                                
                                                   B
                                                
                                             
                                          
                                          
                                             ‾
                                          
                                       
                                       )
                                       )
                                    
                                  or to 
                                    
                                       (
                                       EVM
                                       (
                                       
                                          
                                             
                                                
                                                   FD
                                                
                                                
                                                   B
                                                
                                             
                                          
                                          
                                             ‾
                                          
                                       
                                       )
                                       -
                                       EVM
                                       (
                                       
                                          
                                             
                                                
                                                   FD
                                                
                                                
                                                   A
                                                
                                             
                                          
                                          
                                             ‾
                                          
                                       
                                       )
                                       )
                                    
                                 . This fact can be proved by applying directly Eq. (9).

Vertices of the isolated faces of 
                                    
                                       
                                          
                                             BD
                                          
                                          
                                             A
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             FD
                                          
                                          
                                             B
                                          
                                       
                                    
                                  when the shape preservation technique is applied.

Therefore, PEVE encodes the sequence of objects in such a way that remaining vertices are stored only once. For instance, Fig. 11
                         depicts a 2D LOD sequence generated by the presented approach. For this dataset, the method produces 3 more objects. Note that there are some remaining EV. Fig. 12
                         depicts the sequence put together and each EV is labeled with the object numbers to which it belongs. Note that, although there are vertices that only appear once, there are also vertices that appear in two, three and even in the four objects. Moreover, most of these vertices appear in consecutive objects, and only one appears in non-consecutive objects. For instance, the vertex in the upper-left corner of the object appears in all the objects, the vertex in the bottom-right corner appears from object 1 to 3, while the vertex highlighted in yellow appears only in objects 0 and 2.

PEVE encodes EV of all objects into a single set, by storing, for any vertex coordinate, an indicator to which objects this EV belongs. For storage purposes, we classify EV into the next categories:
                           
                              Unique (U):
                              it appears once, i.e., it belongs only to one object 
                                    
                                       
                                          
                                             Φ
                                          
                                          
                                             i
                                          
                                       
                                    
                                  of the sequence.

it has a consecutive occurrence, i.e., it belongs to all objects in an object interval 
                                    
                                       [
                                       
                                          
                                             Φ
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             Φ
                                          
                                          
                                             j
                                          
                                       
                                       ]
                                    
                                 , 
                                    
                                       j
                                       >
                                       i
                                    
                                 .

it appears several times, either as an U or a C-vertex.

In a sporadic EV, the number of times it can appear is no more than two in 2D and four in 3D as the following theorem proves.
                           Theorem 4
                           
                              Let v be an EV in the LOD sequence, the number of non successive occurrences throughout the simplification process is no more than two in 2D, and four in 3D.
                           

The proof is performed by enumeration. Consider a 3D OPP embedded in a 3D grid in such a way that all OPP vertices coincide with grid vertices. A vertex v is classified according to the color black (B) or white (W) of its eight surrounding voxels. There are 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          8
                                       
                                    
                                    =
                                    256
                                 
                               combinations, which applying reflections and rotations may be grouped into 22 configurations. Eight of these configurations correspond to an EV and are those with an odd number of B and W surrounding voxels (see Fig. 13
                              ) while configurations with an even number of B and W voxels do not correspond to EV [1]. Taking into account that the merging faces process always displaces faces outward the object, i.e. it enlarges the object, we can gradually go from 0 to 8 surrounding voxels, and not vice versa. Therefore, in the worst case, if the number of surroundingvoxels of v changes step by step, v can be EV at most four times (in odd configurations). The 2D case can be proved with the same reasoning. □

Furthermore, experimental tests have yielded that sporadic vertices appear rather infrequently, less than 6% of all EV in the LOD sequence.

The next v-scheme will be used in PEVE. For every vertex 2bits are used to indicate its type, plus the following associated information that depends on the number of objects of the sequence, p:
                           
                              •
                              U-vertex: the object number to which it belongs, i.e. 
                                    
                                       
                                          
                                             log
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       p
                                       )
                                    
                                 
                                 bits.

C-vertex: the number of the first and last objects to which it belongs, i.e. 
                                    
                                       2
                                       
                                          
                                             log
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       p
                                       )
                                    
                                 
                                 bits.

S-vertex: 2bits to indicate the number of intervals, plus 1 bit for each interval to indicate its type, followed by the bits for the interval information. In the worst case an S-vertex can appear four times as C-vertex, i.e., it requires at most 
                                    
                                       2
                                       +
                                       4
                                       (
                                       1
                                       +
                                       2
                                       
                                          
                                             log
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       p
                                       )
                                       )
                                       =
                                       6
                                       +
                                       8
                                       
                                          
                                             log
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       p
                                       )
                                    
                                  bits.

In order to progressively decode or transmit the whole LOD sequence, PEVE must store first those EV that belong to object 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    p
                                 
                              
                           
                        , then to 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    p
                                    -
                                    1
                                 
                              
                           
                        , and so on. Therefore, EV are sorted in the following way:
                           
                              1.
                              First, according to the last object they belong in descending order.

Then by type (first S, then C, and then U-vertices).

Finally by its XYZ-coordinates in ascending order.

In this way, we can decode first vertices corresponding to the more simplified object and progressively decode objects with a better LOD, yielding at the end the lossless information of the original object 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    0
                                 
                              
                           
                        .

We group vertices by type since several U and C-vertices share the same v-scheme with other vertices of the same type. Then, using a flag (1bit) to indicate if the v-scheme is factored out, we avoid to store this information. The number of bits needed for a vertex coordinate is obtained from the resolution size of the dataset. Fig. 14
                         depicts this data structure.


                        Fig. 15
                         shows PEVE in ASCII format for the dataset shown in Fig. 11. The whole sequence has 76 vertices but only 51 vertices are encoded. After each vertex, letters U, C and S indicate the type, followed by its v-scheme; symbol ∗ indicates that v-scheme or a coordinate value is factored out. Moreover, observe that, when the first vertex whose last object is 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    0
                                 
                              
                           
                         appears (vertex 29), it is not necessary to save the v-scheme of the following vertices, as all of them are U-vertices belonging to 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    0
                                 
                              
                           
                        , and therefore, this information can be omitted in the encoding.

Following with this example and considering 4bits to code a vertex coordinate, vertex 5 is coded with 
                           
                              1
                              +
                              4
                              +
                              4
                              +
                              1
                              +
                              2
                              +
                              2
                              +
                              1
                              +
                              2
                              +
                              1
                              +
                              2
                              =
                              20
                           
                        
                        bits, vertex 13 with 
                           
                              1
                              +
                              4
                              +
                              4
                              +
                              1
                              +
                              2
                              +
                              2
                              +
                              2
                              =
                              16
                           
                        
                        bits, vertex 14 with 
                           
                              1
                              +
                              4
                              +
                              1
                              =
                              6
                           
                        , and vertex 30 with 
                           
                              1
                              +
                              4
                              =
                              5
                           
                        
                        bits. The whole LOD sequence requires 54 bytes. Encoding each object separately with the compressed EVM (see Section 6.1) requires 61bytes, and with EVM in its raw form (
                           
                              2
                              ×
                              4
                           
                        
                        bits per vertex), 76bytes. Therefore, in the first case the compression ratio is 0.88 and in the second case 0.71.

@&#EXPERIMENTAL RESULTS@&#

PEVE has been tested on several 3D datasets with different shape features such as size, number of connected components, concavities and holes. These datasets where obtained from the following public repositories: Aim@Shape, Models3d.ru, Stanford 3D Scanning, Czech Republic Sciences Academy and Czech TU, or own collection. The corresponding programs are written in C++ and have been tested on a PC Intel® Core 2 Duo CPU E6600@2.40GHz with 3.2GB RAM and running Linux.

We report here the results of simplification using Algorithm 4 with 
                        
                           nv
                           =
                           8
                        
                      and storing all intermediate objects with PEVE. Statistics and results in a compilation of nine datasets are listed in Table 1
                     . For each dataset it shows: size in voxels, number of extreme vertices (
                        
                           |
                           EV
                           |
                        
                     ) in the original dataset, maximum used distance (
                        
                           
                              
                                 d
                              
                              
                                 max
                              
                           
                        
                     ), number of processed pairs (
                        
                           |
                           pairs
                           |
                        
                     ), i.e., number of times Eq. (9) is executed, global computation time to simplify the object until the AABB (in seconds), total number of generated objects (p), total number of extreme vertices (
                        
                           |
                           TEV
                           |
                        
                     ), total PEVE storage size in bytes, and compression rates with respect to a direct storage of the sequence in its raw EVM (
                        
                           
                              
                                 cr
                              
                              
                                 r
                              
                           
                        
                     ) and with respect to the compressed EVM (
                        
                           
                              
                                 cr
                              
                              
                                 c
                              
                           
                        
                     ) (see Section 6.1). For these datasets the number of bits to encode a vertex coordinate varies from 7 to 11. All these datasets are shown in Figs. 9, 17, 18, 19, 20, 21 and 22. Note that, the number of encoded objects is not 
                        
                           2
                           
                              
                                 d
                              
                              
                                 max
                              
                           
                        
                      because there can be repeated generated objects, and we do not consider them as a new object.


                     Fig. 16
                     (a) depicts the quality distortion curves of the test datasets as a function of the percentage of total bytes decoded (transmitted) in order to get the original object. This graph shows that the presented approach yields good approximations, 
                        
                           Θ
                           <
                           0.2
                        
                     , with only 10% of the decoded data. Fig. 16(b) gives a closeup of the first 10%. Note that the more orthogonal or bigger is the object the less distortion it has along the simplification process (e.g. Pelvis, PhlegmaticDragon and Athene), while the opposite happens with sparse or small objects (e.g. Aneurysm, Venus and DiskBrake).

An ideal comparison would be against other methods with the same dataset at the same scale, computing compression rates and visual quality. However, as we pointed out in Section 2, there are few methods that produce a progressive LOD sequence of bounding volumes, and the corresponding results are reported in different ways making a global comparison hard. Nonetheless, we have chosen those three methods in the revised literature that are more related to the presented one and we will perform ad hoc comparisons with each of them.

The presented approach can generate sequences of objects in which pairs of consecutive objects only change in very few vertices. However, we are aware that for progressive methods, logarithmically spaced approximations are quite good. Therefore, in the following comparisons these kind of sequences will be generated, i.e., consecutive objects will satisfy the following statement: 
                           
                              |
                              EV
                              (
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                              
                              )
                              |
                              ⩽
                              0.5
                              |
                              EV
                              (
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                    -
                                    1
                                 
                              
                              )
                              |
                              ,
                              ∀
                              i
                              =
                              1
                              ,
                              
                              …
                              
                              ,
                              
                              p
                           
                        . Table 2
                         shows the statistics for the test datasets with this restriction.

The Bunny dataset has been tested by Samet and Kochut in an octree-based approximation method [48]. The size of the volume data is 
                              
                                 
                                    
                                       128
                                    
                                    
                                       3
                                    
                                 
                              
                            and, therefore, the region octree has a maximum depth of 7 and the method generates a LOD sequence of eight objects. In this method, 29007 blocks are necessary to reconstruct the original Bunny. Each block is uniquely identified with a locational code, 
                              
                                 
                                    
                                       z
                                    
                                    
                                       n
                                    
                                 
                              
                           , which for any node 
                              
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                              
                            is an integer computed with the next recursive expression:
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      i
                                                      =
                                                      m
                                                   
                                                
                                                
                                                   
                                                      9
                                                      ·
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            i
                                                            -
                                                            1
                                                         
                                                      
                                                      +
                                                      childtype
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      m
                                                      <
                                                      i
                                                      ⩽
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where the sequence 
                              
                                 <
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 >
                              
                            represents all the directional codes on the path from the root node 
                              
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                 
                              
                            to node 
                              
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                              
                            and childtype returns the corresponding directional code.

Although this locational code supposes some compression degree, the authors do not explain any way for further compression. However, we have compared the size of both codifications in two different ways. First, for an octree with depth 7, in the worst case when all the directional codes are 8, this expression gives a maximum value of 
                              
                                 8
                                 ·
                                 
                                    
                                       9
                                    
                                    
                                       0
                                    
                                 
                                 +
                              
                            
                           
                              
                                 8
                                 ·
                                 
                                    
                                       9
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 …
                                 +
                                 8
                                 ·
                                 
                                    
                                       9
                                    
                                    
                                       6
                                    
                                 
                                 =
                                 4
                                 ,
                                 782
                                 ,
                                 968
                              
                           , therefore, the locational code for each block will require at most 23 bits. Thus, we estimate that the sequence of blocks of the Bunny requires, in this case, a total storage size of 83,396bytes (29,007 blocks 
                              
                                 ·
                              
                            23bits). For the same dataset and at the same resolution, PEVE requires 51,698bytes for a total of 33,298 EV that encode 10 objects. Note that in this case a vertex coordinate is encoded with 
                              
                                 
                                    
                                       log
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 128
                                 )
                                 =
                                 7
                              
                            bits. This storage size is 0.619 of the storage size of the octree-based method.

On the other hand, we have considered the streams (in plain text) generated by both methods and then we have zipped them. For the octree-based method 29,007 random numbers between 1 and 4,782,968 have been generated, and for PEVE, we have generated a file like that shown in Fig. 15. In this case, the total storage size of the zipped data stream of the octree-based method is 107,162bytes
                              1
                              Similar results for more than 20 tests.
                           
                           
                              1
                           . For PEVE, the zipped data stream requires 87,107bytes. Therefore, this storage size is 0.812 of the storage size of the octree-based method.


                           Fig. 17
                            shows a visual comparison of the approximation quality of both methods. We show for each object the quantity of decoded (transmitted) bytes and the number of elements (blocks and EV respectively). In all the approximations PEVE gives a better indication of the shape with less storage cost, and even EVM objects with 20,796 and 51,698bytes look better than object with 60,163bytes in the octree-based method (see Fig. 17(b), (g) and (h).

The BSP-based method of Huang and Wang [27] (BSP, from now on) generates approximations that are convex bounding volumes. Although this simplification method is progressive, it is lossy and does not allow a progressive decoding, so, we will compare separated approximations. We use three datasets tested with BSP: Pelvis, Foot and Venus (see Fig. 18–20
                           
                           
                           ). The basic element used in BSP is a plane represented by its four coefficients while for EVM is an EV represented by its three coordinates. Therefore, these datasets have been converted into EVM in such a way that the number of EV is approximately 4/3 the number of planes of the initial object.


                           Table 3
                            gives the execution time to obtain the LOD sequence in both methods. BSP has been tested with C++ program on a PC with Intel® Core 2 Quad CPU Q6600@2.40GHz. Note that although this PC is faster than the one we used, the execution times with BSP are higher. Fig. 18–20 show several approximations using BSP and PEVE for the Pelvis, Foot and Venus datasets showing for each approximation the number of nodes (BSP), EV (PEVE) and the percentage of these elements with respect to the initial object.

We make several observations concerning visual quality. For the Foot dataset, the fingers in PEVE are noticeable even in the 1.2% approximation (see Fig. 19(e)) while in BSP they look wrapped from the 30% approximation (see Fig. 19(c)). For the Pelvis dataset, PEVE approximations maintain better the genus (number of handles), the genus of the original Pelvis is 13, and this value is maintained in the 28.1% approximation (see Fig. 18(g)), the genus for the 6.2% and 0.5% approximations are 10 and 3 respectively.

On the other hand, the genus for the 30% approximation obtained by BSP seems to be less than 13 as some small handles are closed (see Fig. 18(b)) and in the 0.5% approximation holes look completely wrapped. Finally, for the Venus dataset, PEVE approximations maintain better the concavities of the model than BSP.

Melero et al. have tested the BP-Octree (BP-O) [37] to transmit progressively 3D objects over the network. We have tested the PhlegmaticDragon dataset, which has 715,933 triangles (13298.9kB in the PLY format). The generated BP-O uses a tree with a maximum depth of 8, i.e., it corresponds to a LOD sequence with nine objects. It contains 970,985 planes and supposes ≈25,000kB of transmitted data (1.8 times the original size). The authors claim that the final geometry is never transmitted as a very fine approximation of the model is reached at leaf nodes. However, if the original geometry was transmitted (true lossless), this size increases.

On the other hand, the original PhlegmaticDragon dataset has been represented in EVM with 716,840EV (1309.9kB, using the compressed EVM). Moreover, PEVE needs 1972.9kB (1.5 times the original size) to encode all 15 generated objects. Note that the required storage size in PEVE is noticeably smaller than using BP-O (7.8%) and that in PEVE the original geometry is always transmitted without any extra cost.

In Fig. 21
                            we compare the visual quality of the shape approximation of BP-O and PEVE. For each approximation, we show the percentage of decoded transmitted elements (planes and EV respectively) with respect to the original object as well as the transmitted kB. In all approximations PEVE gives a better indication of the shape with notably less storage cost. Note that the BP-O approximation looks wrapped in low levels. Finally, although the authors do not indicate the PC used to generate the BP-O, they report the time it requires, 197.24s, which is higher than to generate PEVE, 110.8s.
                        

Structural parameters allow to measure physical properties of a sample such as osteoporosis degree of bones, suitability of biomaterials to be used as implants, transport and distribution of fluids into rocks for petrographic purposes, grain shape for industrial and manufacturing applications. Recently, OPP represented either with EVM or CUDB have been demonstrated to be suitable to compute structural parameters of binary datasets compared with the voxel model: Pore-size distribution [47], connectivity [7,16], sphericity and roundness [15]. Moreover, experimental tests have shown that the application of the simplification method presented in this paper, can be used as support in the structural parameters computation. Results can be summarized as follows (for details see [15]).

Regarding the pore-size distribution, the first approximations of a porous sample retain enough relevant information and the generated histograms show a similar behavior than the original sample, and as the approximations contain less number of elements than the original dataset, they are processed faster even considering the simplification time. In the connectivity computation, objects containing big holes better preserve its genus (in some cases until approximations with 10% of encoded data) than those objects containing small holes throughout the simplification. And, regarding the sphericity, as this property is most dependent on elongation and the simplification method keeps the AABB size in all the approximations, the sphericity index changes slightly until approximations with 10% of encoded data.

@&#CONCLUSIONS@&#

We have presented an approach to simplify orthogonal polyhedra and 3D binary images, represented with EVM. It generates a LOD sequence of BOPP, which fulfill the common subset and AABB properties of bounding structures. The approach is based on a merging faces strategy and deals with OPP with any number of holes and connected components. It also includes a technique, based on model continuity, for a better shape preservation. We have pointed out the efficiency and robustness of EVM Boolean operations, specially xor, and we have taken full advantage of this operation. Finally, we have presented a data structure, PEVE, to encode in a progressive and lossless way the generated LOD sequence.

From experimental results, we can conclude that the LOD sequence generated by this method is satisfactory in terms of quality of the approximation, although better quality is obtained when more orthogonal is the object shape. Compared with other approaches, PEVE gives good compression rates and processing time. Moreover, the generated bounding approximations are tighter, in general, than in other approaches, maintaining concavities, genus and other shape features at a very compressed approximations.

The presented approach can be very useful in applications that require bounding volumes and deal with many 3D objects, specially where most of them are distributed in an orthogonal way, e.g. to speed up the collision detection in the automatic pipe routing in ships [6].

As a future work, we are devising a new method for pore space partitioning, as an extension of our previous work, based on narrow throat detection [47]. We will apply this method to real silica nano datasets. To analyze the resulting complex forms we will simplify them with the presented method before applying the pore space partitioning. As the simplified object bounds the original, detected narrow throats on it will be also narrow throats on the original. Currently, we are preparing a new paper with these results and other benefits like those described in Section 7.2 of performing simplification using OPP.

Other directions for future work include the study of an EVM and CUDB based data structure to efficiently encode time-varying datasets.

@&#ACKNOWLEDGMENTS@&#

This work was partially supported by the national Projects TIN2008-02903 and TIN2011-24220 of the Spanish government and a CONACYT grant of the Mexican government for I. Cruz-Matías. The authors thank the anonymous reviewers whose suggestions and questions gave them challenge and opportunity to greatly improve the paper.

@&#REFERENCES@&#

