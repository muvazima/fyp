@&#MAIN-TITLE@&#Semi-automated quantification of retinal IS/OS damage in en-face OCT image

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Semi-automated method to quantify retinal IS/OS damage using level-sets.


                        
                        
                           
                           Mutual information as energy function to leverage statistics of the lesion.


                        
                        
                           
                           Thorough statistical analysis of algorithmic accuracy vis-à-vis manual method.


                        
                        
                           
                           Algorithmic damage quantification reported vis-à-vis observer repeatability.


                        
                        
                           
                           Quotients are defined to fairly compare among methods tested on disparate datasets.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

En-face optical coherence tomography (OCT)

Inner-segment/outer-segment (IS/OS) junction

Level-set method

Mutual information

Dice coefficient

Statistical analysis

@&#ABSTRACT@&#


               
                  Graphical abstract
                  
                     
                        
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

With the advent of optical coherence tomography (OCT) [1], ophthalmologists have been able to image as well as assess pathological changes in the posterior segment of the eye [2]. Specifically, the spectral domain OCT (SD-OCT) has enabled improved visualization and segmentation of retinal layers, almost similar to histology [3], and consequently, various significant clinical studies. For example, the integrity of the hyper-reflective inner-segment/outer-segment (IS/OS) junction of photoreceptorsin SD-OCT B-scans has been found to correlate with visual acuity in various retinal disorders [4–6]. In particular, recent investigations have shown such association in patients with parafoveal telangiectasia [7], retinitis pigmentosa [8], Stargardt׳s disease [9], retinal vein occlusion [10], age-related macular degeneration (AMD) [11], resolved central serous chorioretinopathy [12], and diabetic macular edema [13].

The aforementioned reports include evaluation of horizontal and/or vertical B-scans of the macular area. Typical SD-OCT B-scan is shown in Fig. 1
                     (a), consisting of retina (layered), including IS/OS junction, choroid (granular), and sclera (smooth), from top to bottom (physiologically from inner to outer layer) [14]. Unfortunately, a single foveal B-scan provides only a general idea about visual acuity, and does not convey holistic information about the entire macular region. For instance, OCT B-scan depicted in Fig. 1(b) provides only a cross-sectional view of the condition of IS/OS layer present at foveal center, which is clearly not sufficient to visualize the complete topography of the lesion. In this backdrop, an SD-OCT-based technology, called en-face visualization (also called a transverse-, coronal-, or C-scan) of specific layers of the retina including the IS/OS, assumed significance [15,16]. Fig. 1(c) depicts the en-face OCT image taken at the IS/OS junction from volumetric B-scans, where the dark region at the center indicates the damaged IS/OS region. Clearly, an en-face OCT image provides better visualization of the damaged region compared to B-scans.

Indeed, the extent of damage in IS/OS region, estimated from en-face OCT images of the posterior part of the eye, has emerged as an important metric in disease management [17]. Accurate quantification of damaged IS/OS region on en-face images provides information about the extent of the damage, and helps in early diagnosis of extrafoveal diseases, monitoring of disease progression and evaluation of treatment response. Consequently, estimation accuracy has assumed a vital role in ensuring accurate diagnostic outcome. So far, such area measurements have been performed by experts by manually delineating the damaged region boundaries and then measure the area [18,19]. Generally, an expert labels multiple en-face OCT images per subject to evaluate disease progression and treatment response, making this procedure time consuming, laborious as well as susceptible to fatigue-induced error. Further, since the number of available experts is often few compared to the number of subjects (especially, in developing regions), only a fraction of potential subjects actually receive the aforementioned diagnosis. Against this backdrop, automated quantification of IS/OS layer lesion could be crucial in reducing professional effort and time per subject, potentially allowing more subjects to obtain specialized medical attention. Automation would also avoid human error induced by fatigue and tedium. Accordingly, we propose a semi-automated algorithm for damaged IS/OS region segmentation and related area measurements. In particular, we adopt a level-set approach towards lesion segmentation. At the heart of our technique lies an energy function, chosen as the estimated mutual information between rival classes, which is iteratively minimized. Upon meeting a suitable stopping criterion, the zero-level contour of the level-set function is taken as the decision boundary. Advantages of the level-set method over conventional statistical pixel classification techniques arise from the former׳s ability to achieve global smoothness while seamlessly handling changes in topology [20].

Our algorithm is evaluated on a dataset consisting of 27 en-face OCT images taken from 20 patients with idiopathic juxtafoveal retinal telangiectasia (IJRT) type 2A, each covering 6× 6mm2 area centered around fovea. Further, damaged area measurements obtained using the proposed method are compared with that obtained manually. We take the average of the two manual segmentations performed by the same expert as the reference following current clinical practices [21,22], and perform both qualitative and quantitative performance assessment. First we visually compare the algorithmic segmentation of the damaged region vis-à-vis the manual reference. Subsequently, we turn to quantitative assessment of the proposed semi-automated algorithm in terms of estimation accuracy of the damaged area. Specifically, we quantify estimation accuracy in terms of Dice coefficient (DC), which measures the closeness between the algorithmic and the manual delineations. Ideally, one wishes algorithms to perform as well as the manual method. To quantify the closeness to this ideal goal, we present a thorough statistical analysis. Specifically, we obtain mean DC of 85.69%, which is close to the corresponding observer repeatability value of 89.45%. Further, to provide a basis for performance comparison against future techniques, which will possibly be evaluated on disparate datasets, we define two statistical measures (i) quotient of mean and (ii) quotient of coefficient of variation, where the term quotient indicates ratio of automated to manual indices. Specifically, we calculate the respective quotient of mean Dice coefficient (QMDC) and quotient of coefficient of variation of Dice coefficient (QCVDC), for each of which smaller value is better, and the value of one signifies a level of performance at par with that of human expert. Encouragingly, we achieve respective quotient values of 1.35 and 1.09, signifying the efficacy of the proposed algorithm.

In summary, our main contributions are as follows:
                        
                           1.
                           A semi-automated method based on level sets is demonstrated for delineating IS/OS damage.

Algorithmic delineation of the damaged region is evaluated for accuracy vis-à-vis manual delineation using thorough statistical analysis based on Dice coefficients.

Quotient measures are introduced to facilitate comparison among algorithms that are tested on disparate datasets.

The present study was performed at L.V. Prasad Eye Institute, India, between December 2012 and June 2013. Approval from the Institutional Review Board of the institute was obtained and the subjects provided their informed consent. Further, this study was conducted in accordance with the tenets of the Declaration of Helsinki. In particular, we considered 20 patients diagnosed to have idiopathic juxtafoveal retinal telangiectasia (IJRT) type 2A, based on SD-OCT scans. Detailed biomicroscopic examination and fundus fluoscein angiography were performed to confirm the diagnosis in all cases. SD-OCT scans were obtained using Cirrus SD-OCT (Carl Zeiss Meditec, Dublin, CA). Macular cube scan protocol (128 B-scans, each consisting of 512 A-scans over a 6× 6mm2 area with a maximal scan velocity of 27,000axial scans per second) was performed. All scans were performed by OCT-certified ophthalmic technician. High-quality scans, which were centered on the fovea with a signal strength greater than 6, and which displayed correctly aligned automatic software segmentation of the internal limiting membrane and inner RPE (retinal pigment epithelium) boundary, were included. Images from eyes with subretinal neovascular membranes and eyes with shadowing effect on IS/OS layer due to intraretinal pigments were excluded. Pigment would have produced a shadowing effect on deeper layers and hence would have confounded the results. Subject to the above criteria, we chose volume scans of 27 eyes for our study.

The SD-OCT software, by default, produced en-face images at the level of the RPE. On the corresponding B-scan image, the default level was then off-set vertically upwards to coincide with the IS/OS junction a hyperreflective line, located just above the RPE. The image window width was set to 20 slices, which provided good image contrast. Within each image, dark areas were observed which were suggestive of IS/OS degeneration or loss (refer to Fig. 1(b)). These dark areas correlated qualitatively with the B-scan OCT images, where one could clearly see the absent IS/OS junction in cross-section.


                        Manual segmentation: The borders of these damaged IS/OS regions were mapped with the freehand selection tool of the ImageJ software version 1.47 (Wayne Rasband, National Institutes of Health, USA), a free-to-download software in the public domain [23]. The mapping of the dark area borders were performed independently for each image twice by single observer, masked to previous measurements. In order to improve robustness, we considered both these two delineations with equal weight for quantifying accuracy of the proposed method.

In this section, we first detail the clinical motivation behind the desired semi-automated segmentation, and then establish its engineering complexity. Subsequently, we pose the problem in the mathematical framework of level-set methods.

A typical en-face image with IS/OS damage is depicted in Fig. 2
                           (a), where the damage region was delineated by a solid orange line. Area of such region, as alluded earlier, directly relates to visual acuity, and the ophthalmologist seeks its accurate quantification. While the damage, generally manifesting as a dark irregular region, is expected to be delineated accurately by human experts, such manual delineation is often time consuming and laborious, and sometimes incurs in fatigue-induced error. In this backdrop, algorithmic segmentation and quantification of damaged region, closely matching manual results, have assumed clinical significance. While a fully automated algorithm, if accurate, would be preferred, developing such an algorithm could be problematic due to the various complexities. For instance, (i) damage may be present anywhere, (ii) size of the damaged region may vary from quite small to rather large, (iii) multiple lesions may be present in a single image, and (iv) unrelated dark structures and imaging artifacts may confound the algorithm. Against this backdrop, starting with a few arbitrary points/subregions (seeds) that are known to belong to the damaged region, we seek a semi-automated algorithm that then grows such seeds to gradually fit the target region. Further, the desired algorithm should detect multiple lesions, when applicable. Not only is the resulting segmentation expected to be accurate, but seed selection can be delegated to semi-trained personnel, so that the primary objective of reducing clinicians’ burden is still achieved.

While presenting experts with little difficulty, the segmentation task at hand poses considerable challenge to an algorithm even when the aforementioned seeds are available. Notice the following in Fig. 2(a). While the damaged region is visually distinguishable due to its general darkness, it lacks uniformity of intensity levels. Specifically, the damaged dark region contains a few bright spots, so that the range of intensity values is possibly similar both inside and outside the damaged region. On the other hand, sometimes the uneffected portion also contains dark regions, mostly imaging artifacts and retinal blood vessels. Therefore, straightforward methods based on intensity thresholding would not be accurate. However, the relative proportions of various intensity levels are clearly different inside and outside, indicating the suitability of statistical methods. In particular, we pose the desired delineation problem as a two-region image segmentation problem, and adopt a level-set technique to tackle it.

At this point, we formalize the segmentation problem at hand. Denote the image intensity of the en-face image Γ at location x by J(x). Further, let J(x) follow probability density p
                           
                              dr
                            if J(x) belongs to the damaged IS/OS region, and p
                           
                              br
                           , otherwise. Then our task consists in testing 
                              J
                              (
                              x
                              )
                              ~
                              
                                 
                                    p
                                 
                                 
                                    dr
                                 
                              
                            vs. 
                              J
                              (
                              x
                              )
                              ~
                              
                                 
                                    p
                                 
                                 
                                    br
                                 
                              
                           , and the segmented damaged region 
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    dr
                                 
                              
                            consists of all locations x such that J(x) is declared to follow p
                           
                              dr
                           . The complementary (background) region is denoted by 
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    br
                                 
                              
                           . In practice, p
                           
                              dr
                            and p
                           
                              br
                            are not known a priori, and estimating those adds to the difficulty. In this context, to achieve the desired segmentation, we propose to iteratively estimate (evolve) the decision boundary curve, and hence the decision regions, using the concept of level sets [20]. In particular, we start with an arbitrary seed curve 
                              
                                 
                                    C
                                 
                                 
                                    →
                                 
                              
                           , whose inside is declared as the estimated damaged region, and label each pixel by
                              
                                 (1)
                                 
                                    
                                       
                                          L
                                       
                                       
                                          
                                             
                                                C
                                             
                                             
                                                →
                                             
                                          
                                       
                                    
                                    (
                                    x
                                    )
                                    =
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      dr
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                x
                                                
                                                ∈
                                                
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            ^
                                                         
                                                      
                                                   
                                                   
                                                      dr
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      br
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                x
                                                
                                                ∈
                                                
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            ^
                                                         
                                                      
                                                   
                                                   
                                                      br
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Denoting by X a location random variable taking values x in Γ, it has been shown that the mutual information 
                              
                                 
                                    I
                                 
                                 
                                    ^
                                 
                              
                              (
                              J
                              (
                              X
                              )
                              ;
                              
                                 
                                    L
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          →
                                       
                                    
                                 
                              
                              (
                              X
                              )
                              )
                            is maximum when label values for all pixel locations are correct [24]. Thus motivated, we adopt the above information-theoretic energy functional alongside a curve-length penalty and a distance regularization term [25] as follows:
                              
                                 (2)
                                 
                                    E
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          →
                                       
                                    
                                    )
                                    =
                                    −
                                    |
                                    Γ
                                    |
                                    
                                       
                                          I
                                       
                                       
                                          ^
                                       
                                    
                                    (
                                    J
                                    (
                                    X
                                    )
                                    ;
                                    
                                       
                                          L
                                       
                                       
                                          
                                             
                                                C
                                             
                                             
                                                →
                                             
                                          
                                       
                                    
                                    (
                                    X
                                    )
                                    )
                                    +
                                    α
                                    
                                       
                                          ∮
                                       
                                       
                                          
                                             
                                                C
                                             
                                             
                                                →
                                             
                                          
                                       
                                    
                                    
                                    ds
                                    +
                                    μ
                                    R
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          →
                                       
                                    
                                    )
                                    ,
                                 
                              
                           where 
                              
                                 
                                    I
                                 
                                 
                                    ^
                                 
                              
                              (
                              J
                              (
                              X
                              )
                              ;
                              
                                 
                                    L
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          →
                                       
                                    
                                 
                              
                              (
                              X
                              )
                              )
                            denotes estimated pixelwise mutual information, 
                              
                                 
                                    ∮
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          →
                                       
                                    
                                 
                              
                              
                              ds
                            measures the length of the curve, and 
                              R
                              (
                              
                                 
                                    C
                                 
                                 
                                    →
                                 
                              
                              )
                            indicates a distance regularization term. Here α and μ are scalar parameters, and 
                              |
                              Γ
                              |
                            is the total number of pixels in the image. Our task now boils down to minimizing 
                              E
                              (
                              
                                 
                                    C
                                 
                                 
                                    →
                                 
                              
                              )
                            given by (2), and declare the minimizing 
                              
                                 
                                    C
                                 
                                 
                                    →
                                 
                              
                            as the desired decision boundary. Interestingly, the minimizing 
                              
                                 
                                    C
                                 
                                 
                                    →
                                 
                              
                            can be obtained by iteratively solving a governing equation involving the level-set function 
                              ϕ
                              (
                              x
                              ,
                              t
                              )
                           , and taking its zero level set [20]. Additional details on level-set evolution are furnished in Appendix A.

At this point, it is worth noting a pertinent property of the level-set method that the evolving zero level set (i.e., the curve 
                              
                                 
                                    C
                                 
                                 
                                    →
                                 
                              
                           ) need not be a single contour, and may consist of even a varying number of contours. The initial 
                              
                                 
                                    C
                                 
                                 
                                    →
                                 
                              
                            generally consists of multiple seed boxes/contours. In case a single lesion is present, we expect such seed contours to gradually coalesce together, and fit to the boundary of the lesion in the course of evolution. On the other hand, when multiple lesions are present, level-set evolution is expected to gradually merge subsets of seed contours so as to fit the boundaries of the various lesions.

The proposed algorithm is schematically depicted as a flow chart in Fig. 3
                           . First, the level-set function is initialized as a step function based on the seed curve 
                              
                                 
                                    C
                                 
                                 
                                    →
                                 
                              
                           , lying entirely inside the damaged IS/OS region. At every iteration, the level-set function is evolved according the governing equation, and checked against the stopping criterion. If such criterion is met, the zero level contour of the level-set function is declared as the final estimate of the decision boundary 
                              
                                 
                                    C
                                 
                                 
                                    →
                                 
                              
                           , whereas the level-set evolution is continued otherwise. A negative value of the parameter α, which ensures that the desired region grows with iterations, should be chosen. For our analysis, we set 
                              α
                              =
                              −
                              3
                           . We also set the distance-regularization parameter 
                              μ
                              =
                              0.04
                           . On a representative OCT image given in Fig. 2(a), the initialization and various stages of evolution of 
                              
                                 
                                    C
                                 
                                 
                                    →
                                 
                              
                            are shown in Fig. 2(b)–(f). Since algorithmic convergence is expected to take a long time, we need to stop prematurely. Accordingly, we are left to pick an appropriate stopping condition.

To this end, it would seem natural to stop at an iteration when, on the average, the area of the damaged region obtained algorithmically matches that obtained manually. However, such an approach suffers from a subtle inadequacy. To see this, consider the following. While one wishes a close match between algorithmic and manual area measurements, one also wishes the segmented regions obtained by the two methods to overlap substantially. For instance, consider two scenarios, depicted in Fig. 4
                           . In Scenario I, the aforementioned segmented regions have exactly equal areas but no overlap, whereas, in Scenario II, those regions have somewhat unequal areas, although with large overlap. Notionally, Scenario II should indicate a closer match compared to Scenario I. Thus the task now boils down to adopting a criterion that measures the degree of match according to the above notion.

At this point, let x and y denote two delineations of the damaged region in an OCT image. Then the Dice coefficient (DC) is given by [26,27]
                           
                              
                                 (3)
                                 
                                    DC
                                    =
                                    
                                       
                                          2
                                          Area
                                          (
                                          x
                                          ∩
                                          y
                                          )
                                       
                                       
                                          Area
                                          (
                                          x
                                          )
                                          +
                                          Area
                                          (
                                          y
                                          )
                                       
                                    
                                    .
                                 
                              
                           Notice that DC (large positive) in Scenario II is clearly greater than DC (equal to zero) in Scenario I in Fig. 4. More broadly, DC appears to quantify our notion of match, and hence we propose to stop at an iteration when, on the average, DC is maximized.

As mentioned earlier, we used 27 en-face OCT images as the experimental dataset, performed semi-automated segmentation of the damaged IS/OS junction, and compared our results with that obtained manually.

Towards performing and analyzing the desired segmentation, we first attend to certain technical considerations, involving performance and stopping criteria.

As stated in Section 2.1, we began with two manual delineations for each image, performed independently by the same observer. The resulting observer repeatability served as the yardstick for algorithmic performance, and was measured by the DC between two manual segmentations, and taken as the reference DC. In other words, for the i-th (i=1,2,…, N) image in the dataset, the reference DC, 
                              
                                 
                                    DC
                                 
                                 
                                    i
                                 
                                 
                                    ref
                                 
                              
                           , is given by
                              
                                 (4)
                                 
                                    
                                       
                                          DC
                                       
                                       
                                          i
                                       
                                       
                                          ref
                                       
                                    
                                    =
                                    
                                       
                                          2
                                          Area
                                          (
                                          M
                                          
                                             
                                                1
                                             
                                             
                                                i
                                             
                                          
                                          ∩
                                          M
                                          
                                             
                                                2
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          Area
                                          (
                                          M
                                          
                                             
                                                1
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          +
                                          Area
                                          (
                                          M
                                          
                                             
                                                2
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    ,
                                 
                              
                           where 
                              M
                              
                                 
                                    1
                                 
                                 
                                    i
                                 
                              
                            and 
                              M
                              
                                 
                                    2
                                 
                                 
                                    i
                                 
                              
                            are two manual segmentations of the i-th image.

Against the aforementioned reference DC, it would seem natural to compare 
                              
                                 
                                    DC
                                 
                                 
                                    i
                                 
                                 
                                    auto
                                 
                              
                           , the DC between reference segmentation (
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                           ) and its automated counterpart (
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           ). However, this approach would lead to certain difficulties. While one would ideally compute 
                              
                                 
                                    DC
                                 
                                 
                                    i
                                 
                                 
                                    auto
                                 
                              
                            according to (4), with 
                              M
                              
                                 
                                    1
                                 
                                 
                                    i
                                 
                              
                            replaced by 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           , and 
                              M
                              
                                 
                                    2
                                 
                                 
                                    i
                                 
                              
                            replaced by 
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                           , systematically defining the reference segmentation 
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                            from individual manual segmentations 
                              M
                              
                                 
                                    1
                                 
                                 
                                    i
                                 
                              
                            and 
                              M
                              
                                 
                                    2
                                 
                                 
                                    i
                                 
                              
                            poses a challenge. Specifically, 
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                            cannot be taken as the average of 
                              M
                              
                                 
                                    1
                                 
                                 
                                    i
                                 
                              
                            and 
                              M
                              
                                 
                                    2
                                 
                                 
                                    i
                                 
                              
                           , as the latter are sets and their average is not well defined. In response, we seek an alternative definition for 
                              
                                 
                                    DC
                                 
                                 
                                    i
                                 
                                 
                                    auto
                                 
                              
                            that does not directly involve 
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                           . To this end, we replace the notional overlapped area 
                              Area
                              (
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              ∩
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              )
                            by the average of areas of overlapped regions 
                              Area
                              (
                              M
                              
                                 
                                    1
                                 
                                 
                                    i
                                 
                              
                              ∩
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              )
                            and 
                              Area
                              (
                              M
                              
                                 
                                    2
                                 
                                 
                                    i
                                 
                              
                              ∩
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              )
                           . We further replace the notional 
                              Area
                              (
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              )
                            by the average of 
                              Area
                              (
                              M
                              
                                 
                                    1
                                 
                                 
                                    i
                                 
                              
                              )
                            and 
                              Area
                              (
                              M
                              
                                 
                                    2
                                 
                                 
                                    i
                                 
                              
                              )
                           . Accordingly, we arrive at the following practical definition:
                              
                                 (5)
                                 
                                    
                                       
                                          DC
                                       
                                       
                                          i
                                       
                                       
                                          auto
                                       
                                    
                                    =
                                    
                                       
                                          Area
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                          
                                          ∩
                                          M
                                          
                                             
                                                1
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          +
                                          Area
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                          
                                          ∩
                                          M
                                          
                                             
                                                2
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          Area
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          +
                                          (
                                          Area
                                          (
                                          M
                                          
                                             
                                                1
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          +
                                          Area
                                          (
                                          M
                                          
                                             
                                                2
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          )
                                          /
                                          2
                                       
                                    
                                    .
                                 
                              
                           One would like 
                              
                                 
                                    DC
                                 
                                 
                                    i
                                 
                                 
                                    auto
                                 
                              
                            to be high. Note that 
                              
                                 
                                    DC
                                 
                                 
                                    i
                                 
                                 
                                    auto
                                 
                              
                              =
                              
                                 
                                    DC
                                 
                                 
                                    i
                                 
                                 
                                    ref
                                 
                              
                            indicates algorithmic performance at par with manual methods.

As depicted in Fig. 2(b), a few seeds, typically boxes, belonging to the damaged region were provided to the algorithm, based on which the initial level-set function was assigned, which was then evolved iteratively. Early iterations saw rapid growth of the region enclosed by the zero level-set, while the growth subsequently slowed towards convergence. Not surprisingly, as shown in Fig. 5
                           (a), a similar monotonic behavior towards saturation was exhibited by the average area of the said region, expressed as a percentage of the manually obtained reference area. Notice that the 100% mark is reached at the 144-th iteration. In comparison, plotting in Fig. 5(b) the mean DC (MDC
                              auto
                           )
                              1
                           
                           
                              1
                              Mean DC is given by 
                                    MDC
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          DC
                                       
                                       
                                          k
                                       
                                    
                                 . Further, MDC
                                    auto
                                  and MDC
                                    ref
                                  respectively refer to MDC obtained algorithmically and manually.
                            achieved by the algorithm against iteration count, a clear peak of 85.69% was observed at the 44-th iteration. Interestingly, such peak value was close to the manual reference 
                              
                                 
                                    MDC
                                 
                                 
                                    ref
                                 
                              
                              =
                              89.45
                              %
                           . Accordingly, as explained in Section 2.2.3, we picked the 44-th iteration as our stopping point rather than the 144-th iteration, as the former maximized the desired overlap between manual and automated delineation. To further illustrate the point to readers, we depict in Fig. 6
                           (a) and (b) the 17-th image in our dataset at the 44-th iteration and the 144-th iteration of segmentation, respectively, and compare those to a manual segmentation (M1). Careful examination reveals a more accurate match between manual and algorithmic results in the former.

At this point, we performed semi-automated delineation of damaged region in the 27 OCT images in our dataset, following the steps given in Section 2.2.3, and stopping at the 44-th iteration as dictated by Fig. 5(b). The size of the damaged region varied significantly among the images in our dataset. Some (such as the 20-th image in our dataset, shown in Fig. 7
                        (e)) even included multiple lesions. However, the algorithmic results were in general agreement with the manual ones across all images. In Fig. 7, such delineations are depicted in six representative images for visual comparison. Next we statistically analyze the degree of the aforementioned agreement.

To begin with, the damaged area was estimated using the proposed algorithm (P), as well as manually (twice, M1 and M2, as well as average of those), and plotted against image index in Fig. 8
                           (a). Algorithmic estimates matched well with manual ones, although, as explained earlier, area alone is an inadequate performance metric. Subsequently, the Dice coefficients 
                              
                                 
                                    DC
                                 
                                 
                                    i
                                 
                                 
                                    auto
                                 
                              
                            (between P and M) and 
                              
                                 
                                    DC
                                 
                                 
                                    i
                                 
                                 
                                    ref
                                 
                              
                            were similarly plotted in Fig. 8(b), while the difference in Dice coefficients (DDC), 
                              
                                 
                                    DC
                                 
                                 
                                    i
                                 
                                 
                                    ref
                                 
                              
                              −
                              
                                 
                                    DC
                                 
                                 
                                    i
                                 
                                 
                                    auto
                                 
                              
                           , was plotted in Fig. 8(c). We observed general agreement, albeit the 
                              
                                 
                                    DC
                                 
                                 
                                    ref
                                 
                              
                            variation between 76.92% and 96.67%, with DDC confined between −1.02 (image 21) and 9.10 (image 20). In view of the large variation observed in 
                              
                                 
                                    DC
                                 
                                 
                                    ref
                                 
                              
                           , to ensure fair comparison, we next made use of normalized difference in DC (NDDC), which for the i-th (
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              N
                           ) image is defined by
                              
                                 (6)
                                 
                                    
                                       
                                          NDDC
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                DC
                                             
                                             
                                                i
                                             
                                             
                                                ref
                                             
                                          
                                          −
                                          
                                             
                                                DC
                                             
                                             
                                                i
                                             
                                             
                                                auto
                                             
                                          
                                       
                                       
                                          
                                             
                                                DC
                                             
                                             
                                                i
                                             
                                             
                                                ref
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           Plotting the cumulative percentage of images against NDDC in Fig. 8(d), we noticed the following: (i) the proposed algorithm outperformed manual methods in 15.6% of the images; in terms of NDDC (ii) the former performed within 3.4% of the latter in 50% of the images, and (iii) within 8.01% in 90% of the images. Such figures indicated the robustness of the proposed algorithm.

Next, we characterize algorithmic performance in terms of statistical measures. To begin with, recall that our algorithm achieved 
                              
                                 
                                    MDC
                                 
                                 
                                    auto
                                 
                              
                              =
                              85.69
                              %
                           , close to the manual reference 
                              
                                 
                                    MDC
                                 
                                 
                                    ref
                                 
                              
                              =
                              89.45
                              %
                           . In terms of standard deviation in DC, 
                              SDDC
                              =
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                DC
                                             
                                             
                                                k
                                             
                                          
                                          −
                                          MDC
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           , the algorithm achieved 
                              
                                 
                                    SDDC
                                 
                                 
                                    auto
                                 
                              
                              =
                              5.25
                              %
                            against the manual reference 
                              
                                 
                                    SDDC
                                 
                                 
                                    ref
                                 
                              
                              =
                              4.99
                              %
                           . Consequently, the coefficient of variation in DC (
                              CVDC
                              =
                              SDDC
                              /
                              MDC
                           ) of 0.061, achieved algorithmically, was also found to approximate that of 0.056, achieved manually. Overall, the performance of the proposed algorithm remained close to that of manual methods.

Finally, we consider the task of comparing among algorithms that could possibly be tested on different datasets. In such a scenario, it is imperative to assign performance scores in relation to observer repeatability index. In particular, we used two quotient measures: (i) quotient of mean Dice coefficient, 
                              QMDC
                              =
                              |
                              
                                 
                                    MDC
                                 
                                 
                                    auto
                                 
                              
                              −
                              
                                 
                                    DC
                                 
                                 
                                    ideal
                                 
                              
                              |
                              /
                              |
                              
                                 
                                    MDC
                                 
                                 
                                    ref
                                 
                              
                              −
                              
                                 
                                    DC
                                 
                                 
                                    ideal
                                 
                              
                              |
                            (where 
                              
                                 
                                    DC
                                 
                                 
                                    ideal
                                 
                              
                              =
                              1
                           , the ideal value of DC) and (ii) quotient of coefficient of variation in Dice coefficient, 
                              QCVDC
                              =
                              
                                 
                                    CVDC
                                 
                                 
                                    auto
                                 
                              
                              /
                              
                                 
                                    CVDC
                                 
                                 
                                    ref
                                 
                              
                           . One desires either quotient to be low, and a quotient value of one indicates an algorithmic performance indistinguishable from its manual counterpart. For our dataset, we obtained QMDC=1.35 and QCVDC= 1.09, which were close to one, indicating the efficiency of the proposed algorithm. Refer Table. 1
                            for a summary of the above statistical analysis.

Before proceeding further, we note that measures such as correlation coefficient (CC) and mean absolute difference (MAD) have found wide use [28]. However, since those are only based on areas (values) rather than regions (sets), we can extend the argument of Section 2.2.3, and still conclude that DC provides a superior performance criterion. Nevertheless, for the sake of completeness, quantification based on CC and MAD was performed and presented in Appendix B.

@&#DISCUSSION@&#

In this paper, we attempted at algorithmically obtaining the status of the IS/OS junction of photoreceptors from en-face OCT images of the posterior pole of the eye. Specifically, we proposed a semi-automated method for quantifying the damaged area as a time-saving assist to physicians. Noting the statistical difference between the damaged area and the remainder of the image, we adopted a level-set method involving minimization of an energy functional defined in terms of mutual information. Encouragingly, results obtained by the proposed method exhibited not only close visual agreement with manual results, but also close statistical match based on Dice coefficients. In addition, we proposed certain quotient measures, defined relative to observer repeatability, in order to facilitate comparison among algorithms tested on disparate datasets. Such quotient values also indicated that the proposed algorithm closely approximates the manual methods. In this context, full automation based on random seeds, if producing accurate results, would be preferred over the proposed semi-automated mode of operation. However, we do not recommend automated operation of the proposed algorithm because it sometimes detects imaging artifacts alongside genuinely damaged region, an instance of which is shown in Fig. 9
                      (compare with Fig. 2(e)).

Our approach assumes significance as previous reports demonstrate correlation between IS/OS damage with visual function in eyes with IJRT type 2A and other macular diseases based only on OCT B-scan [29–32], without using the complete topographic information. In contrast, en-face images provide a global status of this structure at the macula, could potentially sharpen the nature of such correlation, and could now be widely employed in view of automation. Further, recent data from the MacTel (Macular Telangiectasia) study group demonstrated a higher retinal sensitivity (measured by microperimetry) at locations outside the area of IS/OS defect seen on en face OCT imaging compared to those within it [18]. This defect has also been found to increase in size with time, with the increasing size correlating with a reduction in aggregate retinal sensitivity measured by microperimetry [33]. Therefore, quantification of this defect would be helpful in early diagnosis, progression and assessment of treatment response in MacTel as well as many macular diseases. In the near future, we envision our algorithm to be used as a fast tool for clinical screening. Specifically, our algorithm helps in early diagnosis of extrafoveal diseases, and can be used for monitoring disease progression and evaluating treatment response. Further, accurate measurement of damaged IS/OS region on en-face images may further improve the understanding of macular diseases.

Work is also in progress towards expanding the scope of the proposed algorithm. In this paper, our main objective was to practically demonstrate semi-automated segmentation and quantification, and for the sake of simplicity, we considered conditions that do not affect the Z-axis topography of the eye. In future, we plan to advance from en-face to volumetric analysis, and enlarge the algorithmic scope to include conditions, such as myopia, where Z-axis topography is altered.

None declared.

For any scalar function f(x) and region R, the energy functional 
                        E
                        (
                        
                           
                              C
                           
                           
                              →
                           
                        
                        (
                        t
                        )
                        )
                      is given by
                        
                           (A.1)
                           
                              E
                              (
                              
                                 
                                    C
                                 
                                 
                                    →
                                 
                              
                              (
                              t
                              )
                              )
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    R
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          →
                                       
                                    
                                    (
                                    t
                                    )
                                    )
                                 
                              
                              f
                              (
                              x
                              )
                              
                              dx
                              ,
                           
                        
                     where 
                        
                           
                              C
                           
                           
                              →
                           
                        
                      denotes the boundary of R. The gradient flow equation of curve evolution to minimize 
                        E
                        (
                        
                           
                              C
                           
                           
                              →
                           
                        
                        (
                        t
                        )
                        )
                      is given by [34]
                     
                        
                           (A.2)
                           
                              
                                 
                                    ∂
                                    
                                       
                                          C
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ∂
                                    t
                                 
                              
                              =
                              −
                              f
                              
                                 
                                    N
                                 
                                 
                                    →
                                 
                              
                              ,
                           
                        
                     where f controls the motion of the contour and 
                        
                           
                              N
                           
                           
                              →
                           
                        
                      indicates the inward normal vector to the curve. The corresponding level-set evolution equation for (A.2) is given by [35]
                     
                        
                           (A.3)
                           
                              
                                 
                                    ∂
                                    ϕ
                                 
                                 
                                    ∂
                                    t
                                 
                              
                              =
                              −
                              f
                              |
                              ∇
                              ϕ
                              |
                              ,
                           
                        
                     where ϕ denotes the level-set function.

Now, recall from Section 2.2.2 that our information-theoretic energy functional with curve-length penalty takes the form [24]
                     
                        
                           (A.4)
                           
                              E
                              (
                              
                                 
                                    C
                                 
                                 
                                    →
                                 
                              
                              )
                              =
                              −
                              |
                              Γ
                              |
                              
                                 
                                    I
                                 
                                 
                                    ^
                                 
                              
                              (
                              J
                              (
                              X
                              )
                              ,
                              
                              
                                 
                                    L
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          →
                                       
                                    
                                 
                              
                              (
                              X
                              )
                              )
                              +
                              α
                              
                                 
                                    ∮
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          →
                                       
                                    
                                 
                              
                              
                              ds
                              .
                           
                        
                     In view of (A.3), the level set evolution equation to minimize the energy functional in (A.4) can be derived as (details skipped for the sake of brevity)
                        
                           (A.5)
                           
                              
                                 
                                    ∂
                                    ϕ
                                 
                                 
                                    ∂
                                    t
                                 
                              
                              =
                              [
                              
                                 log
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                dr
                                             
                                          
                                          (
                                          J
                                          (
                                          
                                             
                                                C
                                             
                                             
                                                →
                                             
                                          
                                          )
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                br
                                             
                                          
                                          (
                                          J
                                          (
                                          
                                             
                                                C
                                             
                                             
                                                →
                                             
                                          
                                          )
                                          )
                                       
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       |
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             dr
                                          
                                       
                                       |
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             dr
                                          
                                       
                                    
                                 
                                 
                                    
                                       K
                                       (
                                       J
                                       (
                                       x
                                       )
                                       −
                                       J
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             →
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             dr
                                          
                                       
                                       (
                                       J
                                       (
                                       x
                                       )
                                       )
                                    
                                 
                                 
                                 dx
                                 −
                                 
                                    
                                       1
                                    
                                    
                                       |
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             br
                                          
                                       
                                       |
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             br
                                          
                                       
                                    
                                 
                                 
                                    
                                       K
                                       (
                                       J
                                       (
                                       x
                                       )
                                       −
                                       J
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             →
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             br
                                          
                                       
                                       (
                                       J
                                       (
                                       x
                                       )
                                       )
                                    
                                 
                                 
                                 dx
                              
                              ]
                              |
                              ∇
                              ϕ
                              |
                              −
                              α
                              (
                              
                                 
                                    
                                       ∇
                                    
                                    
                                       →
                                    
                                 
                                 ·
                                 (
                                 ∇
                                 ϕ
                                 )
                              
                              )
                              /
                              |
                              ∇
                              ϕ
                              |
                              ,
                           
                        
                     where 
                        K
                        (
                        z
                        )
                        =
                        (
                        1
                        /
                        
                           
                              2
                              π
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                           
                        
                        )
                        
                           
                              e
                           
                           
                              −
                              2
                              
                                 
                                    z
                                 
                                 
                                    2
                                 
                              
                              /
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                           
                        
                      denotes the underlying Gaussian kernel. Further, non-parametric Parzen estimates are used to estimate respective probability densities 
                        
                           
                              
                                 
                                    p
                                 
                                 
                                    ^
                                 
                              
                           
                           
                              dr
                           
                        
                      and 
                        
                           
                              
                                 
                                    p
                                 
                                 
                                    ^
                                 
                              
                           
                           
                              br
                           
                        
                      
                     [36]. We add a distance regularization term, suggested by [25], to (A.4) to obtain (2), and accordingly, the corresponding time-evolution term to (A.5) to arrive at the desired governing equation.

Let x
                     
                        i
                      and y
                     
                        i
                      denote two delineations of the damaged region in the i-th (i=1,…,N) image. Then the correlation coefficient (CC) and mean absolute difference (MAD) are defined by [28] 
                     
                        
                           
                              CC
                              =
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    Area
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    Area
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          Area
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          Area
                                          
                                             
                                                (
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                              
                              MAD
                              =
                              
                                 
                                    1
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                              |
                              Area
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              −
                              Area
                              (
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              )
                              |
                              .
                           
                        
                     
                  

On our dataset, we obtained the iteration-wise evolution of CC and MAD, and plotted in Fig. B1
                     (a) and (b) respectively. Interestingly, a maximum CC of 99.86% and a minimum MAD of 0.075mm2 are achieved respectively at the 28-th and the 100-th iterations. Interestingly, the aforementioned CC surpasses the manually obtained CC of 99.84%. Unfortunately, as asserted earlier, measures such as CC and MAD that are only based on areas are inadequate for correctly capturing algorithmic performance.

@&#REFERENCES@&#

