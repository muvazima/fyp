@&#MAIN-TITLE@&#The general design of asymptotic unrestricted polar quantizers with square cells

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The design of asymptotic unrestricted polar quantizer with square cells was done.


                        
                        
                           
                           The design was done in general manner, i.e. for any compression function.


                        
                        
                           
                           The design was done for variable variance.


                        
                        
                           
                           Using μ-law companding function, robust polar quantizers were designed.


                        
                        
                           
                           Very good performances are achieved and proved by simulation.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Unrestricted polar quantizer

Square cells




                     μ-law companding function

Gaussian source

Minimal moment of inertia

@&#ABSTRACT@&#


               
               
                  The aim of this paper is the presentation of the designing of asymptotic unrestricted polar quantizers with square cells, since it is known that square cells give minimal moment of inertia, which leads to minimization of distortion. Until now, polar quantizers with square cells have been designed only for the optimal companding function and their performances have been analyzed only for the stationary variance. In this paper, the design is done in a general manner, i.e. it is valid for any companding function and performances are analyzed in the wide range of variances. After that, this general design is applied for the logarithmic μ-law companding function. It is important that expressions for the numbers of magnitude and phase levels are obtained in the closed form, which simplifies the design. It is shown that the proposed polar quantizer has better performances (more than 3 dB higher the maximal and the average SQNR (signal-to-quantization noise ratio)) than the corresponding scalar quantizer with μ-law. Simulation is performed, and it is shown that theoretical and simulation results are matched very well. It is shown that the proposed polar quantizer can be used both for stationary and non-stationary signals, choosing the appropriate value of μ. This quantizer can be widely used, for all signals with Gaussian distribution.
               
            

@&#INTRODUCTION@&#

Quantizers are one of the main parts of A/D (analog-to-digital) converters, but they can also be used for signal compression. Hence, quantizers are very important parts of modern systems and the design of quantizers is very topical. Quantizers are often designed for Gaussian source, since a lot of signals can be modeled with Gaussian distribution. Furthermore, quantizers designed for Gaussian distribution can be used for signals with other distributions, passing these signals through an appropriate filter [1].

Vector quantizers have better performances than scalar quantizers, but on the other hand they are more complex and their complexity increases with increasing of dimension. Two-dimensional vector quantizers are much simpler compared to vector quantizers with higher dimensions, but they still have better performances than scalar quantizers, therefore they are very used in practice. For two-dimensional circularly symmetric sources (such as two-dimensional memoryless Gaussian source) it is much easier to design two-dimensional vector quantizers in polar coordinates (r-magnitude, ϕ-phase) than in Cartesian coordinates. Such two-dimensional vector quantizers, designed in polar coordinates, are called polar quantizers. The magnitude r is usually quantized using the companding technique with some companding function 
                        g
                        (
                        r
                        )
                     . Polar quantizers can be restricted (also called product, where the numbers of phase levels are the same for all magnitude levels) and unrestricted (where the number of phase levels is optimized for each magnitude level).

Polar quantization has been considered in many papers. Papers [2–4] consider the unrestricted polar quantization with the optimal companding function. The uniform polar quantization is considered in [5,6]. Paper [7] considers product polar quantization with a companding function which is optimal for scalar but not for polar quantization. In [8], embedded product and unrestricted polar quantizers are considered. For the polar quantizer from [9], numbers of magnitude and phase levels are found by trying all possible combinations in a brute force manner, which is exhausting and it does not provide optimal solution for higher bit-rates. In [10] the polar quantizer is designed using an iterative algorithm, which can be computationally complex for higher bit-rates. In all these papers [2–10], polar quantizers are designed for the stationary variance, i.e. without the analysis of robustness. In [11], an n-dimensional vector quantizer is considered, but for Laplacian PDF. Product polar quantizer with A-law, considering high values of A, was designed in [12], for audio signals, but without exact definition of distortion and without optimization of quantizerʼs parameters. In [13], product polar quantization with μ-law was considered, but also without optimization of parameters of the quantizer.

In this paper, the design of the asymptotic unrestricted polar quantizers for the two-dimensional memoryless Gaussian source is done, applying the principle of square cells, since it was proved in [2] that square cells have the minimal moment of inertia of all rectangular cells, which is important for the minimization of distortion, since the moment of inertia is used in Bennettʼs integral for vector quantizers [14]. Until now, the principle of square cells was exploited only for the design of polar quantizers with optimal companding function for stationary variance [2,4,15]. In this paper, the design of polar quantizers with square cells is done in a general manner, i.e. for any companding function 
                        g
                        (
                        r
                        )
                      and for variable variance. After that, this general theory is applied for the design of the unrestricted polar quantizer with μ-law companding function, which has the following advantages compared to the optimal companding function: expressions for thresholds and representation levels are obtained in the closed form, while for the optimal companding function it is necessary to solve integral equations [16,17]; furthermore, the optimal companding function has very poor robustness and it is suitable only for stationary signals (with constant variances) but not for non-stationary signals (whose variances change in time), while μ-law companding function is much more flexible, since it depends on the parameter μ and choosing the appropriate value of μ the quantizer can be adjusted to different types of signals. It is shown in this paper that small values of μ should be used for stationary signals, while high values of μ should be used for non-stationary signals since quantizer becomes very robust. Another important result from this paper is that expressions for numbers of magnitude and phase levels and for distortion are obtained in the closed form, which significantly simplifies the design of quantizer. The analysis of performances of the quantizer is done in the wide range of variances, for different values of the parameter μ. The asymptotic analysis [2–5,11–14] of the polar quantizer is applied; therefore this model should be used for medium and high bit-rates. The optimization of the parameter μ is done, to achieve the maximal SQNR. Simulation is done and it is shown that theoretical and simulation results are matched very well, which proves the developed theory. It is shown that the unrestricted polar quantizer has better performances than the corresponding scalar quantizer: higher the maximal SQNR for 3.34 dB and higher the average SQNR in the wide range of variances for 3.63 dB. Also, it was shown that our μ-law polar quantizer is much more robust than the optimal and the uniform polar quantizers.

This paper is organized as follows. In Section 2, the unrestricted polar quantizer with square cells is designed in a general manner, i.e. for any companding function. In Section 3, the design of the unrestricted polar quantizer for μ-law is presented, its performances are analyzed and numerical results obtained by theory and by simulation are presented. Section 4 concludes the paper.

Letʼs consider the two-dimensional memoryless Gaussian source, which is defined with the probability density function (PDF) in Cartesian coordinates 
                        f
                        (
                        x
                        ,
                        y
                        ,
                        σ
                        )
                        =
                        
                           1
                           
                              2
                              π
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                           
                        
                        exp
                        (
                        −
                        
                           
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                           
                           
                              2
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                           
                        
                        )
                     . Polar coordinates are defined as 
                        r
                        =
                        
                           
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                           
                        
                      and 
                        ϕ
                        =
                        arctan
                        
                        
                           y
                           x
                        
                     , where r is called magnitude and ϕ is called phase. In polar coordinates, PDF for this Gaussian source becomes
                        
                           (1)
                           
                              f
                              (
                              r
                              ,
                              ϕ
                              ,
                              σ
                              )
                              =
                              
                                 r
                                 
                                    2
                                    π
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              exp
                              
                                 (
                                 −
                                 
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                    
                                    
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 )
                              
                              ,
                           
                        
                      where 
                        
                           
                              σ
                           
                           
                              2
                           
                        
                      is the variance (i.e. power) of the Gaussian source. PDFs of r and ϕ coordinates are 
                        
                           
                              f
                           
                           
                              r
                           
                        
                        (
                        r
                        ,
                        σ
                        )
                        =
                        
                           
                              ∫
                           
                           
                              0
                           
                           
                              2
                              π
                           
                        
                        f
                        (
                        r
                        ,
                        ϕ
                        ,
                        σ
                        )
                        
                        d
                        ϕ
                        =
                        
                           r
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                        
                        exp
                        (
                        −
                        
                           
                              
                                 r
                              
                              
                                 2
                              
                           
                           
                              2
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                           
                        
                        )
                      which is Rayleigh distribution and 
                        
                           
                              f
                           
                           
                              ϕ
                           
                        
                        (
                        ϕ
                        ,
                        σ
                        )
                        =
                        
                           
                              ∫
                           
                           
                              0
                           
                           
                              ∞
                           
                        
                        f
                        (
                        r
                        ,
                        ϕ
                        ,
                        σ
                        )
                        
                        d
                        r
                        =
                        
                           1
                           
                              2
                              π
                           
                        
                      which is uniform distribution. Since the phase has the uniform distribution, this source is circularly-symmetric. Contours where 
                        f
                        (
                        r
                        ,
                        ϕ
                        ,
                        σ
                        )
                      is constant are concentric circles. According to the geometric principle for the design of quantizers [15], cells of quantizer should be placed on contours where PDF is constant, while distances between contours are inversely proportional to the value of PDF. Therefore, two-dimensional quantizer can be easily designed in the polar coordinates, putting cells on concentric magnitude rings.

Magnitude r is quantized using the companding technique with companding function 
                        g
                        (
                        r
                        )
                     , while phase ϕ is quantized using the uniform quantization, since it has uniform PDF. Letʼs N denotes the total number of cells of the quantizer; L denotes the number of the magnitude levels; 
                        
                           
                              M
                           
                           
                              i
                           
                        
                     , 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        L
                     , denotes the number of phase levels on the ith magnitude level; 
                        
                           
                              r
                           
                           
                              max
                           
                        
                      denotes the maximal magnitude of the quantizer; 
                        
                           
                              r
                           
                           
                              i
                           
                        
                     , 
                        i
                        =
                        0
                        ,
                        …
                        ,
                        L
                     , denote thresholds and 
                        
                           
                              m
                           
                           
                              i
                           
                        
                     , 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        L
                     , denote representation levels for the quantization of magnitude 
                        r
                        ;
                        
                           
                              ϕ
                           
                           
                              i
                              ,
                              j
                           
                        
                        =
                        j
                        2
                        π
                        /
                        
                           
                              M
                           
                           
                              i
                           
                        
                     , 
                        j
                        =
                        0
                        ,
                        …
                        ,
                        
                           
                              M
                           
                           
                              i
                           
                        
                     , denote thresholds and 
                        
                           
                              ψ
                           
                           
                              i
                              ,
                              j
                           
                        
                        =
                        (
                        j
                        −
                        1
                        /
                        2
                        )
                        2
                        π
                        /
                        
                           
                              M
                           
                           
                              i
                           
                        
                     , 
                        j
                        =
                        1
                        ,
                        …
                        ,
                        
                           
                              M
                           
                           
                              i
                           
                        
                      denote representation levels for the quantization of phase ϕ on the ith magnitude level. It holds that
                        
                           (2)
                           
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 L
                              
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              =
                              N
                              .
                           
                        
                      Cells of the polar quantizer are defined as 
                        
                           
                              S
                           
                           
                              i
                              ,
                              j
                           
                        
                        =
                        {
                        (
                        r
                        ,
                        ϕ
                        )
                        |
                        
                           
                              r
                           
                           
                              i
                              −
                              1
                           
                        
                        ⩽
                        r
                        <
                        
                           
                              r
                           
                           
                              i
                           
                        
                        ,
                        
                        
                           
                              ϕ
                           
                           
                              i
                              ,
                              j
                              −
                              1
                           
                        
                        ⩽
                        ϕ
                        <
                        
                           
                              ϕ
                           
                           
                              i
                              ,
                              j
                           
                        
                        }
                     , and within each cell 
                        
                           
                              S
                           
                           
                              i
                              ,
                              j
                           
                        
                      there is one representation point 
                        (
                        
                           
                              m
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              ψ
                           
                           
                              i
                              ,
                              j
                           
                        
                        )
                     . Therefore we can define the polar quantization Q as a mapping 
                        Q
                        :
                        
                           
                              R
                           
                           
                              2
                           
                        
                        →
                        
                           
                              R
                           
                           
                              2
                           
                        
                     , 
                        Q
                        [
                        (
                        r
                        ,
                        ϕ
                        )
                        ]
                        =
                        (
                        
                           
                              m
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              ψ
                           
                           
                              i
                              ,
                              j
                           
                        
                        )
                        ,
                        
                        ∀
                        (
                        r
                        ,
                        ϕ
                        )
                        ∈
                        
                           
                              S
                           
                           
                              i
                              ,
                              j
                           
                        
                     .

Our aim is to design the unrestricted polar quantizer with square cells in general way, i.e. for any companding function 
                        g
                        (
                        r
                        )
                     , and to analyze its performances in the wide range of input variances, i.e. for a variable variance 
                        
                           
                              σ
                           
                           
                              2
                           
                        
                     . Letʼs define 
                        
                           
                              Δ
                           
                           
                              r
                           
                        
                        (
                        i
                        )
                      as the radial width and 
                        
                           
                              Δ
                           
                           
                              ϕ
                           
                        
                        (
                        i
                        )
                      as the angular width of cells on the ith magnitude level. If we introduce the parameter 
                        Δ
                        =
                        
                           
                              r
                           
                           
                              max
                           
                        
                        /
                        L
                     , for the asymptotic analysis it holds that 
                        
                           
                              g
                           
                           
                              ′
                           
                        
                        (
                        
                           
                              m
                           
                           
                              i
                           
                        
                        )
                        =
                        
                           Δ
                           
                              
                                 
                                    Δ
                                 
                                 
                                    r
                                 
                              
                              (
                              i
                              )
                           
                        
                        =
                        
                           
                              
                                 r
                              
                              
                                 max
                              
                           
                           
                              L
                              
                                 
                                    Δ
                                 
                                 
                                    r
                                 
                              
                              (
                              i
                              )
                           
                        
                      
                     [16]. Parameters 
                        
                           
                              Δ
                           
                           
                              r
                           
                        
                        (
                        i
                        )
                      and 
                        
                           
                              Δ
                           
                           
                              ϕ
                           
                        
                        (
                        i
                        )
                      can be defined as:
                        
                           (3)
                           
                              
                                 
                                    Δ
                                 
                                 
                                    r
                                 
                              
                              (
                              i
                              )
                              =
                              
                                 
                                    
                                       r
                                    
                                    
                                       max
                                    
                                 
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    L
                                 
                              
                              ;
                              
                              
                                 
                                    Δ
                                 
                                 
                                    ϕ
                                 
                              
                              (
                              i
                              )
                              =
                              
                                 
                                    2
                                    π
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                              
                              .
                           
                        
                      In [2], it was proved that square cells have minimal moment of inertia of all rectangular cells, which leads to the minimization of the distortion. Therefore, this principle of square cells will be applied in this paper for the design of polar quantizers. This principle denotes the fact that cells have nearly square shape [2], which means that the radial width 
                        
                           
                              Δ
                           
                           
                              r
                           
                        
                        (
                        i
                        )
                      and the angular width 
                        
                           
                              Δ
                           
                           
                              ϕ
                           
                        
                        (
                        i
                        )
                      of cells on the ith magnitude level are equal (see Fig. 1
                     ), which is defined with equation
                        
                           (4)
                           
                              
                                 
                                    Δ
                                 
                                 
                                    r
                                 
                              
                              (
                              i
                              )
                              =
                              
                                 
                                    Δ
                                 
                                 
                                    ϕ
                                 
                              
                              (
                              i
                              )
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              L
                              .
                           
                        
                     
                  

It is clear that numbers of magnitude and phase levels (L and 
                        
                           
                              M
                           
                           
                              i
                           
                        
                     ) have to be integers. But, in the process of the theoretical analysis, we can allow that numbers of magnitude and phase levels can be real numbers, denoted with 
                        
                           L
                           ˜
                        
                      and 
                        
                           
                              
                                 M
                                 ˜
                              
                           
                           
                              i
                           
                        
                     . This approach is usual in the asymptotic analysis [4,6]. We use this approach since we want to obtain the final expressions in the closed form.

Using (3) and (4), it is obtained that
                        
                           (5)
                           
                              
                                 
                                    
                                       M
                                       ˜
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    2
                                    π
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          g
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    L
                                 
                                 
                                    
                                       r
                                    
                                    
                                       max
                                    
                                 
                              
                              .
                           
                        
                      Putting (5) into (2), multiplying and dividing by 
                        
                           
                              Δ
                           
                           
                              r
                           
                        
                        (
                        i
                        )
                     , using (3) for 
                        
                           
                              Δ
                           
                           
                              r
                           
                        
                        (
                        i
                        )
                      in the denominator and changing summation with integration (
                        ∑
                        →
                        ∫
                     , 
                        
                           
                              m
                           
                           
                              i
                           
                        
                        →
                        r
                     , 
                        
                           
                              Δ
                           
                           
                              r
                           
                        
                        (
                        i
                        )
                        →
                        d
                        r
                     ) [4], it follows that
                        
                           (6)
                           
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 L
                              
                              
                                 
                                    
                                       M
                                       ˜
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    2
                                    π
                                    L
                                 
                                 
                                    
                                       r
                                    
                                    
                                       max
                                    
                                 
                              
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 L
                              
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    g
                                 
                                 
                                    ′
                                 
                              
                              (
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              )
                              
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    i
                                    )
                                 
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    i
                                    )
                                 
                              
                              =
                              
                                 
                                    2
                                    π
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       max
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 L
                              
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    )
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    Δ
                                 
                                 
                                    r
                                 
                              
                              (
                              i
                              )
                              =
                              
                                 
                                    2
                                    π
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       max
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ∫
                                 0
                                 
                                    
                                       r
                                    
                                    
                                       max
                                    
                                 
                              
                              r
                              
                                 
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    r
                                    )
                                    )
                                 
                                 
                                    2
                                 
                              
                              
                              d
                              r
                              =
                              N
                              .
                           
                        
                      From (6) it is obtained that
                        
                           (7)
                           
                              
                                 L
                                 ˜
                              
                              =
                              
                                 
                                    r
                                 
                                 
                                    max
                                 
                              
                              
                                 
                                    N
                                    
                                       2
                                       π
                                       
                                          
                                             ∫
                                          
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   max
                                                
                                             
                                          
                                       
                                       r
                                       
                                          
                                             (
                                             
                                                
                                                   g
                                                
                                                
                                                   ′
                                                
                                             
                                             (
                                             r
                                             )
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       
                                       d
                                       r
                                    
                                 
                              
                              .
                           
                        
                      In (5) and (6) we use L (not 
                        
                           L
                           ˜
                        
                     ) since until (7) we do not know that this parameter takes a real value. Changing (7) into (5), it is obtained that
                        
                           (8)
                           
                              
                                 
                                    
                                       M
                                       ˜
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    g
                                 
                                 
                                    ′
                                 
                              
                              (
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              )
                              
                                 
                                    
                                       2
                                       π
                                       N
                                    
                                    
                                       
                                          
                                             ∫
                                          
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   max
                                                
                                             
                                          
                                       
                                       r
                                       
                                          
                                             (
                                             
                                                
                                                   g
                                                
                                                
                                                   ′
                                                
                                             
                                             (
                                             r
                                             )
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       
                                       d
                                       r
                                    
                                 
                              
                              .
                           
                        
                     
                  

For practical realization, we have to use integer value 
                        L
                        =
                        [
                        
                           L
                           ˜
                        
                        ]
                     , where [x] denotes the nearest integer to the real number x. Also, we have to calculate integer values for the numbers of phase levels 
                        
                           
                              M
                           
                           
                              i
                           
                        
                        =
                        [
                        
                           
                              
                                 M
                                 ˜
                              
                           
                           
                              i
                           
                        
                        ]
                     , 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        L
                     . If 
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              L
                           
                        
                        
                           
                              M
                           
                           
                              i
                           
                        
                        =
                        N
                      then calculated values of parameters 
                        
                           
                              M
                           
                           
                              i
                           
                        
                      are final values which will be used in the practical realization. However, due to the rounding of 
                        
                           L
                           ˜
                        
                      and 
                        
                           
                              
                                 M
                                 ˜
                              
                           
                           
                              i
                           
                        
                     , it is possible that 
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              L
                           
                        
                        
                           
                              M
                           
                           
                              i
                           
                        
                      is very close but not equal to N. In this case (when 
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              L
                           
                        
                        
                           
                              M
                           
                           
                              i
                           
                        
                        ≠
                        N
                     ) we have to slightly modify values of parameters 
                        
                           
                              M
                           
                           
                              i
                           
                        
                     , 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        L
                     , to satisfy the condition 
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              L
                           
                        
                        
                           
                              M
                           
                           
                              i
                           
                        
                        =
                        N
                     . We define 
                        K
                        =
                        |
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              L
                           
                        
                        
                           
                              M
                           
                           
                              i
                           
                        
                        −
                        N
                        |
                     . If 
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              L
                           
                        
                        
                           
                              M
                           
                           
                              i
                           
                        
                        >
                        N
                      then K of L parameters 
                        
                           
                              M
                           
                           
                              i
                           
                        
                      should be decreased by 1, while if 
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              L
                           
                        
                        
                           
                              M
                           
                           
                              i
                           
                        
                        <
                        N
                      then K of L parameters 
                        
                           
                              M
                           
                           
                              i
                           
                        
                      should be increased by 1. Selection of K parameters 
                        
                           
                              M
                           
                           
                              i
                           
                        
                      that will be modified (decreased or increased by 1) should be done with the aim to make the minimal rounding error. This process of modification of 
                        
                           
                              M
                           
                           
                              i
                           
                        
                      parameters is described with the following algorithm.


                     
                        Algorithm 1
                        
                           
                              
                                 1:
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       [
                                       
                                          
                                             
                                                M
                                                ˜
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ]
                                    , 
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       L
                                    ;


                                    
                                       K
                                       =
                                       |
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             L
                                          
                                       
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       N
                                       |
                                    ;

if 
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             L
                                          
                                       
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                       >
                                       N
                                     then

 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             
                                                M
                                                ˜
                                             
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       1
                                       )
                                    , 
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       L
                                    ; /⁎ 
                                       
                                          
                                             a
                                          
                                          
                                             i
                                          
                                       
                                     denotes the rounding error of 
                                       
                                          
                                             
                                                M
                                                ˜
                                             
                                          
                                          
                                             i
                                          
                                       
                                     if 
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                     will decrease by 1 ⁎/

 Letʼs 
                                       
                                          
                                             p
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             K
                                          
                                       
                                     denote indexes of K the smallest errors   
                                       
                                          
                                             a
                                          
                                          
                                             i
                                          
                                       
                                    , 
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       L
                                    ;

 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             p
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             M
                                          
                                          
                                             p
                                             j
                                          
                                       
                                       −
                                       1
                                    , 
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       K
                                    ; /⁎ We decrease (by 1) K parameters 
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                     whose decreasing by 1 causes the smallest error ⁎/

endif;

if 
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             L
                                          
                                       
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                       <
                                       N
                                     then

 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       1
                                       )
                                       −
                                       
                                          
                                             
                                                M
                                                ˜
                                             
                                          
                                          
                                             i
                                          
                                       
                                    , 
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       L
                                    ; /⁎ 
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                     denotes the rounding error of 
                                       
                                          
                                             
                                                M
                                                ˜
                                             
                                          
                                          
                                             i
                                          
                                       
                                     if 
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                     will increase by 1 ⁎/

 Letʼs 
                                       
                                          
                                             p
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             K
                                          
                                       
                                     denote indexes of K the smallest errors   
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                    , 
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       L
                                    ;

 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             p
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             M
                                          
                                          
                                             p
                                             j
                                          
                                       
                                       +
                                       1
                                    , 
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       K
                                    ; /⁎ We increase (by 1) K parameters 
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                     whose increasing by 1 causes the smallest error ⁎/

endif;

Text between /⁎ and ⁎/ denotes comments and explanations. Algorithm 1 represents one method for the rounding of 
                        
                           
                              
                                 M
                                 ˜
                              
                           
                           
                              i
                           
                        
                      to integer values, with the aim of minimization of the rounding error. Other methods are also possible. However, it should be mentioned that rounding of 
                        
                           
                              
                                 M
                                 ˜
                              
                           
                           
                              i
                           
                        
                      to integer values has negligible impact on the performances.

According to [4], the granular distortion (in the area 
                        r
                        ⩽
                        
                           
                              r
                           
                           
                              max
                           
                        
                     ) is defined as:
                        
                           (9)
                           
                              
                                 
                                    D
                                 
                                 
                                    g
                                 
                              
                              (
                              σ
                              )
                              =
                              
                                 1
                                 2
                              
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 L
                              
                              
                                 
                                    f
                                 
                                 
                                    r
                                 
                              
                              (
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              ,
                              σ
                              )
                              
                                 (
                                 
                                    
                                       
                                          r
                                       
                                       
                                          max
                                       
                                       
                                          2
                                       
                                    
                                    
                                       12
                                       
                                          
                                             (
                                             
                                                
                                                   g
                                                
                                                
                                                   ′
                                                
                                             
                                             (
                                             
                                                
                                                   m
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             m
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       3
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 )
                              
                              
                                 
                                    Δ
                                 
                                 
                                    r
                                 
                              
                              (
                              i
                              )
                              .
                           
                        
                      Based on (3) it is obtained that
                        
                           (10)
                           
                              
                                 
                                    D
                                 
                                 
                                    g
                                 
                              
                              (
                              σ
                              )
                              =
                              
                                 1
                                 2
                              
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 L
                              
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    σ
                                    )
                                 
                                 12
                              
                              
                                 (
                                 
                                    
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       i
                                       )
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             ϕ
                                          
                                       
                                       (
                                       i
                                       )
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              
                                 
                                    Δ
                                 
                                 
                                    r
                                 
                              
                              (
                              i
                              )
                              .
                           
                        
                      Based on (4), it follows that 
                        
                           
                              D
                           
                           
                              g
                           
                        
                        (
                        σ
                        )
                        =
                        
                           1
                           12
                        
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              L
                           
                        
                        
                           
                              f
                           
                           
                              r
                           
                        
                        (
                        
                           
                              m
                           
                           
                              i
                           
                        
                        ,
                        σ
                        )
                        
                           
                              (
                              
                                 
                                    Δ
                                 
                                 
                                    r
                                 
                              
                              (
                              i
                              )
                              )
                           
                           
                              2
                           
                        
                        
                           
                              Δ
                           
                           
                              r
                           
                        
                        (
                        i
                        )
                     . Using (3), it is obtained that 
                        
                           
                              D
                           
                           
                              g
                           
                        
                        (
                        σ
                        )
                        =
                        
                           
                              
                                 r
                              
                              
                                 max
                              
                              
                                 2
                              
                           
                           
                              12
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           
                        
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              L
                           
                        
                        
                           
                              
                                 
                                    f
                                 
                                 
                                    r
                                 
                              
                              (
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              ,
                              σ
                              )
                           
                           
                              
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 )
                              
                              
                                 2
                              
                           
                        
                        
                           
                              Δ
                           
                           
                              r
                           
                        
                        (
                        i
                        )
                     . Changing summation with integration, it follows that
                        
                           (11)
                           
                              
                                 
                                    D
                                 
                                 
                                    g
                                 
                              
                              (
                              σ
                              )
                              =
                              
                                 
                                    
                                       r
                                    
                                    
                                       max
                                    
                                    
                                       2
                                    
                                 
                                 
                                    12
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 ∫
                                 0
                                 
                                    
                                       r
                                    
                                    
                                       max
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    r
                                    ,
                                    σ
                                    )
                                 
                                 
                                    
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       r
                                       )
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                              
                              d
                              r
                              .
                           
                        
                      According to [13], the overload distortion is defined as:
                        
                           (12)
                           
                              
                                 
                                    D
                                 
                                 
                                    ov
                                 
                              
                              (
                              σ
                              )
                              =
                              
                                 1
                                 2
                              
                              
                                 ∫
                                 
                                    
                                       r
                                    
                                    
                                       max
                                    
                                 
                                 ∞
                              
                              
                                 [
                                 
                                    
                                       (
                                       r
                                       −
                                       
                                          
                                             r
                                          
                                          
                                             max
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       r
                                       
                                          
                                             r
                                          
                                          
                                             max
                                          
                                       
                                       
                                          
                                             π
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       3
                                       
                                          
                                             M
                                          
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ]
                              
                              
                                 
                                    f
                                 
                                 
                                    r
                                 
                              
                              (
                              r
                              ,
                              σ
                              )
                              
                              d
                              r
                              =
                              
                                 1
                                 2
                              
                              
                                 [
                                 X
                                 (
                                 σ
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             max
                                          
                                       
                                       
                                          
                                             π
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       3
                                       
                                          
                                             M
                                          
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 Y
                                 (
                                 σ
                                 )
                                 ]
                              
                              ,
                           
                        
                      where
                        
                           (13)
                           
                              X
                              (
                              σ
                              )
                              =
                              
                                 ∫
                                 
                                    
                                       r
                                    
                                    
                                       max
                                    
                                 
                                 ∞
                              
                              
                                 
                                    (
                                    r
                                    −
                                    
                                       
                                          r
                                       
                                       
                                          max
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    r
                                 
                              
                              (
                              r
                              ,
                              σ
                              )
                              
                              d
                              r
                              =
                              σ
                              
                                 (
                                 2
                                 σ
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                max
                                             
                                             
                                                2
                                             
                                          
                                          
                                             2
                                             
                                                
                                                   σ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       2
                                       π
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       max
                                    
                                 
                                 
                                    Erfc
                                 
                                 
                                    (
                                    
                                       
                                          
                                             r
                                          
                                          
                                             max
                                          
                                       
                                       
                                          
                                             2
                                          
                                          σ
                                       
                                    
                                    )
                                 
                                 )
                              
                              ,
                           
                        
                     
                     
                        
                           (14)
                           
                              Y
                              (
                              σ
                              )
                              =
                              
                                 ∫
                                 
                                    
                                       r
                                    
                                    
                                       max
                                    
                                 
                                 ∞
                              
                              r
                              
                                 
                                    f
                                 
                                 
                                    r
                                 
                              
                              (
                              r
                              ,
                              σ
                              )
                              
                              d
                              r
                              =
                              
                                 
                                    e
                                 
                                 
                                    −
                                    
                                       
                                          
                                             r
                                          
                                          
                                             max
                                          
                                          
                                             2
                                          
                                       
                                       
                                          2
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    max
                                 
                              
                              +
                              
                                 
                                    π
                                    2
                                 
                              
                              σ
                              
                                 Erfc
                              
                              
                                 (
                                 
                                    
                                       
                                          r
                                       
                                       
                                          max
                                       
                                    
                                    
                                       
                                          2
                                       
                                       σ
                                    
                                 
                                 )
                              
                              .
                           
                        
                     
                  

The total distortion is 
                        D
                        (
                        σ
                        )
                        =
                        
                           
                              D
                           
                           
                              g
                           
                        
                        (
                        σ
                        )
                        +
                        
                           
                              D
                           
                           
                              ov
                           
                        
                        (
                        σ
                        )
                     , where 
                        
                           
                              D
                           
                           
                              g
                           
                        
                        (
                        σ
                        )
                      is given with (11) and 
                        
                           
                              D
                           
                           
                              ov
                           
                        
                        (
                        σ
                        )
                      is given with (12). SQNR is defined as:
                        
                           (15)
                           
                              
                                 SQNR
                              
                              (
                              σ
                              )
                              =
                              10
                              
                                 
                                    log
                                 
                                 
                                    10
                                 
                              
                              
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    D
                                    (
                                    σ
                                    )
                                 
                              
                              
                              [
                              
                                 dB
                              
                              ]
                              .
                           
                        
                      The design of quantizers is always done for some referent variance 
                        
                           
                              σ
                           
                           
                              0
                           
                           
                              2
                           
                        
                     . This means that the parameter of quantizer 
                        
                           
                              r
                           
                           
                              max
                           
                        
                      have to be calculated for 
                        
                           
                              σ
                           
                           
                              0
                           
                           
                              2
                           
                        
                     , by minimization of the total distortion 
                        D
                        (
                        
                           
                              σ
                           
                           
                              0
                           
                        
                        )
                     , i.e., by solving the equation 
                        
                           
                              d
                              D
                              (
                              
                                 
                                    σ
                                 
                                 
                                    0
                                 
                              
                              )
                           
                           
                              d
                              
                                 
                                    r
                                 
                                 
                                    max
                                 
                              
                           
                        
                        =
                        0
                     . This value of 
                        
                           
                              r
                           
                           
                              max
                           
                        
                      is used for any other variance 
                        
                           
                              σ
                           
                           
                              2
                           
                        
                     .

These quantizers are designed for uncorrelated signals, but they can be also applied for correlated signals, putting them into DPCM loop [12,16]. In this way, the correlation of the signal is exploited, increasing SQNR of the product polar quantizer by the prediction gain of the linear predictor.

The previous theory is general since it was developed for any companding function 
                           g
                           (
                           r
                           )
                        . Now, this theory will be applied for the design of the unrestricted polar quantizer with logarithmic μ-law companding function, which is defined as:
                           
                              (16)
                              
                                 g
                                 (
                                 r
                                 )
                                 =
                                 
                                    
                                       
                                          r
                                       
                                       
                                          max
                                       
                                    
                                    
                                       ln
                                       (
                                       μ
                                       +
                                       1
                                       )
                                    
                                 
                                 ln
                                 
                                    (
                                    1
                                    +
                                    μ
                                    
                                       r
                                       
                                          
                                             r
                                          
                                          
                                             max
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           μ
                           >
                           0
                         is a parameter. Thresholds and representation levels for the magnitude r are defined with the following expressions:
                           
                              (17)
                              
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          r
                                       
                                       
                                          max
                                       
                                    
                                    μ
                                 
                                 
                                    (
                                    
                                       
                                          (
                                          μ
                                          +
                                          1
                                          )
                                       
                                       
                                          i
                                          /
                                          L
                                       
                                    
                                    −
                                    1
                                    )
                                 
                                 ,
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          r
                                       
                                       
                                          max
                                       
                                    
                                    μ
                                 
                                 
                                    (
                                    
                                       
                                          (
                                          μ
                                          +
                                          1
                                          )
                                       
                                       
                                          (
                                          i
                                          −
                                          
                                             1
                                             2
                                          
                                          )
                                          /
                                          L
                                       
                                    
                                    −
                                    1
                                    )
                                 
                                 .
                              
                           
                         We can see that thresholds and representation levels are given in the closed form, i.e. there is no need to solve integral equation which is the case for the optimal companding function. Therefore, the realization of the quantizer is simplified. Expressions (7) and (8) for the numbers of magnitude and phase levels become:
                           
                              (19)
                              
                                 
                                    L
                                    ˜
                                 
                                 =
                                 ln
                                 (
                                 μ
                                 +
                                 1
                                 )
                                 
                                    
                                       (
                                       
                                          N
                                          
                                             2
                                             π
                                          
                                       
                                       )
                                    
                                    
                                       1
                                       /
                                       2
                                    
                                 
                                 
                                    
                                       (
                                       −
                                       1
                                       +
                                       
                                          1
                                          
                                             1
                                             +
                                             μ
                                          
                                       
                                       +
                                       ln
                                       (
                                       μ
                                       +
                                       1
                                       )
                                       )
                                    
                                    
                                       −
                                       1
                                       /
                                       2
                                    
                                 
                                 ;
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       
                                          M
                                          ˜
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          r
                                       
                                       
                                          max
                                       
                                    
                                 
                                 
                                    
                                       μ
                                       
                                          
                                             2
                                             π
                                             N
                                          
                                       
                                    
                                    
                                       (
                                       1
                                       +
                                       μ
                                       
                                          
                                             
                                                m
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                max
                                             
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       (
                                       −
                                       1
                                       +
                                       
                                          1
                                          
                                             1
                                             +
                                             μ
                                          
                                       
                                       +
                                       ln
                                       (
                                       μ
                                       +
                                       1
                                       )
                                       )
                                    
                                    
                                       −
                                       1
                                       /
                                       2
                                    
                                 
                                 .
                              
                           
                         It is very important that expressions for 
                           
                              L
                              ˜
                           
                         and 
                           
                              
                                 
                                    M
                                    ˜
                                 
                              
                              
                                 i
                              
                           
                         are obtained in the closed form, which significantly simplifies the design of quantizer. For practical realization we should use integer values 
                           L
                           =
                           [
                           
                              L
                              ˜
                           
                           ]
                         and 
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                         obtained using Algorithm 1.

If condition 
                           μ
                           
                              
                                 m
                              
                              
                                 i
                              
                           
                           /
                           
                              
                                 r
                              
                              
                                 max
                              
                           
                           ≫
                           1
                         is satisfied (it is valid for high i, i.e. for higher number of levels), then expression (20) becomes
                           
                              (21)
                              
                                 
                                 
                                    
                                       
                                          M
                                          ˜
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ≡
                                 
                                    M
                                    ˜
                                 
                                 =
                                 
                                    
                                       2
                                       π
                                       N
                                    
                                 
                                 
                                    
                                       (
                                       −
                                       1
                                       +
                                       
                                          1
                                          
                                             1
                                             +
                                             μ
                                          
                                       
                                       +
                                       ln
                                       (
                                       μ
                                       +
                                       1
                                       )
                                       )
                                    
                                    
                                       −
                                       1
                                       /
                                       2
                                    
                                 
                                 .
                              
                           
                         We can see that 
                           
                              
                                 
                                    M
                                    ˜
                                 
                              
                              
                                 i
                              
                           
                         (and therefore 
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                        ) becomes constant, i.e. it does not depend on i. Condition 
                           μ
                           
                              
                                 m
                              
                              
                                 i
                              
                           
                           /
                           
                              
                                 r
                              
                              
                                 max
                              
                           
                           ≫
                           1
                         can be written more specifically as 
                           μ
                           
                              
                                 m
                              
                              
                                 i
                              
                           
                           /
                           
                              
                                 r
                              
                              
                                 max
                              
                           
                           >
                           k
                        , where k is some positive number. Based on (18) and (19), it is obtained that 
                           μ
                           
                              
                                 m
                              
                              
                                 i
                              
                           
                           /
                           
                              
                                 r
                              
                              
                                 max
                              
                           
                           >
                           k
                         is equivalent to 
                           i
                           >
                           t
                           ≡
                           ⌊
                           0.5
                           +
                           ln
                           (
                           k
                           +
                           1
                           )
                           
                              
                                 N
                              
                              
                                 1
                                 /
                                 2
                              
                           
                           
                              
                                 (
                                 2
                                 π
                                 (
                                 −
                                 1
                                 +
                                 
                                    1
                                    
                                       1
                                       +
                                       μ
                                    
                                 
                                 +
                                 ln
                                 (
                                 μ
                                 +
                                 1
                                 )
                                 )
                                 )
                              
                              
                                 −
                                 1
                                 /
                                 2
                              
                           
                           ⌋
                        , where 
                           ⌊
                           x
                           ⌋
                         denotes the nearest integer less than or equal to x. Therefore, it can be considered that for magnitude levels 
                           i
                           >
                           t
                        , the number of phase levels is constant, which simplifies the realization of the quantizer, since instead of calculating and storing in the memory all values 
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                        , 
                           i
                           =
                           t
                           +
                           1
                           ,
                           …
                           ,
                           L
                        , it is enough to calculate and store in memory only one value 
                           
                              
                                 M
                              
                              
                                 t
                                 +
                                 1
                              
                           
                        . It is obvious that t is inversely proportional to μ. For example, for 
                           N
                           =
                           
                              
                                 128
                              
                              
                                 2
                              
                           
                        , 
                           μ
                           =
                           255
                         and 
                           k
                           =
                           10
                        , it is obtained that 
                           L
                           =
                           120
                         and 
                           t
                           =
                           53
                        , which means that for more than a half magnitude levels the number of phase levels can be considered as a constant.

Based on (11), the granular distortion becomes:
                           
                              (22)
                              
                                 
                                    
                                       D
                                    
                                    
                                       g
                                    
                                 
                                 (
                                 σ
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             ln
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       μ
                                       +
                                       1
                                       )
                                    
                                    
                                       12
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    ∫
                                    0
                                    
                                       
                                          r
                                       
                                       
                                          max
                                       
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 r
                                 ,
                                 σ
                                 )
                                 
                                    
                                       r
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       (
                                       1
                                       +
                                       
                                          
                                             
                                                r
                                             
                                             
                                                max
                                             
                                          
                                          
                                             μ
                                             r
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 d
                                 r
                                 =
                                 
                                    
                                       
                                          
                                             ln
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       μ
                                       +
                                       1
                                       )
                                    
                                    
                                       12
                                       
                                          
                                             μ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          r
                                       
                                       
                                          max
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    2
                                    
                                       
                                          μ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          e
                                       
                                       
                                          −
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   max
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                2
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       (
                                       2
                                       
                                          
                                             μ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             r
                                          
                                          
                                             max
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             (
                                             1
                                             +
                                             μ
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          2
                                          π
                                       
                                    
                                    
                                       
                                          r
                                       
                                       
                                          max
                                       
                                    
                                    μ
                                    σ
                                    
                                       Erf
                                    
                                    
                                       (
                                       
                                          
                                             
                                                r
                                             
                                             
                                                max
                                             
                                          
                                          
                                             
                                                2
                                             
                                             σ
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 .
                              
                           
                         Based on (12), and using the approximation 
                           
                              
                                 m
                              
                              
                                 L
                              
                           
                           ≈
                           
                              
                                 r
                              
                              
                                 max
                              
                           
                        , which is valid for the asymptotic analysis, the following expression for the overload distortion is obtained:
                           
                              (23)
                              
                                 
                                    
                                       D
                                    
                                    
                                       ov
                                    
                                 
                                 (
                                 σ
                                 )
                                 =
                                 
                                    1
                                    2
                                 
                                 
                                    [
                                    X
                                    (
                                    σ
                                    )
                                    +
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                max
                                             
                                          
                                          
                                             
                                                π
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                (
                                                1
                                                +
                                                μ
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          6
                                          N
                                          
                                             
                                                μ
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       (
                                       −
                                       1
                                       +
                                       
                                          1
                                          
                                             1
                                             +
                                             μ
                                          
                                       
                                       +
                                       ln
                                       (
                                       μ
                                       +
                                       1
                                       )
                                       )
                                    
                                    Y
                                    (
                                    σ
                                    )
                                    ]
                                 
                                 .
                              
                           
                         According to (13) and (14), it follows that 
                           X
                           (
                           σ
                           )
                         and 
                           Y
                           (
                           σ
                           )
                         can be expressed using 
                           
                              Erfc
                           
                           (
                           ⋅
                           )
                         function. Since functions 
                           
                              Erf
                           
                           (
                           ⋅
                           )
                         and 
                           
                              Erfc
                           
                           (
                           ⋅
                           )
                         can be approximated in the closed form with very high accuracy [18], it follows that 
                           
                              
                                 D
                              
                              
                                 g
                              
                           
                           (
                           σ
                           )
                         and 
                           
                              
                                 D
                              
                              
                                 ov
                              
                           
                           (
                           σ
                           )
                         can be expressed in the closed form, which simplifies the design.

Now, short algorithm for the designing of the final quantizer will be presented. Input data:N, μ, 
                           
                              
                                 σ
                              
                              
                                 0
                              
                           
                        , k (values of these parameters should be defined in advance). Quantizer is designed for the referent variance 
                           
                              
                                 σ
                              
                              
                                 0
                              
                              
                                 2
                              
                           
                        , therefore during the design process it will be considered that 
                           σ
                           =
                           
                              
                                 σ
                              
                              
                                 0
                              
                           
                        . Algorithm 2 consists of the following steps:


                        
                           Algorithm 2
                           
                              
                                 
                                    1.
                                    
                                       L is calculated using (19) and rounded to the nearest integer value.

Calculation of 
                                          
                                             
                                                r
                                             
                                             
                                                max
                                             
                                          
                                       . Putting value of L into (22) and (23), we can see that the total distortion 
                                          D
                                          =
                                          
                                             
                                                D
                                             
                                             
                                                g
                                             
                                          
                                          +
                                          
                                             
                                                D
                                             
                                             
                                                ov
                                             
                                          
                                        is the function of one unknown variable 
                                          
                                             
                                                r
                                             
                                             
                                                max
                                             
                                          
                                       , i.e. 
                                          D
                                          ≡
                                          D
                                          (
                                          
                                             
                                                r
                                             
                                             
                                                max
                                             
                                          
                                          )
                                       . Optimal value of 
                                          
                                             
                                                r
                                             
                                             
                                                max
                                             
                                          
                                        is found by numerical minimization of D, i.e. by solving the equation 
                                          
                                             
                                                d
                                                D
                                                (
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      max
                                                   
                                                
                                                )
                                             
                                             
                                                d
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      max
                                                   
                                                
                                             
                                          
                                          =
                                          0
                                       .


                                       
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                        and 
                                          
                                             
                                                m
                                             
                                             
                                                i
                                             
                                          
                                        are calculated using (17) and (18).

Values 
                                          
                                             
                                                M
                                             
                                             
                                                i
                                             
                                          
                                       , 
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          L
                                       , are calculated using (20) and applying Algorithm 1.

For 
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          L
                                        calculate 
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          =
                                          j
                                          2
                                          π
                                          /
                                          
                                             
                                                M
                                             
                                             
                                                i
                                             
                                          
                                       , 
                                          j
                                          =
                                          0
                                          ,
                                          …
                                          ,
                                          
                                             
                                                M
                                             
                                             
                                                i
                                             
                                          
                                       , and 
                                          
                                             
                                                ψ
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          =
                                          (
                                          j
                                          −
                                          1
                                          /
                                          2
                                          )
                                          2
                                          π
                                          /
                                          
                                             
                                                M
                                             
                                             
                                                i
                                             
                                          
                                       , 
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          
                                             
                                                M
                                             
                                             
                                                i
                                             
                                          
                                       .

To simplify the design, Step 4 should be replaced with the following step:
                           
                              4a.
                              Calculate t. Calculate 
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                 , 
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    t
                                    +
                                    1
                                 , using (20) and applying Algorithm 1. For 
                                    t
                                    +
                                    1
                                    <
                                    i
                                    ⩽
                                    L
                                  it holds that 
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          M
                                       
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                 .

Calculating all these parameters, the designing is finished.

Numerical results for the unrestricted polar quantizer, obtained using the developed theory, are shown in Table 1
                        , for different values of μ and N. Maximal value of SQNR is always achieved for the reference variance 
                           
                              
                                 σ
                              
                              
                                 0
                              
                              
                                 2
                              
                           
                        , and therefore this maximal value will be denoted as 
                           
                              
                                 SQNR
                              
                              
                                 
                                    
                                       σ
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        . The optimization of μ is done, in the way to achieve maximal value of 
                           
                              
                                 SQNR
                              
                              
                                 
                                    
                                       σ
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        . The value of μ that gives maximal 
                           
                              
                                 SQNR
                              
                              
                                 
                                    
                                       σ
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         (denoted as 
                           
                              
                                 μ
                              
                              
                                 opt
                              
                           
                        ) is calculated by numerical optimization of 
                           
                              SQNR
                           
                           (
                           
                              
                                 σ
                              
                              
                                 0
                              
                           
                           )
                         defined with (15). Values of 
                           
                              
                                 μ
                              
                              
                                 opt
                              
                           
                         are different for different values of N, and they are also presented in Table 1.

Simulation in MATLAB is done in the following way. Firstly, a memoryless Gaussian random vector X with 1 000 000 samples is generated, using MATLAB function 
                           X
                           =
                           randn
                           (
                           1
                           
                           000
                           
                           000
                           ,
                           1
                           )
                        . Then, the two-dimensional random Gaussian source is generated joining every two consecutive samples (
                           X
                           (
                           2
                           i
                           −
                           1
                           )
                        , 
                           X
                           (
                           2
                           i
                           )
                        ), 
                           i
                           =
                           1
                           ,
                           …
                           ,
                           500
                           
                           000
                        . After that, the polar quantizer is simulated according to the algorithm described above. Values of 
                           
                              
                                 SQNR
                              
                              
                                 
                                    
                                       σ
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         obtained by simulation are also shown in Table 1, for the purpose of comparison with theoretical results. We can see that values of 
                           
                              
                                 SQNR
                              
                              
                                 
                                    
                                       σ
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         obtained by theory and by simulation are matched very well, which proves the developed theory.

In Fig. 2
                        , there is shown SQNR in the wide range of variances, for different values of μ and for 
                           N
                           =
                           
                              
                                 128
                              
                              
                                 2
                              
                           
                        . For 
                           μ
                           =
                           5.357
                        , the maximal value of 
                           
                              
                                 SQNR
                              
                              
                                 
                                    
                                       σ
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         is achieved, but robustness of the quantizer is poor. Increasing of μ leads to decreasing of 
                           
                              
                                 SQNR
                              
                              
                                 
                                    
                                       σ
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        , but robustness increases. For high values of μ (e.g. 
                           μ
                           =
                           255
                        ), robustness of the quantizer is very good, i.e. SQNR is constant in very wide range of variances. We can conclude that for stationary signals whose variance is constant (equal to 
                           
                              
                                 σ
                              
                              
                                 0
                              
                              
                                 2
                              
                           
                        ) and for near-stationary signals (whose variance is changed in the narrow range of variances around 
                           
                              
                                 σ
                              
                              
                                 0
                              
                              
                                 2
                              
                           
                        ), small values of μ should be used. For non-stationary signals, whose variances are changed significantly with time in the wide range of variances, robustness is very important, therefore high values of μ should be used. Also, this polar quantizer can be used as a part of adaptive and switch quantizers [16,19]. In this case, small values of μ should be used.


                        Fig. 3
                         shows SQNR in the wide range of variances for 
                           μ
                           =
                           255
                        , for different N.

The bit-rate of the polar quantizer is defined as 
                           R
                           =
                           
                              1
                              2
                           
                           
                              
                                 log
                              
                              
                                 2
                              
                           
                           
                           N
                         bits-per-sample (bps). SQNR of the unrestricted polar quantizer in the wide range of variances is shown in Fig. 4
                         with line 1. Also, for the purpose of comparison, SQNR of the corresponding μ-law scalar quantizer is shown in Fig. 4 with line 2. Both quantizers have the same parameters
                           :
                           R
                           =
                           7
                            bps
                         and 
                           μ
                           =
                           255
                        . We can see that the unrestricted polar quantizer has better performances than the corresponding scalar quantizer: it has higher the maximal SQNR for 3.34 dB and higher the average SQNR for 3.63 dB in the range of variances (
                           
                              
                                 σ
                              
                              
                                 0
                              
                              
                                 2
                              
                           
                           
                           [
                           
                              dB
                           
                           ]
                           −
                           40
                            dB
                        , 
                           
                              
                                 σ
                              
                              
                                 0
                              
                              
                                 2
                              
                           
                           
                           [
                           
                              dB
                           
                           ]
                        ).


                        Fig. 5
                         shows SQNR in the wide range of variances for the μ-law polar quantizer from this paper, for two values of 
                           μ
                           :
                           μ
                           =
                           255
                         and 
                           μ
                           =
                           
                              
                                 μ
                              
                              
                                 opt
                              
                           
                        . Also, SQNR for two other types of the polar quantizers (the optimal polar [4] and the uniform polar [6] quantizers) is presented, for the purpose of comparison. All these quantizers are considered for the same bit-rate of 
                           R
                           =
                           7
                            bps
                        . For non-stationary signals, the μ-law polar quantizer with high μ (
                           μ
                           =
                           255
                        ) is used. Its average SQNR in the wide range of variances (
                           
                              
                                 σ
                              
                              
                                 0
                              
                              
                                 2
                              
                           
                           
                           [
                           
                              dB
                           
                           ]
                           −
                           40
                            dB
                        , 
                           
                              
                                 σ
                              
                              
                                 0
                              
                              
                                 2
                              
                           
                           
                           [
                           
                              dB
                           
                           ]
                        ) is 33.53 dB, while the average values of SQNR for the optimal and the uniform polar quantizers in this range of variances are 21.68 dB and 19.65 dB, respectively. We can see that the μ-law polar quantizer with 
                           μ
                           =
                           255
                         has much higher the average SQNR (i.e. it is much more robust) than the optimal and the uniform polar quantizers. Therefore, the μ-law polar quantizer with 
                           μ
                           =
                           255
                         is a much better solution for non-stationary signals than the uniform and the optimal polar quantizers. For stationary signals, the μ-law polar quantizer with small μ (
                           μ
                           =
                           
                              
                                 μ
                              
                              
                                 opt
                              
                           
                        ) is used. It is better than the uniform polar quantizer since it has higher SQNR for all variances. It has slightly smaller the maximal SQNR than the optimal polar quantizer for 0.83 dB, but on the other hand it has higher the average SQNR for 4.95 dB. Furthermore, it is simpler for realization since the optimal polar quantizer requires solving of integral equations which is not the case with the μ-law polar quantizer. Therefore, for stationary signals, the μ-law polar quantizer with 
                           μ
                           =
                           
                              
                                 μ
                              
                              
                                 opt
                              
                           
                         is a very good solution. We can see that the μ-law polar quantizer is a very good solution both for stationary and non-stationary signals, which is not the case with the optimal and the uniform polar quantizers. Also, the unrestricted polar quantizer with 
                           μ
                           =
                           255
                         has higher the maximal SQNR for 0.84 dB, higher the average SQNR for 0.59 dB in the range of variances (
                           
                              
                                 σ
                              
                              
                                 0
                              
                              
                                 2
                              
                           
                           
                           [
                           
                              dB
                           
                           ]
                           −
                           25
                            dB
                        , 
                           
                              
                                 σ
                              
                              
                                 0
                              
                              
                                 2
                              
                           
                           
                           [
                           
                              dB
                           
                           ]
                        ) and higher the average SQNR for 0.08 dB in the range of variances (
                           
                              
                                 σ
                              
                              
                                 0
                              
                              
                                 2
                              
                           
                           
                           [
                           
                              dB
                           
                           ]
                           −
                           40
                            dB
                        , 
                           
                              
                                 σ
                              
                              
                                 0
                              
                              
                                 2
                              
                           
                           
                           [
                           
                              dB
                           
                           ]
                        ), compared to the product polar quantizer from [13]. Furthermore, the product polar quantizer in [13] is designed only for one value of μ (
                           μ
                           =
                           255
                        ), while the unrestricted polar quantizer in this paper is designed for all values of μ.

@&#CONCLUSION@&#

The design of asymptotic unrestricted polar quantizers with square cells for two-dimensional memoryless Gaussian source was presented in this paper. Firstly, the design was done in general manner, for any companding function and for variable variance 
                        
                           
                              σ
                           
                           
                              2
                           
                        
                      and after that it was applied for the μ-law companding function. The fact that for μ-law expressions for thresholds and representation levels are given in the closed form simplifies the design. In this paper it was proved that the design is further simplified for two reasons: firstly, expressions for numbers of magnitude and phase levels and for distortion are given in the closed form; secondly, number of phase levels becomes constant for higher magnitude levels. Optimization of the parameter μ was done to obtain the maximal SQNR for different values of N. The analysis of SQNR in the wide range of variances was done for different values of μ and it was shown that small values of μ should be used for stationary and near-stationary signals, and for adaptive and switched quantizers, while high values of μ should be used for non-adaptive quantizers for non-stationary signals. It was shown that the unrestricted polar quantizer has higher the maximal SQNR for 3.34 dB and higher the average SQNR for 3.63 dB in the range of variances (
                        
                           
                              σ
                           
                           
                              0
                           
                           
                              2
                           
                        
                        
                        [
                        
                           dB
                        
                        ]
                        −
                        40
                         dB
                     , 
                        
                           
                              σ
                           
                           
                              0
                           
                           
                              2
                           
                        
                        
                        [
                        
                           dB
                        
                        ]
                     ) compared to the corresponding scalar quantizer. Also, our μ-law polar quantizer is much more robust than the optimal and the uniform polar quantizers. Simulation of the model was done in MATLAB and the correctness of the developed theory was proved by the very well matching between the theoretical and the simulation results. Since the asymptotic analysis was applied, this model should be used for medium and high bit-rates (higher than 3.5 bps or 4 bps). The unrestricted polar quantizers can have a wide range of applications, since many signals can be modeled with Gaussian source.

@&#ACKNOWLEDGEMENTS@&#

This work is partially supported by Serbian Ministry of Education and Science (projects TR-32045 and TR-32035). M.D.P. was supported by Ministry of Education and Science, Republic of Serbia, Grant No. 174013.

@&#REFERENCES@&#

