@&#MAIN-TITLE@&#A hierarchical Markov decision process modeling feeding and marketing decisions of growing pigs

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We model feeding and marketing decisions of growing pigs simultaneously.


                        
                        
                           
                           The decision process is formulated using a hierarchical Markov decision process.


                        
                        
                           
                           We use a Bayesian approach to update the system state under repeated measurements.


                        
                        
                           
                           We show the functionality of the model for three pens with different growth rates.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OR in agriculture

Stochastic programming

Hierarchical Markov decision process

Herd management

Bayesian updating

@&#ABSTRACT@&#


               
               
                  Feeding is the most important cost in the production of growing pigs and has a direct impact on the marketing decisions, growth and the final quality of the meat. In this paper, we address the sequential decision problem of when to change the feed-mix within a finisher pig pen and when to pick pigs for marketing. We formulate a hierarchical Markov decision process with three levels representing the decision process. The model considers decisions related to feeding and marketing and finds the optimal decision given the current state of the pen. The state of the system is based on information from on-line repeated measurements of pig weights and feeding and is updated using a Bayesian approach. Numerical examples are given to illustrate the features of the proposed optimization model.
               
            

@&#INTRODUCTION@&#

In production systems of growing pigs, feeding is the most important operation and has a direct influence on the cost and the quality of the meat. Another important operation is the timing of marketing. It refers to a sequence of culling decisions until the production unit is empty. As a result the profit of the production unit is highly dependent on the feeding cost and on good timing of marketing, i.e. decisions about feeding and marketing have a direct impact on profit.

In a production system of growing/finishing pigs (Danish standards), the animals may be considered at different levels: herd, section, pen, or animal. The herd is a group of sections, a section includes some pens, and a finisher pen involves some animals (usually 15–20). New piglets are transferred to a weaner unit approx. four weeks after birth, and they stay for approx. eight weeks until they weigh approx. 30  kilograms. The pigs are then moved to a finisher pen where they grow until marketing (9–12 weeks). In the finisher pen, the farmer should determine which pigs should be selected for slaughter (individual marketing). The reward of marketing a pig depends on the unit meat price of the carcass weight and the leanness of the pig. The meat price is highest if the carcass weight of the pig lies in a specific interval. Next, after a sequence of individual marketings, the farmer must decide when to terminate (empty) the rest of the pen. Terminating a pen means that the remaining pigs in the pen are sent to the slaughterhouse (in one delivery) and after cleaning the pen, another group of piglets (each weighing approx. 30 kilograms) is inserted into the pen and the production cycle is repeated. That is, the farmer must time the marketing decisions while simultaneously considering the carcass weight in relation to the best interval, the leanness, and the length of the production cycle. For an extended overview over pig production of growing pigs, see Pourmoayed and Nielsen (2014a).

The growth and leanness of the pigs will be highly dependent on the feed given. Phase feeding is a common method used in the production of the growing pigs. In the finisher pen the growing period typically includes 3 or 4 phases and each phase involves a predefined feed-mix which is a mixture of different ingredients (barley, soy, maize, etc.). A relevant decision is when to change the current feed-mix (transition to a new phase) and what type of feed-mix to use in the next phase.

Since the choice of feed-mix affects the pigs’ growth, a specific feeding strategy has an impact on the marketing strategy. That is, the economic optimization of feeding and marketing decisions is interrelated and requires a simultaneous analysis. Consequently, a sequential decision model is needed that considers both feeding and marketing decisions. To the best of our knowledge, there are only a few studies that take into account these decisions simultaneously (Niemi, 2006; Sirisatien, Wood, Dong, & Morel, 2009). However, these studies consider the problem at animal level and do not take into account the inhomogeneity of animals in growth and feed intake. The aim of this paper is to close this gap and consider the problem at pen level instead.

In this paper we formulate a hierarchical Markov decision process which takes into account decisions related to feeding and marketing of growing pigs at pen level. We assume that the production is cyclic, i.e. when the pen is emptied, not only a regular state transition takes place, but rather the process (the current batch of pigs) is restarted.

The model considers time series of pig weights and feeding obtained from online monitoring, e.g. from a set of sensors in the pen. A Bayesian approach is used to update the state of the system such that it contains the relevant information based on the previous measurements. More precisely, two state space models for Bayesian forecasting (West & Harrison, 1997) are used to update the estimates of live weights and feed intake on a weekly basis.

The structure of the paper is as follows. First, Section 2 gives a short literature review. Second, a detailed description of the optimization model is given in Section 3. Next, Section 4 presents the statistical models which are embedded into the model. In Section 5, numerical examples are considered to show the functionality of the proposed optimization model. Finally, conclusions and directions for further research are given in Section 6.

@&#LITERATURE REVIEW@&#

Due to the dynamic nature of the production environment of growing pigs, the marketing and feeding decisions are sequential, complex and hard to optimize. Various models have been considered to deal with this complexity.

Some studies consider only the marketing decisions. Chavas, Kliebenstein, and Crenshaw (1985) applied the concepts of optimal control theory to find the optimal time of marketing of individual animals. Jørgensen (1993) used a dynamic programming approach to optimize a given heuristic framework for delivering the pigs to the slaughterhouse. Boland, Preckel, and Schinckel (1993) considered the optimal slaughter pig marketing problem under different pricing models and for each pricing system, they found the optimal slaughter weight. Kure (1997) considered the problem at batch level and used the replacement theory concepts and a recursive dynamic programming method to determine the optimal time of marketing the pigs. Toft, Kristensen, and Jørgensen (2005) optimized both marketing and treatment decisions (e.g. regarding vaccination for disease problems) using a hierarchical Markov decision process (HMDP). Boys, Li, Preckel, Schinckel, and Foster (2007) implemented a simulation approach to determine the best marketing strategy to utilize full truck capacity for delivering the pigs to the packers. In the study by Ohlmann and Jones (2008), a mixed integer programming model was proposed to find the best marketing strategy under an annual profit criterion. Kristensen, Nielsen, and Nielsen (2012) suggested a two-level HMDP to find the best marketing strategy according to the data from an online monitoring system.

Other studies focus on sequential feeding decisions, i.e. finding the best strategy for choosing the appropriate feed-mix during the growing period of animals. One example is Glen (1983) who proposed a dynamic programming approach to determine the sequence of feed-mixes in the production unit. In the study by Boland, Foster, and Preckel (1999), a linear programming approach was used to specify the optimal time of changing the feed-mix and also the optimal nutrient ingredients of the feed-mix. A genetic algorithm was applied by (Alexander, Morel, & Wood, 2006, chap. 2) to find the best nutrient components of each feed-mix.

Only a few studies take both marketing and feeding decisions into account. Niemi (2006) used a mechanistic function to model the animal growth trend during the growing period. Niemi (2006) further applied a stochastic dynamic programming method to find the best nutrient ingredients and also the best time of marketing. In the study by Sirisatien et al. (2009), a genetic algorithm was used. Each iteration resulted in a set of feeding schedules followed by the optimal values of the nutrient ingredients and feeding period. Both studies considered the problem at animal level and did not take into account the inhomogeneity of animals with respect to growth and feed conversion rate.

Markov decision models are a well-known modeling technique within animal science used to model livestock systems. See for instance Rodriguez, Jensen, Pla, and Kristensen (2011) and Nielsen, Jørgensen, Kristensen, and Østergaard (2010). For a recent survey see Nielsen and Kristensen (2015), which cites more than 100 papers using (hierarchical) Markov decision processes to model and optimize livestock systems. An HMDP is an extension of a semi Markov decision process (semi-MDP) where a series of finite-horizon semi-MDPs are combined into one process at the founder level called the main process (Kristensen, 1988; Kristensen & Jørgensen, 2000). As a result the state space at the founder level can be reduced and larger models can be solved using a modified policy iteration algorithm under different criteria (Nielsen & Kristensen, 2015). Modeling the problem using an HMDP compared to a semi-MDP contributes to reducing the curse of dimensionality, since the total number of state variables can be decreased. Moreover, the total number of states at the founder level is lower (i.e. the matrix which must be inverted in the modified policy iteration algorithm is much smaller).

A state space model (SSM) (West & Harrison, 1997) is a statistical model which may be used to transform large datasets obtained using online sensors into the required information about the production process. An SSM consists of a set of latent variables and a set of observed variables. At a specified point in time the conditional distribution of the observed variables is a function of the latent variables specified via the observation equations. The latent variables change over time as described via the system equations. The observations are conditionally independent given the latent variables. Thus the estimated value of the latent variables at a time point may be considered as the state of the system, and with Bayesian forecasting (the Kalman filter) we can estimate the latent variables/real state of the system via the observed variables. Examples of SSMs applied to agricultural problems are Bono, Cornou, and Kristensen (2012), Bono, Cornou, Lundbye-Christensen, and Kristensen (2013) and Cornou, Vinther, and Kristensen (2008). Moreover, an SSM can be discretized and embedded into an HMDP (Nielsen, Jørgensen, & Højsgaard, 2011).

Our pig marketing and feeding problem is modeled using a hierarchical Markov decision process (HMDP) with three levels. A short introduction to HMDPs is given below. As techniques from both statistical forecasting and operations research are used, consistent notation can be hard to specify. To assist the reader, Appendix A provides an overview.

An HMDP is an extension of a semi-MDP where a series of finite-horizon semi-MDPs are combined into one infinite time-horizon process at the founder level called the founder process (Kristensen & Jørgensen, 2000). The idea is to expand the stages of a process to so-called child processes, which again may expand stages further to new child processes leading to multiple levels. At the lowest level the HMDP consists of a set of finite-horizon semi-MDPs (see e.g. Tijms, 2003, chap. 7). All processes are linked together using jump actions (see Fig. 1
                     ).

A finite-horizon semi-MDP considers a sequential decision problem over 
                        N
                      
                     stages. Let 
                        
                           I
                           n
                        
                      denote the finite set of system states at stage n. When state
                     
                        
                           i
                           ∈
                           
                              I
                              n
                           
                        
                      is observed, an action a from the finite set of allowable actions 
                        
                           
                              A
                              n
                           
                           
                              (
                              i
                              )
                           
                        
                      must be chosen, and this decision generates reward rn
                     (i, a). Moreover, let un
                     (i, a) denote the stage length of action a, i.e. the expected time until the next decision epoch (stage 
                        
                           n
                           +
                           1
                        
                     ) given action a and state i. Finally, let 
                        
                           Pr
                           
                              (
                              j
                              ∣
                              n
                              ,
                              i
                              ,
                              a
                              )
                           
                        
                      denote the transition probability of obtaining state 
                        
                           j
                           ∈
                           
                              I
                              
                                 n
                                 +
                                 1
                              
                           
                        
                      at stage 
                        
                           n
                           +
                           1
                        
                      given that action a is chosen in state i at stage n.

An HMDP with three levels is illustrated in Fig. 1 using a state-expanded hypergraph (Nielsen & Kristensen, 2006). At the first level, a single founder process
                     
                        
                           p
                           0
                        
                      is defined. Index 0 indicates that the process has no ancestral processes. We assume that 
                        
                           p
                           0
                        
                      is running over an infinite number of stages and that all stages have identical state and action spaces and hence just a single stage is illustrated in Fig. 1. Let 
                        
                           p
                           
                              l
                              +
                              1
                           
                        
                      denote a child process at level 
                        
                           l
                           +
                           1
                        
                     . Process 
                        
                           p
                           
                              l
                              +
                              1
                           
                        
                      is uniquely defined by a given stage nl
                     , state il
                      and action 
                        
                           a
                           l
                        
                      of parent process
                     
                        
                           p
                           l
                        
                     . For instance, the semi-MDP 
                        
                           p
                           2
                        
                      in Fig. 1 is defined at stage 
                        
                           
                              n
                              1
                           
                           =
                           2
                           ,
                        
                      state i
                     1 and action 
                        
                           a
                           1
                        
                      of the process 
                        
                           p
                           1
                        
                      symbolized by the notation 
                        
                           
                              p
                              2
                           
                           =
                           
                              (
                              
                                 p
                                 1
                              
                              ∥
                              
                                 (
                                 
                                    n
                                    1
                                 
                                 ,
                                 
                                    i
                                    1
                                 
                                 ,
                                 
                                    a
                                    1
                                 
                                 )
                              
                              )
                           
                        
                     . Each process is connected to its parent and child processes using jump actions which can be divided into two groups, namely, a child jump action that represents an initial probability distribution of transitions to a child process or a parent jump action that represents a terminating probability distribution of transitions to a parent process. This is illustrated in Fig. 1 for process 
                        
                           p
                           1
                        
                      where child jump action 
                        
                           a
                           1
                        
                      (illustrated using a solid hyperarc) represents a transition to the child process 
                        
                           p
                           2
                        
                      and parent jump action 
                        
                           a
                           2
                        
                      (illustrated using a dashed hyperarc) represents termination of the process 
                        
                           p
                           2
                        
                     . Like traditional actions, jump actions are associated with an expected reward, action length, and a set of transition probabilities. Each node in Fig. 1 at a given stage n of a process 
                        
                           p
                           l
                        
                      corresponds to a state in 
                        
                           I
                           
                              n
                           
                           l
                        
                     . For example, there are 3 states at stage 1 in process 
                        
                           p
                           2
                        
                     . Similarly each hyperarc corresponds to an action, e.g. action a (gray hyperarc) results in a transition to either state j
                     1 or j
                     2.

A policy is a decision rule/function that assigns to each state in a process a (jump) action. That is, choosing a policy corresponds to choosing a single hyperarc out of each node in Fig. 1. Given a policy, the reward at a stage of a parent process equals the total expected rewards of the corresponding child processes. For instance, in Fig. 1, the reward of choosing action 
                        
                           a
                           1
                        
                      in state i
                     1 at stage 
                        
                           
                              n
                              1
                           
                           =
                           2
                        
                      in process 
                        
                           p
                           1
                        
                      equals the total expected reward of process 
                        
                           p
                           2
                        
                     . A similar approach can be used to calculate the transition probabilities and the stage length of an action at a stage of a parent process.

Different optimality criteria may be considered. In this paper, our optimality criterion is to maximize the expected reward per time unit and the optimal policy of the HMDP can be found using a modified policy iteration algorithm. For a detailed description of the algorithm, the interested reader may consult Nielsen and Kristensen (2015).

Consider the problem of optimizing feeding and marketing decisions in a finisher pig pen. The problem can be modeled as a three-level semi-HMDP under the following assumptions:

                           
                              –
                              
                                 q
                                 max  pigs are inserted into the finisher pen;

a finite set of feed-mixes 
                                    F
                                  is available and feed-mix 
                                    
                                       f
                                       ∈
                                       F
                                    
                                  cannot be changed before it has been used for at least 
                                    
                                       t
                                       
                                          f
                                       
                                       min
                                    
                                  weeks (for simplicity, 
                                    
                                       t
                                       
                                          f
                                       
                                       min
                                    
                                  is the same for all feed-mixes);

at most b
                                 max  feeding phases can be used;

marketing of pigs is started in week t
                                 min  at the earliest;

the pen is terminated in week t
                                 max  at the latest, i.e. the maximum life time of a pig in the pen is t
                                 max ;

the growth of a pig is independent of the other pigs in the pen, i.e. the growth is not dependent on the number of pigs in the pen;

weekly deliveries to the abattoir in the marketing period are based on a cooperative agreement where culled pigs from each pen are grouped in one transportation delivery at a fixed time each week, i.e. the transportation cost is fixed.

To give a complete description of the three-level HMDP with feeding and marketing decisions, each semi-MDP must be specified at all levels, i.e. stages, states, and (jump) actions including the corresponding rewards, stage lengths (measured in weeks), and transition probabilities.

As illustrated in Fig. 1, the founder process of the HMDP is an infinite time-horizon process where a stage represents a life of q
                        max  pigs inserted into the pen (until termination). A stage of the process at the second level corresponds to a feeding phase in which the pigs are fed a specific feed-mix f. Finally, a stage at the third level is a week of the current production cycle in the pen under the specific feed-mix. The length, stage, states, and (jump) actions of each process at the different levels are described below. Whenever, the level is clear from the context, the superscript indicating the current level under consideration will be left out to avoid heavy notation.


                           
                              
                                 
                                    Stage: A production cycle of q
                                    max  pigs, i.e. from inserting the piglets into the pen until terminating the pen.


                                    Time horizon: Infinite (since the number of filling and emptying a pen is infinite).


                                    States: A single state representing the start of a production cycle (
                                       
                                          I
                                          =
                                          {
                                          
                                             i
                                             0
                                          
                                          
                                          }
                                       
                                    ).


                                    Actions: One child jump action 
                                       
                                          a
                                          0
                                       
                                     representing insertion of a new group of piglets (
                                       
                                          A
                                          
                                             (
                                             
                                                i
                                                0
                                             
                                             )
                                          
                                          =
                                          
                                             {
                                             
                                                a
                                                0
                                             
                                             }
                                          
                                       
                                    ).


                           
                              
                                 
                                    Stage: A feeding phase with a given feed-mix.


                                    Time horizon: Given a maximum of b
                                    max  feeding phases, the maximum number of stages in process 
                                       
                                          p
                                          1
                                       
                                     is 
                                       
                                          N
                                          =
                                          
                                             b
                                             max
                                          
                                          +
                                          1
                                       
                                     since a dummy stage is added at the end.


                                    States: First, consider stage/feeding phase 2 ≤ n ≤ b
                                    max . A state i is defined using the following state variables:

                                       
                                          
                                             fn
                                             : previous feed-mix (feed-mix in stage/phase 
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             );


                                             tn
                                             : starting time of phase (week);


                                             qn
                                             : number of pigs in the pen at the beginning of stage/phase n;


                                             
                                                
                                                   w
                                                   n
                                                
                                             : model information related to the weight of the pigs, obtained using Bayesian updating (
                                                
                                                   
                                                      w
                                                      n
                                                   
                                                   ∈
                                                   
                                                      W
                                                      n
                                                   
                                                
                                             ). Section 4 provides details on the way the information is obtained.

Furthermore, at this level, a dummy state 
                                       
                                          i
                                          ˜
                                       
                                     is added to represent pen termination. Note that due to the model assumptions, the earliest starting time of phase n is 
                                       
                                          
                                             (
                                             n
                                             −
                                             1
                                             )
                                          
                                          
                                             t
                                             
                                                f
                                             
                                             min
                                          
                                          +
                                          1
                                       
                                    . Moreover, if tn
                                     ≤ t
                                    min  then 
                                       
                                          
                                             q
                                             n
                                          
                                          =
                                          
                                             q
                                             max
                                          
                                       
                                    . Hence the set of states becomes

                                       
                                          
                                             
                                                
                                                   
                                                   
                                                   
                                                      
                                                         
                                                            I
                                                            n
                                                         
                                                         =
                                                         {
                                                         i
                                                         =
                                                         
                                                            (
                                                            
                                                               f
                                                               n
                                                            
                                                            ,
                                                            
                                                               t
                                                               n
                                                            
                                                            ,
                                                            
                                                               q
                                                               n
                                                            
                                                            ,
                                                            
                                                               w
                                                               n
                                                            
                                                            )
                                                         
                                                         ∣
                                                         
                                                            f
                                                            n
                                                         
                                                         ∈
                                                         F
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         
                                                         
                                                            t
                                                            n
                                                         
                                                         ∈
                                                         
                                                            {
                                                            
                                                               (
                                                               n
                                                               −
                                                               1
                                                               )
                                                            
                                                            
                                                               t
                                                               
                                                                  f
                                                               
                                                               min
                                                            
                                                            +
                                                            1
                                                            ,
                                                            …
                                                            ,
                                                            
                                                               t
                                                               max
                                                            
                                                            −
                                                            1
                                                            }
                                                         
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         
                                                            q
                                                            n
                                                         
                                                         ∈
                                                         
                                                            {
                                                            
                                                               q
                                                               max
                                                            
                                                            
                                                               I
                                                               
                                                                  {
                                                                  
                                                                     t
                                                                     n
                                                                  
                                                                  ≤
                                                                  
                                                                     t
                                                                     min
                                                                  
                                                                  }
                                                               
                                                            
                                                            +
                                                            
                                                               I
                                                               
                                                                  {
                                                                  
                                                                     t
                                                                     n
                                                                  
                                                                  >
                                                                  
                                                                     t
                                                                     min
                                                                  
                                                                  }
                                                               
                                                            
                                                            ,
                                                            …
                                                            ,
                                                            
                                                               q
                                                               max
                                                            
                                                            }
                                                         
                                                         ,
                                                         
                                                            w
                                                            n
                                                         
                                                         ∈
                                                         
                                                            W
                                                            n
                                                         
                                                         }
                                                         ∪
                                                         
                                                            {
                                                            
                                                               i
                                                               ˜
                                                            
                                                            }
                                                         
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    where I
                                    { · } denotes the indicator function.

Next, consider stage 
                                       
                                          n
                                          =
                                          1
                                       
                                    . Here the number of states to 
                                       
                                          
                                             I
                                             n
                                          
                                          =
                                          
                                             W
                                             n
                                          
                                       
                                     can be reduced, since 
                                       
                                          
                                             t
                                             n
                                          
                                          =
                                          1
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             q
                                             n
                                          
                                          =
                                          
                                             q
                                             max
                                          
                                          ,
                                       
                                     and there is no previous feed-mix.

Finally, at the dummy stage (
                                       
                                          n
                                          =
                                          
                                             N
                                             1
                                          
                                       
                                    ), only the dummy state 
                                       
                                          i
                                          ˜
                                       
                                     representing pen termination is defined.


                                    Actions:
 At stage 
                                       
                                          n
                                          =
                                          1
                                          ,
                                       
                                     it is possible to choose a feed-mix 
                                       
                                          f
                                          ∈
                                          F
                                       
                                     at state 
                                       
                                          i
                                          =
                                          
                                             w
                                             n
                                          
                                          ,
                                       
                                     i.e. the set of child jump actions is 
                                       
                                          
                                             A
                                             n
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                          =
                                          
                                             {
                                             
                                                a
                                                f
                                             
                                             ∣
                                             f
                                             ∈
                                             F
                                             }
                                          
                                       
                                    . At the subsequent stages (
                                       
                                          1
                                          <
                                          n
                                          <
                                          
                                             N
                                             1
                                          
                                       
                                    ), possible child jump actions at state 
                                       
                                          i
                                          =
                                          (
                                          
                                             f
                                             n
                                          
                                          ,
                                          
                                             t
                                             n
                                          
                                          ,
                                          
                                             q
                                             n
                                          
                                          ,
                                          
                                             w
                                             n
                                          
                                          )
                                       
                                     are 
                                       
                                          
                                             A
                                             n
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                          =
                                          
                                             {
                                             
                                                a
                                                f
                                             
                                             ∣
                                             f
                                             ∈
                                             F
                                             ∖
                                             
                                                {
                                                
                                                   f
                                                   n
                                                
                                                }
                                             
                                             }
                                          
                                       
                                    . The length of all child jump actions choosing a feed-mix is zero. In the dummy state 
                                       
                                          i
                                          ˜
                                       
                                     a single dummy parent jump action 
                                       
                                          a
                                          ˜
                                       
                                     with length zero is considered which represents that the pen has been terminated.

At the lowest level a semi-MDP is defined for each stage/feeding phase n
                           1, parent state 
                              
                                 
                                    i
                                    1
                                 
                                 =
                                 
                                    (
                                    
                                       f
                                       
                                          n
                                          1
                                       
                                    
                                    ,
                                    
                                       t
                                       
                                          n
                                          1
                                       
                                    
                                    ,
                                    
                                       q
                                       
                                          n
                                          1
                                       
                                    
                                    ,
                                    
                                       w
                                       
                                          n
                                          1
                                       
                                    
                                    )
                                 
                                 ,
                              
                            and action 
                              
                                 
                                    a
                                    1
                                 
                                 =
                                 
                                    a
                                    f
                                 
                              
                            corresponding to choosing feed-mix f.

                              
                                 
                                    Stage: A week in the current feeding phase.


                                    Time horizon: A stage is defined for each week 
                                       
                                          
                                             t
                                             
                                                n
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             t
                                             max
                                          
                                       
                                     and hence the time horizon becomes 
                                       
                                          N
                                          =
                                          
                                             t
                                             max
                                          
                                          −
                                          
                                             t
                                             
                                                n
                                                1
                                             
                                          
                                          +
                                          1
                                       
                                    . That is, stage 
                                       
                                          n
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          N
                                       
                                     corresponds to week 
                                       
                                          
                                             t
                                             
                                                n
                                                1
                                             
                                          
                                          +
                                          n
                                          −
                                          1
                                       
                                     (
                                       
                                          n
                                          −
                                          1
                                       
                                     weeks since the feed-mix was changed).


                                    States: Given stage n, a state i consists of the following state variables:

                                       
                                          
                                             qn
                                             : number of pigs in the pen at the beginning of the week;


                                             
                                                
                                                   w
                                                   n
                                                
                                             : model information related to the weight of the pigs, obtained using Bayesian updating (
                                                
                                                   
                                                      w
                                                      n
                                                   
                                                   ∈
                                                   
                                                      W
                                                      n
                                                   
                                                
                                             );


                                             
                                                
                                                   g
                                                   n
                                                
                                             : model information related to the growth of the pigs, obtained using Bayesian updating (
                                                
                                                   
                                                      g
                                                      n
                                                   
                                                   ∈
                                                   
                                                      G
                                                      n
                                                   
                                                
                                             ). Further details on how 
                                                
                                                   g
                                                   n
                                                
                                              and 
                                                
                                                   w
                                                   n
                                                
                                              are obtained, are given in Section 4.

A dummy state 
                                                
                                                   i
                                                   ˜
                                                
                                              is also added to represent pen termination. Therefore the set of states becomes:

                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  I
                                                                  n
                                                               
                                                            
                                                            
                                                               =
                                                            
                                                            
                                                               
                                                                  {
                                                                  i
                                                                  =
                                                                  
                                                                     (
                                                                     
                                                                        q
                                                                        n
                                                                     
                                                                     ,
                                                                     
                                                                        w
                                                                        n
                                                                     
                                                                     ,
                                                                     
                                                                        g
                                                                        n
                                                                     
                                                                     )
                                                                  
                                                                  ∣
                                                                  
                                                                     q
                                                                     n
                                                                  
                                                                  ∈
                                                                  {
                                                                  
                                                                     q
                                                                     max
                                                                  
                                                                  
                                                                     I
                                                                     
                                                                        {
                                                                        
                                                                           t
                                                                           
                                                                              n
                                                                              1
                                                                           
                                                                        
                                                                        +
                                                                        n
                                                                        −
                                                                        1
                                                                        ≤
                                                                        
                                                                           t
                                                                           min
                                                                        
                                                                        }
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                            
                                                            
                                                               
                                                                  +
                                                                  
                                                                  
                                                                     I
                                                                     
                                                                        {
                                                                        
                                                                           t
                                                                           
                                                                              n
                                                                              1
                                                                           
                                                                        
                                                                        +
                                                                        n
                                                                        −
                                                                        1
                                                                        >
                                                                        
                                                                           t
                                                                           min
                                                                        
                                                                        }
                                                                     
                                                                  
                                                                  ,
                                                                  …
                                                                  ,
                                                                  
                                                                     q
                                                                     max
                                                                  
                                                                  }
                                                                  ,
                                                                  
                                                                     w
                                                                     n
                                                                  
                                                                  ∈
                                                                  
                                                                     W
                                                                     n
                                                                  
                                                                  ,
                                                                  
                                                                     g
                                                                     n
                                                                  
                                                                  ∈
                                                                  
                                                                     G
                                                                     n
                                                                  
                                                                  }
                                                                  ∪
                                                                  
                                                                     {
                                                                     
                                                                        i
                                                                        ˜
                                                                     
                                                                     }
                                                                  
                                                                  .
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          


                                    Actions:
 Consider state 
                                       
                                          i
                                          =
                                          (
                                          
                                             q
                                             n
                                          
                                          ,
                                          
                                             w
                                             n
                                          
                                          ,
                                          
                                             g
                                             n
                                          
                                          )
                                       
                                     at stage n. If marketing is not possible at this stage (since 
                                       
                                          
                                             t
                                             
                                                n
                                                1
                                             
                                          
                                          +
                                          n
                                          −
                                          1
                                          <
                                          
                                             t
                                             min
                                          
                                       
                                    ), then the production process continues for another week with the current feed-mix using action 
                                       
                                          a
                                          cont
                                       
                                    . If marketing is possible (
                                       
                                          
                                             t
                                             
                                                n
                                                1
                                             
                                          
                                          +
                                          n
                                          −
                                          1
                                          ≥
                                          
                                             t
                                             min
                                          
                                          ,
                                          n
                                          <
                                          
                                             N
                                             1
                                          
                                       
                                    ), then the set of actions can be expanded to the parent jump action 
                                       
                                          a
                                          term
                                       
                                     where the pen is terminated and actions aq
                                    , which implies that the q heaviest pigs are culled (individual marketing). If 
                                       
                                          n
                                          >
                                          
                                             t
                                             
                                                f
                                             
                                             min
                                          
                                       
                                     the current feed-mix can be changed, which corresponds to parent jump action 
                                       
                                          a
                                          newMix
                                       
                                    . Finally, at the last stage 
                                       
                                          n
                                          =
                                          N
                                          ,
                                       
                                     the pen must be terminated. Hence the set of actions 
                                       
                                          
                                             A
                                             n
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                     becomes

                                       
                                          •
                                          
                                             
                                                
                                                   {
                                                   
                                                      a
                                                      cont
                                                   
                                                   }
                                                
                                              if 
                                                
                                                   
                                                      t
                                                      
                                                         n
                                                         1
                                                      
                                                   
                                                   +
                                                   n
                                                   −
                                                   1
                                                   <
                                                   
                                                      t
                                                      min
                                                   
                                                   ,
                                                   n
                                                   ≤
                                                   
                                                      t
                                                      
                                                         f
                                                      
                                                      min
                                                   
                                                
                                             ;


                                             
                                                
                                                   {
                                                   
                                                      a
                                                      cont
                                                   
                                                   ,
                                                   
                                                      a
                                                      newMix
                                                   
                                                   }
                                                
                                              if 
                                                
                                                   
                                                      t
                                                      
                                                         n
                                                         1
                                                      
                                                   
                                                   +
                                                   n
                                                   −
                                                   1
                                                   <
                                                   
                                                      t
                                                      min
                                                   
                                                   ,
                                                   
                                                      t
                                                      
                                                         f
                                                      
                                                      min
                                                   
                                                   <
                                                   n
                                                   <
                                                   N
                                                
                                             ;


                                             
                                                
                                                   
                                                      {
                                                      
                                                         a
                                                         cont
                                                      
                                                      ,
                                                      
                                                         a
                                                         term
                                                      
                                                      }
                                                   
                                                   ∪
                                                   
                                                      {
                                                      
                                                         a
                                                         q
                                                      
                                                      ∣
                                                      1
                                                      ≤
                                                      q
                                                      <
                                                      
                                                         q
                                                         n
                                                      
                                                      }
                                                   
                                                
                                             if
                                                
                                                   
                                                      t
                                                      
                                                         n
                                                         1
                                                      
                                                   
                                                   +
                                                   n
                                                   −
                                                   1
                                                   ≥
                                                   
                                                      t
                                                      min
                                                   
                                                   ,
                                                   n
                                                   ≤
                                                   
                                                      t
                                                      
                                                         f
                                                      
                                                      min
                                                   
                                                
                                             ;


                                             
                                                
                                                   
                                                      {
                                                      
                                                         a
                                                         cont
                                                      
                                                      ,
                                                      
                                                         a
                                                         newMix
                                                      
                                                      ,
                                                      
                                                         a
                                                         term
                                                      
                                                      }
                                                   
                                                   ∪
                                                   
                                                      {
                                                      
                                                         a
                                                         q
                                                      
                                                      ∣
                                                      1
                                                      ≤
                                                      q
                                                      <
                                                      
                                                         q
                                                         n
                                                      
                                                      }
                                                   
                                                
                                             if
                                                
                                                   
                                                      t
                                                      
                                                         n
                                                         1
                                                      
                                                   
                                                   +
                                                   n
                                                   −
                                                   1
                                                   ≥
                                                   
                                                      t
                                                      min
                                                   
                                                   ,
                                                   
                                                      t
                                                      
                                                         f
                                                      
                                                      min
                                                   
                                                   <
                                                   n
                                                   <
                                                   N
                                                
                                             ;


                                             
                                                
                                                   {
                                                   
                                                      a
                                                      term
                                                   
                                                   }
                                                
                                              if 
                                                
                                                   n
                                                   =
                                                   N
                                                
                                             .

To complete the formulation of the HMDP, transition probabilities must be specified for all (jump) actions.

Given state i
                           0 and child jump action 
                              
                                 a
                                 0
                              
                            (insertion of a new group of piglets), a transition to state 
                              
                                 
                                    i
                                    1
                                 
                                 =
                                 
                                    w
                                    1
                                 
                              
                            at the first stage (
                              
                                 
                                    n
                                    1
                                 
                                 =
                                 1
                              
                           ) of process 
                              
                                 p
                                 1
                              
                            happens with probability 
                              
                                 Pr
                                 
                                    (
                                    
                                       i
                                       1
                                    
                                    ∣
                                    
                                       i
                                       0
                                    
                                    ,
                                    
                                       a
                                       0
                                    
                                    )
                                 
                                 =
                                 
                                    Pr
                                    0
                                 
                                 
                                    (
                                    
                                       w
                                       1
                                    
                                    )
                                 
                                 ,
                              
                            where 
                              
                                 
                                    Pr
                                    0
                                 
                                 
                                    (
                                    
                                       w
                                       1
                                    
                                    )
                                 
                              
                            denotes the initial probability of weight information 
                              
                                 w
                                 1
                              
                           .

Consider state 
                              
                                 i
                                 =
                                 (
                                 
                                    f
                                    n
                                 
                                 ,
                                 
                                    t
                                    n
                                 
                                 ,
                                 
                                    q
                                    n
                                 
                                 ,
                                 
                                    w
                                    n
                                 
                                 )
                              
                            and child jump action 
                              
                                 a
                                 =
                                 
                                    a
                                    f
                                 
                              
                            that corresponds to choosing a specific feed-mix 
                              
                                 f
                                 ∈
                                 F
                              
                           . A transition to state 
                              
                                 
                                    i
                                    2
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          q
                                          ˜
                                       
                                       1
                                    
                                    ,
                                    
                                       
                                          w
                                          ˜
                                       
                                       1
                                    
                                    ,
                                    
                                       
                                          g
                                          ˜
                                       
                                       1
                                    
                                    )
                                 
                              
                            at the first stage (
                              
                                 
                                    n
                                    2
                                 
                                 =
                                 1
                              
                           ) of process 
                              
                                 p
                                 2
                              
                            happens with probability

                              
                                 
                                    
                                       Pr
                                       
                                          (
                                          
                                             i
                                             2
                                          
                                          ∣
                                          n
                                          ,
                                          i
                                          ,
                                          a
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         Pr
                                                         0
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               g
                                                               ˜
                                                            
                                                            1
                                                         
                                                         ∣
                                                         f
                                                         )
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            q
                                                            ˜
                                                         
                                                         1
                                                      
                                                      =
                                                      
                                                         q
                                                         n
                                                      
                                                      ,
                                                      
                                                      
                                                      
                                                         
                                                            w
                                                            ˜
                                                         
                                                         1
                                                      
                                                      =
                                                      
                                                         w
                                                         n
                                                      
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      otherwise
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    Pr
                                    0
                                 
                                 
                                    (
                                    
                                       
                                          g
                                          ˜
                                       
                                       1
                                    
                                    ∣
                                    f
                                    )
                                 
                              
                            denotes the initial probability of growth information for state 
                              
                                 
                                    g
                                    ˜
                                 
                                 1
                              
                            given feed-mix f. For dummy state 
                              
                                 i
                                 ˜
                              
                            and parent jump action 
                              
                                 
                                    a
                                    ˜
                                 
                                 ,
                              
                            a deterministic transition to state i
                           0 happens.

First, consider state 
                              
                                 i
                                 =
                                 (
                                 
                                    q
                                    n
                                 
                                 ,
                                 
                                    w
                                    n
                                 
                                 ,
                                 
                                    g
                                    n
                                 
                                 )
                              
                            in process 
                              
                                 p
                                 2
                              
                            starting at week 
                              
                                 
                                    t
                                    
                                       n
                                       1
                                    
                                 
                                 ,
                              
                            given 
                              
                                 
                                    a
                                    1
                                 
                                 =
                                 
                                    a
                                    f
                                 
                                 ,
                              
                            i.e. the process uses feed-mix f. At Level 2, two parent jump actions are considered. If the feed-mix is changed (
                              
                                 a
                                 =
                                 
                                    a
                                    newMix
                                 
                              
                           ), then the process terminates and makes a deterministic transition to state 
                              
                                 
                                    i
                                    1
                                 
                                 =
                                 
                                    (
                                    f
                                    ,
                                    
                                       t
                                       
                                          n
                                          1
                                       
                                    
                                    +
                                    n
                                    −
                                    1
                                    ,
                                    
                                       q
                                       n
                                    
                                    ,
                                    
                                       w
                                       n
                                    
                                    )
                                 
                              
                            at stage 
                              
                                 
                                    n
                                    1
                                 
                                 +
                                 1
                              
                           . If the process is terminated using parent jump action 
                              
                                 
                                    a
                                    term
                                 
                                 ,
                              
                            then the system makes a deterministic transition to state 
                              
                                 
                                    i
                                    1
                                 
                                 =
                                 
                                    i
                                    ˜
                                 
                              
                            in level 1.

Next, consider states 
                              
                                 i
                                 =
                                 (
                                 
                                    q
                                    n
                                 
                                 ,
                                 
                                    w
                                    n
                                 
                                 ,
                                 
                                    g
                                    n
                                 
                                 )
                              
                            at stage n and 
                              
                                 j
                                 =
                                 (
                                 
                                    q
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    w
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    g
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 )
                              
                            at stage 
                              
                                 n
                                 +
                                 1
                              
                           . Two types of actions are possible. If the current feed-mix is not changed, the transition probability equals

                              
                                 (1)
                                 
                                    
                                       Pr
                                       
                                          (
                                          j
                                          ∣
                                          i
                                          ,
                                          
                                             a
                                             cont
                                          
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      Pr
                                                      
                                                         (
                                                         
                                                            w
                                                            
                                                               n
                                                               +
                                                               1
                                                            
                                                         
                                                         ,
                                                         
                                                            g
                                                            
                                                               n
                                                               +
                                                               1
                                                            
                                                         
                                                         ∣
                                                         
                                                            w
                                                            n
                                                         
                                                         ,
                                                         
                                                            g
                                                            n
                                                         
                                                         )
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         q
                                                         
                                                            n
                                                            +
                                                            1
                                                         
                                                      
                                                      =
                                                      
                                                         q
                                                         n
                                                      
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      otherwise
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           and if q pigs are culled, the transition probability equals:

                              
                                 (2)
                                 
                                    
                                       Pr
                                       
                                          (
                                          j
                                          ∣
                                          i
                                          ,
                                          
                                             a
                                             q
                                          
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      Pr
                                                      
                                                         (
                                                         
                                                            w
                                                            
                                                               n
                                                               +
                                                               1
                                                            
                                                         
                                                         ,
                                                         
                                                            g
                                                            
                                                               n
                                                               +
                                                               1
                                                            
                                                         
                                                         ∣
                                                         
                                                            w
                                                            n
                                                         
                                                         ,
                                                         
                                                            g
                                                            n
                                                         
                                                         )
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         q
                                                         
                                                            n
                                                            +
                                                            1
                                                         
                                                      
                                                      =
                                                      
                                                         q
                                                         n
                                                      
                                                      −
                                                      q
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      otherwise
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           The probability 
                              
                                 Pr
                                 
                                    (
                                    
                                       w
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                       g
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    ∣
                                    
                                       w
                                       n
                                    
                                    ,
                                    
                                       g
                                       n
                                    
                                    )
                                 
                              
                            depends on the statistical models used for Bayesian forecasting and will be given in Section 4.

Finally, if the dummy parent action in state 
                              
                                 i
                                 ˜
                              
                            is considered, a deterministic transition to state 
                              
                                 
                                    i
                                    1
                                 
                                 =
                                 
                                    i
                                    ˜
                                 
                              
                            in process 
                              
                                 p
                                 1
                              
                            occurs.

To finalize the description of the model, the expected reward of each (jump) action must be specified.

Action 
                              
                                 a
                                 0
                              
                            represents the insertion of q
                           max  piglets and hence the reward equals 
                              
                                 r
                                 
                                    (
                                    
                                       i
                                       0
                                    
                                    ,
                                    
                                       a
                                       0
                                    
                                    )
                                 
                                 =
                                 −
                                 
                                    c
                                    
                                       pig
                                    
                                 
                                 
                                    q
                                    max
                                 
                                 ,
                              
                            where 
                              
                                 c
                                 
                                    pig
                                 
                              
                            denotes the unit cost of a piglet.

The reward of child jump action af
                            (choose feed-mix f) is zero since the cost of reconfiguring the feeding system is added in Level 2. The same holds for the parent jump action 
                              
                                 a
                                 ˜
                              
                            where the reward is assumed to be zero.

The reward of choosing a new feed-mix (parent jump action 
                              
                                 a
                                 newMix
                              
                           ) is 
                              
                                 −
                                 
                                    c
                                    
                                       newMix
                                    
                                 
                              
                            where 
                              
                                 c
                                 
                                    newMix
                                 
                              
                            denotes the fixed cost of changing from one feed-mix to another. The reward of the dummy parent jump action 
                              
                                 a
                                 ˜
                              
                            is zero.

For the remaining actions (
                              
                                 
                                    a
                                    cont
                                 
                                 ,
                                 
                                    a
                                    term
                                 
                                 ,
                                 
                                    a
                                    q
                                 
                              
                           ) the expected reward equals the expected revenue from selling the pigs minus the expected cost of feeding the pigs conditioned on the values of the state variables and the action. Let 
                              
                                 
                                    (
                                    
                                       w
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    ,
                                    
                                       z
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    )
                                 
                                 ,
                                 …
                                 ,
                                 
                                    (
                                    
                                       w
                                       
                                          (
                                          
                                             q
                                             n
                                          
                                          )
                                       
                                    
                                    ,
                                    
                                       z
                                       
                                          (
                                          
                                             q
                                             n
                                          
                                          )
                                       
                                    
                                    )
                                 
                              
                            denote the weight and weekly feed intake of the pigs ordered such that 
                              
                                 
                                    w
                                    
                                       (
                                       k
                                       )
                                    
                                 
                                 ≤
                                 
                                    w
                                    
                                       (
                                       k
                                       +
                                       1
                                       )
                                    
                                 
                              
                           . That is, w
                           (k) is the weight of kth pig, i.e. the kth order statistics. If the q heaviest pigs are culled, the revenue becomes

                              
                                 (3)
                                 
                                    
                                       
                                          ∑
                                          
                                             j
                                             =
                                             
                                                q
                                                n
                                             
                                             −
                                             q
                                             +
                                             1
                                          
                                          
                                             q
                                             n
                                          
                                       
                                       
                                          
                                             w
                                             ˜
                                          
                                          
                                             (
                                             j
                                             )
                                          
                                       
                                       ·
                                       p
                                       
                                          (
                                          
                                             
                                                w
                                                ˜
                                             
                                             
                                                (
                                                j
                                                )
                                             
                                          
                                          ,
                                          
                                             
                                                w
                                                ˘
                                             
                                             
                                                (
                                                j
                                                )
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                              
                           where 
                              
                                 
                                    w
                                    ˜
                                 
                                 
                                    (
                                    j
                                    )
                                 
                              
                            and 
                              
                                 
                                    w
                                    ˘
                                 
                                 
                                    (
                                    j
                                    )
                                 
                              
                            denote the carcass weight (kilogram) and the leanness (non-fat percentage) of the jth pig in the pen, respectively. Price function p(·) is the unit price of the meat. Similarly, the cost of feeding the 
                              
                                 
                                    q
                                    n
                                 
                                 −
                                 q
                              
                            lightest pigs is

                              
                                 (4)
                                 
                                    
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             
                                                q
                                                n
                                             
                                             −
                                             q
                                          
                                       
                                       
                                          z
                                          
                                             (
                                             j
                                             )
                                          
                                       
                                       ·
                                       
                                          c
                                          f
                                       
                                       ,
                                    
                                 
                              
                           where cf
                            denotes the unit cost of feed-mix f. The expected reward 
                              
                                 
                                    r
                                    n
                                 
                                 
                                    (
                                    i
                                    ,
                                    
                                       a
                                       q
                                    
                                    )
                                 
                              
                            can now be found as the difference between the expected value of Eqs. (3) and (4). Actions 
                              
                                 a
                                 cont
                              
                            and 
                              
                                 a
                                 term
                              
                            may be considered as extreme culling decisions (
                              
                                 q
                                 =
                                 0
                              
                            and 
                              
                                 q
                                 =
                                 
                                    q
                                    n
                                 
                              
                           ), i.e. 
                              
                                 
                                    r
                                    n
                                 
                                 
                                    (
                                    i
                                    ,
                                    
                                       a
                                       cont
                                    
                                    )
                                 
                              
                            equals the expectation of (4) with 
                              
                                 q
                                 =
                                 0
                              
                            and 
                              
                                 
                                    r
                                    n
                                 
                                 
                                    (
                                    i
                                    ,
                                    
                                       a
                                       term
                                    
                                    )
                                 
                              
                            equals the expectation of (3) with 
                              
                                 q
                                 =
                                 
                                    q
                                    n
                                 
                              
                           .

To evaluate the expected reward of (3) and (4), statistical models are needed to transform the repeated measurements of weight and feed intake into relevant information about weight and growth using Bayesian forecasting. This will be the focus in the next section.

In animal production, online monitoring is a relevant method to obtain data for tracking the changes and can be done regularly by sensors placed in the production units. Two types of online sensors are considered in the finisher pen which provide data about live weight and feed intake, respectively. To transform these data into information about weight and growth, we need a statistical model. In this paper state space models (SSMs) are used to estimate the mean weight μt
                      and growth gt
                      of the pigs in the pen at time t. The same holds for the standard deviation σt
                      of the pig weights in the pen.

The set 
                        
                           W
                           n
                        
                      in the HMDP will therefore contain discretized estimates of the mean weight and standard deviation and the set 
                        
                           G
                           n
                        
                      will include discretized estimates of the mean growth.

SSMs can be categorized into different groups based on the dynamic nature of the considered system and the probability distribution assumed. Two kinds of SSMs are considered and later embedded into the HMDP. In the first model, the probability distribution of the observations, related to the online sensors, is Gaussian (GSSM) and in the second model, these observations come from a non-Gaussian distribution (nGSSM). The dynamics of the system is modeled by linear equations in both models.

The next sections, first provide a description of the two models and afterwards use the models to calculate the reward and transition probabilities of the HMDP. For a short introduction to SSMs and the theorems used for Bayesian updating see Appendix B.

Let 
                           
                              
                                 (
                                 
                                    
                                       w
                                       ^
                                    
                                    1
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       w
                                       ^
                                    
                                    d
                                 
                                 )
                              
                              t
                           
                         denote d weight estimates obtained by an online weighting method (e.g. image processing) at time t. That is, an estimate of the average weight at time t is 
                           
                              
                                 
                                    w
                                    ¯
                                 
                                 t
                              
                              =
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 d
                              
                              
                                 
                                    w
                                    ^
                                 
                                 k
                              
                              /
                              d
                           
                        . Moreover, assume that the average feed intake per pig 
                           
                              
                                 
                                    z
                                    ¯
                                 
                                 t
                              
                              ,
                           
                         given feed-mix f, is measured using an automatic feeding system. The following GSSM is used to model mean weight and growth:

                           
                              (5)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             system
                                             
                                             equation
                                             
                                             (
                                             
                                                θ
                                                t
                                             
                                             =
                                             G
                                             
                                                θ
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             +
                                             
                                                ω
                                                t
                                             
                                             )
                                             
                                             :
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            g
                                                            t
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             =
                                             
                                                (
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                            
                                                               t
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            g
                                                            
                                                               t
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            ω
                                                            
                                                               1
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ω
                                                            
                                                               2
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             observation
                                             
                                             equation
                                             
                                             (
                                             
                                                y
                                                t
                                             
                                             =
                                             
                                                F
                                                
                                                   t
                                                
                                                ′
                                             
                                             
                                                θ
                                                t
                                             
                                             +
                                             
                                                ν
                                                t
                                             
                                             )
                                             
                                             :
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                               ¯
                                                            
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               z
                                                               ¯
                                                            
                                                            t
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             =
                                             
                                                (
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            k
                                                            
                                                               1
                                                               t
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            k
                                                            2
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            g
                                                            t
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            ν
                                                            
                                                               1
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ν
                                                            
                                                               2
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The system equation (5) models the relation between the latent variables 
                           
                              
                                 θ
                                 t
                              
                              =
                              
                                 
                                    (
                                    
                                       μ
                                       t
                                    
                                    ,
                                    
                                       g
                                       t
                                    
                                    )
                                 
                                 ′
                              
                           
                         where the first equation in (5) states that the mean weight μt
                         in the pen at time t equals the mean weight at time 
                           
                              t
                              −
                              1
                           
                         plus the mean growth and some noise. The second equation states that the mean growth gt
                         in the pen follows a random process. The system noise is ωt
                         ∼ N(0, W) and the prior distribution is θ
                        0 ∼ N(m
                        0, f
                        , C
                        0, f
                        ) given a fixed feed-mix f.

The observation equation (6) illustrates the relation between the observed variables 
                           
                              
                                 y
                                 t
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          w
                                          ¯
                                       
                                       t
                                    
                                    ,
                                    
                                       
                                          z
                                          ¯
                                       
                                       t
                                    
                                    )
                                 
                                 ′
                              
                           
                         and the latent variables. That is, in the first equation, the observed average weight equals the mean weight plus the measurement error of the weighing method, and in the second equation, the observed average feed intake equals

                           
                              
                                 
                                    
                                       
                                          z
                                          ¯
                                       
                                       t
                                    
                                    =
                                    
                                       k
                                       
                                          1
                                          t
                                       
                                    
                                    
                                       μ
                                       t
                                    
                                    +
                                    
                                       k
                                       2
                                    
                                    
                                       g
                                       t
                                    
                                    +
                                    
                                       ν
                                       
                                          2
                                          t
                                       
                                    
                                    ,
                                 
                              
                           
                        where k
                        1t
                         and k
                        2 are two known parameters. This relation is based on a linear approximation of the relation between feed intake and growth stated in Jørgensen (1993) where k
                        1t
                         is a dynamic parameter to cover the non-linearity of the weight term. The observation error is assumed to be νt
                         ∼ N(0, V).

Let 
                           
                              
                                 D
                                 t
                              
                              =
                              
                                 (
                                 
                                    y
                                    1
                                 
                                 ,
                                 …
                                 ,
                                 
                                    y
                                    t
                                 
                                 ,
                                 
                                    m
                                    
                                       0
                                       ,
                                       f
                                    
                                 
                                 ,
                                 
                                    C
                                    
                                       0
                                       ,
                                       f
                                    
                                 
                                 )
                              
                           
                         denote the information available up to time t. When new values of the observable variable 
                           
                              
                                 y
                                 t
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          w
                                          ¯
                                       
                                       t
                                    
                                    ,
                                    
                                       
                                          z
                                          ¯
                                       
                                       t
                                    
                                    )
                                 
                                 ′
                              
                           
                         are received, Bayesian updating (Theorem 1 in Appendix B) can be used to update the posterior 
                           
                              
                                 (
                                 
                                    θ
                                    t
                                 
                                 ∣
                                 
                                    D
                                    t
                                 
                                 )
                              
                              ∼
                              N
                              
                                 (
                                 
                                    m
                                    t
                                 
                                 ,
                                 
                                    C
                                    t
                                 
                                 )
                              
                           
                         at time t. That is, the posterior mean and covariance given the current feed-mix f become

                           
                              
                                 
                                    
                                       m
                                       t
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      μ
                                                      ^
                                                   
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      g
                                                      ^
                                                   
                                                   t
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    
                                       C
                                       t
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   C
                                                   
                                                      t
                                                      ,
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   C
                                                   
                                                      t
                                                      ,
                                                      12
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   C
                                                   
                                                      t
                                                      ,
                                                      12
                                                   
                                                
                                             
                                             
                                                
                                                   C
                                                   
                                                      t
                                                      ,
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     

The estimated means 
                           
                              
                                 (
                                 
                                    
                                       μ
                                       ^
                                    
                                    t
                                 
                                 ,
                                 
                                    
                                       g
                                       ^
                                    
                                    t
                                 
                                 )
                              
                              ′
                           
                         are the best estimate of the latent variables (μt, gt
                        )′. The starting time of the GSSM is when the pigs are inserted into the pen, i.e. the prior mean of the latent variable is 
                           
                              
                                 m
                                 
                                    0
                                    ,
                                    f
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       μ
                                       ^
                                    
                                    0
                                 
                                 ,
                                 
                                    
                                       g
                                       ^
                                    
                                    
                                       0
                                       ,
                                       f
                                    
                                 
                                 )
                              
                           
                         where 
                           
                              
                                 μ
                                 ^
                              
                              0
                           
                         denotes the average weight of the piglets at insertion and 
                           
                              
                                 g
                                 ^
                              
                              
                                 0
                                 ,
                                 f
                              
                           
                         is the estimated growth rate given feed-mix f (prior to receiving sensor data). The initial covariance C
                        0, f
                         contains the initial covariance components of live weight and growth rate at the time of insertion given feed-mix f.

If the feed-mix is changed at time t to a new feed-mix f, this change is interpreted as a system intervention (Kristensen, Jørgensen, & Toft, 2010, Section 8.2.5) and the posterior mean and covariance are modified to

                           
                              
                                 
                                    
                                       m
                                       t
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      μ
                                                      ^
                                                   
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      g
                                                      ^
                                                   
                                                   
                                                      0
                                                      ,
                                                      f
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    
                                       C
                                       t
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   C
                                                   
                                                      t
                                                      ,
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   C
                                                   
                                                      0
                                                      ,
                                                      f
                                                      ,
                                                      12
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   C
                                                   
                                                      0
                                                      ,
                                                      f
                                                      ,
                                                      12
                                                   
                                                
                                             
                                             
                                                
                                                   C
                                                   
                                                      0
                                                      ,
                                                      f
                                                      ,
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 g
                                 ^
                              
                              
                                 0
                                 ,
                                 f
                              
                           
                         denotes the initial estimate of the growth rate of the new feed-mix (prior to receiving sensor data for feed-mix f) and C
                        0, f, · denotes the initial covariances for the feed-mix f.

Assuming d weight estimates 
                           
                              
                                 (
                                 
                                    
                                       w
                                       ^
                                    
                                    1
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       w
                                       ^
                                    
                                    d
                                 
                                 )
                              
                              t
                           
                         at time t, the unbiased sample variance at time t is 
                           
                              
                                 s
                                 t
                                 2
                              
                              =
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 d
                              
                              
                                 
                                    (
                                    
                                       
                                          w
                                          ^
                                       
                                       k
                                    
                                    −
                                    
                                       
                                          w
                                          ¯
                                       
                                       t
                                    
                                    )
                                 
                                 2
                              
                              /
                              
                                 (
                                 d
                                 −
                                 1
                                 )
                              
                           
                        . It is well known that if 
                           
                              s
                              t
                              2
                           
                         is based on observations from a normal distribution with true variance (σt
                        )2, then 
                           
                              
                                 (
                                 d
                                 −
                                 1
                                 )
                              
                              
                                 s
                                 t
                                 2
                              
                              /
                              
                                 
                                    (
                                    
                                       σ
                                       t
                                    
                                    )
                                 
                                 2
                              
                           
                         follows a chi-square distribution with 
                           
                              d
                              −
                              1
                           
                         degrees of freedom (Wackerly, Mendenhall, & Scheaffer, 2008, p. 357). Hence the sample variance 
                           
                              s
                              t
                              2
                           
                         follows a gamma distribution with shape 
                           
                              a
                              t
                           
                         and scale 
                           
                              b
                              t
                           
                         given as

                           
                              
                                 
                                    
                                       a
                                       t
                                    
                                    =
                                    
                                       
                                          d
                                          −
                                          1
                                       
                                       2
                                    
                                    ,
                                    
                                    
                                       b
                                       t
                                    
                                    =
                                    
                                       
                                          2
                                          
                                             
                                                (
                                                
                                                   σ
                                                   t
                                                
                                                )
                                             
                                             2
                                          
                                       
                                       
                                          d
                                          −
                                          1
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Note that since d is constant, 
                           
                              a
                              t
                           
                         is constant and known for all t > 1.

An nGSSM can now be defined with observation 
                           
                              
                                 y
                                 t
                              
                              =
                              
                                 s
                                 t
                                 2
                              
                           
                         and latent variable 
                           
                              
                                 θ
                                 t
                              
                              =
                              
                                 
                                    (
                                    
                                       σ
                                       t
                                    
                                    )
                                 
                                 2
                              
                           
                         at time t where yt
                         follows a gamma distribution with shape 
                           
                              a
                              t
                           
                         and scale 
                           
                              b
                              t
                           
                        . The natural parameter becomes 
                           
                              
                                 η
                                 t
                              
                              =
                              −
                              1
                              /
                              
                                 
                                    (
                                    
                                       σ
                                       t
                                    
                                    )
                                 
                                 2
                              
                           
                         and the impact on the latent variable 
                           
                              (
                              g
                              
                                 (
                                 
                                    η
                                    t
                                 
                                 )
                              
                              =
                              
                                 F
                                 
                                    t
                                 
                                 ′
                              
                              
                                 θ
                                 t
                              
                              )
                           
                         is defined as 
                           
                              g
                              
                                 (
                                 
                                    η
                                    t
                                 
                                 )
                              
                              =
                              
                                 
                                    (
                                    
                                       σ
                                       t
                                    
                                    )
                                 
                                 2
                              
                              ,
                           
                         i.e. 
                           
                              g
                              
                                 (
                                 
                                    η
                                    t
                                 
                                 )
                              
                              =
                              −
                              1
                              /
                              
                                 η
                                 t
                              
                              ,
                              
                                 F
                                 
                                    t
                                 
                                 ′
                              
                              =
                              1
                           
                         (see Appendix B). The system equation is:

                           
                              
                                 
                                    
                                       
                                          (
                                          
                                             σ
                                             t
                                          
                                          )
                                       
                                       2
                                    
                                    =
                                    
                                       G
                                       t
                                    
                                    
                                       
                                          (
                                          
                                             σ
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                       2
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 G
                                 t
                              
                              =
                              
                                 
                                    (
                                    
                                       t
                                       
                                          t
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 2
                              
                           
                         for t > 1 (
                           
                              
                                 G
                                 1
                              
                              =
                              1
                           
                        ). That is, it is assumed that the true variance in the pen increases by coefficient 
                           
                              
                                 (
                                 
                                    t
                                    
                                       t
                                       −
                                       1
                                    
                                 
                                 )
                              
                              2
                           
                         (Kristensen et al., 2012).

It should be noted that the conjugate prior distribution of (σt
                        )2 is an inverse-gamma distribution (Gelman et al., 2004, p. 50). Hence, when the piglets are inserted into the pen (
                           
                              t
                              =
                              0
                           
                        ), the initial (prior) distribution of the variance is

                           
                              (7)
                              
                                 
                                    
                                       θ
                                       0
                                    
                                    ∼
                                    Inv-Gamma
                                    
                                       (
                                       
                                          c
                                          0
                                       
                                       =
                                       
                                          
                                             d
                                             −
                                             1
                                          
                                          2
                                       
                                       ,
                                       
                                       
                                       
                                          d
                                          0
                                       
                                       =
                                       
                                          
                                             
                                                (
                                                d
                                                −
                                                1
                                                )
                                             
                                             
                                                s
                                                0
                                                2
                                             
                                          
                                          2
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        with shape 
                           
                              c
                              0
                           
                         and scale 
                           
                              d
                              0
                           
                         where 
                           
                              s
                              0
                              2
                           
                         is the initial estimated sample variance of the live weight with sample size d. Given the nGSSM and the initial distribution (7), the estimate of the variance can now be updated when a new observation 
                           
                              s
                              t
                              2
                           
                         is obtained from the pen by using Theorem 3 and Corollary 1 in Appendix B.

The two SSMs described in the previous sections provide information about the mean weight and growth (μt, gt
                        ) and the standard deviation σt
                         of the weights in the pen. To embed this information into the HMDP these values have to be discretized (Nielsen et al., 2011).

Let 
                           
                              
                                 U
                                 
                                    x
                                    n
                                 
                              
                              =
                              
                                 {
                                 
                                    Π
                                    1
                                 
                                 ,
                                 …
                                 ,
                                 
                                    Π
                                    
                                       
                                          |
                                       
                                       
                                          U
                                          
                                             x
                                             n
                                          
                                       
                                       
                                          |
                                       
                                    
                                 
                                 }
                              
                           
                         be a set of disjoint intervals representing the partitioning of possible values of the continuous state variable x at stage n (e.g. 
                           
                              x
                              =
                              
                                 
                                    μ
                                    ^
                                 
                                 n
                              
                           
                        ). Moreover, given interval Π, let centre point π denote the centre of the interval. The set of possible values of the state variables in the HMDP related to information about weight is 
                           
                              
                                 W
                                 n
                              
                              =
                              
                                 U
                                 
                                    
                                       μ
                                       ^
                                    
                                    n
                                 
                              
                              ×
                              
                                 U
                                 
                                    
                                       σ
                                       ^
                                    
                                    n
                                 
                              
                           
                         and hence a state 
                           
                              w
                              n
                           
                         corresponds to area 
                           
                              
                                 Π
                                 
                                    
                                       μ
                                       ^
                                    
                                    n
                                 
                              
                              ×
                              
                                 Π
                                 
                                    
                                       σ
                                       ^
                                    
                                    n
                                 
                              
                           
                         and is represented using the centre point 
                           
                              
                                 w
                                 n
                              
                              =
                              
                                 (
                                 
                                    π
                                    
                                       
                                          μ
                                          ^
                                       
                                       n
                                    
                                 
                                 ,
                                 
                                    π
                                    
                                       
                                          σ
                                          ^
                                       
                                       n
                                    
                                 
                                 )
                              
                           
                        . Similarly the corresponding set of possible values of the state variable related to information about growth is 
                           
                              
                                 G
                                 n
                              
                              =
                              
                                 U
                                 
                                    
                                       g
                                       ^
                                    
                                    n
                                 
                              
                           
                        .

It is now possible to compute the transition probability 
                              
                                 Pr
                                 
                                    (
                                    
                                       w
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                       g
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    ∣
                                    
                                       w
                                       n
                                    
                                    ,
                                    
                                       g
                                       n
                                    
                                    )
                                 
                              
                            used in (1) and (2). Since the mean and variance estimations are treated separately in different SSMs, this transition probability can be split into two parts:

                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                Pr
                                                
                                                   (
                                                   
                                                      w
                                                      
                                                         n
                                                         +
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      g
                                                      
                                                         n
                                                         +
                                                         1
                                                      
                                                   
                                                   ∣
                                                   
                                                      w
                                                      n
                                                   
                                                   ,
                                                   
                                                      g
                                                      n
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                =
                                                Pr
                                                
                                                   (
                                                   
                                                      m
                                                      
                                                         n
                                                         +
                                                         1
                                                      
                                                   
                                                   =
                                                   
                                                      (
                                                      
                                                         
                                                            μ
                                                            ^
                                                         
                                                         
                                                            n
                                                            +
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            g
                                                            ^
                                                         
                                                         
                                                            n
                                                            +
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   ∈
                                                   
                                                      Π
                                                      
                                                         
                                                            μ
                                                            ^
                                                         
                                                         
                                                            n
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      Π
                                                      
                                                         
                                                            g
                                                            ^
                                                         
                                                         
                                                            n
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                   ∣
                                                   
                                                      m
                                                      n
                                                   
                                                   =
                                                   
                                                      (
                                                      
                                                         π
                                                         
                                                            
                                                               μ
                                                               ^
                                                            
                                                            n
                                                         
                                                      
                                                      ,
                                                      
                                                         π
                                                         
                                                            
                                                               g
                                                               ^
                                                            
                                                            n
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                ·
                                                Pr
                                                
                                                   (
                                                   
                                                      m
                                                      
                                                         n
                                                         +
                                                         1
                                                      
                                                      ′
                                                   
                                                   =
                                                   
                                                      
                                                         σ
                                                         ^
                                                      
                                                      
                                                         n
                                                         +
                                                         1
                                                      
                                                   
                                                   ∈
                                                   
                                                      Π
                                                      
                                                         
                                                            σ
                                                            ^
                                                         
                                                         
                                                            n
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                   ∣
                                                   
                                                      m
                                                      
                                                         n
                                                      
                                                      ′
                                                   
                                                   =
                                                   
                                                      π
                                                      
                                                         
                                                            σ
                                                            ^
                                                         
                                                         n
                                                      
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The first part can be calculated using the GSSM as

                              
                                 
                                    
                                       Pr
                                       
                                          (
                                          
                                             m
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                          ∈
                                          
                                             Π
                                             
                                                
                                                   μ
                                                   ^
                                                
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                          
                                          ×
                                          
                                             Π
                                             
                                                
                                                   g
                                                   ^
                                                
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                          
                                          ∣
                                          
                                             m
                                             n
                                          
                                          )
                                       
                                       =
                                       
                                          ∫
                                          
                                             Π
                                             
                                                
                                                   μ
                                                   ^
                                                
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       
                                       
                                          ∫
                                          
                                             Π
                                             
                                                
                                                   g
                                                   ^
                                                
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       
                                       
                                          f
                                          
                                             (
                                             
                                                m
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                             ∣
                                             
                                                m
                                                n
                                             
                                             )
                                          
                                       
                                       
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                       d
                                       y
                                       
                                       d
                                       x
                                       ,
                                    
                                 
                              
                           where the distribution of 
                              
                                 (
                                 
                                    m
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 ∣
                                 
                                    m
                                    n
                                 
                                 )
                              
                            can be found using Theorem 2 in Appendix B. The second part can be calculated using the nGSSM as

                              
                                 
                                    
                                       Pr
                                       
                                          (
                                          
                                             m
                                             
                                                n
                                                +
                                                1
                                             
                                             ′
                                          
                                          ∈
                                          
                                             Π
                                             
                                                
                                                   σ
                                                   ^
                                                
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                          
                                          ∣
                                          
                                             m
                                             n
                                             ′
                                          
                                          )
                                       
                                       =
                                       
                                          ∫
                                          
                                             Π
                                             
                                                
                                                   σ
                                                   ^
                                                
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          f
                                          
                                             (
                                             
                                                m
                                                
                                                   n
                                                   +
                                                   1
                                                
                                                ′
                                             
                                             ∣
                                             
                                                m
                                                n
                                                ′
                                             
                                             )
                                          
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       d
                                       x
                                       ,
                                    
                                 
                              
                           where the distribution of 
                              
                                 (
                                 
                                    m
                                    
                                       n
                                       +
                                       1
                                    
                                    ′
                                 
                                 ∣
                                 
                                    m
                                    n
                                    ′
                                 
                                 )
                              
                            can be found using Theorem 4 in Appendix B.

The expected reward given stage n and state 
                              
                                 
                                    (
                                    
                                       q
                                       n
                                    
                                    ,
                                    
                                       w
                                       n
                                    
                                    ,
                                    
                                       g
                                       n
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       q
                                       n
                                    
                                    ,
                                    
                                       (
                                       
                                          π
                                          
                                             
                                                μ
                                                ^
                                             
                                             n
                                          
                                       
                                       ,
                                       
                                          π
                                          
                                             
                                                σ
                                                ^
                                             
                                             n
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                       π
                                       
                                          
                                             g
                                             ^
                                          
                                          n
                                       
                                    
                                    )
                                 
                              
                            in process 
                              
                                 p
                                 2
                              
                            can be calculated as the expected value of (3) minus the expected value of (4). The expected revenue of (3) can be written as

                              
                                 (8)
                                 
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             
                                                q
                                                n
                                             
                                             −
                                             q
                                             +
                                             1
                                          
                                          
                                             q
                                             n
                                          
                                       
                                       E
                                       
                                          (
                                          
                                             
                                                w
                                                ˜
                                             
                                             
                                                (
                                                k
                                                )
                                             
                                          
                                          ·
                                          p
                                          
                                             (
                                             
                                                
                                                   w
                                                   ˜
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                             ,
                                             
                                                
                                                   w
                                                   ˘
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       ,
                                    
                                 
                              
                           where 
                              
                                 
                                    w
                                    ˜
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                            and 
                              
                                 
                                    w
                                    ˘
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                            denote the carcass weight and leanness of the jth pig (based on the order statistics w
                           (k), see Section 3.4). The carcass weight, 
                              
                                 
                                    
                                       w
                                       ˜
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                 
                                 ,
                              
                            of the jth pig is a fraction of live weight (Andersen, Pedersen, & Ogannisian, 1999):

                              
                                 (9)
                                 
                                    
                                       
                                          
                                             w
                                             ˜
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       =
                                       0.84
                                       
                                          w
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       −
                                       5.89
                                       +
                                       ϵ
                                       ,
                                    
                                 
                              
                           where 
                              
                                 ϵ
                                 ∼
                                 N
                                 (
                                 0
                                 ,
                                 
                                    σ
                                    ϵ
                                    2
                                 
                                 )
                              
                            is a random error. Furthermore, Kristensen et al. (2012) proposed a rule of thumb for use in production units, which is used to compute the lean meat percentage 
                              
                                 
                                    w
                                    ˘
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                            at marketing:

                              
                                 
                                    
                                       
                                          
                                             w
                                             ˘
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             −
                                             30
                                             (
                                             
                                                
                                                   g
                                                   ¯
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                             −
                                             
                                                g
                                                ¯
                                             
                                             )
                                          
                                          4
                                       
                                       +
                                       
                                          
                                             w
                                             ˘
                                          
                                          ¯
                                       
                                       ,
                                    
                                 
                              
                           where 
                              
                                 
                                    g
                                    ¯
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                            denotes the average daily growth/gain of the kth pig until marketing, 
                              
                                 g
                                 ¯
                              
                            is the average daily growth in the herd, and 
                              
                                 
                                    w
                                    ˘
                                 
                                 ¯
                              
                            is the average herd leanness percentage at marketing. The average daily growth t days after insertion into the pen is 
                              
                                 
                                    
                                       g
                                       ¯
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       w
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    −
                                    
                                       
                                          μ
                                          ^
                                       
                                       0
                                    
                                    )
                                 
                                 /
                                 t
                                 ,
                              
                            where 
                              
                                 
                                    μ
                                    ^
                                 
                                 0
                              
                            denotes the average weight at time of insertion into the pen.

The expected cost of (4) is:

                              
                                 (10)
                                 
                                    
                                       
                                          c
                                          f
                                       
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             
                                                q
                                                n
                                             
                                             −
                                             q
                                          
                                       
                                       E
                                       
                                          (
                                          
                                             z
                                             
                                                (
                                                k
                                                )
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           
                        

And from (6), the ordered random variable z
                           (k) equals:

                              
                                 
                                    
                                       
                                          z
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       =
                                       
                                          k
                                          
                                             1
                                             t
                                          
                                       
                                       
                                          w
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       +
                                       
                                          k
                                          2
                                       
                                       
                                          g
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

Note that the evaluation of (8) and (10) is rather complex since it involves calculating the mean of a piecewise reward function and the truncated normal distribution. However, the values of (8) and (10) can be simulated using a simple sorting procedure and given the fact that 
                              
                                 w
                                 ∼
                                 N
                                 (
                                 
                                    π
                                    
                                       μ
                                       ^
                                    
                                 
                                 ,
                                 
                                    π
                                    
                                       σ
                                       ^
                                    
                                 
                                 )
                              
                            where w denotes the weight of a pig randomly selected in the pen at the current stage.

To illustrate the functionality of the proposed optimization model, the HMDP is applied on three pens with different properties (average weekly gain). The average weekly gain of Pen 2 is assumed to be “normal” (an initial growth of 5.8 kilograms/week using Feed-mix 1), and Pens 1 and 3 grow 20 percent slower and faster, respectively, than Pen 2. Moreover, to initialize the three pens with the same conditions, the pigs are fed by the same feed-mix (Feed-mix 1) at the time of insertion into the pen.

To obtain time series of observations 
                           
                              (
                              
                                 
                                    w
                                    ¯
                                 
                                 t
                              
                              ,
                              
                                 
                                    z
                                    ¯
                                 
                                 t
                              
                              )
                           
                         and 
                           
                              s
                              t
                              2
                           
                         used by the GSSM and nGSSM a simulation model was developed. The model is based on the biological growth formulas in Jørgensen (1993). The simulation model and the generated data are available online for reproducibility (see Pourmoayed & Nielsen, 2014b).

An example is given in Fig. 2 that shows the observed values of average live weight 
                           
                              
                                 
                                    w
                                    ¯
                                 
                                 t
                              
                              ,
                           
                         average feed intake 
                           
                              
                                 
                                    z
                                    ¯
                                 
                                 t
                              
                              ,
                           
                         and the standard deviation st
                         (resulted from the simulation). It also gives the estimated information of live weight and growth (calculated using Bayesian updating with the GSSM and nGSSM) in the three pens. These values together with the other state variables are used to identify the current state in the HMDP. Note that the simulation is started with Feed-mix 1 and each time the feed-mix is changed, we continue the simulation using the new feed-mix.

The parameters used for the HMDP are given in Table 1
                        . The parameter values have been obtained using information about finisher pig production (Danish conditions) and related literature (see the footnotes in Table 1).


                        Table 2
                        
                         contains parameter values related to the GSSM and nGSSM. The values have been estimated with time series generated using the simulation model. More specifically, we used the expectation-maximization algorithm (Dethlefsen, 2001) to find V and W, and the initial posterior parameters m
                        0, 1 and C
                        0, 1 were estimated using the weight data at the time of inserting the piglets into the pen. For the nGSSM, the initial sample variance 
                           
                              s
                              0
                              2
                           
                         was calculated using the time series data and 
                           
                              d
                              =
                              35
                           
                         is used as the number of weight estimates per day. Finally, note that each feed-mix implies a special growth rate in the pen (
                           
                              
                                 g
                                 ^
                              
                              
                                 0
                                 ,
                                 f
                              
                           
                        ) and that feed-mixes with higher growth rates are more expensive in comparison with other feed-mixes (cf
                        ).

To calculate the revenue of marketing in (3), the unit price function 
                           
                              p
                              (
                              
                                 
                                    w
                                    ˜
                                 
                                 
                                    (
                                    j
                                    )
                                 
                              
                              ,
                              
                                 
                                    w
                                    ˘
                                 
                                 
                                    (
                                    j
                                    )
                                 
                              
                              )
                           
                         should be specified, which under Danish conditions is the sum of two piecewise linear functions 
                           
                              
                                 p
                                 ˜
                              
                              
                                 (
                                 
                                    w
                                    ˜
                                 
                                 )
                              
                           
                         and 
                           
                              
                                 p
                                 ˘
                              
                              
                                 (
                                 
                                    w
                                    ˘
                                 
                                 )
                              
                           
                         related to the price of carcass and a bonus for the leanness percentage per kilogram meat, respectively. We define 
                           
                              
                                 p
                                 ˜
                              
                              
                                 (
                                 
                                    w
                                    ˜
                                 
                                 )
                              
                           
                         and 
                           
                              
                                 p
                                 ˘
                              
                              
                                 (
                                 
                                    w
                                    ˘
                                 
                                 )
                              
                           
                         based on the meat prices used in Kristensen et al. (2012)
                        
                           1
                        
                        
                           1
                           For current prices see http://www.danishcrown.dk/Ejer/Noteringer/Aktuel-svinenotering.aspx.
                         as

                           
                              (11)
                              
                                 
                                    
                                       p
                                       ˜
                                    
                                    
                                       (
                                       
                                          w
                                          ˜
                                       
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      w
                                                      ˜
                                                   
                                                   <
                                                   50
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0.2
                                                   
                                                      w
                                                      ˜
                                                   
                                                   −
                                                   2.7
                                                
                                             
                                             
                                                
                                                   50
                                                   ≤
                                                   
                                                      w
                                                      ˜
                                                   
                                                   <
                                                   60
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0.1
                                                   
                                                      w
                                                      ˜
                                                   
                                                   +
                                                   3.3
                                                
                                             
                                             
                                                
                                                   60
                                                   ≤
                                                   
                                                      w
                                                      ˜
                                                   
                                                   <
                                                   70
                                                
                                             
                                          
                                          
                                             
                                                
                                                   10.3
                                                
                                             
                                             
                                                
                                                   70
                                                   ≤
                                                   
                                                      w
                                                      ˜
                                                   
                                                   <
                                                   86
                                                
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   0.1
                                                   
                                                      w
                                                      ˜
                                                   
                                                   +
                                                   18.9
                                                
                                             
                                             
                                                
                                                   86
                                                   ≤
                                                   
                                                      w
                                                      ˜
                                                   
                                                   <
                                                   95
                                                
                                             
                                          
                                          
                                             
                                                
                                                   9.3
                                                
                                             
                                             
                                                
                                                   95
                                                   ≤
                                                   
                                                      w
                                                      ˜
                                                   
                                                   <
                                                   100
                                                
                                             
                                          
                                          
                                             
                                                
                                                   9.1
                                                
                                             
                                             
                                                
                                                   
                                                      w
                                                      ˜
                                                   
                                                   ≥
                                                   100
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        and

                           
                              
                                 
                                    
                                       p
                                       ˘
                                    
                                    
                                       (
                                       
                                          w
                                          ˘
                                       
                                       )
                                    
                                    =
                                    0.1
                                    
                                       (
                                       
                                          w
                                          ˘
                                       
                                       −
                                       61
                                       )
                                    
                                    .
                                 
                              
                           
                        A plot of the two functions is given in Fig. 3.

Finally, in order to initialize the HMDP, possible values of the state variables should be determined for each stage. For the discrete state variables (qn, tn, fn
                        ), the possible values are set according to the set of states defined in Section 3.2. Moreover, based on the discretization method in the beginning of Section 4.3, the continuous state variables (
                           
                              
                                 
                                    μ
                                    ^
                                 
                                 n
                              
                              ,
                           
                        
                        
                           
                              
                                 
                                    σ
                                    ^
                                 
                                 n
                              
                              ,
                           
                        
                        
                           
                              
                                 g
                                 ^
                              
                              n
                           
                        ) are divided into the 11, 7 and 5 intervals, respectively. The centre points of these intervals are specified such that they represent the possible values of the weight and growth information in the system. An overview over the values of each state variable is given in Table 3
                        .

The HMDP was coded using C++ (GCC compiler) and R (R Core Team, 2015). The source code is available online (Pourmoayed & Nielsen, 2014b). After the model was built, the optimal policy was calculated with the modified policy iteration algorithm using the R package “MDP” (Nielsen, 2009). The resulting model consists of 802,581 states and 5,050,446 actions (one stage of the founder process including states and actions of sub-processes).

The CPU time for building and solving the model was 268 and 94 seconds, respectively (Fujitsu laptop with i7-4800MQ CPU and 32 gigabyte of memory running on a Windows 7, 64 bit OS). Note that the model has only to be resolved when the model parameters change, e.g. a new estimation of V and W which might be re-estimated monthly. Therefore, a fast solution time is not the primary focus.

The information from each pen, i.e. the values 
                           
                              
                                 q
                                 n
                              
                              ,
                              
                                 t
                                 n
                              
                              ,
                              
                                 f
                                 n
                              
                              ,
                              
                                 
                                    μ
                                    ^
                                 
                                 n
                              
                              ,
                              
                                 
                                    σ
                                    ^
                                 
                                 n
                              
                           
                         and 
                           
                              
                                 
                                    g
                                    ^
                                 
                                 n
                              
                              ,
                           
                         is used to find the relevant state in the HMDP. Next, the optimal action is found using the calculated optimal policy. The resulting optimal feeding and marketing decisions (i.e. the sample path of the MDP) are illustrated in Figs. 2 and 4 for each pen. In Fig. 2 the vertical dotted and solid lines show weeks where marketing and feeding decisions are taken in the system. The bars show the number of pigs left in the pen before a (possible) marketing decision. For instance, in week 9, three pigs in Pen 3 are marketed. A detailed overview of the optimal decisions is given in Fig. 4. Here the plot of each pen is separated into two parts. The solid line in the upper part shows the optimal feed-mix. A jump indicates that the optimal decision is to change the current feed-mix. In the lower part of each plot the optimal marketing decision is illustrated by means of symbols. For instance, the black dots indicate a culling action.

A closer look at Fig. 4 shows that all pens start with Feed-mix 1. After 3 weeks, the feed-mix in Pen 1 (with the lowest weekly gain) changes to Feed-mix 2, resulting in a better growth rate compared to Feed-mix 1. Pen 1 (low growth) uses this feed-mix until week 8 and after that Feed-mix 3 is chosen for the remaining weeks because a higher growth is obtained (compared to using Feed-mix 2), and hence the appropriate live weight is reached at the end of the growing period. In Pen 2 (normal growth), we change the feed-mix in week 4 from Feed-mix 1 to Feed-mix 2 and until week 12 this feed-mix is used in the pen. In this pen, the average growth rate is appropriate and there is no need to use a more expensive feed-mix (Feed-mix 3) with a faster expected growth rate. Finally, in Pen 3 (high growth), the feed-mix remains unchanged since the pigs genetically grow fast in this pen using the cheapest feed-mix (Feed-mix 1) and they will have an appropriate live weight in the last weeks of the growing period.

The length of the growing period, i.e. the number of weeks before terminating the pen, differs between pens. Pens 1 and 2 are terminated at the maximum growth length (week 12) since a good slaughter weight is reached for the remaining pigs. However, Pen 3 is terminated in week 11. Due to the high growth rate in this pen, the average weight in week 11 is appropriate and the pen is terminated such that a new batch of piglets can be inserted into the pen earlier (new production cycle).

Individual marketing decisions are made in all pens to select the heaviest pigs for marketing. Usually pigs grow with different growth values in the pen and hence in the last weeks of the growing period (from week 9 to 12) they obtain different live weights. Hence, these decisions are made in order to market the pigs that are in the best slaughter weight interval (with a live weight approximately between 89 and 109 kilograms due to (9) and (11)). For instance, in Pen 2, the 4 heaviest pigs are culled in week 11. As a result, these individual marketing decisions lead to a decrease in the inhomogeneity between the remaining pigs in the pen, which implies a more consistent growth among the remaining pigs.

Changing the parameters of the model influences on the optimal policy. To make a small sensitivity analysis, three groups of scenarios are considered and compared with the basic scenario based on the parameters in Tables 1 and 2. In the first group of scenarios the starting time of the marketing period is changed by considering different values of t
                        min  under a fixed growing period (
                           
                              
                                 t
                                 max
                              
                              =
                              12
                           
                        ). In the second group, the maximum length of the marketing period is altered by changing t
                        max  under a fixed starting time for marketing decisions (
                           
                              
                                 t
                                 min
                              
                              =
                              9
                           
                        ) and in the third group different feed-mix unit costs are taken into account. Under each scenario, the optimal policy of the HMDP and the gross margin per week are calculated for comparison.

The results are shown in Table 4
                        . In Group 1, a change in the starting time of possible marketing decisions (t
                        min ) has a small impact on the gross margin while in Group 2 the maximum length of the marketing period (t
                        max ) has a much higher impact on the gross margin per week. Therefore, it is better to increase the marketing length by extending the growing period t
                        max  compared to lowering t
                        min . This illustrates the importance of the length of the growing period in the pen. Finally, in Group 3, a decrease/increase in the feed-mix unit cost gives a higher/lower gross margin. The effect is relatively high which shows that the profit of the production unit is extremely dependent on the feeding costs.

In the production of growing pigs, the decision maker must consider feeding and marketing decisions simultaneously. In this paper, we presented a three-level HMDP which considers both feeding and marketing decisions at pen level.

We used a Bayesian approach to update the state of the system such that it contains the updated information based on previous measurements. More specifically, a GSSM is used to forecast mean weight and growth information based on online measurements and an nGSSM is used to forecast the weight variance within the pen. By embedding the SSMs into the HMDP, the model takes into account new online measurements. Both SSMs are embedded into the HMDP using a general discretization method.

A numerical example shows that the optimal policy adapts to different pen conditions (we used three pens with different genetic properties) and chooses actions which maximize the expected reward per time unit. Furthermore, a marginal sensitivity analysis illustrated the importance of the length of the growing period and feed-mix cost.

The model presented in this paper can be used as a part of a decision support system with online data such that the system state can be found using Bayesian updating and the optimal policy of the HMDP can determine the best feeding and marketing decisions at pen level. For simplicity we have assumed that the three alternative feed mixes available for the pigs are the same throughout the production period. In practice it would be natural to adjust the feed mixes to the various growth phases so that the alternatives taken into account depend on the age of the pigs. It would be straightforward to implement such a more realistic setup so it is not a limitation for a practical use. There are, however, some other limitations of the model that require more thorough consideration.

First, the model considers feeding and marketing decisions at pen level and ignores possible constraints at section or herd level. For instance, limitations in the feeding management system and the transportation strategy to the abattoir are currently ignored. That is, we assume weekly deliveries to the abattoir in the marketing period based on a cooperative agreement where culled pigs from each pen are grouped in one delivery. Hence, the transportation cost is fixed and can be ignored. This is the situation in many Danish herds since the majority of farmers in Denmark use a single abattoir which also handles the transport. To handle constraints and decisions about transportation costs (e.g. truck capacity), we need to extend the model from pen level to section or herd level. Given the current modeling framework, this extension may be difficult due to the curse of dimensionality since the number of states will grow dramatically. As a result there is a need for an approximation method to approximate the value function of the HMDP and find the best marketing policy in the herd. This can be done by using an approximate dynamic programming approach (Powell, 2007) and is a possible direction of future research.

Second, we may have weekly variations in the carcass price (11) and piglet cost in practice. This fact may have an influence on the marketing decisions but has been ignored in this study and in previous papers using HMDP models (Nielsen & Kristensen, 2015). Considering price variations in a model with marketing and feeding decisions is difficult since state variables related to price information have to be introduced into the model which will result in an exponential increase in the number of state variables. Two directions are possible. Either approximate dynamic programming methods are applied or other state variables are excluded from the model. Price variations can be analyzed using an SSM and Bayesian updating and embedded into an HMDP which is a subject of future research.

Finally, the model may be extended to handle information and decisions about diseases such as diarrhea and tail biting.

@&#ACKNOWLEDGMENT@&#

We thank the three anonymous referees for their useful comments and suggestions. This article has been written with support from the Danish Council for Strategic Research (The PigIT project, Grant number 11-116191).

Since the paper uses techniques from both statistical forecasting and operations research, we had to make some choices with respect to notation. In general, we use capital letters for matrices and let A′ denote the transpose of A. Capital blackboard bold letters are used for sets (e.g. 
                        
                           
                              W
                              n
                           
                           
                        
                      and 
                        F
                     ). Subscript indices indicate e.g. stage, week, and feed-mix and are separated using a comma. Superscript is only used to indicate the level in the HMDP except when lower and upper limits on ranges (e.g. 
                        
                           t
                           
                              f
                           
                           min
                        
                      and t
                     max ) are considered. Greek letters are used for some stochastic variables and their mean and variance such as θt
                      and μt
                     . Finally, accent 
                        
                           x
                           ^
                        
                      (hat) is used to denote an estimate of x and accent 
                        
                           x
                           ¯
                        
                      (bar) the average of a group of x-variables. A description of the notation introduced in Sections 3 and 4 is given in Tables 5
                      and 6
                     , respectively.

A GSSM includes a set of observable and latent/unobservable continuous variables. The set of latent variables 
                           
                              θ
                              
                                 {
                                 t
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 }
                              
                           
                         evolves over time using system equation (written using matrix notation)

                           
                              
                                 
                                    
                                       θ
                                       t
                                    
                                    =
                                    
                                       G
                                       t
                                    
                                    
                                       θ
                                       
                                          t
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       ω
                                       t
                                    
                                    ,
                                 
                              
                           
                        where ωt
                         ∼ N(0, Wt
                        ) is a random term and Gt
                         is a matrix of known values. We assume that the prior θ
                        0 ∼ N(m
                        0, C
                        0) is given. Moreover, we have a set of observable variables 
                           
                              y
                              
                                 {
                                 t
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 }
                              
                           
                         (the data acquired from the online sensors) which are dependent on the latent variable using observation equation
                        
                           
                              
                                 
                                    
                                       y
                                       t
                                    
                                    =
                                    
                                       F
                                       
                                          t
                                       
                                       ′
                                    
                                    
                                       θ
                                       t
                                    
                                    +
                                    
                                       ν
                                       t
                                    
                                    ,
                                 
                              
                           
                        with νt
                         ∼ N(0, Vt
                        ). Here F is the design matrix of system equations with known values and F′ denotes the transpose to matrix F.

The error sequences ωt
                         and νt
                         are internally and mutually independent. Hence given θt
                         we have that yt
                         is independent of all other observations and in general the past and the future are independent given the present.

Let 
                           
                              
                                 D
                                 
                                    t
                                    −
                                    1
                                 
                              
                              =
                              
                                 (
                                 
                                    y
                                    1
                                 
                                 ,
                                 …
                                 ,
                                 
                                    y
                                    
                                       t
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    m
                                    0
                                 
                                 ,
                                 
                                    C
                                    0
                                 
                                 )
                              
                           
                         denote the information available up to time 
                           
                              t
                              −
                              1
                           
                        . Given the posterior of the latent variable at time 
                           
                              t
                              −
                              1
                              ,
                           
                         we can use Bayesian updating (the Kalman filter) to update the distributions at time t (West & Harrison, 1997, Theorem 4.1).

                           Theorem 1
                           
                              Suppose that at time
                              
                                 
                                    t
                                    −
                                    1
                                 
                               
                              we have 
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                θ
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             ∣
                                             
                                                D
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                          ∼
                                          N
                                          
                                             (
                                             
                                                m
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             
                                                C
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             ,
                                             
                                             
                                             
                                             (
                                             posteriorattime
                                             t
                                             −
                                             1
                                             
                                                )
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                              then 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      θ
                                                      t
                                                   
                                                   ∣
                                                   
                                                      D
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                ∼
                                             
                                             
                                                
                                                   N
                                                   
                                                      (
                                                      
                                                         b
                                                         t
                                                      
                                                      ,
                                                      
                                                         R
                                                         t
                                                      
                                                      )
                                                   
                                                   
                                                      ,
                                                      
                                                      (
                                                      prior
                                                      at
                                                      time
                                                      t
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      y
                                                      t
                                                   
                                                   ∣
                                                   
                                                      D
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                ∼
                                             
                                             
                                                
                                                   N
                                                   
                                                      (
                                                      
                                                         f
                                                         t
                                                      
                                                      ,
                                                      
                                                         Q
                                                         t
                                                      
                                                      )
                                                   
                                                   
                                                      ,
                                                      
                                                      (
                                                      one
                                                      −
                                                      step
                                                      forecast
                                                      at
                                                      time
                                                      t
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      θ
                                                      t
                                                   
                                                   ∣
                                                   
                                                      D
                                                      t
                                                   
                                                   )
                                                
                                             
                                             
                                                ∼
                                             
                                             
                                                
                                                   N
                                                   
                                                      (
                                                      
                                                         m
                                                         t
                                                      
                                                      ,
                                                      
                                                         C
                                                         t
                                                      
                                                      )
                                                   
                                                   
                                                      ,
                                                      
                                                      (
                                                      posterior
                                                      at
                                                      time
                                                      t
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              where 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   b
                                                   t
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      G
                                                      t
                                                   
                                                   
                                                      m
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                   
                                                      R
                                                      t
                                                   
                                                   =
                                                   
                                                      G
                                                      t
                                                   
                                                   
                                                      C
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      G
                                                      
                                                         t
                                                      
                                                      ′
                                                   
                                                   +
                                                   
                                                      W
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   f
                                                   t
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      F
                                                      
                                                         t
                                                      
                                                      ′
                                                   
                                                   
                                                      b
                                                      t
                                                   
                                                   ,
                                                   
                                                   
                                                      Q
                                                      t
                                                   
                                                   =
                                                   
                                                      F
                                                      
                                                         t
                                                      
                                                      ′
                                                   
                                                   
                                                      R
                                                      t
                                                   
                                                   
                                                      F
                                                      t
                                                   
                                                   +
                                                   
                                                      V
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   e
                                                   t
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      y
                                                      t
                                                   
                                                   −
                                                   
                                                      f
                                                      t
                                                   
                                                   ,
                                                   
                                                   
                                                      B
                                                      t
                                                   
                                                   =
                                                   
                                                      R
                                                      t
                                                   
                                                   
                                                      F
                                                      t
                                                   
                                                   
                                                      Q
                                                      
                                                         t
                                                      
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   m
                                                   t
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      b
                                                      t
                                                   
                                                   +
                                                   
                                                      B
                                                      t
                                                   
                                                   
                                                      e
                                                      t
                                                   
                                                   ,
                                                   
                                                   
                                                      C
                                                      t
                                                   
                                                   =
                                                   
                                                      R
                                                      t
                                                   
                                                   −
                                                   
                                                      B
                                                      t
                                                   
                                                   
                                                      Q
                                                      t
                                                   
                                                   
                                                      B
                                                      
                                                         t
                                                      
                                                      ′
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Note that the one-step forecast mean ft
                         only depends on 
                           
                              
                                 m
                                 
                                    t
                                    −
                                    1
                                 
                              
                              ,
                           
                         i.e. we only need to keep the most recent conditional mean of 
                           
                              θ
                              
                                 t
                                 −
                                 1
                              
                           
                         to forecast the next value. Hence when making a prediction based on 
                           
                              
                                 D
                                 
                                    t
                                    −
                                    1
                                 
                              
                              ,
                           
                         we need only to store 
                           
                              m
                              
                                 t
                                 −
                                 1
                              
                           
                        . Similarly, the variance Qt
                         only depends on the number of observations made, i.e. we can calculate a sequence Q
                        1,…, Qt
                         without knowing the observations y
                        1,…, yt
                        .

The distribution of 
                           
                              (
                              
                                 m
                                 
                                    t
                                    +
                                    1
                                 
                              
                              ∣
                              
                                 m
                                 t
                              
                              )
                           
                         can also be found (Nielsen et al., 2011, p. 303).

                           Theorem 2
                           
                              The conditional random variable
                              
                                 
                                    (
                                    
                                       m
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    ∣
                                    
                                       m
                                       t
                                    
                                    )
                                 
                               
                              follows a multivariate normal distribution 
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                m
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             ∣
                                             
                                                m
                                                t
                                             
                                             )
                                          
                                          ∼
                                          N
                                          
                                             (
                                             
                                                G
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             
                                                m
                                                t
                                             
                                             ,
                                             
                                                B
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             
                                                Q
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             
                                                B
                                                
                                                   t
                                                   +
                                                   1
                                                
                                                ′
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           

An nGSSM relaxes the Gaussian assumption of the observed values, i.e. observations are not conditional Gaussian given the values of the latent variable θt
                        . Instead the probability distribution of the observable variable yt
                         belongs to the exponential family, i.e. the density function is:

                           
                              (12)
                              
                                 
                                    f
                                    
                                       (
                                       
                                          y
                                          t
                                       
                                       |
                                       
                                          η
                                          t
                                       
                                       ,
                                       
                                          u
                                          t
                                       
                                       )
                                    
                                    =
                                    exp
                                    
                                       (
                                       
                                          
                                             x
                                             
                                                (
                                                
                                                   y
                                                   t
                                                
                                                )
                                             
                                             
                                                η
                                                t
                                             
                                             −
                                             a
                                             
                                                (
                                                
                                                   η
                                                   t
                                                
                                                )
                                             
                                          
                                          
                                             u
                                             t
                                          
                                       
                                       )
                                    
                                    q
                                    
                                       (
                                       
                                          y
                                          t
                                       
                                       ,
                                       
                                          u
                                          t
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        with natural parameter ηt
                         and scale parameter
                        
                           
                              u
                              t
                           
                        . Functions a(ηt
                        ), x(yt
                        ), and 
                           
                              q
                              (
                              
                                 y
                                 t
                              
                              ,
                              
                                 u
                                 t
                              
                              )
                           
                         are assumed known. The equation

                           
                              (13)
                              
                                 
                                    g
                                    
                                       (
                                       
                                          η
                                          t
                                       
                                       )
                                    
                                    =
                                    
                                       F
                                       t
                                    
                                    
                                       θ
                                       t
                                    
                                    ,
                                 
                              
                           
                        defines the impact of the latent variable θt
                         on the natural parameter ηt
                        . Here, g(ηt
                        ) is a known function. Finally, to specify the full nGSSM model, a system equation has to be specified:

                           
                              
                                 
                                    
                                       θ
                                       t
                                    
                                    =
                                    
                                       G
                                       t
                                    
                                    
                                       θ
                                       
                                          t
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       κ
                                       t
                                    
                                    ,
                                 
                              
                           
                        with κt
                         ∼ [0, Ht
                        ], meaning that κt
                         has zero mean and a covariance matrix Ht
                        . There is no assumption about a normal distribution. In other words, the distribution is only partially specified through its mean and variance (we use the notation κt
                         ∼ [mt, Ht
                        ]).

As for the GSSM, the purpose of Bayesian updating is to estimate the latent variable θt
                         using previous information 
                           
                              
                                 D
                                 
                                    t
                                    −
                                    1
                                 
                              
                              =
                              
                                 (
                                 
                                    y
                                    1
                                 
                                 ,
                                 …
                                 ,
                                 
                                    y
                                    
                                       t
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    m
                                    0
                                 
                                 ,
                                 
                                    C
                                    0
                                 
                                 )
                              
                           
                         available up to time 
                           
                              t
                              −
                              1
                           
                        . However, due to (13) we also estimate the parameter ηt
                        . An updating procedure was presented by Kristensen et al. (2010, Section 8.5.4). Since there is no normality assumption, only an approximate analysis can be conducted. Moreover, the conjugate family of ηt
                         must be known.

In our application a gamma distribution with shape parameter 
                           
                              a
                              t
                           
                         and scale parameter 
                           
                              b
                              t
                           
                         is used, i.e. 
                           
                              
                                 η
                                 t
                              
                              =
                              −
                              1
                              /
                              
                                 a
                                 t
                              
                              
                                 b
                                 t
                              
                              ,
                           
                        
                        
                           
                              
                                 V
                                 t
                              
                              =
                              1
                              /
                              
                                 a
                                 t
                              
                              ,
                           
                        
                        
                           
                              a
                              
                                 (
                                 
                                    η
                                    t
                                 
                                 )
                              
                              =
                              ln
                              
                                 (
                                 
                                    
                                       −
                                       1
                                    
                                    
                                       η
                                       t
                                    
                                 
                                 )
                              
                              ,
                           
                        
                        
                           
                              x
                              
                                 (
                                 
                                    y
                                    t
                                 
                                 )
                              
                              =
                              
                                 y
                                 t
                              
                           
                         and 
                           
                              q
                              
                                 (
                                 
                                    y
                                    t
                                 
                                 ,
                                 
                                    a
                                    t
                                 
                                 )
                              
                              =
                              
                                 y
                                 t
                                 
                                    
                                       a
                                       t
                                    
                                    −
                                    1
                                 
                              
                              
                                 a
                                 t
                                 
                                    a
                                    t
                                 
                              
                              /
                              Γ
                              
                                 (
                                 
                                    a
                                    t
                                 
                                 )
                              
                           
                         and the density becomes

                           
                              (14)
                              
                                 
                                    f
                                    
                                       (
                                       
                                          y
                                          t
                                       
                                       |
                                       
                                          a
                                          t
                                       
                                       ,
                                       
                                          b
                                          t
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          exp
                                          
                                             (
                                             −
                                             
                                                y
                                                t
                                             
                                             /
                                             
                                                b
                                                t
                                             
                                             )
                                          
                                          
                                             y
                                             t
                                             
                                                
                                                   a
                                                   t
                                                
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             b
                                             t
                                             
                                                a
                                                t
                                             
                                          
                                          Γ
                                          
                                             (
                                             
                                                a
                                                t
                                             
                                             )
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        Moreover, the conjugate prior of g(ηt
                        ) is an Inverse-Gamma distribution. As a result, the updating procedure (Kristensen et al., 2010, Section 8.5.4) reduces to the theorem below.

                           Theorem 3
                           
                              Suppose that at time
                              
                                 
                                    t
                                    −
                                    1
                                 
                               
                              we have 
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                θ
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             ∣
                                             
                                                D
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                          ∼
                                          
                                             [
                                             
                                                m
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             
                                                C
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             ]
                                          
                                          
                                          
                                             (
                                             p
                                             o
                                             s
                                             t
                                             e
                                             r
                                             i
                                             o
                                             r
                                             
                                             a
                                             t
                                             
                                             t
                                             i
                                             m
                                             e
                                             
                                             t
                                             −
                                             1
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                              Moreover, assume that
                              
                                 
                                    g
                                    
                                       (
                                       
                                          η
                                          t
                                       
                                       )
                                    
                                    ∼
                                    Inv-Gamma
                                    
                                       (
                                       
                                          c
                                          t
                                       
                                       ,
                                       
                                          d
                                          t
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    g
                                    
                                       (
                                       
                                          η
                                          t
                                       
                                       )
                                    
                                    =
                                    −
                                    1
                                    /
                                    
                                       η
                                       t
                                    
                                    ,
                                 
                               
                              and that the density
                              
                                 
                                    f
                                    (
                                    
                                       y
                                       t
                                    
                                    |
                                    
                                       a
                                       t
                                    
                                    ,
                                    
                                       b
                                       t
                                    
                                    )
                                 
                               
                              equals 
                              
                                 (14)
                              
                              . Then 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      θ
                                                      t
                                                   
                                                   ∣
                                                   
                                                      D
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   ∼
                                                   
                                                      [
                                                      
                                                         b
                                                         t
                                                      
                                                      ,
                                                      
                                                         R
                                                         t
                                                      
                                                      ]
                                                   
                                                
                                             
                                             
                                                
                                             
                                             
                                                
                                                   (
                                                   prior
                                                   at
                                                   time
                                                   t
                                                   )
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   g
                                                   
                                                      (
                                                      
                                                         η
                                                         t
                                                      
                                                      )
                                                   
                                                   ∣
                                                   
                                                      D
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   ∼
                                                   
                                                      [
                                                      
                                                         f
                                                         t
                                                      
                                                      ,
                                                      
                                                         Q
                                                         t
                                                      
                                                      ]
                                                   
                                                
                                             
                                             
                                                
                                             
                                             
                                                
                                                   (
                                                   prior
                                                   of
                                                   
                                                   g
                                                   
                                                      (
                                                      
                                                         η
                                                         t
                                                      
                                                      )
                                                   
                                                   
                                                   at
                                                   time
                                                   t
                                                   )
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      θ
                                                      t
                                                   
                                                   ∣
                                                   
                                                      D
                                                      t
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   ∼
                                                   
                                                      [
                                                      
                                                         m
                                                         t
                                                      
                                                      ,
                                                      
                                                         C
                                                         t
                                                      
                                                      ]
                                                   
                                                
                                             
                                             
                                                
                                             
                                             
                                                
                                                   (
                                                   posterior
                                                   at
                                                   time
                                                   t
                                                   )
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              where 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   b
                                                   t
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      G
                                                      t
                                                   
                                                   
                                                      m
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   R
                                                   t
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      G
                                                      t
                                                   
                                                   
                                                      C
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      G
                                                      t
                                                      ′
                                                   
                                                   +
                                                   
                                                      H
                                                      t
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   f
                                                   t
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      F
                                                      t
                                                      ′
                                                   
                                                   
                                                      b
                                                      t
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   Q
                                                   t
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      F
                                                      t
                                                      ′
                                                   
                                                   
                                                      R
                                                      t
                                                   
                                                   
                                                      F
                                                      t
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   m
                                                   t
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      b
                                                      t
                                                   
                                                   +
                                                   
                                                      R
                                                      t
                                                   
                                                   
                                                      F
                                                      t
                                                   
                                                   
                                                      (
                                                      
                                                         f
                                                         t
                                                         *
                                                      
                                                      −
                                                      
                                                         f
                                                         t
                                                      
                                                      )
                                                   
                                                   /
                                                   
                                                      Q
                                                      t
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   C
                                                   t
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      R
                                                      t
                                                   
                                                   −
                                                   
                                                      R
                                                      t
                                                   
                                                   
                                                      F
                                                      t
                                                   
                                                   
                                                      F
                                                      t
                                                      ′
                                                   
                                                   
                                                      R
                                                      t
                                                   
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         Q
                                                         t
                                                         *
                                                      
                                                      /
                                                      
                                                         Q
                                                         t
                                                      
                                                      )
                                                   
                                                   /
                                                   
                                                      Q
                                                      t
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   f
                                                   t
                                                   *
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      
                                                         α
                                                         t
                                                         *
                                                      
                                                      
                                                         β
                                                         t
                                                         *
                                                      
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   Q
                                                   t
                                                   *
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      
                                                         α
                                                         t
                                                         
                                                            *
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  β
                                                                  t
                                                                  *
                                                               
                                                               )
                                                            
                                                            2
                                                         
                                                         
                                                            (
                                                            
                                                               β
                                                               t
                                                               *
                                                            
                                                            −
                                                            1
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   α
                                                   t
                                                   *
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      α
                                                      t
                                                   
                                                   +
                                                   
                                                      a
                                                      t
                                                   
                                                   
                                                      y
                                                      t
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   β
                                                   t
                                                   *
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      β
                                                      t
                                                   
                                                   +
                                                   
                                                      a
                                                      t
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   α
                                                   t
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      
                                                         f
                                                         t
                                                         3
                                                      
                                                      
                                                         Q
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      f
                                                      t
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   β
                                                   t
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      
                                                         f
                                                         t
                                                         2
                                                      
                                                      
                                                         Q
                                                         t
                                                      
                                                   
                                                   +
                                                   1
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Consider the updating procedure by Kristensen et al. (2010, Section 8.5.4) which consists of seven steps. The first three steps are the same, but repeated below for readability.

                                 
                                    (a)
                                    Posterior information for 
                                          
                                             θ
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                        at time 
                                          
                                             t
                                             −
                                             1
                                          
                                       :

                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         θ
                                                         
                                                            t
                                                            −
                                                            1
                                                         
                                                      
                                                      ∣
                                                      
                                                         D
                                                         
                                                            t
                                                            −
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   ∼
                                                   
                                                      [
                                                      
                                                         m
                                                         
                                                            t
                                                            −
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         C
                                                         
                                                            t
                                                            −
                                                            1
                                                         
                                                      
                                                      ]
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    

Prior for θt
                                        at time t:

                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         θ
                                                         t
                                                      
                                                      ∣
                                                      
                                                         D
                                                         
                                                            t
                                                            −
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   ∼
                                                   
                                                      [
                                                      
                                                         b
                                                         t
                                                      
                                                      ,
                                                      
                                                         R
                                                         t
                                                      
                                                      ]
                                                   
                                                   ,
                                                   
                                                   
                                                      b
                                                      t
                                                   
                                                   =
                                                   
                                                      G
                                                      t
                                                   
                                                   
                                                      m
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                   
                                                      R
                                                      t
                                                   
                                                   =
                                                   
                                                      G
                                                      t
                                                   
                                                   
                                                      C
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      G
                                                      t
                                                      ′
                                                   
                                                   +
                                                   
                                                      H
                                                      t
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    

Prior for g(ηt
                                       ) at time t:

                                          
                                             
                                                
                                                   
                                                      (
                                                      g
                                                      
                                                         (
                                                         
                                                            η
                                                            t
                                                         
                                                         )
                                                      
                                                      ∣
                                                      
                                                         D
                                                         
                                                            t
                                                            −
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   ∼
                                                   
                                                      [
                                                      
                                                         f
                                                         t
                                                      
                                                      ,
                                                      
                                                         Q
                                                         t
                                                      
                                                      ]
                                                   
                                                   ,
                                                   
                                                   
                                                      f
                                                      t
                                                   
                                                   =
                                                   
                                                      F
                                                      t
                                                      ′
                                                   
                                                   
                                                      b
                                                      t
                                                   
                                                   ,
                                                   
                                                   
                                                      Q
                                                      t
                                                   
                                                   =
                                                   
                                                      F
                                                      t
                                                      ′
                                                   
                                                   
                                                      R
                                                      t
                                                   
                                                   
                                                      F
                                                      t
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    

Approximate full prior for ηt
                                        at time t: According to our assumptions we have that 
                                          
                                             
                                                (
                                                g
                                                
                                                   (
                                                   
                                                      η
                                                      t
                                                   
                                                   )
                                                
                                                ∣
                                                
                                                   D
                                                   
                                                      t
                                                      −
                                                      1
                                                   
                                                
                                                )
                                             
                                             ∼
                                             Inv-Gamma
                                             
                                                (
                                                
                                                   c
                                                   t
                                                
                                                ,
                                                
                                                   d
                                                   t
                                                
                                                )
                                             
                                          
                                        where 
                                          
                                             c
                                             t
                                          
                                        and 
                                          
                                             d
                                             t
                                          
                                        are the shape and scale parameters, 
                                          
                                             g
                                             
                                                (
                                                
                                                   η
                                                   t
                                                
                                                )
                                             
                                             =
                                             −
                                             1
                                             /
                                             
                                                η
                                                t
                                             
                                             ,
                                          
                                        and that the density of yt
                                        is (14).

In this step we need to identify the conjugate prior of 
                                          
                                             
                                                η
                                                t
                                             
                                             =
                                             −
                                             1
                                             /
                                             g
                                             
                                                (
                                                
                                                   η
                                                   t
                                                
                                                )
                                             
                                          
                                        using the general form of the conjugate prior with two parameters αt
                                        and βt
                                        (Kristensen et al., 2010):

                                          
                                             
                                                
                                                   f
                                                   
                                                      (
                                                      
                                                         η
                                                         t
                                                      
                                                      |
                                                      
                                                         D
                                                         
                                                            t
                                                            −
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   =
                                                   c
                                                   
                                                      (
                                                      
                                                         α
                                                         t
                                                      
                                                      ,
                                                      
                                                         β
                                                         t
                                                      
                                                      )
                                                   
                                                   exp
                                                   
                                                      (
                                                      
                                                         α
                                                         t
                                                      
                                                      
                                                         η
                                                         t
                                                      
                                                      −
                                                      
                                                         β
                                                         t
                                                      
                                                      a
                                                      
                                                         (
                                                         
                                                            η
                                                            t
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                             
                                          
                                       where c(αt, βt
                                       ) is a known function and 
                                          
                                             a
                                             
                                                (
                                                
                                                   η
                                                   t
                                                
                                                )
                                             
                                             =
                                             ln
                                             
                                                (
                                                −
                                                1
                                                /
                                                
                                                   η
                                                   t
                                                
                                                )
                                             
                                          
                                        as defined in (12). If we suppose 
                                          
                                             y
                                             =
                                             
                                                η
                                                t
                                             
                                          
                                        and 
                                          
                                             x
                                             =
                                             g
                                             (
                                             
                                                η
                                                t
                                             
                                             )
                                             ,
                                          
                                        i.e. 
                                          
                                             y
                                             =
                                             h
                                             
                                                (
                                                x
                                                )
                                             
                                             =
                                             
                                                
                                                   −
                                                   1
                                                
                                                x
                                             
                                             ,
                                          
                                        then by applying the transformation rule, the density function of ηt
                                        is

                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                            (
                                                            
                                                               η
                                                               t
                                                            
                                                            |
                                                            
                                                               D
                                                               
                                                                  t
                                                                  −
                                                                  1
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            =
                                                            
                                                               f
                                                               x
                                                            
                                                            
                                                               (
                                                               
                                                                  h
                                                                  
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               
                                                                  (
                                                                  y
                                                                  )
                                                               
                                                               |
                                                               
                                                                  D
                                                                  
                                                                     t
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               
                                                                  
                                                                     ∂
                                                                     
                                                                        h
                                                                        
                                                                           −
                                                                           1
                                                                        
                                                                     
                                                                     
                                                                        (
                                                                        y
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     ∂
                                                                     y
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            =
                                                            
                                                               
                                                                  d
                                                                  t
                                                                  
                                                                     c
                                                                     t
                                                                  
                                                               
                                                               
                                                                  Γ
                                                                  (
                                                                  
                                                                     c
                                                                     t
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               
                                                                  (
                                                                  −
                                                                  1
                                                                  /
                                                                  
                                                                     η
                                                                     t
                                                                  
                                                                  )
                                                               
                                                               
                                                                  −
                                                                  
                                                                     c
                                                                     t
                                                                  
                                                                  −
                                                                  1
                                                               
                                                            
                                                            exp
                                                            
                                                               (
                                                               −
                                                               
                                                                  
                                                                     d
                                                                     t
                                                                  
                                                                  
                                                                     −
                                                                     1
                                                                     /
                                                                     
                                                                        η
                                                                        t
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               1
                                                               
                                                                  η
                                                                  t
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            =
                                                            
                                                               
                                                                  d
                                                                  t
                                                                  
                                                                     c
                                                                     t
                                                                  
                                                               
                                                               
                                                                  Γ
                                                                  (
                                                                  
                                                                     c
                                                                     t
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               
                                                                  (
                                                                  −
                                                                  
                                                                     η
                                                                     t
                                                                  
                                                                  )
                                                               
                                                               
                                                                  
                                                                     c
                                                                     t
                                                                  
                                                                  −
                                                                  1
                                                               
                                                            
                                                            exp
                                                            
                                                               (
                                                               
                                                                  d
                                                                  t
                                                               
                                                               
                                                                  η
                                                                  t
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            =
                                                            
                                                               
                                                                  d
                                                                  t
                                                                  
                                                                     c
                                                                     t
                                                                  
                                                               
                                                               
                                                                  Γ
                                                                  (
                                                                  
                                                                     c
                                                                     t
                                                                  
                                                                  )
                                                               
                                                            
                                                            exp
                                                            
                                                               (
                                                               
                                                                  d
                                                                  t
                                                               
                                                               
                                                                  η
                                                                  t
                                                               
                                                               −
                                                               
                                                                  (
                                                                  
                                                                     c
                                                                     t
                                                                  
                                                                  −
                                                                  1
                                                                  )
                                                               
                                                               ln
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        −
                                                                        1
                                                                     
                                                                     
                                                                        η
                                                                        t
                                                                     
                                                                  
                                                                  )
                                                               
                                                               )
                                                            
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       Hence the parameters αt
                                        and βt
                                        in the conjugate prior of ηt
                                        become:

                                          
                                             (15)
                                             
                                                
                                                   
                                                      α
                                                      t
                                                   
                                                   =
                                                   
                                                      d
                                                      t
                                                   
                                                   ,
                                                   
                                                   
                                                      β
                                                      t
                                                   
                                                   =
                                                   
                                                      c
                                                      t
                                                   
                                                   −
                                                   1
                                                   .
                                                
                                             
                                          
                                       Finally, we fit αt
                                        and βt
                                        such that

                                          
                                             (16)
                                             
                                                
                                                   
                                                      
                                                         
                                                            E
                                                            
                                                               (
                                                               g
                                                               
                                                                  (
                                                                  
                                                                     η
                                                                     t
                                                                  
                                                                  )
                                                               
                                                               ∣
                                                               
                                                                  D
                                                                  
                                                                     t
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            =
                                                            
                                                               
                                                                  d
                                                                  t
                                                               
                                                               
                                                                  
                                                                     c
                                                                     t
                                                                  
                                                                  −
                                                                  1
                                                               
                                                            
                                                            =
                                                            
                                                               
                                                                  α
                                                                  t
                                                               
                                                               
                                                                  β
                                                                  t
                                                               
                                                            
                                                            =
                                                            
                                                               f
                                                               t
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Var
                                                            (
                                                            g
                                                            
                                                               (
                                                               
                                                                  η
                                                                  t
                                                               
                                                               )
                                                            
                                                            ∣
                                                            
                                                               D
                                                               
                                                                  t
                                                                  −
                                                                  1
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            =
                                                            
                                                               
                                                                  d
                                                                  t
                                                                  2
                                                               
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           c
                                                                           t
                                                                        
                                                                        −
                                                                        1
                                                                        )
                                                                     
                                                                     2
                                                                  
                                                                  
                                                                     (
                                                                     
                                                                        c
                                                                        t
                                                                     
                                                                     −
                                                                     2
                                                                     )
                                                                  
                                                               
                                                            
                                                            =
                                                            
                                                               
                                                                  α
                                                                  t
                                                                  2
                                                               
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           β
                                                                           t
                                                                        
                                                                        )
                                                                     
                                                                     2
                                                                  
                                                                  
                                                                     (
                                                                     
                                                                        β
                                                                        t
                                                                     
                                                                     −
                                                                     1
                                                                     )
                                                                  
                                                               
                                                            
                                                            =
                                                            
                                                               Q
                                                               t
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       implying that

                                          
                                             
                                                
                                                   
                                                      α
                                                      t
                                                   
                                                   =
                                                   
                                                      
                                                         f
                                                         t
                                                         3
                                                      
                                                      
                                                         Q
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      f
                                                      t
                                                   
                                                   ,
                                                   
                                                   
                                                      β
                                                      t
                                                   
                                                   =
                                                   
                                                      
                                                         f
                                                         t
                                                         2
                                                      
                                                      
                                                         Q
                                                         t
                                                      
                                                   
                                                   +
                                                   1
                                                   .
                                                
                                             
                                          
                                       
                                    

One step forecast of yt
                                       : In this step we need to find the forecast distribution 
                                          
                                             f
                                             (
                                             
                                                y
                                                t
                                             
                                             |
                                             
                                                D
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                       . According to the concepts of the nGSSM models, the general form of this distribution with two parameters αt
                                        and βt
                                        is (Kristensen et al., 2010):

                                          
                                             
                                                
                                                   f
                                                   
                                                      (
                                                      
                                                         y
                                                         t
                                                      
                                                      |
                                                      
                                                         D
                                                         
                                                            t
                                                            −
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      
                                                         c
                                                         
                                                            (
                                                            
                                                               α
                                                               t
                                                            
                                                            ,
                                                            
                                                               β
                                                               t
                                                            
                                                            )
                                                         
                                                         q
                                                         
                                                            (
                                                            
                                                               y
                                                               t
                                                            
                                                            ,
                                                            
                                                               u
                                                               t
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         c
                                                         (
                                                         
                                                            α
                                                            t
                                                         
                                                         +
                                                         
                                                            ϕ
                                                            t
                                                         
                                                         x
                                                         
                                                            (
                                                            
                                                               y
                                                               t
                                                            
                                                            )
                                                         
                                                         ,
                                                         
                                                            β
                                                            t
                                                         
                                                         +
                                                         
                                                            ϕ
                                                            t
                                                         
                                                         )
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                       where 
                                          
                                             q
                                             (
                                             
                                                y
                                                t
                                             
                                             ,
                                             
                                                u
                                                t
                                             
                                             )
                                          
                                        and x(yt
                                       ) have been defined in (12) and 
                                          
                                             
                                                ϕ
                                                t
                                             
                                             =
                                             
                                                1
                                                
                                                   u
                                                   t
                                                
                                             
                                          
                                       . Using the values of αt
                                        and βt
                                        found in Step (d), the forecast distribution 
                                          
                                             f
                                             (
                                             
                                                y
                                                t
                                             
                                             |
                                             
                                                D
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                        equals

                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                            (
                                                            
                                                               y
                                                               t
                                                            
                                                            |
                                                            
                                                               D
                                                               
                                                                  t
                                                                  −
                                                                  1
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         =
                                                      
                                                      
                                                         
                                                            
                                                               1
                                                               
                                                                  B
                                                                  (
                                                                  
                                                                     a
                                                                     t
                                                                  
                                                                  ,
                                                                  
                                                                     c
                                                                     t
                                                                  
                                                                  )
                                                               
                                                            
                                                            ·
                                                            
                                                               1
                                                               
                                                                  
                                                                     d
                                                                     t
                                                                  
                                                                  /
                                                                  
                                                                     a
                                                                     t
                                                                  
                                                               
                                                            
                                                            ·
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        
                                                                           y
                                                                           t
                                                                        
                                                                        −
                                                                        0
                                                                     
                                                                     
                                                                        
                                                                           d
                                                                           t
                                                                        
                                                                        /
                                                                        
                                                                           a
                                                                           t
                                                                        
                                                                     
                                                                  
                                                                  )
                                                               
                                                               
                                                                  
                                                                     a
                                                                     t
                                                                  
                                                                  −
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            ·
                                                            
                                                               
                                                                  (
                                                                  1
                                                                  +
                                                                  
                                                                     
                                                                        
                                                                           y
                                                                           t
                                                                        
                                                                        −
                                                                        0
                                                                     
                                                                     
                                                                        
                                                                           d
                                                                           t
                                                                        
                                                                        /
                                                                        
                                                                           a
                                                                           t
                                                                        
                                                                     
                                                                  
                                                                  )
                                                               
                                                               
                                                                  −
                                                                  
                                                                     a
                                                                     t
                                                                  
                                                                  −
                                                                  
                                                                     c
                                                                     t
                                                                  
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       where 
                                          
                                             B
                                             
                                                (
                                                
                                                   a
                                                   t
                                                
                                                ,
                                                
                                                   c
                                                   t
                                                
                                                )
                                             
                                             =
                                             
                                                
                                                   Γ
                                                   
                                                      (
                                                      
                                                         a
                                                         t
                                                      
                                                      )
                                                   
                                                   Γ
                                                   
                                                      (
                                                      
                                                         c
                                                         t
                                                      
                                                      )
                                                   
                                                
                                                
                                                   Γ
                                                   (
                                                   
                                                      a
                                                      t
                                                   
                                                   +
                                                   
                                                      c
                                                      t
                                                   
                                                   )
                                                
                                             
                                          
                                       . That is a generalized beta prime distribution denoted by β′ (Crooks, 2013, p. 50) and hence

                                          
                                             (17)
                                             
                                                
                                                   
                                                      (
                                                      
                                                         y
                                                         t
                                                      
                                                      |
                                                      
                                                         D
                                                         
                                                            t
                                                            −
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   ∼
                                                   
                                                      β
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         ψ
                                                         1
                                                      
                                                      ,
                                                      
                                                         ψ
                                                         2
                                                      
                                                      ,
                                                      
                                                         ψ
                                                         3
                                                      
                                                      ,
                                                      
                                                         ψ
                                                         4
                                                      
                                                      ,
                                                      
                                                         ψ
                                                         5
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                             
                                          
                                       with parameters: 
                                          
                                             
                                                ψ
                                                1
                                             
                                             =
                                             0
                                          
                                        (location); 
                                          
                                             
                                                ψ
                                                2
                                             
                                             =
                                             
                                                d
                                                t
                                             
                                             /
                                             
                                                a
                                                t
                                             
                                          
                                        (scale); 
                                          
                                             
                                                ψ
                                                3
                                             
                                             =
                                             
                                                a
                                                t
                                             
                                          
                                        (first shape); 
                                          
                                             
                                                ψ
                                                4
                                             
                                             =
                                             
                                                c
                                                t
                                             
                                          
                                        (second shape); and 
                                          
                                             
                                                ψ
                                                5
                                             
                                             =
                                             1
                                          
                                        (Weibull power parameter).

Posterior distributions for ηt
                                        and g(ηt
                                       ) at time t: The general form of posterior density function of ηt
                                        is:

                                          
                                             
                                                
                                                   f
                                                   
                                                      (
                                                      
                                                         η
                                                         t
                                                      
                                                      |
                                                      
                                                         D
                                                         t
                                                      
                                                      )
                                                   
                                                   =
                                                   c
                                                   
                                                      (
                                                      
                                                         α
                                                         t
                                                         *
                                                      
                                                      ,
                                                      
                                                         β
                                                         t
                                                         *
                                                      
                                                      )
                                                   
                                                   exp
                                                   
                                                      (
                                                      
                                                         α
                                                         t
                                                         *
                                                      
                                                      
                                                         η
                                                         t
                                                      
                                                      −
                                                      
                                                         β
                                                         t
                                                         *
                                                      
                                                      a
                                                      
                                                         (
                                                         
                                                            η
                                                            t
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                             
                                          
                                       with

                                          
                                             (18)
                                             
                                                
                                                   
                                                      α
                                                      t
                                                      *
                                                   
                                                   =
                                                   
                                                      α
                                                      t
                                                   
                                                   +
                                                   
                                                      ϕ
                                                      t
                                                   
                                                   
                                                      y
                                                      t
                                                   
                                                   =
                                                   
                                                      α
                                                      t
                                                   
                                                   +
                                                   
                                                      a
                                                      t
                                                   
                                                   
                                                      y
                                                      t
                                                   
                                                   ,
                                                   
                                                   
                                                      β
                                                      t
                                                      *
                                                   
                                                   =
                                                   
                                                      β
                                                      t
                                                   
                                                   +
                                                   
                                                      ϕ
                                                      t
                                                   
                                                   =
                                                   
                                                      β
                                                      t
                                                   
                                                   +
                                                   
                                                      a
                                                      t
                                                   
                                                   .
                                                
                                             
                                          
                                       The last relation follows from 
                                          
                                             
                                                ϕ
                                                t
                                             
                                             =
                                             
                                                1
                                                
                                                   u
                                                   t
                                                
                                             
                                             =
                                             
                                                a
                                                t
                                             
                                          
                                       . If we suppose 
                                          
                                             x
                                             =
                                             
                                                η
                                                t
                                             
                                          
                                        and 
                                          
                                             y
                                             =
                                             g
                                             (
                                             
                                                η
                                                t
                                             
                                             )
                                          
                                        then, based on relation 
                                          
                                             g
                                             
                                                (
                                                
                                                   η
                                                   t
                                                
                                                )
                                             
                                             =
                                             −
                                             1
                                             /
                                             
                                                η
                                                t
                                             
                                             ,
                                          
                                        we have 
                                          
                                             y
                                             =
                                             h
                                             
                                                (
                                                x
                                                )
                                             
                                             =
                                             
                                                
                                                   −
                                                   1
                                                
                                                x
                                             
                                          
                                        and using the transformation rule, the posterior distribution of g(ηt
                                       ) is:

                                          
                                             (19)
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                               
                                                                  g
                                                                  (
                                                                  
                                                                     η
                                                                     t
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               (
                                                               g
                                                               
                                                                  (
                                                                  
                                                                     η
                                                                     t
                                                                  
                                                                  )
                                                               
                                                               |
                                                               
                                                                  D
                                                                  t
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         =
                                                      
                                                      
                                                         
                                                            
                                                               f
                                                               x
                                                            
                                                            
                                                               (
                                                               
                                                                  h
                                                                  
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               
                                                                  (
                                                                  y
                                                                  )
                                                               
                                                               |
                                                               
                                                                  D
                                                                  t
                                                               
                                                               )
                                                            
                                                            
                                                               
                                                                  
                                                                     ∂
                                                                     
                                                                        h
                                                                        
                                                                           −
                                                                           1
                                                                        
                                                                     
                                                                     
                                                                        (
                                                                        y
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     ∂
                                                                     y
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         =
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        α
                                                                        t
                                                                        *
                                                                     
                                                                     )
                                                                  
                                                                  
                                                                     
                                                                        β
                                                                        t
                                                                        *
                                                                     
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               
                                                                  Γ
                                                                  (
                                                                  
                                                                     β
                                                                     t
                                                                     *
                                                                  
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            exp
                                                            
                                                               (
                                                               
                                                                  
                                                                     −
                                                                     
                                                                        α
                                                                        t
                                                                        *
                                                                     
                                                                  
                                                                  
                                                                     g
                                                                     (
                                                                     
                                                                        η
                                                                        t
                                                                     
                                                                     )
                                                                  
                                                               
                                                               −
                                                               
                                                                  β
                                                                  t
                                                                  *
                                                               
                                                               ln
                                                               
                                                                  (
                                                                  g
                                                                  
                                                                     (
                                                                     
                                                                        η
                                                                        t
                                                                     
                                                                     )
                                                                  
                                                                  )
                                                               
                                                               )
                                                            
                                                            
                                                               1
                                                               
                                                                  g
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           η
                                                                           t
                                                                        
                                                                        )
                                                                     
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         =
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        α
                                                                        t
                                                                        *
                                                                     
                                                                     )
                                                                  
                                                                  
                                                                     
                                                                        β
                                                                        t
                                                                        *
                                                                     
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               
                                                                  Γ
                                                                  (
                                                                  
                                                                     β
                                                                     t
                                                                     *
                                                                  
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            
                                                               
                                                                  (
                                                                  g
                                                                  
                                                                     (
                                                                     
                                                                        η
                                                                        t
                                                                     
                                                                     )
                                                                  
                                                                  )
                                                               
                                                               
                                                                  −
                                                                  (
                                                                  
                                                                     β
                                                                     t
                                                                     *
                                                                  
                                                                  +
                                                                  1
                                                                  )
                                                                  −
                                                                  1
                                                               
                                                            
                                                            exp
                                                            
                                                               (
                                                               −
                                                               
                                                                  
                                                                     α
                                                                     t
                                                                     *
                                                                  
                                                                  
                                                                     g
                                                                     (
                                                                     
                                                                        η
                                                                        t
                                                                     
                                                                     )
                                                                  
                                                               
                                                               )
                                                            
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

It follows from (19) that 
                                          
                                             
                                                (
                                                g
                                                
                                                   (
                                                   
                                                      η
                                                      t
                                                   
                                                   )
                                                
                                                ∣
                                                
                                                   D
                                                   t
                                                
                                                )
                                             
                                             ∼
                                             Inv-Gamma
                                             
                                                (
                                                
                                                   c
                                                   t
                                                   *
                                                
                                                ,
                                                
                                                   d
                                                   t
                                                   *
                                                
                                                )
                                             
                                          
                                        with

                                          
                                             
                                                
                                                   
                                                      c
                                                      t
                                                      *
                                                   
                                                   =
                                                   
                                                      β
                                                      t
                                                      *
                                                   
                                                   +
                                                   1
                                                   ,
                                                   
                                                   
                                                      d
                                                      t
                                                      *
                                                   
                                                   =
                                                   
                                                      α
                                                      t
                                                      *
                                                   
                                                   .
                                                
                                             
                                          
                                       Next, we fit 
                                          
                                             α
                                             t
                                             *
                                          
                                        and 
                                          
                                             β
                                             t
                                             *
                                          
                                        such that

                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                               t
                                                               *
                                                            
                                                            =
                                                            E
                                                            
                                                               (
                                                               g
                                                               
                                                                  (
                                                                  
                                                                     η
                                                                     t
                                                                  
                                                                  )
                                                               
                                                               ∣
                                                               
                                                                  D
                                                                  t
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         =
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                                  t
                                                                  *
                                                               
                                                               
                                                                  
                                                                     c
                                                                     t
                                                                     *
                                                                  
                                                                  −
                                                                  1
                                                               
                                                            
                                                            =
                                                            
                                                               
                                                                  α
                                                                  t
                                                                  *
                                                               
                                                               
                                                                  β
                                                                  t
                                                                  *
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               Q
                                                               t
                                                               *
                                                            
                                                            =
                                                            Var
                                                            
                                                               (
                                                               g
                                                               
                                                                  (
                                                                  
                                                                     η
                                                                     t
                                                                  
                                                                  )
                                                               
                                                               ∣
                                                               
                                                                  D
                                                                  t
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         =
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     d
                                                                     t
                                                                     *
                                                                  
                                                                  )
                                                               
                                                               2
                                                            
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        c
                                                                        t
                                                                        *
                                                                     
                                                                     −
                                                                     1
                                                                     )
                                                                  
                                                                  2
                                                               
                                                               
                                                                  (
                                                                  
                                                                     c
                                                                     t
                                                                     *
                                                                  
                                                                  −
                                                                  2
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         =
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        α
                                                                        t
                                                                        *
                                                                     
                                                                     )
                                                                  
                                                                  2
                                                               
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           β
                                                                           t
                                                                           *
                                                                        
                                                                        )
                                                                     
                                                                     2
                                                                  
                                                                  
                                                                     (
                                                                     
                                                                        β
                                                                        t
                                                                        *
                                                                     
                                                                     −
                                                                     1
                                                                     )
                                                                  
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

Posterior of θt
                                        at t: The posterior parameters mt
                                        and Ct
                                        are

                                          
                                             
                                                
                                                   
                                                      m
                                                      t
                                                   
                                                   =
                                                   
                                                      b
                                                      t
                                                   
                                                   +
                                                   
                                                      R
                                                      t
                                                   
                                                   
                                                      F
                                                      t
                                                   
                                                   
                                                      (
                                                      
                                                         f
                                                         t
                                                         *
                                                      
                                                      −
                                                      
                                                         f
                                                         t
                                                      
                                                      )
                                                   
                                                   /
                                                   
                                                      Q
                                                      t
                                                   
                                                   ,
                                                   
                                                   
                                                      C
                                                      t
                                                   
                                                   =
                                                   
                                                      R
                                                      t
                                                   
                                                   −
                                                   
                                                      R
                                                      t
                                                   
                                                   
                                                      F
                                                      t
                                                   
                                                   
                                                      F
                                                      t
                                                      ′
                                                   
                                                   
                                                      R
                                                      t
                                                   
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         Q
                                                         t
                                                         *
                                                      
                                                      /
                                                      
                                                         Q
                                                         t
                                                      
                                                      )
                                                   
                                                   /
                                                   
                                                      Q
                                                      t
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    

Since the above steps calculate the values stated in Theorem 3, this finishes the proof.□


                              Given 
                              
                                 Theorem 3
                               
                              and
                              
                                 
                                    
                                       F
                                       t
                                    
                                    =
                                    1
                                 
                               
                              we have that 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                   t
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      b
                                                      t
                                                   
                                                   ,
                                                   
                                                   
                                                      Q
                                                      t
                                                   
                                                   
                                                   =
                                                   
                                                      R
                                                      t
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   m
                                                   t
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      f
                                                      t
                                                      *
                                                   
                                                   ,
                                                   
                                                   
                                                      C
                                                      t
                                                   
                                                   
                                                   =
                                                   
                                                      Q
                                                      t
                                                      *
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Finally, the probability distribution of 
                           
                              (
                              
                                 m
                                 
                                    t
                                    +
                                    1
                                 
                              
                              ∣
                              
                                 m
                                 t
                              
                              )
                           
                         can be found.

                           Theorem 4
                           
                              Under 
                              
                                 Theorem 3
                               
                              and 
                              
                                 Corollary 1
                               
                              and assuming
                              
                                 
                                    
                                       H
                                       t
                                    
                                    =
                                    0
                                    ,
                                 
                               
                              the conditional random variable
                              
                                 
                                    (
                                    
                                       m
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    ∣
                                    
                                       m
                                       t
                                    
                                    )
                                 
                               
                              follows a generalized beta prime distribution. That is, 
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                m
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             ∣
                                             
                                                m
                                                t
                                             
                                             )
                                          
                                          ∼
                                          
                                             β
                                             ′
                                          
                                          
                                             (
                                             
                                                ψ
                                                1
                                             
                                             ,
                                             
                                                ψ
                                                2
                                             
                                             ,
                                             
                                                ψ
                                                3
                                             
                                             ,
                                             
                                                ψ
                                                4
                                             
                                             ,
                                             
                                                ψ
                                                5
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                              with parameters:
                              
                                 
                                    
                                       ψ
                                       1
                                    
                                    =
                                    
                                       G
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    
                                       m
                                       t
                                    
                                    
                                       β
                                       t
                                       *
                                    
                                    /
                                    
                                       (
                                       
                                          β
                                          t
                                          *
                                       
                                       +
                                       
                                          a
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                 
                               
                              (location),
                              
                                 
                                    
                                       ψ
                                       2
                                    
                                    =
                                    
                                       ψ
                                       1
                                    
                                 
                               
                              (scale),
                              
                                 
                                    
                                       ψ
                                       3
                                    
                                    =
                                    
                                       a
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                 
                               
                              (first shape),
                              
                                 
                                    
                                       ψ
                                       4
                                    
                                    =
                                    
                                       β
                                       t
                                       *
                                    
                                    +
                                    1
                                 
                               
                              (second shape), and
                              
                                 
                                    
                                       ψ
                                       5
                                    
                                    =
                                    1
                                 
                               
                              (Weibull power) where
                              
                                 
                                    a
                                    
                                       t
                                       +
                                       1
                                    
                                 
                               
                              is the shape parameter of the exponential family distribution of
                              
                                 
                                    y
                                    
                                       t
                                       +
                                       1
                                    
                                 
                              
                              .
                           

Assume that Theorem 3 and Corollary 1 hold. Then

                                 
                                    
                                       
                                          
                                             (
                                             
                                                m
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             ∣
                                             
                                                m
                                                t
                                             
                                             )
                                          
                                          =
                                          
                                             (
                                             
                                                f
                                                
                                                   t
                                                   +
                                                   1
                                                
                                                *
                                             
                                             ∣
                                             
                                                m
                                                t
                                             
                                             )
                                          
                                          =
                                          
                                             (
                                             
                                                
                                                   α
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                   *
                                                
                                                
                                                   β
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                   *
                                                
                                             
                                             ∣
                                             
                                                m
                                                t
                                             
                                             )
                                          
                                          =
                                          
                                             A
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          +
                                          
                                             B
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                y
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             |
                                             
                                                D
                                                t
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              since based on (18) we have that

                                 
                                    
                                       
                                          
                                             
                                                α
                                                
                                                   t
                                                   +
                                                   1
                                                
                                                *
                                             
                                             
                                                β
                                                
                                                   t
                                                   +
                                                   1
                                                
                                                *
                                             
                                          
                                          =
                                          
                                             A
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          +
                                          
                                             B
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          
                                             y
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                              where

                                 
                                    
                                       
                                          
                                             A
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                α
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             
                                                
                                                   β
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                                +
                                                
                                                   a
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                          
                                             B
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                a
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             
                                                
                                                   β
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                                +
                                                
                                                   a
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              From (16) and since 
                                 
                                    
                                       H
                                       t
                                    
                                    =
                                    0
                                    ,
                                 
                               we have that

                                 
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      
                                                         α
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                      
                                                         f
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         f
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                         2
                                                      
                                                      
                                                         Q
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                   +
                                                   1
                                                   =
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               G
                                                               
                                                                  t
                                                                  +
                                                                  1
                                                               
                                                            
                                                            
                                                               f
                                                               t
                                                               *
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                      
                                                         
                                                            G
                                                            
                                                               t
                                                               +
                                                               1
                                                            
                                                         
                                                         
                                                            Q
                                                            t
                                                            *
                                                         
                                                         
                                                            G
                                                            
                                                               t
                                                               +
                                                               1
                                                            
                                                            ′
                                                         
                                                      
                                                   
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                         t
                                                         
                                                            *
                                                            2
                                                         
                                                      
                                                      
                                                         Q
                                                         t
                                                         *
                                                      
                                                   
                                                   +
                                                   1
                                                   =
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               α
                                                               t
                                                               *
                                                            
                                                            
                                                               β
                                                               t
                                                               *
                                                            
                                                         
                                                         )
                                                      
                                                      2
                                                   
                                                   
                                                      
                                                         α
                                                         t
                                                         
                                                            *
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            β
                                                            t
                                                            
                                                               *
                                                               2
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               β
                                                               t
                                                               *
                                                            
                                                            −
                                                            1
                                                            )
                                                         
                                                      
                                                   
                                                   +
                                                   1
                                                   =
                                                   
                                                      β
                                                      t
                                                      *
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              which implies that

                                 
                                    
                                       
                                          
                                             α
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             f
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          
                                             β
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             f
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          
                                             β
                                             t
                                             *
                                          
                                          =
                                          
                                             G
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          
                                             m
                                             t
                                          
                                          
                                             β
                                             t
                                             *
                                          
                                          .
                                       
                                    
                                 
                              As a result we can compute 
                                 
                                    A
                                    
                                       t
                                       +
                                       1
                                    
                                 
                               and 
                                 
                                    B
                                    
                                       t
                                       +
                                       1
                                    
                                 
                               as

                                 
                                    
                                       
                                          
                                             A
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   G
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   m
                                                   t
                                                
                                                
                                                   β
                                                   t
                                                   *
                                                
                                             
                                             
                                                
                                                   β
                                                   t
                                                   *
                                                
                                                +
                                                
                                                   a
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                          
                                             B
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                a
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             
                                                
                                                   β
                                                   t
                                                   *
                                                
                                                +
                                                
                                                   a
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              which are two scalars given mt
                               (since parameters 
                                 
                                    a
                                    
                                       t
                                       +
                                       1
                                    
                                 
                               and 
                                 
                                    β
                                    t
                                    *
                                 
                               are known values given t).

Recall from (17), we have that 
                                 
                                    
                                       (
                                       
                                          y
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       ∣
                                       
                                          D
                                          t
                                       
                                       )
                                    
                                    ∼
                                    
                                       β
                                       ′
                                    
                                    
                                       (
                                       
                                          
                                             ψ
                                             ˇ
                                          
                                          1
                                       
                                       ,
                                       
                                          
                                             ψ
                                             ˇ
                                          
                                          2
                                       
                                       ,
                                       
                                          
                                             ψ
                                             ˇ
                                          
                                          3
                                       
                                       ,
                                       
                                          
                                             ψ
                                             ˇ
                                          
                                          4
                                       
                                       ,
                                       
                                          
                                             ψ
                                             ˇ
                                          
                                          5
                                       
                                       )
                                    
                                    ,
                                 
                               with parameters: 
                                 
                                    
                                       
                                          ψ
                                          ˇ
                                       
                                       1
                                    
                                    =
                                    0
                                 
                               (location), 
                                 
                                    
                                       
                                          ψ
                                          ˇ
                                       
                                       2
                                    
                                    =
                                    
                                       d
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    /
                                    
                                       a
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                 
                               (scale), 
                                 
                                    
                                       
                                          ψ
                                          ˇ
                                       
                                       3
                                    
                                    =
                                    
                                       a
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                 
                               (first shape), 
                                 
                                    
                                       
                                          ψ
                                          ˇ
                                       
                                       4
                                    
                                    =
                                    
                                       c
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                 
                               (second shape), and 
                                 
                                    
                                       
                                          ψ
                                          ˇ
                                       
                                       5
                                    
                                    =
                                    1
                                 
                               (Weibull power parameter). Hence we have that

                                 
                                    
                                       
                                          
                                             (
                                             
                                                m
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             ∣
                                             
                                                m
                                                t
                                             
                                             )
                                          
                                          ∼
                                          
                                             β
                                             ′
                                          
                                          
                                             (
                                             
                                                ψ
                                                1
                                             
                                             ,
                                             
                                                ψ
                                                2
                                             
                                             ,
                                             
                                                ψ
                                                3
                                             
                                             ,
                                             
                                                ψ
                                                4
                                             
                                             ,
                                             
                                                ψ
                                                5
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              with parameters: 
                                 
                                    
                                       ψ
                                       1
                                    
                                    =
                                    
                                       A
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       ψ
                                       2
                                    
                                    =
                                    
                                       B
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    
                                       d
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    /
                                    
                                       a
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       ψ
                                       3
                                    
                                    =
                                    
                                       a
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       ψ
                                       4
                                    
                                    =
                                    
                                       c
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    ,
                                 
                               and 
                                 
                                    
                                       ψ
                                       5
                                    
                                    =
                                    1
                                 
                              . Here we have used the property that if

                                 
                                    
                                       
                                          X
                                          ∼
                                          
                                             β
                                             ′
                                          
                                          
                                             (
                                             
                                                ψ
                                                1
                                             
                                             ,
                                             
                                                ψ
                                                2
                                             
                                             ,
                                             
                                                ψ
                                                3
                                             
                                             ,
                                             
                                                ψ
                                                4
                                             
                                             ,
                                             
                                                ψ
                                                5
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              then (based on the transformation rule)

                                 
                                    
                                       
                                          a
                                          +
                                          b
                                          X
                                          ∼
                                          
                                             β
                                             ′
                                          
                                          
                                             (
                                             a
                                             +
                                             
                                                ψ
                                                1
                                             
                                             ,
                                             b
                                             
                                                ψ
                                                2
                                             
                                             ,
                                             
                                                ψ
                                                3
                                             
                                             ,
                                             
                                                ψ
                                                4
                                             
                                             ,
                                             
                                                ψ
                                                5
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              Note that due to (15), we have that

                                 
                                    
                                       
                                          
                                             ψ
                                             2
                                          
                                          =
                                          
                                             B
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          
                                             d
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          /
                                          
                                             a
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                d
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             
                                                
                                                   β
                                                   t
                                                   *
                                                
                                                +
                                                
                                                   a
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                α
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             
                                                
                                                   β
                                                   t
                                                   *
                                                
                                                +
                                                
                                                   a
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             A
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                              and

                                 
                                    
                                       
                                          
                                             ψ
                                             4
                                          
                                          =
                                          
                                             c
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             β
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          +
                                          1
                                          =
                                          
                                             β
                                             t
                                             *
                                          
                                          +
                                          1
                                          ,
                                       
                                    
                                 
                              which finishes the proof.□

@&#REFERENCES@&#

