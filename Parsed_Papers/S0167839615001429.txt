@&#MAIN-TITLE@&#Constrained multi-degree reduction with respect to Jacobi norms

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We study the problem of constrained degree reduction with respect to Jacobi norms.


                        
                        
                           
                           Our results generalize several previous findings on polynomial degree reduction.


                        
                        
                           
                           We explore the space of Jacobi parameters on the reduced polynomial approximation.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Degree reduction

Weighted least squares

Jacobi norm

Hahn orthogonal polynomials

@&#ABSTRACT@&#


               
               
                  We show that a weighted least squares approximation of Bézier coefficients with factored Hahn weights provides the best constrained polynomial degree reduction with respect to the Jacobi 
                        
                           
                              L
                           
                           
                              2
                           
                        
                     -norm. This result affords generalizations to many previous findings in the field of polynomial degree reduction. A solution method to the constrained multi-degree reduction with respect to the Jacobi 
                        
                           
                              L
                           
                           
                              2
                           
                        
                     -norm is presented.
               
            

@&#INTRODUCTION@&#

Optimal degree reduction is one of the fundamental tasks in Computer Aided Geometric Design (CAGD) and therefore has attracted researchers' attention for several decades (Ait-Haddou, in press; Zhou and Wang, 2009; Ahn et al., 2004; Ahn, 2003; Kim and Ahn, 2000; Lutterkort et al., 1999; Watkins and Worsey, 1988). Used not only for data compression, CAD/CAM software typically requires algorithms capable of converting a curve (surface) of a high degree to a curve (surface) of a lower degree. Considering the problem coordinate-wise, the goal is formulated as follows: given a univariate polynomial p of degree n, find its best polynomial approximation q of degree m, 
                        m
                        <
                        n
                     , with respect to a certain given norm.

The degree reduction can be seen as an inverse operation to the degree elevation. Whereas elevating polynomial degree from m to n is always possible, see e.g. (Hoschek and Lasser, 1993), because it is equivalent to expressing a polynomial 
                        q
                        ∈
                        
                           
                              P
                           
                           
                              m
                           
                        
                      in the basis of a larger linear space 
                        
                           
                              P
                           
                           
                              n
                           
                        
                     , 
                        
                           
                              P
                           
                           
                              m
                           
                        
                        ⊂
                        
                           
                              P
                           
                           
                              n
                           
                        
                     , the degree reduction is in general not. A natural alternative is then finding the best approximation that minimizes a certain error. This can be interpreted as projecting 
                        p
                        ∈
                        
                           
                              P
                           
                           
                              n
                           
                        
                      into 
                        
                           
                              P
                           
                           
                              m
                           
                        
                     . Depending on a particular norm defined on 
                        
                           
                              P
                           
                           
                              n
                           
                        
                     , various schemes for degree reduction were derived (Eck, 1993; Peters and Reif, 2000; Lee and Park, 1997; Kim and Moon, 1997; Brunnett et al., 1996; Ait-Haddou and Goldman, 2015).

An elegant resemblance between the 
                        
                           
                              L
                           
                           
                              2
                           
                        
                     -norm and the Euclidean norm acting on the vector of Bernstein coefficients was revealed by Lutterkort et al. (1999). They proved that the least squares approximation of Bézier coefficients provides the best polynomial degree reduction in the 
                        
                           
                              L
                           
                           
                              2
                           
                        
                     -norm. Two interesting generalizations of this result were achieved by Ahn et al. (2004) and by Ait-Haddou (submitted for publication). Ahn et al. (2004) showed that a weighted least squares approximation of Bézier coefficients provides the best constrained polynomial degree reduction in the 
                        
                           
                              L
                           
                           
                              2
                           
                        
                     -norm. By constrained we understand that the original polynomial and its reduced-degree approximation match at the boundaries up to a specific continuity order. Ait-Haddou (submitted for publication) shows that the weighted least squares approximation of Bézier coefficients with Hahn weights provides the best polynomial degree reduction with respect to the Jacobi 
                        
                           
                              L
                           
                           
                              2
                           
                        
                     -norm. In view of these two generalizations, it is natural to ask the following question:

(Q) – Is there an analogue to the result of 
                     
                        Lutterkort et al. (1999)
                      
                     for the constrained degree reduction with respect to the Jacobi 
                     
                        
                           
                              L
                           
                           
                              2
                           
                        
                     
                     -norm?
                  

The Jacobi 
                        
                           
                              L
                           
                           
                              2
                           
                        
                     -norm depends on two real parameters and a partial answer to the question (Q) is given in (Jianmin and Wang, 2003) for specific values of the parameters of the Jacobi 
                        
                           
                              L
                           
                           
                              2
                           
                        
                     -norm.

In the present work, we give an affirmative answer to question (Q); namely we show that there exists a weighted inner product on the Bézier coefficients for which the problem of constrained degree reduction with respect to the Jacobi 
                        
                           
                              L
                           
                           
                              2
                           
                        
                     -norm is equivalent to the problem of weighted least squares approximation of the Bézier coefficients.

Our methodology for answering question (Q) is very similar to Lutterkort et al. (1999) and its extension by Ahn et al. (2004). The main challenge lies in the construction of the adequate inner product of Bézier coefficients.

We note that a general solution to the problem of constrained degree reduction with respect to the Jacobi 
                        
                           
                              L
                           
                           
                              2
                           
                        
                     -norm is derived in (Woźny and Lewanowicz, 2009). Although their solution does not require matrix inversion, the derivation is rather complicated because it requires an explicit computation of the dual bases of the discrete Bernstein bases. Moreover, their methodology does not involve the approach taken in (Lutterkort et al., 1999) and (Ahn et al., 2004). In contrast, our solution, even though it requires the computation of a single Moore–Penrose inverse, is simple and fits to the framework of (Lutterkort et al., 1999; Ahn et al., 2004).

The rest of the paper is organized as follows. In section 2, we prove that the best constrained polynomial degree reduction with respect to the Jacobi 
                        
                           
                              L
                           
                           
                              2
                           
                        
                     -norm is equivalent to a weighted least squares approximation of Bézier coefficients with factored Hahn weights. We demonstrate how to compute the degree-reduced polynomials in Section 3, present several examples in Section 4, and finally conclude the paper in Section 5.

Denote by 
                        
                           
                              P
                           
                           
                              n
                           
                        
                      the linear space of polynomials of degree at most n and let 
                        
                           
                              B
                           
                           
                              n
                           
                        
                      be its Bernstein–Bézier (BB) basis and 
                        
                           
                              Q
                           
                           
                              n
                           
                        
                      be its Lagrange basis with respect to the nodes 
                        (
                        0
                        ,
                        1
                        ,
                        …
                        ,
                        n
                        )
                     , i.e.,
                        
                           
                              
                                 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             n
                                          
                                       
                                       :
                                       =
                                       [
                                       
                                          
                                             B
                                          
                                          
                                             0
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             n
                                          
                                          
                                             n
                                          
                                       
                                       ]
                                       ,
                                       
                                    
                                    
                                       where
                                       
                                    
                                    
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       t
                                       )
                                       =
                                       
                                          (
                                          
                                             
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   i
                                                
                                             
                                          
                                          )
                                       
                                       
                                          
                                             (
                                             1
                                             −
                                             t
                                             )
                                          
                                          
                                             n
                                             −
                                             i
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                       t
                                       ∈
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                       ,
                                       
                                       and
                                    
                                 
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             n
                                          
                                       
                                       :
                                       =
                                       [
                                       
                                          
                                             Q
                                          
                                          
                                             0
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             Q
                                          
                                          
                                             n
                                          
                                          
                                             n
                                          
                                       
                                       ]
                                       ,
                                       
                                    
                                    
                                       where
                                       
                                    
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             i
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       t
                                       )
                                       =
                                       
                                          ∏
                                          
                                             j
                                             =
                                             0
                                             ,
                                             j
                                             ≠
                                             i
                                          
                                          n
                                       
                                       
                                          
                                             t
                                             −
                                             j
                                          
                                          
                                             i
                                             −
                                             j
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        
                     
                  

Let 
                        
                           
                              P
                           
                           
                              m
                           
                        
                      be a subspace of 
                        
                           
                              P
                           
                           
                              n
                           
                        
                     , 
                        m
                        <
                        n
                      and let k and l be two non-negative integers such that 
                        k
                        +
                        l
                        ≤
                        m
                        +
                        1
                     , we define 
                        
                           
                              P
                           
                           
                              m
                           
                           
                              k
                              ,
                              l
                           
                        
                      as:
                        
                           
                              
                                 
                                    P
                                 
                                 
                                    m
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                              =
                              {
                              f
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    m
                                 
                              
                              :
                              
                                 
                                    f
                                 
                                 
                                    (
                                    i
                                    )
                                 
                              
                              (
                              0
                              )
                              =
                              0
                              ,
                              
                              i
                              =
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              k
                              −
                              1
                              ;
                              
                              
                                 
                                    f
                                 
                                 
                                    (
                                    j
                                    )
                                 
                              
                              (
                              1
                              )
                              =
                              0
                              ,
                              
                              j
                              =
                              0
                              ,
                              …
                              ,
                              l
                              −
                              1
                              }
                              .
                           
                        
                      That is, 
                        
                           
                              P
                           
                           
                              m
                           
                           
                              k
                              ,
                              l
                           
                        
                      is a linear space of polynomials of degree at most m with k vanishing derivatives at 
                        t
                        =
                        0
                      and l vanishing derivatives at 
                        t
                        =
                        1
                     . Moreover, we define
                        
                           
                              
                                 
                                    Q
                                 
                                 
                                    m
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                              =
                              {
                              f
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    m
                                 
                              
                              :
                              f
                              (
                              i
                              )
                              =
                              0
                              ,
                              
                              i
                              =
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              k
                              −
                              1
                              
                              and
                              
                              i
                              =
                              n
                              −
                              l
                              +
                              1
                              ,
                              …
                              ,
                              n
                              }
                              .
                           
                        
                      Let 
                        α
                        >
                        −
                        1
                      and 
                        β
                        >
                        −
                        1
                      be two real numbers and define the Jacobi inner product in 
                        
                           
                              P
                           
                           
                              n
                           
                        
                      by
                        
                           (1)
                           
                              
                                 <
                                 p
                                 ,
                                 q
                                 
                                    
                                       >
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    ∫
                                    0
                                    1
                                 
                                 
                                    
                                       t
                                    
                                    
                                       α
                                    
                                 
                                 
                                    
                                       (
                                       1
                                       −
                                       t
                                       )
                                    
                                    
                                       β
                                    
                                 
                                 p
                                 (
                                 t
                                 )
                                 q
                                 (
                                 t
                                 )
                                 d
                                 
                                 t
                                 .
                              
                           
                        
                     
                  

Considering the vectors of BB coefficients of p and q, 
                        p
                        =
                        
                           
                              [
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                              
                              ]
                           
                           
                              T
                           
                        
                      and 
                        q
                        =
                        
                           
                              [
                              
                                 
                                    q
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    q
                                 
                                 
                                    n
                                 
                              
                              ]
                           
                           
                              T
                           
                        
                     , respectively, we define the following weighted Euclidean inner product of the BB coefficients
                        
                           (2)
                           
                              
                                 <
                                 p
                                 ,
                                 q
                                 
                                    
                                       >
                                    
                                    
                                       
                                          
                                             E
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 <
                                 
                                    
                                       B
                                    
                                    
                                       n
                                    
                                 
                                 p
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       n
                                    
                                 
                                 q
                                 
                                    
                                       >
                                    
                                    
                                       
                                          
                                             E
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       k
                                    
                                    
                                       n
                                       −
                                       l
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                 
                                 ,
                              
                           
                        
                      with the weights
                        
                           (3)
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             
                                                i
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   i
                                                   −
                                                   k
                                                
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   n
                                                   −
                                                   i
                                                
                                             
                                             
                                                
                                                   n
                                                   −
                                                   i
                                                   −
                                                   l
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       (
                                       α
                                       +
                                       1
                                       )
                                    
                                    
                                       k
                                       +
                                       i
                                    
                                 
                                 
                                    
                                       (
                                       β
                                       +
                                       1
                                       )
                                    
                                    
                                       n
                                       −
                                       i
                                       +
                                       l
                                    
                                 
                                 ,
                              
                           
                        
                      where 
                        
                           
                              (
                              a
                              )
                           
                           
                              s
                           
                        
                        =
                        a
                        (
                        a
                        +
                        1
                        )
                        …
                        (
                        a
                        +
                        s
                        −
                        1
                        )
                      denotes the Pochhammer symbol with the convention that 
                        
                           
                              (
                              a
                              )
                           
                           
                              0
                           
                        
                        :
                        =
                        1
                     .


                     
                        Remark 1
                        The choice of the weights 
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                            in (3) is not arbitrary but follows a certain logic that combines the work of Ahn et al. (2004) and the work of Ait-Haddou (submitted for publication). First recall that Hahn orthogonal polynomials 
                              
                                 
                                    H
                                 
                                 
                                    i
                                 
                              
                           , 
                              i
                              =
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              n
                           , are orthogonal polynomials with respect to the Hahn inner product
                              
                                 (4)
                                 
                                    
                                       <
                                       p
                                       ,
                                       q
                                       
                                          
                                             >
                                          
                                          
                                             H
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             0
                                          
                                          n
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   i
                                                
                                             
                                          
                                          )
                                       
                                       
                                          
                                             (
                                             α
                                             +
                                             1
                                             )
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             (
                                             β
                                             +
                                             1
                                             )
                                          
                                          
                                             n
                                             −
                                             i
                                          
                                       
                                       p
                                       (
                                       i
                                       )
                                       q
                                       (
                                       i
                                       )
                                       .
                                    
                                 
                              
                            When 
                              k
                              =
                              l
                              =
                              0
                            (the unconstrained case) the weights 
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                            in (3) coincide with the Hahn weights 
                              
                                 (
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       
                                          i
                                       
                                    
                                 
                                 )
                              
                              
                                 
                                    (
                                    α
                                    +
                                    1
                                    )
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    (
                                    β
                                    +
                                    1
                                    )
                                 
                                 
                                    n
                                    −
                                    i
                                 
                              
                            given in (4). This is what is naturally expected from the results in (Ait-Haddou, submitted for publication). Moreover, in the constrained case, i.e, when 
                              k
                              ≠
                              0
                            or 
                              l
                              ≠
                              0
                           , and when 
                              α
                              =
                              β
                              =
                              0
                           , we recover from (3) the inner product given in (Ahn et al., 2004). The weights in (3) are essentially the Hahn weights in (4) multiplied by certain factors that depend on the order of the endpoint constraints.

We need the following lemma given in (Ahn et al., 2004). 
                        Lemma 1
                        
                           (See 
                           
                              Ahn et al., 2004
                           
                           .) A polynomial 
                           
                              
                                 
                                    B
                                 
                                 
                                    n
                                 
                              
                              p
                            
                           is of degree m, 
                           
                              m
                              ≤
                              n
                           
                           , with 
                           
                              p
                              (
                              i
                              )
                              =
                              0
                            
                           for 
                           
                              i
                              =
                              0
                              ,
                              …
                              ,
                              k
                              −
                              1
                            
                           and 
                           
                              i
                              =
                              n
                              −
                              l
                              +
                              1
                              ,
                              …
                              ,
                              n
                            
                           if and only if the vector of coefficients is a polynomial of degree m with zeros at 
                           
                              i
                              =
                              0
                              ,
                              …
                              ,
                              k
                              −
                              1
                            
                           and 
                           
                              i
                              =
                              n
                              −
                              l
                              +
                              1
                              ,
                              …
                              ,
                              n
                            
                           in its index, i.e.,
                           
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          n
                                       
                                    
                                    p
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          m
                                       
                                       
                                          k
                                          ,
                                          l
                                       
                                    
                                    ⇔
                                    
                                       
                                          Q
                                       
                                       
                                          n
                                       
                                    
                                    p
                                    ∈
                                    
                                       
                                          Q
                                       
                                       
                                          m
                                       
                                       
                                          k
                                          ,
                                          l
                                       
                                    
                                    .
                                 
                              
                           
                        

Now we are in a position to state the main result of this work. 
                        Theorem 1
                        
                           The orthogonal complements of 
                           
                              
                                 
                                    P
                                 
                                 
                                    m
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                            
                           in 
                           
                              
                                 
                                    P
                                 
                                 
                                    n
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                            
                           with respect to the Jacobi inner product 
                           
                              (1)
                            
                           and the weighted Euclidean inner product 
                           
                              (2)
                            
                           are equal.
                        


                     
                        Proof
                        Denote by 
                              
                                 
                                    P
                                 
                                 
                                    m
                                    ,
                                    n
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                            the orthogonal complement of 
                              
                                 
                                    P
                                 
                                 
                                    m
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                            in 
                              
                                 
                                    P
                                 
                                 
                                    n
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                            with respect to the Euclidean inner product (2). Let 
                              
                                 
                                    B
                                 
                                 
                                    n
                                 
                              
                              q
                            be an element of 
                              
                                 
                                    P
                                 
                                 
                                    m
                                    ,
                                    n
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                           . Thus we have
                              
                                 
                                    <
                                    
                                       
                                          B
                                       
                                       
                                          n
                                       
                                    
                                    q
                                    ,
                                    
                                       
                                          B
                                       
                                       
                                          n
                                       
                                    
                                    p
                                    
                                       
                                          >
                                       
                                       
                                          
                                             
                                                E
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    =
                                    0
                                 
                              
                            for any element 
                              
                                 
                                    B
                                 
                                 
                                    n
                                 
                              
                              p
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    m
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                           . Let s be an integer smaller or equal than 
                              m
                              −
                              k
                              −
                              l
                           . We have
                              
                                 
                                    <
                                    
                                       
                                          B
                                       
                                       
                                          n
                                       
                                    
                                    q
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          k
                                          +
                                          s
                                       
                                    
                                    
                                       
                                          (
                                          1
                                          −
                                          t
                                          )
                                       
                                       
                                          l
                                       
                                    
                                    
                                       
                                          >
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    =
                                    
                                       ∫
                                       0
                                       1
                                    
                                    
                                       
                                          t
                                       
                                       
                                          α
                                          +
                                          s
                                          +
                                          k
                                       
                                    
                                    
                                       
                                          (
                                          1
                                          −
                                          t
                                          )
                                       
                                       
                                          β
                                          +
                                          l
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          n
                                       
                                    
                                    q
                                    
                                    d
                                    
                                    t
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       n
                                    
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    
                                    
                                       ∫
                                       0
                                       1
                                    
                                    
                                       
                                          t
                                       
                                       
                                          α
                                          +
                                          s
                                          +
                                          k
                                       
                                    
                                    
                                       
                                          (
                                          1
                                          −
                                          t
                                          )
                                       
                                       
                                          β
                                          +
                                          l
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    t
                                    )
                                    
                                    d
                                    
                                    t
                                    .
                                 
                              
                            Therefore,
                              
                                 (5)
                                 
                                    
                                       <
                                       
                                          
                                             B
                                          
                                          
                                             n
                                          
                                       
                                       q
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             s
                                          
                                       
                                       
                                          
                                             (
                                             1
                                             −
                                             t
                                             )
                                          
                                          
                                             l
                                          
                                       
                                       
                                          
                                             >
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       =
                                       <
                                       
                                          
                                             B
                                          
                                          
                                             n
                                          
                                       
                                       q
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             n
                                          
                                       
                                       ϕ
                                       
                                          
                                             >
                                          
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                            where 
                              ϕ
                              =
                              [
                              
                                 
                                    ϕ
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    n
                                 
                              
                              ]
                            with
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      i
                                                      −
                                                      k
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      n
                                                      −
                                                      i
                                                   
                                                
                                                
                                                   
                                                      n
                                                      −
                                                      i
                                                      −
                                                      l
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   i
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       1
                                       
                                          
                                             
                                                (
                                                α
                                                +
                                                1
                                                )
                                             
                                             
                                                k
                                                +
                                                i
                                             
                                          
                                          
                                             
                                                (
                                                β
                                                +
                                                1
                                                )
                                             
                                             
                                                n
                                                −
                                                i
                                                +
                                                l
                                             
                                          
                                       
                                    
                                    
                                       ∫
                                       0
                                       1
                                    
                                    
                                       
                                          t
                                       
                                       
                                          α
                                          +
                                          s
                                          +
                                          k
                                       
                                    
                                    
                                       
                                          (
                                          1
                                          −
                                          t
                                          )
                                       
                                       
                                          β
                                          +
                                          l
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    t
                                    )
                                    
                                    d
                                    
                                    t
                                    .
                                 
                              
                            As 
                              
                                 
                                    B
                                 
                                 
                                    n
                                 
                              
                              q
                            is an element of 
                              
                                 
                                    P
                                 
                                 
                                    m
                                    ,
                                    n
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                            and by Lemma 1, the inner product (5) vanishes if and only if 
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                            is a polynomial in i of degree less or equal to m that vanishes at 
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              k
                              −
                              1
                            and at 
                              n
                              −
                              l
                              +
                              1
                              ,
                              …
                              ,
                              n
                           . We have
                              
                                 
                                    
                                       ∫
                                       0
                                       1
                                    
                                    
                                       
                                          t
                                       
                                       
                                          α
                                          +
                                          s
                                          +
                                          k
                                       
                                    
                                    
                                       
                                          (
                                          1
                                          −
                                          t
                                          )
                                       
                                       
                                          β
                                          +
                                          l
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    t
                                    )
                                    
                                    d
                                    
                                    t
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             
                                                i
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          Γ
                                          (
                                          α
                                          +
                                          s
                                          +
                                          k
                                          +
                                          i
                                          +
                                          1
                                          )
                                          Γ
                                          (
                                          β
                                          +
                                          l
                                          +
                                          n
                                          −
                                          i
                                          +
                                          1
                                          )
                                       
                                       
                                          Γ
                                          (
                                          α
                                          +
                                          β
                                          +
                                          s
                                          +
                                          k
                                          +
                                          l
                                          +
                                          n
                                          +
                                          2
                                          )
                                       
                                    
                                    ,
                                 
                              
                            where 
                              Γ
                              (
                              .
                              )
                            is the Gamma function. Thus
                              
                                 
                                    
                                       ∫
                                       0
                                       1
                                    
                                    
                                       
                                          t
                                       
                                       
                                          α
                                          +
                                          s
                                          +
                                          k
                                       
                                    
                                    
                                       
                                          (
                                          1
                                          −
                                          t
                                          )
                                       
                                       
                                          β
                                          +
                                          l
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    t
                                    )
                                    
                                    d
                                    
                                    t
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             
                                                i
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          Γ
                                          (
                                          α
                                          +
                                          1
                                          )
                                          Γ
                                          (
                                          β
                                          +
                                          1
                                          )
                                       
                                       
                                          Γ
                                          (
                                          α
                                          +
                                          β
                                          +
                                          2
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                (
                                                α
                                                +
                                                1
                                                )
                                             
                                             
                                                i
                                                +
                                                k
                                                +
                                                s
                                             
                                          
                                          
                                             
                                                (
                                                β
                                                +
                                                1
                                                )
                                             
                                             
                                                n
                                                −
                                                i
                                                +
                                                l
                                             
                                          
                                       
                                       
                                          
                                             (
                                             α
                                             +
                                             β
                                             +
                                             2
                                             )
                                          
                                          
                                             s
                                             +
                                             n
                                             +
                                             k
                                             +
                                             l
                                          
                                       
                                    
                                    .
                                 
                              
                            Therefore,
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          Γ
                                          (
                                          α
                                          +
                                          1
                                          )
                                          Γ
                                          (
                                          β
                                          +
                                          1
                                          )
                                       
                                       
                                          Γ
                                          (
                                          α
                                          +
                                          β
                                          +
                                          2
                                          )
                                       
                                    
                                    
                                       
                                          (
                                          α
                                          +
                                          i
                                          +
                                          1
                                          )
                                          (
                                          α
                                          +
                                          i
                                          +
                                          2
                                          )
                                          …
                                          (
                                          α
                                          +
                                          i
                                          +
                                          s
                                          )
                                       
                                       
                                          
                                             (
                                             α
                                             +
                                             β
                                             +
                                             2
                                             )
                                          
                                          
                                             s
                                             +
                                             n
                                             +
                                             k
                                             +
                                             l
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                i
                                             
                                          
                                          
                                             
                                                i
                                                −
                                                k
                                             
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             
                                                n
                                                −
                                                i
                                             
                                          
                                          
                                             
                                                n
                                                −
                                                i
                                                −
                                                l
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                            which shows that 
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                            is a polynomial of degree at most m in the variable i that vanishes at 
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              k
                              −
                              1
                            and at 
                              n
                              −
                              l
                              +
                              1
                              ,
                              …
                              ,
                              n
                           . Therefore, 
                              
                                 
                                    P
                                 
                                 
                                    m
                                    ,
                                    n
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                            is contained in the orthogonal complement of 
                              
                                 
                                    P
                                 
                                 
                                    m
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                            in 
                              
                                 
                                    P
                                 
                                 
                                    n
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                            with respect to the weighted Euclidean inner product (2). The fact of equal dimensions of both orthogonal complements completes the proof.  □

A consequence of Theorem 1 for the constrained degree reduction with respect to the Jacobi 
                        
                           
                              L
                           
                           
                              2
                           
                        
                     -norm is the following corollary; for which the proof goes along the same lines as the proof of Corollary 4.1 in (Ahn et al., 2004). 
                        Corollary 1
                        
                           Given a polynomial p of degree n, the approximation problem
                           
                              
                                 (6)
                                 
                                    
                                       
                                          min
                                          
                                             q
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                       ⁡
                                       {
                                       ‖
                                       p
                                       −
                                       q
                                       ‖
                                       :
                                       
                                          
                                             p
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                       (
                                       0
                                       )
                                       =
                                       
                                          
                                             q
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                       (
                                       0
                                       )
                                       
                                       
                                          for
                                       
                                       
                                       i
                                       =
                                       0
                                       ,
                                       …
                                       ,
                                       k
                                       −
                                       1
                                       ,
                                       
                                       
                                          and
                                       
                                       
                                          
                                             p
                                          
                                          
                                             (
                                             j
                                             )
                                          
                                       
                                       (
                                       1
                                       )
                                       =
                                       
                                          
                                             q
                                          
                                          
                                             (
                                             j
                                             )
                                          
                                       
                                       (
                                       1
                                       )
                                       
                                       
                                          for
                                       
                                       
                                       j
                                       =
                                       0
                                       ,
                                       …
                                       ,
                                       l
                                       −
                                       1
                                       }
                                    
                                 
                              
                            
                           has the same minimizer for the norm induced either by the Jacobi 
                           
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           
                           -inner product 
                           
                              (1)
                            
                           or the weighted Euclidean inner product 
                           
                              (2)
                           
                           .
                        


                     
                        Remark 2
                        The following factorization for the constrained degree reduction holds: Denote by 
                              
                                 
                                    P
                                 
                                 
                                    m
                                    ,
                                    n
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                            the linear operator that maps polynomials of degree n to their best constrained Jacobi 
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           -approximations; then we have 
                              
                                 
                                    P
                                 
                                 
                                    m
                                    ,
                                    n
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                              =
                              
                                 
                                    P
                                 
                                 
                                    m
                                    ,
                                    h
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    h
                                    ,
                                    n
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                            with 
                              m
                              ≤
                              h
                              ≤
                              n
                           . That is, reducing the degree sequentially by one from n to m gives the same result as projecting p directly from 
                              
                                 
                                    P
                                 
                                 
                                    n
                                 
                              
                            to 
                              
                                 
                                    P
                                 
                                 
                                    m
                                 
                              
                            while preserving the endpoint constraints.


                     
                        Remark 3
                        Our result is a generalization of both unconstrained and constrained 
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           -degree reduction schemes (Lutterkort et al., 1999; Ahn et al., 2004; Ait-Haddou, submitted for publication). For 
                              α
                              =
                              β
                              =
                              0
                           , we recover the results given in (Ahn et al., 2004) and if additionally 
                              k
                              =
                              l
                              =
                              0
                           , we obtain the results in (Lutterkort et al., 1999). For 
                              k
                              =
                              l
                              =
                              0
                            and α, β arbitrary, we recover the results given in (Ait-Haddou, submitted for publication).

We now introduce computational tools to solve the constrained polynomial degree reduction with respect to the Jacobi 
                        
                           
                              L
                           
                           
                              2
                           
                        
                     -norm. Apart from the expression of the weight matrices, that accommodates the expression of the inner product (2), the method is similar to the one given in (Ahn et al., 2004).

Denote by 
                        
                           
                              A
                           
                           
                              n
                              ,
                              m
                           
                        
                      the degree raising matrix that maps the BB coefficients q of a polynomial q of degree m to BB coefficients 
                        
                           
                              q
                           
                           ‾
                        
                        =
                        
                           
                              [
                              
                                 
                                    
                                       
                                          q
                                       
                                       ‾
                                    
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          q
                                       
                                       ‾
                                    
                                 
                                 
                                    n
                                 
                              
                              ]
                           
                           
                              T
                           
                        
                      when raised to degree n, i.e., 
                        
                           
                              q
                           
                           ‾
                        
                        =
                        
                           
                              A
                           
                           
                              n
                              ,
                              m
                           
                        
                        q
                     . The matrix 
                        
                           
                              A
                           
                           
                              n
                              ,
                              m
                           
                        
                      is of order 
                        (
                        n
                        +
                        1
                        )
                        ×
                        (
                        m
                        +
                        1
                        )
                      and can be decomposed into elementary degree raising matrices as 
                        
                           
                              A
                           
                           
                              n
                              ,
                              m
                           
                        
                        =
                        
                           
                              A
                           
                           
                              n
                              ,
                              n
                              −
                              1
                           
                        
                        
                           
                              A
                           
                           
                              n
                              −
                              1
                              ,
                              n
                              −
                              2
                           
                        
                        …
                        
                           
                              A
                           
                           
                              m
                              +
                              1
                              ,
                              m
                           
                        
                      where
                        
                           
                              
                                 
                                    A
                                 
                                 
                                    h
                                    ,
                                    h
                                    −
                                    1
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              =
                              
                                 {
                                 
                                    
                                       
                                          i
                                          /
                                          h
                                          
                                       
                                       
                                          if
                                          
                                       
                                       
                                          j
                                          =
                                          i
                                          −
                                          1
                                          ,
                                       
                                    
                                    
                                       
                                          1
                                          −
                                          i
                                          /
                                          h
                                          
                                       
                                       
                                          if
                                          
                                       
                                       
                                          j
                                          =
                                          i
                                          ,
                                       
                                    
                                    
                                       
                                          0
                                          
                                       
                                       
                                          
                                       
                                       
                                          else
                                          .
                                       
                                    
                                 
                              
                           
                        
                      Denote by W (resp. 
                        
                           W
                        
                     ) the diagonal 
                        (
                        n
                        +
                        1
                        )
                        ×
                        (
                        n
                        +
                        1
                        )
                      
                     weight matrix where the diagonal elements are the weights 
                        
                           
                              w
                           
                           
                              i
                           
                        
                      (resp. 
                        
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                        
                     ) from (3).

According to Corollary 1, the constrained degree reduction problem reduces to solving the least squares problem
                        
                           (7)
                           
                              
                                 
                                    min
                                    
                                       q
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             m
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 ⁡
                                 
                                    
                                       ‖
                                       p
                                       −
                                       
                                          
                                             A
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                       q
                                       ‖
                                    
                                    
                                       
                                          
                                             E
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                      with k boundary constraints at 
                        t
                        =
                        0
                      and l boundary constraints at 
                        t
                        =
                        1
                     . Imposing the boundary constraints equals expressing the first k (the last l) coefficients of q in terms of the first k (the last l) coefficients of p. This yields a 
                        (
                        k
                        ×
                        k
                        )
                      (an 
                        (
                        l
                        ×
                        l
                        )
                     ) linear system 
                        
                           
                              p
                           
                           
                              i
                           
                        
                        =
                        
                           
                              
                                 
                                    q
                                 
                                 ‾
                              
                           
                           
                              i
                           
                        
                     , 
                        i
                        =
                        0
                        ,
                        …
                        ,
                        k
                        −
                        1
                      (
                        
                           
                              p
                           
                           
                              i
                           
                        
                        =
                        
                           
                              
                                 
                                    q
                                 
                                 ‾
                              
                           
                           
                              i
                           
                        
                     , 
                        i
                        =
                        n
                        −
                        l
                        +
                        1
                        ,
                        …
                        ,
                        n
                     ) with the coefficients of the vector q as unknowns, see e.g. (Hoschek and Lasser, 1993). We denote by
                        
                           
                              
                                 
                                    q
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              
                                 
                                    [
                                    
                                       
                                          q
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          q
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    ,
                                    0
                                    ,
                                    …
                                    ,
                                    0
                                    ,
                                    
                                       
                                          q
                                       
                                       
                                          n
                                          −
                                          l
                                          +
                                          1
                                       
                                    
                                    ,
                                    …
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              ,
                              
                              
                                 
                                    q
                                 
                                 
                                    ˆ
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    m
                                    +
                                    1
                                 
                              
                              ,
                           
                        
                      the vector that contains the solutions of the two boundary linear systems. That is, there is 
                        m
                        +
                        1
                        −
                        k
                        −
                        l
                      coefficients of q that are not affected by the boundary constraints, we denote them by 
                        
                           
                              q
                           
                           
                              ˜
                           
                        
                        =
                        [
                        
                           
                              q
                           
                           
                              k
                           
                        
                        ,
                        …
                        ,
                        
                           
                              q
                           
                           
                              m
                              −
                              l
                           
                        
                        ]
                        ∈
                        
                           
                              R
                           
                           
                              m
                              +
                              1
                              −
                              k
                              −
                              l
                           
                        
                     . These coefficients are the free parameters for the least squares minimization described as follows.

Let 
                        
                           
                              W
                           
                           
                              n
                           
                           
                              k
                              ,
                              l
                           
                        
                      be a diagonal 
                        (
                        n
                        +
                        1
                        −
                        k
                        −
                        l
                        )
                      matrix obtained from 
                        
                           
                              W
                           
                           
                              n
                           
                        
                      by skipping the first k and the last l entries and define 
                        
                           
                              p
                           
                           
                              ˜
                           
                        
                      as
                        
                           
                              
                                 
                                    [
                                    
                                       
                                          
                                             0
                                             ,
                                             …
                                             ,
                                             0
                                          
                                          ︸
                                       
                                       k
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          ˜
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             0
                                             ,
                                             …
                                             ,
                                             0
                                          
                                          ︸
                                       
                                       l
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              =
                              p
                              −
                              
                                 
                                    A
                                 
                                 
                                    m
                                    ,
                                    n
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    ˆ
                                 
                              
                              .
                           
                        
                      Then the least squares problem (7) transforms to
                        
                           (8)
                           
                              
                                 
                                    min
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ˜
                                          
                                       
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             m
                                             +
                                             1
                                             −
                                             k
                                             −
                                             l
                                          
                                       
                                    
                                 
                                 ⁡
                                 
                                    
                                       ‖
                                       
                                          
                                             
                                                W
                                             
                                             
                                                n
                                             
                                             
                                                k
                                                ,
                                                l
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             ˜
                                          
                                       
                                       −
                                       
                                          
                                             
                                                W
                                             
                                             
                                                n
                                             
                                             
                                                k
                                                ,
                                                l
                                             
                                          
                                       
                                       
                                          
                                             A
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                          
                                             k
                                             ,
                                             l
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             ˜
                                          
                                       
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        
                      where 
                        
                           
                              A
                           
                           
                              n
                              ,
                              m
                           
                           
                              k
                              ,
                              l
                           
                        
                      is a submatrix of 
                        
                           
                              A
                           
                           
                              n
                              ,
                              m
                           
                        
                      obtained from 
                        
                           
                              A
                           
                           
                              n
                              ,
                              m
                           
                        
                      by skipping the first k and the last l rows and columns. Using Moore–Penrose inverse, the unique minimizer to (8) is
                        
                           (9)
                           
                              
                                 
                                    
                                       q
                                    
                                    
                                       ˜
                                    
                                 
                                 =
                                 
                                    
                                       M
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                    
                                       k
                                       ,
                                       l
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       ˜
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             (
                                             
                                                
                                                   A
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                                
                                                   k
                                                   ,
                                                   l
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             W
                                          
                                          
                                             n
                                          
                                          
                                             k
                                             ,
                                             l
                                          
                                       
                                       
                                          
                                             A
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                          
                                             k
                                             ,
                                             l
                                          
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                          
                                             k
                                             ,
                                             l
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       n
                                    
                                    
                                       k
                                       ,
                                       l
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       ˜
                                    
                                 
                                 .
                              
                           
                        
                     
                  


                     
                        Example 1
                        Consider degree reduction from 
                              n
                              =
                              6
                            to 
                              m
                              =
                              5
                            with the 
                              
                                 
                                    C
                                 
                                 
                                    0
                                 
                              
                            continuity constraint at 
                              t
                              =
                              0
                            and 
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                            continuity constraint at 
                              t
                              =
                              1
                           , i.e., 
                              k
                              =
                              1
                           , 
                              l
                              =
                              2
                           , see Fig. 1
                           . Then
                              
                                 
                                    p
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          m
                                          ,
                                          n
                                       
                                    
                                    q
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      5
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      6
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    −
                                    
                                       1
                                       6
                                    
                                    
                                       [
                                       
                                          
                                             
                                                6
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                1
                                                
                                             
                                             
                                                5
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                                
                                             
                                             
                                                2
                                                
                                             
                                             
                                                4
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                3
                                                
                                             
                                             
                                                3
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                4
                                                
                                             
                                             
                                                2
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                5
                                                
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                6
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      5
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    .
                                 
                              
                            The first k and the last l control points of q are determined by the boundary constraints. Incorporating them we obtain
                              
                                 
                                    p
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          m
                                          ,
                                          n
                                       
                                    
                                    q
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      5
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      6
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    −
                                    
                                       1
                                       6
                                    
                                    
                                       [
                                       
                                          
                                             
                                                6
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                1
                                                
                                             
                                             
                                                
                                                   5
                                                
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                                
                                             
                                             
                                                
                                                   2
                                                
                                                
                                             
                                             
                                                
                                                   4
                                                
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                             
                                             
                                                
                                                   3
                                                
                                                
                                             
                                             
                                                
                                                   3
                                                
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                             
                                             
                                                
                                                   4
                                                
                                                
                                             
                                             
                                                2
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                5
                                                
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                6
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   6
                                                   5
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      5
                                                   
                                                
                                                −
                                                
                                                   1
                                                   5
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      6
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      6
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    .
                                 
                              
                            Splitting q into boundary-determined and boundary-independent vectors,
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          ˆ
                                       
                                    
                                    =
                                    
                                       
                                          [
                                          
                                             
                                                p
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          0
                                          ,
                                          0
                                          ,
                                          0
                                          ,
                                          
                                             6
                                             5
                                          
                                          
                                             
                                                p
                                             
                                             
                                                5
                                             
                                          
                                          −
                                          
                                             1
                                             5
                                          
                                          
                                             
                                                p
                                             
                                             
                                                6
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                6
                                             
                                          
                                          ]
                                       
                                       
                                          T
                                       
                                    
                                    
                                    and
                                    
                                    
                                       
                                          q
                                       
                                       
                                          ˜
                                       
                                    
                                    =
                                    
                                       
                                          [
                                          
                                             
                                                q
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                q
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                q
                                             
                                             
                                                3
                                             
                                          
                                          ]
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                 
                              
                            and grouping the p-dependent terms together, the system reduces to
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ˜
                                       
                                    
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          m
                                          ,
                                          n
                                       
                                       
                                          k
                                          ,
                                          l
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          ˜
                                       
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   1
                                                   6
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      4
                                                   
                                                
                                                −
                                                
                                                   2
                                                   5
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      5
                                                   
                                                
                                                +
                                                
                                                   1
                                                   15
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      6
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    −
                                    
                                       1
                                       6
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   5
                                                
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                             
                                             
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                             
                                             
                                                
                                                   4
                                                
                                                
                                             
                                             
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                
                                                
                                             
                                             
                                                
                                                   3
                                                
                                                
                                             
                                             
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                             
                                             
                                                
                                                   4
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                 
                              
                            and (9) gives 
                              
                                 
                                    q
                                 
                                 
                                    ˜
                                 
                              
                           .

In this section, we show several numerical examples of constrained degree reduction. Fig. 2
                      shows the effect of the parameters α and β on the final approximant q. In this figure, p and q are both univariate polynomials (graphs). One can see that the shape of the degree-reduced curve changes considerably for various α and β and these Jacobi weights can be seen as two free shape parameters. Their influence on the degree-reduced curve can be interpreted as follows. For example, if 
                        α
                        ≪
                        β
                     , the final 
                        
                           
                              L
                           
                           
                              2
                           
                        
                      error is forced to be smaller in the neighbourhood of 
                        p
                        (
                        0
                        )
                      because the weight magnifies the 
                        
                           
                              L
                           
                           
                              2
                           
                        
                      error to be minimized, see (1). This results in a curve that is closely aligned to the initial curve closer to its startpoint 
                        p
                        (
                        0
                        )
                     .

Due to the two degrees of freedom, additional criteria on the quality of the fit can be considered. Fig. 2 shows the 
                        
                           
                              L
                           
                           
                              ∞
                           
                        
                      error between p and q and also the fairness energy defined as
                        
                           (10)
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       
                                          fair
                                       
                                    
                                 
                                 (
                                 q
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       ‖
                                       
                                          
                                             q
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       −
                                       2
                                       
                                          
                                             q
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             q
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                      which reflects the variation of the control points and consequently the fairness of the curve. It is difficult to estimate a-priori the optimal pair 
                        (
                        α
                        ,
                        β
                        )
                      that minimizes either 
                        
                           
                              L
                           
                           
                              ∞
                           
                        
                      or 
                        
                           
                              E
                           
                           
                              
                                 fair
                              
                           
                        
                     . However, since the minimization of (6) is achieved by (9) efficiently, one may explore the space of shape parameters to seek for an approximation that meets additional criteria, e.g. low 
                        
                           
                              L
                           
                           
                              ∞
                           
                        
                      and/or 
                        
                           
                              E
                           
                           
                              
                                 fair
                              
                           
                        
                     .

Curvature constrained degree reduction of planar Bézier curves is shown in Fig. 3
                     . The problem is reduced component-wise and, for the particular setting 
                        n
                        =
                        8
                     , 
                        m
                        =
                        6
                     , 
                        k
                        =
                        l
                        =
                        3
                     , the coordinates of a single free control point (green) are computed from (9). Observe the impact of 
                        (
                        α
                        ,
                        β
                        )
                      on the shape of the approximation.

An example of a 
                        
                           
                              C
                           
                           
                              1
                           
                        
                     -constrained degree reduction is shown in Fig. 4
                     . A planar curve is considered as a half-meridian of a surface of revolution and the two parameter family of the optimal approximations with respect to Jacobi 
                        
                           
                              L
                           
                           
                              2
                           
                        
                     -norm (1) is explored. Again, one can see how the weights α and β influence the shape by increasing (decreasing) the importance of the 
                        
                           
                              L
                           
                           
                              2
                           
                        
                      error in the vicinity of the corresponding endpoint.

@&#CONCLUSION@&#

We have derived an analogous result to Lutterkort et al. (1999) for solving the problem of multi-degree reduction of polynomials with boundary constraints with respect to Jacobi inner product. We have proved that the best constrained degree-reduced approximation is equal to the weighted least squares fit of the Bézier coefficients with factored Hahn weights. We have shown on several examples that the two additional parameters of the Jacobi 
                        
                           
                              L
                           
                           
                              2
                           
                        
                     -norm, when compared to the classical 
                        
                           
                              L
                           
                           
                              2
                           
                        
                      inner product, can serve as supplementary shape parameters for constrained degree reduction.

@&#REFERENCES@&#

