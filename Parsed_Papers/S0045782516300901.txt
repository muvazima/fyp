@&#MAIN-TITLE@&#Dual form of discontinuous deformation analysis

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The dual form of discontinuous deformation analysis, abbreviated as DDA-d, with the contact forces as the basic variables, is established.


                        
                        
                           
                           DDA-d does not need the virtual springs, the stiffness of which has strong influence on the computational results.


                        
                        
                           
                           An iterative algorithm for the finite-dimensional quasi-variational inequality in DDA-d, called the compatibility iteration, is designed.


                        
                        
                           
                           DDA-d is more accurate and robust than the classic discontinuous deformation analysis, and comparable in efficiency with DDA.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Discontinuous deformation analysis

Contact problems

Finite-dimensional variational inequalities

Open–close iteration

Projection–contraction algorithm

@&#ABSTRACT@&#


               
               
                  Discontinuous deformation analysis (DDA) is a numerical method for analyzing dynamic behaviors of an assemblage of distinct blocks, with the block displacements as the basic variables. The contact conditions are approximately satisfied by the open–close iteration, which needs to fix or remove repeatedly the virtual springs between blocks in contact. The results from DDA are strongly dependent upon stiffness of these virtual springs. Excessively hard or soft springs all incur numerical problems. This is believed to be the biggest obstacle to more extensive application of DDA. To avoid the introduction of virtual springs, huge efforts have been made with little progress related to low efficiency in solution. In this study, the contact forces, instead of the block displacements, are taken as the basic variables. Stemming from the equations of momentum conservation of each block, the block displacements can be expressed in terms of the contact forces acting on the block. From the contact conditions a finite-dimensional quasi-variational inequality is derived with the contact forces as the independent variables. On the basis of the projection–contraction algorithm for the standard finite-dimensional variational inequalities, an iteration algorithm, called the compatibility iteration, is designed for the quasi-variational inequality. The main processes can be highly parallelized with no need to assemble the global stiffness matrix. A number of numerical tests, including those very challenging, suggest that the proposed procedure has reached practical level in accuracy, robustness and efficiency, and the goal to abandon completely virtual springs has been reached.
               
            

6-dimensional generalized force vector, in Eq. (4)
                     


                        
                           6
                           ×
                           2
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                         matrix formed by all the local frames at block 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                        , Eq. (8)
                     


                        
                           6
                           ×
                           2
                         matrix of the 
                           j
                        th contact local frame at block 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                        , Eq. (9)
                     

cohesion at the 
                           k
                           
                              th
                           
                         contact, Eq. (33)
                     

incremental displacement vector of block 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                        , Eq. (1)
                     

time interval of a time step, Eq. (10)
                     

Young’s modulus, in all the examples


                        
                           6
                           ×
                           6
                         stiffness matrix of block 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                        , Eq. (7)
                     

tolerance of contact force vector 
                           
                              p
                           
                         in the compatibility iteration


                        
                           x
                         direction normal strain of block 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                        , Eq. (7)
                     


                        
                           y
                         direction normal strain of block 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                        , Eq. (1)
                     


                        
                           6
                           ×
                           2
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                         flexibility matrix, Eq. (15)
                     

6-dimensional flexibility vector, Eq. (16)
                     

vector-valued gap function, in Eq. (38)
                     

acceleration of gravity, in all the examples

a part of normal gap of the contact-pair formed by an edge of 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                         and a vertex of 
                           
                              
                                 Ω
                              
                              
                                 j
                              
                           
                        , in Eq. (24)
                     

a part of tangential slide of the contact-pair formed by an edge of 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                         and a vertex of 
                           
                              
                                 Ω
                              
                              
                                 j
                              
                           
                        , in Eq. (31)
                     

normal gap of the 
                           k
                           
                              th
                           
                         contact, Eq. (18)
                     

tangential slide of the 
                           k
                           
                              th
                           
                         contact, Eq. (27)
                     

shear strain component of block 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                        , Eq. (1)
                     


                        
                           6
                           ×
                           6
                         equivalent stiffness matrix of block 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                        , Eq. (12)
                     

allowable maximum displacement within a time step, in all the example

density of block, Eq. (6)
                     


                        
                           6
                           ×
                           6
                         mass matrix of block 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                        , Eq. (6)
                     

friction coefficient at the 
                           k
                           
                              th
                           
                         contact, Eq. (33)
                     

the number of contact-pairs within a time step, in Section  4
                     

unit normal vector of local frame 
                           
                              [
                              
                                 n
                              
                              ,
                              
                                 τ
                              
                              ]
                           
                         of a contact-pair


                        
                           2
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                        - and 
                           2
                           
                              
                                 n
                              
                              
                                 j
                              
                           
                        - and dimensional vectors in calculating normal gap 
                           
                              
                                 g
                              
                              
                                 k
                              
                              
                                 n
                              
                           
                         of the 
                           k
                           
                              th
                           
                         contact-pair, in Eq. (23)
                     

the number of contact-pairs at block 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                        , Eq. (5)
                     

Poisson’s ratio, in all the examples

region occupied by the 
                           i
                        th block

contact force vector, Eq. (35)
                     

normal contact force of the 
                           k
                           
                              th
                           
                         contact, Eq. (25)
                     

tangential contact force of the 
                           k
                           
                              th
                           
                         contact, Eq. (32)
                     

6-dimensional equivalent block force vector of block 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                        , Eq. (13)
                     

rotation angle of block 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                         around point 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        , Eq. (1)
                     


                        
                           2
                           ×
                           6
                         shape function matrix of block 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                        , Eq. (3)
                     

unit normal vector of local frame 
                           
                              [
                              
                                 n
                              
                              ,
                              
                                 τ
                              
                              ]
                           
                         of a contact-pair


                        
                           2
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                        - and 
                           2
                           
                              
                                 n
                              
                              
                                 j
                              
                           
                        - and dimensional vectors in calculating tangential slide 
                           
                              
                                 g
                              
                              
                                 k
                              
                              
                                 τ
                              
                           
                         of the 
                           k
                           
                              th
                           
                         contact-pair, in Eq. (30)
                     

shear strength corresponding to normal contact force 
                           
                              
                                 p
                              
                              
                                 k
                              
                              
                                 n
                              
                           
                        , in Eq. (33)
                     

velocity vector of block 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                         at the end of a time step, Eq. (17)
                     

velocity vector of block 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                         at the beginning of a time step, Eq. (17)
                     

coordinates of an arbitrary point in block 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                        , Eq. (2)
                     

coordinates of a reference point in block 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                        , Eq. (1)
                     

constraint for the contact forces, in Eq. (36)
                     

@&#INTRODUCTION@&#

Discontinuous Deformation Analysis (DDA, [1]) is a numerical method for rock engineers to study dynamical behaviors of an assemblage of distinct blocks, which takes block displacements as the basic variables.

DDA has been widely used in rock engineering, such as tunnel engineering  [2,3], slope engineering  [4], stability analysis of ancient masonry structures  [5], evaluation of seismic site response  [6], and the shape optimization of bucket elevators  [7], to name just a few.

Lin et al. introduced artificial joints and sub-blocks into big blocks to simulate fracture in the blocks  [8]. As a matter of fact, the simulation of rock fracture can be implemented in more sophisticated manners, such as meshless methods  [9–13].

To obtain a more accurate stress distribution, a higher order displacement mode was used to replace the first order displacement mode in the original DDA  [14]; and for the same purpose the finite element mesh was also adopted to partition DDA blocks  [15]. The continuous/discontinuous deformation analysis (CDDA) by Cai et al.  [16] can also be classified in this category, where the block displacements are approximated with higher degree polynomials. The nodal-based DDA by Bao and Zhao introduced the finite element mesh and the fracturing scheme into DDA to enhance accuracy in stress distribution and to simulate block fracturing  [17]. Coupling with fluid was studied in  [18] and  [19].

The three-dimensional DDA has been paid considerable attention  [3,20–23]. The biggest obstacle to thwart 3D DDA is the detection of contacts. Recently, Shi published his new contact theory  [24], which is expected to facilitate significantly the contact treatment.

In DDA, the contact state between blocks is determined by repeatedly fixing and removing normal and tangential springs between blocks in contact. This process is referred to as the open–close iteration, which allows for penetration between blocks in contact. The stiffness of contact springs affects the results exceedingly. To avoid the contact springs or to mitigate the dependency on stiffness of contact springs, the augmented Lagrange multiplier method  [8] and the Lagrange multiplier method  [25] were tested. But the open–close iteration is still needed to reach the correct contact state, which is not always convergent. Furthermore, the Lagrange multiplier method would break down due to rank deficiency of the Jacobian matrix, which might be caused by redundant contact-pairs or too many inactive constraints activated.

To avoid the contact springs, more advanced tools have been applied and more sophisticated models have been built, including the complementarity theory  [26–28], and variational inequality theory  [29]. All these formulations took the contact forces as well as the block displacements as the independent variables, nearly doubling the number of basic variables of DDA. All these formulations were reduced to the solution of a system of non-smooth equations, which involves inversing the Jacobian matrix. Since the DDA code might generate some redundant contact-pairs, which leads to rank deficiency of the Jacobi matrix, the steepest descent procedure had to be invoked in such a case. Whenever this happened, the solution would become very inefficient, as was pointed out in  [28].

In this study, only the contact forces are taken as the basic variables, which is why the proposed procedure is called the dual form of DDA, denoted by DDA-d, and hence the number of the basic variables in DDA-d is far less than those in  [26–29]. Since in DDA-d the block displacements can be expressed in terms of the contact forces, and accordingly can be obtained accurately once the contact forces are solved.

From the perspective of calculus of variations, the classic DDA, taking block displacements as the basic variables, is actually the primal form. The contact forces in DDA are approximated by multiplying the relative displacements between blocks in contact by stiffness of the virtual springs.

This study is organized as follows.

In Section  2, from the equations of momentum conservation of a block, we derive the displacements of the block in terms of the contact forces acting on it. To each contact-pair, Section  3 firstly establishes the relationship between the contact force and the relative movement; then the two variational inequalities are built to represent the normal and tangential contact conditions, respectively. In Section  4, by collecting the variational inequalities of all the contact-pairs, a finite-dimensional quasi-variational inequality is derived, with the contact forces as the independent variables and the constraint set dependent on the solution. Section  5 describes the solution process of a time step, in which the main sub-processes can be highly parallelized, with no need to assemble the global stiffness matrix. In Section  6, firstly the solution of the quasi-variational inequality posed in Section  4, called the compatibility iteration, is analyzed; and then two functions that are repeatedly invoked in the compatibility iteration are expounded. In Section  7, some typical examples are used to test the proposed procedure in comparison with DDA. Section  8 concludes this study. Some details related to the solution algorithms are put in three appendices to avoid unnecessary distractions.

In this section, to a typical block 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                      the relationship between its displacement and the contact force acting on it will be derived.

For simplicity, the displacement mode in this study is the same as the classic DDA, reading 
                        
                           (1)
                           
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                             
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                             
                                             
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                             
                                             
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                             
                                             
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      x
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              ,
                           
                        
                      where all the components of 
                        
                           
                              
                                 d
                              
                           
                           
                              i
                           
                        
                      are increments; 
                        
                           
                              u
                           
                           
                              0
                           
                           
                              i
                           
                        
                      and 
                        
                           
                              v
                           
                           
                              0
                           
                           
                              i
                           
                        
                      represent the translational displacements of 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                      in the horizontal and vertical direction, respectively; 
                        
                           
                              r
                           
                           
                              0
                           
                           
                              i
                           
                        
                      is the rotation angle of 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                      around a reference point 
                        
                           (
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 0
                              
                           
                           )
                        
                      in 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                     ; 
                        
                           
                              ε
                           
                           
                              x
                           
                           
                              i
                           
                        
                     , 
                        
                           
                              ε
                           
                           
                              y
                           
                           
                              i
                           
                        
                     , 
                        
                           
                              γ
                           
                           
                              x
                              y
                           
                           
                              i
                           
                        
                      represent the small deformation based average strain components of 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                     .

Under the assumption of small deformation and small rotation, the incremental displacement vector 
                        
                           
                              
                                 u
                              
                           
                           
                              i
                           
                        
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      at point 
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      in 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                      can be expressed as 
                        
                           (2)
                           
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                              =
                              
                                 
                                    
                                       T
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                           
                        
                      in terms of 
                        
                           
                              
                                 d
                              
                           
                           
                              i
                           
                        
                     , with the 
                        2
                        ×
                        6
                      shape function matrix 
                        
                           (3)
                           
                              
                                 
                                    
                                       T
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          1
                                       
                                       
                                          0
                                       
                                       
                                          −
                                          
                                             (
                                             y
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                       
                                          0
                                       
                                       
                                          
                                             (
                                             y
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                          /
                                          2
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          1
                                       
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                       
                                          0
                                       
                                       
                                          
                                             (
                                             y
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                          /
                                          2
                                       
                                    
                                 
                                 )
                              
                              .
                           
                        
                     
                  

In DDA, all types of contact are actually reduced to the contact between a vertex 
                        V
                      of block 
                        
                           
                              Ω
                           
                           
                              s
                           
                        
                      and an edge 
                        E
                      of another block 
                        
                           
                              Ω
                           
                           
                              m
                           
                        
                     , as shown in Fig. 1
                     . Here, a vertex is actually a convex angle. The vertex 
                        V
                      and the edge 
                        E
                      compose a contact-pair, denoted by 
                        E
                     –
                        V
                     . 
                        
                           
                              V
                           
                           
                              ′
                           
                        
                      is the projection of 
                        V
                      onto the edge 
                        E
                     . In the contact-pair 
                        E
                     –
                        V
                     , a local frame 
                        
                           [
                           
                              n
                           
                           ,
                           
                              τ
                           
                           ]
                        
                      is fixed, where 
                        
                           n
                        
                      is the unit vector normal to edge 
                        E
                      and pointing to the inside of 
                        
                           
                              Ω
                           
                           
                              m
                           
                        
                     ; 
                        
                           τ
                        
                      is the unit anticlockwise tangential vector of 
                        
                           
                              Ω
                           
                           
                              m
                           
                        
                     . The forces on the edge 
                        E
                      exerted by vertex 
                        V
                      of block 
                        
                           
                              Ω
                           
                           
                              s
                           
                        
                      are referred to as the contact forces, including the normal force 
                        
                           
                              p
                           
                           
                              n
                           
                        
                        
                           n
                        
                      and the tangential force 
                        
                           
                              p
                           
                           
                              τ
                           
                        
                        
                           τ
                        
                     .

Clearly, block 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                      might be acted by the contact force 
                        
                           (
                           
                              
                                 p
                              
                              
                                 m
                              
                              
                                 n
                              
                           
                           
                              
                                 
                                    n
                                 
                              
                              
                                 m
                              
                           
                           ,
                           
                              
                                 p
                              
                              
                                 m
                              
                              
                                 τ
                              
                           
                           
                              
                                 
                                    τ
                                 
                              
                              
                                 m
                              
                           
                           )
                        
                      on some edge, and by the contact force 
                        
                           (
                           
                              
                                 −
                                 p
                              
                              
                                 s
                              
                              
                                 n
                              
                           
                           
                              
                                 
                                    n
                                 
                              
                              
                                 s
                              
                           
                           ,
                           
                              
                                 −
                                 p
                              
                              
                                 s
                              
                              
                                 τ
                              
                           
                           
                              
                                 
                                    τ
                                 
                              
                              
                                 s
                              
                           
                           )
                        
                      at some vertex, where 
                        
                           [
                           
                              
                                 
                                    n
                                 
                              
                              
                                 s
                              
                           
                           ,
                           
                              
                                 
                                    τ
                                 
                              
                              
                                 s
                              
                           
                           ]
                        
                      is the local frame of the contact-pair containing the vertex. Fig. 2
                      illustrates such a case.

From the weak form of momentum conservation of a block 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                     , we have its discrete form as 
                        
                           (4)
                           
                              
                                 
                                    
                                       M
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             d
                                          
                                       
                                       
                                          ̈
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    
                                       E
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    i
                                 
                              
                              −
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       b
                                    
                                 
                                 
                                    i
                                 
                              
                              .
                           
                        
                      Here, 
                        
                           
                              
                                 b
                              
                           
                           
                              i
                           
                        
                      is the 6-dimensional generalized force vector dual to the generalized displacement vector 
                        
                           
                              
                                 d
                              
                           
                           
                              i
                           
                        
                     , calculated as in  [1]. 
                        
                           
                              
                                 p
                              
                           
                           
                              i
                           
                        
                      is the contact force vector consisting of the 
                        2
                        
                           
                              n
                           
                           
                              i
                           
                        
                      contact force components from the 
                        
                           
                              n
                           
                           
                              i
                           
                        
                      contact-pairs on 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                     , written as 
                        
                           (5)
                           
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             1
                                          
                                          
                                             τ
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             τ
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              .
                           
                        
                     
                     
                        
                           
                              
                                 M
                              
                           
                           
                              i
                           
                        
                      is the 
                        6
                        ×
                        6
                      mass matrix, 
                        
                           (6)
                           
                              
                                 
                                    
                                       M
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    ρ
                                 
                                 
                                    ̄
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    
                                       
                                          Ω
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       T
                                    
                                 
                                 
                                    i
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    
                                       T
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 d
                              
                              Ω
                              ;
                           
                        
                     
                     
                        
                           
                              
                                 E
                              
                           
                           
                              i
                           
                        
                      is the 6×6 stiffness matrix, 
                        
                           (7)
                           
                              
                                 
                                    
                                       E
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                
                                             
                                             
                                                3
                                                ×
                                                3
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   0
                                                
                                             
                                             
                                                3
                                                ×
                                                3
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                
                                             
                                             
                                                3
                                                ×
                                                3
                                             
                                          
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   D
                                                
                                             
                                             
                                                3
                                                ×
                                                3
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                              ,
                           
                        
                      with 
                        
                           
                              S
                           
                           
                              i
                           
                        
                        =
                      area of 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                      and 
                        
                           D
                        
                        =
                        3
                        ×
                        3
                      elastic matrix; 
                        
                           
                              
                                 C
                              
                           
                           
                              i
                           
                        
                      in Eq. (4) is the 
                        6
                        ×
                        2
                        
                           
                              n
                           
                           
                              i
                           
                        
                      matrix defined as 
                        
                           (8)
                           
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       i
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       i
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 ]
                              
                              ,
                           
                        
                      where each 
                        
                           
                              
                                 C
                              
                           
                           
                              i
                           
                           
                              j
                           
                        
                      is the 
                        6
                        ×
                        2
                      matrix associated with the 
                        j
                     th contact-pair 
                        
                           
                              E
                           
                           
                              j
                           
                        
                     –
                        
                           
                              V
                           
                           
                              j
                           
                        
                      of 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                     , reading 
                        
                           (9)
                           
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    i
                                 
                                 
                                    j
                                 
                              
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          j
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    i
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                              
                                 [
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          τ
                                       
                                    
                                    
                                       j
                                    
                                 
                                 ]
                              
                              ,
                           
                        
                      for the contact-pair index 
                        j
                        =
                        1
                        ,
                        …
                        ,
                        
                           
                              n
                           
                           
                              i
                           
                        
                     . Here, 
                        
                           [
                           
                              
                                 
                                    n
                                 
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 
                                    τ
                                 
                              
                              
                                 j
                              
                           
                           ]
                        
                      is the local frame of the 
                        j
                        
                           th
                        
                      contact-pair. 
                        
                           (
                           
                              
                                 x
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 j
                              
                           
                           )
                        
                      is the coordinate of the contact point of 
                        
                           
                              E
                           
                           
                              j
                           
                        
                        −
                        
                           
                              V
                           
                           
                              j
                           
                        
                     . If edge 
                        
                           
                              E
                           
                           
                              j
                           
                        
                      belongs to 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                     , the contact point is the projection 
                        
                           
                              V
                           
                           
                              j
                           
                           
                              ′
                           
                        
                      of 
                        
                           
                              V
                           
                           
                              j
                           
                        
                      on 
                        
                           
                              E
                           
                           
                              j
                           
                        
                      and 
                        
                           
                              s
                           
                           
                              j
                           
                        
                      equals 1; if vertex 
                        
                           
                              V
                           
                           
                              j
                           
                        
                      belongs to 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                     , the contact point is vertex 
                        
                           
                              V
                           
                           
                              j
                           
                        
                      and 
                        
                           
                              s
                           
                           
                              j
                           
                        
                      equals 
                        −
                        1
                     .

The derivation of Eq. (4) is based on the assumption that 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                      is elastic, with details in  [27]. More sophisticated constitutive laws for blocks, such as  [30], should be implemented without essential difficulties. In this study, however, contact nonlinearity is our major concern.

The time integration is still conducted as in the original DDA, namely, 
                        
                           (10)
                           
                              
                                 
                                    
                                       
                                          
                                             d
                                          
                                       
                                       
                                          ̈
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    2
                                 
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    i
                                 
                              
                              −
                              
                                 
                                    2
                                 
                                 
                                    Δ
                                 
                              
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    0
                                 
                                 
                                    i
                                 
                              
                              ,
                           
                        
                      where 
                        Δ
                      is the time length of this time step; 
                        
                           
                              
                                 v
                              
                           
                           
                              0
                           
                           
                              i
                           
                        
                      is the velocity vector of 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                      at the beginning of this time step.

Substituting Eq. (10) into Eq. (4), we have 
                        
                           (11)
                           
                              
                                 
                                    
                                       K
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    i
                                 
                              
                              −
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    i
                                 
                              
                              .
                           
                        
                      Here, 
                        
                           
                              
                                 K
                              
                           
                           
                              i
                           
                        
                      is the 
                        6
                        ×
                        6
                      equivalent block stiffness matrix, defined as 
                        
                           (12)
                           
                              
                                 
                                    
                                       K
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    2
                                 
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       M
                                    
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    
                                       E
                                    
                                 
                                 
                                    i
                                 
                              
                              ;
                           
                        
                     
                     
                        
                           
                              
                                 q
                              
                           
                           
                              i
                           
                        
                      is the 6-dimensional equivalent block force vector, defined as 
                        
                           (13)
                           
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    2
                                 
                                 
                                    Δ
                                 
                              
                              
                                 
                                    
                                       M
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    0
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    
                                       b
                                    
                                 
                                 
                                    i
                                 
                              
                              .
                           
                        
                      Since 
                        
                           
                              
                                 K
                              
                           
                           
                              i
                           
                        
                      is invertible  [28], by premultiplying Eq. (11) with 
                        
                           
                              
                                 K
                              
                           
                           
                              i
                           
                           
                              −
                              1
                           
                        
                     , we can express 
                        
                           
                              
                                 d
                              
                           
                           
                              i
                           
                        
                      as, 
                        
                           (14)
                           
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       F
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    
                                       f
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                           
                        
                      in terms of the contact force vector 
                        
                           
                              
                                 p
                              
                           
                           
                              i
                           
                        
                      of 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                     , where 
                        
                           
                              
                                 F
                              
                           
                           
                              i
                           
                        
                      is the 
                        6
                        ×
                        2
                        
                           
                              n
                           
                           
                              i
                           
                        
                      flexibility matrix 
                        
                           (15)
                           
                              
                                 
                                    
                                       F
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       K
                                    
                                 
                                 
                                    i
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                           
                        
                      and 
                        
                           
                              
                                 f
                              
                           
                           
                              i
                           
                        
                      is the 6-dimensional vector, called the flexibility vector, 
                        
                           (16)
                           
                              
                                 
                                    
                                       f
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       K
                                    
                                 
                                 
                                    i
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    i
                                 
                              
                              .
                           
                        
                      Both 
                        
                           
                              
                                 F
                              
                           
                           
                              i
                           
                        
                      and 
                        
                           
                              
                                 f
                              
                           
                           
                              i
                           
                        
                      keep invariant within this time step.

Having obtained the displacement vector 
                        
                           
                              
                                 d
                              
                           
                           
                              i
                           
                        
                      of 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                     , we have the velocity vector 
                        
                           
                              
                                 v
                              
                           
                           
                              i
                           
                        
                      of 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                      at the end of this time step, namely 
                        
                           (17)
                           
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    0
                                 
                                 
                                    i
                                 
                              
                              +
                              Δ
                              
                                 
                                    
                                       
                                          
                                             d
                                          
                                       
                                       
                                          ̈
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           
                              
                                 v
                              
                           
                           
                              i
                           
                        
                      will be deemed the initial velocity vector 
                        
                           
                              
                                 v
                              
                           
                           
                              0
                           
                           
                              i
                           
                        
                      at the next time step.

At the beginning of each time step, all the contact-pairs are first detected, which can be conducted by the conventional DDA code. In this section, we will derive the contact conditions that a contact-pair must follow at the end of a time step.

In the following deduction, we will take the 
                        k
                        
                           th
                        
                      contact-pair 
                        
                           
                              E
                           
                           
                              k
                           
                        
                     –
                        
                           
                              V
                           
                           
                              k
                           
                        
                      as an instance, with edge 
                        
                           
                              E
                           
                           
                              k
                           
                        
                      belonging to block 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                      and vertex 
                        
                           
                              V
                           
                           
                              k
                           
                        
                      to block 
                        
                           
                              Ω
                           
                           
                              j
                           
                        
                     , and 
                        
                           [
                           
                              
                                 
                                    n
                                 
                              
                              
                                 k
                              
                           
                           
                              
                                 
                                    τ
                                 
                              
                              
                                 k
                              
                           
                           ]
                        
                      as the local frame, as shown in Fig. 3
                     .

At the end of a time step, the normal gap 
                           
                              
                                 g
                              
                              
                                 k
                              
                              
                                 n
                              
                           
                         of contact-pair 
                           
                              
                                 E
                              
                              
                                 k
                              
                           
                        –
                           
                              
                                 V
                              
                              
                                 k
                              
                           
                         is the projection of the vector 
                           
                              
                                 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             k
                                          
                                       
                                       V
                                    
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                              
                              
                                 ⃗
                              
                           
                         onto 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 k
                              
                           
                        , namely, 
                           
                              (18)
                              
                                 
                                    
                                       g
                                    
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       k
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 j
                              
                           
                         are the respective position vectors of 
                           
                              
                                 V
                              
                              
                                 k
                              
                              
                                 ′
                              
                           
                         and 
                           
                              
                                 V
                              
                              
                                 k
                              
                           
                         at the end of this time step, reading 
                           
                              
                                 (19)
                                 
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          
                                             T
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             d
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                 
                              
                              
                                 (20)
                                 
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          j
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          
                                             T
                                          
                                       
                                       
                                          j
                                       
                                    
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             j
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             d
                                          
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                 
                              
                           
                         with 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                              
                                 0
                              
                           
                         the position vector of 
                           
                              
                                 V
                              
                              
                                 k
                              
                              
                                 ′
                              
                           
                         at the start of this time step and, 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 j
                              
                              
                                 0
                              
                           
                         the position vector of 
                           
                              
                                 V
                              
                              
                                 k
                              
                           
                         at the start of this time step.

By expressing 
                           
                              
                                 
                                    d
                                 
                              
                              
                                 i
                              
                           
                         in Eq. (19) and 
                           
                              
                                 
                                    d
                                 
                              
                              
                                 j
                              
                           
                         in Eq. (20) in terms of 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 j
                              
                           
                         respectively, and then substituting them back to Eq. (18), we have the normal gap 
                           
                              (21)
                              
                                 
                                    
                                       g
                                    
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       n
                                    
                                 
                                 +
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       n
                                    
                                 
                                 ,
                              
                           
                         in terms of independent variables 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                         (the contact force vector of 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                        ) and 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 j
                              
                           
                         (the contact force vector of 
                           
                              
                                 Ω
                              
                              
                                 j
                              
                           
                        ), with 
                           
                              
                                 (22)
                                 
                                    
                                       
                                          p
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          k
                                          i
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          k
                                          j
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                 
                              
                              
                                 (23)
                                 
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          k
                                          i
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          k
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          
                                             F
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          k
                                          j
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          k
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          
                                             F
                                          
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                 
                              
                              
                                 (24)
                                 
                                    
                                       
                                          g
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          k
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             j
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             
                                                T
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                f
                                             
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             
                                                T
                                             
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             
                                                f
                                             
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                         Here, 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 k
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 k
                                 j
                              
                           
                         are 
                           2
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                        - and 
                           2
                           
                              
                                 n
                              
                              
                                 j
                              
                           
                        -dimensional vectors, respectively; 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 j
                              
                           
                         are the flexibility matrices, 
                           
                              
                                 
                                    f
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    f
                                 
                              
                              
                                 j
                              
                           
                         are the flexibility vectors of 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 Ω
                              
                              
                                 j
                              
                           
                        , with definitions in Eqs. (15) and (16), respectively.

The constraints of neither overlapping nor tensile give rise to the complementarity condition 
                           
                              (25)
                              
                                 
                                    
                                       g
                                    
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 ≥
                                 0
                                 ,
                                 
                                 
                                    
                                       p
                                    
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 ≥
                                 0
                                 ,
                                 
                                 and
                                 
                                 
                                    
                                       g
                                    
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                        
                     

The complementarity condition is equivalent to the variational inequality, denoted by VI-
                           n
                           
                              (
                              k
                              )
                           
                        : find 
                           
                              
                                 p
                              
                              
                                 k
                              
                              
                                 n
                              
                           
                           ≥
                           0
                        , such that 
                           
                              (26)
                              
                                 
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          k
                                       
                                       
                                          n
                                       
                                    
                                    −
                                    
                                       
                                          p
                                       
                                       
                                          k
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                                 
                                    
                                       g
                                    
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 ≥
                                 0
                                 ,
                                 
                                 ∀
                                 
                                    
                                       q
                                    
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 ≥
                                 0
                                 .
                              
                           
                         Here, 
                           
                              
                                 g
                              
                              
                                 k
                              
                              
                                 n
                              
                           
                         is deemed the function of 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 j
                              
                           
                         with the definition in Eq. (21).

As an aside, the complementarity theory and algorithm have been extensively applied to the solution of engineering problems. For example, Areias et al. [30] derived a nonlinearity complementarity problem from the extrinsic plastic cohesive law combined with the discrete version of equilibrium form.

At the end of this time step, the tangential slide 
                           
                              
                                 g
                              
                              
                                 k
                              
                              
                                 τ
                              
                           
                         of contact-pair 
                           
                              
                                 E
                              
                              
                                 k
                              
                           
                        –
                           
                              
                                 V
                              
                              
                                 k
                              
                           
                         is defined as the movement of 
                           
                              
                                 V
                              
                              
                                 k
                              
                              
                                 ′
                              
                           
                         relative to 
                           
                              
                                 V
                              
                              
                                 k
                              
                           
                         along edge 
                           
                              
                                 E
                              
                              
                                 k
                              
                           
                        , namely, 
                           
                              (27)
                              
                                 
                                    
                                       g
                                    
                                    
                                       k
                                    
                                    
                                       τ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          τ
                                       
                                    
                                    
                                       k
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Substitution of Eqs. (19) and (20) into (27) yields the expression of 
                           
                              
                                 g
                              
                              
                                 k
                              
                              
                                 τ
                              
                           
                         as 
                           
                              (28)
                              
                                 
                                    
                                       g
                                    
                                    
                                       k
                                    
                                    
                                       τ
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       τ
                                    
                                 
                                 +
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       τ
                                    
                                 
                                 ,
                              
                           
                         in terms of the contact force vector 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                         of 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                         and the contact force vector 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 j
                              
                           
                         of 
                           
                              
                                 Ω
                              
                              
                                 j
                              
                           
                        , with 
                           
                              
                                 (29)
                                 
                                    
                                       
                                          p
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          τ
                                       
                                    
                                    =
                                    
                                       
                                          
                                             τ
                                          
                                       
                                       
                                          k
                                          i
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          
                                             τ
                                          
                                       
                                       
                                          k
                                          j
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                 
                              
                              
                                 (30)
                                 
                                    
                                       
                                          
                                             τ
                                          
                                       
                                       
                                          k
                                          i
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             τ
                                          
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          
                                             F
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          τ
                                       
                                       
                                          k
                                          j
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             τ
                                          
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          
                                             F
                                          
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                 
                              
                              
                                 (31)
                                 
                                    
                                       
                                          g
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          τ
                                       
                                    
                                    =
                                    
                                       
                                          
                                             τ
                                          
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                T
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                f
                                             
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             
                                                T
                                             
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             
                                                f
                                             
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                         Here, 
                           
                              
                                 
                                    τ
                                 
                              
                              
                                 k
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    τ
                                 
                              
                              
                                 k
                                 j
                              
                           
                         are 
                           2
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                        - and 
                           2
                           
                              
                                 n
                              
                              
                                 j
                              
                           
                        -dimensional vectors, respectively.

The Coulomb friction law followed in this study leads to the following condition 
                           
                              (32)
                              
                                 
                                    
                                       g
                                    
                                    
                                       k
                                    
                                    
                                       τ
                                    
                                 
                                 
                                    {
                                    
                                       
                                          
                                             ≥
                                             0
                                             ,
                                          
                                          
                                             if  
                                             
                                                
                                                   p
                                                
                                                
                                                   k
                                                
                                                
                                                   τ
                                                
                                             
                                             =
                                             −
                                             τ
                                             
                                                (
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      n
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             =
                                             0
                                             ,
                                          
                                          
                                             if  
                                             
                                                |
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      τ
                                                   
                                                
                                                |
                                             
                                             <
                                             τ
                                             
                                                (
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      n
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             ≤
                                             0
                                             ,
                                          
                                          
                                             if  
                                             
                                                
                                                   p
                                                
                                                
                                                   k
                                                
                                                
                                                   τ
                                                
                                             
                                             =
                                             τ
                                             
                                                (
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      n
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         That is to say, 
                           
                              
                                 g
                              
                              
                                 k
                              
                              
                                 τ
                              
                           
                         and 
                           
                              
                                 p
                              
                              
                                 k
                              
                              
                                 τ
                              
                           
                         have the relationship as in Fig. 4
                        . Here, the tangential slide 
                           
                              
                                 g
                              
                              
                                 k
                              
                              
                                 τ
                              
                           
                         is deemed the function of 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 j
                              
                           
                        , defined in Eq. (28), and 
                           τ
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    k
                                 
                                 
                                    n
                                 
                              
                              )
                           
                         is the shear strength corresponding to the normal force 
                           
                              
                                 p
                              
                              
                                 k
                              
                              
                                 n
                              
                           
                        , reading 
                           
                              (33)
                              
                                 τ
                                 
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          k
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 ,
                              
                           
                         with 
                           
                              
                                 μ
                              
                              
                                 k
                              
                           
                           =
                           
                              friction
                           
                         factor, 
                           
                              
                                 c
                              
                              
                                 k
                              
                           
                           =
                           
                              inner
                           
                         cohesion.

Again, the relationship (32) is equivalent to the quasi-variational inequality, denoted by QVI-
                           τ
                           
                              (
                              k
                              )
                           
                        : find 
                           
                              |
                              
                                 
                                    p
                                 
                                 
                                    k
                                 
                                 
                                    τ
                                 
                              
                              |
                           
                           ≤
                           τ
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    k
                                 
                                 
                                    n
                                 
                              
                              )
                           
                         such that 
                           
                              (34)
                              
                                 
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          k
                                       
                                       
                                          τ
                                       
                                    
                                    −
                                    
                                       
                                          p
                                       
                                       
                                          k
                                       
                                       
                                          τ
                                       
                                    
                                    )
                                 
                                 
                                    
                                       g
                                    
                                    
                                       k
                                    
                                    
                                       τ
                                    
                                 
                                 ≥
                                 0
                                 ,
                                 
                                 ∀
                                 
                                    |
                                    
                                       
                                          q
                                       
                                       
                                          k
                                       
                                       
                                          τ
                                       
                                    
                                    |
                                 
                                 ≤
                                 τ
                                 
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          k
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Here, the prefix “Q” of VI is due to the fact that the constraint interval 
                           
                              [
                              −
                              τ
                              
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                              ,
                              τ
                              
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                              ]
                           
                         depends on the normal contact force 
                           
                              
                                 p
                              
                              
                                 k
                              
                              
                                 n
                              
                           
                         to be determined.

Suppose there are 
                        N
                      contact-pairs in the current time step, and hence 
                        2
                        N
                      contact force components are to be determined, denoted by the contact force vector 
                        
                           p
                        
                        ∈
                        
                           
                              R
                           
                           
                              2
                              N
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                    
                                       τ
                                    
                                 
                                 ;
                                 ⋯
                                 ;
                                 
                                    
                                       p
                                    
                                    
                                       N
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       N
                                    
                                    
                                       τ
                                    
                                 
                                 )
                              
                              ,
                           
                        
                      with 
                        
                           
                              p
                           
                           
                              k
                           
                           
                              n
                           
                        
                      and 
                        
                           
                              p
                           
                           
                              k
                           
                           
                              τ
                           
                        
                      the respective components of the normal and tangential contact force components of the 
                        k
                        
                           th
                        
                      contact-pair. Hereafter, we use semicolons to separate the normal and tangential contact force components of distinct contact-pairs.

From the deduction of Section  3, the 
                        k
                        
                           th
                        
                      contact-pair has two independent variables 
                        
                           
                              p
                           
                           
                              k
                           
                           
                              n
                           
                        
                      and 
                        
                           
                              p
                           
                           
                              k
                           
                           
                              τ
                           
                        
                     , and contributes two inequalities: VI-
                        n
                        
                           (
                           k
                           )
                        
                      and QVI-
                        τ
                        
                           (
                           k
                           )
                        
                     . The number of variational inequalities equals the number of contact force components, which makes the system determinant. By letting subscript 
                        k
                      traverse all these 
                        N
                      contact-pairs, we have the variational formulation of DDA as follows.

Find the contact force vector 
                        
                           p
                        
                        ∈
                        X
                        
                           (
                           
                              p
                           
                           )
                        
                        ⊂
                        
                           
                              R
                           
                           
                              2
                              N
                           
                        
                     , such that 
                        
                           (35)
                           
                              
                                 
                                    
                                       (
                                       
                                          q
                                       
                                       −
                                       
                                          p
                                       
                                       )
                                    
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              
                                 G
                              
                              
                                 (
                                 
                                    p
                                 
                                 )
                              
                              ≥
                              0
                              ,
                           
                        
                      for any 
                        
                           q
                        
                        ∈
                        X
                        
                           (
                           
                              p
                           
                           )
                        
                     . This problem will be denoted by 
                        
                           QVI
                        
                        
                           (
                           X
                           ,
                           
                              G
                           
                           )
                        
                      subsequently.

Here, the constraint 
                        X
                        
                           (
                           
                              p
                           
                           )
                        
                      is a closed set in 
                        
                           
                              R
                           
                           
                              2
                              N
                           
                        
                     , which is dependent on solution 
                        
                           p
                        
                     , with the definition as 
                        
                           (36)
                           
                              X
                              
                                 (
                                 
                                    p
                                 
                                 )
                              
                              =
                              
                                 
                                    X
                                 
                                 
                                    1
                                 
                              
                              
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                              ×
                              
                                 
                                    X
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                              ×
                              ⋯
                              ×
                              
                                 
                                    X
                                 
                                 
                                    N
                                 
                              
                              
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       N
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                              ,
                           
                        
                      where 
                        
                           
                              X
                           
                           
                              i
                           
                        
                        
                           (
                           
                              
                                 p
                              
                              
                                 i
                              
                              
                                 n
                              
                           
                           )
                        
                        ⊂
                        
                           
                              R
                           
                           
                              2
                           
                        
                      is the constraint set of the contact forces 
                        
                           
                              p
                           
                           
                              i
                           
                           
                              n
                           
                        
                      and 
                        
                           
                              p
                           
                           
                              i
                           
                           
                              τ
                           
                        
                      in the 
                        i
                     th contact-pair, which is dependent on the normal contact force 
                        
                           
                              p
                           
                           
                              i
                           
                           
                              n
                           
                        
                      of the 
                        i
                     th contact-pair, defined by 
                        
                           (37)
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                              =
                              
                                 {
                                 
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          q
                                       
                                       
                                          τ
                                       
                                    
                                    )
                                 
                                 |
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                 
                                 ≥
                                 0
                                 ,
                                 
                                    |
                                    
                                       
                                          q
                                       
                                       
                                          τ
                                       
                                    
                                    |
                                 
                                 ≤
                                 τ
                                 
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                                 }
                              
                              =
                              
                                 [
                                 0
                                 ,
                                 ∞
                                 )
                              
                              ×
                              
                                 [
                                 −
                                 τ
                                 
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                                 ,
                                 τ
                                 
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                                 ]
                              
                              ,
                           
                        
                      for 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        N
                     , with 
                        τ
                        
                           (
                           
                              
                                 p
                              
                              
                                 i
                              
                              
                                 n
                              
                           
                           )
                        
                      defined in Eq. (33).

The function-valued function 
                        
                           G
                        
                        :
                        
                        
                           
                              R
                           
                           
                              2
                              N
                           
                        
                        →
                        
                           
                              R
                           
                           
                              2
                              N
                           
                        
                     , called the gap function, is defined as 
                        
                           (38)
                           
                              
                                 G
                              
                              
                                 (
                                 
                                    p
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       [
                                       
                                          
                                             g
                                          
                                          
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             p
                                          
                                          )
                                       
                                       ,
                                       
                                          
                                             g
                                          
                                          
                                             1
                                          
                                          
                                             τ
                                          
                                       
                                       
                                          (
                                          
                                             p
                                          
                                          )
                                       
                                       ;
                                       ⋯
                                       ;
                                       
                                          
                                             g
                                          
                                          
                                             N
                                          
                                          
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             p
                                          
                                          )
                                       
                                       ,
                                       
                                          
                                             g
                                          
                                          
                                             N
                                          
                                          
                                             τ
                                          
                                       
                                       
                                          (
                                          
                                             p
                                          
                                          )
                                       
                                       ]
                                    
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              ,
                           
                        
                      in which 
                        
                           
                              g
                           
                           
                              i
                           
                           
                              n
                           
                        
                        
                           (
                           
                              p
                           
                           )
                        
                      is the normal gap of the 
                        i
                     th contact-pair defined by Eq. (21), and 
                        
                           
                              g
                           
                           
                              i
                           
                           
                              τ
                           
                        
                        
                           (
                           
                              p
                           
                           )
                        
                      is the tangential slide of the 
                        i
                     th contact-pair defined by Eq. (28).

To this point, we have derived the dual form of DDA with the contact forces as the basic variables, DDA-d. From the perspective of variational calculus, the original DDA is the primal form since it takes the block displacements as the independent variables.

The number of basic variables of DDA-d is 
                        2
                        N
                     , while the number of basic invariables in DDA is 
                        6
                        M
                     , with 
                        M
                      being the number of the blocks. In general, no rules can tell which one of 
                        2
                        N
                      and 
                        6
                        M
                      is larger. It appears that 
                        2
                        N
                        ≈
                        6
                        M
                     , in most applications. Anyway, the number of basic variables in DDA-d is far less than that in  [26–29].

Most of the solution process of DDA-d coincides with DDA. But DDA-d does not assemble the global stiffness matrix. The open–close iteration in DDA is replaced by the solution of 
                        
                           QVI
                        
                        
                           (
                           X
                           ,
                           
                              G
                           
                           )
                        
                      to be expounded in the next solution, which will be referred to as the compatibility iteration. Once the compatibility iteration is finished, both the momentum conservation of the block system and the contact conditions are satisfied.

Here is the solution process to a time step of DDA-d.

① Collect all the contact-pairs by the contact detection.

② Calculate and save the 
                        6
                        ×
                        2
                        
                           
                              n
                           
                           
                              i
                           
                        
                      flexibility matrix 
                        
                           
                              
                                 F
                              
                           
                           
                              i
                           
                        
                      by Eq. (15) and the 6-dimensional flexibility vector 
                        
                           
                              
                                 f
                              
                           
                           
                              i
                           
                        
                      by Eq. (16) of all the blocks.

③ Calculate and save the four vectors: 
                        
                           
                              
                                 n
                              
                           
                           
                              k
                              i
                           
                        
                     , 
                        
                           
                              
                                 n
                              
                           
                           
                              k
                              j
                           
                        
                      by Eq. (23), and 
                        
                           
                              
                                 τ
                              
                           
                           
                              k
                              i
                           
                        
                        ,
                        
                        
                           
                              
                                 τ
                              
                           
                           
                              k
                              j
                           
                        
                      by Eq. (30), and the two numbers: 
                        
                           
                              g
                           
                           
                              i
                              j
                           
                           
                              n
                           
                        
                      by Eq. (24) and 
                        
                           
                              g
                           
                           
                              i
                              j
                           
                           
                              τ
                           
                        
                      by Eq. (31), of all the contact-pairs.

④ Carry out the compatibility iteration to solve for the contact vector 
                        
                           p
                        
                     .

⑤ Calculate and save the 6-dimensional displacement vector 
                        
                           
                              
                                 d
                              
                           
                           
                              i
                           
                        
                      of all the blocks by Eq. (14).

⑥ Update the configuration of all the blocks according to the scheme in  [31].

Each of the main processes, namely steps ②–⑥, can be highly parallelized. For example, in step ③, the computation of the four vectors 
                        
                           
                              
                                 n
                              
                           
                           
                              k
                              i
                           
                        
                     , 
                        
                           
                              
                                 n
                              
                           
                           
                              k
                              j
                           
                        
                      by Eq. (23), and 
                        
                           
                              
                                 τ
                              
                           
                           
                              k
                              i
                           
                        
                        ,
                        
                           
                              
                                 τ
                              
                           
                           
                              k
                              j
                           
                        
                      by Eq. (30), associated with the 
                        k
                        
                           th
                        
                      contact-pair, can be conducted independently from other contact-pairs. The major computation of DDA-d lies in the compatibility iteration, namely step ④, which is just the content of the next section.

In step ⑥, the reason why the configuration of the blocks is updated according to the scheme in  [31] is that the direct accumulation of the displacement vector 
                        
                           
                              
                                 d
                              
                           
                           
                              i
                           
                        
                      has been observed the false volume expansion, which can be easily overcome by fixing a local frame onto each block that moves with the block and accumulating the block displacements in the local frame. More details can be found in  [31].

The compatibility iteration is for the solution of 
                        
                           QVI
                        
                        
                           (
                           X
                           ,
                           
                              G
                           
                           )
                        
                      posed in Section  3. QVI is an extension of VI, and also a very active field. But no mature algorithm is available for 
                        
                           QVI
                        
                        
                           (
                           X
                           ,
                           
                              G
                           
                           )
                        
                     . Even in the magnum opus  [32], no algorithm for QVI is expounded. In order to solve 
                        
                           QVI
                        
                        
                           (
                           X
                           ,
                           
                              G
                           
                           )
                        
                     , an iterative algorithm is designed based on the standard projection–contraction algorithm for the standard VI.

In 
                        
                           QVI
                        
                        
                           (
                           X
                           ,
                           
                              G
                           
                           )
                        
                     , set 
                        X
                        
                           (
                           
                              p
                           
                           )
                        
                     , defined in Eq. (36), is a rectangle in 
                        
                           
                              R
                           
                           
                              2
                              N
                           
                        
                     . The even-dimensional constraints of 
                        X
                        
                           (
                           
                              p
                           
                           )
                        
                     , namely the constraints on the tangential contact force components, vary with the solution vector 
                        
                           p
                        
                     , leading to huge difficulties in finding the projector of 
                        X
                        
                           (
                           
                              p
                           
                           )
                        
                     .

If 
                        
                           p
                        
                      is given, then 
                        X
                        
                           (
                           
                              p
                           
                           )
                        
                      is determined by Eq. (36). Here, 
                        
                           p
                        
                      is an approximation to the solution. In this case, the projection 
                        
                           
                              
                                 q
                              
                           
                           
                              ̄
                           
                        
                      of any vector 
                        
                           q
                        
                     , 
                        
                           
                              
                                 q
                              
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                          
                                             τ
                                          
                                       
                                       ;
                                       ⋯
                                       ;
                                       
                                          
                                             q
                                          
                                          
                                             N
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             N
                                          
                                          
                                             τ
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                    N
                                 
                              
                              ,
                           
                        
                      onto 
                        X
                        
                           (
                           
                              p
                           
                           )
                        
                     , is given by 
                        
                           (39)
                           
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       1
                                    
                                    
                                       τ
                                    
                                 
                                 ;
                                 ⋯
                                 ;
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       i
                                    
                                    
                                       τ
                                    
                                 
                                 ;
                                 ⋯
                                 ;
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       N
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       N
                                    
                                    
                                       τ
                                    
                                 
                                 )
                              
                              .
                           
                        
                      Here, 
                        
                           
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    ̄
                                 
                              
                           
                           
                              i
                           
                           
                              n
                           
                        
                      is the projection of 
                        
                           
                              q
                           
                           
                              i
                           
                           
                              n
                           
                        
                      onto interval 
                        
                           [
                           0
                           ,
                           ∞
                           )
                        
                     , namely, 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                              =
                              max
                              
                                 (
                                 0
                                 ,
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                              ;
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    ̄
                                 
                              
                           
                           
                              i
                           
                           
                              τ
                           
                        
                      is the projection of 
                        
                           
                              q
                           
                           
                              i
                           
                           
                              τ
                           
                        
                      onto the closed interval 
                        
                           
                              τ
                           
                           
                              i
                           
                        
                        =
                        
                           [
                           −
                           τ
                           
                              (
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                              )
                           
                           ,
                           τ
                           
                              (
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                              )
                           
                           ]
                        
                     , with 
                        
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                              =
                              max
                              
                                 (
                                 0
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                              ,
                           
                        
                      and 
                        
                           
                              p
                           
                           
                              i
                           
                           
                              n
                           
                        
                      being the 
                        
                           (
                           2
                           i
                           −
                           1
                           )
                        
                        
                           th
                        
                      component of vector 
                        
                           p
                        
                     ; and 
                        
                           
                              τ
                              
                                 (
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    μ
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                              .
                           
                        
                      The one-dimensional projection onto a closed interval is referred to Appendix A.

Now we give two procedures that are repeatedly invoked during the compatibility iteration, the calculation of gap function 
                        
                           G
                        
                        
                           (
                           
                              p
                           
                           )
                        
                      and the projection of vector 
                        
                           q
                        
                      onto 
                        X
                        
                           (
                           
                              p
                           
                           )
                        
                     , denoted by 
                        
                           
                              
                                 q
                              
                           
                           
                              ̄
                           
                        
                        =
                        Π
                        
                           (
                           
                              q
                           
                           ;
                           
                              p
                           
                           )
                        
                     . The algorithm for 
                        
                           QVI
                        
                        
                           (
                           X
                           ,
                           
                              G
                           
                           )
                        
                     , see Appendix B, is based on the projection–contraction method.

The algorithm has the contact force vector 
                           
                              p
                           
                         and the Boolean argument, bswitch, as input, and the vector-valued gap function 
                           
                              Gp
                           
                           =
                           
                              G
                           
                           
                              (
                              
                                 p
                              
                              )
                           
                         as output, with the definition as 
                           
                              
                                 
                                    Gp
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                g
                                             
                                             
                                                1
                                             
                                             
                                                n
                                             
                                          
                                          ,
                                          
                                             
                                                g
                                             
                                             
                                                1
                                             
                                             
                                                τ
                                             
                                          
                                          ;
                                          ⋯
                                          ;
                                          
                                             
                                                g
                                             
                                             
                                                k
                                             
                                             
                                                n
                                             
                                          
                                          ,
                                          
                                             
                                                g
                                             
                                             
                                                k
                                             
                                             
                                                τ
                                             
                                          
                                          ;
                                          ⋯
                                          
                                             
                                                g
                                             
                                             
                                                N
                                             
                                             
                                                n
                                             
                                          
                                          ,
                                          
                                             
                                                g
                                             
                                             
                                                N
                                             
                                             
                                                τ
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 ,
                              
                           
                         with the components 
                           
                              
                                 g
                              
                              
                                 k
                              
                              
                                 n
                              
                           
                         and 
                           
                              
                                 g
                              
                              
                                 k
                              
                              
                                 τ
                              
                           
                         being given in Eqs. (21) and (28), respectively. The Boolean argument, bswitch, is used to indicate whether or not switching to another contact-pair to those singular contact-pairs, which will be explained after the algorithm.

After exiting from the algorithm, the contact force vector 
                           
                              p
                           
                         does not change, but some singular contact-pairs might change.


                        
                           
                        
                     

By a singular contact-pair 
                           E
                        –
                           V
                        , we mean the vertex 
                           V
                         is very close to one end of the edge 
                           E
                        , and the end of 
                           E
                         is also a vertex (a convex angle), leading to a vertex–vertex contact. Every vertex–vertex contact has two possible contact-pairs, but only one is active at a moment. At the start of a time step, usually we do not know which contact-pair in a vertex–vertex contact should be taken. During the compatibility iteration, therefore the active contact-pair might switch between the two possible contact-pairs of the vertex–vertex contact so that the correct contact is guaranteed by the end of this time step. Appendix C elucidates upon how to switch to another contact-pair in a vertex–vertex contact.

Suppose that vector 
                           
                              p
                           
                         is an approximation to the solution, and vector 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 ̃
                              
                           
                         is another approximation updated from 
                           
                              p
                           
                        . During the compatibility iteration, it is necessary to calculate the gap function difference, 
                           
                              dG
                           
                           =
                           
                              G
                           
                           
                              (
                              
                                 p
                              
                              )
                           
                           −
                           
                              G
                           
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    ̃
                                 
                              
                              )
                           
                        . In order to be physically meaningful, any two vectors, 
                           
                              a
                           
                         and 
                           
                              b
                           
                        , in the expression of 
                           
                              a
                           
                           −
                           
                              b
                           
                        , must be defined in the same coordinate system, suggesting that the calculation of 
                           
                              G
                           
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    ̃
                                 
                              
                              )
                           
                         should be in the same local frames of the contact-pairs as 
                           
                              G
                           
                           
                              (
                              
                                 p
                              
                              )
                           
                        . Therefore, whenever calculating the difference of gap functions of 
                           
                              G
                           
                           
                              (
                              
                                 p
                              
                              )
                           
                         and 
                           
                              G
                           
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    ̃
                                 
                              
                              )
                           
                        , this algorithm should be invoked in this way, 
                           
                              dG
                           
                           =
                           
                              G
                           
                           
                              (
                              
                                 p
                              
                              ,
                              
                                 true
                              
                              )
                           
                           −
                           
                              G
                           
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    ̃
                                 
                              
                              ,
                              
                                 false
                              
                              )
                           
                        .

With the 
                           2
                           N
                        -dimensional vector 
                           
                              q
                           
                         and the approximate solution 
                           
                              p
                           
                         as input, defined by 
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                       
                                          τ
                                       
                                    
                                    ;
                                    ⋯
                                    ;
                                    
                                       
                                          q
                                       
                                       
                                          k
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          q
                                       
                                       
                                          k
                                       
                                       
                                          τ
                                       
                                    
                                    ;
                                    ⋯
                                    ;
                                    
                                       
                                          q
                                       
                                       
                                          N
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          q
                                       
                                       
                                          N
                                       
                                       
                                          τ
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                       
                                          τ
                                       
                                    
                                    ;
                                    ⋯
                                    ;
                                    
                                       
                                          p
                                       
                                       
                                          k
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          k
                                       
                                       
                                          τ
                                       
                                    
                                    ;
                                    ⋯
                                    ;
                                    
                                       
                                          p
                                       
                                       
                                          N
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          N
                                       
                                       
                                          τ
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         this algorithm calculates the projection 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 ̄
                              
                           
                         of vector 
                           
                              q
                           
                         onto 
                           X
                           =
                           X
                           
                              (
                              
                                 p
                              
                              )
                           
                        , which is the constraint set associated with vector 
                           
                              p
                           
                        . The output includes the 
                           2
                           N
                        -dimensional projection 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 ̄
                              
                           
                         of 
                           
                              q
                           
                         onto 
                           X
                           
                              (
                              
                                 p
                              
                              )
                           
                        , defined as 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          1
                                       
                                       
                                          τ
                                       
                                    
                                    ;
                                    ⋯
                                    ;
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          k
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          k
                                       
                                       
                                          τ
                                       
                                    
                                    ;
                                    ⋯
                                    ;
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          N
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          N
                                       
                                       
                                          τ
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Neither 
                           
                              q
                           
                         nor 
                           
                              p
                           
                         is changed after this algorithm.


                        
                           
                        
                     

The projection of the 
                           N
                         contact-pairs in the above algorithm can be shared by many different processors in that the projection of 
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                                 
                                    τ
                                 
                              
                              )
                           
                         of the 
                           i
                        th contact-pair has no relation to the projection of 
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                                 
                                    n
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                                 
                                    τ
                                 
                              
                              )
                           
                         of the 
                           j
                        th contact-pair, suggesting the above loop can be split in a parallelization way.

To demonstrate the proposed procedure, in this section we will select some typical examples including those designed by the inventor.

Shown in Fig. 5
                         are two blocks on a rectangular block, the left block horizontally slides with no friction to the right at a constant speed, and will be in collision with the left block at rest. All blocks have the same material parameters: density 
                           
                              
                                 ρ
                              
                              
                                 ̄
                              
                           
                           =
                           2.8
                           ×
                           
                              
                                 10
                              
                              
                                 3
                              
                           
                           
                           
                              kg
                           
                           /
                           
                              
                                 
                                    m
                                 
                              
                              
                                 3
                              
                           
                        , Young’s modulus 
                           E
                           =
                           2.0
                           ×
                           
                              
                                 10
                              
                              
                                 4
                              
                           
                           
                           
                              MPa
                           
                        , and Poisson’s ratio 
                           υ
                           =
                           0.25
                        . The four vertices of the bottom block are fixed with springs of stiffness 
                           2.0
                           ×
                           
                              
                                 10
                              
                              
                                 8
                              
                           
                           
                           
                              MN
                           
                           /
                           
                              m
                           
                        , acceleration of gravity 
                           g
                           =
                           9.8
                           
                           
                              m
                           
                           /
                           
                              
                                 
                                    s
                                 
                              
                              
                                 2
                              
                           
                        . The computational control parameters include the allowable maximum displacement ratio 
                           ρ
                           =
                           0.1
                        , time step length 
                           Δ
                           =
                           0.05
                           
                           
                              s
                           
                        , 160 time steps, and stop error 
                           ε
                           =
                           1.0
                           ×
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 10
                              
                           
                        .

Before collision, speed of the left block is 
                           v
                           =
                           5.0
                           ×
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 1
                              
                           
                           
                           
                              m
                           
                           /
                           
                              s
                           
                        . After collision, the left block and the right block both slide to the right, their speeds are 
                           1.7301
                           ×
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 5
                              
                           
                           
                           
                              m
                           
                           /
                           
                              s
                           
                        , 
                           4.9998
                           ×
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 1
                              
                           
                           
                           
                              m
                           
                           /
                           
                              s
                           
                        , respectively. Compared with the theoretical values, 
                           0
                           
                           
                              m
                           
                           /
                           
                              s
                           
                         and 
                           5.0
                           ×
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 1
                              
                           
                           
                           
                              m
                           
                           /
                           
                              s
                           
                        , the error is very small.


                        Fig. 6
                         displays the variation in momentum of the two blocks before and after collision.

Shown in Fig. 7
                         is a standard benchmark to validate precision of DDA, where a small block is sliding down a ramp with a slope angle of 
                           3
                           
                              
                                 0
                              
                              
                                 ∘
                              
                           
                        . The block and the ramp have the same material parameters: density 
                           
                              
                                 ρ
                              
                              
                                 ̄
                              
                           
                           =
                           2.75
                           ×
                           
                              
                                 10
                              
                              
                                 3
                              
                           
                           
                           
                              kg
                           
                           /
                           
                              
                                 
                                    m
                                 
                              
                              
                                 3
                              
                           
                        , Young’s modulus 
                           E
                           =
                           2.0
                           ×
                           
                              
                                 10
                              
                              
                                 4
                              
                           
                           
                           
                              MPa
                           
                        , and Poisson’s ratio 
                           υ
                           =
                           0.25
                        . The friction angle between the block and the ramp is 20°. The three vertices of the ramp are fixed with springs of stiffness 
                           2.0
                           ×
                           
                              
                                 10
                              
                              
                                 8
                              
                           
                           
                           
                              MN
                           
                           /
                           
                              m
                           
                        . Acceleration of gravity 
                           g
                           =
                           9.8
                           
                           
                              m
                           
                           /
                           
                              
                                 
                                    s
                                 
                              
                              
                                 2
                              
                           
                        .

The computational control parameters include the allowable maximum displacement ratio 
                           ρ
                           =
                           0.1
                        , time step length 
                           Δ
                           =
                           0.01
                           
                           
                              s
                           
                        , and 300 time steps. The stop error of the compatibility iteration is set such that DDA and DDA-d yield almost equal penetration between the two blocks.

The following observations can be made from Fig. 8
                        . When the allowable penetration is set not very strict, DDA has an acceptable displacement precision, as shown in Fig. 8(a). If the penetration is set stringent, as shown in Fig. 8(b), DDA has a worse precision and becomes instable. Instead, DDA-d behaves excellently in both cases, with much higher precision than DDA.

Some researchers believe that only in the case of numerous blocks does DDA yield multiple solutions. However, Bao and Zhao gave a counter-example  [33]. Shown in Fig. 9
                         is a four-block system on a fixed table with gravity neglected, and all the blocks keep still at the beginning till the force with a ratio of 4:3 is exerted.

All the blocks have the same material properties: mass density 
                           
                              
                                 ρ
                              
                              
                                 ̄
                              
                           
                           =
                           2300
                           
                           
                              kg
                           
                           /
                           
                              
                                 
                                    m
                                 
                              
                              
                                 3
                              
                           
                        , Young’s modulus 
                           E
                           =
                           10
                           
                           
                              GPa
                           
                        , friction angle between blocks 
                           ϕ
                           =
                           15
                           °
                         and cohesion 
                           c
                           =
                           0
                        . The computational control parameters include: the allowable maximum displacement ratio 
                           ρ
                           =
                           0.05
                        , time step length 
                           Δ
                           =
                           0.01
                           
                           
                              s
                           
                        , stop error 
                           ε
                           =
                           1.0
                           ×
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 10
                              
                           
                        , and 20 time steps. The DDA normal contact spring stiffness is 
                           4
                           ×
                           
                              
                                 10
                              
                              
                                 5
                              
                           
                           
                           
                              MN
                           
                           /
                           
                              m
                           
                        , the point force 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    T
                                 
                              
                           
                           =
                           
                              (
                              −
                              4
                              ×
                              
                                 
                                    10
                                 
                                 
                                    7
                                 
                              
                              ,
                              −
                              3
                              ×
                              
                                 
                                    10
                                 
                                 
                                    7
                                 
                              
                              )
                           
                         KN is applied on block A. The dynamic factor is set zero for the static analysis.

Shown in Fig. 10
                         are the solutions by DDA and DDA-d. Bao and Zhao  [33] believed that the solution by DDA was incorrect with the argument as follows.

Since 
                           
                              
                                 F
                              
                              
                                 x
                              
                           
                           /
                           
                              
                                 F
                              
                              
                                 y
                              
                           
                           =
                           4
                           /
                           3
                        , i.e, 
                           
                              |
                              
                                 
                                    F
                                 
                                 
                                    x
                                 
                              
                              |
                           
                           >
                           
                              |
                              
                                 
                                    F
                                 
                                 
                                    y
                                 
                              
                              |
                           
                        , the deformation along the horizontal direction is larger than that along the vertical direction. Therefore, the vertex of block A should move horizontally along the top edge of block C, rather than vertically along the side edge. In order to reach such a state, Bao and Zhao  [33] suggested that a temporary spring be fixed between the two vertices of blocks A and C.

The authors think that both solutions illustrated in Fig. 10 are acceptable, although DDA-d gave a more likely solution as shown in Fig. 10(b).

To be frank, the author’s team have made huge efforts to remove completely contact springs, which led to complementarity based algorithms  [26–28] and variational inequalities based algorithm  [29]. Albeit a little progress, all these algorithms become extremely inefficient if there are a large number of vertex–vertex contacts.

Now the inefficiency has been improved essentially, which will be illustrated by the inventor designed example of a missile penetrating an underground infrastructure, where, as shown in Fig. 11
                        , there are 1689 blocks, and up to 11000 contact-pairs. Most of contacts are vertex–vertex contact, so the problem is extremely singular.

For the missile, density 
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 m
                              
                           
                           =
                           0.5
                        , Young’s modulus 
                           E
                           =
                           4
                           ×
                           
                              
                                 10
                              
                              
                                 5
                              
                           
                        , and Poisson’s ratio 
                           υ
                           =
                           0.25
                        . For other blocks, density 
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 b
                              
                           
                           =
                           0.3
                        , with the same Young’s modulus and Poisson’s ratio as the missile. All the joints are set no cohesion and no friction. The acceleration speed 
                           g
                           =
                           8.0
                        .

Now let the missile vertically penetrate the block pile at an initial speed of 274. The allowable maximum displacement ratio 
                           ρ
                           =
                           0.003
                        , the tolerance 
                           ε
                           =
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 4
                              
                           
                        , a very stringent error control, 280 time steps are conducted and time length is automatically selected.

Shown in Fig. 12
                         are the configurations at time steps 100, 200, and 280, respectively.

A PC running this example has the configuration as follows: 4G RAM and 3.4 GHz Intel Core i7 CPU. It took 8.2 min for DDA-d to conduct this example, a tolerable time consumption. DDA’s time consumption on this example is 4.3 min.

Considering DDA-d is easy to be highly parallelized, the authors are quite confident that the solution efficiency will be enhanced considerably by means of the GPU technique or the parallelization in future.

@&#CONCLUSIONS@&#

With the contact forces as the basic variables, the dual form of DDA, DDA-d, can accurately satisfy the contact condition as well as the momentum conservation, while DDA only approximately satisfies the contact condition because it has to allow for penetration between blocks in contact. The proposed algorithm has reached a practical level in accuracy, robustness and efficiency, and finally accomplished the dream to avoid completely virtual contact springs.

DDA-d is highly superior to DDA in precision and numerical stability, and its solution efficiency is comparable with DDA. Considering the fact that the algorithms for DDA-d can be highly parallelized, however, DDA-d will exceed DDA in the solution efficiency if it is parallelized in future. Since much time has to be spent in testing stiffness of contact springs whenever DDA is used to analyze geotechnical problems, the total time of DDA-d in solving an engineering problem might be less than DDA.

Since DDA-d does not assemble the global stiffness matrix, it can solve a larger number of blocks than DDA.

However, we have to admit that the above advantages of DDA-d over DDA are based on the assumption of linear displacement mode of blocks, where the dimension of stiffness matrices of all the blocks is only 6, and the inversion of these stiffness matrices needs very few computations. If all the blocks are discretized with meshes to enhance their deformation accuracy, the dimensions of stiffness matrices of these blocks will become much higher, and accordingly the inversion of them will become a huge task. In that case, a highly efficient solver for linear equations is vital to maintain the solution efficiency, which will be our next effort.

@&#ACKNOWLEDGMENTS@&#

This study is supported by the National Basic Research Program of China (973 Program), under the Grant Nos. 2011CB013505 and 2014CB047100; and the National Natural Science Foundation of China, under the Grant Nos. 11572009 and 51538001.

Finite-dimensional variational inequalities originate from optimization but have been applied to numerous disciplines, such as seepage analysis  [34], and simulation of propagation of multiple cracks  [13]. This Appendix A only touches upon the most basic content involved in this study. More details can be found in  [32].

The problem of a basic finite-dimensional variational inequalities is posed as follows.

Given a subset 
                           K
                         of the Euclidean 
                           n
                        -dimensional space 
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                         and a vector-valued function: 
                           
                              F
                           
                           :
                           K
                           →
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        , 
                           
                              
                                 
                                    F
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          [
                                          
                                             
                                                F
                                             
                                             
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          ,
                                          
                                             
                                                F
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                F
                                             
                                             
                                                n
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          ]
                                       
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 ,
                              
                           
                         with 
                           
                              
                                 F
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         the 
                           i
                        th component function, the variational inequality, denoted by 
                           
                              VI
                           
                           
                              (
                              K
                              ,
                              
                                 F
                              
                              )
                           
                        , is to find a vector 
                           
                              x
                           
                           ∈
                           K
                         such that 
                           
                              
                                 
                                    
                                       
                                          (
                                          
                                             y
                                          
                                          −
                                          
                                             x
                                          
                                          )
                                       
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 
                                    F
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 ≥
                                 0
                                 ,
                                 
                                 ∀
                                 
                                    y
                                 
                                 ∈
                                 K
                                 .
                              
                           
                         The solution of nonlinear equations is a particular case of 
                           
                              VI
                           
                           
                              (
                              K
                              ,
                              
                                 F
                              
                              )
                           
                         by letting 
                           K
                           =
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        . The solution of the complementarity problem is also a particular case by letting 
                           K
                           =
                           
                              
                                 R
                              
                              
                                 +
                              
                              
                                 n
                              
                           
                        , where 
                           
                              
                                 R
                              
                              
                                 +
                              
                              
                                 n
                              
                           
                         is composed of 
                           n
                        -dimensional vectors with all components being nonnegative.

General as they are, the contents of basic finite-dimensional variational inequalities are not able to include some topics arose from the applications including this study. So they need to be further extended. Here is a typical instance.

If the set 
                           K
                         is dependent on the solution, namely, 
                           K
                         is a set-valued function, 
                           K
                           
                              (
                              
                                 x
                              
                              )
                           
                        , then the quasi-inequality variational problem, denoted by 
                           
                              QVI
                           
                           
                              (
                              K
                              ,
                              
                                 F
                              
                              )
                           
                        , is to find a vector 
                           
                              x
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                         such that 
                           
                              
                                 
                                    
                                       
                                          (
                                          
                                             y
                                          
                                          −
                                          
                                             x
                                          
                                          )
                                       
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 
                                    F
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 ≥
                                 0
                                 ,
                                 
                                 ∀
                                 
                                    y
                                 
                                 ∈
                                 K
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

There is a huge volume of literature on the solution of finite-dimensional variational inequalities, most of which falls into the Newton category  [32]. Highly efficient as they are, the algorithms of Newton’s type cannot be used to solve those problems where the dimension of the solution vector varies with iteration, such as the simulation of crack propagation  [13]. Meanwhile, if the Jacobian has abrupt change during iteration, such as the switch of contact-pairs in vertex–vertex contacts, the efficiency of the Newton method becomes extremely low and even not convergent. In this case, we might resort to the projection-based algorithms, in which projection is necessary. Here is the definition of projection.

Let 
                           K
                         be a closed subset of the Euclidean 
                           n
                        -dimensional space 
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        . For every point 
                           
                              x
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        , there is at least one point 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 ̄
                              
                           
                           ∈
                           K
                         that is closest to 
                           
                              x
                           
                        . The closest point 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 ̄
                              
                           
                         is called the projection of 
                           
                              x
                           
                         onto 
                           K
                        , denoted by 
                           
                              
                                 Π
                              
                              
                                 K
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                        . Correspondingly, the operator 
                           
                              
                                 Π
                              
                              
                                 K
                              
                           
                         is called the projector of 
                           K
                        .


                        Fig. A.1
                         illustrates schematically the projector of a two-dimensional subset 
                           Ω
                        , where some points might have more than one projections.

The computation of 
                           
                              
                                 Π
                              
                              
                                 K
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         is strongly dependent on set 
                           K
                        , and usually not a trifle. When 
                           K
                         is a closed rectangle in 
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        , namely, 
                           
                              (A.1)
                              
                                 K
                                 =
                                 
                                    
                                       ∏
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    [
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                         with 
                           −
                           ∞
                           ≤
                           
                              
                                 a
                              
                              
                                 i
                              
                           
                           <
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                           ≤
                           +
                           ∞
                        , however, 
                           
                              
                                 Π
                              
                              
                                 K
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         becomes very easy 
                           
                              (A.2)
                              
                                 
                                    
                                       Π
                                    
                                    
                                       K
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          Π
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   a
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          Π
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   a
                                                
                                                
                                                   n
                                                
                                             
                                             ,
                                             
                                                
                                                   b
                                                
                                                
                                                   n
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 ,
                              
                           
                         in which 
                           
                              
                                 Π
                              
                              
                                 
                                    [
                                    a
                                    ,
                                    b
                                    ]
                                 
                              
                           
                           
                              (
                              x
                              )
                           
                         represents the projection of 
                           x
                           ∈
                           R
                         onto the closed interval 
                           
                              [
                              a
                              ,
                              b
                              ]
                           
                        , defined by 
                           
                              (A.3)
                              
                                 
                                    
                                       Π
                                    
                                    
                                       
                                          [
                                          a
                                          ,
                                          b
                                          ]
                                       
                                    
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             a
                                             ,
                                          
                                          
                                             if  
                                             x
                                             <
                                             a
                                          
                                       
                                       
                                          
                                             x
                                             ,
                                          
                                          
                                             if  
                                             a
                                             ≤
                                             x
                                             ≤
                                             b
                                          
                                       
                                       
                                          
                                             b
                                             ,
                                          
                                          
                                             if  
                                             x
                                             >
                                             b
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                     

Particularly, for 
                           
                              [
                              a
                              ,
                              b
                              ]
                           
                           =
                           
                              [
                              0
                              ,
                              ∞
                              )
                           
                        , 
                           
                              (A.4)
                              
                                 
                                    
                                       Π
                                    
                                    
                                       
                                          [
                                          0
                                          ,
                                          ∞
                                          )
                                       
                                    
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 max
                                 
                                    (
                                    0
                                    ,
                                    x
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             0
                                             ,
                                          
                                          
                                             if  
                                             x
                                             <
                                             0
                                          
                                       
                                       
                                          
                                             x
                                             ,
                                          
                                          
                                             if  
                                             x
                                             ≥
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The projection-based algorithm for 
                        
                           VI
                        
                        
                           (
                           K
                           ,
                           
                              F
                           
                           )
                        
                      is based on the proposition  [32], which says that 
                        
                           x
                        
                      solves 
                        
                           VI
                        
                        
                           (
                           K
                           ,
                           
                              F
                           
                           )
                        
                      if and only if 
                        
                           x
                        
                      is the projection of 
                        
                           x
                        
                        −
                        β
                        
                           F
                        
                        
                           (
                           
                              x
                           
                           )
                        
                      onto 
                        K
                     , namely, 
                        
                           (B.1)
                           
                              
                                 x
                              
                              =
                              
                                 
                                    Π
                                 
                                 
                                    K
                                 
                              
                              
                                 [
                                 
                                    x
                                 
                                 −
                                 β
                                 
                                    F
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 ]
                              
                              .
                           
                        
                     
                  

Here, 
                        β
                      is a positive number for scaling 
                        
                           F
                        
                        
                           (
                           
                              x
                           
                           )
                        
                      to improve the condition of VI.

The proposed algorithm for 
                        
                           QVI
                        
                        
                           (
                           X
                           ,
                           
                              G
                           
                           )
                        
                      defined in Eq. (35) stems from the projection-contraction algorithm by He and Liao for the standard finite-dimensional inequalities  [35]. After the algorithm is finished, the contact force vector 
                        
                           p
                        
                      is obtained, which satisfies both the momentum conservation and the compatibility condition between contacts. Therefore, the algorithm is referred to as the compatibility iteration.


                     
                        
                     
                  

The control parameters in this algorithm are the same as  [35], namely, 
                        ν
                        =
                        0.9
                     , 
                        μ
                        =
                        0.4
                     , and 
                        γ
                        =
                        1.9
                     .

The parameter 
                        
                           
                              k
                           
                           
                              p
                           
                        
                      is merely used to scale the normal gap 
                        
                           
                              g
                           
                           
                              n
                           
                        
                      and tangential slide 
                        
                           
                              g
                           
                           
                              τ
                           
                        
                      such that 
                        
                           
                              k
                           
                           
                              p
                           
                        
                        
                           
                              g
                           
                           
                              n
                           
                        
                      and 
                        
                           
                              k
                           
                           
                              p
                           
                        
                        
                           
                              g
                           
                           
                              τ
                           
                        
                      have a magnitude nearly equal to the normal contact force 
                        
                           
                              p
                           
                           
                              n
                           
                        
                      and tangential contact force 
                        
                           
                              p
                           
                           
                              τ
                           
                        
                      in calculating the error vector. 
                        
                           
                              k
                           
                           
                              p
                           
                        
                      has no influence on the iterative series, with a quite large scope of selection. For all the examples, 
                        
                           
                              k
                           
                           
                              p
                           
                        
                        =
                        
                           
                              10
                           
                           
                              −
                              3
                           
                        
                        E
                     .

DDA reduces all the types of contact to the contact between an edge 
                        E
                      and a vertex 
                        V
                      that constitute the contact-pair 
                        E
                     –
                        V
                     . A normal contact spring is only allowed to link 
                        V
                      and the projection 
                        
                           
                              V
                           
                           
                              ′
                           
                        
                      of 
                        V
                      onto 
                        E
                     . In this study, the normal contact spring and the tangential spring in the 
                        k
                        
                           th
                        
                      contact-pair 
                        
                           
                              E
                           
                           
                              k
                           
                        
                     –
                        
                           
                              V
                           
                           
                              k
                           
                        
                      are replaced by 
                        
                           VI
                        
                        -
                        n
                        
                           (
                           k
                           )
                        
                      defined in Eq. (26) and 
                        
                           QVI
                        
                        -
                        τ
                        
                           (
                           k
                           )
                        
                      in Eq. (34).

When the vertex 
                        V
                      of contact-pair 
                        E
                     –
                        V
                      is very close to one end of edge 
                        E
                     , less than the maximum allowable displacement 
                        ρ
                     , and the end of 
                        E
                      is also a vertex (a convex angle), however, there are two potential contact-pairs, and at any moment only one can be selected as the contact-pair. The selected contact-pair is called active. In general, we have no way to determine which one of the two contact-pairs is active. This is the so called issue of vertex–vertex contact, and also called singular contact.

According to the relative position of the two close vertices, there are four cases as shown in Fig. C.2
                     , where the edges of the two potential contact-pairs are marked with thick lines. Once the edge of a contact-pair is selected, another block vertex becomes the vertex of the contact-pair.

The active edge is determined the same as in DDA. Let us suppose 
                        
                           
                              E
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              E
                           
                           
                              2
                           
                        
                      represent the possible edges, and 
                        
                           
                              V
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              V
                           
                           
                              2
                           
                        
                      the possible vertices, respectively. If 
                        
                           
                              d
                           
                           
                              1
                           
                        
                        ≥
                        
                           
                              d
                           
                           
                              2
                           
                        
                     , 
                        
                           
                              E
                           
                           
                              1
                           
                        
                      is set active; otherwise, 
                        
                           
                              E
                           
                           
                              2
                           
                        
                      is set active. Here, 
                        
                           
                              d
                           
                           
                              1
                           
                        
                      represents the algebraic distance from 
                        
                           
                              V
                           
                           
                              2
                           
                        
                      to 
                        
                           
                              E
                           
                           
                              1
                           
                        
                     : it is positive if 
                        
                           
                              V
                           
                           
                              2
                           
                        
                      is outside 
                        
                           
                              E
                           
                           
                              1
                           
                        
                     , and negative if 
                        
                           
                              V
                           
                           
                              2
                           
                        
                      is inside 
                        
                           
                              E
                           
                           
                              1
                           
                        
                     .


                     Fig. C.3
                      shows a schematic illustration of selecting the active edge.

@&#REFERENCES@&#

