@&#MAIN-TITLE@&#Multi-symbol QIM video watermarking

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Theoretical framework for the binary m-QIM (multi-symbol quantization index modulation).


                        
                        
                           
                           Detection method optimized with respect to the minimization of the average error probability.


                        
                        
                           
                           Expected benefit: for prescribed transparency and robustness constraints, the data payload is increased by a factor of log2
                              m.
                           


                        
                        
                           
                           Experimental validation: robust and semi-fragile MPEG-4 AVC watermarking.


                        
                     
                  
               
            

@&#KEYPHRASES@&#




                     m-QIM

MPEG-4 AVC watermarking

Robustness

Semi-fragility

@&#ABSTRACT@&#


               
               
                  This paper introduces the theoretical framework allowing for the binary quantization index modulation (QIM) embedding techniques to be extended towards multiple-symbol QIM (m-QIM, where m stands for the number of symbols on which the mark is encoded prior to its embedding). The underlying detection method is optimized with respect to the minimization of the average error probability, under the hypothesis of white, additive Gaussian behavior for the attacks. This way, for prescribed transparency and robustness constraints, the data payload is increased by a factor of log2
                     m.
                  
                     m-QIM is experimentally validated under the frameworks of the MEDIEVALS French national project and of the SPY ITEA2 European project, related to MPEG-4 AVC robust and semi-fragile watermarking applications, respectively. The experiments are three-folded and consider the data payload–robustness–transparency tradeoff. In the former case, the main benefit is the increase of data payload by a factor of log2
                     m while keeping fixed robustness (variations lower than 3% of the bit error rate after additive noise, transcoding and Stirmark random bending attacks) and transparency (set to average PSNR=45dB and 65dB for SD and HD encoded content, respectively). The experiments consider 1h of video content. In the semi-fragile watermarking case, the m-QIM main advantage is a relative gain factor of 0.11 of PSNR for fixed robustness (against transcoding), fragility (to content alteration) and the data payload. The experiments consider 1h 20min of video content.
               
            

@&#INTRODUCTION@&#

Digital watermarking can be defined as the process of embedding a pattern of information into a cover digital content (image, audio, video, etc.) [1,2], as illustrated in 
                     Fig. 1. While such a procedure can be public, the very insertion of the mark is always controlled by some secret information referred to as a key. Once watermarked, the host data can be transmitted and/or stored in a hostile environment, i.e. in an environment where changes (attacks) attempting to remove the watermark are likely to occur. The subsequent watermark detection can serve to a large variety of applications, from property and/or integrity proof to augmented reality.

Although there are no universal requirements to be satisfied by all watermarking applications, some main directions are generally considered by the research studies [1,2].

In order to be effective, the watermark should be perceptually invisible for a human observer (i.e. the transparency property) and its detection should be successful even when the watermarked content is attacked (i.e. the robustness property). Moreover, it should allow the insertion of the amount of information (referred to as data payload) required by the targeted application (e.g. a serial number identifying a user, a time stamp, etc.). In order for the watermarking techniques to be easily integrated into practical applications, the watermark insertion/detection should be achieved at a low computational cost.

The actual level of each of these four requirements is set according to the targeted application. For instance, let’s consider the two examples of video ownership (e.g. ensure copyright protection) and of video authentication (e.g. ensure video surveillance integrity).

The former example relies on the so-called robust watermarking. Such a system should feature ideal transparency (i.e. human imperceptible visual differences between the original and the marked content) and robustness (i.e. the mark can be successfully recovered after each and every attack which still preserves the commercial value of that content). The mark itself may represent the owner/legal user identity, a time stamp, etc. The latter example can be based on the so-called semi-fragile watermarking, with weaker transparency constraints but with the possibility of discriminating between content-alteration attacks (e.g. object deletion, spatio-temporal cropping, …) which should destroy the mark and mundane video processing applications (noise addition, transcoding, …) which should allow the mark to be detected. The mark carries some content authentication information (a signature).


                     
                     Fig. 2 illustrates the difference between the robust and the semi-fragile watermarking. A frame sampled from the watermarked video is presented in Fig. 2a. Fig. 2b presents a compressed version of the marked frame; the mark should be detected by both robust and semi-fragile watermarking. Assume now the case in which a region in the watermarked and compressed frame was modified by introducing a person (a content alteration attack), as illustrated in Fig. 2c. On the one hand, the robust watermark method should be insensitive to such an attack and the mark should be detected. On the other hand, the semi-fragile watermark should be sensitive to such an attack: the authentication mark should no longer be detected, thus demonstrating the content modification. Real life applications consider more elaborated use-cases, in which the modified area should be discriminated from the genuine one. For instance, out of processing the frame in Fig. 2c, the mark should be detected in area where the content was altered only by compression but not from the area in which the person was added (see the legal/fake areas in Fig. 2d).

In practice, video sequences are stored and distributed in compressed bit stream formats. Consequently, watermarking a video content would require to decode the sequence, then to insert the watermark and, finally, to re-encode that video. Such an approach would result into a large computational time, mainly spent on encoding/decoding. These two operations are intrinsically avoided if the watermarking is performed directly in the compressed video domain.

When approaching the compressed domain watermarking, the main deadlock relates to the conceptual contradiction between compression and watermarking: while watermarking exploits visual redundancy to hide the mark, compression eliminates the same visual redundancy in order to reduce the size of the stream. Therefore, compressed video stream leaves very little (virtually any) space to hide data. The challenge is to embed the prescribed amount of information (set by the targeted application) directly into the compressed stream while maintaining prescribed robustness and transparency levels.

The present paper takes this challenge and advances a theoretical framework for the multi-symbol embedding, based on QIM (quantization index modulation) [3]. In this respect, the insertion rule is extended from a binary alphabet [4] to an m-ary alphabet; the underlying optimal detection rule, in the sense of minimizing the average error in mark detection under additive white Gaussian noise attacks is derived. Hence, it is thus demonstrated that the data payload can be increased by a factor of log2
                     m, for prescribed transparency and additive Gaussian noise power.

The advanced method was experimentally validated under the frameworks of the MEDIEVALS French national project and of the SPY ITEA2 European project, related to robust and semi-fragile watermarking applications, respectively.

The paper has the following structure. Section 2 details the state of the art on compressed domain video watermarking (both robust and semi-fragile). Section 3 presents the advanced m-QIM theoretical framework. Sections 4 and 5 are devoted to the applicative validation for robust and semi-fragile watermarking, respectively. Section 6 concludes the paper and discusses the future work directions.

Current days, a special attention in watermarking is paid to the MPEG-4 Part 10 (a.k.a. MPEG-4 AVC or, alternatively H.264) [5] compressed stream. As its ancestors, this standard contains four basic functions: prediction, transformation, quantization and entropic encoding, denoted in 
                     Fig. 3 by P, T, Q and E, respectively. In order to achieve higher compression efficiency, MPEG-4 AVC deploys particular compression features such as variable block-size motion estimation, directional spatial prediction, DCT (discrete cosine transform) approximation and context-adaptive entropic encoding. Consequently, the watermarking techniques devoted to uncompressed or to earlier compressed domains (MPEG-2 or MPEG-4 Part 2) are likely to fail in reaching the same performances in the MPEG-4 AVC domain and specific methods should be devised in this respect, [4,6–16]. Such different studies cover issues related to both robust [4,6–8] and semi-fragile watermarking systems [9–16]; they are benchmarked in 
                     
                     Tables 1 and 2. Note that two methods reported in the literature as robust [14,16] can be considered, at least from their properties point of view, as semi-fragile.

Golikeri et al. [6] advance a binary QIM (quantization index modulation) watermarking method applied to MPEG-4 AVC DCT coefficients. The watermark is inserted into the perceptual projection (according to a psycho visual mask) of the selected block. Although it is transparent (a value of PSNR=32.4dB) and robust against transcoding and filtering, this method does not meet either the robustness to geometrics attacks or the real time constraints.

In [7], Noorkami et al. present a method devoted to the MPEG-4 AVC stream but performed during the encoding step (hence, the uncompressed data should be available during the insertion). The watermark, a bipolar message, is inserted into the quantized AC coefficients, selected according to a perceptual cost. When compared to the method in [6], this technique increases the data payload to 160bit/min while keeping the same transparency. The experiments show robustness against linear filtering, fragility to geometrical attacks and does not consider transcoding. The watermark insertion during the encoding process makes this method computationally complex.

Zou et al. [8] tackle the issue of watermarking the MPEG-4 AVC stream by a substitution method applied at the stream level. This study demonstrates that such a controlled modification of the stream elements is possible while keeping a transparency expressed by a PSNR=32dB. However, the paper does not evaluate the watermarking system performances.

Belhaj et al. [4] introduce a binary ST-DM for MPEG-4 AVC stream watermarking which combines QIM principles, a new perceptual shaping mechanism devoted to the MPEG-4 AVC syntax peculiarities, and an information-theory driven selection criterion. This way, a transparency expressed by a PSNR=42dB and a NCC=0.99 is obtained. The robustness was checked against transcoding and random geometric attacks (BER lower than 10%). The data payload is 279bit/5min of video.

Xu and Wang [9] perform the watermarking at the MPEG-4 AVC entropic encoding level. In this respect, the Exp-Golomb code elements which are eligible to be watermarked without destroying the stream synchronization are first detected. Then, a mapping rule between these elements and the watermark bits is established. The detection is performed by directly parsing the Exp-Golomb code words of the watermarked stream. The performance evaluations show perfect transparency (no quality degradation being induced) but a total fragility to transcoding.

Kim et al. [10] embed the watermark bits in the motion vectors of the inter blocks or in the intra mode number of the intra blocks. The advanced method features a high data payload with small image quality degradation (a PSNR=40dB is reported). Nevertheless, a large sensitivity to transcoding is featured.

Wang and Hsu [11] present a fragile watermarking algorithm to authenticate MPEG-4 AVC stream. The mark is computed as the MD5 (message digest algorithm) hash function of a random generated binary sequence and embedded by changing the parity of the high-frequency quantized DCT coefficients of I frames. While such a technique provides the ideal case of fragility and features low complexity (only the MPEG-4 AVC entropic decoding being required), it is conceptually unable to make any distinction between mundane and malicious attacks.

Zang and Ho [12] adopt the same principles and insert the mark in the P frames. The overall results show good transparency (PSNR>35dB), a very good sensitivity to spatio-temporal alterations, low complexity but no robustness to content preserving attacks (e.g. transcodage).

Chen and Leung present a semi-fragile watermarking scheme based on chaotic systems for the authentication of individual frames in the MPEG-4 AVC stream [13]. The authentication information is represented by both the GOP index and the frame index in that GOP. This information is modulated in a chaotic signal and inserted in the DCT transformed blocks of each frame by imposing local intensity relationships into a group of adjacent blocks. The insertion requires the entropic decoding, the de-quantizing and the reverse of the prediction operations, thus becoming computationally complex. Experiments carried out on a 795 frames video sequence proved a transparency expressed by a PSNR=40dB and robustness against JPEG compression (quality factor QF of 30) and median filtering. This method also detects the temporal modifications (with one frame accuracy) but the spatial modification properties were not assessed.

Thiemert et al. [14] advance a semi-fragile watermarking system devoted to the MPEG-1/2 video sequences. The mark computation is based on the properties of the entropy computed at the 8×8 block levels. The mark is embedded by enforcing relationship between the DCT coefficients of some blocks. The experiments are run on one sequence (whose length is not précised) encoded at 1125kbps. The method proved both robustness (against JPEG compression with QF=50) and fragility against temporal (with 2 frame accuracy) and spatial (with a non-assessed accuracy) content changing. However, the main drawback of this method remains its inner computation complexity: beyond the complete MPEG decoding/encoding, it also requires sophisticated entropy estimation at frame levels.

Proforck et al. [15] propose an integrity authentication schema of MPEG-4 AVC. The authentication information which consists of the encrypted hash value and a certificate with public key is embedded by reactivating some skipped macroblocks. The advantage of the method is the possibility of erasing the watermark, but the considered hash algorithm increases the computation cost of the scheme. The transparency was evaluated at a PSNR>50dB.

Chen et al. [16] compute the authentication data as the block sub-index. Then, the obtained signature is embedded by modifying the number of nonzero DCT AC coefficients of I frames. The experimental results show that the proposed system can detect the illegally altered area. However, neither the transparency nor the robustness against non malicious alteration has been evaluated.


                        Tables 1 and 2 show that the large variety of state of-the-art methods allow each particular constraint (transparency, robustness, data payload, computational cost) to be individually reached for particular applications. However, none of these studies is able to jointly reach these four requirements. For instance, for the robust watermarking, the method in [4], based on binary QIM, seems to provide the best robustness, transparency and computational trade off but leaves room for data payload improvement. Moreover, to the best of our knowledge, no watermarking method is able today to serve both the purposes of robust and semi-fragile watermarking.

Our previous studies [17–19] represent some first steps in this respect: they followed an application oriented approach and brought to light the utility of m-QIM for increasing the data payload with respect to the QIM methods. These studies are resumed and extended in the present paper. The m-QIM theoretical framework is first advanced. Then, its performances are evaluated under the frameworks of the MEDIEVALS French national project (robust watermarking) and of the SPY ITEA2 European project (semi-fragile watermarking).

Consider the case in which some binary information 
                           α
                           =
                           0.84
                         is to be inserted in some (floating point) original data 
                           Δ
                           =
                           70
                         by means of binary QIM methods [6,4]. To do so, x is quantized using multiple quantizers whose indexes are chosen based on the message to be embedded [3].

To implement such quantizers, dither modulation (DM) can be used [3], thus obtaining the watermarked signal 
                           y
                        :
                           
                              (1)
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                q
                                                =
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      Δ
                                                   
                                                
                                                (
                                                x
                                                −
                                                Δ
                                                (
                                                b
                                                /
                                                2
                                                +
                                                k
                                                )
                                                )
                                                −
                                                (
                                                x
                                                −
                                                Δ
                                                (
                                                b
                                                /
                                                2
                                                +
                                                k
                                                )
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                y
                                                =
                                                x
                                                +
                                                α
                                                q
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           Δ
                         is a fixed quantization step size, 
                           k
                         a random key (sampled from a white, uniform noise, 
                           0
                           <
                           k
                           ≤
                           1
                        ) and 
                           α
                         a fixed parameter, 
                           0
                           <
                           α
                           ≤
                           1
                        .

The quantizer 
                           
                              
                                 Q
                              
                              
                                 Δ
                              
                           
                         is defined as follows:
                           
                              (2)
                              
                                 
                                    
                                       Q
                                    
                                    
                                       Δ
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 Δ
                                 Round
                                 (
                                 x
                                 /
                                 Δ
                                 )
                              
                           
                        where 
                           Round
                           (
                           )
                         is the approximation to the closest integer.

The practical balance between the transparency and the robustness can be reached by adjusting the 
                           α
                         and 
                           Δ
                         parameters: the lower the 
                           α
                         and 
                           Δ
                         values, the lower the difference between 
                           x
                         and 
                           y
                         and, consequently, the greater the transparency but the worse the robustness.

At the decoder, the embedded message bits are recovered by a scalar quantization of the received signal sample r which represents the y signal after its corruption by attacks.

The Y (b) decision variable is computed as follows [3,4]:
                           
                              (3)
                              
                                 Y
                                 (
                                 b
                                 )
                                 =
                                 
                                    
                                       Q
                                    
                                    
                                       Δ
                                    
                                 
                                 (
                                 r
                                 −
                                 k
                                 Δ
                                 )
                                 −
                                 r
                                 +
                                 k
                                 Δ
                              
                           
                        
                     

The aim is to decide whether the inserted bit was 
                           b
                           =
                           0
                         or 
                           b
                           =
                           1
                        . The optimal decision rule, assuming the attacks are modelled by additive white Gaussian noise is (see 
                        Fig. 4) [3]:
                           
                              (4)
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   |
                                                   
                                                      Y
                                                      (
                                                      b
                                                      )
                                                   
                                                   |
                                                
                                                <
                                                (
                                                1
                                                −
                                                α
                                                )
                                                Δ
                                                /
                                                2
                                                
                                                
                                                →
                                                
                                                
                                                   b
                                                   ^
                                                
                                                
                                                =
                                                0
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   |
                                                   
                                                      Y
                                                      (
                                                      b
                                                      )
                                                   
                                                   |
                                                
                                                ≥
                                                (
                                                1
                                                −
                                                α
                                                )
                                                
                                                Δ
                                                /
                                                2
                                                
                                                →
                                                
                                                
                                                
                                                   b
                                                   ^
                                                
                                                =
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In order to generalize the insertion technique, be there the same binary message 
                              b
                            to be inserted in the same original data 
                              x
                           .

Prior to its insertion, the message 
                              b
                            is encoded into a message 
                              d
                            belonging to an m-ary alphabet 
                              D
                           ; assuming 
                              m
                            is an odd value
                              
                                 
                                    D
                                    =
                                    
                                    
                                       {
                                       
                                          −
                                          
                                             
                                                m
                                                −
                                                1
                                             
                                             2
                                          
                                          ,
                                          
                                          
                                          −
                                          
                                             
                                                m
                                                −
                                                2
                                             
                                             2
                                          
                                          ,
                                          
                                          …
                                          
                                          
                                          0
                                          ,
                                          
                                          
                                          …
                                          
                                          
                                             
                                                m
                                                −
                                                2
                                             
                                             2
                                          
                                          ,
                                          
                                          
                                             
                                                m
                                                −
                                                1
                                             
                                             2
                                          
                                       
                                       }
                                    
                                    .
                                 
                              
                           
                        

On average, each 
                              d
                            symbol corresponds to 
                              
                                 
                                    log
                                 
                                 
                                    2
                                 
                              
                              m
                            bits from the message 
                              b
                            
                           [20].

By following the principles above, the m-QIM insertion can be expressed as
                              
                                 (5)
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                   =
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         Δ
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         −
                                                         Δ
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     d
                                                                     m
                                                                  
                                                               
                                                               +
                                                               k
                                                            
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         x
                                                         −
                                                         Δ
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     d
                                                                     m
                                                                  
                                                               
                                                               +
                                                               k
                                                            
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   y
                                                   =
                                                   x
                                                   +
                                                   α
                                                   q
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           as in the binary case, the lower the 
                              α
                            and the 
                              Δ
                           , the lower the difference between 
                              x
                            and 
                              y
                            and the greater the transparency but the worse the robustness. However, this time, each 
                              x
                            sample bears one 
                              d
                            
                           m-ary symbol, thus increasing the data payload by a factor of 
                              
                                 
                                    log
                                 
                                 
                                    2
                                 
                              
                              m
                           , with respect to the binary case.

While keeping practically the same insertion rule, see (1) vs. (5), the multi-symbol generalisation requires the modification of the decision rule. In the present paper, a decision rule minimising the probability error in mark detection under the white additive Gaussian noise hypothesis is derived.

Let us consider first the case in which no attack occurs. The decision is based on the value of the 
                              Y
                              (
                              d
                              )
                            variable
                              
                                 (6)
                                 
                                    Y
                                    (
                                    d
                                    )
                                    =
                                    
                                       
                                          Q
                                       
                                       
                                          Δ
                                       
                                    
                                    (
                                    x
                                    +
                                    α
                                    q
                                    −
                                    k
                                    Δ
                                    )
                                    −
                                    (
                                    x
                                    +
                                    α
                                    q
                                    −
                                    k
                                    Δ
                                    )
                                 
                              
                           
                           
                              Y
                              (
                              d
                              )
                            is a quantization error belonging to the 
                              [
                              
                                 −
                                 
                                    Δ
                                    /
                                    2
                                 
                                 ;
                                 
                                    Δ
                                    /
                                    2
                                 
                              
                              ]
                            interval. Hence, specifying a decision rule means to divide the decision region 
                              [
                              
                                 −
                                 
                                    Δ
                                    /
                                    2
                                 
                                 ;
                                 
                                    Δ
                                    /
                                    2
                                 
                              
                              ]
                            into m non-overlapping intervals. These intervals are computed based on a three-steps development presented below. First, the 
                              Y
                              (
                              d
                              )
                            expression is reformulated so as to no longer depend on the original data 
                              x
                           . Second, the decision intervals are computed by expressing the quantization error as a function of 
                              α
                           , 
                              d
                           , 
                              m
                            and 
                              Δ
                           . Finally, the value of the 
                              α
                            parameter ensuring non-overlapping intervals is computed.

Step 1: 
                              Y
                              (
                              d
                              )
                            reformulation.

We denote: 
                              A
                              =
                              x
                              −
                              Δ
                              (
                              d
                              /
                              m
                              +
                              k
                              )
                            and 
                              B
                              =
                              x
                              +
                              α
                              q
                              −
                              k
                              Δ
                           .

The expression of 
                              A
                            as a function of 
                              B
                            is obtained as follows:
                              
                                 (7)
                                 
                                    
                                       
                                          
                                             B
                                             =
                                             x
                                             +
                                             α
                                             
                                                (
                                                
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         Δ
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         −
                                                         Δ
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     d
                                                                     m
                                                                  
                                                               
                                                               +
                                                               k
                                                            
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         x
                                                         −
                                                         Δ
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     d
                                                                     m
                                                                  
                                                               
                                                               +
                                                               k
                                                            
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                
                                                )
                                             
                                             −
                                             k
                                             Δ
                                          
                                       
                                       
                                          
                                             =
                                             x
                                             +
                                             α
                                             
                                                
                                                   Q
                                                
                                                
                                                   Δ
                                                
                                             
                                             (
                                             A
                                             )
                                             −
                                             α
                                             
                                                (
                                                
                                                   x
                                                   −
                                                   Δ
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               d
                                                               m
                                                            
                                                         
                                                         +
                                                         k
                                                      
                                                      )
                                                   
                                                
                                                )
                                             
                                             −
                                             k
                                             Δ
                                             
                                          
                                       
                                       
                                          
                                             =
                                             (
                                             1
                                             −
                                             α
                                             )
                                             (
                                             A
                                             −
                                             
                                                
                                                   Q
                                                
                                                
                                                   Δ
                                                
                                             
                                             (
                                             A
                                             )
                                             )
                                             +
                                             
                                                
                                                   Q
                                                
                                                
                                                   Δ
                                                
                                             
                                             (
                                             A
                                             )
                                             +
                                             Δ
                                             
                                                
                                                   d
                                                   m
                                                
                                             
                                             =
                                             (
                                             α
                                             −
                                             1
                                             )
                                             q
                                             +
                                             
                                                
                                                   Q
                                                
                                                
                                                   Δ
                                                
                                             
                                             (
                                             A
                                             )
                                             +
                                             Δ
                                             
                                                
                                                   d
                                                   m
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Then, 
                              Y
                              (
                              d
                              )
                            can be written as follows:
                              
                                 
                                    
                                       
                                          
                                             Y
                                             (
                                             d
                                             )
                                             =
                                             
                                                
                                                   Q
                                                
                                                
                                                   Δ
                                                
                                             
                                             (
                                             B
                                             (
                                             d
                                             )
                                             )
                                             −
                                             B
                                             (
                                             d
                                             )
                                             
                                          
                                       
                                       
                                          
                                             
                                             =
                                             
                                                
                                                   Q
                                                
                                                
                                                   Δ
                                                
                                             
                                             
                                                (
                                                
                                                   (
                                                   α
                                                   −
                                                   1
                                                   )
                                                   q
                                                   +
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         Δ
                                                      
                                                   
                                                   (
                                                   A
                                                   )
                                                   +
                                                   Δ
                                                   
                                                      
                                                         d
                                                         m
                                                      
                                                   
                                                
                                                )
                                             
                                             −
                                             (
                                             α
                                             −
                                             1
                                             )
                                             q
                                             −
                                             
                                                
                                                   Q
                                                
                                                
                                                   Δ
                                                
                                             
                                             (
                                             A
                                             )
                                             −
                                             Δ
                                             
                                                
                                                   d
                                                   m
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           as 
                              
                                 
                                    Q
                                 
                                 
                                    Δ
                                 
                              
                            is by its definition a multiple of 
                              Δ
                           , 
                              Y
                              (
                              d
                              )
                            can be simplified as follows:
                              
                                 
                                    Y
                                    (
                                    d
                                    )
                                    =
                                    
                                       
                                          Q
                                       
                                       
                                          Δ
                                       
                                    
                                    
                                       (
                                       
                                          (
                                          α
                                          −
                                          1
                                          )
                                          q
                                          +
                                          Δ
                                          
                                             
                                                d
                                                m
                                             
                                          
                                       
                                       )
                                    
                                    −
                                    (
                                    α
                                    −
                                    1
                                    )
                                    q
                                    −
                                    Δ
                                    
                                       
                                          d
                                          m
                                       
                                    
                                 
                              
                           
                        

Let 
                              C
                              (
                              d
                              )
                              =
                              (
                              α
                              −
                              1
                              )
                              q
                              +
                              Δ
                              d
                              /
                              m
                            then
                              
                                 (8)
                                 
                                    Y
                                    (
                                    d
                                    )
                                    =
                                    
                                       
                                          Q
                                       
                                       
                                          Δ
                                       
                                    
                                    (
                                    C
                                    (
                                    d
                                    )
                                    )
                                    −
                                    C
                                    (
                                    d
                                    )
                                 
                              
                           
                        

Note that while (6) and (8) are equivalent from the mathematical point of view, the right-hand term of (8) does no longer depend on the original (unmarked) data 
                              x
                           .

Step 2: Decision intervals as a function of 
                              α
                           , 
                              d
                           , 
                              m
                            and 
                              Δ
                           .

We have 
                              −
                              Δ
                              /
                              2
                              <
                              q
                              <
                              Δ
                              /
                              2
                            and 
                              0
                              <
                              α
                              ≤
                              1
                           ; this implies
                              
                                 (9)
                                 
                                    Δ
                                    (
                                    (
                                    α
                                    −
                                    1
                                    )
                                    m
                                    +
                                    2
                                    d
                                    )
                                    /
                                    2
                                    m
                                    <
                                    C
                                    (
                                    d
                                    )
                                    <
                                    Δ
                                    (
                                    (
                                    1
                                    −
                                    α
                                    )
                                    m
                                    +
                                    2
                                    d
                                    )
                                    /
                                    2
                                    m
                                 
                              
                           
                        

Be there
                              
                                 (10)
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         sup
                                                         ,
                                                         α
                                                      
                                                   
                                                   (
                                                   d
                                                   )
                                                   =
                                                   
                                                      
                                                         Δ
                                                         (
                                                         (
                                                         1
                                                         −
                                                         α
                                                         )
                                                         m
                                                         +
                                                         2
                                                         d
                                                         )
                                                      
                                                      
                                                         2
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         inf
                                                         ,
                                                         α
                                                      
                                                   
                                                   (
                                                   d
                                                   )
                                                   =
                                                   
                                                      
                                                         Δ
                                                         (
                                                         (
                                                         α
                                                         −
                                                         1
                                                         )
                                                         m
                                                         +
                                                         2
                                                         d
                                                         )
                                                      
                                                      
                                                         2
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

From Eqs. (5) and (6) we obtain
                              
                                 (11)
                                 
                                    −
                                    
                                       
                                          I
                                       
                                       
                                          sup
                                          ,
                                          α
                                       
                                    
                                    (
                                    d
                                    )
                                    +
                                    
                                       
                                          Q
                                       
                                       
                                          Δ
                                       
                                    
                                    (
                                    C
                                    (
                                    d
                                    )
                                    )
                                    <
                                    Y
                                    (
                                    d
                                    )
                                    <
                                    −
                                    
                                       
                                          I
                                       
                                       
                                          inf
                                          ,
                                          α
                                       
                                    
                                    (
                                    d
                                    )
                                    +
                                    
                                       
                                          Q
                                       
                                       
                                          Δ
                                       
                                    
                                    (
                                    C
                                    (
                                    d
                                    )
                                    )
                                 
                              
                           
                           
                              
                                 
                                    Q
                                 
                                 
                                    Δ
                                 
                              
                              (
                              C
                              (
                              d
                              )
                              )
                            is the quantized value of 
                              C
                              (
                              d
                              )
                            with quantization step 
                              Δ
                           ; hence
                              
                                 (12)
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         Δ
                                                      
                                                   
                                                   (
                                                   C
                                                   (
                                                   d
                                                   )
                                                   )
                                                   =
                                                   l
                                                   Δ
                                                   ,
                                                   
                                                   l
                                                   ∈
                                                   Z
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         l
                                                         −
                                                         
                                                            
                                                               1
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   Δ
                                                   ≤
                                                   C
                                                   (
                                                   d
                                                   )
                                                   <
                                                   
                                                      (
                                                      
                                                         l
                                                         +
                                                         
                                                            
                                                               1
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   Δ
                                                
                                             
                                          
                                       
                                       
                                    
                                 
                              
                           
                        

Eqs. (9) and (12) imply
                              
                                 (13)
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         (
                                                         1
                                                         −
                                                         α
                                                         )
                                                         m
                                                         +
                                                         2
                                                         d
                                                         )
                                                      
                                                      
                                                         2
                                                         m
                                                      
                                                   
                                                   <
                                                   l
                                                   +
                                                   1
                                                   /
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         (
                                                         α
                                                         −
                                                         1
                                                         )
                                                         m
                                                         +
                                                         2
                                                         d
                                                         )
                                                      
                                                      
                                                         2
                                                         m
                                                      
                                                   
                                                   >
                                                   l
                                                   −
                                                   1
                                                   /
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           as 
                              d
                            is a symbol from the m-ary alphabet D, we have
                              
                                 
                                    |
                                    d
                                    |
                                    ≤
                                    (
                                    m
                                    −
                                    1
                                    )
                                    /
                                    2
                                 
                              
                           
                        

Hence, Eq. (13) gives
                              
                                 (14)
                                 
                                    |
                                    l
                                    |
                                    <
                                    
                                       
                                          |
                                          (
                                          m
                                          −
                                          1
                                          )
                                          /
                                          m
                                          −
                                          α
                                          |
                                       
                                       2
                                    
                                 
                              
                           then: 
                              l
                              =
                              0
                            and consequently 
                              
                              
                                 
                                    Q
                                 
                                 
                                    Δ
                                 
                              
                              (
                              C
                              (
                              d
                              )
                              )
                              =
                              0
                           . According to (10) we get
                              
                                 (15)
                                 
                                    −
                                    
                                       
                                          I
                                       
                                       
                                          sup
                                          ,
                                          α
                                       
                                    
                                    (
                                    d
                                    )
                                    ≤
                                    Y
                                    (
                                    d
                                    )
                                    ≤
                                    −
                                    
                                       
                                          I
                                       
                                       
                                          inf
                                          ,
                                          α
                                       
                                    
                                    (
                                    d
                                    )
                                    
                                 
                              
                           Eq. (15) demonstrates that the insertion of the 
                              d
                            symbol results in 
                              Y
                              (
                              d
                              )
                            values belonging to the 
                              [
                              
                                 
                                    
                                       
                                          −
                                          
                                             
                                                I
                                             
                                             
                                                sup
                                                ,
                                                α
                                             
                                          
                                          
                                             (
                                             d
                                             )
                                          
                                       
                                    
                                    
                                       
                                          −
                                          
                                             
                                                I
                                             
                                             
                                                inf
                                                ,
                                                α
                                             
                                          
                                          
                                             (
                                             d
                                             )
                                          
                                       
                                    
                                 
                              
                              ]
                            interval. 
                              
                                 
                                    I
                                 
                                 
                                    α
                                 
                              
                              (
                              d
                              )
                            depends on 
                              Δ
                           , 
                              α
                           , and 
                              m
                           : while 
                              Δ
                            and 
                              m
                            are fixed for an application, 
                              α
                            is a parameter which can be chosen so as to ensure non-overleaping decision intervals.

Step 3: Computing the optimal 
                              α
                            value.

For a fixed value of 
                              α
                            parameter, 
                              
                                 
                                    I
                                 
                                 
                                    sup
                                    ,
                                    α
                                 
                              
                            and 
                              
                                 
                                    I
                                 
                                 
                                    inf
                                    ,
                                    α
                                 
                              
                            defined in Eq. (10) are positive slope affine functions, i.e. increasing functions of 
                              d
                           . Hence, if each two successive symbols (d, d+1) have non-overlapping decision intervals, then we will have m non-overlapping decision intervals
                              
                                 
                                    
                                       
                                          I
                                       
                                       
                                          sup
                                          ,
                                          α
                                       
                                    
                                    (
                                    d
                                    )
                                    −
                                    
                                       
                                          I
                                       
                                       
                                          inf
                                          ,
                                          α
                                       
                                    
                                    (
                                    d
                                    +
                                    1
                                    )
                                    ≤
                                    0
                                 
                              
                           
                        

This yields to
                              
                                 (16)
                                 
                                    
                                       
                                          Δ
                                          (
                                          (
                                          α
                                          −
                                          1
                                          )
                                          m
                                          +
                                          2
                                          d
                                          )
                                       
                                       
                                          2
                                          m
                                       
                                    
                                    
                                    −
                                    
                                    
                                       
                                          Δ
                                          (
                                          (
                                          1
                                          −
                                          α
                                          )
                                          m
                                          +
                                          2
                                          (
                                          d
                                          +
                                          1
                                          )
                                          )
                                       
                                       
                                          2
                                          m
                                       
                                    
                                    ≤
                                    0
                                 
                              
                           Eq. (16) implies that the condition for obtaining non-overleaping 
                              
                                 
                                    I
                                 
                                 
                                    α
                                 
                              
                              (
                              d
                              )
                            intervals is 
                              
                              α
                              ≥
                              (
                              m
                              −
                              1
                              )
                              /
                              m
                           ; be 
                              
                                 
                                    α
                                 
                                 ⁎
                              
                              =
                              (
                              m
                              −
                              1
                              )
                              /
                              m
                           . The influence of 
                              α
                            on the 
                              
                                 
                                    I
                                 
                                 
                                    α
                                 
                              
                              (
                              d
                              )
                            intervals is illustrated in 
                           Fig. 5 for 
                              m
                              =
                              5
                            (hence, 
                              
                                 
                                    α
                                 
                                 ⁎
                              
                              =
                              0.8
                           ) and 
                              Δ
                              =
                              70
                           . Three particular cases are considered, namely 
                              α
                              =
                              0.76
                              <
                              
                                 
                                    α
                                 
                                 ⁎
                              
                            (see Fig. 5 up-left), 
                              α
                              =
                              0.8
                              =
                              
                                 
                                    α
                                 
                                 ⁎
                              
                            (see Fig. 5 up-right) and 
                              α
                              =
                              0.84
                              >
                              
                                 
                                    α
                                 
                                 ⁎
                              
                            (see Fig. 5 bottom). In these three plots, the abscissa corresponds to the value of 
                              d
                           , while the ordinate stands for the 
                              
                                 
                                    I
                                 
                                 
                                    inf
                                    ,
                                    
                                    
                                    α
                                 
                              
                            (in blue diamond) and 
                              
                                 
                                    I
                                 
                                 
                                    sup
                                    ,
                                    α
                                 
                              
                            (in red square).

The 
                              
                                 
                                    α
                                 
                                 ⁎
                              
                            can be considered as the optimal 
                              α
                            value for computing the decision intervals: it ensures non-overlapping intervals (hence ideal robustness, assuming no attack occurs) and the best transparency (the minimal differences between the host and the marked signals). Consequently, the optimal decision rule associates to each inserted 
                              d
                            symbol a detection interval 
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          α
                                       
                                       ⁎
                                    
                                 
                              
                              
                              (
                              d
                              )
                              =
                              [
                              
                                 
                                    
                                       
                                          −
                                          
                                             
                                                I
                                             
                                             
                                                sup
                                                ,
                                                
                                                   
                                                      α
                                                   
                                                   ⁎
                                                
                                             
                                          
                                          (
                                          d
                                          )
                                       
                                    
                                    
                                       
                                          −
                                          
                                             
                                                I
                                             
                                             
                                                inf
                                                ,
                                                
                                                   
                                                      α
                                                   
                                                   ⁎
                                                
                                             
                                          
                                          (
                                          d
                                          )
                                       
                                    
                                 
                              
                              ]
                           . In other words, when a particular 
                              Y
                              (
                              d
                              )
                            value is computed at the watermarking detection side, we decide that the inserted symbol was 
                              
                                 d
                                 ^
                              
                           , where
                              
                                 (17)
                                 
                                    if
                                    
                                    
                                    Y
                                    (
                                    d
                                    )
                                    ∈
                                    
                                       
                                          I
                                       
                                       
                                          
                                             
                                                α
                                             
                                             ⁎
                                          
                                       
                                    
                                    (
                                    
                                       d
                                       ^
                                    
                                    )
                                    =
                                    >
                                    d
                                    =
                                    
                                       d
                                       ^
                                    
                                 
                              
                           
                        

Assume now the case in which the attacks are present: the insertion of a 
                              d
                            symbol can result now in a value 
                              Y
                              (
                              d
                              )
                            outside the 
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          α
                                       
                                       ⁎
                                    
                                 
                              
                            interval. Intuitively, in order to decrease the errors induced by such a situation, a value 
                              α
                              >
                              
                                 
                                    α
                                 
                                 ⁎
                              
                            should be considered at insertion/detection, i.e. a lower transparency should be accepted in order to grant some additional robustness against attacks, see Fig. 5. The 
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          α
                                       
                                       ⁎
                                    
                                 
                              
                            and 
                              
                                 
                                    I
                                 
                                 
                                    α
                                 
                              
                            obtained for m=5 (hence 
                              
                                 
                                    α
                                 
                                 ⁎
                              
                              =
                              0.84
                           ), 
                              α
                              =
                              0.84
                            and 
                              Δ
                              =
                              70
                            are illustrated in 
                           Fig. 6.

As usual in the watermarking studies [21], we shall assume that the attacks are independent with respect to the inserted symbol and that they can be modelled by a white, Gaussian noise which is added to the 
                              Y
                              (
                              d
                              )
                            value computed for a fixed 
                              α
                              >
                              
                                 
                                    α
                                 
                                 ⁎
                              
                            parameter; the 
                              
                                 Y
                                 ˜
                              
                              (
                              d
                              )
                            variable becomes
                              
                                 
                                    
                                       Y
                                       ˜
                                    
                                    (
                                    d
                                    )
                                    =
                                    Y
                                    (
                                    d
                                    )
                                    +
                                    n
                                 
                              
                           
                           
                              
                                 Y
                                 ˜
                              
                              (
                              d
                              )
                            can fall between two 
                              
                                 
                                    I
                                 
                                 
                                    α
                                 
                              
                              (
                              d
                              )
                            decision regions or even outside the 
                              [
                              
                                 −
                                 
                                    Δ
                                    2
                                 
                                 ;
                                 
                                    Δ
                                    2
                                 
                              
                              ]
                            interval. Consequently, the optimal decision rule defined in Eqs. (6) and (17) should be extended so as to cope with such a situation, as follows. First, although the insertion is performed for an 
                              α
                              >
                              
                                 
                                    α
                                 
                                 ⁎
                              
                            value, the decision regions will be computed on the 
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          α
                                       
                                       ⁎
                                    
                                 
                              
                            basis: this way, all the values inside the 
                              [
                              
                                 −
                                 
                                    Δ
                                    2
                                 
                                 ;
                                 
                                    Δ
                                    2
                                 
                              
                              ]
                            are considered. Moreover, in order to avoid the cases in which 
                              
                                 Y
                                 ˜
                              
                              (
                              d
                              )
                            would fall outside the 
                              [
                              
                                 −
                                 
                                    Δ
                                    2
                                 
                                 ;
                                 
                                    Δ
                                    2
                                 
                              
                              ]
                            interval, a modulo operator is applied prior to the detection. The corresponding decision variable 
                              
                                 
                                    
                                       Y
                                       ˜
                                    
                                 
                                 
                                    Δ
                                 
                              
                              (
                              d
                              )
                            and the underlying decision rule are
                              
                                 (18)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Y
                                                      ˜
                                                   
                                                
                                                
                                                   Δ
                                                
                                             
                                             (
                                             d
                                             )
                                             =
                                             
                                                Y
                                                ˜
                                             
                                             (
                                             d
                                             )
                                             modulo
                                             
                                             
                                             Δ
                                             −
                                             
                                                Δ
                                                2
                                             
                                          
                                       
                                       
                                          
                                             if
                                             
                                             
                                             
                                                
                                                   
                                                      Y
                                                      ˜
                                                   
                                                
                                                
                                                   Δ
                                                
                                             
                                             (
                                             d
                                             )
                                             ∈
                                             
                                                
                                                   I
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      ⁎
                                                   
                                                
                                             
                                             (
                                             
                                                d
                                                ^
                                             
                                             )
                                             =
                                             
                                             >
                                             d
                                             =
                                             
                                                d
                                                ^
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The error probability associated to the decision rule in Eq. (18) and its optimality are discussed in the following section.

In the sequel, we shall incrementally express the probability density function for the 
                              Y
                              (
                              d
                              )
                           , 
                              
                                 Y
                                 ˜
                              
                              (
                              d
                              )
                            and 
                              
                                 
                                    
                                       Y
                                       ˜
                                    
                                 
                                 
                                    Δ
                                 
                              
                              (
                              d
                              )
                            decision variables.

The 
                              Y
                              (
                              d
                              )
                            variable is computed as the result of a quantization error and belongs to the 
                              
                                 
                                    I
                                 
                                 
                                    α
                                 
                              
                              (
                              d
                              )
                              =
                              [
                              
                                 
                                    
                                       
                                          −
                                          
                                             
                                                I
                                             
                                             
                                                sup
                                                ,
                                                α
                                             
                                          
                                          (
                                          d
                                          )
                                       
                                    
                                    
                                       
                                          −
                                          
                                          
                                             
                                                I
                                             
                                             
                                                inf
                                                ,
                                                α
                                             
                                          
                                          (
                                          d
                                          )
                                       
                                    
                                 
                              
                              ]
                            intervals, cf. (6) and (17). Consequently, the probability density function of the 
                              Y
                              (
                              .
                              )
                            variable conditioned on the insertion of the 
                              Δ
                              =
                              90
                            symbol is denoted by 
                              
                                 
                                    p
                                 
                                 
                                    Y
                                 
                              
                              (
                              u
                              /
                              d
                              )
                            and can be modelled by a uniform law in that interval [20]:
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          Y
                                       
                                    
                                    (
                                    u
                                    /
                                    d
                                    )
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                         
                                                            
                                                               (
                                                               
                                                                  1
                                                                  −
                                                                  α
                                                               
                                                               )
                                                            
                                                            Δ
                                                         
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      if
                                                      u
                                                      ∈
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            α
                                                         
                                                      
                                                      (
                                                      d
                                                      )
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      if
                                                      
                                                      not
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The noise probability density function, denoted by 
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                              
                              (
                              n
                              )
                           , is assumed to follow a normal (Gaussian) law of 
                              μ
                              =
                              0
                            mean and 
                              σ
                            standard deviation
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    n
                                    )
                                    =
                                    
                                       1
                                       
                                          
                                             
                                                2
                                                π
                                             
                                          
                                          σ
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          −
                                          
                                             
                                                n
                                             
                                             2
                                          
                                          /
                                          2
                                          
                                             
                                                σ
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        

As 
                              
                                 Y
                                 ˜
                              
                              (
                              d
                              )
                              =
                              Y
                              (
                              d
                              )
                              +
                              n
                           , its probability density function conditioned on the insertion of the 
                              d
                            symbol can be expressed as the convolution between the 
                              
                                 
                                    p
                                 
                                 
                                    Y
                                 
                              
                              (
                              y
                              /
                              d
                              )
                            and 
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                              
                              (
                              n
                              )
                           
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          
                                             Y
                                             ˜
                                          
                                       
                                    
                                    (
                                    y
                                    /
                                    d
                                    )
                                    =
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          Y
                                       
                                    
                                    (
                                    u
                                    /
                                    d
                                    )
                                    ⊗
                                    
                                       
                                          p
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    n
                                    )
                                    )
                                    (
                                    y
                                    )
                                    =
                                    
                                       1
                                       
                                          (
                                          1
                                          −
                                          α
                                          )
                                          Δ
                                       
                                    
                                    
                                       ∫
                                       
                                          −
                                          
                                             
                                                I
                                             
                                             
                                                sup
                                                ,
                                                α
                                             
                                          
                                          (
                                          d
                                          )
                                       
                                       
                                          −
                                          
                                          
                                             
                                                I
                                             
                                             
                                                inf
                                                ,
                                                α
                                             
                                          
                                          (
                                          d
                                          )
                                       
                                    
                                    
                                       1
                                       
                                          
                                             
                                                2
                                                π
                                             
                                          
                                          σ
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          −
                                          
                                             
                                                (
                                                y
                                                −
                                                t
                                                )
                                             
                                             2
                                          
                                          /
                                          2
                                          
                                             
                                                σ
                                             
                                             2
                                          
                                       
                                    
                                    d
                                    t
                                 
                              
                           
                        

Thus, 
                              
                                 
                                    p
                                 
                                 
                                    
                                       Y
                                       ˜
                                    
                                 
                              
                              (
                              y
                              /
                              d
                              )
                            can be expressed by using the 
                              erfc
                            function
                              
                                 (19)
                                 
                                    
                                       
                                          p
                                       
                                       
                                          
                                             Y
                                             ˜
                                          
                                       
                                    
                                    (
                                    y
                                    /
                                    d
                                    )
                                    =
                                    
                                       1
                                       
                                          2
                                          (
                                          1
                                          −
                                          α
                                          )
                                          Δ
                                       
                                    
                                    
                                       (
                                       
                                          erfc
                                          
                                             (
                                             
                                                −
                                                
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            sup
                                                            ,
                                                            α
                                                         
                                                      
                                                      (
                                                      d
                                                      )
                                                      +
                                                      y
                                                   
                                                   
                                                      
                                                         2
                                                      
                                                      σ
                                                   
                                                
                                             
                                             )
                                          
                                          −
                                          erfc
                                          
                                             (
                                             
                                                −
                                                
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            inf
                                                            ,
                                                            α
                                                         
                                                      
                                                      (
                                                      d
                                                      )
                                                      +
                                                      y
                                                   
                                                   
                                                      
                                                         2
                                                      
                                                      σ
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       )
                                    
                                 
                              
                           where 
                              erfc
                              (
                              ⋅
                              )
                            is the complementary error function function defined by
                              
                                 
                                    erfc
                                    (
                                    x
                                    )
                                    =
                                    
                                       2
                                       
                                          
                                             π
                                          
                                       
                                    
                                    
                                       ∫
                                       x
                                       ∞
                                    
                                    
                                       
                                          e
                                       
                                       
                                          −
                                          
                                             
                                                t
                                             
                                             2
                                          
                                       
                                    
                                    d
                                    t
                                 
                              
                           
                        

As 
                              
                                 
                                    
                                       Y
                                       ˜
                                    
                                 
                                 
                                    Δ
                                 
                              
                              (
                              d
                              )
                              =
                              
                                 Y
                                 ˜
                              
                              (
                              d
                              )
                              modulo
                              
                              
                              Δ
                              −
                              Δ
                              /
                              2
                              
                           , its conditional probability on the insertion of the 
                              d
                            symbol was computed in our study from the 
                              
                                 
                                    p
                                 
                                 
                                    
                                       Y
                                       ˜
                                    
                                 
                              
                              (
                              y
                              /
                              d
                              )
                           , by following basic principles in non-linear random variable filtering:
                              
                                 (20)
                                 
                                    
                                       
                                          p
                                       
                                       
                                          
                                             
                                                
                                                   Y
                                                   ˜
                                                
                                             
                                             
                                                Δ
                                             
                                          
                                       
                                    
                                    (
                                    y
                                    /
                                    d
                                    )
                                    =
                                    
                                       ∑
                                       i
                                    
                                    
                                       
                                          p
                                       
                                       
                                          
                                             Y
                                             ˜
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      i
                                                      Δ
                                                   
                                                   2
                                                
                                                +
                                                y
                                             
                                             )
                                          
                                          /
                                          d
                                       
                                       )
                                    
                                    ,
                                    
                                    
                                    i
                                    =
                                    2
                                    j
                                    +
                                    1
                                    ,
                                    
                                    
                                    j
                                    ∈
                                    Z
                                 
                              
                           Eqs. (19) and (20) show that irrespective to the 
                              d
                            symbol, 
                              
                                 
                                    p
                                 
                                 
                                    
                                       
                                          
                                             Y
                                             ˜
                                          
                                       
                                       
                                          Δ
                                       
                                    
                                 
                              
                              (
                              y
                              /
                              d
                              )
                            has a maximal value corresponding the centre of the 
                              
                                 
                                    I
                                 
                                 
                                    α
                                 
                              
                              (
                              d
                              )
                            and symmetrically decreases from that point, as illustrated in 
                           Fig. 7 for 
                              m
                              =
                              5
                           , 
                              Δ
                              
                              =
                              70
                            and 
                              α
                              =
                              0.84
                           .

In its widest acceptation, specifying a decision rule means to define a partition of the interval in which the detection variable takes values [21]. In the m-QIM case, this means to define a partition 
                              
                                 
                                    Δ
                                 
                                 
                                    i
                                 
                              
                           , 
                              i
                              ∈
                              {
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              m
                              −
                              1
                              }
                            of the 
                              [
                              −
                              Δ
                              /
                              2
                              ,
                              
                              Δ
                              /
                              2
                              ]
                            interval
                              
                                 (21)
                                 
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          Δ
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    [
                                    −
                                    Δ
                                    /
                                    2
                                    ,
                                    
                                    Δ
                                    /
                                    2
                                    ]
                                    
                                    and
                                    
                                    
                                       
                                          ∩
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          Δ
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    ∅
                                 
                              
                           
                        

Consider now the case in which a symbol 
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                            is inserted. A correct decision is made when the 
                              
                                 
                                    
                                       Y
                                       ˜
                                    
                                 
                                 
                                    Δ
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              )
                            variable belongs to the 
                              
                                 
                                    Δ
                                 
                                 
                                    i
                                 
                              
                            interval. On the contrarily, an error occurs when the attacks act in such a way that the 
                              
                                 
                                    
                                       Y
                                       ˜
                                    
                                 
                                 
                                    Δ
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              )
                            variable belongs to a 
                              
                                 
                                    Δ
                                 
                                 
                                    j
                                 
                              
                           , with 
                              i
                              ≠
                              j
                           ; 
                              i
                              ,
                              
                              j
                              ∈
                              {
                              0
                              ,
                              
                              1
                              ,
                              
                              …
                              ,
                              
                              m
                              −
                              1
                              }
                           .


                           
                           Table 3 illustrates the correct/erred decisions for 
                              m
                              =
                              5
                           : the rows correspond to the inserted symbols, while the columns to the decision; C stands for a correct decision while E stands for an erred decision.

The probability of the correct decision when inserting the 
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                            symbol is denoted by 
                              
                                 
                                    P
                                 
                                 
                                    c
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                           ) and can be computed as follows:
                              
                                 (22)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          c
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    
                                       ∫
                                       
                                          
                                          
                                             
                                                Δ
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          
                                             
                                                
                                                   Y
                                                   ˜
                                                
                                             
                                             
                                                Δ
                                             
                                          
                                       
                                    
                                    (
                                    y
                                    /
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    d
                                    y
                                 
                              
                           
                        

The average probability of a correct decision is denoted by 
                              
                                 
                                    P
                                 
                                 
                                    c
                                 
                              
                            and can be computed by averaging the 
                              
                                 
                                    P
                                 
                                 
                                    c
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              )
                            values
                              
                                 (23)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          c
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          
                                             
                                                d
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    P
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    
                                       
                                          P
                                       
                                       
                                          c
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              
                           The optimal detection rule should ensure the maximal 
                              
                                 
                                    P
                                 
                                 
                                    c
                                 
                              
                            value over all possible 
                              
                                 
                                    Δ
                                 
                                 
                                    i
                                 
                              
                            partitions of the 
                              [
                              −
                              Δ
                              /
                              2
                              ,
                              
                              Δ
                              /
                              2
                              ]
                            interval.

For watermarking applications, the inserted symbols are equally likely: 
                              P
                              (
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              P
                              (
                              
                                 
                                    d
                                 
                                 
                                    j
                                 
                              
                              )
                           , 
                              i
                              ,
                              j
                              ∈
                              {
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              m
                              −
                              1
                              }
                           . Hence, at the detection side, the probabilities of correct detection of the inserted symbols should also be equal
                              
                                 (24)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          c
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          P
                                       
                                       
                                          c
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    ,
                                    
                                    i
                                    ,
                                    j
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    ,
                                    …
                                    ,
                                    m
                                    −
                                    1
                                    }
                                 
                              
                           
                        

Eqs. (22) and (24) yield to
                              
                                 (25)
                                 
                                    
                                       ∫
                                       
                                          
                                          
                                             
                                                Δ
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          
                                             
                                                
                                                   Y
                                                   ˜
                                                
                                             
                                             
                                                Δ
                                             
                                          
                                       
                                    
                                    (
                                    y
                                    /
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    d
                                    y
                                    =
                                    
                                       ∫
                                       
                                          
                                          
                                             
                                                Δ
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          
                                             
                                                
                                                   Y
                                                   ˜
                                                
                                             
                                             
                                                Δ
                                             
                                          
                                       
                                    
                                    (
                                    y
                                    /
                                    
                                       
                                          d
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    d
                                    y
                                 
                              
                           where 
                              i
                              ,
                              j
                              ∈
                              {
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              m
                              −
                              1
                              }
                           .

Eq. (25) demonstrates that the optimal decision rule should ensure at the same time maximal and equal 
                              
                                 ∫
                                 
                                    
                                    
                                       
                                          Δ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    
                                       
                                          
                                             Y
                                             ˜
                                          
                                       
                                       
                                          Δ
                                       
                                    
                                 
                              
                              (
                              y
                              /
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              )
                              d
                              y
                            values over all possible 
                              
                                 
                                    Δ
                                 
                                 
                                    i
                                 
                              
                            partitions.

When coming now back to the expression of 
                              
                                 
                                    p
                                 
                                 
                                    
                                       
                                          
                                             Y
                                             ˜
                                          
                                       
                                       
                                          Δ
                                       
                                    
                                 
                              
                              (
                              y
                              /
                              d
                              )
                           , see Eq. (20), it can be stated that:
                              
                                 (1)
                                 equal values for the left and right side expressions in (25) can be obtained when the 
                                       
                                          
                                             Δ
                                          
                                          
                                             i
                                          
                                       
                                     intervals have the same length (i.e. a fifth of the 
                                       Δ
                                     value;

for a given length of a decision interval 
                                       
                                          
                                             Δ
                                          
                                          
                                             i
                                          
                                       
                                    , 
                                       i
                                       ∈
                                       {
                                       0
                                       ,
                                       1
                                       ,
                                       …
                                       ,
                                       m
                                       −
                                       1
                                       }
                                    , a maximal value for 
                                       
                                          ∫
                                          
                                             
                                             
                                                
                                                   Δ
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                
                                                   
                                                      
                                                         Y
                                                         ˜
                                                      
                                                   
                                                   
                                                      Δ
                                                   
                                                
                                             
                                          
                                          (
                                          y
                                          /
                                          
                                             
                                                d
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          d
                                          y
                                       
                                     is obtained when 
                                       
                                          
                                             p
                                          
                                          
                                             
                                                
                                                   
                                                      Y
                                                      ˜
                                                   
                                                
                                                
                                                   Δ
                                                
                                             
                                          
                                       
                                       (
                                       y
                                       /
                                       
                                          
                                             d
                                          
                                          
                                             i
                                          
                                       
                                       )
                                     is centred within the 
                                       
                                          
                                             Δ
                                          
                                          
                                             i
                                          
                                       
                                     interval.

The two observations above demonstrate that the decision rule in (18) is an optimal decision rule, in the sense of maximizing the probability of correct decision, hence of minimizing the probability of error.

Assume now the case in which a 
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                            symbol is inserted and a wrong decision 
                              
                                 
                                    d
                                 
                                 
                                    j
                                 
                              
                            
                           
                              (
                              
                                 
                                    d
                                 
                                 
                                    j
                                 
                              
                              ≠
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              )
                            is made. The probability of such an error, denoted by 
                              
                                 
                                    P
                                 
                                 
                                    e
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    j
                                 
                              
                              )
                           , can be computed as
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          e
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          d
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    =
                                    P
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    
                                       ∫
                                       
                                          
                                          
                                             
                                                I
                                             
                                             
                                                
                                                   
                                                      α
                                                   
                                                   ⁎
                                                
                                             
                                          
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          
                                             
                                                
                                                   Y
                                                   ˜
                                                
                                             
                                             
                                                Δ
                                             
                                          
                                       
                                    
                                    (
                                    y
                                    /
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    d
                                    y
                                 
                              
                           
                        

The average error probability, when considering all the possible symbols to be inserted and all the possible errors in detection can be computed as the sum of the individual error probabilities
                              
                                 (26)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          e
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ≠
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          e
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          d
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    ,
                                    
                                    
                                    i
                                    ,
                                    j
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    ,
                                    …
                                    ,
                                    m
                                    −
                                    1
                                    }
                                 
                              
                           
                        

The error probability expressed by Eq. (26) corresponds to the error in detecting a symbol 
                              d
                            from an m-ary alphabet. Should we be interested in the error of detecting a symbol from the initial binary message 
                              b
                           , the general conversion formula can be applied [22,23]
                           
                              
                                 (27)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          e
                                          b
                                       
                                    
                                    =
                                    
                                       
                                          1
                                          
                                       
                                       2
                                    
                                    
                                       m
                                       
                                          m
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          e
                                       
                                    
                                 
                              
                           
                        


                           
                           Fig. 8 illustrates the average probability error expressed by Eq. (26) as a function of the Gaussian noise standard deviation 
                              σ
                            (presented on the abscissa), for 
                              Δ
                              
                              =
                              70
                           . Four alphabet sizes have been considered, namely 
                              m
                              =
                              2
                           , 
                              m
                              =
                              3
                           , 
                              m
                              =
                              5
                            and 
                              m
                              =
                              7
                           . In each case, 11 values for the 
                              α
                            parameter are illustrated; these values are evenly distributed with a step 0.02 and are centered on the corresponding 
                              
                                 
                                    α
                                 
                                 ⁎
                              
                            value; the case of 
                              
                                 
                                    α
                                 
                                 ⁎
                              
                            is plotted in red.

By analyzing these plots, the following conclusions are brought to light:
                              
                                 •
                                 when 
                                       α
                                       <
                                       
                                          
                                             α
                                          
                                          ⁎
                                       
                                    , 
                                       
                                          
                                             P
                                          
                                          
                                             e
                                          
                                       
                                       >
                                       0
                                     even in the absence of attacks (i.e. even when 
                                       σ
                                       =
                                       0
                                    ); this is a consequence of the overlapping between the decision intervals, see Fig. 5;

when 
                                       α
                                       =
                                       
                                          
                                             α
                                          
                                          ⁎
                                       
                                     and in the absence of attacks (i.e. 
                                       σ
                                       =
                                       0
                                    ), 
                                       
                                          
                                             P
                                          
                                          
                                             e
                                          
                                       
                                       =
                                       0
                                    ; this result derives from the fact that in the absence of attacks, the decision rule in (17) is deterministic and 
                                       α
                                       =
                                       
                                          
                                             α
                                          
                                          ⁎
                                       
                                     ensures the best robustness–transparency trade-off;

if 
                                       α
                                       =
                                       
                                          
                                             α
                                          
                                          ⁎
                                       
                                     and 
                                       σ
                                       >
                                       0
                                    , then 
                                       
                                          
                                             P
                                          
                                          
                                             e
                                          
                                       
                                       >
                                       0
                                    ; consequently, the 
                                       
                                          
                                             α
                                          
                                          ⁎
                                       
                                     value ensuring the best transparency cannot be exploited in practical applications: in order to grant some robustness to the attacks, an 
                                       α
                                       >
                                       
                                          
                                             α
                                          
                                          ⁎
                                       
                                     should be considered, thus impacting in the transparency;

if the practical application requires a value 
                                       
                                          
                                             P
                                          
                                          
                                             e
                                          
                                       
                                       <
                                       0.1
                                     for 
                                       σ
                                       <
                                       Δ
                                       
                                       /
                                       (
                                       4
                                       m
                                       )
                                     (i.e. for a Gaussian noise covering at 95% a particular decision interval 
                                       
                                          
                                             I
                                          
                                          
                                             
                                                
                                                   α
                                                
                                                ⁎
                                             
                                          
                                       
                                       (
                                       d
                                       )
                                    , see 
                                    Fig. 9), then values 
                                       α
                                       ≥
                                       
                                          
                                             α
                                          
                                          ⁎
                                       
                                       +
                                       0.04
                                     should be considered. This lower limit 
                                       α
                                       =
                                       
                                          
                                             α
                                          
                                          ⁎
                                       
                                       +
                                       0.04
                                     will be further considered for the theoretical investigation of the 
                                       
                                          
                                             P
                                          
                                          
                                             e
                                          
                                       
                                     variation as a function of 
                                       Δ
                                     (see 
                                    Fig. 10) and for the experimental validations in Sections 4 and 5;

all the 
                                       
                                          
                                             P
                                          
                                          
                                             e
                                          
                                       
                                     plots converge towards 
                                       (
                                       m
                                       −
                                       1
                                       )
                                       /
                                       m
                                    , when 
                                       σ
                                       →
                                       Δ
                                       /
                                       2
                                     (i.e. in the case of a very strong Gaussian noise, covering practically all the 
                                       [
                                       
                                          −
                                          
                                             Δ
                                             2
                                          
                                          ;
                                          
                                             Δ
                                             2
                                          
                                       
                                       ]
                                     interval), see Fig. 9.


                           Fig. 10 illustrates the average probability error expressed by Eq. (26) as a function of the Gaussian noise standard deviation 
                              σ
                            (represented on the abscissa), for 
                              α
                              =
                              
                                 
                                    α
                                 
                                 ⁎
                              
                              +
                              0.04
                           ; the same four values for m have been investigated: m=2, m=3, m=5 and m=7 . In each case, seven Δ values are illustrated, namely Δ=40 , Δ=50, Δ=60, Δ=70, Δ=80, Δ=90, and Δ=100. By analyzing these plots, we can see that 
                              
                                 
                                    P
                                 
                                 
                                    e
                                 
                              
                            is a decreasing function of Δ, at a fixed value of 
                              σ
                            . Hence, the increase of Δ means a priori a stronger robustness, obtained at the expense of a weaker transparency. In the sequel, we shall consider Δ values between 50 and 90 and we shall discuss their practical relevance.

@&#CONCLUSION@&#

This section presents the theoretical framework for the m-QIM watermarking. First, it generalizes the insertion rule, from the binary to 
                           m
                        -ary case, see Eq. (5). Second, it derives the optimal decision rule in the sense of minimizing the error probability of detection under an additive white Gaussian noise (18) and computes the underlying probability error (26). These results also identify optimal (in the error probability sense) parameters for the method and/or hinted to more suitable configurations to be considered in the practical validation. The way in which these theoretical issues are reflected in the practical data payload–transparency–robustness tradeoff is investigated in next section for robust and semi-fragile applications.

The robust watermarking embedding process starts by following the principles in [17,18]. The mark is inserted in the quantized AC luma residual coefficients; this way, the MPEG-4 AVC decoding/reenconding overhead is limited to the binary decoding/reencoding.

The host vector 
                        x
                      is obtained by zig-zag scanning the 15 components of a 
                        4
                        ×
                        4
                      AC luma residual coefficients.

In order to match the watermarking method to the human visual system, a perceptual shaping mechanism is also considered. This means that the watermark is not directly embedded into the original vector x but into its projection onto a perceptual mask 
                        
                        
                           
                              v
                           
                           
                              mask
                           
                        
                     . This mask is obtained by adapting and extending [4] for MPEG-4 AVC the popular Watson model [24] developed for still images.

The insertion/detection follows Eqs. (5) and (18). More details in this respect can be found in [17,18].

The m-QIM parameters are chosen so as to serve the practical purpose of the robust watermarking application and are guided by the theoretical demonstration in Section 3. Four 
                        m
                      values and three quantization steps 
                        Δ
                      are compared all through the study, namely 
                        m
                        ∈
                        {
                        2
                        ,
                        
                        3
                        ,
                        
                        5
                        ,
                        
                        7
                        }
                      and 
                        Δ
                        ∈
                        {
                        50
                        ,
                        
                        70
                        ,
                        
                        90
                        }
                     .

Regardless the particular 
                        m
                      and 
                        Δ
                      values, we set 
                        α
                        =
                        
                           
                              α
                           
                           ⁎
                        
                        +
                        0.04
                      (see the discussion in Section 3.3.2).

Experimental evaluations are carried under MEDIEVALS corpus consisting of 4 video sequences of 15min each. They were encoded in MPEG-4 AVC Baseline Profile (no B frames, CAVLC entropy encoder) at 512kb/s (SD) and 2Mbps (HD). The GOP size is set to 10.

The experiments are conducted at three successive levels, so as to investigate the three-folded data payload–robustness–transparency watermarking challenge.

First (Section 4.1), the data payload is estimated for different m values while keeping fixed values for transparency (average PSNR of 45dB and of 65dB, for SD and HD, respectively) and robustness (maximal BER of 0.1±0.03 against bipolar additive noise, transcoding and geometric random bending attacks).

Second (Section 4.2), the robustness against the same three types of attacks is investigated at fixed data payload (150bit/min) and transparency (PSNR of 45dB and of 65dB, for SD and HD, respectively) constraints.

Finally (Section 4.3), the transparency (expressed by five subjective metrics) is assessed at fixed data payload (150bit/min) and robustness (maximal BER of 0.1±0.03 against additive noise, transcoding and geometric random bending attacks).

As the m-QIM is intrinsically a side-information method [3,21] the data payload depends on the particular video sequence and cannot be a priori predicted.

Consequently, our experiments consider for each value 
                           m
                         an incremental approach: we start from the value reported in [4] for 
                           m
                           =
                           2
                         and SD (namely 56bit/min), and we gradually increase it up to the limit allowing prescribed average values for transparency and robustness. On the one hand, the average transparency is set at a PSNR=45dB in the SD case and at a PSNR=65dB in the HD case (with minimal/maximal limits of 43/47dB and 63/67dB, respectively). On the other hand, for both the SD and the HD corpora, the robustness is set at an average BER of 0.1 (with minimal/maximal limits of 0.07/0.13) after noise addition, transcoding and geometric random bending attacks
                           1
                        
                        
                           1
                           All through the paper the geometric attack is ensured by the Stirmark random bending [31]; the terms random geometric and Stirmark attacks will be alternatively employed.
                        . A 
                           Δ
                           =
                           70
                         has been considered. The values thus obtained for the data payload are plotted in 
                        Fig. 11 in blue diamonds.

However, with respect to the binary QIM, the m-QIM insertion is theoretically expected to increase the data payload by a factor of 
                           
                              
                                 log
                              
                              
                                 2
                              
                           
                           m
                         
                        [20]. Consequently, we consider the data payload value obtained for 
                           m
                           =
                           2
                         and we also plot the corresponding theoretical logarithmic function, see the red squares in Fig. 11.


                        Fig. 11 shows a good concordance between the theoretical and the experimental plot, the relative average differences being lower than 0.02 in the SD case and lower than 0.06 in the HD case. These average differences are computed by averaging the relative differences obtained on the corresponding corpora, for all the considered 
                           m
                         values.

The experiments reported in Fig. 11 are resumed, in 
                        Table 4, for 
                           α
                           =
                           
                              
                                 α
                              
                              ⁎
                           
                           +
                           0.04
                        , for 
                           m
                           =
                           5
                         but for two different 
                           Δ
                         values, namely 
                           Δ
                           =
                           50
                         and 
                           Δ
                           =
                           70
                        . With respect to the reference case 
                           Δ
                        =70, when keeping the same transparency/robustness constraints, it can be noticed that:
                           
                              •
                              
                                 
                                    Δ
                                    =
                                    50
                                  ensures relative increases of the data payload by factor of 0.1 and 0.07 in the SD and HD cases, respectively.


                                 
                                    Δ
                                    =
                                    90
                                  ensures relative decreases of the data payload by factor of 0.13 and 0.11 in the SD and HD cases, respectively.

The relative gain 
                           ρ
                         represented in the paragraph above is computed according to the formula:
                           
                              (28)
                              
                                 ρ
                                 =
                                 
                                    
                                       value
                                       (
                                       tested
                                       
                                       Δ
                                       )
                                       −
                                       value
                                       (
                                       Δ
                                       =
                                       70
                                       )
                                    
                                    
                                       value
                                       
                                       (
                                       Δ
                                       =
                                       70
                                       )
                                    
                                 
                              
                           
                        
                     

While the theoretical demonstration presented in Section 3.3 considered the case of the attacks modelled by additive white Gaussian noise, the present section goes outside this hypothesis, by experimentally investigating attacks which cannot be modelled by the Gaussian laws [25]: bipolar −1/1 white noise added in the 
                           4
                           ×
                           4
                         MPEG-4 AVC coefficient domain, MPEG-4 AVC transcoding (down to 25% from the original stream bit rate) and geometric random bending attacks.

The data payload is set at 150bit/min while the transparency is set at 45dB (with 
                           ±
                           
                           2
                           
                           dB
                         maximal variation) in the SD case and at 65dB (with 
                           ±
                           
                           2
                           
                           dB
                         maximal variation) in the HD case. The 
                           Δ
                         parameter is set at 
                           Δ
                           =
                           70
                        . The same four values for 
                           m
                         are investigated: 
                           m
                           ∈
                           {
                           2
                           ,
                           
                           3
                           ,
                           
                           5
                           ,
                           
                           7
                           }
                        .

The robustness is investigated by computing the BER, see 
                        Fig. 12: the case of bipolar additive noise is represented in blue diamonds, the case of transcoding in red squares while the random geometric attacks in green triangles. The values reported in Fig. 12 are obtained by averaging the BER obtained at the frame level. The following conclusions can be drawn:
                           
                              •
                              the −1/1 bipolar noise addition results in perturbations described by a unitary standard deviation; as this value is very small compared to the 
                                    Δ
                                  (see discussion in Section 3.3.2), the choice of 
                                    α
                                    =
                                    
                                       
                                          α
                                       
                                       ⁎
                                    
                                    +
                                    0.04
                                  ensured a BER=0, although the law of such perturbation is not Gaussian;

the MPEG-4 AVC transcoding resulted in average
                                    2
                                 
                                 
                                    2
                                    Averaged over the four considered m values.
                                  BER of 0.05 and 0.06, for the SD and HD content, respectively; it can be noticed that BER is quite constant with respect to 
                                    m
                                 , the corresponding variances (over the four investigated 
                                    m
                                  values) being 2.2
                                    ×
                                 10−4 and 1.7
                                    ×
                                 10−4, respectively;

the standard deviation of the noise induced by the transcoding attacks is estimated in our experiments at 3.2 and 2.8, for SD and HD, respectively; the theoretical error obtained by Eq. (27) for these sigma values are 0.07 and 0.06; while a slight difference between the practice and the theory is identified in the SD case (0.05 vs. 0.07), the two values are identical in the HD case;

the geometric random bending attacks also result in quite constant averaged BER as a function of 
                                    m
                                 : average values of 0.105 and 0.090 and variances of 5.7
                                    ×
                                 10−4 and 4.4
                                    ×
                                 10−4 are obtained for the SD and HD content, respectively;

the standard deviation of the noise corresponding to these attacks is estimated at 5.3 and 4.5, respectively; the theoretical average error computed with (27) are 0.12 and 0.11; we can see a lower concordance between the theoretical and experimental results than in the case of transcoding; this is the consequence of the fact that the geometrical attacks do not follow a Gaussian law;

the numerical values reported in this section are statistical relevant, in the sense that the 95% confidence intervals [26] computed for the BER after the transcoding and the random bending attacks resulted in relative errors lower than 5
                                    ×
                                 10−3 (the BER in the bipolar noise addition was constantly equal to 0; hence, no confidence interval has been computed).

The overall BER results prove the robustness of the m-QIM watermarking method against the investigated attacks. In order to illustrate the practical impact of these attacks for SD content, 
                        Fig. 13 presents the case in which the ARTEMIS logo is considered as the mark. The experiments in Fig. 13 considered the same context as above: a data payload of 150bit/min, 
                           α
                           =
                           
                              
                                 α
                              
                              ⁎
                           
                           +
                           0.04
                        , 
                           Δ
                        =70.

The experiments reported in Fig. 12 are resumed in 
                        Table 5 for the same 
                           α
                           =
                           
                              
                                 α
                              
                              ⁎
                           
                           +
                           0.04
                        , for 
                           m
                           =
                           5
                         but for two different 
                           Δ
                         values, namely 
                           Δ
                           =
                           50
                         and 
                           Δ
                           =
                           90
                        . With respect to the case 
                           Δ
                        =70, when keeping the same data payload/transparency constraints, it can be noticed that:
                           
                              •
                              
                                 
                                    Δ
                                    =
                                    50
                                  ensures relative increases of the BER by a factor of 0.5 and 0.27 for transcoding and Stirmark random bending, respectively in the SD case and by a factor of 0.28 and 0.2 for transcoding and Stirmark random bending, respectively in the HD case.


                                 
                                    Δ
                                    =
                                    90
                                  results in relative decreases of the BER by a factor of 0.33 and 0.09 for transcoding and Stirmark random bending, respectively in the SD case and by a factor of 0.28 and 0.1 for transcoding and Stirmark random bending, respectively in the HD case.

Note: the relative increases/decreases in the BER are computed according to (28).

In order to evaluate the transparency of the watermarking method, three types of metrics have been considered: pixel difference-based measures (peak signal to noise ratio – PSNR and absolute average difference – AAD), correlation based measures (structural continent – SC and normalized cross correlation – NCC), and psycho-visual measures (digital video quality – DVQ). These metrics are computed at the frame level according to their definitions presented [27,28], then averaged over the video corpus, as follows. Be there 
                           S
                         and 
                           
                              S
                              ^
                           
                         two video to be compared, each of them having 
                           
                              
                                 N
                              
                              
                                 f
                              
                           
                         frames of 
                           W
                           ×
                           H
                         pixels. Be 
                           
                              
                                 S
                              
                              
                                 i
                                 ,
                                 j
                                 ,
                                 k
                              
                           
                         the pixel at column 
                           i
                         and row 
                           j
                         of frame 
                           k
                        . 
                           PSNR
                        , 
                           AAD
                        , 
                           SC
                         and 
                           NNC
                         are expressed by
                           
                              
                                 PSNR
                                 (
                                 S
                                 ,
                                 
                                    S
                                    ^
                                 
                                 )
                                 =
                                 
                                    1
                                    
                                       
                                          
                                             N
                                          
                                          
                                             f
                                          
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             f
                                          
                                       
                                    
                                 
                                 10
                                 
                                 log
                                 
                                    (
                                    
                                       
                                          
                                             W
                                             ×
                                             H
                                             ×
                                             max
                                             (
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                                2
                                             
                                             )
                                          
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                W
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                H
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            S
                                                            ^
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                 AAD
                                 (
                                 S
                                 ,
                                 
                                    S
                                    ^
                                 
                                 )
                                 =
                                 
                                    1
                                    
                                       
                                          
                                             N
                                          
                                          
                                             f
                                          
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             f
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          W
                                       
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          H
                                       
                                       |
                                       
                                          
                                             S
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       −
                                       
                                          
                                             
                                                S
                                                ^
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       |
                                    
                                    
                                       W
                                       ×
                                       H
                                    
                                 
                                 SC
                                 (
                                 S
                                 ,
                                 
                                    S
                                    ^
                                 
                                 )
                                 =
                                 
                                    1
                                    
                                       
                                          
                                             N
                                          
                                          
                                             f
                                          
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             f
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          W
                                       
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          H
                                       
                                       (
                                       
                                          
                                             
                                                S
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          2
                                       
                                       )
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          W
                                       
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          H
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   S
                                                   ^
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          2
                                       
                                       )
                                    
                                 
                                 
                                 NNC
                                 (
                                 S
                                 ,
                                 
                                    S
                                    ^
                                 
                                 )
                                 =
                                 
                                    1
                                    
                                       
                                          
                                             N
                                          
                                          
                                             f
                                          
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             f
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          W
                                       
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          H
                                       
                                       (
                                       
                                          
                                             S
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       ×
                                       
                                          
                                             
                                                S
                                                ^
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       )
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          W
                                       
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          H
                                       
                                       (
                                       
                                          
                                             
                                                S
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          2
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

As the DVQ analytic computing is very sophisticated, the reader is referred to [28].

A fixed data payload of 150bit/min and robustness (expressed by average maximal BER of 0.1±0.03 against the three above-mentioned attacks) are considered.


                        
                        
                        
                        Figs. 14 to 16 display the average values of these metrics alongside with their 95% confidence intervals [29].

As an overall trend, we can see that the transparency improves with increasing the alphabet size m. This can be explained by the fact that, for a fixed data payload, increasing m decreases the number of MPEG-4 AVC blocks needed for embedding the mark and thus reduces the drift artifacts inner to compressed domain watermarking. However, an in-depth analysis of the different variations of the quality metrics, with respect to 
                           m
                        , brings to light that the variation of the quality metrics is stronger in the case of SD content than in the case of HD content. In order to objectively asses this behavior, we consider the average relative variation between two successive 
                           m
                         values, denoted by 
                           η
                        :
                           
                              (29)
                              
                                 η
                                 =
                                 
                                    1
                                    3
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    3
                                 
                                 
                                    
                                       metric
                                       (
                                       
                                          
                                             m
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       )
                                       −
                                       metric
                                       (
                                       
                                          
                                             m
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       metric
                                       (
                                       
                                          
                                             m
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        where 
                           metric
                         ∈ {PSNR, AAD, SC, NCC and DVQ} and 
                           i
                         is the index of the deployed 
                           m
                         value belonging to the set 
                           {
                           2
                           ,
                           
                           3
                           ,
                           
                           5
                           ,
                           
                           7
                           }
                        . The 
                           η
                         values are presented in 
                        Table 6.

The experiments reported in Figs. 14 to 16 are resumed in 
                        Table 7 for the same 
                           α
                           =
                           
                              
                                 α
                              
                              ⁎
                           
                           +
                           0.04
                        , for 
                           m
                           =
                           5
                         and for two different 
                           Δ
                         values, namely 
                           Δ
                           =
                           50
                         and 
                           Δ
                           =
                           70
                        . With respect to the case 
                           Δ
                        =70, when keeping the same data payload/robustness constraints, we note that 
                           Δ
                           =
                           50
                         ensures:
                           
                              •
                              Relative increases by a factor of 0.06 and 0.04 for PSNR in the SD case and HD case, respectively.

Relative decreases by a factor 0.2 and 0.33 for DVQ, in the SD case and in the HD case, respectively.

Similarly, with respect to the case 
                           Δ
                        =70, when keeping the same data payload/robustness constraints, we note that 
                           Δ
                           =
                           90
                         ensures:
                           
                              •
                              Relative decreases by a factor of 0.07 and 0.06 for PSNR, in the SD case and in the HD case, respectively.

Relative increases by a factor of 0.4 and 0.33 for DVQ in the SD case and in the HD case, respectively.

The relative gains are computed according to (28).

@&#CONCLUSION@&#

This section stands for the applicative validation of the m-QIM insertion/detection under the framework of the robust watermarking. The experimental investigation was conducted at three levels and considered 
                           α
                           =
                           
                              
                                 α
                              
                              ⁎
                           
                           +
                           0.4
                         (according to the a priori hints discussed in Section 3.3).

First, for fixed transparency and robustness, an overall 
                           
                              
                                 log
                              
                              
                                 2
                              
                           
                           m
                         gain in data payload has been obtained with respects to the study in [4] where 
                           m
                           =
                           2
                         was considered.

Second, for fixed data payload and transparency constraints, no practical loss in robustness has been encountered, the variance of the BER with respect to 
                           m
                         value being lower than 6
                           ×
                        10−4; such a result holds for both SD and HD corpora.

Finally, an average relative increase by a factor of 0.1 and 0.01 of PSNR and an average relative decrease by a factor of 0.23 and 0.16 of DVQ are obtained for fixed data payload and robustness in the SD case and HD case, respectively; the correlation based measures are quite constant with respect to 
                           m
                        . This slight increase in transparency is the consequence of the decrease of the number of MPEG-4 AVC blocks needed for embedding when the alphabet size is increased and of the subsequent drift effect attenuation.

The experiments also investigated the impact of the 
                           Δ
                         parameter in the overall results (the larger the 
                           Δ
                        , the better the robustness but the worse the transparency). They also brought to light that a quite large interval of 
                           Δ
                         values (from 50 to 90) can be considered for robust watermarking purposes.

In order to allow an overall comparison between our m-QIM framework and state-of-the-art binary QIM approaches, we also implemented the method in [6]. We resumed the experiments presented in this Section 4 while keeping the data payload–robustness–transparency constraints the same.

The data payload experiments (cf. Section 4.1) demonstrated that the method in [6] cannot allow even 1bit/s to be inserted.

The robustness experiments (cf. Section 4.2) brought to light that the QIM method in [6] resulted in:
                           
                              •
                              BER=0, after additive noise (for both SD and HD original content);

BER=0.17 and 0.15 after transcoding attacks, for SD and HD content, respectively; the underlying 95% relative errors were 0.02 and 0.019, respectively; these BER values are about 3 times larger than the average values corresponding to the m-QIM.

BER=0.45 and 0.43 after the Stirmark random bending attack, for SD and HD content, respectively; the underlying 95% relative errors were 0.025; these BER values are about 4 times larger than the average values corresponding to the m-QIM.

A synoptic view on these robustness results is provided by 
                        Fig. 17 which is analogous to Fig. 13. It illustrates the ARTEMIS logo recovered by using the method in [6], after bipolar additive noise, transcoding and Stirmark random bending attacks. It can be noticed that the Stirmark random bending attacks completely destroy the meaning of the recovered logo.

As the method in [6] cannot provide the expected data payload and robustness constraints, the transparency experiments in Section 4.3 were not resumed.

The practical use of m-QIM for semi-fragile watermarking was first discussed in [19]. While the same insertion/detection rule as in the case of robust watermarking is basically kept the semi-fragile watermarking application comes with particular constraints on (1) the mark semantics, (2) the data payload, and (3) the result interpretation.

First, from the semantic point of view, the mark no longer relates to the intellectual property rights information but to an authentication signature of the content itself. The low complexity requirement can be met when such a signature is extracted and inserted directly from/in the MPEG-4 AVC syntax elements, with minimal decoding/re-encoding operations. To meet this requirement, we consider individual groups of i successive I frames (further referred to as I-Group) sampled from an MPEG-4 AVC video sequence, see 
                        Fig. 18. The signature is computed from the first frame 
                           
                              
                                 I
                              
                              
                                 0
                              
                           
                         in such an I-Group, by assigning one bit to each macroblock, according to its prediction mode. Further, the binary signature is encoded to on a m-ary alphabet. This principle explained at the frame level, can be applied at a finer level, i.e. on given area covering neighbor macroblocks. The smaller the area on which the signature is computed, the more accurate the spatial identification of the content modified regions.

The signature conveying information about the content of the first I frame is further inserted into the rest of 
                           i
                           −
                           1
                         
                        I frames of that I-Group by the m-QIM embedding method, see Eq. (6). The shorter the I-Group, the more accurate the temporal localization of the altered content.

In order to verify the integrity of an attacked I-Group (see Fig. 18), the authentication signature of the attacked video is computed from its first 
                           
                              
                                 I
                              
                              
                                 0
                              
                           
                         frame. This signature is compared with the mark extracted from the rest of the attacked I-Group frames. In our experiments, we consider that an area in a frame is altered when at least 50% of the attacked signature elements belonging to that area do not match with the corresponding extracted watermark elements.

Second, from the data payload point of view, such an authentication signature results in about 4.5kbit/min (assuming SD corpus with frame size of 640×480). As such a data payload is 30 times larger than the one investigated in Section 4 for robust watermarking purposes, the robustness and transparency investigation should be resumed accordingly.

Third, from the result interpretation point of view, feed-back provided by professional under the framework of the SPY project brought to light that when an I-Group is maliciously altered, it is very likely to have other successive blocks altered. Consequently, the decision according to Eq. (18) is followed by a post-processing rule of the type: one I-Group is considered as altered if at least two I-Groups that succeed it or precede it are detected as altered.

The experiments investigate the robustness, fragility and transparency properties, for a prescribed data payload value, set by the size of the authentication signature (i.e. 4.5kbits/min).

First, under the semi-fragile watermarking framework, transcoding and additive noise are the most harmless authorized attacks. Consequently, Section 5.2.1 investigates the BER after these attacks, for prescribed transparency (average PSNR=32dB).

Second, the fragility is investigated in Section 5.2.2 by computing the Precision and Recall rates when identifying the content altered blocks at fixed robustness (maximal BER of 0.1±0.03 after transcoding). The same transparency constraint is kept (average PSNR=32dB).

Finally, the transparency is assessed in Section 5.2.3 for prescribed robustness/fragility limits (maximal BER of 0.1±0.03 and minimal Precision and Recall of 0.9).

Note that current day video surveillance cameras are mainly IP-based and generate SD content; hence our study considers only an SD corpus. The experiments were carried out on a video surveillance corpus composed of 8 sequences of 10min each, downloaded from internet [29] or recorded under the framework of the SPY project. Their content is heterogeneous, combining city streets, highways, industrial objectives, shopping centers, … This corpus is encoded in MPEG-4 AVC in Baseline Profile (no B frames, CAVLC entropy encoder) at 512kbps, 640×480pixel frames; the GOP size is set to 8.

Four 
                           m
                         values and three quantization steps 
                           Δ
                         are compared all through the study, namely 
                           m
                           ∈
                           {
                           2
                           ,
                           
                           3
                           ,
                           
                           5
                           ,
                           
                           7
                           }
                         and 
                           Δ
                           ∈
                           
                              {
                              
                                 50
                                 ,
                                 70
                                 ,
                                 90
                              
                              }
                           
                        . Each and every time, 
                           α
                           =
                           
                              
                                 α
                              
                              ⁎
                           
                           +
                           0.4
                        , see the discussion in Section 3.3.

This section investigates the robustness of the semi-fragile watermarking method based on m-QIM against transcoding (down to 25% from the original stream bit rate) and bipolar noise addition, for a data payload of 4.5kbit/min. The average transparency is set to PSNR=32dB. 
                           Fig. 19 illustrates the BER as a function of 
                              m
                           , when 
                              m
                              ∈
                              {
                              2
                              ,
                              
                              3
                              ,
                              
                              5
                              ,
                              
                              7
                              }
                           , 
                              Δ
                              =
                              70
                            and 
                              α
                              =
                              
                                 
                                    α
                                 
                                 ⁎
                              
                              +
                              0.04
                           .

The BER values reported in Fig. 19 prove the robustness of the semi-fragile method against the investigated attacks: average BER of 0.08 and 0 against transcoding and additive noise are obtained, respectively. It can also be noticed that the BER is quite constant with respect to 
                              m
                           , its variance being lower than 4
                              ×
                           10−4. These numerical values are statistical relevant, in the sense that the 95% confidence intervals [26] computed for the BER after the transcoding resulted in relative errors lower than 5
                              ×
                           10−3 (the BER in the bipolar noise addition was constantly equal to 0; hence, no confidence interval has been computed).

The experiments are resumed so as to investigate the robustness behavior as a function of 
                              Δ
                           . This time, 
                              m
                              =
                              5
                            and 
                              Δ
                              ∈
                              
                                 {
                                 
                                    50
                                    ,
                                    90
                                 
                                 }
                              
                           , see 
                           Table 8.

When keeping the same transparency constraints, 
                              Δ
                              =
                              90
                            results in relative decreases of the BER by a factor of 0.14, while 
                              Δ
                              =
                              50
                            results in a relative increase of the BER by a factor of 1.28; these relative gains are computed by (28). Table 8 demonstrates that, at least from the robustness point of view, a value 
                              Δ
                              =
                              50
                            is no longer of practical relevance. Note that these results confirm the theoretical ground as well as the behaviour which was experimentally identified in Section 4.2: the larger the 
                              Δ
                            value, the better the robustness.

The video content is considered as being altered when one object is removed, inserted or substituted. To simulate this attack, we wrote a piece of code that tampers the marked video by arbitrarily changing 1/81 areas of the frame.

From the fragility point of view, an ideal watermarking method should fail in detecting the mark from each and every area which was subject to content alterations, thus identifying the altered area. While such a behavior can be also expressed in terms of probability of missed detection and false alarm, the literature brings to light two more detailed measures, namely the Precision and the Recall ratios, defined as follows [30].
                              
                                 
                                    Pr
                                    e
                                    c
                                    i
                                    s
                                    i
                                    o
                                    n
                                    =
                                    t
                                    p
                                    /
                                    (
                                    t
                                    p
                                    +
                                    f
                                    p
                                    )
                                    ,
                                    
                                    Re
                                    c
                                    a
                                    l
                                    l
                                    =
                                    t
                                    p
                                    /
                                    (
                                    t
                                    p
                                    +
                                    f
                                    n
                                    )
                                 
                              
                           where 
                              t
                              p
                            is the number of true positive (i.e. the number of content modified areas which do not allow the mark to be recovered), 
                              f
                              p
                            is the false positive (i.e. the number of content preserved areas which do not allow the mark to be recovered) and 
                              f
                              n
                            is the false negative number (i.e. the number of content modified areas which allow the mark to be detected).


                           
                           Fig. 20 illustrates the obtained Precision and Recall values as a function of m, for 
                              Δ
                              =
                              70
                           .


                           Fig. 20 shows average values for Precision and Recall of 0.92 and 0.95, respectively. The Precision and Recall value are quite constant with respect to 
                              m
                           , the relative variances being of of 6
                              ×
                           10−5 and 9
                              ×
                           10−5, respectively.

The above fragility experiments are resumed for 
                              Δ
                              =
                              50
                            and 
                              Δ
                              =
                              90
                           ; this time 
                              m
                              =
                              5
                           , see 
                           Table 9. With respect to the case 
                              Δ
                              =
                              70
                           , 
                              Δ
                              =
                              90
                            results in a quite constant Precision and Recall values. However, 
                              Δ
                              =
                              50
                            results in important relative decrease by a factor of 0.4 and 0.29, respectively. The relative gains are computed according to (28). Hence, the fragility property also refutes the 
                              Δ
                              =
                              50
                            value (see Section 5.2.1).

The transparency of the semi-fragile watermarking method is assessed considering the same three types of metrics as in Section 4.3.

Here again, the data-payload is set at 4.5kbit/min. The robustness expressed by a BER=0.1±0.03 against transcoding while the fragility is kept at Precision and Recall rates larger than 0.9. The same four 
                              m
                            value are investigated, namely 
                              m
                            ∈{2, 3, 5, 7}.

The experimental results are reported in 
                           
                           
                           Figs. 21 to 23
                           
                              3
                           
                           
                              3
                              In order to allow a synoptic comparison with robust watermarking, the same axis ranges as in Figs. 15 to 17 are kept.
                           . These numeric values meet the a priori expectancies: the transparency increases with 
                              m
                           . This behavior is assessed by computing the 
                              η
                            coefficient defined by (29), see 
                           Table 10.

The transparency investigation is resumed for 
                              Δ
                              =
                              90
                            and 
                              m
                              =
                              5
                           . Note that Sections 5.2.1 and 5.2.2 demonstrate that 
                              Δ
                              =
                              50
                            is unable to meet the robustness/fragility requirements. With respect to the case 
                              Δ
                              =
                              70
                           , 
                              Δ
                              =
                              90
                            results in a significantly depreciated transparency, see 
                           Table 11 where the relative gains, computed according to (28), are reported. Consequently, 
                              Δ
                              =
                              90
                            is no longer of practical relevance.

@&#CONCLUSION@&#

This section studies the usefulness of the m-QIM technique for semi-fragile MPEG-4 AVC video watermarking. Such an application requires a data payload 30 times larger than in the robust watermarking case. It was experimentally demonstrated that the robustness and fragility property be properly achieved while having as main benefit an increase of the transparency by a factor of 0.1 in PSNR, 0.06 in NCC and 0.23 in DVQ. However, this application is more restrictive than the robust watermarking with respect to interval to which the 
                           Δ
                         value belongs.

In order to also allow an overall comparison between our m-QIM framework and state of the art binary QIM approaches, we resumed the experiment for the method in [6]. The robustness experiments (cf. Section 5.2.1) brought to light average BER values of 0 and 0.25, after the additive noise and transcoding attacks, respectively. As the latter BER value, computed with a 95% relative error of 0.011 is that high, we can state that the method in [6] does not meet our targeted semi-fragile watermarking requirements. Consequently, the fragility (cf. Section 5.2.2) and transparency (cf. Section 5.2.3) were not performed for the method in [6].

@&#CONCLUSION@&#

The present study generalized the QIM watermarking techniques from binary to the m-ary case. From the theoretical point of view, the insertion/detection rules are paired derived so as to minimize the probability of error under white Gaussian noise attacks.

While the m-QIM can be potentially applied to any insertion domain, our experimental study considers the quantized residual coefficients of the MPEG-4 AVC stream, and investigates the possibility of designing both robust and semi-fragile applications.

First, the robust watermarking investigation is carried out on 1h of video content encoded at two resolutions (SD and HD). It is thus demonstrated that:
                        
                           •
                           while keeping fixed robustness and transparency, the data payload is increased by a factor of log2
                              m;

while imposing fixed transparency and data payload, the robustness is quite constant with respect to 
                                 m
                              ;

while setting a prescribed data robustness and data payload, an average relative increase by a factor of 0.1 and 0.01 of PSNR and an average relative decrease by a factor of 0.23 and 0.16 of DVQ are achieved in the SD case and HD case.

Such results are brought to light for 
                        m
                     ∈{2, 3, 5, 7} and for a quite broad interval of 
                        Δ
                      values, ranging from 50 to 90.

Second, under the semi-fragile watermarking framework, the experiments consider a strong data payload constraint (4.5kbit/min) imposed by the signature size. It is demonstrated that:
                        
                           •
                           while imposing a prescribed transparency, the robustness and the fragility are quite constant with respect to 
                                 m
                              ;

while keeping fixed robustness/fragility constraints, the transparency is increased by 0.1 in PSNR, 0.06 in NCC and 0.23 in DVQ.

These results are obtained at the expense of restricting the 
                        Δ
                      parameter to a quite narrow interval centered on 70.

Note that the MPEG-4 AVC watermarking by means of m-QIM technique avoids complex operations by requiring just binary MPEG-4 AVC encoding/decoding and m-QIM quantization operations.

These overall results demonstrate that the m-QIM watermarking technique outperforms the state-of-the art studies presented in Section 2. Hence, we can state that m-QIM technique is an unitary theoretical framework jointly reaching functional equilibrium for both robust and semi-fragile watermarking applications.

Further work will be carried out on both theoretical and applicative aspects. From the theoretical point of view, the extension of the m-QIM insertion/detection rule outside the Gaussian noise hypothesis is the first step. From the applicative point of view, the overall data payload–robustness–transparency results featured by the m-QIM framework encourage us to go beyond robust and semi-fragile watermarking and to consider other potential watermarking use-cases like broadcast and Internet monitoring [1], visual content filtering and classification [32], asset and content management [32] and e-commerce [32].

@&#REFERENCES@&#

