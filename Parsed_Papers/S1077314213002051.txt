@&#MAIN-TITLE@&#Comparison of multi-label graph cuts method and Monte Carlo simulation with block-spin transformation for the piecewise constant Mumford–Shah segmentation model

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We give a comparison of two methods for solving the Mumford–Shah segmentation model.


                        
                        
                           
                           We propose a hybrid method for solving the Mumford–Shah segmentation model.


                        
                        
                           
                           This hybrid method combines the advantages of the two methods, robustness and speed.


                        
                        
                           
                           We show that the hybrid method is efficient for a wide range of model parameters.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Mumford–Shah segmentation model

Image segmentation

Graph cuts

Monte Carlo method

@&#ABSTRACT@&#


               
               
                  The Mumford–Shah segmentation model is an energy model widely applied in computer vision. Many attempts have been made to minimize the energy of the model. We focus on recently proposed two methods for solving multi-phase segmentation; the graph cuts method by Bae and Tai (2009) [16] and the Monte Carlo method by Watanabe et al. (2011) [21]. We compare the convergence of solutions, the values of obtained energy, the computational time, etc. Finally we propose a hybrid method combining the advantages of the Monte Carlo and the graph cuts. The hybrid method can find the global minimum energy solution efficiently without sensitivity of initial guess.
               
            

@&#INTRODUCTION@&#

The Mumford–Shah segmentation model [1] is an energy model for image segmentation in the field of computer vision. By exploring lower-energy solution, an output image with piecewise constant regions and smooth contour is obtained.

There have been many works for solving the Mumford–Shah segmentation model. The level set method approach by Chan and Vese [2] had great success for binary segmentation. The level set method is a kind of dynamic contour model where a contour is represented implicitly as the zero level set of a scalar Lipschitz continuous function 
                        
                           ϕ
                        
                     , which is called level set function. In the level set method, a contour of the Mumford–Shah segmentation model is formulated by level set function. An output image is obtained by solving associated gradient descent equations numerically. The extension of level set method to multi-phase segmentation [3] was proposed. As another approach, a variant of level set method, so-called the piecewise constant level set method (PCLSM) was proposed in [4–6]. Different from standard level set method, any partition can be described by single level set function which takes discrete values on each region, and the length of contour is approximated by the total variation of the level set function.

Recently, the solution of the Mumford–Shah segmentation model using graph cuts method has captured a lot of attention. The graph cuts method is well known in the field of computer vision [7–10]. By finding a minimum cut in a graph corresponding to the energy model, the minimum energy solution can be computed. The application to the two-phase Mumford–Shah segmentation model was reported in [11–13]. It was shown that the graph cuts method is much efficient and robust than the gradient descent minimization. The extension to multi-phase segmentation was proposed by El-Zehiry and Elmaghraby [14]. In their method, each phase is segmented iteratively by the two-label graph cuts method. However, the optimal solution is not always guaranteed to be subset of the result with smaller phases. Bae and Tai [15,16] proposed another graph cuts method under the framework of PCLSM. The level set formulation of the Mumford–Shah segmentation model is related to the multi-label graph, and the solution is obtained by calculating a minimum cut iteratively. The efficiency of the graph cuts method was reported to be very superior in comparison with the previous gradient-descent-equation based approach, with maintaining the lower-energy outputs [15,16]. The construction of the graph in this method is based on the work by [17–19]. Bae and Tai [20] also proposed a graph cuts method for the multi-phase model. This is a slightly modified approach for the level set function, where they used binary level set functions.

On the other hand, the solution of the Mumford–Shah segmentation model using the Monte Carlo method was proposed recently [21]. The Monte Carlo method is a probabilistic numerical approach, which is a standard simulation method for many particle systems in statistical physics. By mapping the data of image to the highly correlated lattice model, the Monte Carlo method is easily applied in the field of computer vision. Although such an approach was already used in the prominent paper by Geman and Geman [22], Monte Carlo techniques have not been studied extensively because it was generally believed that Monte Carlo methods are too slow in computation. However, techniques in Monte Carlo method have improved significantly with the advance in computer speed, and they now play a bigger role in computer vision once again. Watanabe et al. [21] studied the piecewise constant Mumford–Shah energy model by simulated annealing with the Metropolis sampling [23]. With the use of the block-spin transformation, they succeeded in the fast convergence to the low-energy solution.

We here make a remark on another recent progress in solving the Mumford–Shah segmentation model. Chan et al. [24] applied the scalar-valued convex relaxation method to the two-valued Mumford–Shah model. Fixing two parameters 
                        
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                        
                      to represent the average value of the intensity of image, they proposed a method to minimize the energy. Brown et al. [25] proposed a method that is applicable to the case of unknown 
                        
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                        
                     . This method, called the completely convex relaxation method, extended the method for the image registration by Goldstein et al. [26] to the problem of image segmentation. The work of Goldstein et al. [26] generalized the ideas of the exact optimization [18] and the convex relaxation [27]. Brown et al. [25] asserted that the numerical results are better than those of Chan and Vese [2], but their method takes very long time. This method can be extended to the case of multi-phase segmentation problem, but the memory size becomes larger and much more computation time is required for the case of multi-phase segmentation. Extending the work by Brown et al. [25], Bae and Tai [28] proposed a method which improves the memory consumption and the computation time. As described above, the application of the convex relaxation method to the Mumford–Shah segmentation model has been actively discussed in recent years. More efficient method for the minimization of the Mumford–Shah segmentation model is highly required.

In this paper, we pay attention to two methods recently proposed for the numerical solution of the Mumford–Shah segmentation model, that is, the multi-label graph cuts method Bae and Tai [15,16] and the Monte Carlo method with the block-spin transformation by Watanabe et al. [21]. For abbreviation, we simply refer to the graph cuts method by Bae and Tai as “the graph cuts method” and the Monte Carlo method by Watanabe et al. as “the Monte Carlo method” from now on.

We compare the convergence of solutions, the values of obtained energy, the computational time, etc. The Monte Carlo method has advantage in robustness to initial conditions, and it easily approaches the low-energy solution. But it is difficult to remove thermal fluctuations, depending on the schedule of simulated annealing. On the other hand, the graph cuts method strongly depends on initial conditions, but once an appropriate initial condition is set, it approaches the global minimum solution deterministically. Based on the results of comparison, we here propose a hybrid method combining the advantages of the Monte Carlo and the graph cuts. We show that our hybrid method efficiently finds the global minimum energy solution in wide range of parameter.

This paper is organized as follows. We first give a description of the Mumford–Shah energy model in Section 2. Then, the optimization technique with a graph cuts method, especially the method of Bae and Tai [15,16] is explained in Section 3, and the Monte Carlo method in Section 4. We give numerical comparison between two methods in Section 5. The detailed process of the hybrid method is described in Section 6. The final section is devoted to summary and discussions.

The Mumford–Shah energy model [1] is a famous energy model with a wide range of applications in image processing. Let the image domain be 
                        
                           Ω
                        
                      and intensity of the input image be 
                        
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                           (
                           x
                           )
                        
                     . The image domain 
                        
                           Ω
                        
                      is partitioned into exclusive segments 
                        
                           
                              
                                 Ω
                              
                              
                                 l
                              
                           
                           ,
                           
                           l
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                        
                      by C, which is a set of contours of 
                        
                           
                              
                                 Ω
                              
                              
                                 l
                              
                           
                        
                     , so that 
                        
                           Ω
                           =
                           
                              
                                 Ω
                              
                              
                                 1
                              
                           
                           ∪
                           
                              
                                 Ω
                              
                              
                                 2
                              
                           
                           ∪
                           …
                           ∪
                           C
                        
                     . The energy model is given in terms of an image variable 
                        
                           u
                           (
                           x
                           )
                        
                      as
                        
                           (1)
                           
                              E
                              (
                              u
                              (
                              x
                              )
                              ,
                              C
                              )
                              =
                              λ
                              
                                 ∫
                                 
                                    Ω
                                 
                              
                              |
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                              (
                              x
                              )
                              -
                              u
                              (
                              x
                              )
                              
                                 
                                    |
                                 
                                 
                                    2
                                 
                              
                              dx
                              +
                              
                                 ∫
                                 
                                    Ω
                                    ⧹
                                    C
                                 
                              
                              |
                              ∇
                              u
                              (
                              x
                              )
                              
                                 
                                    |
                                 
                                 
                                    2
                                 
                              
                              dx
                              +
                              μ
                              |
                              C
                              |
                              ,
                           
                        
                     where 
                        
                           |
                           C
                           |
                        
                      stands for the total length of the contours making up C. The first term means that 
                        
                           u
                           (
                           x
                           )
                        
                      approximates the input image 
                        
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                           (
                           x
                           )
                        
                     , the second term means that 
                        
                           u
                           (
                           x
                           )
                        
                      does not vary very much on each 
                        
                           
                              
                                 Ω
                              
                              
                                 l
                              
                           
                        
                     , and the third term asks that the total length of C is as short as possible. If a minimum energy is given, 
                        
                           u
                           (
                           x
                           )
                        
                      may be taken as a cartoon-like image in which the edges are drawn sharply, and the objects surrounded by the contours are drawn smoothly in comparison with the input image.

It is often adopted that the image variable 
                        
                           u
                           (
                           x
                           )
                        
                      takes constant values 
                        
                           
                              
                                 c
                              
                              
                                 l
                              
                           
                        
                      on each region 
                        
                           
                              
                                 Ω
                              
                              
                                 l
                              
                           
                        
                     . In this case the second term of Eq. (1) disappears, and a simpler version of Mumford–Shah energy model is derived as follows,
                        
                           (2)
                           
                              E
                              (
                              {
                              
                                 
                                    c
                                 
                                 
                                    l
                                 
                              
                              }
                              ,
                              C
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 ∫
                                 
                                    
                                       
                                          Ω
                                       
                                       
                                          l
                                       
                                    
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    x
                                    )
                                    -
                                    
                                       
                                          c
                                       
                                       
                                          l
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                              dx
                              +
                              μ
                              |
                              C
                              |
                              ,
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    c
                                 
                                 
                                    l
                                 
                              
                              =
                              
                                 
                                    
                                       mean
                                    
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                              (
                              x
                              )
                              )
                              =
                              
                                 
                                    
                                       
                                          ∫
                                       
                                       
                                          
                                             
                                                Ω
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          u
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    x
                                    )
                                    dx
                                 
                                 
                                    
                                       ∫
                                       
                                          
                                             
                                                Ω
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                    
                                    dx
                                 
                              
                              .
                           
                        
                     We call Eq. (2) the Mumford–Shah segmentation model.

In order to compare the graph cuts method and the Monte Carlo method in the same energy model, we deal with the Mumford–Shah segmentation model defined in the two dimensional discrete lattice. Let 
                        
                           i
                           =
                           (
                           x
                           ,
                           y
                           )
                        
                      be a grid point on a lattice 
                        
                           P
                        
                     . Define the neighborhood system 
                        
                           N
                           (
                           i
                           )
                           =
                           {
                           (
                           x
                           ±
                           1
                           ,
                           y
                           )
                           ,
                           (
                           x
                           ,
                           y
                           ±
                           1
                           )
                           }
                        
                     . The energy model on a discrete lattice is written as follows:
                        
                           (4)
                           
                              
                                 
                                    E
                                 
                                 
                                    d
                                 
                              
                              (
                              {
                              
                                 
                                    c
                                 
                                 
                                    l
                                 
                              
                              }
                              ,
                              ϕ
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       P
                                    
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                    -
                                    
                                       
                                          c
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                              +
                              μ
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       P
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       N
                                       (
                                       i
                                       )
                                    
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              |
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    ϕ
                                 
                                 
                                    j
                                 
                              
                              |
                              ,
                           
                        
                     
                     
                        
                           
                              ϕ
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                              .
                           
                        
                     
                     
                        
                           
                              
                                 u
                              
                              
                                 i
                              
                              
                                 0
                              
                           
                        
                      is the intensity of the input image at the grid point i, and 
                        
                           
                              
                                 c
                              
                              
                                 l
                              
                           
                        
                      is average intensity of the grid points in 
                        
                           
                              
                                 Ω
                              
                              
                                 l
                              
                           
                        
                      as 
                        
                           
                              
                                 c
                              
                              
                                 l
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 ∈
                                 P
                              
                           
                           
                           
                              
                                 u
                              
                              
                                 i
                              
                              
                                 0
                              
                           
                           
                              
                                 δ
                              
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 l
                              
                           
                           /
                           
                              
                                 ∑
                              
                              
                                 i
                                 ∈
                                 P
                              
                           
                           
                           
                              
                                 δ
                              
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 l
                              
                           
                        
                     . We refer to the first term as “the data term” and the second term as “the regularization term”. For the regularization term we have chosen the discrete version of total variation of 
                        
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                        
                      norm (
                        
                           
                              
                                 TV
                              
                              
                                 1
                              
                           
                        
                     ). In this case, the level set function becomes convex and linearly ordered, which is essential property for applying the multi-label graph cuts to Eq. (4). Since each term is counted twice in the regularization term, the factor 1/2 is multiplied.

A graph cuts method is an optimization technique which captures recent attention. A graph 
                           
                              G
                              =
                              (
                              V
                              ,
                              E
                              )
                           
                         is a set of vertices 
                           
                              V
                           
                         and a set of directed edges 
                           
                              E
                              ⊂
                              V
                              ×
                              V
                           
                        . 
                           
                              V
                           
                         consists of special vertices, a source s and a sink t, and other vertices. 
                           
                              (
                              a
                              ,
                              b
                              )
                              ∈
                              E
                           
                         is the directed edge from vertex a to vertex b and the function 
                           
                              c
                              (
                              a
                              ,
                              b
                              )
                           
                         is the cost on the edge 
                           
                              (
                              a
                              ,
                              b
                              )
                           
                        . A cut 
                           
                              C
                           
                         on 
                           
                              G
                           
                         is a partition of 
                           
                              V
                           
                         into two subsets S and 
                           
                              T
                              ,
                              T
                              =
                              V
                              ⧹
                              S
                           
                        , such that 
                           
                              s
                              ∈
                              S
                              ,
                              t
                              ∈
                              T
                           
                        . We say that the cut severs the edge 
                           
                              (
                              a
                              ,
                              b
                              )
                           
                         if 
                           
                              a
                              ∈
                              S
                           
                         and 
                           
                              b
                              ∈
                              T
                           
                        . For each cut, the set of severed edges 
                           
                              C
                           
                         is uniquely given as
                           
                              (5)
                              
                                 C
                                 =
                                 {
                                 (
                                 a
                                 ,
                                 b
                                 )
                                 |
                                 a
                                 ∈
                                 S
                                 ,
                                 
                                 b
                                 ∈
                                 T
                                 ,
                                 
                                 (
                                 a
                                 ,
                                 b
                                 )
                                 ∈
                                 E
                                 }
                                 ,
                              
                           
                        and the total cost of the cut is defined as
                           
                              (6)
                              
                                 |
                                 C
                                 |
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          e
                                          ∈
                                          C
                                       
                                    
                                 
                                 c
                                 (
                                 e
                                 )
                                 .
                              
                           
                        A minimum cut is a cut with minimum total cost on 
                           
                              G
                           
                        . As Ford and Fulkerson [29] proved, finding a maximum flow on 
                           
                              G
                           
                         is equivalent to finding a minimum cut in 
                           
                              G
                           
                        . A minimum cut thus can be computed efficiently by various max-flow algorithms [10,29,30]. In this paper, we implement the max-flow algorithm based on the algorithm described in [10].

The main idea of graph cuts method is to construct a graph such that there is a one-to-one correspondence between configurations of the energy model and cuts of the graph, and the total cost of the cut is the same as the total energy of the configuration.

In computer vision, the graph cuts technique was first introduced by the early work of Greig et al. [31] where a global minimum solution is guaranteed for the first order Markov Random Field (MRF) model with two label states. Since the extension to more than two label states is NP hard, the usual graph cuts approach for multi-label optimization problems uses an approximation method. Boykov et al. [8] proposed some approximation methods which generate a local minimum solution with respect to two types of large moves; 
                           
                              α
                              –
                              β
                           
                         swap and 
                           
                              α
                           
                        -expansion. But, under some conditions, the global optimization for the multi-label states was proposed by [17–19]. If an MRF model has three or more linearly ordered states and convex priors, a global minimum solution can be found in polynomial time.

In the work of Bae and Tai [15,16], the graph cuts method for minimizing the Mumford–Shah segmentation model, Eq. (4), is based on the work of [17–19]. Their algorithm can search minimum energy both with respect to 
                           
                              ϕ
                           
                         and 
                           
                              {
                              
                                 
                                    c
                                 
                                 
                                    l
                                 
                              
                              }
                           
                         by combining two steps iteratively; the optimization of the partition of 
                           
                              ϕ
                           
                         through the multi-label graph cuts for a fixed 
                           
                              {
                              
                                 
                                    c
                                 
                                 
                                    l
                                 
                              
                              }
                           
                        , and the optimization of 
                           
                              {
                              
                                 
                                    c
                                 
                                 
                                    l
                                 
                              
                              }
                           
                         for a fixed 
                           
                              ϕ
                           
                        .

We fix parameter 
                           
                              {
                              
                                 
                                    c
                                 
                                 
                                    l
                                 
                              
                              }
                           
                         in Eq. (4) so that the energy model satisfies the condition for applying the multi-label graph cuts [17–19]. The strategy of the graph cuts method is to construct the graph 
                           
                              G
                           
                         such that
                           
                              (7)
                              
                                 min
                                 |
                                 C
                                 |
                                 =
                                 
                                    
                                       
                                          min
                                       
                                       
                                          C
                                          
                                          cut
                                          
                                          on
                                          
                                          G
                                       
                                    
                                 
                                 
                                 
                                    
                                       E
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 {
                                 
                                    
                                       c
                                    
                                    
                                       l
                                    
                                 
                                 }
                                 ,
                                 ϕ
                                 )
                                 +
                                 σ
                                 ,
                              
                           
                        for fixed 
                           
                              {
                              
                                 
                                    c
                                 
                                 
                                    l
                                 
                              
                              }
                           
                        . Here, 
                           
                              σ
                              >
                              0
                           
                         is a constant such that no edges have zero cost.

For each grid point 
                           
                              i
                              ∈
                              P
                              ,
                              (
                              n
                              -
                              1
                              )
                           
                         vertices are associated with the graph 
                           
                              G
                           
                        , denoted 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                    ,
                                    l
                                 
                              
                              ,
                              
                              l
                              =
                              1
                              ,
                              …
                              ,
                              n
                              -
                              1
                           
                        . The set of vertices 
                           
                              V
                           
                         is defined as
                           
                              (8)
                              
                                 V
                                 =
                                 {
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       l
                                    
                                 
                                 |
                                 i
                                 ∈
                                 P
                                 ,
                                 
                                 l
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 -
                                 1
                                 }
                                 }
                                 ∪
                                 {
                                 s
                                 }
                                 ∪
                                 {
                                 t
                                 }
                                 .
                              
                           
                        An illustration for a one-dimensional image is shown in Fig. 1
                        , for the number of grid points 
                           
                              |
                              P
                              |
                              =
                              5
                           
                         and 
                           
                              n
                              =
                              4
                           
                         case. The total number of vertices is given as 
                           
                              (
                              n
                              -
                              1
                              )
                              ×
                              |
                              P
                              |
                              +
                              2
                           
                        .

The edges on 
                           
                              G
                           
                         are arranged in two groups, the data term edges 
                           
                              
                                 
                                    E
                                 
                                 
                                    D
                                 
                              
                           
                         and the regularization term edges 
                           
                              
                                 
                                    E
                                 
                                 
                                    R
                                 
                              
                           
                        . In Fig. 1, 
                           
                              
                                 
                                    E
                                 
                                 
                                    D
                                 
                              
                           
                         are illustrated as vertical arrows and 
                           
                              
                                 
                                    E
                                 
                                 
                                    R
                                 
                              
                           
                         are illustrated as horizontal arrows. The data term edges 
                           
                              
                                 
                                    E
                                 
                                 
                                    D
                                 
                              
                           
                        , which correspond to the data term in Eq. (4), are defined as
                           
                              (9)
                              
                                 
                                    
                                       E
                                    
                                    
                                       D
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ⋃
                                       
                                       
                                          i
                                          ∈
                                          P
                                       
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 (
                                 s
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       
                                          ⋃
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          n
                                          -
                                          2
                                       
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       l
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       l
                                       +
                                       1
                                    
                                 
                                 )
                                 
                                    ⋃
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       n
                                       -
                                       1
                                    
                                 
                                 ,
                                 t
                                 )
                                 
                                 ∀
                                 i
                                 ∈
                                 P
                                 ,
                              
                           
                        and 
                           
                              
                                 
                                    E
                                 
                                 
                                    R
                                 
                              
                           
                         are defined as
                           
                              (11)
                              
                                 
                                    
                                       E
                                    
                                    
                                       R
                                    
                                 
                                 =
                                 {
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       l
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       j
                                       ,
                                       l
                                    
                                 
                                 )
                                 |
                                 i
                                 ∈
                                 P
                                 ,
                                 
                                 j
                                 ∈
                                 N
                                 (
                                 i
                                 )
                                 ,
                                 
                                 l
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 -
                                 1
                                 }
                                 }
                                 ,
                              
                           
                        which correspond to the regularization term.

Then, we define the edge costs such that the relationship Eq. (7) is satisfied. The cost for the data term edges 
                           
                              
                                 
                                    E
                                 
                                 
                                    D
                                 
                              
                           
                         is defined by
                           
                              (12)
                              
                                 c
                                 (
                                 s
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                 
                                 )
                                 =
                                 |
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                                 -
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       |
                                       P
                                       |
                                    
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 P
                                 ,
                              
                           
                        
                        
                           
                              (13)
                              
                                 c
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       l
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       l
                                       +
                                       1
                                    
                                 
                                 )
                                 =
                                 |
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                                 -
                                 
                                    
                                       c
                                    
                                    
                                       l
                                       +
                                       1
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       |
                                       P
                                       |
                                    
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 P
                                 ,
                                 
                                 ∀
                                 l
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 -
                                 2
                                 }
                                 ,
                              
                           
                        
                        
                           
                              (14)
                              
                                 c
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       n
                                    
                                 
                                 ,
                                 t
                                 )
                                 =
                                 |
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                                 -
                                 
                                    
                                       c
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       |
                                       P
                                       |
                                    
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 P
                                 .
                              
                           
                        The cost for the regularization edges 
                           
                              
                                 
                                    E
                                 
                                 
                                    R
                                 
                              
                           
                         is defined by
                           
                              (15)
                              
                                 c
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       l
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       j
                                       ,
                                       l
                                    
                                 
                                 )
                                 =
                                 μ
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 P
                                 ,
                                 
                                 ∀
                                 j
                                 ∈
                                 N
                                 (
                                 i
                                 )
                                 ,
                                 
                                 ∀
                                 l
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 -
                                 1
                                 }
                                 .
                              
                           
                        
                     

The relationship between a cut on 
                           
                              G
                           
                         and a level set function 
                           
                              ϕ
                           
                         is proved to be defined as single valued [16] such that
                           
                              (16)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   if
                                                   
                                                   (
                                                   s
                                                   ,
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                         ,
                                                         1
                                                      
                                                   
                                                   )
                                                   ∈
                                                   C
                                                   ,
                                                
                                             
                                             
                                                
                                                   l
                                                   +
                                                   1
                                                
                                                
                                                   if
                                                   
                                                   (
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                         ,
                                                         l
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                         ,
                                                         l
                                                         +
                                                         1
                                                      
                                                   
                                                   )
                                                   ∈
                                                   C
                                                   ,
                                                
                                             
                                             
                                                
                                                   n
                                                
                                                
                                                   if
                                                   
                                                   (
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                         ,
                                                         n
                                                         -
                                                         1
                                                      
                                                   
                                                   ,
                                                   l
                                                   )
                                                   ∈
                                                   C
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        A level set function and its corresponding cut satisfy
                           
                              (17)
                              
                                 |
                                 C
                                 |
                                 =
                                 
                                    
                                       E
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 {
                                 
                                    
                                       c
                                    
                                    
                                       l
                                    
                                 
                                 }
                                 ,
                                 ϕ
                                 )
                                 +
                                 σ
                                 .
                              
                           
                        Thus, 
                           
                              ϕ
                           
                         corresponding to a minimum cut is a minimizer of Eq. (4) for fixed 
                           
                              {
                              
                                 
                                    c
                                 
                                 
                                    l
                                 
                              
                              }
                           
                        . Once 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    ˆ
                                 
                              
                           
                         is determined by the minimum cut calculation, the optimal values 
                           
                              {
                              
                                 
                                    c
                                 
                                 
                                    l
                                 
                              
                              }
                           
                         that minimize 
                           
                              
                                 
                                    E
                                 
                                 
                                    d
                                 
                              
                              (
                              {
                              
                                 
                                    c
                                 
                                 
                                    l
                                 
                              
                              }
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                         are easily obtained by the average intensity on each region as
                           
                              (18)
                              
                                 
                                    
                                       c
                                    
                                    
                                       l
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             P
                                          
                                       
                                       
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             l
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             P
                                          
                                       
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             l
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

By combining the two above results, the iterative descent algorithm that minimizes Eq. (4) is as follows,
                           
                              Step 1.
                              Assume 
                                    
                                       
                                          
                                             {
                                             
                                                
                                                   c
                                                
                                                
                                                   l
                                                
                                             
                                             }
                                          
                                          
                                             0
                                          
                                       
                                    
                                  and set 
                                    
                                       t
                                       =
                                       0
                                    
                                 .

Construct graph 
                                    
                                       G
                                    
                                  and use graph cuts for estimate 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                  by
                                    
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                ˆ
                                             
                                          
                                          =
                                          arg
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          
                                             
                                                E
                                             
                                             
                                                d
                                             
                                          
                                          (
                                          
                                             
                                                {
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      l
                                                   
                                                
                                                }
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                ϕ
                                             
                                             
                                                ̃
                                             
                                          
                                          )
                                          .
                                       
                                    
                                 
                              

Calculate 
                                    
                                       
                                          
                                             {
                                             
                                                
                                                   c
                                                
                                                
                                                   l
                                                
                                             
                                             }
                                          
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                    
                                  by Eq. (18).

if 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             l
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   l
                                                
                                                
                                                   t
                                                
                                             
                                             -
                                             
                                                
                                                   c
                                                
                                                
                                                   l
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       >
                                       e
                                       ,
                                       t
                                       ←
                                       t
                                       +
                                       1
                                    
                                  and back to Step 2. 
                                    
                                       e
                                       >
                                       0
                                    
                                  is small constant.

Because of the dependency of the initial assumption of 
                           
                              
                                 
                                    {
                                    
                                       
                                          c
                                       
                                       
                                          l
                                       
                                    
                                    }
                                 
                                 
                                    0
                                 
                              
                           
                        , this algorithm is no longer guaranteed to find the global minimum solution. It may get trapped in a local minimum solution close to the initial value 
                           
                              
                                 
                                    {
                                    
                                       
                                          c
                                       
                                       
                                          l
                                       
                                    
                                    }
                                 
                                 
                                    0
                                 
                              
                           
                        .

For the choice of 
                           
                              
                                 
                                    {
                                    
                                       
                                          c
                                       
                                       
                                          l
                                       
                                    
                                    }
                                 
                                 
                                    0
                                 
                              
                           
                        , Bae and Tai proposed that the isodata algorithm [32], a process for classifying a set of gray level image points into distinct n classes, works good in many cases. However, for some conditions, we remark that the graph cuts method with the initial values of isodata algorithm is not so effective. The numerical experiments are shown later.

In this section, we present the solution of the Mumford–Shah segmentation model, Eq. (4), using the Monte Carlo method. This method is based on the work of Watanabe et al. [21] which illustrates an effective use of Monte Carlo by formulating the Mumford–Shah image segmentation problem in a statistical physics framework with isotropic Potts interaction. They succeeded in the fast convergence to the low-energy solution by simulated annealing with the block-spin transformation.

Simulated annealing is a probabilistic method for finding the global minimum solution of a cost function that may possess several local minima. It works by starting from high-temperature state with thermal fluctuations and gradually removing thermal fluctuations; eventually it reaches the global minimum solution escaping from local minima. In actual simulation, because of the finite computation time, it converges to a solution which is very close to the global minimum solution. The transition of states is realized by the standard Metropolis algorithm [23] given as follows,
                        
                           Step 1.
                           Let the present spin configuration as 
                                 
                                    {
                                    ϕ
                                    }
                                 
                              . Pick up the pixel 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                               and the trial spin value 
                                 
                                    m
                                    ∈
                                    [
                                    1
                                    ,
                                    n
                                    ]
                                 
                               randomly. Set the trial spin configuration as
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                      
                                                      
                                                         i
                                                         
                                                         ≠
                                                         
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         m
                                                         ,
                                                      
                                                      
                                                         i
                                                         =
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              that is, 
                                 
                                    {
                                    
                                       
                                          ϕ
                                       
                                       
                                          ′
                                       
                                    
                                    }
                                 
                               is the configuration that only the spin value of 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                               is changed to m.

Calculate the change of energy value 
                                 
                                    E
                                    (
                                    {
                                    
                                       
                                          c
                                       
                                       
                                          l
                                       
                                    
                                    }
                                    ,
                                    {
                                    
                                       
                                          ϕ
                                       
                                       
                                          ′
                                       
                                    
                                    }
                                    )
                                    -
                                    E
                                    (
                                    {
                                    
                                       
                                          c
                                       
                                       
                                          l
                                       
                                    
                                    }
                                    ,
                                    {
                                    ϕ
                                    }
                                    )
                                 
                              .

Update the spin configuration 
                                 
                                    {
                                    ϕ
                                    }
                                    ←
                                    {
                                    
                                       
                                          ϕ
                                       
                                       
                                          ′
                                       
                                    
                                    }
                                 
                               with the probability
                                 
                                    
                                       min
                                       (
                                       1
                                       ,
                                       exp
                                       [
                                       -
                                       (
                                       E
                                       (
                                       {
                                       
                                          
                                             c
                                          
                                          
                                             l
                                          
                                       
                                       }
                                       ,
                                       {
                                       
                                          
                                             ϕ
                                          
                                          
                                             ′
                                          
                                       
                                       }
                                       )
                                       -
                                       E
                                       (
                                       {
                                       
                                          
                                             c
                                          
                                          
                                             l
                                          
                                       
                                       }
                                       ,
                                       {
                                       ϕ
                                       }
                                       )
                                       )
                                       /
                                       T
                                       ]
                                       )
                                       ,
                                    
                                 
                              where 
                                 
                                    T
                                    ⩾
                                    0
                                 
                               is a simulation parameter as referred to “temperature”; otherwise the spin configuration remains.

For simulated annealing, the computational time strongly depends on the cost to calculate 
                        
                           E
                           (
                           {
                           
                              
                                 c
                              
                              
                                 l
                              
                           
                           }
                           ,
                           {
                           
                              
                                 ϕ
                              
                              
                                 ′
                              
                           
                           }
                           )
                           -
                           E
                           (
                           {
                           
                              
                                 c
                              
                              
                                 l
                              
                           
                           }
                           ,
                           {
                           ϕ
                           }
                           )
                        
                      in step 2. It is not practical if the calculation of order N is needed for single spin flip process. In the case of Mumford–Shah segmentation model, as Watanabe et al. [21] showed, only the computation of local energy change is needed for calculating a trial energy 
                        
                           E
                           (
                           {
                           
                              
                                 c
                              
                              
                                 l
                              
                           
                           }
                           ,
                           {
                           
                              
                                 ϕ
                              
                              
                                 ′
                              
                           
                           }
                           )
                        
                     . We write the energy in terms of the variables, 
                        
                           
                              
                                 N
                              
                              
                                 l
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                              
                           
                           
                           
                              
                                 δ
                              
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 l
                              
                           
                        
                     , 
                        
                           
                              
                                 U
                              
                              
                                 l
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                              
                           
                           
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                           
                              
                                 δ
                              
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 l
                              
                           
                        
                      and 
                        
                           
                              
                                 c
                              
                              
                                 l
                              
                           
                           =
                           
                              
                                 U
                              
                              
                                 l
                              
                           
                           /
                           
                              
                                 N
                              
                              
                                 l
                              
                           
                        
                     , and if 
                        
                           
                              
                                 ϕ
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           =
                           k
                        
                      at the pixel 
                        
                           
                              
                                 i
                              
                              
                                 0
                              
                           
                        
                      is changed to 
                        
                           
                              
                                 ϕ
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 ′
                              
                           
                           =
                           m
                        
                     , then the new values 
                        
                           
                              
                                 N
                              
                              
                                 k
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 N
                              
                              
                                 m
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 U
                              
                              
                                 k
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 U
                              
                              
                                 m
                              
                              
                                 ′
                              
                           
                        
                      and 
                        
                           
                              
                                 c
                              
                              
                                 k
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 m
                              
                              
                                 ′
                              
                           
                        
                      are given by,
                        
                           (19)
                           
                              
                                 
                                    
                                    
                                       
                                          2
                                          
                                             
                                                N
                                             
                                             
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          
                                             
                                                N
                                             
                                             
                                                k
                                             
                                          
                                          -
                                          1
                                          ,
                                          
                                          
                                             
                                                N
                                             
                                             
                                                m
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          
                                             
                                                N
                                             
                                             
                                                m
                                             
                                          
                                          +
                                          1
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                U
                                             
                                             
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          
                                             
                                                U
                                             
                                             
                                                k
                                             
                                          
                                          -
                                          
                                             
                                                u
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                U
                                             
                                             
                                                m
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          
                                             
                                                U
                                             
                                             
                                                m
                                             
                                          
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          
                                             
                                                U
                                             
                                             
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                          /
                                          
                                             
                                                N
                                             
                                             
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                c
                                             
                                             
                                                m
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          
                                             
                                                U
                                             
                                             
                                                m
                                             
                                             
                                                ′
                                             
                                          
                                          /
                                          
                                             
                                                N
                                             
                                             
                                                m
                                             
                                             
                                                ′
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Finally, the energy change in Mumford–Shah functional is calculated as
                        
                           (20)
                           
                              E
                              (
                              {
                              
                                 
                                    c
                                 
                                 
                                    l
                                 
                              
                              }
                              ,
                              {
                              
                                 
                                    ϕ
                                 
                                 
                                    ′
                                 
                              
                              }
                              )
                              -
                              E
                              (
                              {
                              
                                 
                                    c
                                 
                                 
                                    l
                                 
                              
                              }
                              ,
                              {
                              ϕ
                              }
                              )
                              =
                              -
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    U
                                 
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              +
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    U
                                 
                                 
                                    k
                                 
                              
                              -
                              
                                 
                                    c
                                 
                                 
                                    m
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    U
                                 
                                 
                                    m
                                 
                                 
                                    ′
                                 
                              
                              +
                              
                                 
                                    c
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    U
                                 
                                 
                                    m
                                 
                              
                              +
                              μ
                              Δ
                              |
                              C
                              |
                              ,
                           
                        
                     where the first to fourth terms are the change of data terms and the last term is the change of regularization term. The energy change of the regularization term for 
                        
                           
                              
                                 TV
                              
                              
                                 1
                              
                           
                        
                      can be evaluated as
                        
                           (21)
                           
                              Δ
                              |
                              C
                              |
                              =
                              μ
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       N
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 
                                    
                                       |
                                       m
                                       -
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                       
                                       |
                                       -
                                       |
                                       k
                                       -
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                       
                                       |
                                    
                                 
                              
                              .
                           
                        
                     This expression is a little bit different from the case of the isotropic Potts interaction given in [21].

To accelerate the convergence, Watanabe et al. [21] proposed to use the idea of the block-spin transformation, which was based on the coarse graining of lattices in the renormalization group theory [33]. By starting with the coarse-grained system instead of the original lattice, the convergence of simulation can be accelerated drastically. For two dimensions, each operation of block-spin transformation reduces the number of pixels by fourfold. Block-spin transformation is performed by taking four neighboring pixels and replacing them by one pixel with the average intensity of four pixels. We iterate this process in the Monte Carlo optimization. If we start with the coarse-grained system with t times, the time for one Monte Carlo step (MCS) per spin is roughly 
                        
                           1
                           /
                           
                              
                                 4
                              
                              
                                 t
                              
                           
                        
                      of that for the original size. The invariance of the energy under block-spin transformation was given by Law et al. [34]; the energy of regularization term is invariant by setting the parameter 
                        
                           μ
                        
                      as 
                        
                           μ
                           →
                           μ
                           /
                           2
                        
                      in the block-spin transformation. This statement also holds for the regularization energy term of 
                        
                           
                              
                                 TV
                              
                              
                                 1
                              
                           
                        
                     , Eq. (4).

In this way, we start with the coarse-grained system in the initial stage of simulation with high temperature, and we increase the system size with decreasing the temperature. With this process, we search for the low-energy configuration much efficiently compared to the simple annealing method of the original size.

The schematic illustration of the time sequence of block-spin transformation Monte Carlo method is shown in Fig. 2
                     . We see that the system size is reduced to 
                        
                           24
                           ×
                           24
                        
                      from 
                        
                           192
                           ×
                           192
                        
                      of the original MRI trial image, as an example, in the initial stage of simulation, and is multiplied stepwise in accordance with Monte Carlo steps. It was reported that the convergence of energy is much faster with block spin transformation, with maintaining robustness to initial conditions and statistical fluctuation [21].

We make a comment on the energy model of Eq. (4). Since the regularization term of 
                        
                           
                              
                                 TV
                              
                              
                                 1
                              
                           
                        
                      is ordered, the energy depends on the order of 
                        
                           {
                           
                              
                                 c
                              
                              
                                 l
                              
                           
                           }
                        
                     . Unlike the case of isotropic Potts interaction of 
                        
                           μ
                           
                              
                                 δ
                              
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       j
                                    
                                 
                              
                           
                        
                      in [21], the permutation of the order of 
                        
                           {
                           
                              
                                 c
                              
                              
                                 l
                              
                           
                           }
                        
                      may give a different energy for regularization term, and eventually for total energy. It is thus possible that the solution is trapped at a local minimum solution with the wrong order of 
                        
                           {
                           
                              
                                 c
                              
                              
                                 l
                              
                           
                           }
                        
                      in the simulation. To escape from that, we perform the optimization of the order of labels at the early stage of simulation. The convergence of the Monte Carlo method can be improved by this process. Detailed process is described in Section 5.

In this section, we present the numerical comparison of two methods. We show the results of numerical experiments of both the graph cuts method and the Monte Carlo method applied to Eq. (4). It is noted that the two methods are applied to the same model, so that the strict comparison of the energy solutions is possible. As a trial image, we use the gray scale MRI image of brain with tumor shown in Fig. 3
                     . The system size of the trial image is 
                        
                           192
                           ×
                           192
                        
                     . We start with considering the case that the number of phases, n, is four.

We first explain the initial condition of the graph cuts method. The initial pattern of the graph cuts method is provided by the isodata algorithm [32]. The output of the isodata algorithm is not uniquely determined, but different outputs of the isodata algorithm yield almost the same solution through the graph cuts method, except for special cases. So we present a typical single solution of the graph cuts method below. In Fig. 4
                     , we show an output image, 
                        
                           ϕ
                        
                     , of the isodata algorithm with four phases for this MRI trial image. There, the histogram of the intensity, luminance, for each phase 1–4 is also given. The histogram indicates that the isodata algorithm is image thresholding.

The simulation schedule of the Monte Carlo method is given as follows; for the first 75 MCS the reduced system size is 
                        
                           24
                           ×
                           24
                        
                     , that is, the block level is 3, see [21] for precise definition of block level; from 76 to 150 MCS the reduced system size is 
                        
                           48
                           ×
                           48
                        
                     , that is, the block level is 2; from 151 to 300 MCS the reduced system size is 
                        
                           96
                           ×
                           96
                        
                     , that is, the block level is 1; from 301 to 600 MCS we treat the original system size 
                        
                           192
                           ×
                           192
                        
                     . The illustration of the schedule of the Monte Carlo method is shown in Fig. 5
                     . We set the initial temperature as 
                        
                           T
                           =
                           1500
                        
                     , and gradually reduce the temperature by 
                        
                           T
                           =
                           0.98
                           T
                        
                      for every 10 steps. With the block level t, we set 
                        
                           
                              
                                 μ
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 μ
                              
                              
                                 0
                              
                           
                           /
                           
                              
                                 2
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 μ
                              
                              
                                 0
                              
                           
                        
                      is used at zero block level. We start with random configurations using 100 random numbers. In order to optimize the system energy about order of the label, we perform the process of checking the order of label. We make all the possible permutations of 
                        
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                        
                      for 
                        
                           {
                           
                              
                                 c
                              
                              
                                 l
                              
                           
                           }
                        
                     , then employ the configuration which gives the lowest energy among all the possible permutations. We perform this process of checking the order of label at the MCS when we change the block level, which we denote 
                        
                           
                              
                                 N
                              
                              
                                 L
                              
                           
                        
                     . That is, 
                        
                           
                              
                                 N
                              
                              
                                 L
                              
                           
                           =
                           75
                        
                      in this simulation, and it is also indicated in Fig. 5. The computational cost of this process is quite small, because it is performed in the smallest block-spin system and only once in the simulation. This process is not needed in the graph cuts method because the optimal order of labels is automatically determined by the isodata algorithm.

Now we show the results of the numerical simulation. For 
                        
                           μ
                           =
                           1000
                        
                     , the minimum energy by the graph cuts method was obtained as 
                        
                           1.04
                           ×
                           
                              
                                 10
                              
                              
                                 7
                              
                           
                        
                     . This energy is compared with the energy distribution of the Monte Carlo method in Fig. 6
                     (a). The energy of the graph cuts method with the isodata algorithm is shown by red line. About 90% of trials of the Monte Carlo method converge to the low-energy configurations which are very close to the minimum solution by the graph cuts method by Bae and Tai. We plot the data for the case of 
                        
                           μ
                           =
                           1800
                        
                      in Fig. 6(b). In this case, solutions of the Monte Carlo method are widely distributed. Compared with the graph cuts solution, about half of them give lower energy solution than the graph cuts, while the rest is converged to higher energy. It indicates that the graph cuts method with the initial values of isodata algorithm does not work well for some conditions. We also note that if we start with other initial patterns for the graph cuts method, for example, a random configuration, the graph cuts method gives solution far from the global minimum solution. For larger 
                        
                           μ
                           =
                           2600
                        
                      in Fig. 6(c), the situation is different. The energies of the Monte Carlo method are widely distributed, and the graph cuts method gives lower energy solution. It indicates that the Monte Carlo method is not good for this region of 
                        
                           μ
                        
                     .

Next, we focus on the lowest energy sample of two methods. In Fig. 7
                     , the lowest energy obtained by the Monte Carlo method is compared with that by the graph cuts method as a function of 
                        
                           μ
                        
                     , in the range of 
                        
                           0
                           ⩽
                           μ
                           ⩽
                           3000
                        
                     . For 
                        
                           μ
                           =
                           0
                           –
                           1400
                        
                     , the energies of both methods give almost the same results, but the Monte Carlo method gives a little bit higher energy because of residual thermal fluctuations. The typical output pattern obtained by two methods in this area are compared in Fig. 8
                     (a) for 
                        
                           μ
                           =
                           1000
                        
                     . The histogram of the intensity are also shown. The obtained patterns are very close to the output of the isodata algorithm shown in Fig. 4. On the other hand, for 
                        
                           μ
                           =
                           1600
                           –
                           2000
                        
                      in Fig. 7, the Monte Carlo method gives lower energy. According to the typical low-energy patterns in Fig. 8(b) for 
                        
                           μ
                           =
                           1800
                        
                     , the obtained patterns by the Monte Carlo method and the graph cuts method are different. The graph cuts method yields almost the same pattern as the case of 
                        
                           μ
                           =
                           1000
                        
                     . On the other hand, the pattern of the Monte Carlo method is different from that of the isodata algorithm, and it gives lower energy. Over 
                        
                           μ
                           =
                           2200
                        
                     , both methods yield almost the same patterns. It indicates that the initial pattern obtained by the isodata algorithm is not always good for larger 
                        
                           μ
                        
                      case. To see the roles of the data term and the regularization term clearly, we also show the contribution of each term in Fig. 7. In the case of the Monte Carlo method, the energy of regularization term becomes smaller and that of data term becomes larger above 
                        
                           μ
                           =
                           1200
                        
                     . This indicates that with the increase of 
                        
                           μ
                        
                     , the pattern of the solution changes from the pattern which gives priority to the data term to that to the regularization term, from the pattern with four-valued segmentation to the pattern with effectively three-valued segmentation in Fig. 8. In the case of the graph cuts method, the balance of two terms is changed above 
                        
                           μ
                           =
                           2200
                        
                     ; the change of output patterns is also visible in Fig. 8.

To summarize this section, the Monte Carlo method has advantage in robustness to initial conditions, and it easily approaches the good pattern that yields the low-energy solution. But because of thermal fluctuations, it is difficult to reach the exact global minimum solution. On the other hand, the multi-label graph cuts method due to Bae and Tai depends on initial conditions, but once an appropriate initial condition is set, it approaches the global minimum solution deterministically. For the initial configuration, the use of isodata algorithm works fairly good, but there are still cases that global minimum solution is not obtained; that is, the Monte Carlo method gives lower energy than the graph cuts method for large 
                        
                           μ
                        
                      where the competition of the data term and the regularization term is large.

As shown in Section 5, the graph cuts method sometimes suffered from local minimum solution for large 
                        
                           μ
                        
                     . Actually, the initialization by isodata algorithm yields a configuration close to the global energy solution in small 
                        
                           μ
                        
                      region. If parameter 
                        
                           μ
                        
                      becomes large, the pattern yielded by isodata algorithm is far from the global minimum solution because the spacial correlation is strong. Thus, other initialization schemes are needed for large 
                        
                           μ
                        
                     . We note that in the field of data mining there are many previous works about an initialization problem [35–37].

We here propose a hybrid method combining the advantages of the Monte Carlo method and the graph cuts method. The idea is that using the block-spin Monte Carlo method we search for a good initial configuration which takes into account the spacial correlation; then, we remove thermal fluctuations by the graph cuts method. It seems that the hybrid method needs more computational time than the graph cuts method or the Monte Carlo method. But actually we do not need much extra computational cost because we perform the Monte Carlo simulation only while the block-spin system size is small. We introduce the switching parameter 
                        
                           
                              
                                 N
                              
                              
                                 E
                              
                           
                        
                     , which is the MCS at which the Monte Carlo process be switched to the graph cuts process.

The detailed process of the hybrid method is given as follows:
                        
                           Step 1.
                           Set the initial configuration 
                                 
                                    
                                       
                                          {
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                             
                                          
                                          }
                                       
                                       
                                          0
                                       
                                    
                                 
                               randomly.

Apply the block-spin Monte Carlo method in order to search appropriate initial configuration for the graph cuts method. We perform the block-spin Monte Carlo simulation while MCS is less than 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          E
                                       
                                    
                                 
                              . When MCS is 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          E
                                       
                                    
                                 
                              , we resize the block-spin system to original system size. Let the obtained configuration be 
                                 
                                    
                                       
                                          {
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                             
                                          
                                          }
                                       
                                       
                                          1
                                       
                                    
                                 
                              .

Apply the graph cuts method with 
                                 
                                    
                                       
                                          {
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                             
                                          
                                          }
                                       
                                       
                                          1
                                       
                                    
                                 
                               as initial values.

The actual process of the hybrid method is illustrated in Fig. 9
                     .

In the Monte Carlo process of the above hybrid method, we perform the process of checking the order of label at 
                        
                           
                              
                                 N
                              
                              
                                 L
                              
                           
                        
                     , as already discussed in Section 5. We follow the same schedule as in Fig. 5 in Section 5; that is, 
                        
                           
                              
                                 N
                              
                              
                                 L
                              
                           
                           =
                           75
                        
                     . For 
                        
                           
                              
                                 N
                              
                              
                                 E
                              
                           
                        
                     , in this paper, we choose 
                        
                           
                              
                                 N
                              
                              
                                 E
                              
                           
                           =
                           150
                        
                      because this choice gives good results in terms of energy and computational time for various parameters. We will come back to this point at the end of this section.

Now we give the results of numerical experiments on our proposed hybrid method. Since the output of the Monte Carlo process is not uniquely determined, the graph cuts process gives different outputs in the hybrid method. To show this behavior, we plot the energy distribution of the solutions of the hybrid method for 100 samples in Fig. 10
                      for 
                        
                           μ
                        
                     
                     =1000, 1800 and 2600. The energy distribution for the Monte Carlo method is also shown in Fig. 10. The result of the graph cuts method with isodata initialization is indicated by red line for comparison. We see that there are distributions in energy, but the distribution of the hybrid method is clearly much narrower than the Monte Carlo method. The hybrid method is superior to the Monte Carlo method in both the quality of solution and the low-energy convergence. The graph cuts method with isodata initialization already gives the low enough energy for small 
                        
                           μ
                        
                     . But for larger 
                        
                           μ
                        
                     , the hybrid method leads to lower energy with high probability compared to the graph cuts method.

We show the lowest energy obtained by the hybrid method for 
                        
                           1000
                           ⩽
                           μ
                           ⩽
                           3000
                        
                      in Fig. 11
                     , where the data are compared with the other two results, those of the graph cuts method with the isodata initial values and those of the Monte Carlo method. For 
                        
                           μ
                           =
                           1000
                        
                     , three methods yield almost the same energy value and output pattern with four-valued segmentation. For 
                        
                           1200
                           ⩽
                           μ
                           <
                           2200
                        
                     , the Monte Carlo method gives lower energy than the graph cuts method because output pattern of the Monte Carlo method is changed to the lower-energy pattern with three-valued segmentation. The hybrid method yields much lower energy with the similar structure to the Monte Carlo pattern. For 
                        
                           2200
                           ⩽
                           μ
                        
                     , though the three methods yield the pattern with three-valued segmentation, we observe that the hybrid method yields lower energy than other two methods. That is, the hybrid method picks up the advantage of both methods, the graph cuts and the Monte Carlo method.

We here discuss the computational time. Table 1
                      compares the average computational time of three methods in units of msec in the range of 
                        
                           μ
                           =
                           1000
                        
                     –3000. In taking an average, we execute simulations for the hybrid method and the Monte Carlo method 100 times, and simulations for the graph cuts method initialized by the isodata Algorithm 5 times. The total computational times of the hybrid method are shown along with the time of the Monte Carlo part (MC) and the graph cuts part (GC). The table shows that the time of the Monte Carlo method is independent of the parameter 
                        
                           μ
                        
                     . The efficiency of the graph cuts method was reported to be very superior to previous methods [15,16]. According to Table 1, the Monte Carlo method with block-spin transformation is compatible to the graph cuts method. The average computational time of the hybrid method was even shorter than that of the graph cuts method. It is because the hybrid method starts from a better initial configuration close to the minimum energy solution, and the computational cost for estimating initial 
                        
                           ϕ
                        
                      is very small thanks to block-spin transformation.

So far we have shown the results for 
                        
                           n
                           =
                           4
                        
                      with MRI image input. We have checked other cases of 
                        
                           n
                           =
                           3
                           ,
                           6
                           ,
                           8
                        
                      and 10. We compare the results of the simulation of the hybrid method and those of the graph cuts method initialized by the isodata algorithm in the range of 
                        
                           0
                           ⩽
                           μ
                           ⩽
                           3000
                        
                     . In all cases, the hybrid method gives lower energy or the same energy compared to the result of the graph cuts method.

As an example, in Table 2
                     , we show the comparison of the average energy between the hybrid method and the graph cuts method for various n with 
                        
                           μ
                           =
                           1800
                        
                     . We also show the average computational time in Table 2. We can see that the hybrid method yields lower energy solution with shorter time especially in large n case. In Fig. 12
                     , we plot the distribution of the output energy by the hybrid method for 
                        
                           μ
                           =
                           1600
                        
                      with 
                        
                           n
                           =
                           6
                        
                     . We also give the data of the graph cuts method there. It shows that the hybrid method is better in energy. We also compare the output patterns of both methods in Fig. 12. In this case, the difference of the outputs is clear; the graph cuts method yields a kind of three-valued pattern, while the hybrid method yields a kind of four-valued pattern.

We also performed the numerical simulation for other input images. We first pick up one of standard images, a cameraman image. We compare the minimum energy between the hybrid method and the graph cuts method for 
                        
                           μ
                           ⩽
                           3000
                        
                      with 
                        
                           n
                           =
                           4
                        
                     , which is shown in Fig. 13
                     . The essential feature of the comparison is the same as the case of the MRI image input; the graph cuts method and the hybrid method yield almost the same result for small 
                        
                           μ
                        
                     , and the hybrid method yields lower-energy solutions for large 
                        
                           μ
                        
                     . The original image and the outputs of graph cuts method and the hybrid method (
                        
                           μ
                           =
                           3000
                        
                     ) are also shown. In Figs. 14 and 15
                     
                     , we plot the comparison of the minimum energy between the graph cuts method and the hybrid method for other standard images, the airplane image and boat image. The parameters are 
                        
                           n
                           =
                           4
                        
                      and 
                        
                           μ
                           ⩽
                           3000
                        
                     . In these cases again, the hybrid method gives lower energy compared to the graph cuts method for a wide range of 
                        
                           μ
                        
                     . The comparison of the minimum energy between the graph cuts method and the hybrid method for the lighthouse image is shown in Fig. 16
                      for 
                        
                           n
                           =
                           4
                        
                      and 
                        
                           μ
                           ⩽
                           3000
                        
                     . Since the graph cuts method already yields a good enough minimum energy, there is no appreciable difference between the graph cuts method and the hybrid method.

To conclude, we have shown that the hybrid method robustly works well irrespective of number of phases. We have checked for several input images that the hybrid method gives lower or the same energy than the graph cuts method in all the cases.

Here, we make a comment on the schedule of the hybrid method. In this paper, we showed the data with 
                        
                           
                              
                                 N
                              
                              
                                 L
                              
                           
                           =
                           75
                        
                      and 
                        
                           
                              
                                 N
                              
                              
                                 E
                              
                           
                           =
                           150
                        
                      because in most cases these choices yielded reasonable performance, that is, to get lower energy with short iteration process for the graph cuts process. The optimum values may depend on each image, parameter, etc. We emphasize that a very short-time rough calculation with large block spin level leads to good initial values for the graph cuts methods. If we spend too much time for Monte Carlo process, it may be trapped in a small local minimum. In such a case, an early switch to graph cuts method gives lower energy solution with shorter time.

In this paper, we proposed a hybrid method that combines the block-spin Monte Carlo method of Watanabe et al. [21] and the multi-label graph cuts method proposed by Bae and Tai [15,16]. This method picks up the advantages of both methods. The hybrid method has robustness to initial conditions, which is a typical advantage of the Monte Carlo method, and it easily approaches the global minimum energy solution to remove statistical fluctuations with high probability. Numerical experiments showed that our proposed method is efficient for a wide range of parameters 
                        
                           μ
                        
                     , although the graph cuts method failed in finding a global minimum energy solution for large 
                        
                           μ
                        
                     . The obtained energy of the hybrid method is lower than those of the other two methods, which was shown in Fig. 11. The computational time of our hybrid method is even shorter than that of the graph cuts method. It is because the hybrid method starts from a better initial configuration close to the minimum energy solution, and the computational cost for estimating initial configuration using the Monte Carlo method is very small because of block-spin transformation. These conclusions have been confirmed for many numbers of phases n and for various input images.

The graph-cuts method of Bae and Tai [15,16] has a restriction that the regularization term should be convex. But the idea of the hybrid method can be applied to the energy model with non-convex regularization term. We may use the Monte Carlo method in the early stage of simulation to offer an initial configuration for the 
                        
                           α
                           –
                           β
                        
                      swap graph cuts method. This idea can be used for the energy model with isotropic Potts regularization term, for example, although the 
                        
                           α
                           –
                           β
                        
                      swap is an approximated method for multi-phase segmentation. A preliminary test shows that this idea works well. Then, the hybrid method can be applied to a wide range of energy models.

For a future work, it is interesting to combine our method with basin-hopping [38]. Basin-hopping is a stochastic method that uses global updates to escape from local traps effectively. Previous work for Mumford–Shah segmentation model reported that high quality solution is obtained within 10 stochastic hops [34]. Our hybrid method can search for a pattern very close to global minimum energy solution, but there are still distributions in obtained energy. More improvement of convergence is expected with basin-hopping.

Our hybrid method is robust and very fast. In this paper we have shown that it takes only a few seconds for the two-dimensional test image with the size of 
                        
                           192
                           ×
                           192
                        
                     . The application to three-dimensional images, for example, the three-dimensional MRI image of brain [39], is highly interesting, which is now in progress.

@&#ACKNOWLEDGMENT@&#

This work was supported by a Grant-in-Aid for Scientific Research from the Japan Society for the Promotion of Science.

@&#REFERENCES@&#

