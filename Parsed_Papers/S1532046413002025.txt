@&#MAIN-TITLE@&#Foldover-free shape deformation for biomedicine

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           To propose a generalised algorithm for foldover-free deformation.


                        
                        
                           
                           The proposed iterative mechanism can guarantee the local invertibility of large deformations.


                        
                        
                           
                           The proposed iterative mechanism can be extended to other deformation scheme.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Shape deformation

Foldover

One-to-one mapping

@&#ABSTRACT@&#


               
               
                  Shape deformation as a fundamental geometric operation underpins a wide range of applications, from geometric modelling, medical imaging to biomechanics. In medical imaging, for example, to quantify the difference between two corresponding images, 2D or 3D, one needs to find the deformation between both images. However, such deformations, particularly deforming complex volume datasets, are prone to the problem of foldover, i.e. during deformation, the required property of one-to-one mapping no longer holds for some points. Despite numerous research efforts, the construction of a mathematically robust foldover-free solution subject to positional constraints remains open. In this paper, we address this challenge by developing a radial basis function-based deformation method. In particular we formulate an effective iterative mechanism which ensures the foldover-free property is satisfied all the time. The experimental results suggest that the resulting deformations meet the internal positional constraints. In addition to radial basis functions, this iterative mechanism can also be incorporated into other deformation approaches, e.g. B-spline based FFDs, to develop different deformable approaches for various applications.
               
            

@&#INTRODUCTION@&#

Shape deformation is an active topic of research in geometric modelling, biomechanics, and computational anatomy, which involves analysis and manipulation of 2D and 3D datasets. For instance, in computational anatomy, deformation techniques are usually deployed for accurate alignment of patient brain scans with a stereotactic atlas in order to quantify the morphology of anatomical structures. This is to understand the variability of brain anatomy by comparing and contrasting volumetric measurements between different patients, e.g. identifying the morphological elements that characterise the attributes of respective groups [2]. Moreover, high dimensional deformation techniques are useful not only in 3D volume data analysis, but also 4D flow MR Imaging. For example, 3D deformation fields can incorporate prior probability density functions from training sample sets into volume dataset segmentation and registration algorithms [22]. 4D-MRI further measures and visualises the temporal evolution of complex flow patterns in a 3D volume [5]. In biomechanics, deformation methods are used to mimic the static and dynamic behaviour of the objects inside the human body through the musculoskeletal model. This model is usually applied to the simulation of continuously deformable organs and tissues, such as muscles, ligaments and tendons [13]. The deformation of the tissue shape plays an important role in computing the muscles and joint forces using this model [15].

However, all the above mentioned techniques do encounter the same difficulty when the amount of deformation is large, which means that unexpected foldovers are likely to appear in the resulting deformations. In computational anatomy, this implies that the mapping between the source and target datasets is not injective. This is a tricky issue for many applications where large deformation is inevitable, such as landmark matching via large deformation [3,11,30]. Despite numerous effects, anomalies, including irregular edges, spikes and jumps, still appear in image warping [7]. In biomechanics, foldover will violate the constraint of topology preservation. One obvious case is that an improper deformation may cause an intersection between muscles and bones when simulating the human limb movement. In geometric modelling, foldovers often lead to self-intersection of the deformed surface. In general, there are two kinds of self-intersections, global intersection (e.g. intersection of different regions of a surface) and local self-intersection (e.g. adjacent faces/pixels overlapping). This paper focuses on the latter. The objective of our research is to develop a mechanism to ensure that large deformation does not result in mesh anomalies, i.e. the resulting datasets are foldover-free.

Our work here is primarily concerned with robust foldover-free deformations for high dimensional datasets. We first derive a general numerical condition, called the foldover-free condition, which guarantees no foldover occurs for an arbitrary dimensional dataset. Our main contribution is to formulate a generalised iterative deformation mechanism by incorporating this condition. We then employ radial basis functions (RBFs) to estimate the iterative step length. The second contribution of this paper is that the proposed iterative mechanism can guarantee the transformations locally invertible. Finally, the proposed iterative mechanism is further extended to other deformation schemes, e.g. B-spline based FFDs. This is the third contribution of this paper. Experiments will further validate the effectiveness and robustness of the proposed iterative algorithm in handling large deformations, some of which are topologically complex.

The paper is organised as follows. Section 2 briefly reviews the related work. Section 3 gives an overview of our foldover-free shape deformation method. In Section 4, we further describe the foldover-free iterative mechanism in detail. Applications and discussions are given in Section 5. The conclusions and future work are presented in Section 6.

@&#RELATED WORK@&#

Image registration is to determine the correspondence between the source and target images. Herein, shape deformation is described as the transformation between the source and target domain. For medical imaging, the mapping is from 3D to 3D in general, and is nonlinear (or nonrigid) in practice. A desirable property is the preservation of the topology of anatomical structures, which is closely related to the property of one-to-one mapping of the transformation. There is an extensive literature that addresses both the theoretical aspects of nonrigid image registration and practical implementations. For a detailed review, the reader is referred to [10]. Herein, we focus on a subcategory, the basis function expansions. The transformations can be based on radial basis functions [23], B-splines [19] or wavelets [21]. They are smooth and can effectively handle large deformations. Additionally, from a numerical perspective, radial basis functions have a small number of degrees of freedom and can provide fast closed-form solutions. However, these traditional transformations are not invertible in general, i.e. they do not preserve the topology of an object. Recent works in computational anatomy [11,3] have presented the registration approaches based on diffeomorphic nonlinear transformations for one-to-one differential mappings. As applying viscous fluid flow models, diffeomorphic mappings can deal with large deformations. However, the challenge is to solve complex partial differential equations that integrate the velocity field over time along a geodesic path. The implementation thus involves a large number of degrees of freedom, resulting in high computational complexity. This makes such methods unattractive for clinical applications. How to overcome the non-invertibility of the traditional deformation approaches is becoming an active research issue.

In biomechanics, one often analyses and predicates the forces, stresses and strains that occur inside the human body during movement using a musculoskeletal model. For example, to model the limbs, muscles cannot be simply represented as a set of straight lines from the origin to insertion, as the complex morphology makes the muscles warp around passive structures, the bones. Computing the muscle forces had to take into account the bone shapes [15,6]. To estimate muscle parameters, the muscle boundaries of the quantitative CT scans were first manually traced at each vertebral level, then the 3D models of the individual muscles were reconstructed accordingly for parameter estimation in [1]. One challenge in their research is how to prevent the disappearance of existing or new structures during deformation. In another example of biomechanics research, a similar musculoskeletal model is developed for motion analysis, such as clinical gait analysis. Gait is a well-defined motion type that is a repetitive sequence occurring from heelstrike to heelstrike. Several biomechanical models of the lower limb have been developed for the computation of joint angles, joint forces and moments [16]. They have been applied to the investigation of treatment planning that addresses orthopaedic pathology and prevents injury. Similar to [1], they firstly measured a set of markers on the body and then retarget a standard 3D anatomy model accordingly for musculoskeletal modelling. It is essential to ensure the deformed 3D anatomy model is topology preserved.

Another important application of shape deformation is in CAD field. [8] gives a survey of spatial deformation methods. We only recap several papers here that address the self-intersection issue. [24] noted the “space-tearing” phenomenon and proposed the Simple Constrained Deformation (SCoDef), which assigns each constrained point an independent region of influence so that the deformation is bounded by a union of these spherical regions. Further work, e.g. Sweepers [25], Warp Sculpting [26], Blendeforming [27] and Vector-Field Based Deformation [28], also adopted the similar idea as SCoDef. Essentially, shape deformation requires that transformations must be invertible. Unfortunately, B-spline based FFD transformations are not invertible in general. Invertibility of transformations is the intrinsic property causing foldovers. Thus, it is meaningful to seek the invertible transformations for shape deformation. The distinct advantage of our proposed algorithm is to guarantee the local invertibility of large deformations. Additionally, many methods of shape deformation also suffer from undesired volume changes, even resulting in local self-intersection [29]. Shape- and volume-preserving deformation techniques are therefore receiving more and more attentions.

Considering a given dataset S in Rn
                     , a transformation U is a one-to-one mapping which maps the points X
                     ∊
                     S into the individual corresponding points U of another domain Ω in Rn
                      with arbitrary m constraint point pairs 
                        
                           (
                           
                              
                                 X
                              
                              
                                 i
                              
                              
                                 ∗
                              
                           
                           ↔
                           
                              
                                 U
                              
                              
                                 i
                              
                              
                                 ∗
                              
                           
                           )
                        
                     , i.e.
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                X
                                                ∈
                                                S
                                                →
                                                U
                                                (
                                                X
                                                )
                                                ∈
                                                Ω
                                             
                                          
                                          
                                             
                                                subject to
                                                
                                                U
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                )
                                                =
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                ,
                                                
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     Our algorithm is developed based on radial basis functions (RBFs). This is due to many well behaved properties of the RBF scheme, e.g. mesh-free, C
                     2 continuous and ability to handle large deformations. In particular the RBF scheme is very suitable for the implementation of the positional constraint based deformation, since the radial basis functions simplify the multidimensional representation of the deformation through a radial distance metric. In contrast, B-spline expansions conventionally use the linear combinations of univariate forms to construct multidimensional basis functions. Extending from the bivariate to a trivariate case, there is a proliferation in control points that makes B-spline based FFDs difficult in practice [8]. Therefore, using RBFs will not lead to any new control points both for triangular meshes and tetrahedral ones.

Unlike the previous applications of RBFs [9,20], in our algorithm, the RBF scheme is used to compute the displacement of the point’s coordinates, that is, the deformation fields,
                        
                           (1)
                           
                              Δ
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              (
                              X
                              )
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                    
                                    
                                       m
                                    
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    ij
                                 
                              
                              ϕ
                              (
                              ‖
                              X
                              -
                              
                                 
                                    C
                                 
                                 
                                    j
                                 
                              
                              ‖
                              )
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                           
                        
                     where the displacement is represented as a vector of ΔU
                     =(Δu
                     1,…,Δun
                     )
                        T
                     , RBF coefficients denote 
                        
                           
                              
                                 λ
                              
                              
                                 ij
                              
                           
                        
                     , Cj
                     
                     ∊
                     Rn
                      represents the constraint points in Ω, and Pi
                     (X) is an affine transformation, i.e. 
                        
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           (
                           X
                           )
                           =
                           
                              
                                 a
                              
                              
                                 i
                                 0
                              
                           
                           +
                           
                              
                                 ∑
                              
                              
                                 k
                                 =
                                 1
                              
                              
                                 n
                              
                           
                           
                              
                                 a
                              
                              
                                 ik
                              
                           
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                        
                      (herein, aik
                     ,
                     k
                     =0,1,…
                     n are affine coefficients), n stands for the dimensionality of the datasets. Our intention is to introduce foldover-free constraints through the deformation fields of Eq. (1).

Although there are various forms of radial basis functions, we utilise the thin plate spline (TPS) as the basis functions ϕ here rather than others, e.g. multiquadric interpolation (MQ). This is because for the large and global deformation, TPS performances better than MQ [23]. The deformed U is obtained by updating U(X)=
                     X
                     +ΔU. For next iteration, let X
                     ←
                     U(X).

Our deformation algorithm is summarised as below. The proposed algorithm is executed iteratively, and the superscript j stands for the iteration index below. m points in the dataset are constrained to the specified positions: 
                        
                           
                              
                                 C
                              
                              
                                 i
                              
                              
                                 (
                                 0
                                 )
                              
                           
                        
                      denotes the initial positions, and their destination locations are denoted as 
                        
                           
                              
                                 C
                              
                              
                                 i
                              
                              
                                 ∗
                              
                           
                           ,
                           i
                           =
                           1
                           ,
                           …
                           m
                        
                     . The iterative mechanism will be described in detail in the following section.
                        
                           
                              
                                 
                                    
                                       
                                          (1)
                                          
                                             Input: Initial dataset S
                                             (0) and a set of user-specified constraint point pairs 
                                                
                                                   (
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         (
                                                         0
                                                         )
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                   )
                                                   ,
                                                   i
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   m
                                                
                                             .


                                             Loop: estimate the scaling factor δ by Eq. (6) (see Section 4) based on the configuration of the current m constraint point pairs 
                                                
                                                   (
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         (
                                                         j
                                                         )
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                   )
                                                   ,
                                                   i
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   m
                                                
                                             .

Computing the current constraint points’ displacements by 
                                                
                                                   Δ
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         (
                                                         j
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   =
                                                   δ
                                                   (
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         (
                                                         j
                                                         )
                                                      
                                                   
                                                   )
                                                
                                             , such that 
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         (
                                                         j
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         (
                                                         j
                                                         )
                                                      
                                                   
                                                   +
                                                   Δ
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         (
                                                         j
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                
                                             .

Computing the displacements of points on S
                                             (j) by Eq. (A2) (see Appendix A) and updating S
                                             (j)
                                             →
                                             S
                                             (j+1).

End Loop until all 
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         (
                                                         j
                                                         )
                                                      
                                                   
                                                
                                              reach 
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                             .


                     Fig. 1
                      illustrates our RBF based deformation algorithm foldover-free under large deformation. For the sake of visualisation, our method is performed on a 2D mesh. Moreover, for some extreme deformations, the final deformed mesh may not always converge to the most ideal positions by our approach (see Fig. 1d). This may be because either the RBF scheme is not flexible enough or the foldover-free condition prevents the constrained points from reaching the desired locations. To deal with the extreme deformations, a simple strategy is to subdivide meshes (or tetrahedral ones), so as to make the mesh more flexible as shown in Fig. 1e.

From a mathematical point of view, a “foldover-free” deformation gives a “one-to-one” mapping between the original surfaces (or datasets) and their target domains. We will first formulate a foldover-free condition, and then explain our iterative mechanism in a general form.

The goal of our work is to develop a foldover-free deformation approach with a set of the positional constraints. It requires that the mapping U(X) be globally univalent or “globally one-to-one”, that is, the topology or the connection relationship between any pair of vertices in the datasets should remain unchanged before and after the deformation. Mathematically it means the determinant of the Jacobian matrix must be positive everywhere,
                           
                              (2)
                              
                                 det
                                 (
                                 ∇
                                 U
                                 )
                                 >
                                 0
                                 .
                              
                           
                        
                     

According to the Gershgorin circle theorem, a sufficient condition of satisfying Eq. (2) can be given as,
                           
                              (3)
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 >
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                          ,
                                          j
                                          ≠
                                          i
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where i
                        =1,…,
                        n. The geometric meaning of Eq. (3) is that the vectors ∂ui
                        /∂(x
                        1,…,
                        xn
                        ) are linearly independent of each other. For 2D scenarios, this implies that the included angle of the vectors is less than π. For 3D scenarios, such three vectors should not be co-planar. Eq. (3) is called the foldover-free condition.

Our deformation algorithm employs an iterative framework and the displacements of vertices are determined considering the condition of Eq. (3), which eliminates foldovers. To this end, we need to limit the length of each displacement vector by introducing a scaling factor δ. Herein we firstly illustrate the geometric meaning of the sufficient condition Eq. (3) as below, and then show the scaling factor δ as the iterative steplength.

The regions of the 1st order partial derivatives in Rn
                         defined by Eq. (3) can be further described as follows, i
                        =1,…,
                        n,
                           
                              (4)
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 δ
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            ,
                                                            …
                                                            ,
                                                            1
                                                            +
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            …
                                                            ,
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   :
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  M
                                                               
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        j
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  K
                                                               
                                                               
                                                                  -
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Δ
                                                                              
                                                                                 
                                                                                    c
                                                                                 
                                                                                 
                                                                                    i
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              0
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   δ
                                                   ,
                                                   
                                                   j
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   n
                                                
                                             
                                             
                                                
                                                   1
                                                   +
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   >
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            =
                                                            1
                                                            ,
                                                            j
                                                            ≠
                                                            i
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   |
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where (r
                        1,…,1+
                        ri
                        ,…,
                        rn
                        ) denotes a point in Ωi
                        (δ), 
                           
                              Δ
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          Δ
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          Δ
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                           
                         denotes as the displacements of all the constraint points, K is a symmetric matrix filled with the radial basis functions ϕkj
                        
                        =
                        ϕ(‖Ck
                        
                        −
                        Cj
                        ‖),
                        k,
                        j
                        =1,…,
                        m and the constraint points’ coordinates, M(X)=(ϕ(‖X
                        −
                        C
                        1‖),…,
                        ϕ(‖X
                        -
                        Cm
                        ‖),
                        x
                        1,…,
                        xn
                        ,1) and 
                           
                              
                                 
                                    M
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                           
                         denote the partial derivatives of M(X) (For details, refer to Appendix A). The scaling factor δ is not a constant, and depends on the displacements of the constraint points. For simplicity, assume that the vectors {Δci
                        } have the same distribution. The regions Ωi
                        (δ) would then have the same size in terms of Eq. (4). In an n-dimensional Euclidean space, the condition of Eq. (3) can be described as,
                           
                              (5)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   M
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   K
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Δ
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       2
                                    
                                 
                                 <
                                 
                                    
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 ,
                              
                           
                        for the region Ωi
                        (δ) and i
                        =1,…,
                        n.

To further illustrate the geometric meaning of Eq. (4), we consider both 2D and 3D scenarios here. When n
                        =2, Eq. (4) is expressed as,
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Ω
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   δ
                                                   )
                                                   =
                                                   
                                                      
                                                         
                                                            (
                                                            1
                                                            +
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            )
                                                            :
                                                            |
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            |
                                                            ⩽
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           M
                                                                        
                                                                        
                                                                           x
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           K
                                                                        
                                                                        
                                                                           -
                                                                           1
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       Δ
                                                                                       
                                                                                          
                                                                                             c
                                                                                          
                                                                                          
                                                                                             1
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                                 
                                                                                    
                                                                                       0
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            δ
                                                            ,
                                                            |
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            |
                                                            ⩽
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           M
                                                                        
                                                                        
                                                                           y
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           K
                                                                        
                                                                        
                                                                           -
                                                                           1
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       Δ
                                                                                       
                                                                                          
                                                                                             c
                                                                                          
                                                                                          
                                                                                             1
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                                 
                                                                                    
                                                                                       0
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            δ
                                                            ,
                                                            1
                                                            +
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            >
                                                            |
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            |
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Ω
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   δ
                                                   )
                                                   =
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            ,
                                                            1
                                                            +
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            )
                                                            :
                                                            |
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            |
                                                            ⩽
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           M
                                                                        
                                                                        
                                                                           x
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           K
                                                                        
                                                                        
                                                                           -
                                                                           1
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       Δ
                                                                                       
                                                                                          
                                                                                             c
                                                                                          
                                                                                          
                                                                                             2
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                                 
                                                                                    
                                                                                       0
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            δ
                                                            ,
                                                            |
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            |
                                                            ⩽
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           M
                                                                        
                                                                        
                                                                           y
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           K
                                                                        
                                                                        
                                                                           -
                                                                           1
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       Δ
                                                                                       
                                                                                          
                                                                                             c
                                                                                          
                                                                                          
                                                                                             2
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                                 
                                                                                    
                                                                                       0
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            δ
                                                            ,
                                                            1
                                                            +
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            >
                                                            |
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            |
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                        Fig. 2
                         illustrates the regions of Ω
                        1(δ),
                        Ω
                        2(δ). The dashed line is used to highlight these undetermined boundaries. The condition of Eq. (3) implies that vectors ∂u/∂(x,
                        y),∂v/∂(x,
                        y) should be linearly independent of each other. Fig. 2 intuitively illustrates this concept by five lines: l
                        1,
                        l
                        2,
                        l
                        3,
                        l
                        4,
                        l
                        5. For example, r
                        1 and r
                        2 should be above line l
                        3 or under line l
                        4, and above line l
                        5, so that the linear independence can be guaranteed. This can be achieved by the scaling factor δ in Eq. (4). Moreover, for simplicity, assume that the vectors Δc
                        1,Δc
                        2 have the same distribution. The regions Ω
                        1(δ),
                        Ω
                        2(δ) would then have the same size in terms of Eq. (4). This will lead to the overlap of straight lines l
                        1 and l
                        2 and form a new dividing line, which is r
                        1
                        +
                        r
                        2
                        =0 in Fig. 2. Line r
                        1
                        +
                        r
                        2
                        =0 guarantees that the included angle is less than π. Consequently, the 2D form of the condition Eq. (5) can be re-formulated as,
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     M
                                                                  
                                                                  
                                                                     x
                                                                  
                                                               
                                                               
                                                                  
                                                                     K
                                                                  
                                                                  
                                                                     -
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 Δ
                                                                                 
                                                                                    
                                                                                       c
                                                                                    
                                                                                    
                                                                                       1
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 0
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     M
                                                                  
                                                                  
                                                                     y
                                                                  
                                                               
                                                               
                                                                  
                                                                     K
                                                                  
                                                                  
                                                                     -
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 Δ
                                                                                 
                                                                                    
                                                                                       c
                                                                                    
                                                                                    
                                                                                       1
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 0
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   <
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     M
                                                                  
                                                                  
                                                                     x
                                                                  
                                                               
                                                               
                                                                  
                                                                     K
                                                                  
                                                                  
                                                                     -
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 Δ
                                                                                 
                                                                                    
                                                                                       c
                                                                                    
                                                                                    
                                                                                       2
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 0
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     M
                                                                  
                                                                  
                                                                     y
                                                                  
                                                               
                                                               
                                                                  
                                                                     K
                                                                  
                                                                  
                                                                     -
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 Δ
                                                                                 
                                                                                    
                                                                                       c
                                                                                    
                                                                                    
                                                                                       2
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 0
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   <
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

When n
                        =3, Eq. (4) is given by,
                           
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 δ
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   1
                                                   +
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                   :
                                                   |
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   |
                                                   ⩽
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  M
                                                               
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               
                                                                  K
                                                               
                                                               
                                                                  -
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Δ
                                                                              
                                                                                 
                                                                                    c
                                                                                 
                                                                                 
                                                                                    1
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              0
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   δ
                                                   ,
                                                
                                             
                                             
                                                
                                                   |
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   |
                                                   ⩽
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  M
                                                               
                                                               
                                                                  y
                                                               
                                                            
                                                            
                                                               
                                                                  K
                                                               
                                                               
                                                                  -
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Δ
                                                                              
                                                                                 
                                                                                    c
                                                                                 
                                                                                 
                                                                                    1
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              0
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   δ
                                                   ,
                                                
                                             
                                             
                                                
                                                   |
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   |
                                                   ⩽
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  M
                                                               
                                                               
                                                                  z
                                                               
                                                            
                                                            
                                                               
                                                                  K
                                                               
                                                               
                                                                  -
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Δ
                                                                              
                                                                                 
                                                                                    c
                                                                                 
                                                                                 
                                                                                    1
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              0
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   δ
                                                   ,
                                                   1
                                                   +
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   >
                                                   |
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   |
                                                   +
                                                   |
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   |
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 δ
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   1
                                                   +
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                   :
                                                   |
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   |
                                                   ⩽
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  M
                                                               
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               
                                                                  K
                                                               
                                                               
                                                                  -
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Δ
                                                                              
                                                                                 
                                                                                    c
                                                                                 
                                                                                 
                                                                                    2
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              0
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   δ
                                                   ,
                                                
                                             
                                             
                                                
                                                   |
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   |
                                                   ⩽
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  M
                                                               
                                                               
                                                                  y
                                                               
                                                            
                                                            
                                                               
                                                                  K
                                                               
                                                               
                                                                  -
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Δ
                                                                              
                                                                                 
                                                                                    c
                                                                                 
                                                                                 
                                                                                    2
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              0
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   δ
                                                   ,
                                                
                                             
                                             
                                                
                                                   |
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   |
                                                   ⩽
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  M
                                                               
                                                               
                                                                  z
                                                               
                                                            
                                                            
                                                               
                                                                  K
                                                               
                                                               
                                                                  -
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Δ
                                                                              
                                                                                 
                                                                                    c
                                                                                 
                                                                                 
                                                                                    2
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              0
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   δ
                                                   ,
                                                   1
                                                   +
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   >
                                                   |
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   |
                                                   +
                                                   |
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   |
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 δ
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   1
                                                   +
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                   :
                                                   |
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   |
                                                   ⩽
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  M
                                                               
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               
                                                                  K
                                                               
                                                               
                                                                  -
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Δ
                                                                              
                                                                                 
                                                                                    c
                                                                                 
                                                                                 
                                                                                    3
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              0
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   δ
                                                   ,
                                                
                                             
                                             
                                                
                                                   |
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   |
                                                   ⩽
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  M
                                                               
                                                               
                                                                  y
                                                               
                                                            
                                                            
                                                               
                                                                  K
                                                               
                                                               
                                                                  -
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Δ
                                                                              
                                                                                 
                                                                                    c
                                                                                 
                                                                                 
                                                                                    3
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              0
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   δ
                                                   ,
                                                
                                             
                                             
                                                
                                                   |
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   |
                                                   ⩽
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  M
                                                               
                                                               
                                                                  z
                                                               
                                                            
                                                            
                                                               
                                                                  K
                                                               
                                                               
                                                                  -
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Δ
                                                                              
                                                                                 
                                                                                    c
                                                                                 
                                                                                 
                                                                                    3
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              0
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   δ
                                                   ,
                                                   1
                                                   +
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   >
                                                   |
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   |
                                                   +
                                                   |
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   |
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     


                        Fig. 3
                         shows the regions of Ω
                        1(δ),
                        Ω
                        2(δ),
                        Ω
                        3(δ). Taking the condition of Eq. (3) into account, we hope to point out that the dividing plane of r
                        1
                        +
                        r
                        2
                        +
                        r
                        3
                        =0 guarantees that the determinant of Jacobian is greater than zero. Similar to the 2D scenarios, the 3D form of the condition Eq. (5) is expressed as,
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     M
                                                                  
                                                                  
                                                                     x
                                                                  
                                                               
                                                               
                                                                  
                                                                     K
                                                                  
                                                                  
                                                                     -
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 Δ
                                                                                 
                                                                                    
                                                                                       c
                                                                                    
                                                                                    
                                                                                       1
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 0
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     M
                                                                  
                                                                  
                                                                     y
                                                                  
                                                               
                                                               
                                                                  
                                                                     K
                                                                  
                                                                  
                                                                     -
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 Δ
                                                                                 
                                                                                    
                                                                                       c
                                                                                    
                                                                                    
                                                                                       1
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 0
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     M
                                                                  
                                                                  
                                                                     z
                                                                  
                                                               
                                                               
                                                                  
                                                                     K
                                                                  
                                                                  
                                                                     -
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 Δ
                                                                                 
                                                                                    
                                                                                       c
                                                                                    
                                                                                    
                                                                                       1
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 0
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   <
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              M
                                                                           
                                                                           
                                                                              x
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              K
                                                                           
                                                                           
                                                                              -
                                                                              1
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          Δ
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                2
                                                                                             
                                                                                          
                                                                                       
                                                                                    
                                                                                    
                                                                                       
                                                                                          0
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  δ
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              M
                                                                           
                                                                           
                                                                              y
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              K
                                                                           
                                                                           
                                                                              -
                                                                              1
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          Δ
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                2
                                                                                             
                                                                                          
                                                                                       
                                                                                    
                                                                                    
                                                                                       
                                                                                          0
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  δ
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              M
                                                                           
                                                                           
                                                                              z
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              K
                                                                           
                                                                           
                                                                              -
                                                                              1
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          Δ
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                2
                                                                                             
                                                                                          
                                                                                       
                                                                                    
                                                                                    
                                                                                       
                                                                                          0
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  δ
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            <
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              M
                                                                           
                                                                           
                                                                              x
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              K
                                                                           
                                                                           
                                                                              -
                                                                              1
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          Δ
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                3
                                                                                             
                                                                                          
                                                                                       
                                                                                    
                                                                                    
                                                                                       
                                                                                          0
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  δ
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              M
                                                                           
                                                                           
                                                                              y
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              K
                                                                           
                                                                           
                                                                              -
                                                                              1
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          Δ
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                3
                                                                                             
                                                                                          
                                                                                       
                                                                                    
                                                                                    
                                                                                       
                                                                                          0
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  δ
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              M
                                                                           
                                                                           
                                                                              z
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              K
                                                                           
                                                                           
                                                                              -
                                                                              1
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          Δ
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                3
                                                                                             
                                                                                          
                                                                                       
                                                                                    
                                                                                    
                                                                                       
                                                                                          0
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  δ
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            <
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

In terms of Eq. (5), every region can provide their individual estimations of the scaling factor. For the entire dataset S, it is straightforward to select the minimum as the estimation of δ as below,
                           
                              (6)
                              
                                 δ
                                 =
                                 
                                    
                                       
                                          min
                                       
                                       
                                          X
                                          ∈
                                          S
                                       
                                    
                                 
                                 δ
                                 (
                                 X
                                 )
                              
                           
                        where
                           
                              
                                 δ
                                 (
                                 X
                                 )
                                 =
                                 
                                    
                                       
                                          min
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               j
                                                               =
                                                               1
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        M
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              x
                                                                           
                                                                           
                                                                              j
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        K
                                                                     
                                                                     
                                                                        -
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    Δ
                                                                                    
                                                                                       
                                                                                          c
                                                                                       
                                                                                       
                                                                                          i
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                              
                                                                                 
                                                                                    0
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                -
                                                1
                                                /
                                                2
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Note that vectors Δci
                        ,
                        i
                        =1,…,
                        n are the differences of the current constraint point positions and their individual destinations’ positions. Scaling factor δ depends on the configuration of the current constraint points. For any constraint point Ci
                        , its displacement needs to be scaled by δ iteratively to approximate its destination 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                                 
                                    ∗
                                 
                              
                           
                        . The configuration of all the current constraint points may be defined as the current state of the dataset. When the constraint points’ positions are updated, the state is changed accordingly. Thus, δ can also be regarded as the iterative step length.

So far we have outlined the proposed iterative deformation mechanism and estimated the scaling factor. The displacements of the constraint points are adaptively changed based on the estimated scaling factor δ of Eq. (6). We also hope to point out that Eq. (6) is a sufficient condition, which means that there might be scenarios where Eq. (6) is not satisfied, but still is foldover-free. There is a simple explanation, that is, the scaling factor is estimated by the regions defined on continuous domains. Compared to continuous domains, the discrete settings (e.g. triangle mesh) are too sparse. Thus, Eq. (6) seems to be overstrict to the discrete settings. What can be guaranteed however is by satisfying Eq. (6), we can both eliminate all possible cases of foldovers and preserve mesh topology.

B-spline based FFD approaches have been widely applied to various geometric modelling applications. We can extend the iterative deformation mechanism to include the B-spline scheme. Without loss of generality, a 2D cubic B-spline function is represented by a patch as follows,
                           
                              (7)
                              
                                 U
                                 (
                                 X
                                 )
                                 =
                                 X
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          3
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          3
                                       
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 w
                                 )
                                 
                                    
                                       B
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 v
                                 )
                                 Δ
                                 
                                    
                                       C
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                              
                           
                        where 0<
                        w,
                        v
                        <1, Bi
                        ,
                        Bj
                         denote the basis functions, and ΔCij
                         denotes the displacement vector of the control points. According to Eq. (7), the deformation field X is updated by X
                        ←
                        U(X) in an iterative way. We can deduce the scaling factor δ as,
                           
                              (8)
                              
                                 δ
                                 =
                                 
                                    min
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          
                                                                                             
                                                                                                B
                                                                                             
                                                                                             
                                                                                                w
                                                                                             
                                                                                          
                                                                                          (
                                                                                          Δ
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                1
                                                                                             
                                                                                          
                                                                                          )
                                                                                       
                                                                                       
                                                                                          
                                                                                             
                                                                                                B
                                                                                             
                                                                                             
                                                                                                w
                                                                                             
                                                                                          
                                                                                          (
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                1
                                                                                             
                                                                                          
                                                                                          )
                                                                                       
                                                                                    
                                                                                    +
                                                                                    
                                                                                       
                                                                                          
                                                                                             
                                                                                                B
                                                                                             
                                                                                             
                                                                                                v
                                                                                             
                                                                                          
                                                                                          (
                                                                                          Δ
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                1
                                                                                             
                                                                                          
                                                                                          )
                                                                                       
                                                                                       
                                                                                          
                                                                                             
                                                                                                B
                                                                                             
                                                                                             
                                                                                                v
                                                                                             
                                                                                          
                                                                                          (
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                1
                                                                                             
                                                                                          
                                                                                          )
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              2
                                                                           
                                                                        
                                                                        +
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          
                                                                                             
                                                                                                B
                                                                                             
                                                                                             
                                                                                                w
                                                                                             
                                                                                          
                                                                                          (
                                                                                          Δ
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                1
                                                                                             
                                                                                          
                                                                                          )
                                                                                       
                                                                                       
                                                                                          
                                                                                             
                                                                                                B
                                                                                             
                                                                                             
                                                                                                w
                                                                                             
                                                                                          
                                                                                          (
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                2
                                                                                             
                                                                                          
                                                                                          )
                                                                                       
                                                                                    
                                                                                    +
                                                                                    
                                                                                       
                                                                                          
                                                                                             
                                                                                                B
                                                                                             
                                                                                             
                                                                                                v
                                                                                             
                                                                                          
                                                                                          (
                                                                                          Δ
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                1
                                                                                             
                                                                                          
                                                                                          )
                                                                                       
                                                                                       
                                                                                          
                                                                                             
                                                                                                B
                                                                                             
                                                                                             
                                                                                                v
                                                                                             
                                                                                          
                                                                                          (
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                2
                                                                                             
                                                                                          
                                                                                          )
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              2
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         -
                                                         1
                                                         /
                                                         2
                                                      
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          
                                                                                             
                                                                                                B
                                                                                             
                                                                                             
                                                                                                w
                                                                                             
                                                                                          
                                                                                          (
                                                                                          Δ
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                2
                                                                                             
                                                                                          
                                                                                          )
                                                                                       
                                                                                       
                                                                                          
                                                                                             
                                                                                                B
                                                                                             
                                                                                             
                                                                                                w
                                                                                             
                                                                                          
                                                                                          (
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                1
                                                                                             
                                                                                          
                                                                                          )
                                                                                       
                                                                                    
                                                                                    +
                                                                                    
                                                                                       
                                                                                          
                                                                                             
                                                                                                B
                                                                                             
                                                                                             
                                                                                                v
                                                                                             
                                                                                          
                                                                                          (
                                                                                          Δ
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                2
                                                                                             
                                                                                          
                                                                                          )
                                                                                       
                                                                                       
                                                                                          
                                                                                             
                                                                                                B
                                                                                             
                                                                                             
                                                                                                v
                                                                                             
                                                                                          
                                                                                          (
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                1
                                                                                             
                                                                                          
                                                                                          )
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              2
                                                                           
                                                                        
                                                                        +
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          
                                                                                             
                                                                                                B
                                                                                             
                                                                                             
                                                                                                w
                                                                                             
                                                                                          
                                                                                          (
                                                                                          Δ
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                2
                                                                                             
                                                                                          
                                                                                          )
                                                                                       
                                                                                       
                                                                                          
                                                                                             
                                                                                                B
                                                                                             
                                                                                             
                                                                                                w
                                                                                             
                                                                                          
                                                                                          (
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                2
                                                                                             
                                                                                          
                                                                                          )
                                                                                       
                                                                                    
                                                                                    +
                                                                                    
                                                                                       
                                                                                          
                                                                                             
                                                                                                B
                                                                                             
                                                                                             
                                                                                                v
                                                                                             
                                                                                          
                                                                                          (
                                                                                          Δ
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                2
                                                                                             
                                                                                          
                                                                                          )
                                                                                       
                                                                                       
                                                                                          
                                                                                             
                                                                                                B
                                                                                             
                                                                                             
                                                                                                v
                                                                                             
                                                                                          
                                                                                          (
                                                                                          
                                                                                             
                                                                                                c
                                                                                             
                                                                                             
                                                                                                2
                                                                                             
                                                                                          
                                                                                          )
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              2
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         -
                                                         1
                                                         /
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        (For the details of computation, refer to Appendix B please.) For a 3D cubic B-spline scheme, we can yield an analogous estimation of δ, as well as Eq. (8).

For simplicity, in our implementations, our deformation algorithm presented in Section 3 employs the RBF scheme rather than the B-spline one. This is because extending the B-spline scheme from the bivariate to trivariate case will involve a large number of control points. To highlight the advantage of the proposed iterative deformation mechanism, we perform the deformation separately by our iterative algorithm (i.e. with constraint the scaling factor) and the non-iterative RBF scheme (i.e. without constraint of the scaling factor) in the following.

This section will first illustrate some interesting properties of the proposed algorithm and then address some important applications on medical imaging and biomechanics.

In general, to estimate the scaling factor δ, it is required to test all the points X within a dataset. However, our observation suggests that the constraint points always hold larger displacements than the others at each iteration. Thus, it is sufficient to estimate the δ only by testing the constraint points instead of all the points.

Volume preservation is one of the desired properties for shape deformation. [18] proposed to firstly embed triangular meshes into tetrahedral ones and then perform some deformation approaches directly on the tetrahedral meshes. However, this usually leads to a large computational burden. Since the RBF scheme is mesh-free, our deformation algorithm will not incur extra computational cost. To illustrate the effectiveness of our algorithm, Fig. 4
                         shows some extreme deformation examples, i.e. a bar is firstly twisted by 360° and then bent by 150°. Notice that taking into account the volume, it is natural to place some constrained points manually along the skeleton of an object, e.g. 5 constrained points on the skeletons of the bar. This is similar to the ideas of the sketch-based editing system [14] and the skeleton-curve deformation method [24]. The user does not necessarily need to place the constraint points on the precise skeletons of the objects. In our implementation, imprecise skeleton constrained points are fine, which guides to the desired shape.

The core of our RBF-based deformation approach is to update the RBF coefficients at each iteration. The main cost is therefore to compute the inverse of a real symmetric matrix, which costs O(nm
                           3), where m is the number of the constraint points and n denotes the dimensionality of the dataset. The time complexity can be estimated as O(knm
                           3), where k denotes the iteration number. However, in practice, updating the whole dataset costs the most of the running time compared to updating the RBF coefficients, e.g. volume data. This is because the number of constraint points is always far smaller than that of the points within a dataset. And our algorithm usually converges with 3–6 iterations. Although it is usually costly to invert a matrix, because the dimension of the matrices to be inverted is small, in practice the cost is negligible.

@&#LIMITATIONS@&#

Our iterative deformation mechanism guarantees to produce diffeomorphic deformation fields and the experiments in Figs. 1 and 4 also validate the effectiveness of handling large deformations. However it does not always guarantee to converge to the most ideal positions for large bending deformations. Experiments in Fig. 4 suggest that our approach can work well when the bending angle is less than 60°. Therefore, bending the bar by 150° in Fig. 4, we had to do it in steps. In this example, we bent the bar by 50° for each step for three steps.

Voxel-based volume deformation has been widely used in image segmentation and registration, e.g. CT and MRI datasets. Our iterative algorithm is suitable for the volume data, since the RBF scheme is mesh-free. Our algorithm can prevent foldovers with only a small number of constraint points. This is in contrast to the other non-iterative deformation methods, such as the B-spline FFDs, which cannot overcome this numerical difficulty even if many constraint points are added. For comparison, we performed a large deformation on the precentral gyrus of a segmented MRI brain volume dataset by a cubic B-spline FFDs [17] and our algorithm respectively, as shown in Fig. 5
                        a and d. Since we were concerned about the large deformation rather than image registration here, the cubic B-spline FFDs did not take into account the voxel intensity similarity measure, nor the constraint of the foldover-free condition. Foldovers within the volume deformation are usually hidden inside the volume dataset rather than on its surface. To see it clearly, we utilised the Marching Cubes to extract the isosurface for rendering purposes. This can highlight the foldovers occurred in the 3D volume data by comparing the meshes shown in Fig. 5c and f. One can note the self-intersections of triangles in Fig. 5c.

In the next example, we applied our deformation algorithm to the simulation of child brain development. We demonstrate that our method is very useful in the analysis of the pediatric and adult neuroimaging data in a common stereotactic space for developmental neuroscience. Growing from a child to an adult gives rise to a significant deformation of the brain, but matching both brain objects requires topology preservation. Due to the complex topological structure of the brain white matter, ensuring foldover-free during the deformation is essential. Fig. 6
                         shows the prediction growth of the segmented white matter of a 5-year child brain toward that of an adult brain. The segmented brain models and the relevant landmarks by experts are available on the Internet Brain Segmentation Repository (www.cma.mgh.harvard.edu/ibsr). Since the landmark correspondence depends on the expert, i.e. keep-the-user-in-the-loop paradigm, we were only able to obtain the correspondence of a small number of landmarks. Because of the limited landmark pairs, some local distortions are inevitable. In order to give a convincing prediction, we need to reduce the unwanted distortion as much as possible. In Fig. 6, we therefore deformed these two brain white matter models separately in the opposite directions.

In biomechanics, the dynamical behaviours are often analysed using a musculoskeletal model, where the forces, stresses and strains of the relevant tissues and organs are computed, because it is impossible to measure these quantities directly that occur inside the human body during an activity. One can first manually measure a set of markers placed on the skin and then retarget a standard human body anatomic model accordingly [13]. The resulting deformed model can be employed to estimate these quantities. Topology preservation is again a critical constraint for such a deformed model. In Fig. 7
                        , we retargeted the anatomic model of an ordinary human body to a much fatter body model based on a set of markers on the skin. The original human body model is reconstructed from the Visual Human Dataset. For comparison, Fig. 7b and c show the results of applying the non-iterative RBF scheme and our iterative approach respectively. It can be noted that our algorithm can effectively prevent the unexpected intersections of different tissues. Fig. 7b only shows the intersection of the muscles and the skin surface. Removing the skin layer, one can find the more unexpected intersections between muscles as shown in Fig. 7e.

Moreover, to simulate the kinematics of body limbs, muscles (or soft tissues) and their deformed shapes must be taken into account. For example, simulating the elbow bending and twisting, we need to calculate the joint angles, forces and moments. Such calculation is particularly sensitive to the deformed shapes of the muscles close to the joint rotation centres. Since many muscles (or soft tissues) wrap around more than one bone, any movement must avoid bone-muscle penetration [6,15]. Simulating such activities without taking care of the anatomical structure tends to result in unexpected intersections. Fig. 8
                         shows the results of bending the elbow (around 75°) and turning the forearm upward (around 70°) by our iterative algorithm. For comparison, we also performed the conventional non-iterative RBF scheme here. The intersections of tissues are indicated by the arrows. In this experiment, the movement of the forearm’s skeleton is given in advance. The constrained points are placed on the bones. (For more details, refer to the video demos in the Supplementary Material.)


                        Fig. 9
                         shows an application of 3D muscle modelling for the ankle joint. [12] applied the musculoskeletal model to the biomechanical analysis of lateral ankle ligaments. They used a motion capture device to capture the left-legged jump shots of an athlete for the ankle joint parameter estimation. However, they did not further reconstruct the 3D models of muscles. [1] emphasised that the muscle parameters for musculoskeletal modelling, e.g. cross-sectional area and moment arm data, should be obtained based on 3D models of muscles. To this end, they extracted the 3D models of muscles from a set of the quantitative CT scans manually. In Fig. 9, we simulated the jumping/landing action for the left leg. 3D muscle modelling is performed by our shape deformation approach.

All the experiments were undertaken using Matlab on an Intel Pentium 4 3.2GHz PC with 1Gbyte of RAM. Although the code is far from optimised, because our method has a low computation complexity as discussed earlier, it is very fast for 2D meshes and 3D polyhedrons.

In this paper, we have incorporated the high dimensional deformable fields into the deformation of high-dimensional datasets, so that the deformed datasets both satisfy the positional constraints and preserve the topology. This is useful for the deformation of medical volume data and tetrahedral meshes due to its ability to handle the geometric complexity of such datasets. The RBF scheme maintains many good numerical properties, such as smoothness, flexibility and low degrees of freedom. But such traditional transformations are not invertible in general. Thus, they cannot preserve the topology during deformation. Our main contribution is to design the RBF-based functions that are diffeomorphic in an iterative way. We have also demonstrated that the proposed iterative mechanism can be extended to incorporate other deformation schemes, e.g. B-spline FFDs.

In our implementation, the thin-plate spline (TSP) is used as the radial basis function. TSP offers global support but not compact support. Compact support has the advantage of reducing the computational cost and is fast for optimisation. Thus, introducing the compact support RBF into our approach will be one of our future objectives. In addition, we also note that the RBF scheme does not work well when dealing with large bending deformations. The current strategy is to add several intermediate states of the constrained points, which works fine. This motives us to seek more powerful functions to overcome this weakness in our future work.

@&#ACKNOWLEDGEMENT@&#

This project is partially supported by the following research grants: National Science Council (contracts NSC-100-2628-E-006-031-MY3 and NSC-100-2221-E-006-188-MY3), Taiwan; Department of Business, Innovation and Skills of the British Government (Sino-UK Higher Education Research Partnership for PhD studies, 2012).

We rewrite Eq. (1) here, such that the displacements linearly depend on the constraint points. To this end, the RBF coefficients 
                        
                           (
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 a
                              
                              
                                 i
                              
                           
                           )
                        
                      can be computed by the following linear system, where 
                        
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             λ
                                          
                                          
                                             im
                                          
                                       
                                    
                                 
                              
                              
                                 T
                              
                           
                           ,
                           
                              
                                 a
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             i
                                             0
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             in
                                          
                                       
                                    
                                 
                              
                              
                                 T
                              
                           
                        
                     ,
                        
                           (A1)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    K
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                Δ
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                              .
                           
                        
                     Herein, there are m given constraint points. The displacements of all the constraint points are denoted as 
                        
                           Δ
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 
                                    
                                       Δ
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       Δ
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                              
                                 T
                              
                           
                        
                     . K is a symmetric matrix filled with the radial basis functions ϕkj
                     
                     =
                     ϕ(‖Ck
                     
                     −
                     Cj
                     ‖),
                     k,
                     j
                     =1,…,
                     m and the constraint points’ coordinates. (For a detailed RBF representation, refer to [4].)

Substituting 
                        
                           (
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 a
                              
                              
                                 i
                              
                           
                           )
                        
                      of Eq. (A1) into Eq. (1), we therefore obtain a new expression of Eq. (1) as follows, i
                     =1,…,
                     n,
                        
                           (A2)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                Δ
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                M
                                                (
                                                X
                                                )
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  Δ
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                M
                                                (
                                                X
                                                )
                                                =
                                                (
                                                ϕ
                                                (
                                                ‖
                                                X
                                                -
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ‖
                                                )
                                                ,
                                                …
                                                ,
                                                ϕ
                                                (
                                                ‖
                                                X
                                                -
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      m
                                                   
                                                
                                                ‖
                                                )
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      n
                                                   
                                                
                                                ,
                                                1
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Note that Eq. (A2) describes a linear system that solves the displacement of any point X (i.e. {Δui
                     }) using the displacements of the constraint points, (i.e. {Δci
                     }). The kernel is M(X)K
                     −1 that describes the current configuration of the constraint points. The displacements {Δci
                     } indicate the directions that the constraint points are moving in. The derivatives of ∂(u
                     1,…,
                     un
                     )/∂(x
                     1,…,
                     xn
                     ) are computed as follows,
                        
                           (A3)
                           
                              
                                 
                                    ∂
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                         +
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               K
                                                            
                                                            
                                                               -
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           Δ
                                                                           
                                                                              
                                                                                 c
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           0
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                         i
                                                         =
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               K
                                                            
                                                            
                                                               -
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           Δ
                                                                           
                                                                              
                                                                                 c
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           0
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                         i
                                                         ≠
                                                         j
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         =
                                                         1
                                                         ,
                                                         …
                                                         ,
                                                         n
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 M
                              
                              
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                              
                           
                        
                      denote the partial derivatives of M(X).

Moreover, substituting the derivatives of Eq. (A3) into Eq. (3) yields,
                        
                           (A4)
                           
                              1
                              +
                              
                                 
                                    M
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    K
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                Δ
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                              >
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                       ,
                                       j
                                       ≠
                                       i
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          
                                             K
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Δ
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                              .
                           
                        
                     
                  

In general, the displacements of the constraint points {Δci
                     } can be obtained by the differences of the current coordinates of the constraint points and their individual destinations’ coordinates. To satisfy the above inequalities, we need to limit the length of each displacement vector by scaling the vectors {Δci
                     } as follows,
                        
                           (A5)
                           
                              1
                              +
                              
                                 
                                    M
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    K
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                Δ
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                              δ
                              >
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                       ,
                                       j
                                       ≠
                                       i
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          
                                             K
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Δ
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              δ
                              ,
                           
                        
                     where δ denotes a scaling factor and δ
                     >0.

The regions in Rn
                      defined by the inequalities of Eq. (A5) can be further described as follows, i
                     =1,…,
                     n,
                        
                           (A6)
                           
                              
                                 
                                    Ω
                                 
                                 
                                    i
                                 
                              
                              (
                              δ
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                1
                                                +
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      n
                                                   
                                                
                                                )
                                                :
                                                
                                                   
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               K
                                                            
                                                            
                                                               -
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           Δ
                                                                           
                                                                              
                                                                                 c
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           0
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                δ
                                                ,
                                                j
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                             
                                          
                                          
                                             
                                                1
                                                +
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      i
                                                   
                                                
                                                >
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         1
                                                         ,
                                                         j
                                                         ≠
                                                         i
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                                |
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      j
                                                   
                                                
                                                |
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where (r
                     1,…,1+
                     ri
                     ,…,
                     rn
                     ) denotes a point in Ωi
                     (δ). These regions are essentially of the ranges of the corresponding 1st order partial derivatives.

According to the 2D cubic B-spline function defined in Eq. (7), let X
                     =(x
                     1,
                     x
                     2)
                        T
                     , U
                     =(u
                     1,
                     u
                     2)
                        T
                      and 
                        
                           
                              
                                 C
                              
                              
                                 ij
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                          
                                             ij
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                              
                              
                                 T
                              
                           
                        
                     . The relevant derivatives can be given as follows,
                        
                           
                              
                                 
                                    ∂
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              =
                              1
                              +
                              
                                 
                                    B
                                 
                                 
                                    w
                                 
                              
                              (
                              Δ
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              )
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          w
                                       
                                    
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                              +
                              
                                 
                                    B
                                 
                                 
                                    v
                                 
                              
                              (
                              Δ
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              )
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          v
                                       
                                    
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           
                              
                                 
                                    ∂
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    B
                                 
                                 
                                    w
                                 
                              
                              (
                              Δ
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              )
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          w
                                       
                                    
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              +
                              
                                 
                                    B
                                 
                                 
                                    v
                                 
                              
                              (
                              Δ
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              )
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          v
                                       
                                    
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           
                              
                                 
                                    ∂
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    B
                                 
                                 
                                    w
                                 
                              
                              (
                              Δ
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              )
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          w
                                       
                                    
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                              +
                              
                                 
                                    B
                                 
                                 
                                    v
                                 
                              
                              (
                              Δ
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              )
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          v
                                       
                                    
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           
                              
                                 
                                    ∂
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              =
                              1
                              +
                              
                                 
                                    B
                                 
                                 
                                    w
                                 
                              
                              (
                              Δ
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              )
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          w
                                       
                                    
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              +
                              
                                 
                                    B
                                 
                                 
                                    v
                                 
                              
                              (
                              Δ
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              )
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          v
                                       
                                    
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              ,
                           
                        
                     where
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                w
                                             
                                          
                                          (
                                          Δ
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   0
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                j
                                             
                                          
                                          Δ
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                             
                                                ij
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                w
                                             
                                          
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   0
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                             
                                                ij
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                v
                                             
                                          
                                          (
                                          Δ
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   0
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          Δ
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                             
                                                ij
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                v
                                             
                                          
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   0
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                             
                                                ij
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                w
                                             
                                          
                                          (
                                          Δ
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   0
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                j
                                             
                                          
                                          Δ
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                             
                                                ij
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                w
                                             
                                          
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   0
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                             
                                                ij
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                v
                                             
                                          
                                          (
                                          Δ
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   0
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          Δ
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                             
                                                ij
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                v
                                             
                                          
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   0
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                             
                                                ij
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Moreover, in terms of Eqs. (5) and (6), introducing the scaling factor δ yields,
                        
                           
                              δ
                              =
                              
                                 min
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          
                                                                                             B
                                                                                          
                                                                                          
                                                                                             w
                                                                                          
                                                                                       
                                                                                       (
                                                                                       Δ
                                                                                       
                                                                                          
                                                                                             c
                                                                                          
                                                                                          
                                                                                             1
                                                                                          
                                                                                       
                                                                                       )
                                                                                    
                                                                                    
                                                                                       
                                                                                          
                                                                                             B
                                                                                          
                                                                                          
                                                                                             w
                                                                                          
                                                                                       
                                                                                       (
                                                                                       
                                                                                          
                                                                                             c
                                                                                          
                                                                                          
                                                                                             1
                                                                                          
                                                                                       
                                                                                       )
                                                                                    
                                                                                 
                                                                                 +
                                                                                 
                                                                                    
                                                                                       
                                                                                          
                                                                                             B
                                                                                          
                                                                                          
                                                                                             v
                                                                                          
                                                                                       
                                                                                       (
                                                                                       Δ
                                                                                       
                                                                                          
                                                                                             c
                                                                                          
                                                                                          
                                                                                             1
                                                                                          
                                                                                       
                                                                                       )
                                                                                    
                                                                                    
                                                                                       
                                                                                          
                                                                                             B
                                                                                          
                                                                                          
                                                                                             v
                                                                                          
                                                                                       
                                                                                       (
                                                                                       
                                                                                          
                                                                                             c
                                                                                          
                                                                                          
                                                                                             1
                                                                                          
                                                                                       
                                                                                       )
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           2
                                                                        
                                                                     
                                                                     +
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          
                                                                                             B
                                                                                          
                                                                                          
                                                                                             w
                                                                                          
                                                                                       
                                                                                       (
                                                                                       Δ
                                                                                       
                                                                                          
                                                                                             c
                                                                                          
                                                                                          
                                                                                             1
                                                                                          
                                                                                       
                                                                                       )
                                                                                    
                                                                                    
                                                                                       
                                                                                          
                                                                                             B
                                                                                          
                                                                                          
                                                                                             w
                                                                                          
                                                                                       
                                                                                       (
                                                                                       
                                                                                          
                                                                                             c
                                                                                          
                                                                                          
                                                                                             2
                                                                                          
                                                                                       
                                                                                       )
                                                                                    
                                                                                 
                                                                                 +
                                                                                 
                                                                                    
                                                                                       
                                                                                          
                                                                                             B
                                                                                          
                                                                                          
                                                                                             v
                                                                                          
                                                                                       
                                                                                       (
                                                                                       Δ
                                                                                       
                                                                                          
                                                                                             c
                                                                                          
                                                                                          
                                                                                             1
                                                                                          
                                                                                       
                                                                                       )
                                                                                    
                                                                                    
                                                                                       
                                                                                          
                                                                                             B
                                                                                          
                                                                                          
                                                                                             v
                                                                                          
                                                                                       
                                                                                       (
                                                                                       
                                                                                          
                                                                                             c
                                                                                          
                                                                                          
                                                                                             2
                                                                                          
                                                                                       
                                                                                       )
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           2
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      -
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          
                                                                                             B
                                                                                          
                                                                                          
                                                                                             w
                                                                                          
                                                                                       
                                                                                       (
                                                                                       Δ
                                                                                       
                                                                                          
                                                                                             c
                                                                                          
                                                                                          
                                                                                             2
                                                                                          
                                                                                       
                                                                                       )
                                                                                    
                                                                                    
                                                                                       
                                                                                          
                                                                                             B
                                                                                          
                                                                                          
                                                                                             w
                                                                                          
                                                                                       
                                                                                       (
                                                                                       
                                                                                          
                                                                                             c
                                                                                          
                                                                                          
                                                                                             1
                                                                                          
                                                                                       
                                                                                       )
                                                                                    
                                                                                 
                                                                                 +
                                                                                 
                                                                                    
                                                                                       
                                                                                          
                                                                                             B
                                                                                          
                                                                                          
                                                                                             v
                                                                                          
                                                                                       
                                                                                       (
                                                                                       Δ
                                                                                       
                                                                                          
                                                                                             c
                                                                                          
                                                                                          
                                                                                             2
                                                                                          
                                                                                       
                                                                                       )
                                                                                    
                                                                                    
                                                                                       
                                                                                          
                                                                                             B
                                                                                          
                                                                                          
                                                                                             v
                                                                                          
                                                                                       
                                                                                       (
                                                                                       
                                                                                          
                                                                                             c
                                                                                          
                                                                                          
                                                                                             1
                                                                                          
                                                                                       
                                                                                       )
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           2
                                                                        
                                                                     
                                                                     +
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          
                                                                                             B
                                                                                          
                                                                                          
                                                                                             w
                                                                                          
                                                                                       
                                                                                       (
                                                                                       Δ
                                                                                       
                                                                                          
                                                                                             c
                                                                                          
                                                                                          
                                                                                             2
                                                                                          
                                                                                       
                                                                                       )
                                                                                    
                                                                                    
                                                                                       
                                                                                          
                                                                                             B
                                                                                          
                                                                                          
                                                                                             w
                                                                                          
                                                                                       
                                                                                       (
                                                                                       
                                                                                          
                                                                                             c
                                                                                          
                                                                                          
                                                                                             2
                                                                                          
                                                                                       
                                                                                       )
                                                                                    
                                                                                 
                                                                                 +
                                                                                 
                                                                                    
                                                                                       
                                                                                          
                                                                                             B
                                                                                          
                                                                                          
                                                                                             v
                                                                                          
                                                                                       
                                                                                       (
                                                                                       Δ
                                                                                       
                                                                                          
                                                                                             c
                                                                                          
                                                                                          
                                                                                             2
                                                                                          
                                                                                       
                                                                                       )
                                                                                    
                                                                                    
                                                                                       
                                                                                          
                                                                                             B
                                                                                          
                                                                                          
                                                                                             v
                                                                                          
                                                                                       
                                                                                       (
                                                                                       
                                                                                          
                                                                                             c
                                                                                          
                                                                                          
                                                                                             2
                                                                                          
                                                                                       
                                                                                       )
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           2
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      -
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.jbi.2013.12.011.


                     
                        
                           Supplementary video 1
                           
                        
                     
                     
                        
                           Supplementary video 2
                           
                        
                     
                     
                        
                           Supplementary data 3
                           
                        
                     
                  

@&#REFERENCES@&#

