@&#MAIN-TITLE@&#Color texture analysis using CFA chromatic co-occurrence matrices

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           New descriptors are proposed for color textures, computed from their CFA images.


                        
                        
                           
                           These are multi-channel descriptors, like chromatic co-occurrence matrices (CCMs).


                        
                        
                           
                           They use specific CFA neighborhoods, allowing to compare textures without demosaicing.


                        
                        
                           
                           They outperform CCMs computed from the demosaiced images in classification accuracy.


                        
                        
                           
                           Avoiding the demosaicing step, they also save much processing time.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Color texture analysis

Chromatic co-occurrence matrix

Bayer color filter array

CFA demosaicing

Texture classification

VisTex and Outex databases

@&#ABSTRACT@&#


               
               
                  Most color cameras are fitted with a single sensor that provides color filter array (CFA) images, in which each pixel is characterized by one of the three color components (either red, green, or blue). To produce a color image, the two missing color components have to be estimated at each pixel of the corresponding CFA image. This process is commonly referred to as demosaicing, and its result as the demosaiced color image.
                  Since demosaicing methods intend to produce “perceptually satisfying” demosaiced color images, they attempt to avoid color artifacts. Because this is often achieved by filtering, demosaicing schemes tend to alter the local texture information that is, however, useful to discriminate texture images. To avoid this issue while exploiting color information for texture classification, it may be relevant to compute texture descriptors directly from CFA images.
                  From chromatic co-occurrence matrices (CCMs) that capture the spatial interaction between color components, we derive new descriptors (CFA CCMs) for CFA texture images. Color textures are then compared by means of the similarity between their CFA CCMs. Experimental results achieved on benchmark color texture databases show the efficiency of this approach for texture classification.
               
            

@&#INTRODUCTION@&#

Color texture classification is a particular problem of color image retrieval, closely related to appearance-based object recognition. It is a major field of development for several industrial vision applications [1]. To respect real-time constraints, these applications generally require as short a processing time as possible for the texture classification scheme.

The supervised classification problem is to retrieve, among a set of color texture images grouped into classes (the target images), those that represent the same texture as a given image (the test image). Each texture being characterized by a set of descriptors, the matching scheme used for texture classification compares the descriptors of the test image with those of the target images by means of a similarity measure. The target images are then ranked with respect to their similarity to the test image, which provides the class of texture to which the test image belongs.

Palm [2] has shown that the texture discrimination quality provided by the sole analysis of luminance texture descriptors is improved by taking into account both the spatial arrangement of the colors in the image plane and their distribution in a color space. Thus, color information is worth being used along with texture descriptors to serve as cues in a texture classifier.

To classify color textures, three kinds of descriptors are encountered in the literature:
                           
                              •
                              “luminance-based texture descriptors” mixed with color statistical features [3,4];

“single-component texture descriptors” that take into account the spatial relationships within a single color component (i.e., the red
                                    1
                                    For interpretation of color in Figs. 1–3 and 5–12, the reader is referred to the web version of this article.
                                 
                                 
                                    1
                                  (R), green (G), or blue (B) color component) [5–7];

“multi-component texture descriptors” that consider spatial relationships both between different color components and within a single one [8,2,9].

Even if the first two approaches seem to be computationally faster, they do not take into account the spatial relationships between color components. As a consequence, the information on the color texture as a whole is ignored, subsequently reducing the classification quality [8]. That is why we opt for descriptors that capture spatial relationships within and between different color components to classify color textures.

The underlying assumption of color texture classification is that digital color images are discrete functions well describing the observed textures. So, the user has to select the color camera with great care to ensure that the color texture is well represented by the acquired images. Two main criteria have to be retained when selecting the camera. First, since a color analysis improves the quality of texture discrimination, the color characterizing each pixel should be as close as possible to the color stimulus reflected by the observed surface element. Second, the color textures are represented by areas with high spatial frequencies. Texture images must then be acquired so that the spatial sampling frequency of the camera sensor is twice higher than the highest spatial frequency of the observed texture patterns, to avoid aliasing. Therefore, camera resolution is an important parameter that influences the choice of sensor technology for texture image acquisition.

The digital color cameras available on the market may be distinguished according to the type of sensor(s)—either charge-coupled device (CCD) or complementary metal-oxide semiconductor (CMOS)—, and to whether they incorporate three sensors or only one single sensor. Three-sensor technology is in accordance with the trichromatic theory: each of the three sensors incorporated in such cameras is sensitive to one of the primary colors (red, green, or blue). In most of such devices, the color stimulus reflected by each surface element of the observed scene is split onto the three sensors by means of a trichroic prism assembly, made of two dichroic prisms [10]. Three color component images (
                           
                              
                                 
                                    I
                                 
                                 
                                    R
                                 
                              
                              ,
                              
                              
                                 
                                    I
                                 
                                 
                                    G
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    I
                                 
                                 
                                    B
                                 
                              
                           
                        ), in which each pixel is characterized by one single color component, are simultaneously acquired by the three sensors, and their combination yields the final full-color image 
                           
                              I
                           
                        , in which each pixel is characterized by the three color components 
                           
                              R
                              ,
                              
                              G
                           
                        , and B (see Fig. 1
                        a).

Although three-sensor technology provides high-quality full-color images, the manufacturing costs of the sensors and of the optical device are high. As a consequence, cameras fitted with such sensors have not yet been affordable to everyone, nor widely distributed. Due to these cost constraints, most color cameras are equipped with a single sensor, which also allows for an increased spatial resolution at given cost in comparison with three-sensor cameras. The surface of this single sensor is covered by a color filter array (CFA), which consists of an array of spectrally selective filters (see Fig. 1b). Each photosite is then made mainly sensitive to a given wavelength band corresponding to a single color component. The Bayer filter array is the most widely used one; it provides a CFA image 
                        
                           
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                           
                         in which each pixel is characterized by only one among the three color components (see Fig. 2
                        ). The levels of the missing two color components must be determined to estimate the color of each pixel. This process is commonly referred to as CFA demosaicing; its result is the demosaiced color image 
                        
                           
                              
                                 
                                    I
                                 
                                 
                                    ˆ
                                 
                              
                           
                        , in which each pixel is characterized by an estimated color (see Fig. 1b). Demosaicing is either achieved by an electronic device inside the camera itself, or by an external software that processes the CFA image delivered by the camera as a raw image file.

The recently published demosaicing schemes can be grouped into two main categories: spatial methods, that analyze the image plane, and methods that examine the frequency domain [11]. Spatial methods exploit assumptions about spatial and/or spectral correlation between colors of neighboring pixels. Frequency-selection methods convolve the CFA image with dedicated masks to retrieve the luminance, then the demosaiced color image.

Losson et al. [12] compare the performances reached by ten recent demosaicing schemes, applied to twelve images coming from the Kodak benchmark database [13]. Two kinds of quality measurements are used: classical fidelity criteria (e.g., the peak signal-to-noise ratio—PSNR), and measurements sensitive to demosaicing artifacts (e.g., to false colors, or to a jagged pattern called “zipper effect”). All these criteria yield consistent quality rankings for the tested demosaicing schemes. This detailed evaluation highlights that the methods mainly using the frequency domain outperform the methods only relying on spatial scans. More precisely, the methods proposed by Dubois [14] and by Lian et al. [15] provide the best demosaicing results, regardless of the quality measurement used. Unfortunately, these demosaicing schemes are rather time-consuming because they filter the CFA image with large convolution masks, and because they scan the CFA image several times.

Since demosaicing methods intend to produce “perceptually satisfying” demosaiced color images, they are usually designed to avoid generating color artifacts [12]. Thus, many demosaicing schemes tend to alter the local texture information that is useful to discriminate the textures [16]. As shown in Fig. 3
                        , even the best demosaicing schemes are prone to generate color artifacts in areas with high spatial frequencies. As a result, the demosaiced color image may not well represent the texture observed by the camera, and a texture classification scheme is expected to reach lower performances when applied to a set of demosaiced color images than when applied to the corresponding full-color images.

It is therefore relevant to consider how to avoid the demosaicing step in any classification scheme of color texture images. One of the advantages of this approach is to decrease the computation time of the classification process. This paper precisely intends to investigate how such classification can be achieved directly from CFA images, and to evaluate the performance reached thereby, in terms of both classification accuracy and computation efficiency.

In this paper, we present a texture classification scheme based only on the analysis of CFA images acquired by single-sensor color cameras, which has never been proposed—to our knowledge.

This scheme relies on the assumption that the CFA images of the observed textures are relevant functions to describe these textures. Grounds for such a claim can be found in the works of Gunturk et al. [18] and Lian et al. [15], showing that the color components are strongly correlated with each other in areas of high spatial frequencies. As a consequence, sampling one single color component per pixel (as in the CFA image) slightly alters the description of the observed texture.

To achieve color texture classification without demosaicing, we propose a new color texture descriptor that is directly computed from the CFA image. Derived from the well-known chromatic co-occurrence matrix (CCM), that captures the spatial relationships both within and between the color component images [8,2,9], this descriptor is hereafter referred to as the CFA chromatic co-occurrence matrix (CFA CCM).

The rest of the paper is organized as follows. The second section describes how CCMs are computed from a color image, and introduces two measures of similarity between these descriptors. The third section sets a formalism for the CFA image, and explains how to compute CFA CCMs. To assess the efficiency of color texture classification using such CFA descriptors, the fourth section presents experimental results obtained with two benchmark color texture databases.

Chromatic co-occurrence matrices (CCMs) are well-known and efficient texture descriptors [19,8,2,9]. In this section, we first give details about how CCMs are generally extracted from a color image. Then we describe how these descriptors can be compared thanks to dedicated similarity measures.

A CCM is a statistical texture descriptor that both takes into account the color distribution of an image and the spatial interactions between the colors of pixels. This multi-channel descriptor can be viewed as a generalization of the gray-level co-occurrence matrix proposed by Haralick [20]. It was introduced by Rosenfeld [21] and taken up by Palm [2] as a texture descriptor extracted from a color image.

A full-color image 
                           
                              I
                           
                         is composed of three color component images 
                           
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                              k
                              ∈
                              {
                              R
                              ,
                              G
                              ,
                              B
                              }
                           
                        . In each image 
                           
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                           
                        , a given pixel P is characterized by the level 
                           
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                              (
                              P
                              )
                           
                         of the color component k. A three-component vector, defined as 
                           
                              I
                              (
                              P
                              )
                              =
                              (
                              
                                 
                                    I
                                 
                                 
                                    R
                                 
                              
                              (
                              P
                              )
                              ,
                              
                                 
                                    I
                                 
                                 
                                    G
                                 
                              
                              (
                              P
                              )
                              ,
                              
                                 
                                    I
                                 
                                 
                                    B
                                 
                              
                              (
                              P
                              )
                              )
                           
                        , is therefore associated with each pixel P. When the spatial coordinates 
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         of P are needed, the same vector may also be denoted as 
                           
                              I
                              (
                              x
                              ,
                              y
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             R
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       ,
                                       
                                          
                                             I
                                          
                                          
                                             G
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       ,
                                       
                                          
                                             I
                                          
                                          
                                             B
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                 
                              
                           
                        .

Let k and 
                           
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              ,
                              (
                              k
                              ,
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              )
                              ∈
                              {
                              R
                              ,
                              G
                              ,
                              B
                              
                                 
                                    }
                                 
                                 
                                    2
                                 
                              
                           
                        , be two of the three color components, and q be the number of levels used to quantize the color components. Let 
                           
                              
                                 
                                    M
                                 
                                 
                                    k
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              [
                              I
                              ]
                           
                         be the CCM that captures the spatial interactions between the color components k and 
                           
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                           
                         of the pixels in the full-color image I, according to a given neighborhood 
                           
                              N
                           
                        . The cell 
                           
                              
                                 
                                    M
                                 
                                 
                                    k
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              [
                              I
                              ]
                              (
                              i
                              ,
                              j
                              )
                           
                         of this matrix, 
                           
                              0
                              ⩽
                              i
                              ⩽
                              q
                              -
                              1
                              ,
                              
                              0
                              ⩽
                              j
                              ⩽
                              q
                              -
                              1
                           
                        , contains the number of times that a pixel Q whose level is j for the color component 
                           
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                           
                        , occurs in the neighborhood 
                           
                              N
                              (
                              P
                              )
                           
                         of a pixel P whose level is i for the color component k:
                           
                              (1)
                              
                                 
                                    
                                       M
                                    
                                    
                                       k
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          I
                                       
                                    
                                 
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          P
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          Q
                                          ∈
                                          N
                                          (
                                          P
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   P
                                                   )
                                                   =
                                                   i
                                                   
                                                   and
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   Q
                                                   )
                                                   =
                                                   j
                                                   ,
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The neighborhood 
                           
                              N
                           
                         used to compute the CCMs is made of the 8 pixels at uniform distance (also called infinity-norm distance) d along the four main directions of the image plane (horizontal and vertical directions, and the two diagonals) (see Fig. 4
                        ):
                           
                              (2)
                              
                                 N
                                 (
                                 P
                                 )
                                 =
                                 {
                                 Q
                                 ∈
                                 I
                                 
                                    
                                       
                                          ‖
                                          PQ
                                          
                                             
                                                ‖
                                             
                                             
                                                ∞
                                             
                                          
                                          =
                                          d
                                          ,
                                          θ
                                          
                                          mod
                                          
                                          π
                                          /
                                          4
                                          =
                                          0
                                          }
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              θ
                           
                         denotes the angle between the horizontal unit vector and the vector PQ defined by the pixels P and Q. The parameter d is adjusted by the user to fit the texture granularity at best. Note that, even if different neighborhoods can be considered [2], this one is consistent with that proposed by Haralick [20].

As a measure of the local interaction between pixels computed from the whole image, this CCM is sensitive to variations of the image size and must be normalized by the total number of co-occurrences to decrease such sensitivity. Let 
                           
                              
                                 
                                    m
                                 
                                 
                                    k
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              [
                              I
                              ]
                              (
                              i
                              ,
                              j
                              )
                           
                         be a cell of the normalized CCM:
                           
                              (3)
                              
                                 
                                    
                                       m
                                    
                                    
                                       k
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 [
                                 I
                                 ]
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             k
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       [
                                       I
                                       ]
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             a
                                             =
                                             0
                                          
                                          
                                             q
                                             -
                                             1
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             b
                                             =
                                             0
                                          
                                          
                                             q
                                             -
                                             1
                                          
                                       
                                       
                                          
                                             M
                                          
                                          
                                             k
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       [
                                       I
                                       ]
                                       (
                                       a
                                       ,
                                       b
                                       )
                                    
                                 
                                 ,
                              
                           
                        so that:
                           
                              (4)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          q
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          q
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       k
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 [
                                 I
                                 ]
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 =
                                 1
                                 .
                              
                           
                        
                     

The relationships between levels of neighboring pixels within any of the three color component images 
                           
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                           
                         are represented by a single-component (normalized) CCM 
                           
                              
                                 
                                    m
                                 
                                 
                                    k
                                    ,
                                    k
                                 
                              
                              [
                              I
                              ]
                              ,
                              
                              k
                              ∈
                              {
                              R
                              ,
                              G
                              ,
                              B
                              }
                           
                        . In order to provide information about the spatial relationships between the color components, multi-component matrices (namely 
                           
                              
                                 
                                    m
                                 
                                 
                                    k
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              [
                              I
                              ]
                              ,
                              
                              k
                              
                              ≠
                              
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                           
                        ) must be considered [2]. These matrices contain the number of pairwise occurrences of levels between different color components. Because 
                           
                              
                                 
                                    m
                                 
                                 
                                    k
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              [
                              I
                              ]
                           
                         and 
                           
                              
                                 
                                    m
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    k
                                 
                              
                              [
                              I
                              ]
                           
                         are transpose of each other, these matrices contain the same information. Therefore, only one of them is useful to describe the co-occurrence information between the color components k and 
                           
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                           
                        .

For a given image 
                           
                              I
                           
                         and a given neighborhood 
                           
                              N
                           
                        , six normalized CCMs are thus computed:
                           
                              •
                              three single-component matrices 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             R
                                             ,
                                             R
                                          
                                       
                                       [
                                       I
                                       ]
                                       ,
                                       
                                       
                                          
                                             m
                                          
                                          
                                             G
                                             ,
                                             G
                                          
                                       
                                       [
                                       I
                                       ]
                                    
                                 , and 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             B
                                             ,
                                             B
                                          
                                       
                                       [
                                       I
                                       ]
                                    
                                 ,

three multi-component matrices 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             R
                                             ,
                                             G
                                          
                                       
                                       [
                                       I
                                       ]
                                       ,
                                       
                                       
                                          
                                             m
                                          
                                          
                                             R
                                             ,
                                             B
                                          
                                       
                                       [
                                       I
                                       ]
                                    
                                  and 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             B
                                             ,
                                             G
                                          
                                       
                                       [
                                       I
                                       ]
                                    
                                 ,

These six chromatic co-occurrence matrices require 
                           
                              6
                              ·
                              
                                 
                                    q
                                 
                                 
                                    2
                                 
                              
                           
                         memory cells for storage. They capture both the distribution and spatial arrangement of the color component levels [2].

The matching scheme between the test image 
                           
                              
                                 
                                    I
                                 
                                 
                                    test
                                 
                              
                           
                         and the target image 
                           
                              
                                 
                                    I
                                 
                                 
                                    tar
                                 
                              
                           
                         is based on a pairwise comparison of their respective chromatic co-occurrence matrices 
                           
                              
                                 
                                    m
                                 
                                 
                                    k
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              [
                              
                                 
                                    I
                                 
                                 
                                    test
                                 
                              
                              ]
                           
                         and 
                           
                              
                                 
                                    m
                                 
                                 
                                    k
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              [
                              
                                 
                                    I
                                 
                                 
                                    tar
                                 
                              
                              ]
                              ,
                              (
                              k
                              ,
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              )
                              ∈
                              S
                           
                        . Several measures have been proposed to compare probability density functions, and normalized co-occurrence matrices can be regarded as such. Therefore, any of the measures considered by Rubner et al. to evaluate the dissimilarity between histograms [22] can be used to compare CCMs. Since the objective of this paper is to show the interest of texture descriptors extracted from CFA images, we retain two similarity measures among the existing ones: the intersection between CCMs [23] (one of the simplest similarity measures), and the Jeffrey divergence [22] (one of the most efficient measures to compare textures).

The intersection between two CCMs, for any pair of color components 
                              
                                 (
                                 k
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ∈
                                 S
                              
                           , is expressed as:
                              
                                 (5)
                                 
                                    Inter
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   k
                                                   ,
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             [
                                             
                                                
                                                   I
                                                
                                                
                                                   test
                                                
                                             
                                             ]
                                             ,
                                             
                                                
                                                   m
                                                
                                                
                                                   k
                                                   ,
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             [
                                             
                                                
                                                   I
                                                
                                                
                                                   tar
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             0
                                          
                                          
                                             q
                                             -
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             0
                                          
                                          
                                             q
                                             -
                                             1
                                          
                                       
                                    
                                    min
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   k
                                                   ,
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             [
                                             
                                                
                                                   I
                                                
                                                
                                                   test
                                                
                                             
                                             ]
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ,
                                             
                                                
                                                   m
                                                
                                                
                                                   k
                                                   ,
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             [
                                             
                                                
                                                   I
                                                
                                                
                                                   tar
                                                
                                             
                                             ]
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

Note that this expression is an extension of the intersection between two image histograms, proposed by Swain et al. [24]. The similarity measure between the test and target images is the mean of their pairwise CCM intersections [25]:
                              
                                 (6)
                                 
                                    SIM
                                    
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   test
                                                
                                             
                                             ,
                                             
                                                
                                                   I
                                                
                                                
                                                   tar
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          6
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             k
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             ∈
                                             S
                                          
                                       
                                    
                                    Inter
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   k
                                                   ,
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             [
                                             
                                                
                                                   I
                                                
                                                
                                                   test
                                                
                                             
                                             ]
                                             ,
                                             
                                                
                                                   m
                                                
                                                
                                                   k
                                                   ,
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             [
                                             
                                                
                                                   I
                                                
                                                
                                                   tar
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

When the two images 
                              
                                 
                                    
                                       I
                                    
                                    
                                       test
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       I
                                    
                                    
                                       tar
                                    
                                 
                              
                            share a similar spatial arrangement of colors, their similarity measure value SIM is close to 1 (see Eqs. (4) and (5)). Although it does not necessarily mean that the two images contain the same texture, we assume so. On the other hand, a similarity measure value close to 0 means that the two textures are significantly different.

The Jeffrey divergence (JD) is derived from the Kullback–Leibler divergence (KLD). Both can be regarded as agreement measures between two probability density functions. In contrast to 
                              
                                 KLD
                                 ,
                                 JD
                              
                            is symmetric and presents a better numerical behavior [22]: it is stable when comparing two empirical distributions. The Jeffrey divergence is expressed as:
                              
                                 (7)
                                 
                                    
                                       
                                          
                                          
                                             
                                                JD
                                                
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               k
                                                               ,
                                                               
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                            
                                                         
                                                         [
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               test
                                                            
                                                         
                                                         ]
                                                         ,
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               k
                                                               ,
                                                               
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                            
                                                         
                                                         [
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               tar
                                                            
                                                         
                                                         ]
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         0
                                                      
                                                      
                                                         q
                                                         -
                                                         1
                                                      
                                                   
                                                
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         0
                                                      
                                                      
                                                         q
                                                         -
                                                         1
                                                      
                                                   
                                                
                                                
                                                
                                                
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      k
                                                      ,
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                [
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      test
                                                   
                                                
                                                ]
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ·
                                                log
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     m
                                                                  
                                                                  
                                                                     k
                                                                     ,
                                                                     
                                                                        
                                                                           k
                                                                        
                                                                        
                                                                           ′
                                                                        
                                                                     
                                                                  
                                                               
                                                               [
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     test
                                                                  
                                                               
                                                               ]
                                                               (
                                                               i
                                                               ,
                                                               j
                                                               )
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           m
                                                                        
                                                                        
                                                                           ¯
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     k
                                                                     ,
                                                                     
                                                                        
                                                                           k
                                                                        
                                                                        
                                                                           ′
                                                                        
                                                                     
                                                                  
                                                               
                                                               (
                                                               i
                                                               ,
                                                               j
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                
                                                
                                                
                                                
                                                
                                                
                                                
                                                
                                                +
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      k
                                                      ,
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                [
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      tar
                                                   
                                                
                                                ]
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ·
                                                log
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     m
                                                                  
                                                                  
                                                                     k
                                                                     ,
                                                                     
                                                                        
                                                                           k
                                                                        
                                                                        
                                                                           ′
                                                                        
                                                                     
                                                                  
                                                               
                                                               [
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     tar
                                                                  
                                                               
                                                               ]
                                                               (
                                                               i
                                                               ,
                                                               j
                                                               )
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           m
                                                                        
                                                                        
                                                                           ¯
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     k
                                                                     ,
                                                                     
                                                                        
                                                                           k
                                                                        
                                                                        
                                                                           ′
                                                                        
                                                                     
                                                                  
                                                               
                                                               (
                                                               i
                                                               ,
                                                               j
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       k
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                k
                                                ,
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          [
                                          
                                             
                                                I
                                             
                                             
                                                test
                                             
                                          
                                          ]
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          +
                                          
                                             
                                                m
                                             
                                             
                                                k
                                                ,
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          [
                                          
                                             
                                                I
                                             
                                             
                                                tar
                                             
                                          
                                          ]
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                    
                                 
                              
                           .

When the two images contain the same texture, the Jeffrey divergence between their CCMs is close to 0, whereas it tends to infinity when they are quite different. The dissimilarity between the two texture images is the mean of the six pairwise divergence measures between their respective CCMs:
                              
                                 (8)
                                 
                                    DISSIM
                                    
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   test
                                                
                                             
                                             ,
                                             
                                                
                                                   I
                                                
                                                
                                                   tar
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          6
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             k
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             ∈
                                             S
                                          
                                       
                                    
                                    JD
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   k
                                                   ,
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             [
                                             
                                                
                                                   I
                                                
                                                
                                                   test
                                                
                                             
                                             ]
                                             ,
                                             
                                                
                                                   m
                                                
                                                
                                                   k
                                                   ,
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             [
                                             
                                                
                                                   I
                                                
                                                
                                                   tar
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

Classification schemes based on the similarity between CCMs provide good results [26], but at high memory and computation costs (see Section 4.4). It is therefore relevant to classify color textures using a similarity measure between CCMs directly computed from their CFA images.

First, we describe the CFA image acquired by any single-sensor color camera, and how the demosaicing process estimates a color image from it. Then, we introduce how to compute CFA chromatic co-occurrence matrices (CFA CCMs) directly from the CFA image, in order to avoid the demosaicing step for color texture classification.

To set a formalism for the CFA image, let us compare the acquisition process of a color image in three-sensor and single-sensor cameras. Fig. 1a outlines a three-sensor camera architecture, in which the full-color image of a scene is formed by combining data from the three sensors. A single-sensor color camera generates a color image in a quite different way, as shown in Fig. 1b. In the first step, the single sensor forms a raw image, called CFA image and denoted by 
                           
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                           
                        , in which a single color component 
                           
                              R
                              ,
                              
                              G
                           
                         or B is associated to each pixel. The second step is the demosaicing process, that consists in estimating a demosaiced color image 
                           
                              
                                 
                                    I
                                 
                                 
                                    ˆ
                                 
                              
                           
                         from 
                           
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                           
                        .

Considering the Bayer CFA of Fig. 2, to each pixel 
                           
                              P
                              (
                              x
                              ,
                              y
                              )
                           
                         in 
                           
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                           
                         is associated a single available color component:
                           
                              •
                              the R color component if x is odd and y is even,

the G color component if x and y are of same parity,

the B color component if x is even and y is odd.

Let 
                           
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                              k
                              ∈
                              {
                              R
                              ,
                              G
                              ,
                              B
                              }
                           
                        , be the subset of pixels in 
                           
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                           
                         whose available color component is k (see Fig. 5
                        ):
                           
                              (9a)
                              
                                 
                                    
                                       I
                                    
                                    
                                       CFA
                                    
                                    
                                       R
                                    
                                 
                                 =
                                 {
                                 P
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 ∈
                                 
                                    
                                       I
                                    
                                    
                                       CFA
                                    
                                 
                                 
                                    
                                       
                                          
                                          x
                                          
                                          is
                                          
                                          odd
                                          
                                          and
                                          
                                          y
                                          
                                          is
                                          
                                          even
                                          }
                                       
                                    
                                 
                                 (
                                 Figure
                                 
                                 6
                                 a
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (9b)
                              
                                 
                                    
                                       I
                                    
                                    
                                       CFA
                                    
                                    
                                       G
                                    
                                 
                                 =
                                 {
                                 P
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 ∈
                                 
                                    
                                       I
                                    
                                    
                                       CFA
                                    
                                 
                                 
                                    
                                       
                                          
                                          x
                                          
                                          and
                                          
                                          y
                                          
                                          are
                                          
                                          of
                                          
                                          same
                                          
                                          parity
                                          }
                                       
                                    
                                 
                                 (
                                 Figure
                                 
                                 6
                                 b
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (9c)
                              
                                 
                                    
                                       I
                                    
                                    
                                       CFA
                                    
                                    
                                       B
                                    
                                 
                                 =
                                 {
                                 P
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 ∈
                                 
                                    
                                       I
                                    
                                    
                                       CFA
                                    
                                 
                                 
                                    
                                       
                                          
                                          x
                                          
                                          is
                                          
                                          even
                                          
                                          and
                                          
                                          y
                                          
                                          is
                                          
                                          odd
                                          }
                                       
                                    
                                 
                                 (
                                 Figure
                                 
                                 6
                                 a
                                 )
                                 ,
                              
                           
                        so that 
                           
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                              ≡
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                                 
                                    R
                                 
                              
                              ∪
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                                 
                                    G
                                 
                              
                              ∪
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                                 
                                    B
                                 
                              
                           
                        . To determine the color of each pixel P of the demosaiced color image, the demosaicing process (denoted by 
                           
                              D
                           
                        ) generally retains the color component available at the same location in 
                           
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                           
                        , and estimates the other two components:
                           
                              (10)
                              
                                 
                                    
                                       I
                                    
                                    
                                       CFA
                                    
                                 
                                 (
                                 P
                                 )
                                 
                                    
                                       →
                                    
                                    
                                       D
                                    
                                 
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 P
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  CFA
                                                               
                                                            
                                                            (
                                                            P
                                                            )
                                                            ,
                                                            
                                                               
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  G
                                                               
                                                            
                                                            (
                                                            P
                                                            )
                                                            ,
                                                            
                                                               
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  B
                                                               
                                                            
                                                            (
                                                            P
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   P
                                                   ∈
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         CFA
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                            (
                                                            P
                                                            )
                                                            ,
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  CFA
                                                               
                                                            
                                                            (
                                                            P
                                                            )
                                                            ,
                                                            
                                                               
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  B
                                                               
                                                            
                                                            (
                                                            P
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   P
                                                   ∈
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         CFA
                                                      
                                                      
                                                         G
                                                      
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                            (
                                                            P
                                                            )
                                                            ,
                                                            
                                                               
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  G
                                                               
                                                            
                                                            (
                                                            P
                                                            )
                                                            ,
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  CFA
                                                               
                                                            
                                                            (
                                                            P
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   P
                                                   ∈
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         CFA
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Each color component triplet in Eq. (10) represents an estimated color. Out of the three components in 
                           
                              
                                 
                                    I
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              P
                              )
                           
                        , the available one at pixel P in 
                           
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                           
                         is denoted by 
                           
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                              (
                              P
                              )
                           
                        , and the missing other two components among 
                           
                              
                                 
                                    
                                       
                                          I
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    R
                                 
                              
                              (
                              P
                              )
                              ,
                              
                              
                                 
                                    
                                       
                                          I
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    G
                                 
                              
                              (
                              P
                              )
                           
                        , and 
                           
                              
                                 
                                    
                                       
                                          I
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    B
                                 
                              
                              (
                              P
                              )
                           
                        , are estimated by demosaicing.

In the CFA image of Fig. 2, four different neighborhood configurations 
                           
                              
                                 
                                    N
                                 
                                 
                                    CFA
                                 
                              
                              (
                              P
                              )
                           
                         are encountered, according to the location of the considered pixel P. Fig. 6
                         shows the four 
                           
                              5
                              ×
                              5
                           
                         spatial neighborhoods centered at a given pixel P, according to the subset 
                           
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                                 
                                    k
                                 
                              
                           
                         to which it belongs (i.e., to the parity of its coordinates x and y). Notice that the neighborhoods 
                           
                              
                                 
                                    N
                                 
                                 
                                    CFA
                                 
                              
                              (
                              P
                              )
                           
                         are structurally similar for 
                           
                              P
                              ∈
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                                 
                                    R
                                 
                              
                           
                         and 
                           
                              P
                              ∈
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                                 
                                    B
                                 
                              
                           
                         (see Fig. 6a and d), apart from the slight difference that available components R and B are exchanged; therefore, they can be analyzed in the same way. Also notice that two neighborhood configurations are encountered at pixels 
                           
                              P
                              (
                              x
                              ,
                              y
                              )
                              ∈
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                                 
                                    G
                                 
                              
                           
                        , according to the parity of x and y (see Fig. 6b and c).


                        Section 2 explained the standard way to compute CCMs from color images, and detailed two measures used to compare them in the texture matching scheme. When CFA images are used as input, a similar procedure may be applied, providing that CCMs are replaced by a specific descriptor that we now introduce.

To characterize a texture represented by a given CFA image 
                           
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                           
                        , we propose to compute six CFA chromatic co-occurrence matrices (CFA CCMs) 
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    k
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              [
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                              ]
                              ,
                              (
                              k
                              ,
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              )
                              ∈
                              S
                           
                        . To achieve this, we examine the neighborhood 
                           
                              
                                 
                                    N
                                 
                                 
                                    CFA
                                 
                                 
                                    k
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              (
                              P
                              )
                           
                         of each pixel P whose available color component is k in 
                           
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                           
                         (i.e., 
                        
                           
                              P
                              ∈
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                                 
                                    k
                                 
                              
                           
                        ). This neighborhood is made of neighboring pixels Q whose available color component is 
                           
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                           
                        . The matrix cell 
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    k
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              [
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                              ]
                              (
                              i
                              ,
                              j
                              )
                           
                         contains the number of times that, in 
                           
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                           
                        , a pixel Q whose available color component is 
                           
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                           
                         and whose level is j, occurs in the neighborhood of a pixel P whose available color component is k and whose level is i. This CFA CCM cell is expressed as:
                           
                              (11)
                              
                                 
                                    
                                       M
                                    
                                    
                                       CFA
                                    
                                    
                                       k
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                CFA
                                             
                                          
                                       
                                    
                                 
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          P
                                          ∈
                                          
                                             
                                                I
                                             
                                             
                                                CFA
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          Q
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                CFA
                                             
                                             
                                                k
                                                ,
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          (
                                          P
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         CFA
                                                      
                                                   
                                                   (
                                                   P
                                                   )
                                                   =
                                                   i
                                                   
                                                   and
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         CFA
                                                      
                                                   
                                                   (
                                                   Q
                                                   )
                                                   =
                                                   j
                                                   ,
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In a CFA image, to count the co-occurrences between two color components k and 
                           
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                           
                        , we therefore consider all pixels P whose available color component is k (
                           
                              P
                              ∈
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                                 
                                    k
                                 
                              
                           
                        ) and, in their neighborhood 
                           
                              
                                 
                                    N
                                 
                                 
                                    CFA
                                 
                                 
                                    k
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              (
                              P
                              )
                           
                        , the pixels Q whose available color component is 
                           
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              (
                              Q
                              ∈
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              )
                           
                        . Unlike the neighborhood 
                           
                              N
                              (
                              P
                              )
                           
                         used to compute CCMs (see Eq. (2) and Fig. 4), 
                           
                              
                                 
                                    N
                                 
                                 
                                    CFA
                                 
                                 
                                    k
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              (
                              P
                              )
                           
                         is specific to the color component pair 
                           
                              (
                              k
                              ,
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                         because of the CFA color sampling. However, we try to make these two neighborhoods consistent with each other at the utmost as follows.
                           
                              •
                              For a given color component 
                                    
                                       k
                                       ∈
                                       {
                                       R
                                       ,
                                       G
                                       ,
                                       B
                                       }
                                       ,
                                       
                                          
                                             N
                                          
                                          
                                             CFA
                                          
                                          
                                             k
                                             ,
                                             k
                                          
                                       
                                       (
                                       P
                                       )
                                    
                                  can be defined exactly as 
                                    
                                       N
                                       (
                                       P
                                       )
                                    
                                 , provided that the distance d from P to Q (used to define 
                                    
                                       N
                                    
                                 ) is even:
                                    
                                       (12)
                                       
                                          
                                             
                                                N
                                             
                                             
                                                CFA
                                             
                                             
                                                k
                                                ,
                                                k
                                             
                                          
                                          (
                                          P
                                          )
                                          =
                                          {
                                          Q
                                          ∈
                                          
                                             
                                                I
                                             
                                             
                                                CFA
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                
                                                   ‖
                                                   PQ
                                                   
                                                      
                                                         ‖
                                                      
                                                      
                                                         ∞
                                                      
                                                   
                                                   =
                                                   2
                                                   ·
                                                   n
                                                   ,
                                                   θ
                                                   
                                                   mod
                                                   
                                                   π
                                                   /
                                                   4
                                                   =
                                                   0
                                                   }
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       n
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  being a distance parameter. Indeed, in the four different neighborhood configurations 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             CFA
                                          
                                       
                                       (
                                       P
                                       )
                                       ,
                                       P
                                       ∈
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                          
                                             k
                                          
                                       
                                    
                                 , the color component k is available at the 8 pixels located along the four main directions at uniform distance 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             k
                                             ,
                                             k
                                          
                                       
                                       =
                                       d
                                       =
                                       2
                                       ·
                                       n
                                    
                                  from P. This is shown for 
                                    
                                       n
                                       =
                                       1
                                    
                                  on Figs. 6 and 7
                                 a for 
                                    
                                       k
                                       =
                                       R
                                    
                                 , on Figs. 6b and Fig. 7b for 
                                    
                                       k
                                       =
                                       G
                                    
                                 , and on Fig. 6d and c for 
                                    
                                       k
                                       =
                                       B
                                    
                                 . This can also be easily verified by examining larger neighborhoods of size 
                                    
                                       (
                                       4
                                       ·
                                       n
                                       +
                                       1
                                       )
                                       ×
                                       (
                                       4
                                       ·
                                       n
                                       +
                                       1
                                       )
                                       ,
                                       n
                                       >
                                       1
                                    
                                 .

For two different color components 
                                    
                                       (
                                       k
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       ∈
                                       {
                                       R
                                       ,
                                       G
                                       ,
                                       B
                                       
                                          
                                             }
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       k
                                       
                                       ≠
                                       
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             N
                                          
                                          
                                             CFA
                                          
                                          
                                             k
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       (
                                       P
                                       )
                                    
                                  can no more be made of the 8 pixels in 
                                    
                                       N
                                       (
                                       P
                                       )
                                    
                                 , since 
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  is unavailable at these pixels in the CFA image. Instead, we use the 4 neighboring pixels Q at which 
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  is available and located along the four main directions at uniform distance 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             k
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       =
                                       2
                                       ·
                                       n
                                       -
                                       1
                                    
                                  from 
                                    
                                       P
                                       ∈
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                          
                                             k
                                          
                                       
                                    
                                 :
                                    
                                       (13)
                                       
                                          
                                             
                                                N
                                             
                                             
                                                CFA
                                             
                                             
                                                k
                                                ,
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          (
                                          P
                                          )
                                          =
                                          {
                                          Q
                                          ∈
                                          
                                             
                                                I
                                             
                                             
                                                CFA
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ‖
                                                   PQ
                                                   
                                                      
                                                         ‖
                                                      
                                                      
                                                         ∞
                                                      
                                                   
                                                   =
                                                   2
                                                   ·
                                                   n
                                                   -
                                                   1
                                                   ,
                                                   θ
                                                   
                                                   mod
                                                   
                                                   π
                                                   /
                                                   4
                                                   =
                                                   0
                                                   }
                                                
                                             
                                          
                                          .
                                       
                                    
                                 Note that the pixels in 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             CFA
                                          
                                          
                                             R
                                             ,
                                             G
                                          
                                       
                                       (
                                       P
                                       )
                                    
                                  and 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             CFA
                                          
                                          
                                             B
                                             ,
                                             G
                                          
                                       
                                       (
                                       P
                                       )
                                    
                                  are then only located along the horizontal and vertical directions (see Fig. 7d and f for 
                                    
                                       n
                                       =
                                       1
                                    
                                 ), whereas pixels in 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             CFA
                                          
                                          
                                             R
                                             ,
                                             B
                                          
                                       
                                       (
                                       P
                                       )
                                    
                                  are only located along the two main diagonal directions (see Fig. 7e). This remains true when 
                                    
                                       n
                                       >
                                       1
                                    
                                 .

In short, for any 
                           
                              (
                              k
                              ,
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              )
                              ∈
                              S
                              ,
                              
                                 
                                    N
                                 
                                 
                                    CFA
                                 
                                 
                                    k
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              (
                              P
                              )
                           
                         is defined as the pixels located along the four main directions at uniform distance 
                           
                              
                                 
                                    d
                                 
                                 
                                    k
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                         from 
                           
                              P
                              ∈
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                                 
                                    k
                                 
                              
                           
                        :
                           
                              (14)
                              
                                 
                                    
                                       N
                                    
                                    
                                       CFA
                                    
                                    
                                       k
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 (
                                 P
                                 )
                                 =
                                 {
                                 Q
                                 ∈
                                 
                                    
                                       I
                                    
                                    
                                       CFA
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 |
                                 ‖
                                 PQ
                                 
                                    
                                       ‖
                                    
                                    
                                       ∞
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       k
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ,
                                 θ
                                 
                                 mod
                                 
                                 π
                                 /
                                 4
                                 =
                                 0
                                 }
                                 ,
                              
                           
                        with:
                           
                              (15)
                              
                                 
                                    
                                       d
                                    
                                    
                                       k
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   2
                                                   ·
                                                   n
                                                
                                                
                                                   if
                                                   
                                                   k
                                                   =
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                   (
                                                   which
                                                   
                                                   yields
                                                   
                                                   8
                                                   
                                                   pixels
                                                   
                                                   in
                                                   
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         CFA
                                                      
                                                      
                                                         k
                                                         ,
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   P
                                                   )
                                                   )
                                                   ,
                                                
                                             
                                             
                                                
                                                   2
                                                   ·
                                                   n
                                                   -
                                                   1
                                                
                                                
                                                   if
                                                   
                                                   k
                                                   
                                                   ≠
                                                   
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                   (
                                                   which
                                                   
                                                   yields
                                                   
                                                   4
                                                   
                                                   pixels
                                                   
                                                   in
                                                   
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         CFA
                                                      
                                                      
                                                         k
                                                         ,
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   P
                                                   )
                                                   )
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        Fig. 7 shows the set of neighborhoods 
                           
                              
                                 
                                    N
                                 
                                 
                                    CFA
                                 
                                 
                                    k
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              (
                              P
                              )
                              ,
                              (
                              k
                              ,
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              )
                              ∈
                              S
                           
                        , used to compute the CFA CCMs 
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    k
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                       
                                    
                                 
                              
                           
                        , for any 
                           
                              P
                              ∈
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                                 
                                    k
                                 
                              
                           
                         as the central pixel and 
                           
                              n
                              =
                              1
                           
                        . Uncolored pixels on this figure are not considered as neighbors. Like for CCMs, these neighborhoods can be defined with a large distance value to describe coarse textures. To show the considered co-occurrences between a pixel in the CFA image and its neighbors located at different distances, Fig. 8
                         illustrates the three neighborhoods 
                           
                              
                                 
                                    N
                                 
                                 
                                    CFA
                                 
                                 
                                    R
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              (
                              P
                              )
                           
                        , for all 
                           
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              {
                              R
                              ,
                              G
                              ,
                              B
                              }
                           
                        , any 
                           
                              P
                              ∈
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                                 
                                    R
                                 
                              
                           
                         as the central pixel, and 
                           
                              n
                              =
                              2
                           
                        . Note that whatever n, the number of pixels in 
                           
                              
                                 
                                    N
                                 
                                 
                                    CFA
                                 
                                 
                                    R
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                         remains either 8 (for 
                           
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              =
                              R
                           
                        ) or 4 (for 
                           
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              
                              ≠
                              
                              R
                           
                        ) (see Figs. 7 and 8).

Like for full-color images, the similarity between the test and target CFA images is then either measured by the mean of the pairwise intersections between their respective CFA CCMs (see Eq. (6)), or by the mean of their pairwise Jeffrey divergences (see Eq. (8)). But, unlike for a full-color image, the number of neighbors used to count the co-occurrences in a CFA image depends on the considered CFA CCM. Indeed, in a CFA image of size N pixels (assumed divisible by 4), there are 
                           
                              Card
                              {
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                                 
                                    R
                                 
                              
                              }
                              =
                              
                                 
                                    N
                                 
                                 
                                    4
                                 
                              
                           
                         red samples, 
                           
                              Card
                              {
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                                 
                                    G
                                 
                              
                              }
                              =
                              
                                 
                                    N
                                 
                                 
                                    2
                                 
                              
                           
                         green samples, and 
                           
                              Card
                              {
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                                 
                                    B
                                 
                              
                              }
                              =
                              
                                 
                                    N
                                 
                                 
                                    4
                                 
                              
                           
                         blue samples, so that the total numbers of co-occurrences are 
                           
                              8
                              ·
                              
                                 
                                    N
                                 
                                 
                                    4
                                 
                              
                           
                         for 
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    R
                                    ,
                                    R
                                 
                              
                              [
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                              ]
                              ,
                              
                              8
                              ·
                              
                                 
                                    N
                                 
                                 
                                    2
                                 
                              
                           
                         for 
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    G
                                    ,
                                    G
                                 
                              
                              [
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                              ]
                              ,
                              
                              8
                              ·
                              
                                 
                                    N
                                 
                                 
                                    4
                                 
                              
                           
                         for 
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    B
                                    ,
                                    B
                                 
                              
                              [
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                              ]
                              ,
                              
                              4
                              ·
                              
                                 
                                    N
                                 
                                 
                                    4
                                 
                              
                           
                         for 
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    R
                                    ,
                                    G
                                 
                              
                              [
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                              ]
                              ,
                              
                              4
                              ·
                              
                                 
                                    N
                                 
                                 
                                    4
                                 
                              
                           
                         for 
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    R
                                    ,
                                    B
                                 
                              
                              [
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                              ]
                           
                        , and 
                           
                              4
                              ·
                              
                                 
                                    N
                                 
                                 
                                    4
                                 
                              
                           
                         for 
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    B
                                    ,
                                    G
                                 
                              
                              [
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                              ]
                           
                         (including neighbors outside the image bounds). In order to ensure that the co-occurrences of the six color component pairs are equally weighted when measuring the similarity between two images, each cell of the CFA CCM 
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    k
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              [
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                              ]
                           
                         must be normalized by its own total number of co-occurrences as:
                           
                              (16)
                              
                                 
                                    
                                       m
                                    
                                    
                                       CFA
                                    
                                    
                                       k
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 [
                                 
                                    
                                       I
                                    
                                    
                                       CFA
                                    
                                 
                                 ]
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             CFA
                                          
                                          
                                             k
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       [
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                       
                                       ]
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             a
                                             =
                                             0
                                          
                                          
                                             q
                                             -
                                             1
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             b
                                             =
                                             0
                                          
                                          
                                             q
                                             -
                                             1
                                          
                                       
                                       
                                          
                                             M
                                          
                                          
                                             CFA
                                          
                                          
                                             k
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       [
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                       
                                       ]
                                       (
                                       a
                                       ,
                                       b
                                       )
                                    
                                 
                                 .
                              
                           
                        Without such normalization, the intersection between the matrices 
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    G
                                    ,
                                    G
                                 
                              
                           
                         of two CFA images would weight, in the similarity measure, four times the intersection between their matrices 
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    k
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                         when 
                           
                              k
                              
                              ≠
                              
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                           
                        , and two times the intersection between their matrices 
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    k
                                    ,
                                    k
                                 
                              
                           
                         when 
                           
                              k
                              ∈
                              {
                              R
                              ,
                              B
                              }
                           
                        . This normalization also decreases the CFA CCM sensitivity to the image size.

Notice at last that, like for CCMs, 
                           
                              
                                 
                                    m
                                 
                                 
                                    CFA
                                 
                                 
                                    k
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    m
                                 
                                 
                                    CFA
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    k
                                 
                              
                           
                         contain the same information for a given CFA image (see demonstration in appendix). The texture represented by the CFA image is then characterized by a set of six matrices:
                           
                              •
                              three single-component matrices 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             CFA
                                          
                                          
                                             R
                                             ,
                                             R
                                          
                                       
                                       [
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                       
                                       ]
                                       ,
                                       
                                          
                                             m
                                          
                                          
                                             CFA
                                          
                                          
                                             G
                                             ,
                                             G
                                          
                                       
                                       [
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                       
                                       ]
                                    
                                 , and 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             CFA
                                          
                                          
                                             B
                                             ,
                                             B
                                          
                                       
                                       [
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                       
                                       ]
                                    
                                 ;

three multi-component matrices 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             CFA
                                          
                                          
                                             R
                                             ,
                                             G
                                          
                                       
                                       [
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                       
                                       ]
                                       ,
                                       
                                          
                                             m
                                          
                                          
                                             CFA
                                          
                                          
                                             R
                                             ,
                                             B
                                          
                                       
                                       [
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                       
                                       ]
                                    
                                  and 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             CFA
                                          
                                          
                                             B
                                             ,
                                             G
                                          
                                       
                                       [
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                       
                                       ]
                                    
                                 .

@&#EXPERIMENTS@&#

This section demonstrates the relevance of using the CFA image in color texture analysis. The first subsection presents the two benchmark color texture databases used in these experiments. The second one details how the CFA CCMs and the CCMs of the demosaiced image are used for color texture classification, as well as in the more general framework of image retrieval. Then, we compare the results obtained using each texture descriptor, both in terms of classification accuracies and recognition rates. Finally, we study the complexity of these two descriptors, and show that the CFA CCM one saves a great amount of processing time.

This subsection presents two well-known color texture databases, widely referred to as benchmarks: Outex [17] and VisTex [27]. More precisely, it details the two benchmark texture sets coming from these databases.

Outex contains a very large number of surface textures acquired by a three-CCD digital color camera under controlled conditions. The used dataset is available from the Outex web site (http://www.outex.oulu.fi/temp/) as the Outex-TC-00013 classification test suite. To build the Outex benchmark set, each of the 68 original texture images in this dataset is split up into disjoint sub-images. Since the size of the original images is 
                              
                                 746
                                 ×
                                 538
                              
                            pixels, this provides 20 sub-images of size 
                              
                                 128
                                 ×
                                 128
                              
                            pixels for each texture class. Fig. 9
                            illustrates each class of the Outex dataset by one of its 20 sub-images.

Each of the 
                              
                                 
                                    
                                       N
                                    
                                    
                                       class
                                    
                                 
                                 =
                                 68
                              
                            classes is represented by 
                              
                                 
                                    
                                       N
                                    
                                    
                                       prot
                                    
                                 
                                 =
                                 10
                              
                            sub-images (called prototypes) out of the 20. All the class prototypes form the subset of 
                              
                                 
                                    
                                       N
                                    
                                    
                                       tar
                                    
                                 
                                 =
                                 
                                    
                                       N
                                    
                                    
                                       prot
                                    
                                 
                                 ·
                                 
                                    
                                       N
                                    
                                    
                                       class
                                    
                                 
                                 =
                                 680
                              
                            target images. Out of the 1360 sub-images of the Outex dataset, the remaining 
                              
                                 
                                    
                                       N
                                    
                                    
                                       test
                                    
                                 
                                 =
                                 680
                              
                            images are used as test images [28].

VisTex is a large set of natural color textures acquired by different color cameras under non-controlled conditions. This whole database is available from the VisTex web site (http://vismod.media.mit.edu/vismod/imagery/VisionTexture), and the used dataset is also available from the Outex web site as the Contrib-TC-00006 classification test suite (http://www.outex.oulu.fi/index.php?page=contributed#Contrib_TC_00006). To build the VisTex benchmark set, each of the 54 original texture images in this dataset is split up into disjoint sub-images. Since the size of the original images is 
                              
                                 512
                                 ×
                                 512
                              
                            pixels, this provides 16 sub-images of size 
                              
                                 128
                                 ×
                                 128
                              
                            pixels for each texture class (see Fig. 10
                           ).

Each of the 
                              
                                 
                                    
                                       N
                                    
                                    
                                       class
                                    
                                 
                                 =
                                 54
                              
                            classes is represented by 
                              
                                 
                                    
                                       N
                                    
                                    
                                       prot
                                    
                                 
                                 =
                                 8
                              
                            prototypes. All the prototypes form the subset of 
                              
                                 
                                    
                                       N
                                    
                                    
                                       tar
                                    
                                 
                                 =
                                 432
                              
                            target images. Out of the 864 sub-images of the VisTex set, the remaining 
                              
                                 
                                    
                                       N
                                    
                                    
                                       test
                                    
                                 
                                 =
                                 432
                              
                            images are used as the test images [28].

This subsection presents the experimental scheme of texture image classification or retrieval using CCMs. The first part outlines the computation of CCMs from the quantized images. The second part focuses on color texture classification using a nearest-prototype scheme, while the third one considers the texture retrieval issue and an associated performance measure.

The computation scheme of CCMs is outlined in Fig. 11
                           . We assume that the two datasets contain only undemosaiced full-color images. The corresponding CFA images, that a single-sensor camera would have provided, are unavailable in practice. Thus, we simulate each CFA image 
                              
                                 
                                    
                                       I
                                    
                                    
                                       CFA
                                    
                                 
                              
                            from its original full-color image 
                              
                                 I
                              
                            by sampling a single color component at each pixel according to the Bayer CFA arrangement shown in Fig. 2.

To reduce the memory cost of the CCMs while preserving their relevance, we propose to apply a uniform color quantization before computing them. Because each matrix contains 
                              
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                              
                            cells, reducing the number of levels for each color component not only decreases the memory storage cost of CCMs, but also the time required to compute their (dis) similarity. Porebski et al. have shown that, when q is set to 64, 32, or even 16, the analysis of such reduced-size matrices yields good classification results, in a significantly reduced processing time [29]. The quantized images are denoted with superscripts 
                              
                                 (
                                 q
                                 )
                              
                           .

Three sets of normalized matrices are then computed:
                              
                                 •
                                 The CCMs are extracted from the color demosaiced image 
                                       
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                (
                                                q
                                                )
                                             
                                          
                                       
                                     (see subsection 2.1). For this purpose, the CFA image is demosaiced according to the methods proposed by Dubois [14] and by Lian et al. [15], because they provide the best demosaicing results with respect to many quality measurements [12].

The CFA CCMs are directly computed from the CFA image 
                                       
                                          
                                             
                                                I
                                             
                                             
                                                CFA
                                             
                                             
                                                (
                                                q
                                                )
                                             
                                          
                                       
                                     (see subsection 3.2).

We also extract the CCMs from the full-color image 
                                       
                                          
                                             
                                                I
                                             
                                             
                                                (
                                                q
                                                )
                                             
                                          
                                       
                                     (see subsection 2.1), which provides a reference for the classification quality.

To obtain comparable classification results for these different kinds of CCMs, the neighborhoods used in practice for their computation must be strictly identical. Therefore, to compute the CCMs from 
                              
                                 
                                    
                                       I
                                    
                                    
                                       (
                                       q
                                       )
                                    
                                 
                              
                            (or from 
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       (
                                       q
                                       )
                                    
                                 
                              
                            alike), we replace 
                              
                                 N
                              
                            by the neighborhood 
                              
                                 
                                    
                                       N
                                    
                                    
                                       k
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                            that is structurally defined as 
                              
                                 
                                    
                                       N
                                    
                                    
                                       CFA
                                    
                                    
                                       k
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           :
                              
                                 (17)
                                 
                                    
                                       
                                          N
                                       
                                       
                                          k
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    (
                                    P
                                    )
                                    =
                                    {
                                    Q
                                    ∈
                                    
                                       
                                          I
                                       
                                       
                                          CFA
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    |
                                    ‖
                                    PQ
                                    
                                       
                                          ‖
                                       
                                       
                                          ∞
                                       
                                    
                                    =
                                    
                                       
                                          d
                                       
                                       
                                          k
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    ,
                                    θ
                                    
                                    mod
                                    
                                    π
                                    /
                                    4
                                    =
                                    0
                                    }
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       k
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                            being defined as for 
                              
                                 
                                    
                                       N
                                    
                                    
                                       CFA
                                    
                                    
                                       k
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                            (see Eq. (15)).

To classify each of the 
                              
                                 
                                    
                                       N
                                    
                                    
                                       test
                                    
                                 
                              
                            test images, the 
                              
                                 
                                    
                                       N
                                    
                                    
                                       tar
                                    
                                 
                              
                            target images are sorted with respect to their similarity to the test image. For each of the 
                              
                                 
                                    
                                       N
                                    
                                    
                                       class
                                    
                                 
                              
                            texture classes, we sum up the ranks of its first (i.e., most similar) M prototypes, 
                              
                                 1
                                 ⩽
                                 M
                                 ⩽
                                 
                                    
                                       N
                                    
                                    
                                       prot
                                    
                                 
                              
                           . The examined test image is assigned to the class with the lowest sum. A successful classification is achieved when this class matches that of the examined test image (hereafter called the true class). This decision scheme assumes that the first M prototypes of the true class are overall more similar to the test image than the first M prototypes of any other class.

When M is set to 1, the scheme is the one nearest neighbor (1-NN) classifier, that is often used to classify the texture images of the considered datasets [2,23]. However, for a given class, several of the 
                              
                                 
                                    
                                       N
                                    
                                    
                                       prot
                                    
                                 
                              
                            prototypes are very similar to the test image, because all these are sub-images of one single original texture image, in which they are spatially close to each other. Consequently, many texture descriptors provide high classification accuracy for the Outex and VisTex databases [23]. To evaluate the respective discriminating power of the texture descriptors, it is better to take into account more than one prototype of each class to assign the test image. When M is set to 
                              
                                 
                                    
                                       N
                                    
                                    
                                       prot
                                    
                                 
                              
                           , the similarity ranks of all the prototypes of each class are taken into account to assign the test image. In that case, the decision scheme assumes that the prototypes of the true class are overall more similar to the test image than the prototypes of any other class.

In order to further investigate the ability of the different CCMs to represent color texture images, independently of the classification stage, the similarity between CCMs is now used by a retrieval scheme.

Each retrieval of a given test image consists in finding which target image (the true one) represents the same texture as this test image, among a set of target images made of only one out of the true class prototypes and of all the other (false) class prototypes. This target image subset, often referred to as the models, contains 
                              
                                 
                                    
                                       N
                                    
                                    
                                       model
                                    
                                 
                                 =
                                 1
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       prot
                                    
                                 
                                 ·
                                 (
                                 
                                    
                                       N
                                    
                                    
                                       class
                                    
                                 
                                 -
                                 1
                                 )
                              
                            candidate target images for the considered retrieval. For a given test image, 
                              
                                 
                                    
                                       N
                                    
                                    
                                       prot
                                    
                                 
                              
                            retrievals are performed because there are 
                              
                                 
                                    
                                       N
                                    
                                    
                                       prot
                                    
                                 
                              
                            target images that represent the same texture. The matching performance of the ith retrieval, 
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       prot
                                    
                                 
                              
                           , is assessed thanks to the match percentile defined as 
                              
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             model
                                          
                                       
                                       -
                                       r
                                       (
                                       i
                                       )
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             model
                                          
                                       
                                       -
                                       1
                                    
                                 
                              
                           , where 
                              
                                 r
                                 (
                                 i
                                 )
                              
                            is the rank of the true image in the sorted list of similarity values. If the true image is ranked first, the match percentile is equal to 1 (perfect match). Note that, unlike in the previous scheme of classification, no decision is taken here about the class to which the test image should be assigned.

The overall matching performance for the 
                              
                                 
                                    
                                       N
                                    
                                    
                                       test
                                    
                                 
                              
                            test images in the dataset is evaluated by the average match percentile (AMP) [24]:
                              
                                 (18)
                                 
                                    AMP
                                    (
                                    %
                                    )
                                    =
                                    
                                       
                                          100
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                test
                                             
                                          
                                          ·
                                          
                                             
                                                N
                                             
                                             
                                                prot
                                             
                                          
                                       
                                    
                                    ·
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   test
                                                
                                             
                                             ·
                                             
                                                
                                                   N
                                                
                                                
                                                   prot
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                N
                                             
                                             
                                                model
                                             
                                          
                                          -
                                          r
                                          (
                                          i
                                          )
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                model
                                             
                                          
                                          -
                                          1
                                       
                                    
                                    .
                                 
                              
                           An AMP of 
                              
                                 100
                                 %
                              
                            is obtained when all matches are perfect, whereas 
                              
                                 50
                                 %
                              
                            indicates that the matches are no better than random. So, by computing the AMP, we can evaluate the matching performance reached by a CCM, for a given similarity measure and quantization level. Note that the AMP is a very sensitive measure: even the second decimal place has to be considered as meaningful when comparing two AMP values expressed as percentages.

@&#EXPERIMENTAL RESULTS@&#


                           Tables 1 and 2
                           
                            display the classification accuracies of the Outex and the VisTex test images. Several values are considered for the parameters, in order to study their influence:
                              
                                 •
                                 the distance parameter n is either set to 1 (
                                       
                                          
                                             
                                                d
                                             
                                             
                                                k
                                                ,
                                                k
                                             
                                          
                                          =
                                          2
                                          ,
                                          
                                             
                                                d
                                             
                                             
                                                k
                                                ,
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          =
                                          1
                                       
                                    ) so that the CCMs are able to describe fine textures (see Tables 1 and 2a), or set to 5 (
                                       
                                          
                                             
                                                d
                                             
                                             
                                                k
                                                ,
                                                k
                                             
                                          
                                          =
                                          10
                                          ,
                                          
                                             
                                                d
                                             
                                             
                                                k
                                                ,
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          =
                                          9
                                       
                                    ) to characterize coarser textures (see Tables 1 and 2b);

the number M of prototypes retained to classify the test image is either set to 1, 
                                       
                                          
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      prot
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    , or 
                                       
                                          
                                             
                                                N
                                             
                                             
                                                prot
                                             
                                          
                                       
                                    ;

the number q of levels used to quantize the color components are the powers of 2 from 16 to 256.

Parameters M and q are shown as table row headers, whereas the main column headers contain the two similarity measures used to compare CCMs: the intersection (see Eq. (6)) and the Jeffrey divergence (see Eq. (8)). These parameter values and similarity measures allow us to draw conclusions about the different CCMs when comparing their classification performance results. For each similarity measure, the first four columns contain the correct classification rates, according to each considered color texture descriptor: CCMs from the (quantized) demosaiced image 
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       (
                                       q
                                       )
                                    
                                 
                              
                            provided by two highly efficient schemes (Dubois’s and Lian et al.’s), CFA CCMs directly computed from the CFA image 
                              
                                 
                                    
                                       I
                                    
                                    
                                       CFA
                                    
                                    
                                       (
                                       q
                                       )
                                    
                                 
                              
                           , and the reference rates obtained with CCMs from the full-color image 
                              
                                 
                                    
                                       I
                                    
                                    
                                       (
                                       q
                                       )
                                    
                                 
                              
                            (
                              
                                 
                                    
                                       I
                                    
                                    
                                       *
                                       (
                                       q
                                       )
                                    
                                 
                              
                            will be considered in section 4.5). For each pair 
                              
                                 (
                                 q
                                 ,
                                 M
                                 )
                              
                            of parameter values and each similarity measure, the best classification accuracy achieved using either CCMs from 
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       (
                                       q
                                       )
                                    
                                 
                              
                            or CFA CCMs is written in bold face.

By examining Tables 1 and 2, we first note that the rates of correctly classified images are very close to each other for all kinds of color texture descriptors, whatever the similarity measure and the values of the parameters M and q. Besides, the accuracy reached by the CCMs extracted from the full-color images is almost always higher than that reached by the CCMs extracted from the demosaiced images (22 cases out of the 30 for Table 1a, 29 out of the 30 for Table 2a, 26 out of the 30 for Table 1b, 30 out of the 30 for Table 2b). This result confirms that the demosaicing step tends to alter the local texture information that is useful to discriminate the textures.


                           Tables 1 and 2 also show that the accuracy reached by using the CFA CCMs extracted from the CFA images is often higher than, or equal to that reached by the CCMs extracted from the demosaiced images (87 out of the 120 cases). Our scheme using the intersection between CFA CCMs hence outperforms the classical intersection between CCMs computed from demosaiced images. Another argument of the relevance of our approach, based on the analysis of the CFA image without any color estimation, is the time saving due to lower complexity (see Section 4.4). This should be kept in mind when considering the implementation of a texture classification scheme from images acquired by a single-sensor color camera.

Still more noticeably, the accuracy reached by using CFA CCMs is strictly higher than that provided by using the CCMs computed from the full-color images, for 38 out of the 120 cases. This result is unexpected, because CFA images are sampled from full-color images. Such cases mainly occur when q is low, which shows that CFA CCMs are more robust than CCMs against the color component quantization.

The best overall classification accuracy for each dataset is provided by CCMs (regardlessly from 
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       (
                                       q
                                       )
                                    
                                 
                              
                            or 
                              
                                 
                                    
                                       I
                                    
                                    
                                       (
                                       q
                                       )
                                    
                                 
                              
                           ): it reaches 
                              
                                 94.85
                                 %
                              
                            for Outex (
                              
                                 n
                                 =
                                 1
                                 ,
                                 
                                 M
                                 =
                                 1
                                 ,
                                 
                                 q
                                 =
                                 128
                              
                           , Jeffrey divergence) and 
                              
                                 99.07
                                 %
                              
                            for VisTex (
                              
                                 n
                                 =
                                 1
                                 ,
                                 
                                 M
                                 =
                                 1
                                 ,
                                 
                                 q
                                 =
                                 256
                              
                           , Jeffrey divergence). Remarkably, CFA CCMs provide overall best results that are very close: 
                              
                                 94.41
                                 %
                              
                            for Outex (
                              
                                 n
                                 =
                                 1
                                 ,
                                 
                                 M
                                 =
                                 1
                                 ,
                                 
                                 q
                                 =
                                 64
                              
                           , Jeffrey divergence) and 
                              
                                 98.61
                                 %
                              
                            for VisTex (
                              
                                 n
                                 =
                                 1
                                 ,
                                 
                                 M
                                 =
                                 1
                                 ,
                                 
                                 q
                                 =
                                 32
                              
                            or 64, Jeffrey divergence). These best results are always provided by the 1-NN classifier coupled with the Jeffrey divergence. For the two datasets, the classficiation accuracy obtained for 
                              
                                 n
                                 =
                                 1
                              
                            is always higher than for 
                              
                                 n
                                 =
                                 5
                              
                           , the other parameters being fixed. But the distance parameter hardly influences the number of cases when CFA CCMs outperform CCMs extracted from demosaiced images.


                           Tables 3 and 4
                           
                            display the average match percentile (see Eq. (18)) obtained with the Outex and the VisTex test images. As for the classification accuracy, the values considered for the distance parameter n are 1 (see Tables 3 and 4a) and 5 (see Tables 3 and 4b). These tables show that CFA CCMs extracted directly from the CFA image outperform CCMs extracted from demosaiced images in all but one of the cases. This means that the true target image ranks better on average with the CFA CCMs than with the CCMs. In this retrieval scheme, CFA CCMs even outperform CCMs computed from the full-color images in 6 out of the 20 cases for the Outex dataset, and in 15 out of the 20 cases for the VisTex dataset. The best AMP for the Outex dataset is provided by CFA CCMs or CCMs computed from the full-color image. It reaches 97.68% when 
                              
                                 q
                                 =
                                 32
                              
                            and using the Jeffrey divergence. The best AMP for VisTeX (97.57%) is obtained for CCMs computed from the full-color image when 
                              
                                 q
                                 =
                                 256
                              
                            and using the Jeffrey divergence. These conclusions are consistent with those drawn from the classification accuracy results.

The results of this subsection overall allow us to conclude that the CFA CCMs generally provide a higher quality of texture classification or retrieval than the CCMs extracted from the demosaiced images, whatever the similarity measure used and parameter values.

In this subsection, we focus on the analysis of images acquired by a single-sensor color camera that delivers CFA images. So, we propose to compare the complexity of computing CFA CCMs rather than CCMs extracted from demosaiced images. To perform such an estimation, the favored option is based on the number of elementary operations required by the tested schemes, rather than their processing time that strongly depends on the code optimization. The sole elementary operations considered here are arithmetic operations, all being equally weighted in the complexity computation. Array indexing (or memory access) associated with each elementary operation is not taken into account, because the neighborhoods practically used to compute the different kinds of CCMs are always identical in order to obtain comparable results.


                        Table 5
                         summarizes the numbers of elementary operations required to compute texture descriptors from a CFA image of size N pixels, according to the two examined strategies:
                           
                              •
                              the CCMs of the demosaiced color image 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                 , estimated from the CFA image according to two demosaicing schemes;

the CFA CCMs, directly computed from the CFA image 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                       
                                    
                                 .

Dubois’s scheme is based on Alleysson et al.’s approach using frequency selection [30], and is assumed to be similarly complex. It is not easy to evaluate the computational complexity of these sophisticated schemes, but Lian et al. have discussed this topic for several algorithms [15]. They indicate that 
                           
                              145
                              ·
                              N
                           
                         elementary operations are required by the frequency-selection method, and 
                           
                              65
                              ·
                              N
                           
                         operations for their own scheme.

The quantization step requires 
                           
                              3
                              ·
                              N
                           
                         elementary operations for the three color components of the demosaiced color images, and only N elementary operations for the CFA image.

Array indexing being ignored here, the number of elementary operations required to compute a CCM or a CFA CCM only depends on the number of co-occurrences taken into account at each pixel. The neighborhood used to compute (CFA) CCMs contains 8 pixels when the two considered color components are the same, and 4 pixels when they are different. Since each case corresponds to 3 out of the 6 CCMs, the number of co-occurrences finally amounts to 
                           
                              3
                              ·
                              8
                              ·
                              N
                              +
                              3
                              ·
                              4
                              ·
                              N
                              =
                              36
                              ·
                              N
                           
                         for the CCMs extracted from a demosaiced color image, and only to 
                           
                              11
                              ·
                              N
                           
                         for the CFA CCMs (in subSection 3.2, we have seen that there are 
                           
                              2
                              ·
                              N
                           
                         co-occurrences for 
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    R
                                    ,
                                    R
                                 
                              
                              [
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                              ]
                              ,
                              
                              4
                              ·
                              N
                           
                         for 
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    G
                                    ,
                                    G
                                 
                              
                              [
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                              ]
                              ,
                              
                              2
                              ·
                              N
                           
                         for 
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    B
                                    ,
                                    B
                                 
                              
                              [
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                              ]
                           
                        , and N for 
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    R
                                    ,
                                    G
                                 
                              
                              [
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                              ]
                              ,
                              
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    R
                                    ,
                                    B
                                 
                              
                              [
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                              ]
                           
                        , and 
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    B
                                    ,
                                    G
                                 
                              
                              [
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                              
                              ]
                           
                        ). Normalizing the 6 (CFA) CCMs requires about 
                           
                              12
                              ·
                              
                                 
                                    q
                                 
                                 
                                    2
                                 
                              
                           
                         operations (
                           
                              6
                              ·
                              (
                              
                                 
                                    q
                                 
                                 
                                    2
                                 
                              
                              -
                              1
                              )
                           
                         additions and 
                           
                              6
                              ·
                              
                                 
                                    q
                                 
                                 
                                    2
                                 
                              
                           
                         divisions).

Overall, the number of elementary operations required to compute the CCMs extracted from the demosaiced color image reaches at least 
                           
                              104
                              ·
                              N
                              +
                              12
                              ·
                              
                                 
                                    q
                                 
                                 
                                    2
                                 
                              
                           
                        , whereas that required to compute the CFA CCMs from the CFA image is 
                           
                              12
                              ·
                              N
                              +
                              12
                              ·
                              
                                 
                                    q
                                 
                                 
                                    2
                                 
                              
                           
                        . The main differences occur at the demosaicing and the CCM computing steps. Assuming for simplicity that the value of 
                           
                              
                                 
                                    q
                                 
                                 
                                    2
                                 
                              
                           
                         is of the same order of magnitude as N, our strategy requires nearly five times fewer elementary operations. This study shows that characterizing textures thanks to the CFA CCMs, directly extracted from CFA images, is less time-consuming than thanks to the CCMs extracted from color demosaiced images.

In this section, we have considered that the used color camera is equipped with a single sensor (see Fig. 1b). Thus, the input images are either CFA or demosaiced color images. The full-color images 
                           
                              
                                 
                                    I
                                 
                                 
                                    (
                                    q
                                    )
                                 
                              
                           
                         acquired by a three-sensor camera (see Fig. 1a) are only used for reference purposes. According to Tables 1 and 2, CFA CCMs perform worse than CCMs computed from 
                           
                              
                                 
                                    I
                                 
                                 
                                    (
                                    q
                                    )
                                 
                              
                           
                         by 
                           
                              0.77
                              %
                           
                         on average over the 120 tested cases. One may therefore choose to use instead a three-sensor camera despite its higher price, and to compute the CCMs from the full-color undemosaiced images it delivers. Should such a camera be affordable, this is certainly a desirable solution when computation time is a minor concern. But when computation efficiency is a key issue, like for real-time texture recognition systems, the image size should be decreased because 
                           
                              36
                              ·
                              N
                           
                         operations are required to compute CCMs from 
                           
                              
                                 
                                    I
                                 
                                 
                                    (
                                    q
                                    )
                                 
                              
                           
                         whose size is N pixels (see Table 5). In this subsection, we study the classification and retrieval performances under such an hypothesis and compare them to those of CFA CCMs computed from images acquired by a single-sensor camera.

We halve each dimension of the original full-color images to obtain the images denoted by 
                           
                              
                                 
                                    I
                                 
                                 
                                    *
                                    (
                                    q
                                    )
                                 
                              
                           
                         whose size is 
                           
                              
                                 
                                    N
                                 
                                 
                                    4
                                 
                              
                           
                         pixels. This is fair because 
                           
                              36
                              ·
                              
                                 
                                    N
                                 
                                 
                                    4
                                 
                              
                              =
                              9
                              ·
                              N
                           
                         operations are then required to compute the CCMs, which is similar to CFA CCM computation requirements (
                           
                              11
                              ·
                              N
                           
                         operations).
                           2
                           CCM normalization is ignored here because it is equally complex in all approaches.
                        
                        
                           2
                         A high-quality resizing method is used [31], which is based on least-squares approximation and which represents images by a continuously defined B-spline model.

The correct classification rates and AMPs obtained thereby are shown in Tables 1–4 in the fifth column of each similarity measure. Over the 120 cases, the three-sensor approach (CCMs from the reduced-size images 
                           
                              
                                 
                                    I
                                 
                                 
                                    *
                                    (
                                    q
                                    )
                                 
                              
                           
                        ) never outperforms the single-sensor one (CFA CCMs from the full-size CFA images 
                           
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                                 
                                    (
                                    q
                                    )
                                 
                              
                           
                        ). Reducing the image resolution is therefore detrimental to texture classification, as also noted by another study [32]. We can further state that the color information lack in CFA images with regard to full-color images is less detrimental than the full-color image size reduction by factor 4. In other terms, we conclude as follows: at given memory footprint (or computation cost), reducing the color definition is preferable to reducing the spatial resolution for color texture classification.

@&#CONCLUSION@&#

This paper focuses on color texture analysis from images acquired from single-sensor color cameras. Such devices deliver CFA images, in which each pixel is characterized by only one of the three color components. The demosaicing step, that estimates the two missing color components at each pixel to provide the demosaiced color images, may alter the texture representation quality while being time-consuming. This leads us to develop a new strategy that directly analyzes the CFA images to classify color textures.

For this purpose, we propose new color texture descriptors stemming from classical chromatic co-occurrence matrices (CCMs). Called CFA CCMs, they are directly extracted from the CFA image, for which they describe the co-occurrences between color components of neighboring pixels. Two textures represented by CFA images are then simply compared by a similarity measure between their respective CFA CCMs.

Experimental results from benchmark texture datasets show that better classification accuracies and recognition rates are achieved by comparing CFA CCMs rather than CCMs extracted from demosaiced color images. This confirms that the demosaicing step alters the texture representation quality. Moreover, we have shown that the CFA CCM approach is less time-consuming than that based on CCMs. Such outstanding performance could be exploited whenever a texture classification scheme analyzes images acquired by a single-sensor color camera.

The proposed CFA CCM descriptors only represent the color textures in the RGB color space. Yet, many color spaces exist, with specific properties, and it is well-known that the choice of a given color space impacts the accuracy of color texture classification [33]. Therefore, we now aim to code specific CFA CCMs in different color spaces.

To alleviate the memory storage cost of these descriptors, it would be relevant to further extract color texture features from them. Haralick’s features, for instance, are often extracted from CCMs in order to characterize textures [34]. Even if this computation is highly time-consuming, the same approach could be applied to CFA CCMs to classify color textures.

This study introduces a new low-level strategy of CFA image analysis, that provides promising results. It highlights the fact that demosaicing may not be useful and should even be avoided to analyze images acquired by single-sensor color cameras. This is all the more accurate that demosaicing schemes are designed to produce “perceptually satisfying” images, regardless of the need to analyze them. A similar strategy could be, for instance, followed on for object extraction and recognition. Because most color cameras actually deliver CFA images, the need for on-board low-level image analysis schemes processed in real time makes such approaches of the utmost importance.

This appendix shows that, for a given CFA image, the CFA CCMs 
                        
                           
                              
                                 M
                              
                              
                                 CFA
                              
                              
                                 k
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 M
                              
                              
                                 CFA
                              
                              
                                 
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 k
                              
                           
                        
                      (or their normalized counterparts 
                        
                           
                              
                                 m
                              
                              
                                 CFA
                              
                              
                                 k
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 m
                              
                              
                                 CFA
                              
                              
                                 
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 k
                              
                           
                        
                     ) contain the same information for any pair of color components 
                        
                           (
                           k
                           ,
                           
                              
                                 k
                              
                              
                                 ′
                              
                           
                           )
                           ∈
                           S
                        
                     , because 
                        
                           
                              
                                 M
                              
                              
                                 CFA
                              
                              
                                 k
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          I
                                       
                                       
                                          CFA
                                       
                                    
                                 
                              
                           
                           =
                           
                              
                                 M
                              
                              
                                 CFA
                              
                              
                                 
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 k
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                       
                                    
                                 
                              
                              
                                 T
                              
                           
                        
                     .

Let us first notice that R and B components play a similar role in the CFA image. Indeed, the neighborhoods of pixels whose available color component is R and B (i.e., 
                     
                        
                           
                              
                                 N
                              
                              
                                 CFA
                              
                           
                           (
                           P
                           )
                           ,
                           P
                           ∈
                           
                              
                                 I
                              
                              
                                 CFA
                              
                              
                                 R
                              
                           
                        
                     , and 
                        
                           
                              
                                 N
                              
                              
                                 CFA
                              
                           
                           (
                           P
                           )
                           ,
                           P
                           ∈
                           
                              
                                 I
                              
                              
                                 CFA
                              
                              
                                 B
                              
                           
                        
                     ) are dual configurations (see Figs. 6a and d). Consequently, 
                        
                           
                              
                                 N
                              
                              
                                 CFA
                              
                              
                                 R
                                 ,
                                 B
                              
                           
                        
                      and 
                        
                           
                              
                                 N
                              
                              
                                 CFA
                              
                              
                                 B
                                 ,
                                 R
                              
                           
                        
                      are dual neighborhoods, and 
                        
                           
                              
                                 M
                              
                              
                                 CFA
                              
                              
                                 R
                                 ,
                                 B
                              
                           
                        
                      and 
                        
                           
                              
                                 M
                              
                              
                                 CFA
                              
                              
                                 B
                                 ,
                                 R
                              
                           
                        
                      matrices are transpose of each other. Besides, the following reasoning, established for 
                        
                           k
                           =
                           G
                        
                      and 
                        
                           
                              
                                 k
                              
                              
                                 ′
                              
                           
                           =
                           R
                        
                     , remains valid when 
                        
                           
                              
                                 k
                              
                              
                                 ′
                              
                           
                           =
                           B
                        
                     .

Let us consider the color component pair (
                        
                           k
                           =
                           G
                           ,
                           
                              
                                 k
                              
                              
                                 ′
                              
                           
                           =
                           R
                        
                     ) and show that 
                        
                           
                              
                                 M
                              
                              
                                 CFA
                              
                              
                                 G
                                 ,
                                 R
                              
                           
                        
                      and 
                        
                           
                              
                                 M
                              
                              
                                 CFA
                              
                              
                                 R
                                 ,
                                 G
                              
                           
                        
                      matrices are transpose of each other. For this purpose, let us examine the neighborhood 
                        
                           
                              
                                 N
                              
                              
                                 CFA
                              
                              
                                 G
                                 ,
                                 R
                              
                           
                        
                      used to compute 
                        
                           
                              
                                 M
                              
                              
                                 CFA
                              
                              
                                 G
                                 ,
                                 R
                              
                           
                        
                     . At a pixel 
                        
                           P
                           (
                           x
                           ,
                           y
                           )
                        
                      whose available color component is G in 
                        
                           
                              
                                 I
                              
                              
                                 CFA
                              
                           
                        
                      (i.e., 
                     
                        
                           P
                           ∈
                           
                              
                                 I
                              
                              
                                 CFA
                              
                              
                                 G
                              
                           
                        
                     ), two different configurations may be encountered for the (full) 
                        
                           5
                           ×
                           5
                        
                      neighborhood 
                        
                           
                              
                                 N
                              
                              
                                 CFA
                              
                           
                           (
                           P
                           )
                        
                      centered at this pixel, according to the parity of its coordinates x and y (see Figs. 6b and c). Within each of these two configurations, only 2 pixels fulfill the Eq. (14) extended to (
                        
                           k
                           =
                           G
                           ,
                           
                              
                                 k
                              
                              
                                 ′
                              
                           
                           =
                           R
                        
                     ) to define 
                        
                           
                              
                                 N
                              
                              
                                 CFA
                              
                              
                                 G
                                 ,
                                 R
                              
                           
                           (
                           P
                           )
                        
                     . They are located either along the horizontal direction if x and y are even (see Fig. 12
                     a), or along the vertical direction if x and y are odd (see Fig. 12b). The definition of each cell of 
                        
                           
                              
                                 M
                              
                              
                                 CFA
                              
                              
                                 G
                                 ,
                                 R
                              
                           
                        
                      (see Eq. (11)) can then be rewritten as:
                        
                           (19)
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    G
                                    ,
                                    R
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                       
                                    
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             
                                                P
                                                (
                                                x
                                                ,
                                                y
                                                )
                                                ∈
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      CFA
                                                   
                                                   
                                                      G
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                even
                                                ,
                                                
                                                y
                                                
                                                even
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       Q
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             CFA
                                          
                                          
                                             G
                                             ,
                                             R
                                          
                                       
                                       (
                                       P
                                       )
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      CFA
                                                   
                                                
                                                (
                                                P
                                                )
                                                =
                                                i
                                                
                                                and
                                                
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      CFA
                                                   
                                                
                                                (
                                                Q
                                                )
                                                =
                                                j
                                                ,
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             
                                                P
                                                (
                                                x
                                                ,
                                                y
                                                )
                                                ∈
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      CFA
                                                   
                                                   
                                                      G
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                odd
                                                ,
                                                
                                                y
                                                
                                                odd
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       Q
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             CFA
                                          
                                          
                                             G
                                             ,
                                             R
                                          
                                       
                                       (
                                       P
                                       )
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      CFA
                                                   
                                                
                                                (
                                                P
                                                )
                                                =
                                                i
                                                
                                                and
                                                
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      CFA
                                                   
                                                
                                                (
                                                Q
                                                )
                                                =
                                                j
                                                ,
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     Figs. 6 and 7 show that, by neighborhood construction, when Q belongs to 
                        
                           
                              
                                 N
                              
                              
                                 CFA
                              
                              
                                 k
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           (
                           P
                           )
                        
                     , then P belongs to 
                        
                           
                              
                                 N
                              
                              
                                 CFA
                              
                              
                                 
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 k
                              
                           
                           (
                           Q
                           )
                        
                     , and vice versa. In particular,
                        
                           (20)
                           
                              Q
                              ∈
                              
                                 
                                    N
                                 
                                 
                                    CFA
                                 
                                 
                                    G
                                    ,
                                    R
                                 
                              
                              (
                              P
                              )
                              ⇔
                              P
                              ∈
                              
                                 
                                    N
                                 
                                 
                                    CFA
                                 
                                 
                                    R
                                    ,
                                    G
                                 
                              
                              (
                              Q
                              )
                              .
                           
                        
                     Also note that 
                        
                           Q
                           ∈
                           
                              
                                 N
                              
                              
                                 CFA
                              
                              
                                 G
                                 ,
                                 R
                              
                           
                           (
                           P
                           )
                           ⇒
                           Q
                           ∈
                           
                              
                                 I
                              
                              
                                 CFA
                              
                              
                                 R
                              
                           
                        
                     . Hence, rather than scanning 
                        
                           P
                           ∈
                           
                              
                                 I
                              
                              
                                 CFA
                              
                              
                                 G
                              
                           
                        
                      to compute 
                        
                           
                              
                                 M
                              
                              
                                 CFA
                              
                              
                                 G
                                 ,
                                 R
                              
                           
                        
                     , we can scan 
                        
                           Q
                           ∈
                           
                              
                                 I
                              
                              
                                 CFA
                              
                              
                                 R
                              
                           
                        
                     . Eq. (19) then becomes:
                        
                           (21)
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    G
                                    ,
                                    R
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                       
                                    
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       Q
                                       (
                                       X
                                       ,
                                       Y
                                       )
                                       ∈
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                          
                                             R
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             
                                                P
                                                (
                                                x
                                                ,
                                                y
                                                )
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      CFA
                                                   
                                                   
                                                      R
                                                      ,
                                                      G
                                                   
                                                
                                                (
                                                Q
                                                )
                                             
                                             
                                                x
                                                
                                                even
                                                ,
                                                
                                                y
                                                
                                                even
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      CFA
                                                   
                                                
                                                (
                                                P
                                                )
                                                =
                                                i
                                                
                                                and
                                                
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      CFA
                                                   
                                                
                                                (
                                                Q
                                                )
                                                =
                                                j
                                                ,
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       Q
                                       (
                                       X
                                       ,
                                       Y
                                       )
                                       ∈
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                          
                                             R
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             
                                                P
                                                (
                                                x
                                                ,
                                                y
                                                )
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      CFA
                                                   
                                                   
                                                      R
                                                      ,
                                                      G
                                                   
                                                
                                                (
                                                Q
                                                )
                                             
                                             
                                                x
                                                
                                                odd
                                                
                                                y
                                                
                                                odd
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      CFA
                                                   
                                                
                                                (
                                                P
                                                )
                                                =
                                                i
                                                
                                                and
                                                
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      CFA
                                                   
                                                
                                                (
                                                Q
                                                )
                                                =
                                                j
                                                ,
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       Q
                                       (
                                       X
                                       ,
                                       Y
                                       )
                                       ∈
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                          
                                             R
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             
                                                P
                                                (
                                                x
                                                ,
                                                y
                                                )
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      CFA
                                                   
                                                   
                                                      R
                                                      ,
                                                      G
                                                   
                                                
                                                (
                                                Q
                                                )
                                             
                                             
                                                x
                                                
                                                and
                                                
                                                y
                                                
                                                of
                                                
                                                same
                                                
                                                parity
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      CFA
                                                   
                                                
                                                (
                                                P
                                                )
                                                =
                                                i
                                                
                                                and
                                                
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      CFA
                                                   
                                                
                                                (
                                                Q
                                                )
                                                =
                                                j
                                                ,
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     Now, let us notice that:
                        
                           (22)
                           
                              P
                              (
                              x
                              ,
                              y
                              )
                              ∈
                              
                                 
                                    N
                                 
                                 
                                    CFA
                                 
                                 
                                    R
                                    ,
                                    G
                                 
                              
                              (
                              Q
                              )
                              ⇒
                              P
                              (
                              x
                              ,
                              y
                              )
                              ∈
                              
                                 
                                    I
                                 
                                 
                                    CFA
                                 
                                 
                                    G
                                 
                              
                              
                                 
                                    ⇒
                                 
                                 
                                    (
                                    9
                                    )
                                 
                              
                              
                              x
                              
                              and
                              
                              y
                              
                              of
                              
                              same
                              
                              parity
                              .
                           
                        
                     The conditions on coordinates of P can then be omitted in Eq. (21), and swapping variable names P and 
                        
                           Q
                           ,
                           x
                        
                      and 
                        
                           X
                           ,
                           y
                        
                      and Y, yields:
                        
                           (23)
                           
                              
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             CFA
                                          
                                          
                                             G
                                             ,
                                             R
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      CFA
                                                   
                                                
                                             
                                          
                                       
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                P
                                                (
                                                x
                                                ,
                                                y
                                                )
                                                ∈
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      CFA
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                       
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                Q
                                                (
                                                X
                                                ,
                                                Y
                                                )
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      CFA
                                                   
                                                   
                                                      R
                                                      ,
                                                      G
                                                   
                                                
                                                (
                                                P
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         if
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               CFA
                                                            
                                                         
                                                         (
                                                         Q
                                                         )
                                                         =
                                                         i
                                                         
                                                         and
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               CFA
                                                            
                                                         
                                                         (
                                                         P
                                                         )
                                                         =
                                                         j
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         otherwise
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       
                                       
                                       
                                       =
                                       
                                          
                                             M
                                          
                                          
                                             CFA
                                          
                                          
                                             R
                                             ,
                                             G
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      CFA
                                                   
                                                
                                             
                                          
                                       
                                       (
                                       j
                                       ,
                                       i
                                       )
                                       .
                                    
                                 
                              
                           
                        
                     A similar demonstration can be performed to show that:
                        
                           (24)
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    G
                                    ,
                                    B
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                       
                                    
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              =
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    B
                                    ,
                                    G
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                       
                                    
                                 
                              
                              (
                              j
                              ,
                              i
                              )
                              .
                           
                        
                     In conclusion, the multi-component CFA CCMs 
                        
                           
                              
                                 M
                              
                              
                                 CFA
                              
                              
                                 k
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          I
                                       
                                       
                                          CFA
                                       
                                    
                                 
                              
                           
                           ,
                           (
                           k
                           ,
                           
                              
                                 k
                              
                              
                                 ′
                              
                           
                           )
                           
                           ∉
                           
                           S
                        
                     , are all respective transpose of those in 
                        
                           S
                        
                     :
                        
                           (25a)
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    G
                                    ,
                                    R
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    R
                                    ,
                                    G
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                CFA
                                             
                                          
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (25b)
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    G
                                    ,
                                    B
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    B
                                    ,
                                    G
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                CFA
                                             
                                          
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (25c)
                           
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    B
                                    ,
                                    R
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             CFA
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    M
                                 
                                 
                                    CFA
                                 
                                 
                                    R
                                    ,
                                    B
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                CFA
                                             
                                          
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              .
                           
                        
                     
                  

@&#REFERENCES@&#

