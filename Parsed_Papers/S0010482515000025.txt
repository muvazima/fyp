@&#MAIN-TITLE@&#MR image super-resolution reconstruction using sparse representation, nonlocal similarity and sparse derivative prior

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Do MR image SR by jointly using sparsity prior, nonlocal similarity, and sparse derivative prior.


                        
                        
                           
                           Use multi-scale first- and second-order derivative to estimate high-frequency information.


                        
                        
                           
                           Use sparse derivative prior based post-processing to suppress blurring effects in MR images.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Magnetic resonance imaging

Super-resolution

Sparse representation

Sparse derivative prior

Nonlocal similarity

@&#ABSTRACT@&#


               
               
                  In magnetic resonance (MR) imaging, image spatial resolution is determined by various instrumental limitations and physical considerations. This paper presents a new algorithm for producing a high-resolution version of a low-resolution MR image. The proposed method consists of two consecutive steps: (1) reconstructs a high-resolution MR image from a given low-resolution observation via solving a joint sparse representation and nonlocal similarity L1-norm minimization problem; and (2) applies a sparse derivative prior based post-processing to suppress blurring effects. Extensive experiments on simulated brain MR images and two real clinical MR image datasets validate that the proposed method achieves much better results than many state-of-the-art algorithms in terms of both quantitative measures and visual perception.
               
            

@&#INTRODUCTION@&#

Compared with other medical imaging techniques, MR imaging uses non-ionizing radiation and provides distinct microscopic chemical and physical information of molecules. However, the spatial resolution of MR images is limited by various instrumental limitations (e.g., gradients’ intensity, filter bandwidth) and physical considerations. The resolution limitation could result in partial volume effect (PVE), a phenomenon that each pixel in the MR images could contain more than one material or tissue type. To reduce PVEs, a common practice is to magnify the images using standard interpolation techniques. However, interpolation techniques usually do not take into account the fact that a low-resolution (LR) pixel is actually a weighted average of the high-resolution (HR) pixels inside it, thus the magnified HR images are typically featured with blurred edges and tissues.

To overcome this problem, various methods have been proposed [1,5–8,11,12,17–20] so far. Among them, super-resolution (SR) is one of the most promising methods and receives much attention in the research community. SR image reconstruction is the process of recovering a HR image from a single (e.g., [2]) or a set of LR images (e.g., [3]). The essential difference between single-frame and multi-frame SR image reconstruction is that new high-frequency information could also be recovered from different LR frames [4]. In MR image analysis, SR was first used to reconstruct a HR image by merging multiple LR acquisitions with subpixel displacements. In [5], Herment et al. reduced total data acquisition time by merging multiple k-space data. Shilling et al. [6] improved the resolution and contrast of MR images by fusing multiple 2D slices with different slice directions. Greenspan et al. [7] used iterative back-projection and Islamet al. [8] used a wavelet-based deblurring approach to improve the resolution of 3D MR images.

Though multi-frame SR image reconstruction is theoretically more promising than single-frame SR image reconstruction, it suffers many difficulties in real applications, such as subpixel image registration/acquisition, the increase of computational complexity as frame number increases. On the other hand, many researches [9,10] have demonstrated that, given a proper prior image model, single-frame SR image reconstruction can also be as effective as multi-frame SR image reconstruction. To reconstruct a HR image from a single MR image, Rousseau [11] used the idea presented in [9] and proposed a patch-based nonlocal regularization framework for brain MR image reconstruction. Manjón et al. [12] extended the patch-based nonlocal regularization framework to include a coherence constraint.

Recently, a powerful statistical image modeling technique, sparse representation [13,14], has been successfully applied in natural image SR applications [15,16,22]. In MR image analysis, however, many efforts have been focused on applying compressed sensing (CS) [17–20], a technique through which a perfect MR image reconstruction is possible by only a small subset of k-space samples that is far less than the Nyquist sampling theorem. Since these CS-based SR methods [17–20] focus on manipulating k-space samples, they do have many advantages, e.g., theoretical simplicity and low computational cost. Nevertheless, they also present some important drawbacks. For example, recovering high frequency information in the k-space will inevitably cause visual artifacts in the image space, thus they need to work in the frequency and the image space in turn to suppress artifacts [20,21]. On the other hand, sparse representation based techniques manipulate image patches in the image space, thus provide much more interpretable information to human eyes, and more importantly, facilitate experts to adopt a much more flexible observation model (e.g., local motion) and incorporate various image priors. Based on these considerations, Andrea et al. [21] proposed to reconstruct HR 3D brain MR image from LR 3D image volumes using overcomplete dictionaries.

Motivated by the ideas presented in Refs. [11,12,21,36,37], in this paper, we propose a new algorithm for reconstructing a HR MR image from a single LR image. The proposed method consists of two consecutive steps: (1) reconstructs a HR MR image from a given LR observation via solving a joint sparse representation and nonlocal similarity L1-norm minimization problem; and (2) applies a sparse derivative prior based post-processing on the reconstructed HR image to suppress blurring effects.

The rest of the paper is organized as follows. In Section 2, we give a brief review of SR image reconstruction based on sparse representation. Sections 3 and 4 present the nonlocal similarity and sparse derivative prior image model, respectively. Section 5 presents the new algorithm. Extensive experiments on simulated brain MR images and two real clinical MR image datasets are conducted in Section 6 to verify the efficiency of our method. Finally, we provide discussion in Section 7.

In SR image reconstruction, the LR image can be modeled as a down-sampled version of the HR image which has been blurred, i.e.,
                        
                           (1)
                           
                              Y
                              
                              =
                              
                              W
                              Z
                              
                           
                        
                     where Y is the observed LR image, Z is the original HR image, and W is a degradation operator representing the blur and down-sampling operator which operates on Z to yield Y (geometric shift is not included in W since we focus on the single-frame SR reconstruction). A maximum a posterior (MAP) estimate of the unknown HR image Z can be computed as
                        
                           (2)
                           
                              
                                 Z
                                 ^
                              
                              =
                              arg
                              
                              
                                 
                                    max
                                 
                                 Z
                              
                              {
                              
                              log
                              
                              Pr
                              (
                              Z
                              |
                              Y
                              )
                              }
                              =
                              
                                 
                                    arg
                                    
                                    min
                                 
                                 Z
                              
                              
                                 {
                                 
                                    
                                       
                                          ‖
                                          
                                             Y
                                             −
                                             W
                                             Z
                                          
                                          ‖
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    
                                    log
                                    
                                    Pr
                                    (
                                    Z
                                    )
                                 
                                 }
                              
                           
                        
                     where Pr(Z) is the prior image model. Many works have been contributed to find a good prior image model, and total variation (TV) [23–26] is one of the most commonly used models. Sparse representation has also been successfully applied as a prior image model as well. Given an image Z, the sparse representation assumes that there exists a sparse vector 
                        Λ
                      and a proper learned dictionary 
                        Ψ
                      (each column in 
                        Ψ
                      is referred to as an atom), such that
                        
                           (3)
                           
                              Z
                              ≈
                              Ψ
                              Λ
                              ,
                              
                              s
                              .t
                              .
                              
                              
                                 
                                    ‖
                                    
                                       Λ
                                    
                                    ‖
                                 
                                 
                                    0
                                 
                              
                              ≤
                              ε
                           
                        
                     where 
                        ε
                      is a predefined threshold to control the sparsity of 
                        Λ
                      and L0-norm 
                        
                           
                              ‖
                              
                                 ⋅
                              
                              ‖
                           
                           
                              0
                           
                        
                      counts the number of nonzero elements in a vector.

Let 
                        
                           
                              Ψ
                           
                           
                              h
                           
                        
                      and 
                        
                           
                              Ψ
                           
                           
                              l
                           
                        
                      are the coupled two dictionaries for the HR and LR images, respectively. For single-frame SR reconstruction, given a HR image Z and the corresponding LR image Y, there exists a sparse vector 
                        Λ
                      simultaneously satisfies [15]
                     
                        
                           (4)
                           
                              Z
                              ≈
                              
                                 
                                    Ψ
                                 
                                 
                                    h
                                 
                              
                              Λ
                              
                              
                              and
                              
                              Y
                              ≈
                              
                                 
                                    Ψ
                                 
                                 
                                    l
                                 
                              
                              Λ
                              ,
                              
                              s
                              .t
                              .
                              
                              
                                 
                                    ‖
                                    
                                       Λ
                                    
                                    ‖
                                 
                                 
                                    0
                                 
                              
                              ≤
                              ε
                              ,
                           
                        
                     
                  

With the sparsity prior image model defined in (4), finding the solution to (1) is equivalent to finding the representation of Z over 
                        
                           
                              Ψ
                           
                           
                              h
                           
                        
                     , which can be estimated from its LR observation Y by solving the following L0-norm minimization problem:
                        
                           (5)
                           
                              
                                 Λ
                                 ^
                              
                              =
                              
                                 
                                    arg
                                    
                                    min
                                 
                                 Λ
                              
                              
                                 {
                                 
                                    
                                       
                                          ‖
                                          
                                             Y
                                             −
                                             
                                                
                                                   Ψ
                                                
                                                
                                                   l
                                                
                                             
                                             Λ
                                          
                                          ‖
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    λ
                                    
                                       
                                          ‖
                                          
                                             Λ
                                          
                                          ‖
                                       
                                       
                                          0
                                       
                                    
                                 
                                 }
                              
                           
                        
                     where 
                        λ
                      is a parameter controlling the importance of sparsity prior. Since L0-norm is nonconvex and solving (5) is NP-hard, many recent works [13,27] demonstrated that if the coefficients 
                        Λ
                      is sparse enough, the solution to (5) can be efficiently approximated by solving the following L1-norm minimization problem
                        
                           (6)
                           
                              
                                 Λ
                                 ^
                              
                              =
                              
                                 
                                    arg
                                    
                                    min
                                 
                                 Λ
                              
                              
                                 {
                                 
                                    
                                       
                                          ‖
                                          
                                             Y
                                             −
                                             
                                                
                                                   Ψ
                                                
                                                
                                                   l
                                                
                                             
                                             Λ
                                          
                                          ‖
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    λ
                                    
                                       
                                          ‖
                                          
                                             Λ
                                          
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                 
                                 }
                              
                           
                        
                     where L1-norm 
                        
                           
                              ‖
                              
                                 ⋅
                              
                              ‖
                           
                           
                              1
                           
                        
                      calculates the sum of the absolute of each element in a vector. Notice that (6) is also known as the Lasso in statistical literature [28].

Once 
                        
                           Λ
                           ^
                        
                      is obtained, Z can then be estimated as
                        
                           (7)
                           
                              
                                 Z
                                 ^
                              
                              =
                              
                                 
                                    Ψ
                                 
                                 
                                    h
                                 
                              
                              
                                 Λ
                                 ^
                              
                           
                        
                     
                  

Traditionally, we divide an image into overlapped or non-overlapped patches, apply (6) and (7) to each image patch and fuse all the reconstructed HR patches to get the final HR image. To avoid confusion, we use letters in lowercase or uppercase to represent an image patch or an entire image throughout this paper unless otherwise stated. For the convenience of later discussion, we write the patch-based version of (6) and (7) as follows:
                        
                           (8)
                           
                              
                                 α
                                 ^
                              
                              =
                              
                                 
                                    arg
                                    
                                    min
                                 
                                 α
                              
                              
                                 {
                                 
                                    
                                       
                                          ‖
                                          
                                             y
                                             −
                                             
                                                
                                                   Ψ
                                                
                                                
                                                   l
                                                
                                             
                                             α
                                          
                                          ‖
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    λ
                                    
                                       
                                          ‖
                                          
                                             α
                                          
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                 
                                 }
                              
                           
                        
                     
                     
                        
                           (9)
                           
                              
                                 z
                                 ^
                              
                              =
                              
                                 
                                    Ψ
                                 
                                 
                                    h
                                 
                              
                              
                                 α
                                 ^
                              
                           
                        
                     
                  

A critical issue in sparse representation prior is the choice of dictionaries. In general, the more redundant the dictionary is, the better SR result will be. Unfortunately, the computational complexity will also increase as the size of dictionary increases. Many dictionary learning algorithms thus aim at getting a compact over-complete dictionary to represent various image patches. Nevertheless, due to the diversity of natural image patterns, it is impossible for such compact dictionary to cover all the patterns. As a result, the similar patterns can well be reconstructed while the dissimilar ones cannot. Considering the fact that either similar or dissimilar patterns, there are often many repetitive patterns throughout an image, such nonlocal redundancy is very helpful in preserving edge sharpness and suppressing noise in the reconstructed images [12,14,29,30]. As a supplementary to the sparse representation prior, in this section, we will develop a nonlocal similarity regularization term for SR image reconstruction.

For a given image patch z
                     
                        j
                     , we search for the similar patches within a sufficiently large area around z
                     
                        j
                     . Two similarity criteria have been frequently used so far: (1) a patch 
                        
                           
                              z
                           
                           
                              j
                           
                           
                              s
                           
                        
                      is selected as a similar patch to z
                     
                        j
                      if 
                        
                           
                              d
                           
                           
                              j
                           
                           
                              s
                           
                        
                        =
                        |
                        |
                        
                           
                              z
                           
                           
                              j
                           
                           
                              s
                           
                        
                        −
                        
                           
                              z
                           
                           
                              j
                           
                        
                        |
                        
                           
                              |
                           
                           
                              2
                           
                           
                              2
                           
                        
                        ≤
                        t
                     , where t is a preset threshold, or (2) one can select the patch if it is within the first L (e.g., L=15) closest patches to z
                     
                        j
                     . However, they are all based on Euclidean norm in the vector space and do not truly reflect the similarity between two vectors. In this paper, we use the cosine of the angle between two vectors as the distance measurement,
                        
                           (10)
                           
                              
                                 
                                    d
                                 
                                 
                                    j
                                 
                                 
                                    s
                                 
                              
                              =
                              
                                 
                                    〈
                                    
                                       
                                          
                                             z
                                          
                                          
                                             j
                                          
                                          
                                             s
                                          
                                       
                                       ,
                                       
                                          
                                             z
                                          
                                          
                                             j
                                          
                                       
                                    
                                    〉
                                 
                                 
                                    (
                                    |
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          j
                                       
                                       
                                          s
                                       
                                    
                                    |
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    ⋅
                                    |
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          j
                                       
                                    
                                    |
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                           
                        
                     
                  

Suppose L similar patches (
                        
                           
                              z
                           
                           
                              j
                           
                           
                              s
                           
                        
                     , s=1,2,…,L) have been located for z
                     
                        j
                     , let 
                        
                           
                              z
                           
                           
                              j
                           
                           
                              s
                           
                        
                      be the central pixel of 
                        
                           
                              z
                           
                           
                              j
                           
                           
                              s
                           
                        
                      and z
                        j
                      be the central pixel of z
                     
                        j
                     . We can use the weighted average of 
                        
                           
                              z
                           
                           
                              j
                           
                           
                              s
                           
                        
                      to predict z
                        j
                     ,
                        
                           (11)
                           
                              
                                 
                                    
                                       z
                                       ^
                                    
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 ∑
                                 
                                    s
                                    =
                                    1
                                 
                                 L
                              
                              
                                 
                                    
                                       z
                                    
                                    
                                       j
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                    
                                       s
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              c
                           
                           
                              j
                           
                           
                              s
                           
                        
                      is the weight assigned to 
                        
                           
                              z
                           
                           
                              j
                           
                           
                              s
                           
                        
                     , determined by
                        
                           (12)
                           
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                                 
                                    s
                                 
                              
                              =
                              
                                 
                                    exp
                                    (
                                    −
                                    
                                       
                                          d
                                       
                                       
                                          j
                                       
                                       
                                          s
                                       
                                    
                                    /
                                    h
                                    )
                                 
                                 
                                    
                                       ∑
                                       
                                          s
                                          =
                                          1
                                       
                                       L
                                    
                                    
                                       exp
                                       (
                                       −
                                       
                                          
                                             d
                                          
                                          
                                             j
                                          
                                          
                                             s
                                          
                                       
                                       /
                                       h
                                       )
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              d
                           
                           
                              j
                           
                           
                              s
                           
                        
                      is determined by (10) and h is a controlling factor of the weight. Considering the fact that there are plenty of repetitive patterns throughout a MR image, the mean squared error between the prediction and the ground truth, i.e.,
                        
                           (13)
                           
                              |
                              |
                              
                                 
                                    z
                                 
                                 
                                    j
                                 
                              
                              −
                              
                                 
                                    
                                       z
                                       ^
                                    
                                 
                                 
                                    j
                                 
                              
                              |
                              
                                 
                                    |
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              =
                              |
                              |
                              
                                 
                                    z
                                 
                                 
                                    j
                                 
                              
                              −
                              
                                 ∑
                                 
                                    s
                                    =
                                    1
                                 
                                 L
                              
                              
                                 
                                    
                                       z
                                    
                                    
                                       j
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                    
                                       s
                                    
                                 
                                 |
                                 
                                    
                                       |
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                     should be sufficiently small. Let c
                     
                        j
                      be the column vector containing all the weights 
                        
                           
                              c
                           
                           
                              j
                           
                           
                              s
                           
                        
                      and patch p
                     
                        j
                      be the column vector containing all 
                        
                           
                              z
                           
                           
                              j
                           
                           
                              s
                           
                        
                     . By summing the mean squared prediction error across the whole image patch z
                     
                        j
                     , we get
                        
                           (14)
                           
                              
                                 
                                    ∑
                                    
                                       
                                          
                                             z
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       
                                          
                                             z
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 
                                    |
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          j
                                       
                                    
                                    −
                                    
                                       ∑
                                       
                                          s
                                          =
                                          1
                                       
                                       L
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             j
                                          
                                          
                                             s
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             j
                                          
                                          
                                             s
                                          
                                       
                                       |
                                       
                                          
                                             |
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    ∑
                                    
                                       
                                          
                                             z
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       
                                          
                                             z
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 
                                    |
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          c
                                       
                                       
                                          j
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          j
                                       
                                    
                                    |
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                     
                  

Since (8) calculates the sparse representation coefficients of HR image patch z only using fidelity constraint and sparsity prior, to incorporate the nonlocal similarity regularization, we revise (8) as follows:
                        
                           (15)
                           
                              
                                 α
                                 ^
                              
                              =
                              
                                 
                                    arg
                                    
                                    min
                                 
                                 α
                              
                              
                                 {
                                 
                                    
                                       
                                          ‖
                                          
                                             y
                                             −
                                             
                                                
                                                   Ψ
                                                
                                                
                                                   l
                                                
                                             
                                             α
                                          
                                          ‖
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    λ
                                    
                                       
                                          ‖
                                          
                                             α
                                          
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    η
                                    
                                       
                                          ∑
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   j
                                                
                                             
                                             ∈
                                             
                                                
                                                   
                                                      z
                                                      ^
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          |
                                          |
                                          
                                             
                                                z
                                             
                                             
                                                j
                                             
                                          
                                          −
                                          
                                             
                                                c
                                             
                                             
                                                j
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                          
                                          |
                                          
                                             
                                                |
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 }
                              
                           
                        
                     where 
                        η
                      is a parameter controlling the contribution of nonlocal similarity regularization. If we define a matrix C as
                        
                           (16)
                           
                              
                                 
                                    C
                                 
                                 
                                    j
                                    s
                                 
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      s
                                                   
                                                
                                                ,
                                                if
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      s
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ,
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      s
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                0
                                                ,
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

By substituting (16) and 
                        z
                        =
                        
                           
                              Ψ
                           
                           
                              l
                           
                        
                        α
                      into (15), we get
                        
                           (17)
                           
                              
                                 α
                                 ^
                              
                              =
                              
                                 
                                    arg
                                    
                                    min
                                 
                                 α
                              
                              
                                 {
                                 
                                    
                                       
                                          ‖
                                          
                                             y
                                             −
                                             
                                                
                                                   Ψ
                                                
                                                
                                                   l
                                                
                                             
                                             α
                                          
                                          ‖
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    λ
                                    
                                       
                                          ‖
                                          
                                             α
                                          
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    η
                                    |
                                    |
                                    (
                                    I
                                    −
                                    C
                                    )
                                    
                                       
                                          Ψ
                                       
                                       
                                          l
                                       
                                    
                                    α
                                    |
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                 
                                 }
                              
                           
                        
                     where I is an identity matrix. By introducing
                        
                           (18)
                           
                              
                                 
                                    y
                                 
                                 ⁎
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             y
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ]
                              
                              
                              and
                              
                              Γ
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             I
                                          
                                       
                                       
                                          
                                             
                                                η
                                                (
                                                I
                                                −
                                                C
                                                )
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                        
                     Eq. (17) can further be simplified as
                        
                           (19)
                           
                              
                                 α
                                 ^
                              
                              =
                              
                                 
                                    arg
                                    
                                    min
                                 
                                 α
                              
                              
                                 {
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   y
                                                
                                                ⁎
                                             
                                             −
                                             Γ
                                             
                                                
                                                   Ψ
                                                
                                                
                                                   l
                                                
                                             
                                             α
                                          
                                          ‖
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    λ
                                    
                                       
                                          ‖
                                          
                                             α
                                          
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                 
                                 }
                              
                           
                        
                     
                  

Please note that (19) has exactly the same form of (8), which is also a L1-norm minimization problem.

Compared with the TV model, using sparsity prior or nonlocal similarity can improve the quality of the final HR image. However, we will demonstrate in Section 6 that sparsity prior or nonlocal similarity based methods also produce blurry effects along strong edges or in soft tissue areas in the reconstructed MR images. In general, the blurry effect is caused by the average operation in these methods. For sparsity prior based methods, overlapped HR patches are separately reconstructed and the pixels in the overlapped regions are averaged via various strategies to maintain compatibility between adjacent patches, and as a result, the selected averaging strategy largely determines the blurry degree. On the other hand, for nonlocal similarity based methods, L similar patches (not identical patches) are averaged to predict the central pixel of the target patch, and certainly the higher the degree of similarity, the less blurry effect in the final HR MR image. Since balancing the blurry effect of sparsity prior and nonlocal similarity under a unified L1-norm minimization framework is difficult and complicated, in this paper, we adopt the sparse derivative prior image model to suppress blurry effects.

For lots of natural images, researchers have found that after applying a localized, oriented, and bandpass filtering operation, the histogram of the filtered images are exponential with high fourth-order statistics (kurtosis) [38–40]. For example, 
                     Fig. 1(a) shows a natural image, the histogram of the filtered image via a 1-D filter [−1, 0, 1] is shown in Fig. 1(b). We can model the distribution in Fig. 1(b) via
                        
                           (20)
                           
                              Pr
                              (
                              x
                              )
                              ∝
                              
                              exp
                              
                              
                                 (
                                 
                                    −
                                    
                                       1
                                       2
                                    
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   |
                                                   x
                                                   |
                                                
                                                σ
                                             
                                          
                                          )
                                       
                                       α
                                    
                                 
                                 )
                              
                           
                        
                     where 
                        σ
                      is the standard deviation, and 
                        α
                      is the exponent parameter. Fig. 1(b) reveals the fact that the gradients of an image are largely zeros, i.e., strong derivatives are sparse in a given natural image. Eq. (20) is also known as the natural image prior when 
                        0
                        <
                        α
                        <
                        1
                     , for it can model lots of natural images [38–40]. Unlike the TV model assumes local smoothness, the natural image prior tends to encourage a single strong derivative, which would appear as a sharp edge in local regions. The natural image prior has been successively applied in natural image noise reduction [41], compression [42], deconvolution [43,44], and SR as well [36,37]. In [37], Tappen et al. simultaneously used fidelity constraint and natural image prior to perform SR. Kwang and Younghee [36] first used kernel ridge regression and then applied natural image prior based post-processing to suppress ringing artifacts. Nevertheless, to the authors’ best knowledge, by far there are many works reported on natural image processing utilizing natural image prior, little similar job was done on MR images or other medical images. To validate whether the natural image prior can be applied to MR images, we filter a brain MR image (shown in 
                     Fig. 2(a)) with the same 1-D filter used in Fig. 1 and show the histogram of the filtered image in Fig. 2(b). By comparing Fig. 1 with Fig. 2, it is clear that though the two images shown in Fig. 1(a) and Fig. 2(a) are quite different in nature, the distributions are almost the same, which implies that the natural image prior can also be used in MR image processing.

In [37], Tappen et al. estimated the HR patch z by maximizing the following joint posterior probability distribution
                        
                           (21)
                           
                              Pr
                              (
                              {
                              z
                              }
                              |
                              {
                              y
                              }
                              )
                              =
                              
                                 1
                                 C
                              
                              
                              
                                 ∏
                                 
                                    j
                                    ,
                                    
                                    i
                                    ∈
                                    
                                       
                                          N
                                       
                                       
                                          8
                                       
                                    
                                    (
                                    j
                                    )
                                 
                              
                              
                                 exp
                                 
                                    [
                                    
                                       −
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         
                                                            ‖
                                                            
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                            ‖
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          α
                                       
                                    
                                    ]
                                 
                              
                              
                              
                                 ∏
                                 j
                              
                              
                                 exp
                                 
                                    [
                                    
                                       −
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         
                                                            ‖
                                                            
                                                               W
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                            
                                                            ‖
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          2
                                       
                                    
                                    ]
                                 
                              
                           
                        
                     where {y} denotes the observed variables corresponding to the pixels in LR image Y, {z} represents the latent variables corresponding to the patch in HR image Z which satisfies y=Wz, N
                     8(j) denotes for 8-connected neighbors of the pixel at location j, C is the normalization constant, 
                        
                           
                              σ
                           
                           
                              N
                           
                        
                      and 
                        
                           
                              σ
                           
                           
                              R
                           
                        
                      are standard deviation parameters. The first product in (21) is the natural image prior term and the second one is the fidelity constraint term. Considering that the data fidelity constraint has already been incorporated in the reconstruction process via the coupled two dictionaries 
                        
                           
                              Ψ
                           
                           
                              h
                           
                        
                      and 
                        
                           
                              Ψ
                           
                           
                              l
                           
                        
                     , directly using (21) in our case is unsuitable. In this paper, a modified version of (21) is thus introduced as follows
                        
                           (22)
                           
                              Pr
                              (
                              {
                              z
                              }
                              |
                              {
                              
                                 z
                                 ^
                              
                              }
                              )
                              =
                              
                                 1
                                 C
                              
                              
                              
                                 ∏
                                 
                                    j
                                    ,
                                    
                                    i
                                    ∈
                                    
                                       
                                          N
                                       
                                       
                                          8
                                       
                                    
                                    (
                                    j
                                    )
                                 
                              
                              
                                 exp
                                 
                                    [
                                    
                                       −
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         
                                                            ‖
                                                            
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                            ‖
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          α
                                       
                                    
                                    ]
                                 
                              
                              
                                 ∏
                                 j
                              
                              
                                 exp
                                 
                                    [
                                    
                                       −
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         
                                                            ‖
                                                            
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     
                                                                        z
                                                                        ^
                                                                     
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                            
                                                            ‖
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          2
                                       
                                    
                                    ]
                                 
                              
                           
                        
                     where {
                        
                           z
                           ^
                        
                     } denotes the reconstructed HR patches via 
                        
                           z
                           ^
                        
                        =
                        
                           
                              Ψ
                           
                           
                              h
                           
                        
                        
                           α
                           ^
                        
                      and 
                        
                           α
                           ^
                        
                      is the solution to (19). The motivation for the replacement of the second product term is intuitive: we want that the final result is not deviate far from the output yielded by (19).

To find the solution through which the joint posterior probability distribution (22) is maximized, we first convert (22) into a factor graph (shown in 
                     Fig. 3, the complete derivation of the factor graph can be traced back to [37]) and then use a max-sum-type belief propagation (BP) algorithm to compute the exact maximum posterior probability at each variable node. To facilitate the optimization, unlike Tappen et al. did in [37] where 16 learned interpolators are used to generate 16h candidates for each latent variable, we use L+1 patches (the source patch got by (19) plus the corresponding L patches got in the step of searching for nonlocal similar patches) as candidates.

Based on (22), the logarithm of the required message-passing equations for the factor graph can be summarized as
                        
                           (23)
                           
                              
                                 
                                    
                                       
                                          
                                             ν
                                          
                                          
                                             [
                                             j
                                             ]
                                             →
                                             j
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       =
                                       −
                                       
                                          1
                                          2
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      ‖
                                                      
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  z
                                                                  ^
                                                               
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                      ‖
                                                   
                                                   
                                                      2
                                                   
                                                
                                                /
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                             )
                                          
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             [
                                             i
                                             ,
                                             j
                                             ]
                                             →
                                             i
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             max
                                          
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   j
                                                   →
                                                   [
                                                   i
                                                   ,
                                                   j
                                                   ]
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             −
                                             
                                                1
                                                2
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            ‖
                                                            
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                            ‖
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      /
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   α
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             j
                                             →
                                             [
                                             i
                                             ,
                                             j
                                             ]
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             ν
                                          
                                          
                                             [
                                             j
                                             ]
                                             →
                                             j
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      8
                                                   
                                                
                                                (
                                                j
                                                )
                                                \
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   [
                                                   j
                                                   ,
                                                   k
                                                   ]
                                                   →
                                                   j
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              ν
                           
                           
                              [
                              j
                              ]
                              →
                              j
                           
                        
                      calculates the message sent from constraint node [j] to variable node z
                     
                        j
                     , 
                        
                           
                              μ
                           
                           
                              [
                              i
                              ,
                              j
                              ]
                              →
                              i
                           
                        
                      represents the message sent from constraint node [i,j] to variable node z
                     
                        i
                     , and 
                        
                           
                              μ
                           
                           
                              j
                              →
                              [
                              i
                              ,
                              j
                              ]
                           
                        
                      is the message sent from variable node j to constraint node [i,j]. In (23), 
                        
                           
                              μ
                           
                           
                              j
                              →
                              [
                              i
                              ,
                              j
                              ]
                           
                        
                      and 
                        
                           
                              μ
                           
                           
                              [
                              i
                              ,
                              j
                              ]
                              →
                              i
                           
                        
                      are natural image prior based messages propagate from latent node j to node i, while 
                        
                           
                              ν
                           
                           
                              [
                              j
                              ]
                              →
                              j
                           
                        
                      is the deviation penalty term between latent node j and observed node j.

With L+1 candidate HR patches in hand, the sparse derivative prior based post-processing is summarized in Algorithm 1.
                        Algorithm 1
                        
                           
                              
                                 (1)
                                 Run BP algorithm X times using the three message-passing equations defined in (23).

For each variable node z
                                    
                                       j, select the candidate HR patch with the highest belief.

Insert the selected candidate HR patches into the corresponding position to form the final output HR image.

In this section, we first discuss how to construct the coupled HR and LR dictionaries, and then propose a new SR algorithm to reconstruct a HR image from a single LR MR image.

In this paper, we use a modified version of the method presented in [15,21] to construct the coupled two dictionaries 
                           
                              
                                 Ψ
                              
                              
                                 h
                              
                           
                         and 
                           
                              
                                 Ψ
                              
                              
                                 l
                              
                           
                         (as illustrated in 
                        Fig. 4). Each HR training image in the training set {Z
                        
                           j
                        , j=1,2,…, N} is first blurred and down-sampled by a factor of q to produce the corresponding LR image set {Y
                        
                           j
                        , j=1,2,…, N} (i.e., Y
                        
                           j
                        
                        =WZ
                        
                           j
                        , where W is the degradation operator defined in (1)). Then a upsampled set {
                           
                              
                                 Y
                              
                              
                                 j
                              
                              
                                 U
                              
                           
                        
                        , 
                        j=1,2,…, N} is obtained by scaling each image in {Y
                        
                           j
                        } by the same factor q via bicubic interpolation (i.e., 
                           
                              
                                 Y
                              
                              
                                 j
                              
                              
                                 U
                              
                           
                           =
                           
                              
                                 U
                              
                              
                                 q
                              
                           
                           
                              
                                 Y
                              
                              
                                 j
                              
                           
                        
                        , where 
                           
                              
                                 U
                              
                              
                                 q
                              
                           
                         is the bicubic interpolator with a magnification factor of q). Since we want dictionary 
                           
                              
                                 Ψ
                              
                              
                                 h
                              
                           
                         contains useful discriminative high-frequency information, the original HR training set {Z
                        
                           j
                        } is further processed to obtain an updated HR training set {
                           
                              
                                 Z
                              
                              
                                 j
                              
                              
                                 U
                              
                           
                           ,
                         
                        j=1,2,…, N} via 
                           
                              
                                 Z
                              
                              
                                 j
                              
                              
                                 U
                              
                           
                           =
                           
                              
                                 Z
                              
                              
                                 j
                              
                           
                           −
                           
                              
                                 Y
                              
                              
                                 j
                              
                              
                                 U
                              
                           
                        . For dictionary 
                           
                              
                                 Ψ
                              
                              
                                 l
                              
                           
                        , many previous work demonstrated that building it in feature space is more suitable than in image space [15,16,21]. Considering the fact that the high-frequency information of the LR image is critical for predicting the lost high-frequency information in the target HR image, people often choose the feature space as some kind of high-pass filtered image. For example, Yang et al. [15] used the first- and second-order derivatives as the feature due to their simplicity and effectiveness, Rueda et al. [21] applied a multi-scale edge analysis, where a series of 6 different filters (Sobel kernels, size 3×3×3 and 5×5×5, in x, y and z directions) are used. To combine the merits of both multi-scale analysis and the first- and second-order derivatives, in this paper, we use a multi-scale (size 3×3 and 5×5) first- and second-order derivative analysis to extract features from the upsampled image set {
                           
                              
                                 Y
                              
                              
                                 j
                              
                              
                                 U
                              
                           
                        
                        }.

The eight 1-D filters used to extract multi-scale first- and second-order derivatives are
                           
                              (24)
                              
                                 
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          [
                                          −
                                          1
                                          ,
                                          0
                                          ,
                                          1
                                          ]
                                          ;
                                          
                                             
                                                F
                                             
                                             
                                                2
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                [
                                                −
                                                1
                                                ,
                                                0
                                                ,
                                                1
                                                ]
                                             
                                             T
                                          
                                          ;
                                          
                                             
                                                F
                                             
                                             
                                                3
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          [
                                          −
                                          1
                                          ,
                                          −
                                          2
                                          ,
                                          
                                          0
                                          ,
                                          
                                          2
                                          ,
                                          
                                          1
                                          ]
                                          ;
                                          
                                             
                                                F
                                             
                                             
                                                4
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                [
                                                −
                                                1
                                                ,
                                                −
                                                2
                                                ,
                                                
                                                0
                                                ,
                                                
                                                2
                                                ,
                                                
                                                1
                                                ]
                                             
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          [
                                          1
                                          ,
                                          −
                                          2
                                          ,
                                          1
                                          ]
                                          ;
                                          
                                             
                                                F
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             
                                                [
                                                1
                                                ,
                                                −
                                                2
                                                ,
                                                1
                                                ]
                                             
                                             T
                                          
                                          ;
                                          
                                             
                                                F
                                             
                                             
                                                3
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          [
                                          1
                                          ,
                                          
                                          0
                                          ,
                                          
                                          −
                                          2
                                          ,
                                          
                                          0
                                          ,
                                          
                                          1
                                          ]
                                          ;
                                          
                                             
                                                F
                                             
                                             
                                                4
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             
                                                [
                                                1
                                                ,
                                                
                                                0
                                                ,
                                                
                                                −
                                                2
                                                ,
                                                
                                                0
                                                ,
                                                
                                                1
                                                ]
                                             
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 F
                              
                              
                                 i
                              
                              
                                 1
                              
                           
                           and
                           
                           
                              
                                 F
                              
                              
                                 i
                              
                              
                                 2
                              
                           
                         (i=1 to 4) are the first- and second-order derivative filters, respectively. For each image in the upsampled image set {
                           
                              
                                 Y
                              
                              
                                 j
                              
                              
                                 U
                              
                           
                        }, applying these eight filters we obtain eight different filtered images {
                           
                              
                                 F
                              
                              
                                 i
                              
                              
                                 r
                              
                           
                           
                              
                                 Y
                              
                              
                                 j
                              
                              
                                 U
                              
                           
                        , r=1,2 and i=1 to 4}.

Following the preprocessing steps described hereinbefore, for each updated HR training image 
                           
                              
                                 Z
                              
                              
                                 j
                              
                              
                                 U
                              
                           
                        , we now have eight different filtered LR images {
                           
                              
                                 F
                              
                              
                                 i
                              
                              
                                 r
                              
                           
                           
                              
                                 Y
                              
                              
                                 j
                              
                              
                                 U
                              
                           
                        }. The procedure for constructing dictionaries 
                           
                              
                                 Ψ
                              
                              
                                 h
                              
                           
                         and 
                           
                              
                                 Ψ
                              
                              
                                 l
                              
                           
                         are thus summarized as follows:
                           
                              1.
                              At each location d of the updated HR training image 
                                    
                                       
                                          Z
                                       
                                       
                                          j
                                       
                                       
                                          U
                                       
                                    
                                 , extract a patch 
                                    
                                       
                                          p
                                       
                                       
                                          Z
                                       
                                       
                                          d
                                       
                                    
                                  of size m×m.

Extract the corresponding LR patches of the same size from the eight filtered images {
                                    
                                       
                                          F
                                       
                                       
                                          i
                                       
                                       
                                          r
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          j
                                       
                                       
                                          U
                                       
                                    
                                 , r=1,2 and i=1 to 4} at the same location. Then concatenate all the eight LR patches to form a single vector 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                Y
                                             
                                             
                                                d
                                             
                                          
                                       
                                       
                                          ¯
                                       
                                    
                                  of length 8m2.

Construct the HR dictionary 
                                    
                                       
                                          Ψ
                                       
                                       
                                          h
                                       
                                    
                                  and a temporary LR dictionary 
                                    
                                       
                                          Ψ
                                       
                                       
                                          l
                                       
                                       
                                          ⁎
                                       
                                    
                                  by gathering all patches {
                                    
                                       
                                          p
                                       
                                       
                                          Z
                                       
                                       
                                          d
                                       
                                    
                                 
                                 } and {
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                Y
                                             
                                             
                                                d
                                             
                                          
                                       
                                       
                                          ¯
                                       
                                    
                                 }, respectively.

Apply Principal Component Analysis (PCA) to 
                                    
                                       
                                          Ψ
                                       
                                       
                                          l
                                       
                                       
                                          ⁎
                                       
                                    
                                 , build the corresponding orthogonal transformation matrix Q by collecting the eigenvectors of the covariance matrix that represents at least 90% of the original variance.

Construct the LR dictionary 
                                    
                                       
                                          Ψ
                                       
                                       
                                          l
                                       
                                    
                                  via Q
                                 
                                    
                                       
                                          Ψ
                                       
                                       
                                          l
                                       
                                       
                                          ⁎
                                       
                                    
                                 .

The reason why we use 
                           
                              
                                 Ψ
                              
                              
                                 l
                              
                           
                         instead of 
                           
                              
                                 Ψ
                              
                              
                                 l
                              
                              
                                 ⁎
                              
                           
                         as the final LR dictionary is the redundancy of multi-scale first- and second-order derivative analysis, since eight different filters are applied to the same image, resulting in complementary but redundant information.

Since LR dictionary 
                           
                              
                                 Ψ
                              
                              
                                 l
                              
                           
                         is not constructed in the original LR image space, thus the original fidelity constraint 
                           
                              
                                 ‖
                                 
                                    y
                                    −
                                    
                                       
                                          Ψ
                                       
                                       
                                          l
                                       
                                    
                                    α
                                 
                                 ‖
                              
                              
                                 2
                              
                              
                                 2
                              
                           
                         in the image space must be replaced by a corresponding constraint in the feature space, which does not demand exact equality between the LR patch y and its estimation 
                           
                              
                                 Ψ
                              
                              
                                 l
                              
                           
                           α
                        . On the other hand, because no continuity conditions are imposed along the boundaries between patches, the reconstructed HR image 
                           
                              Z
                              ∧
                           
                         should thus be further refined to satisfy the SR model (1). To this end, we simply project 
                           
                              Z
                              ∧
                           
                         onto the solution space (i.e., 
                           Y
                           
                           =
                           
                           W
                           Z
                        
                        [15,21]), computing
                           
                              (25)
                              
                                 
                                    
                                       Z
                                    
                                    ⁎
                                 
                                 =
                                 
                                    
                                       arg
                                       
                                       min
                                    
                                    Z
                                 
                                 
                                    {
                                    
                                       
                                          
                                             ‖
                                             
                                                Y
                                                −
                                                W
                                                Z
                                             
                                             ‖
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       ξ
                                       |
                                       |
                                       Z
                                       −
                                       
                                          Z
                                          ^
                                       
                                       
                                          
                                             |
                                             |
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                    
                                    }
                                 
                              
                           
                        where 
                           ξ
                         is a controlling parameter. Instead of using standard gradient descent method to solve (25), we can iteratively calculate the difference 
                           Y
                           −
                           W
                           Z
                        , convolve it with a back-projection kernel, then warp back into the HR image space to update the estimated HR image. This process can be written as [15,21,48,49]
                        
                           
                              (26)
                              
                                 
                                    
                                       Z
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       Z
                                    
                                    t
                                 
                                 +
                                 (
                                 
                                    
                                       U
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 Y
                                 −
                                 W
                                 
                                    
                                       Z
                                    
                                    t
                                 
                                 )
                                 )
                                 ⁎
                                 g
                              
                           
                        where 
                           
                              
                                 Z
                              
                              t
                           
                         is the estimate of the HR image after the tth iteration, 
                           
                              
                                 U
                              
                              
                                 q
                              
                           
                         the bicubic interpolator with a magnification factor of q, g is the back-projection filter and ⁎ is the convolution operator. This updating process is iteratively repeated until the difference between two consecutive images is less than a given threshold.

With dictionaries 
                           
                              
                                 Ψ
                              
                              
                                 h
                              
                           
                         and 
                           
                              
                                 Ψ
                              
                              
                                 l
                              
                           
                        , to reconstruct a HR image Z from a given LR image Y, our proposed SR image reconstruction algorithm (as depicted in 
                        Fig. 5) is outlined in Algorithm 2.
                           Algorithm 2
                           
                              
                                 
                                    1)
                                    Upsample the LR image Y using 
                                          
                                             
                                                Y
                                             
                                             U
                                          
                                          =
                                          
                                             
                                                U
                                             
                                             
                                                q
                                             
                                          
                                          Y
                                       
                                    

Perform multi-scale first- and second-order derivative analysis (i.e., apply the eight 1-D filters defined in (24) to Y
                                       
                                          U
                                        to get eight different filtered images {
                                          
                                             
                                                F
                                             
                                             
                                                i
                                             
                                             
                                                r
                                             
                                          
                                          
                                             
                                                Y
                                             
                                             U
                                          
                                       , r=1,2 and i=1 to 4})

Divide Y
                                       
                                          U
                                        into a grid of nonoverlapping patches with size of m×m. For each patch y in the image Y
                                       
                                          U
                                       , do
                                          
                                             •
                                             Concatenate the patches of the eight filtered images {
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   
                                                      
                                                         Y
                                                      
                                                      U
                                                   
                                                } that correspond to the same location of y to form a patch vector 
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               Y
                                                            
                                                            
                                                               d
                                                            
                                                         
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             

Reduce the dimensionality of 
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               Y
                                                            
                                                            
                                                               d
                                                            
                                                         
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                 via 
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         Y
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   =
                                                   Q
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               Y
                                                            
                                                            
                                                               d
                                                            
                                                         
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             

Substitute 
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         Y
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                 for y in (18) and solve the optimization problem defined in (19)
                                             

Generate the HR patch z via 
                                                   z
                                                   =
                                                   
                                                      
                                                         Ψ
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   
                                                      α
                                                      ^
                                                   
                                                
                                             

Insert patch z into the corresponding location of the HR image 
                                                   
                                                      Z
                                                      ∧
                                                   
                                                
                                             

Update 
                                          
                                             Z
                                             ^
                                          
                                        using 
                                          
                                             Z
                                             ^
                                          
                                          =
                                          
                                             Z
                                             ^
                                          
                                          +
                                          
                                             
                                                Y
                                             
                                             U
                                          
                                       
                                    

Use Algorithm 1 to update 
                                          
                                             Z
                                             ^
                                          
                                       
                                    

Use (26), find the image Z
                                       ⁎, which is the closest image to 
                                          
                                             Z
                                             ^
                                          
                                        that satisfies the global reconstruction constraint (25)
                                    

Output Z
                                       ⁎ as the final result of SR image reconstruction

@&#EXPERIMENTAL RESULTS@&#

To examine more comprehensively the proposed approach, we test two versions of the proposed method: one using sparse representation prior and nonlocal similarity (denoted by SRNL, step 5 is thus excluded from Algorithm 2); the other one using sparse representation prior, nonlocal similarity and sparse derivative prior (denoted by SRNINL). To examine the effect of sparse representation prior and nonlocal similarity separately, we test the sparse representation prior based method proposed by Rueda et al. [21] (denoted by SRA) and nonlocal similarity based upsampling [12] (denoted by NLUP). 
                        Table 1 clearly shows the relation among these four methods. On the other hand, two state-of-the-art methods, adaptive sparse domain selection and adaptive regularization (denoted by ASAR) [16], sparse regression and natural image prior (denoted by SRNI) [36], are also tested. Moreover, for a clear comparison among the above mentioned six methods, we also provide the results yielded by two baseline techniques, i.e., bicubic interpolation (denoted by SBI) and TV prior [23] (denoted by TV).

Since SRA and NLUP are originally designed for 3D MR image reconstruction, here we implement a 2D version of SRA and simply draw out 2D slices from the 3D HR volume reconstructed by NLUP for comparison. On the other hand, considering that the original NLUP includes an additional image denoising step using MNLM3D [34] while the other tested approaches do not, to do a fair comparison, we exclude denoising operation from NLUP in all our experiments.

@&#IMPLEMENTATION DETAILS@&#

For dictionary construction, each HR training image is first blurred with a Gaussian kernel of size 3×3 and standard deviation 1, then down-sampled by a factor of 2 to produce the corresponding LR image. Finally, the LR image is magnified by a factor of 2 via bicubic interpolation to produce the upsampled LR image.

For the proposed algorithm, the observed LR image Y is also upsampled using bicubic interpolation with a magnification factor of 2. In our experiments, the magnification factor is also set to 2, with a patch size of 3×3 in LR image and 6×6 in HR image. Accordingly, the image patch size m at step 3 of Algorithm 2 is also set to 6. To search for nonlocal similar patches, the searching radius is set to 7 which represents a 15×15 searching window and the first 15 (i.e., L=15) closest patches are chosen to calculate the nonlocal similarity regularization term.

To evaluate the performance of SR algorithms we use four different MR data sets: one dictionary dataset and three evaluation datasets. Dictionary dataset contains twenty T1-weighted brain MR images of normal person or patients suffering from mild cognitive impairment (MCI) and Alzheimer’s disease, all downloaded from Internet. For each image in the dictionary dataset, the slice thickness is 1.0mm, slice dimension is 512×512 and the pixel size is 0.469mm×0.469mm. The number of slices per volume varies between 144 and 168. Three evaluation datasets are Brainweb [33] dataset, ADNI dataset [45] and Cardiac MRI dataset [46].

To build the dictionaries, four slices per volume in the dictionary dataset are selected as the original training HR images. In order to improve the representative ability of dictionaries, we preprocess these images by cropping out the texture and edge regions and discarding the smooth parts. Dictionaries 
                           
                              
                                 Ψ
                              
                              
                                 h
                              
                           
                         and 
                           
                              
                                 Ψ
                              
                              
                                 l
                              
                           
                         are then constructed from the preprocessed HR and LR images, respectively. For all the tested sparse representation based methods (i.e., SRNL, SRNINL, SRA and ASAR), the size of final dictionaries is reduced to 1024 atoms.

In this paper, two quantitative measures are used to perform comparison between the reconstructed image A and the original image B:
                           
                              •
                              Peak signal-to-noise ratio (PSNR):
                                    
                                       (27)
                                       
                                          PSNR
                                          (
                                          A
                                          ,
                                          B
                                          )
                                          =
                                          10
                                          ×
                                          
                                             
                                                log
                                             
                                             
                                                10
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         
                                                            255
                                                         
                                                         2
                                                      
                                                   
                                                   
                                                      |
                                                      |
                                                      A
                                                      −
                                                      B
                                                      |
                                                      
                                                         
                                                            |
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      /
                                                      C
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 where C is the dimension of A or B.

Structural Similarity Index (SSIM) [32]:
                                    
                                       (28)
                                       
                                          SSIM
                                          (
                                          A
                                          ,
                                          B
                                          )
                                          =
                                          
                                             
                                                (
                                                2
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      A
                                                   
                                                
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      B
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                (
                                                2
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      A
                                                      B
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      A
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      B
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                (
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      A
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      B
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              

For the proposed SRNINL algorithm, there are total six parameters, i.e., the parameters 
                           
                              
                                 σ
                              
                              
                                 N
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 R
                              
                           
                           ,
                           
                           α
                           ,
                         
                        X in Algorithm 1 and 
                           λ
                           ,
                           η
                         in Algorithm 2. Since it is very difficult to determine these parameters at the same time, a stepwise selection strategy is more feasible and thus is adopted here [47]. Specifically, we fix the parameters 
                           
                              
                                 σ
                              
                              
                                 N
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 R
                              
                           
                           ,
                           
                           α
                           ,
                        
                        X in Algorithm 1 in advance and try to find the optimal values for 
                           λ
                         and 
                           η
                        . To this end, we choose the Basis Pursuit Solver provided in SparseLab library [31] to solve the L1-norm optimization problem defined in (19). We fix the first parameter 
                           λ
                         in advance and try to find the optimal 
                           η
                        , then the optimal 
                           λ
                         is determined based on the chosen 
                           η
                        . Finally, based on the chosen 
                           λ
                         and 
                           η
                        , the four parameters 
                           
                              
                                 σ
                              
                              
                                 N
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 R
                              
                           
                           ,
                           
                           α
                           ,
                         
                        X in Algorithm 1 are determined using the same strategy. 
                        Fig. 6 shows the performance of SRNINL (in PSNR) over the variation of one parameter with other parameters fixed. From Fig. 6, we empirically set 
                           λ
                        =0.01, 
                           η
                        =0.18, 
                           α
                           =
                           0.8
                        , 
                           
                              
                                 σ
                              
                              
                                 R
                              
                           
                           =
                           1
                        ,
                           
                              
                                 σ
                              
                              
                                 N
                              
                           
                           =
                           100
                        , and X=8.

All the experiments are implemented in MATLAB R2010b, running on a personal computer with Intel(R) Core(TM)2 Duo CPU P8700 @ 2.53GHz, 4GB memory.

In this section, we use T1-weighted normal brain MR images with a slice dimension of 181×217 (pixel size is 1mm×1mm) and an interslice distance of 1mm, generated by Brainweb [33] digital brain phantom.

We test the clean (here clean means with 0% intensity non-uniformity and 0% noise) data first. We randomly pick out 10 slices, downsample them by a factor of two to generate the corresponding LR images, and then perform SR image reconstruction using SRNL, SRNINL, SBI, TV, SRA, ASAR, and SRNI. For NLUP, we downsample the original volume data by a factor of two to get the LR volume data and pick out the corresponding reconstructed 2D HR slices for comparison. 
                           Fig. 7 presents one of the reconstructed slices by all the methods. From Fig. 7, we can see that comparing with the result got by SRNL, TV and SRA produce jaggy artifacts and NLUP produces more blurry edges in the center (marked by the red box). TV and SRA also blur the details on the bottom left (marked by the white box). The results got by SRNI and ASAR are as better as SRNL. Nevertheless, by jointly using sparse representation prior, nonlocal similarity and sparse derivative prior, the proposed SRNINL algorithm produces the best result among all the tested methods. The averages of two quantitative measures across 10 slices are reported in 
                           Table 2. Note that the two quantitative measures show good consistence with the visual results in Fig. 7. To compare the computational complexity, 
                           Table 3 lists the corresponding CPU time. Except SBI, the fastest algorithm is NLUP. This is mainly because NLUP is an iterative filtering process that converges very fast. Its main drawback is that it must reconstruct the whole 3D image completely. The actual running time of NLUP in this case is 1.106s×180 slices=199.08s. Since the basic principle of SRA and SRNL is the same, the computational complexity of SRA is comparable with that of SRNL. By adding a filtering operation to SRNL, the resulted SRNINL is a little bit slower than SRNL, but still faster than ASAR.

In the second test, we test the algorithms’ robustness to noise. We download the noisy data (noise: 9%, intensity non-uniformity: 0%) and repeat the same procedure as we did in the first experiment. 
                           Fig. 8 presents one of the reconstructed slices by all the methods. From Fig. 8, we see that unlike methods using either local smooth assumption (e.g., TV) or nonlocal similarity (e.g., NLUP, SRNL, ASAR, SRNINL) to suppress noise, SRA and SRNI are more sensitive to noise and there are many obvious noise-caused artifacts in the center. On the other hand, NLUP, ASAR, and SRNL produce blurry details in the center (marked by the red box), and the structures on the bottom left (marked by the white box) produced by NLUP and ASAR is over-smoothed. In contrast, the proposed SRNINL shows good robustness to noise: not only the noise is effectively suppressed, but also the weak edges are well reconstructed. This is mainly because the noise can be more effectively removed and the edges can be better preserved via jointly using sparse representation prior, nonlocal similarity and sparse derivative prior. 
                           Table 4 lists the corresponding average quantitative measures. An interesting observation is that, although SRNINL generates visually more appealing image than NLUP and ASAR do, its quantitative measure SSIM is actually lower than that of NLUP and ASAR. Since intensive noise is included in this experiment and the PSNR of SRNINL is much higher than that of other methods, we believe that SSIM may not be a good measure under noisy cases (as we will demonstrate later in other experiments that the SSIM of SRNINL on other noiseless data is the best among all the test methods).

To study the effect of intensity non-uniformity, we download the data with 40% intensity non-uniformity (0% noise) and repeat the same procedure as we did in the previous two experiments. 
                           Fig. 9 presents the reconstructed results of the same slice in Fig. 7 by all the tested methods and 
                           Table 5 lists the corresponding quantitative measures. By comparing Fig. 9 with Fig. 7, as well as Table 5 with Table 2, we can easily see that
                              
                                 1)
                                 Intensity non-uniformity makes almost invisible structure changes to the original clean slice.

The performance of SBI, TV, SRA, SRNL, ASAR, SRNI and SRNINL are almost the same as they are in Section 6.3.1, since they all build a 2D HR image from the given 2D LR image. Moreover, SRNINL still produces the best result among all the tested methods.

The performance of NLUP degrades dramatically in Fig. 9 and Table 5. This is mainly because that though intensity non-uniformity does not make great visible structure changes inside slice plane, it causes interslice structure changes, which will hamper NLUP to extract useful sub-pixel information via interslice correspondence.

In the previous experiments, the scaling factor is fixed to 2. However, it could be interesting to test the algorithms’ performance under a larger magnification factor, since more HR patch patterns are associated to a single LR patch. To this end, we set the scaling factor to 4, with a patch size of 3×3 in LR image and 12×12 in HR image. For SRNL, SRNINL, and SRA, we do not use the LR images downsampled by a factor of 4 to construct a new dictionary 
                              
                                 
                                    Ψ
                                 
                                 
                                    l
                                 
                              
                            as Rueda et al. did in [21], we instead adopt the same dictionaries used in the previous experiments and magnify a LR image by two consecutive steps with a magnification of 2 for each step. For TV, NLUP, ASAR, and SRNI, we simply magnify the LR image by a factor of 4 since the codes provided by the authors are capable of executing a magnification of 4 directly. 
                           Fig. 10 presents one of the reconstructed slices by all the methods and the corresponding numeric results are reported in 
                           Table 6. From Fig. 10, we can still see that the proposed SRNINL algorithm produces the best result among all the tested algorithms. However, Table 6 shows that the PSNR of SRNINL is lower than that of SRNL, though it generates visually more appealing image than SRNL does. This is because for the proposed SRNINL algorithm, an extra post-filtering operation (if we add Algorithm 1, the sparse derivative prior based post-filtering operation into SRNL, it turns out to be SRNINL) may degrade pixel-by-pixel based quantitative measures (e.g., PSNR) under large magnification factors. However, the results in this paper demonstrate that pixel-by-pixel based quantitative measures (e.g., PSNR) may work well in noisy cases, SSIM produces more reliable statistics for noiseless images. The corresponding CPU time of each method is also listed in Table 3 for comparison. Except NLUP, all the other methods need more time to reconstruct the final HR image since more unknown pixels are needed to be calculated when magnification factor increases from two to four. The reason why NLUP spends less time for large magnification factors is that it reaches convergence very quickly when there is no sufficient information among neighboring pixels (the larger magnification factor, the less corelation among neighboring pixels). On the other hand, the proposed SRNINL is still faster than ASAR.

The data used in this section were obtained from the Alzheimer’s Disease Neuroimaging Initiative (ADNI) database [45]. The Principal Investigator of ADNI is Michael W. Weiner, MD, VA Medical Center and University of California. ADNI is the result of efforts of many coinvestigators from a broad range of academic institutions and private corporations. The primary goal of ADNI has been to test whether serial MR imaging, positron emission tomography (PET), other biological markers, and clinical and neuropsychological assessment can be combined to measure the progression of mild cognitive impairment (MCI) and early Alzheimer’s disease (AD).

We download the data and repeat the same procedure as we did in the previous experiments. 
                        Fig. 11 presents one of the reconstructed slices by all the methods and the corresponding numeric results are reported in 
                        Table 7. From Fig. 11, we can see that for the down-right area (marked by the red box), SRA and ASAR produce the most blurry results. By incorporating the nonlocal similarity information properly, SRNL and NLUP produce more clear tissue structures. Though SRNI produces better result than SRNL does, by jointly using sparse representation prior, nonlocal similarity and sparse derivative prior, the proposed SRNINL recovers more fine details. Note that in Table 7 the quantitative measures of NLUP are higher than that of SRNI, which is in contradiction with the visual perception shown in Fig. 11.

The Cardiac MRI dataset [46] contains 4D MR images acquired from 33 subjects. Each subject’s sequence consists of 20 frames and 8–15 slices along the long axis, for a total of 7980 images. Since the original data contains time axis, we simply choose the volume data by setting t to zero and repeat the same procedure as we did in the previous experiments. 
                        Fig. 12 presents one of the reconstructed slices by all the methods and the corresponding numeric results are reported in 
                        Table 8. From Fig. 12, we can see that for the tissues marked by the small white and red boxes, SRA and ASAR still produce the most blurry results. On the other hand, SRNL and NLUP produce more clear tissue structures since nonlocal similarity information is properly incorporated into the reconstruction process. The result yielded by SRNI is slightly better than that of SRNL. Nevertheless, our proposed SRNINL still produces the best tissue structures among all the tested methods. Again, as we found in Table 7, though SRNI generates visually more appealing image than NLUP does, in Table 8, the quantitative measures of NLUP are higher than that of SRNI.

@&#DISCUSSION@&#

In this paper, we propose a new algorithm for reconstructing a HR image from a single LR MR image by jointly using sparse representation prior, nonlocal similarity, and sparse derivative prior. The proposed method has been demonstrated to achieve much better results than many state-of-the-art algorithms in terms of both quantitative measures and visual perception. Our main contribution is threefold: (1) the use of multi-scale first- and second-order derivative analysis to estimate the missing high-frequency information, (2) the joint use of sparse representation and nonlocal similarity under a unified L1-norm minimization framework, and (3) the use of sparse derivative prior based post-processing in MR image SR reconstruction.

The use of multi-scale edge analysis to estimate high-frequency information was first proposed by Rueda et al. [21] based on two considerations: (1) compared with low-frequency information, high-frequency information has more influence on the reconstruction of sharp edges, and (2) image coherence and regularity are also preserved via multi-scale analysis to some extent, which makes patch overlapping unnecessary. However, only multi-scale first-order derivative analysis was applied in [21]. Since most edges in images are often gradual transitions from one intensity to another, using first-order derivative one would usually get a curve with rising gradient magnitude, and then a falling gradient magnitude. Extracting the ideal edge is thus a matter of finding this curve with optimal gradient. For patch-based SR image reconstruction, however, such curve may pass through many neighboring patches, the exact location of the edges would probably be lost for these neighboring patches are separately reconstructed. Second-order derivate, on the other hand, could be used to extract optimal edge location by finding where it is zero. We must point out that though only the simplest second-order derivative analysis is used in this paper, using other more reliable ones, e.g., Laplacian operator, Marr–Hildreth operator, is also possible.

Nonlocal similarity refers to the fact that the patches with similar patterns can be spatially far from each other, we can collect them in the whole image and process them simultaneously for various purposes, e.g., image denoising [29,35], deblurring [16,34], and SR [12,30]. In this paper, by incorporating the nonlocal similarity regularization into the process of MR image SR reconstruction, we got better results than only using either nonlocal similarity or sparse representation prior. Moreover, thanks for the averaging operation of similar patches across the image, the proposed method is more robust to noise than TV, SRA and SRNI. Finally, the proposed SRNINL algorithm handles nonlocal similarity information in pixel domain, how about coding nonlocal similarity via sparse representation and including it in the same unified SR image reconstruction framework, this is one of our future research directions.

Though natural image prior has been proven to be effective in various natural image processing tasks, in this paper, we validate that it is also applicable to MR image processing. In fact, we can see that a MR image consists mainly of zero gradient regions interspersed with occasional strong gradient transitions. By comparing the results yielded by SRNL and SRNINL, it is easy to find that a sharp edge is preferred over a blurry one in the final output when applying the natural image prior based post-processing operation. However, a more direct and elegant approach for jointly using sparse representation prior, nonlocal similarity, and sparse derivative prior is to incorporate a sparse derivative prior based regularization term into (19) as follows
                        
                           (29)
                           
                              
                                 α
                                 ^
                              
                              =
                              
                                 
                                    arg
                                    
                                    min
                                 
                                 α
                              
                              
                                 {
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   y
                                                
                                                ⁎
                                             
                                             −
                                             Γ
                                             
                                                
                                                   Ψ
                                                
                                                
                                                   l
                                                
                                             
                                             α
                                          
                                          ‖
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    λ
                                    
                                       
                                          ‖
                                          
                                             α
                                          
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    ζ
                                    
                                       
                                          (
                                          
                                             
                                                |
                                                
                                                   D
                                                   ⁎
                                                   
                                                      
                                                         Ψ
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   α
                                                
                                                |
                                             
                                             /
                                             σ
                                          
                                          )
                                       
                                       α
                                    
                                 
                                 }
                              
                           
                        
                     where D is the desired localized, oriented, and bandpass filter, and 
                        ζ
                      is a parameter controlling the contribution of sparse derivative prior. Unfortunately, for sparse derivative prior, the exponent parameter 
                        α
                      must satisfy 
                        0
                        <
                        α
                        <
                        1
                     , which makes solving (29) via directly applying standard L1-norm optimization techniques impossible. One of our future research directions will focus on finding an efficient algorithm to solve (29).

None declared.

@&#ACKNOWLEDGEMENT@&#

This work was supported by the China Postdoctoral Science Foundation (Grant no. 2012M511804) and the Natural Science Foundation of Guangdong Medical College (Grant no. XB1349).The authors would also like to thank all of the anonymous reviewers for their valuable comments and constructive suggestions that have significantly improved the presentation of this paper.

@&#REFERENCES@&#

