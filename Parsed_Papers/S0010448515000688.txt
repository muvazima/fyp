@&#MAIN-TITLE@&#h-graphs: A new representation for tree decompositions of graphs

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           h-graphs, a new representation for tree decompositions of constraints graph is presented.


                        
                        
                           
                           h-graphs explicitly capture construction steps dependencies in a tree decomposition.


                        
                        
                           
                           An application to speed up computing feasibility ranges for constraint parameters is described.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Parametric solid modeling

Geometric constraint solving

Constraint graphs

Tree-decompositions

Construction steps dependencies

Parameter ranges

@&#ABSTRACT@&#


               
               
                  In geometric constraint solving, 2D well constrained geometric problems can be abstracted as Laman graphs. If the graph is tree decomposable, the constraint-based geometric problem can be solved by a Decomposition–Recombination planner based solver. In general decomposition and recombination steps can be completed only when steps on which they are dependent have already been completed. This fact naturally defines a hierarchy in the decomposition–recombination steps that traditional tree decomposition representations do not capture explicitly.
                  In this work we introduce h-graphs, a new representation for decompositions of tree decomposable Laman graphs, which captures dependence relations between different tree decomposition steps. We show how h-graphs help in efficiently computing parameter ranges for which solution instances to well constrained, tree decomposable geometric constraint problems with one degree of freedom can actually be constructed.
               
            

@&#INTRODUCTION@&#

Many applications in computer-aided design, computer-aided manufacturing, kinematics, robotics or dynamic geometry are conveniently modeled by geometric problems defined by geometric constraints with parameters, some of them representing dimensions. These generic models allow the user to easily generate specific instances for various parameter and constraint values.

When parametric models are used in real applications, it is often found that instantiation may fail for some parameter values. Assuming that failures are not due to bugs in the system, they should be attributed to a more basic problem, that is, a certain combination of constraints in the model and values of parameters do not define a valid shape.

The failure to instantiate the model poses naturally the question of how to compute ranges for parameters such that model instantiation is feasible. This problem or restricted versions of it have been addressed in the literature. Shapiro and Vossler,  [1], and Raghothama and Shapiro,  [2–4], developed a theory on validity of parametric family of solids by investigating the relationship between Brep and CSG schemas in systems with dual representations for solid modeling. The formulation is built on formalisms of algebraic topology. Unfortunately, it seems a rather difficult problem transforming these formalisms into effective algorithms.

Joan-Arinyo and Mata  [5] reported a method to compute feasible ranges for parameters in geometric constraint solving under the assumption that values assigned to parameters are non-trivial-width intervals. The method applies to complex systems of geometric constraints in both 2D and 3D and has been successfully applied in the dynamic geometry field,  [6]. It is a general method, the main drawback, however, is that it is based on numerical sampling.

Hoffmann and Kim  [7] developed a constructive approach to calculate parameter ranges for systems of geometric constraints that include sets of isothetic line segments and distance constraints between them. Model instantiation for distance parameters within the ranges output by the method preserve the topology of the set of isothetic lines.

Sitharam et al. in  [8,9] reported recent theoretical results concerning the computation of intervals of realizable solutions to linkages, that is, 2D geometric constraint problems with one degree of freedom where the parameter is a distance value.

For the first time, van Der Meiden and Bronsvoort  [10] described a method to directly figure out the allowable range for a single parameter in the problem, called variant parameter, such that an actual solution exists for any value in the range. The method was formalized by Hidalgo and Joan-Arinyo in  [11,12] where a correctness proof along with specific implementation details were given. This approach heavily relies on identifying the set of construction steps in the solution to the constraint problem the actual execution of which depends on the current value assigned to the variant parameter. So far identifying the dependencies concerning the construction step under consideration required a specific computation,  [10]. Hence devising a method able to efficiently identify beforehand the whole set of dependencies existing between the construction steps of a constraint problem would be a valuable accomplishment.

In this work we introduce h-graphs, a new representation for graph based constructive solutions to the geometric constraint problem. The h-graph captures the naturally occurring dependency relationships between construction steps in the solution of a geometric constraint problem. As well, computing parameter ranges where the solution is feasible using h-graphs improves over the method described by Hidalgo and Joan-Arinyo in  [11,12].

In what follows we first give a short intuitive introduction to the geometric constraint solving problem to motivate the need for computing parameter ranges. Then we recall the graph tree decomposition, we give technical definitions related to dependence, define h-graphs, show some properties of h-graphs and, we describe an algorithm to compute h-graphs from a tree decomposition which is a solution to a geometric constraint problem. Finally we illustrate how actual dependencies are computed applying the h-graph to a geometric constraint problem with one degree of freedom.

Assume that we want to build a triangle the vertices of which are the points 
                        a
                        ,
                        b
                        ,
                        c
                      like those shown in Fig. 1
                     (a). We want point 
                        a
                      to be placed at a distance 
                        
                           
                              d
                           
                           
                              1
                           
                        
                      from point 
                        b
                      and point 
                        c
                      to be placed at a distance 
                        
                           
                              d
                           
                           
                              2
                           
                        
                      from point 
                        b
                     . Moreover we want that the edge bounded by points 
                        a
                        ,
                        b
                      makes an angle 
                        λ
                      with respect to the edge bounded by points 
                        a
                        ,
                        c
                     . It is well known that this description properly defines a triangle in the Euclidean space. A ruler-and-compass procedure to build the triangle is illustrated in Fig. 1(b) and can be described as follows, 
                        
                           1.
                           Draw an arbitrary straight line, say 
                                 X
                              .

On line 
                                 X
                               mark an arbitrary point 
                                 a
                              .

On line 
                                 X
                               mark a point 
                                 b
                               at a distance 
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                               from 
                                 a
                              .

Draw a line 
                                 L
                               through point 
                                 a
                               and at an angle 
                                 λ
                               with line 
                                 X
                              .

Draw a circle 
                                 C
                               with center 
                                 b
                               and radius 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                              .

Intersections of circle 
                                 C
                               and line 
                                 L
                               yield points 
                                 c
                               and 
                                 
                                    
                                       c
                                    
                                    
                                       ′
                                    
                                 
                               that along with points 
                                 a
                               and 
                                 b
                               define triangles which fulfill the requirements described.

If the procedure is applied after assigning specific values to 
                        
                           
                              d
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              d
                           
                           
                              2
                           
                        
                      and 
                        λ
                     , the geometric construction can be carried out depending on the specific assignment of values.

Many techniques have been reported in the literature that provide powerful and efficient methods for solving geometric problems defined by constraints. For a review, see Hoffmann et al.  [13]. Computer programs that solve geometric problems defined by constraints are called solvers. Among all the geometric constraint solving techniques, our interest here focuses on the one known as constructive. See  [14–18] and the references there in for an in depth discussion on this topic.

Constructive solvers belong to the Decomposition–Recombination solvers, in short DR-solvers, class  [15] and have two main components: the analyzer and the constructor. Given the geometric elements and the constraints defined on them, the analyzer figures out a description of how geometric elements are placed with respect to each other in such a way that the constraints are fulfilled. This description is called construction plan.

If the analyzer succeeds, actual values are assigned to the parameters and the constructor builds an instance of a placement for the geometric objects, provided that no numerical incompatibility arises due to geometric degeneracy.

In the example described above and illustrated in Fig. 1, the set of geometric elements includes the points 
                        
                           {
                           a
                           ,
                           b
                           ,
                           c
                           }
                        
                      while the constraints are the distances 
                        
                           
                              d
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              d
                           
                           
                              2
                           
                        
                      and the angle 
                        λ
                     .

In this scenario asking for the set of values of 
                        λ
                      for which the construction is actually feasible seems natural. To answer this question, efficiently computing dependencies between construction steps in the construction plan plays a central role.

In this work we capture a 2D geometric constraint problem as a graph 
                        G
                        =
                        
                           (
                           V
                           ,
                           E
                           )
                        
                      where 
                        V
                      is a finite set of nodes or vertices which stand for the geometric elements in the problem and 
                        E
                      is a collection of edges. An edge is an unordered pair 
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      of distinct vertices 
                        u
                        ,
                        v
                        ∈
                        V
                        
                           (
                           G
                           )
                        
                     . In general 
                        V
                        
                           (
                           G
                           )
                        
                      and 
                        E
                        
                           (
                           G
                           )
                        
                      will denote respectively the set of vertices and edges of the graph 
                        G
                     .

In what follows we only consider 2D well constrained geometric constraint problems, that is, problems with a finite number of solution instances. In this work, these problems are abstracted as Laman graphs,  [19], 
                        G
                        =
                        
                           (
                           V
                           ,
                           E
                           )
                        
                      with 
                        
                           |
                           V
                           |
                        
                        ≥
                        3
                      and such that 
                        
                           1.
                           
                              
                                 
                                    |
                                    E
                                    |
                                 
                                 =
                                 2
                                 
                                    |
                                    V
                                    |
                                 
                                 −
                                 3
                              .

For every subgraph 
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          E
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               with 
                                 
                                    
                                       V
                                    
                                    
                                       ′
                                    
                                 
                                 ⊂
                                 V
                               and 
                                 
                                    
                                       E
                                    
                                    
                                       ′
                                    
                                 
                                 ⊂
                                 E
                              , 
                                 
                                    |
                                    
                                       
                                          E
                                       
                                       
                                          ′
                                       
                                    
                                    |
                                 
                                 ≤
                                 2
                                 
                                    |
                                    
                                       
                                          V
                                       
                                       
                                          ′
                                       
                                    
                                    |
                                 
                                 −
                                 3
                              .

Tree decompositions, also known as triangular decompositions, are a tool widely used in geometric constraint solving mainly when the underlying solving technique belongs to the DR solvers class. The resulting decomposition describes the solution to the geometric constraint problem by fixing how geometric elements are placed with respect to each other to fulfill the constraints. In this section we recall the concept of tree decomposition of a graph, we formalize the tree decomposition as a rewrite system and show some properties which will be used later on.

We start by introducing the concept of set decomposition illustrated in Fig. 2
                        . Let 
                           S
                         be a set with, at least, three different members, say 
                           a
                           ,
                           b
                           ,
                           c
                        . We say that three subsets of 
                           S
                        , say 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                         ​are a set decomposition of 
                           S
                         if 
                           
                              1.
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                    ∪
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    ∪
                                    
                                       
                                          S
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    S
                                 ,


                                 
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                    ∩
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       {
                                       a
                                       }
                                    
                                 ,


                                 
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    ∩
                                    
                                       
                                          S
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    
                                       {
                                       b
                                       }
                                    
                                  and


                                 
                                    
                                       
                                          S
                                       
                                       
                                          3
                                       
                                    
                                    ∩
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       {
                                       c
                                       }
                                    
                                 .

Next we introduce the concept of tree decomposition step of a graph. See Fig. 3
                        . Let 
                           G
                           =
                           
                              (
                              V
                              ,
                              E
                              )
                           
                         be a graph, the subsets 
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                           
                              (
                              G
                              )
                           
                           ,
                           
                              
                                 V
                              
                              
                                 2
                              
                           
                           
                              (
                              G
                              )
                           
                         and 
                           
                              
                                 V
                              
                              
                                 3
                              
                           
                           
                              (
                              G
                              )
                           
                         define a tree decomposition step of 
                           G
                         if they are a set decomposition of 
                           V
                           
                              (
                              G
                              )
                           
                         and for every edge 
                           e
                           =
                           
                              (
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         with 
                           e
                           ∈
                           E
                           
                              (
                              G
                              )
                           
                        , 
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           ∈
                           V
                           
                              (
                              
                                 
                                    G
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         for some 
                           i
                        , 
                           1
                           ≤
                           i
                           ≤
                           3
                        . Subgraphs 
                           
                              
                                 G
                              
                              
                                 i
                              
                           
                           =
                           
                              (
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         induced in 
                           G
                         by a tree decomposition step are called clusters.

Roughly speaking, a tree decomposition step of a graph 
                           G
                        , is a graph decomposition induced by a set decomposition of vertices 
                           V
                           
                              (
                              G
                              )
                           
                         such that the two vertices bounding each edge in 
                           E
                           
                              (
                              G
                              )
                           
                         belong to a given cluster.

Finally we define the tree decomposition of a graph. Let 
                           G
                           =
                           
                              (
                              V
                              ,
                              E
                              )
                           
                         be a graph. We say that a ternary tree 
                           T
                         is a tree decomposition of 
                           G
                         if 
                           
                              1.
                              
                                 
                                    G
                                  is the root of 
                                    T
                                 ,

Each node 
                                    
                                       
                                          G
                                       
                                       
                                          ′
                                       
                                    
                                    ⊂
                                    G
                                  of 
                                    T
                                  is the father of exactly three nodes, say 
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                  and 
                                    
                                       
                                          G
                                       
                                       
                                          3
                                       
                                       
                                          ′
                                       
                                    
                                 , which are the clusters output by a tree decomposition step applied to a subgraph of 
                                    G
                                 , and

Each leaf node contains a cluster with exactly two vertices 
                                    a
                                    ,
                                    b
                                  of 
                                    V
                                  such that edge 
                                    
                                       (
                                       a
                                       ,
                                       b
                                       )
                                    
                                  is in 
                                    E
                                    
                                       (
                                       G
                                       )
                                    
                                 .

A graph for which there is a tree decomposition is called tree-decomposable. In general, a tree decomposition of a graph is not unique. Fig. 4
                         shows two different tree decompositions for the graph given in Fig. 3(a). Notice that some decompositions are applied in the tree in Fig. 3(a) in different levels than they applied in the tree in Fig. 3(b). For the sake of clarity, tree decompositions only show the set of vertices included by clusters. Labels on the tree edges will be defined later on.

As shown in  [20,17], the process of actually building a solution to a geometric constraint problem described as a tree decomposition of a graph, that is, the solution constructor, can be abstracted as a rewrite system,  [21], where terms are sets of clusters. Given a graph 
                           G
                           =
                           
                              (
                              V
                              ,
                              E
                              )
                           
                         the starting set of clusters is defined as 
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       G
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       {
                                       u
                                       ,
                                       v
                                       }
                                    
                                    :
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    ∈
                                    E
                                    
                                       (
                                       G
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                         Clusters are rewritten using the tree decomposition step as a reduction rule, which is denoted by an arrow 
                           →
                         and formally defined as follows. 
                           Definition 3.1
                           Let 
                                 
                                    C
                                 
                               be a set of clusters where there are three clusters 
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 1
                                 ≤
                                 i
                                 ≤
                                 3
                               such that pairwise share one vertex 
                                 V
                                 
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 ∩
                                 V
                                 
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    a
                                    }
                                 
                                 ,
                                 V
                                 
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 ∩
                                 V
                                 
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    b
                                    }
                                 
                                 ,
                                 V
                                 
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 ∩
                                 V
                                 
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    c
                                    }
                                 
                               with 
                                 a
                                 ,
                                 b
                               and 
                                 c
                               distinct. Then the rewrite rule 
                                 
                                    C
                                 
                                 →
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       ∗
                                    
                                 
                               is defined as 
                                 
                                    
                                       
                                          
                                             
                                                C
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          (
                                          
                                             C
                                          
                                          −
                                          
                                             {
                                             
                                                
                                                   C
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   C
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   C
                                                
                                                
                                                   3
                                                
                                             
                                             }
                                          
                                          )
                                       
                                       ∪
                                       
                                          {
                                          
                                             
                                                C
                                             
                                             
                                                1
                                             
                                          
                                          ∪
                                          
                                             
                                                C
                                             
                                             
                                                2
                                             
                                          
                                          ∪
                                          
                                             
                                                C
                                             
                                             
                                                3
                                             
                                          
                                          }
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Definition 3.2
                           A derivation is a sequence of applications of the rewriting rule in (
                                 
                                    C
                                 
                                 ,
                                 →
                              ). We will denote a derivation by 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          
                                             →
                                          
                                          
                                             ∗
                                          
                                       
                                       
                                          
                                             
                                                C
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Definition 3.3
                           A term 
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       ∗
                                    
                                 
                               is derived from 
                                 
                                    C
                                 
                               if and only if there is a derivation such that 
                                 
                                    C
                                 
                                 
                                    
                                       →
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       ∗
                                    
                                 
                              . A term 
                                 
                                    C
                                 
                               to which the tree decomposition rule does not apply is called irreducible or normal form.

To us, the most important result in reduction systems is that the reduction system 
                           
                              (
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    G
                                 
                              
                              ,
                              →
                              )
                           
                         has a unique normal form that is obtained after finitely many reductions,  [20,17]. In these conditions, if the geometric constraint problem is well constrained, that is, the problem has a finite number of solution instances, the derivation reduces the initial set 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 G
                              
                           
                         to a single cluster. The sequence of construction steps identified by the derivation places a fixed set of triplets of geometric elements in relative positions such that the constraints hold.

If 
                           
                              {
                              a
                              ,
                              b
                              ,
                              c
                              }
                           
                         are the nodes pairwise shared by clusters 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 C
                              
                              
                                 3
                              
                           
                        , denote by 
                           
                              
                                 →
                              
                              
                                 
                                    {
                                    a
                                    ,
                                    b
                                    ,
                                    c
                                    }
                                 
                              
                           
                         the reduction that merges the clusters. In these conditions, the set 
                           
                              
                                 
                                    
                                       
                                          R
                                       
                                    
                                    
                                       
                                          C
                                       
                                    
                                 
                                 
                                    (
                                    ∗
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       {
                                       a
                                       ,
                                       b
                                       ,
                                       c
                                       }
                                    
                                    :
                                    
                                       
                                          →
                                       
                                       
                                          
                                             {
                                             a
                                             ,
                                             b
                                             ,
                                             c
                                             }
                                          
                                       
                                    
                                    
                                    ∈
                                    
                                    
                                       
                                          →
                                       
                                       
                                          ∗
                                       
                                    
                                    }
                                 
                              
                           
                         is the set of triplets or reductions in the derivation 
                           
                              
                                 →
                              
                              
                                 ∗
                              
                           
                        .

According to  [20,22], each triplet of hinges is used once and only once in a reduction process. This means that given two different reduction sequences over the same starting and ending terms, 
                           
                              C
                           
                           
                              
                                 →
                              
                              
                                 ∗
                              
                           
                           
                              
                                 
                                    C
                                 
                              
                              
                                 ∗
                              
                           
                         and 
                           
                              C
                           
                           
                              
                                 →
                              
                              
                                 
                                    
                                       ∗
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           
                              
                                 
                                    C
                                 
                              
                              
                                 ∗
                              
                           
                         we have 
                           
                              
                                 
                                    
                                       
                                          R
                                       
                                    
                                    
                                       
                                          C
                                       
                                    
                                 
                                 
                                    (
                                    ∗
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          R
                                       
                                    
                                    
                                       
                                          C
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ∗
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Edges in the tree decompositions shown in Fig. 4 are labeled with the reduction that merges three clusters into a new one. The set of triplets is the same in both tree decompositions, 
                           
                              
                                 
                                    
                                       
                                          R
                                       
                                    
                                    
                                       
                                          C
                                       
                                    
                                 
                                 
                                    (
                                    ∗
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       {
                                       a
                                       ,
                                       b
                                       ,
                                       c
                                       }
                                    
                                    ,
                                    
                                       {
                                       a
                                       ,
                                       d
                                       ,
                                       c
                                       }
                                    
                                    ,
                                    
                                       {
                                       a
                                       ,
                                       h
                                       ,
                                       f
                                       }
                                    
                                    ,
                                    
                                       {
                                       b
                                       ,
                                       f
                                       ,
                                       e
                                       }
                                    
                                    ,
                                    
                                       {
                                       c
                                       ,
                                       d
                                       ,
                                       e
                                       }
                                    
                                    ,
                                    
                                       {
                                       f
                                       ,
                                       i
                                       ,
                                       g
                                       }
                                    
                                    ,
                                    
                                       {
                                       f
                                       ,
                                       i
                                       ,
                                       j
                                       }
                                    
                                    ,
                                    
                                       {
                                       g
                                       ,
                                       h
                                       ,
                                       i
                                       }
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

From now on, given a tree-decomposable graph 
                           G
                           =
                           
                              (
                              V
                              ,
                              E
                              )
                           
                        , the derivation 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 G
                              
                           
                           
                              
                                 →
                              
                              
                                 ∗
                              
                           
                           
                              
                                 
                                    C
                                 
                              
                              
                                 ∗
                              
                           
                         applied by the solution constructor to the tree decomposition of 
                           G
                         to actually build a solution, will be called the derivation associated with the graph 
                           G
                        . We close this section showing a property of clusters generated by a derivation. 
                           Remark 3.1
                           Consider the derivation 
                                 
                                    C
                                 
                                 
                                    
                                       →
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       ∗
                                    
                                 
                              . For each pair of clusters 
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       ∗
                                    
                                 
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       ∗
                                    
                                 
                               with 
                                 i
                                 ≠
                                 j
                              , 
                                 
                                    |
                                    V
                                    
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                    
                                    ∩
                                    V
                                    
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             j
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                    
                                    |
                                 
                                 ≤
                                 1
                              .


                        
                           Proof
                           By definition, a cluster places a set of vertices with respect to a local framework of reference in such a way that constraints defined on them hold. For a contradiction assume that 
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                    
                                       ∗
                                    
                                 
                               and 
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       ∗
                                    
                                 
                               are two different clusters in 
                                 
                                    
                                       C
                                    
                                    
                                       ∗
                                    
                                 
                               with 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 V
                                 
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          i
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                               and 
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       j
                                    
                                 
                                 ∈
                                 V
                                 
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          j
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                               such that the pairs 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                               and 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       j
                                    
                                 
                               respectively designate the same pair of vertices say 
                                 u
                                 ,
                                 v
                                 ∈
                                 V
                                 
                                    (
                                    
                                       
                                          
                                             C
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                              . Then the pairs 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                               and 
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       j
                                    
                                 
                               define a rigid transformation that places vertices in one cluster with respect to the other one. That is 
                                 V
                                 
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          i
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                               and 
                                 V
                                 
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          j
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                               belong to the same cluster.□

In what follows the clusters merged by the reduction 
                           
                              
                                 →
                              
                              
                                 
                                    {
                                    u
                                    ,
                                    v
                                    ,
                                    w
                                    }
                                 
                              
                           
                         will be sometimes distinguished from each other by explicitly giving the pair of vertices in the reduction triplet included in the cluster, that is denoting them as 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 u
                                 v
                              
                           
                           ,
                           
                              
                                 
                                    C
                                 
                              
                              
                                 v
                                 w
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 w
                                 u
                              
                           
                        .

We have seen in Section  3 that given a tree decomposable graph 
                        G
                        =
                        
                           (
                           V
                           ,
                           E
                           )
                        
                     , in general, the tree decomposition is not unique. But the set of hinges is unique and the final cluster derived by the reduction 
                        
                           
                              
                                 C
                              
                           
                           
                              G
                           
                        
                        
                           
                              →
                           
                           
                              ∗
                           
                        
                        
                           C
                        
                      is canonical. This means that when in a tree decomposition several reduction steps can be applied, the specific reduction selected does not matter. For example in the tree decomposition shown in Fig. 4(a), if the current cluster term includes the clusters 
                        
                           {
                           a
                           ,
                           b
                           }
                        
                        ,
                        
                           {
                           b
                           ,
                           c
                           }
                        
                        ,
                        
                           {
                           c
                           ,
                           a
                           }
                        
                        ,
                        
                           {
                           f
                           ,
                           g
                           }
                        
                        ,
                        
                           {
                           g
                           ,
                           i
                           }
                        
                        ,
                        
                           {
                           i
                           ,
                           f
                           }
                        
                     , then reductions 
                        
                           {
                           a
                           ,
                           b
                           }
                        
                        ,
                        
                           {
                           b
                           ,
                           c
                           }
                        
                        ,
                        
                           {
                           c
                           ,
                           a
                           }
                        
                        
                           
                              →
                           
                           
                              
                                 {
                                 a
                                 ,
                                 b
                                 ,
                                 c
                                 }
                              
                           
                        
                        
                           {
                           a
                           ,
                           b
                           ,
                           c
                           }
                        
                      and 
                        
                           {
                           f
                           ,
                           g
                           }
                        
                        ,
                        
                           {
                           g
                           ,
                           i
                           }
                        
                        ,
                        
                           {
                           i
                           ,
                           f
                           }
                        
                        
                           
                              →
                           
                           
                              
                                 {
                                 f
                                 ,
                                 g
                                 ,
                                 i
                                 }
                              
                           
                        
                        
                           {
                           f
                           ,
                           g
                           ,
                           i
                           }
                        
                      can be applied in any sequence without affecting the resulting set of clusters.

However, in general, some reductions in a tree decomposition derivation can only be carried out after completing some other reductions. For example, reduction 
                        
                           
                              →
                           
                           
                              
                                 {
                                 f
                                 ,
                                 h
                                 ,
                                 j
                                 }
                              
                           
                        
                      in Fig. 4(a) can be completed only after completing reductions 
                        
                           
                              →
                           
                           
                              
                                 {
                                 f
                                 ,
                                 g
                                 ,
                                 i
                                 }
                              
                           
                        
                      and 
                        
                           
                              →
                           
                           
                              
                                 {
                                 g
                                 ,
                                 h
                                 ,
                                 i
                                 }
                              
                           
                        
                     . We say that reduction 
                        
                           
                              →
                           
                           
                              
                                 {
                                 f
                                 ,
                                 h
                                 ,
                                 j
                                 }
                              
                           
                        
                      
                     depends on reductions 
                        
                           
                              →
                           
                           
                              
                                 {
                                 f
                                 ,
                                 g
                                 ,
                                 i
                                 }
                              
                           
                        
                      and 
                        
                           
                              →
                           
                           
                              
                                 {
                                 g
                                 ,
                                 h
                                 ,
                                 i
                                 }
                              
                           
                        
                     . Dependence naturally introduces a hierarchy in the reduction steps of a derivation over a tree decomposition.

We start by defining the concept of minimal well constrained cluster induced by two vertices within a cluster. 
                        Definition 4.1
                        Consider a well constrained Laman cluster 
                              
                                 C
                              
                            and let 
                              u
                              ,
                              v
                            be two vertices in 
                              V
                              
                                 (
                                 
                                    C
                                 
                                 )
                              
                           . The minimal well constrained cluster in 
                              
                                 C
                              
                            with respect to the pair of vertices 
                              u
                              ,
                              v
                            is the cluster 
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       E
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                            induced in 
                              
                                 C
                              
                            by the minimal set of vertices 
                              
                                 
                                    V
                                 
                                 
                                    ′
                                 
                              
                              ⊆
                              V
                              
                                 (
                                 
                                    C
                                 
                                 )
                              
                            such that 
                              u
                              ,
                              v
                              ∈
                              
                                 
                                    V
                                 
                                 
                                    ′
                                 
                              
                            and 
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    ′
                                 
                              
                            is well constrained.

In what follows we shall denote the minimal well constrained cluster within cluster 
                        C
                      with respect to the vertices 
                        u
                        ,
                        v
                        ∈
                        V
                        
                           (
                           C
                           )
                        
                      as 
                        m
                        w
                        
                           
                              c
                           
                           
                              
                                 C
                              
                           
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                     . Notice that if vertices 
                        u
                        ,
                        v
                      define the edge 
                        
                           (
                           u
                           ,
                           v
                           )
                        
                        ∈
                        E
                     , trivially 
                        m
                        w
                        
                           
                              c
                           
                           
                              
                                 C
                              
                           
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                        =
                        
                           (
                           
                              {
                              u
                              ,
                              v
                              }
                           
                           ,
                           
                              {
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              }
                           
                           )
                        
                     .

Clusters in 
                        
                           (
                           
                              
                                 
                                    C
                                 
                              
                              
                                 G
                              
                           
                           ,
                           →
                           )
                        
                      are Laman well constrained, tree-decomposable graphs. Moreover the set of reductions 
                        
                           
                              
                                 R
                              
                           
                           
                              C
                           
                        
                        
                           (
                           ∗
                           )
                        
                      leading the starting term 
                        
                           
                              
                                 C
                              
                           
                           
                              G
                           
                        
                      to its normal form is unique. By definition, 
                        m
                        w
                        
                           
                              c
                           
                           
                              
                                 C
                              
                           
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      is well constrained. Moreover, given that 
                        C
                      is Laman, well constrained and tree-decomposable and that 
                        m
                        w
                        
                           
                              c
                           
                           
                              
                                 C
                              
                           
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      is a subgraph of 
                        C
                     , 
                        m
                        w
                        
                           
                              c
                           
                           
                              
                                 C
                              
                           
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      is a Laman tree-decomposable graph with reductions in 
                        
                           
                              
                                 R
                              
                           
                           
                              C
                           
                        
                        
                           (
                           ∗
                           )
                        
                     . Therefore 
                        m
                        w
                        
                           
                              c
                           
                           
                              
                                 C
                              
                           
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      is well defined and there is a derivation 
                        
                           
                              
                                 C
                              
                           
                           
                              G
                           
                        
                        
                           
                              →
                           
                           
                              ∗
                           
                        
                        m
                        w
                        
                           
                              c
                           
                           
                              
                                 C
                              
                           
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      with reductions in 
                        
                           
                              
                                 R
                              
                           
                           
                              C
                           
                        
                        
                           (
                           ∗
                           )
                        
                     .

In what follows clusters 
                        
                           
                              
                                 C
                              
                           
                           
                              
                                 i
                              
                           
                        
                      shall be denoted as 
                        
                           
                              
                                 C
                              
                           
                           
                              
                                 ab
                              
                           
                        
                      where 
                        a
                      and 
                        b
                      are vertices in a triplet 
                        
                           {
                           u
                           ,
                           v
                           ,
                           w
                           }
                        
                      on which the reduction is applied. Thus we will denote the minimal well constrained cluster 
                        m
                        w
                        
                           
                              c
                           
                           
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    a
                                    b
                                 
                              
                           
                        
                        
                           (
                           a
                           ,
                           b
                           )
                        
                      just as 
                        m
                        w
                        
                           
                              c
                           
                           
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    a
                                    b
                                 
                              
                           
                        
                     .

We consider two different dependence categories: co-dependence and indirect dependence. Technically we define them as follows. Refer to Fig. 5
                     . 
                        Definition 4.2
                        Consider the term 
                              
                                 C
                              
                           . Let 
                              
                                 
                                    →
                                 
                                 
                                    
                                       {
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                       
                                       }
                                    
                                 
                              
                            be a reduction in 
                              
                                 
                                    
                                       R
                                    
                                 
                                 
                                    
                                       C
                                    
                                 
                              
                              
                                 (
                                 ∗
                                 )
                              
                            involving three clusters 
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    a
                                    b
                                 
                              
                            with 
                              a
                              ,
                              b
                              ∈
                              
                                 {
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 }
                              
                            and 
                              a
                              ≠
                              b
                           . Let 
                              m
                              w
                              
                                 
                                    c
                                 
                                 
                                    
                                       
                                          
                                             C
                                          
                                       
                                       
                                          a
                                          b
                                       
                                    
                                 
                              
                            be such that 
                              
                                 (
                                 a
                                 ,
                                 b
                                 )
                              
                            is an edge in 
                              E
                              
                                 (
                                 m
                                 w
                                 
                                    
                                       c
                                    
                                    
                                       
                                          
                                             
                                                C
                                             
                                          
                                          
                                             a
                                             b
                                          
                                       
                                    
                                 
                                 )
                              
                           . Let 
                              
                                 
                                    →
                                 
                                 
                                    
                                       {
                                       a
                                       ,
                                       b
                                       ,
                                       w
                                       }
                                    
                                 
                              
                            be the reduction in 
                              
                                 
                                    
                                       R
                                    
                                 
                                 
                                    
                                       C
                                    
                                 
                              
                              
                                 (
                                 ∗
                                 )
                              
                            which merged the clusters 
                              
                                 (
                                 
                                    {
                                    a
                                    ,
                                    b
                                    }
                                 
                                 ,
                                 
                                    {
                                    
                                       (
                                       a
                                       ,
                                       b
                                       )
                                    
                                    }
                                 
                                 )
                              
                              ,
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    b
                                    w
                                 
                              
                            and 
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    w
                                    a
                                 
                              
                           . Then we say that reductions 
                              
                                 
                                    →
                                 
                                 
                                    
                                       {
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                       
                                       }
                                    
                                 
                              
                            and 
                              
                                 
                                    →
                                 
                                 
                                    
                                       {
                                       a
                                       ,
                                       b
                                       ,
                                       w
                                       }
                                    
                                 
                              
                            are co-dependent on each other.

Co-dependence is symmetric and relates a set of reductions at the same hierarchical level. Fig. 5(a) shows the general case of co-dependence. Assume that clusters 
                        
                           
                              C
                           
                           
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    1
                                 
                              
                           
                        
                        ,
                        
                           
                              C
                           
                           
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    1
                                 
                              
                           
                        
                        ,
                        
                           
                              C
                           
                           
                              a
                              w
                           
                        
                        ,
                        
                           
                              C
                           
                           
                              b
                              w
                           
                        
                      and some cluster, say 
                        
                           
                              C
                           
                           
                              a
                              b
                           
                        
                     , including the edge 
                        
                           (
                           a
                           ,
                           b
                           )
                        
                      belong to the current term. Then reductions 
                        
                           
                              →
                           
                           
                              
                                 {
                                 a
                                 ,
                                 b
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 }
                              
                           
                        
                      and 
                        
                           
                              →
                           
                           
                              
                                 {
                                 a
                                 ,
                                 b
                                 ,
                                 w
                                 }
                              
                           
                        
                      can be applied in any sequence. Fig. 5(b) is a particular example for the cluster 
                        
                           
                              C
                           
                           
                              a
                              b
                           
                        
                     . Fig. 5(c) shows the minimal well constrained cluster 
                        m
                        w
                        
                           
                              c
                           
                           
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          v
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 (
                                 a
                                 ,
                                 b
                                 )
                              
                           
                        
                     . The cluster 
                        
                           
                              C
                           
                           
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                           
                        
                      is generated by the reduction 
                        
                           
                              →
                           
                           
                              
                                 {
                                 a
                                 ,
                                 b
                                 ,
                                 w
                                 }
                              
                           
                        
                     .

Indirect dependence relates reductions at different hierarchical levels by capturing the idea that there are reductions which can be carried out only after completing other reductions. Generically we define indirect dependence as follows. 
                        Definition 4.3
                        Consider the term 
                              
                                 C
                              
                           . Let 
                              
                                 
                                    →
                                 
                                 
                                    
                                       {
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                       
                                       }
                                    
                                 
                              
                            be a reduction in 
                              
                                 
                                    
                                       R
                                    
                                 
                                 
                                    
                                       C
                                    
                                 
                              
                              
                                 (
                                 ∗
                                 )
                              
                            involving three clusters 
                              
                                 C
                              
                              
                                 (
                                 a
                                 b
                                 )
                              
                            with 
                              a
                              ,
                              b
                              ∈
                              
                                 {
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 }
                              
                            and 
                              a
                              ≠
                              b
                           . Let 
                              m
                              w
                              
                                 
                                    c
                                 
                                 
                                    
                                       C
                                    
                                    
                                       (
                                       a
                                       b
                                       )
                                    
                                 
                              
                            be such that 
                              
                                 |
                                 E
                                 
                                    (
                                    m
                                    w
                                    
                                       
                                          c
                                       
                                       
                                          
                                             C
                                          
                                          
                                             (
                                             a
                                             b
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 |
                              
                              >
                              3
                           . We say that reduction 
                              
                                 
                                    →
                                 
                                 
                                    
                                       {
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                       
                                       }
                                    
                                 
                              
                            indirectly depends on the set of reductions in the derivation 
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    G
                                 
                              
                              
                                 
                                    →
                                 
                                 
                                    ∗
                                 
                              
                              m
                              w
                              
                                 
                                    c
                                 
                                 
                                    
                                       C
                                    
                                    
                                       (
                                       a
                                       b
                                       )
                                    
                                 
                              
                           .

It is easy to see that indirect dependence is transitive. Fig. 6
                     (a) illustrates the definition of indirect dependence in the general case. Fig. 6(b) is a particular example and Fig. 6(c) details the minimal well constrained cluster 
                        m
                        w
                        
                           
                              c
                           
                           
                              
                                 C
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                           
                        
                     . Notice that on the one hand vertex 
                        a
                      and the edges incident on it have been removed without affecting the rigidity of the resulting graph. On the other hand, it is clear that before attempting to apply reduction 
                        
                           
                              →
                           
                           
                              
                                 {
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 }
                              
                           
                        
                     , reductions 
                        
                           
                              →
                           
                           
                              
                                 {
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 }
                              
                           
                        
                        ,
                        
                           
                              →
                           
                           
                              
                                 {
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 }
                              
                           
                        
                      and 
                        
                           
                              →
                           
                           
                              
                                 {
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 }
                              
                           
                        
                      must be completed to build the cluster 
                        m
                        w
                        
                           
                              c
                           
                           
                              
                                 C
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                           
                        
                     . In these conditions, consider the reduction
                        
                           
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    u
                                    v
                                 
                              
                              ,
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    v
                                    w
                                 
                              
                              ,
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    w
                                    u
                                 
                              
                              
                                 
                                    →
                                 
                                 
                                    
                                       {
                                       u
                                       ,
                                       v
                                       ,
                                       w
                                       }
                                    
                                 
                              
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    u
                                    v
                                    w
                                 
                              
                              .
                           
                        
                      Let 
                        
                           
                              
                                 R
                              
                           
                           
                              a
                              b
                           
                        
                        
                           (
                           ∗
                           )
                        
                      denote the set of reductions in the derivation 
                        
                           
                              
                                 C
                              
                           
                           
                              G
                           
                        
                        
                           
                              →
                           
                           
                              ∗
                           
                        
                        m
                        w
                        
                           
                              c
                           
                           
                              
                                 C
                              
                              
                                 (
                                 a
                                 b
                                 )
                              
                           
                        
                     . Clearly reduction 
                        
                           
                              →
                           
                           
                              
                                 {
                                 u
                                 ,
                                 v
                                 ,
                                 w
                                 }
                              
                           
                        
                      indirectly depends on the reductions in the set 
                        
                           
                              
                                 R
                              
                           
                           
                              u
                              v
                           
                        
                        
                           (
                           ∗
                           )
                        
                        ∪
                        
                           
                              
                                 R
                              
                           
                           
                              v
                              w
                           
                        
                        
                           (
                           ∗
                           )
                        
                        ∪
                        
                           
                              
                                 R
                              
                           
                           
                              w
                              u
                           
                        
                        
                           (
                           ∗
                           )
                        
                     .

Dependencies between reductions over a tree decomposition of a graph are not explicitly captured by the tree representation. Here we introduce a new way to represent a tree decomposition of a graph which explicitly captures the hierarchy introduced by dependencies in the reduction steps over the tree decomposition.

The new representation for graph tree decomposition is called hinges graph, in short 
                           h
                        -graph, and we formally define it as follows. 
                           Definition 5.1
                           Let 
                                 G
                                 =
                                 
                                    (
                                    V
                                    ,
                                    E
                                    )
                                 
                               be a tree-decomposable graph. The 
                                 h
                              -graph, associated to 
                                 G
                               is the graph 
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                 
                                 =
                                 
                                    (
                                    V
                                    ,
                                    
                                       
                                          E
                                       
                                       
                                          C
                                       
                                    
                                    ∪
                                    
                                       
                                          E
                                       
                                       
                                          I
                                       
                                    
                                    )
                                 
                              , where 
                                 V
                               is the set of reductions in the associated derivation 
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       G
                                    
                                 
                                 
                                    
                                       →
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       ∗
                                    
                                 
                              , 
                                 
                                    
                                       E
                                    
                                    
                                       C
                                    
                                 
                               is the set of unordered pairs 
                                 
                                    (
                                    
                                       
                                          ν
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          ν
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                               such that reductions 
                                 
                                    
                                       ν
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       ν
                                    
                                    
                                       2
                                    
                                 
                               are co-dependent and, 
                                 
                                    
                                       E
                                    
                                    
                                       I
                                    
                                 
                               is the set of ordered pairs 
                                 
                                    (
                                    
                                       
                                          ν
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          ν
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                               such that reduction 
                                 
                                    
                                       ν
                                    
                                    
                                       2
                                    
                                 
                               indirectly depends on reduction 
                                 
                                    
                                       ν
                                    
                                    
                                       1
                                    
                                 
                              .

Co-dependencies are represented by non-directed edges. Indirect dependencies are represented by directed edges. Fig. 7
                         shows the h-graph 
                           
                              
                                 H
                              
                              
                                 G
                              
                           
                         associated to the tree decompositions in Fig. 4 for the graph 
                           G
                         in turn shown in Fig. 3(a).

We shall now show that the h-graph for a given graph is unique. 
                           Theorem 5.1
                           
                              Let 
                              
                                 G
                                 =
                                 
                                    (
                                    V
                                    ,
                                    E
                                    )
                                 
                               
                              be a tree-decomposable graph. The h-graph 
                              
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                 
                               
                              associated with 
                              
                                 G
                               
                              is unique.
                           


                        
                           Proof
                           Let 
                                 T
                               be a tree decomposition of 
                                 G
                              . The set of hinges triplets in 
                                 T
                               or equivalently the set of reductions in the derivation 
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       G
                                    
                                 
                                 
                                    
                                       →
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       ∗
                                    
                                 
                               is unique. Thus the set of nodes 
                                 V
                                 
                                    (
                                    
                                       
                                          H
                                       
                                       
                                          G
                                       
                                    
                                    )
                                 
                               is unique. Since the derivation is canonical and a co- or indirect dependency can always be identified between a pair of adjacent reductions, the h-graph 
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                 
                               is unique.□

Given a tree-decomposable graph 
                           G
                           =
                           
                              (
                              V
                              ,
                              E
                              )
                           
                         and the associated derivation 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 G
                              
                           
                           
                              
                                 →
                              
                              
                                 ∗
                              
                           
                           
                              
                                 
                                    C
                                 
                              
                              
                                 ∗
                              
                           
                         for it, there is an associated 
                           
                              
                                 H
                              
                              
                                 G
                              
                           
                        . Moreover, given a tree-decomposable subgraph 
                           
                              
                                 G
                              
                              
                                 ′
                              
                           
                           ⊂
                           G
                         and a derivation for it 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           
                              
                                 →
                              
                              
                                 ∗
                              
                           
                           
                              
                                 
                                    C
                                 
                              
                              
                                 ′
                                 ∗
                              
                           
                        , there is a h-graph 
                           
                              
                                 H
                              
                              
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        .

Consider now the h graph 
                           
                              
                                 H
                              
                              
                                 G
                              
                           
                         and let 
                           
                              
                                 H
                              
                              
                                 ′
                              
                           
                         be a subgraph of 
                           
                              
                                 H
                              
                              
                                 G
                              
                           
                         defined in the usual way. Due to the dependencies, it is unclear whether there is a tree-decomposable subgraph 
                           
                              
                                 G
                              
                              
                                 ′
                              
                           
                         of 
                           G
                         such that 
                           
                              
                                 H
                              
                              
                                 ′
                              
                           
                           =
                           
                              
                                 H
                              
                              
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                              
                              
                                 ′
                              
                           
                        . In what follows we describe the conditions under which 
                           
                              
                                 G
                              
                              
                                 ′
                              
                           
                         exists. First we define h-subgraphs. 
                           Definition 5.2
                           Let 
                                 G
                                 =
                                 
                                    (
                                    V
                                    ,
                                    E
                                    )
                                 
                               be a tree-decomposable graph and 
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                 
                                 =
                                 
                                    (
                                    V
                                    ,
                                    
                                       
                                          E
                                       
                                       
                                          C
                                       
                                    
                                    ∪
                                    
                                       
                                          E
                                       
                                       
                                          I
                                       
                                    
                                    )
                                 
                               the associated h-graph. 
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          E
                                       
                                       
                                          C
                                       
                                       
                                          ′
                                       
                                    
                                    ∪
                                    
                                       
                                          E
                                       
                                       
                                          I
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               is a 
                                 h
                              -subgraph of 
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                 
                               if and only if 
                                 V
                                 ⊂
                                 
                                    
                                       V
                                    
                                    
                                       ′
                                    
                                 
                              , 
                                 
                                    
                                       E
                                    
                                    
                                       C
                                    
                                    
                                       ′
                                    
                                 
                                 ⊂
                                 
                                    
                                       E
                                    
                                    
                                       C
                                    
                                 
                               and 
                                 
                                    
                                       E
                                    
                                    
                                       I
                                    
                                    
                                       ′
                                    
                                 
                                 ⊂
                                 
                                    
                                       E
                                    
                                    
                                       I
                                    
                                 
                              .

Let 
                           ν
                         and 
                           
                              
                                 ν
                              
                              
                                 ′
                              
                           
                         be reductions in 
                           V
                           
                              (
                              
                                 
                                    H
                                 
                                 
                                    G
                                 
                              
                              )
                           
                         and denote by 
                           
                              
                                 dep
                              
                              
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                 
                              
                           
                           
                              (
                              ν
                              )
                           
                         the set of reductions in 
                           
                              
                                 H
                              
                              
                                 G
                              
                           
                         that indirectly depend on reduction 
                           ν
                        . 
                           Definition 5.3
                           Let 
                                 G
                                 =
                                 
                                    (
                                    V
                                    ,
                                    E
                                    )
                                 
                               be a tree decomposable graph and 
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                 
                                 =
                                 
                                    (
                                    V
                                    ,
                                    
                                       
                                          E
                                       
                                       
                                          C
                                       
                                    
                                    ∪
                                    
                                       
                                          E
                                       
                                       
                                          I
                                       
                                    
                                    )
                                 
                               the associated h-graph. Consider the h-subgraph 
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          E
                                       
                                       
                                          C
                                       
                                       
                                          ′
                                       
                                    
                                    ∪
                                    
                                       
                                          E
                                       
                                       
                                          I
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 ⊆
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                 
                              . We say that the h-subgraph 
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                               is complete if for all 
                                 ν
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       ′
                                    
                                 
                              , 
                                 
                                    
                                       
                                          dep
                                       
                                    
                                    
                                       
                                          
                                             H
                                          
                                          
                                             G
                                          
                                       
                                    
                                 
                                 
                                    (
                                    ν
                                    )
                                 
                                 ⊆
                                 
                                    
                                       V
                                    
                                    
                                       ′
                                    
                                 
                              .


                        Fig. 8
                        (a) and (b) shows complete h-subgraphs of the h-graph in Fig. 7. Notice that complete h-subgraphs include all the reductions needed to complete a derivation for the h-subgraph. Fig. 8(c) shows a h-subgraph where reduction 
                           
                              
                                 →
                              
                              
                                 
                                    {
                                    b
                                    ,
                                    e
                                    ,
                                    f
                                    }
                                 
                              
                           
                         cannot be carried out because reductions 
                           
                              
                                 →
                              
                              
                                 
                                    {
                                    a
                                    ,
                                    b
                                    ,
                                    c
                                    }
                                 
                              
                           
                           ,
                           
                              
                                 →
                              
                              
                                 
                                    {
                                    a
                                    ,
                                    c
                                    ,
                                    d
                                    }
                                 
                              
                           
                         and 
                           
                              
                                 →
                              
                              
                                 
                                    {
                                    c
                                    ,
                                    d
                                    ,
                                    e
                                    }
                                 
                              
                           
                         are missing. Hence this h-subgraph is not complete.


                        Fig. 9
                         shows tree decompositions built from the complete h-subgraphs in Fig. 8(a) and (b). 
                           Theorem 5.2
                           
                              Let 
                              
                                 G
                                 =
                                 
                                    (
                                    V
                                    ,
                                    E
                                    )
                                 
                               
                              be a tree-decomposable graph, 
                              
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                 
                              
                              the associated h-graph and 
                              
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                               
                              a complete h-subgraph of 
                              
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                 
                               
                              . Then there is a tree decomposable subgraph 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 ⊆
                                 G
                               
                              such that 
                              
                                 
                                    
                                       H
                                    
                                    
                                       
                                          
                                             G
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                              
                              .
                           


                        
                           Proof
                           If 
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                 
                               the theorem trivially holds.

Assume now that 
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          E
                                       
                                       
                                          C
                                       
                                       
                                          ′
                                       
                                    
                                    ∪
                                    
                                       
                                          E
                                       
                                       
                                          I
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               is a complete proper h-subgraph of 
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                 
                              . Clearly a graph, say 
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          E
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                              , can always be built from 
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                               with 
                                 
                                    
                                       V
                                    
                                    
                                       ′
                                    
                                 
                                 ⊆
                                 V
                               and 
                                 
                                    
                                       E
                                    
                                    
                                       ′
                                    
                                 
                                 ⊆
                                 E
                               induced from 
                                 
                                    
                                       E
                                    
                                    
                                       C
                                    
                                 
                                 ∪
                                 
                                    
                                       E
                                    
                                    
                                       I
                                    
                                 
                              . Given that 
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                               is complete, the set of decomposition steps in 
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                               built from 
                                 
                                    
                                       H
                                    
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                               can be carried out thus 
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                               is tree decomposable.□


                        Fig. 10
                         shows graphs associated to the complete h-subgraphs in Fig. 8(a) and (b) which illustrate Theorem 5.2.

Finally we prove that inclusion is preserved for h-subgraphs. 
                           Theorem 5.3
                           
                              Let 
                              
                                 
                                    
                                       G
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          E
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                               
                              and 
                              
                                 
                                    
                                       G
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          E
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                               
                              be two tree-decomposable graphs, and 
                              
                                 
                                    
                                       H
                                    
                                    
                                       
                                          
                                             G
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       
                                          
                                             G
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              the respective associated h-graphs. Then, 
                              
                                 
                                    
                                       H
                                    
                                    
                                       
                                          
                                             G
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ⊂
                                 
                                    
                                       H
                                    
                                    
                                       
                                          
                                             G
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                               
                              if and only if 
                              
                                 
                                    
                                       G
                                    
                                    
                                       1
                                    
                                 
                                 ⊂
                                 
                                    
                                       G
                                    
                                    
                                       2
                                    
                                 
                              
                              .
                           


                        
                           Proof
                           For the if part apply Theorem 5.2 with 
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       G
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 G
                                 =
                                 
                                    
                                       G
                                    
                                    
                                       2
                                    
                                 
                              .

For the only if part assume that 
                                 
                                    
                                       H
                                    
                                    
                                       
                                          
                                             G
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                I
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ∪
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                C
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ⊆
                                 
                                    
                                       H
                                    
                                    
                                       
                                          
                                             G
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                I
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ∪
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                C
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    )
                                 
                              . This would imply that 
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                                 ⊆
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                               or 
                                 
                                    
                                       E
                                    
                                    
                                       2
                                    
                                 
                                 ⊆
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                               or both hold. Therefore 
                                 
                                    
                                       G
                                    
                                    
                                       2
                                    
                                 
                                 ⊆
                                 
                                    
                                       G
                                    
                                    
                                       1
                                    
                                 
                              . This contradiction completes the proof.□

Before describing how the minimal well constrained cluster is computed we need to prove some simple results. Let 
                           
                              deg
                           
                           
                              (
                              v
                              )
                           
                         denote the degree of a vertex 
                           v
                         in a given graph 
                           G
                           =
                           
                              (
                              V
                              ,
                              E
                              )
                           
                        . 
                           Theorem 5.4
                           
                              Let 
                              
                                 G
                                 =
                                 
                                    (
                                    V
                                    ,
                                    E
                                    )
                                 
                               
                              be a well constrained graph with 
                              
                                 
                                    |
                                    V
                                    
                                       (
                                       G
                                       )
                                    
                                    |
                                 
                                 >
                                 3
                               
                              . Then there is at least one vertex 
                              
                                 v
                                 ∈
                                 V
                                 
                                    (
                                    G
                                    )
                                 
                               
                              such that 
                              
                                 
                                    deg
                                 
                                 
                                    (
                                    v
                                    )
                                 
                                 ≥
                                 3
                              
                              .
                           


                        
                           Proof
                           Because 
                                 G
                               is well constrained we have that 
                                 
                                    |
                                    E
                                    |
                                 
                                 =
                                 2
                                 
                                    |
                                    V
                                    |
                                 
                                 −
                                 3
                              . We know that for a well constrained graph with 
                                 
                                    |
                                    V
                                    
                                       (
                                       G
                                       )
                                    
                                    |
                                 
                                 >
                                 3
                              , the minimum degree of a vertex is 2. For a contradiction assume now that for each vertex 
                                 v
                                 ∈
                                 V
                                 
                                    (
                                    G
                                    )
                                 
                              , 
                                 
                                    deg
                                 
                                 
                                    (
                                    v
                                    )
                                 
                                 =
                                 2
                              . Then 
                                 
                                    |
                                    E
                                    |
                                 
                                 =
                                 
                                    |
                                    V
                                    |
                                 
                              .□


                        
                           Theorem 5.5
                           
                              Let 
                              
                                 G
                                 =
                                 
                                    (
                                    V
                                    ,
                                    E
                                    )
                                 
                               
                              be a well constrained Laman graph with 
                              
                                 
                                    |
                                    V
                                    
                                       (
                                       G
                                       )
                                    
                                    |
                                 
                                 ≥
                                 3
                               
                              . The graph 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          E
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               
                              resulting from removing a vertex of degree two from 
                              
                                 V
                                 
                                    (
                                    G
                                    )
                                 
                               
                              and the edges in 
                              
                                 E
                                 
                                    (
                                    G
                                    )
                                 
                               
                              incident on 
                              
                                 v
                               
                              is well constrained and Laman.
                           


                        
                           Proof
                           By hypothesis 
                                 
                                    |
                                    E
                                    |
                                 
                                 =
                                 2
                                 
                                    |
                                    V
                                    |
                                 
                                 −
                                 3
                              . But 
                                 
                                    |
                                    
                                       
                                          V
                                       
                                       
                                          ′
                                       
                                    
                                    |
                                 
                                 =
                                 
                                    |
                                    V
                                    |
                                 
                                 −
                                 1
                               and 
                                 
                                    |
                                    
                                       
                                          E
                                       
                                       
                                          ′
                                       
                                    
                                    |
                                 
                                 =
                                 
                                    |
                                    E
                                    |
                                 
                                 −
                                 2
                              . Then 
                                 
                                    |
                                    
                                       
                                          E
                                       
                                       
                                          ′
                                       
                                    
                                    |
                                 
                                 +
                                 2
                                 =
                                 2
                                 
                                    (
                                    
                                       |
                                       
                                          
                                             V
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                    
                                    +
                                    1
                                    )
                                 
                                 −
                                 3
                              . That is 
                                 
                                    |
                                    
                                       
                                          E
                                       
                                       
                                          ′
                                       
                                    
                                    |
                                 
                                 =
                                 2
                                 
                                    |
                                    
                                       
                                          V
                                       
                                       
                                          ′
                                       
                                    
                                    |
                                 
                                 −
                                 3
                              . The graph 
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                               resulting from removing a vertex of degree 2 from a Laman graph 
                                 G
                               preserves the internal distribution of edges carried over from 
                                 G
                              , see Fig. 11
                              . Thus 
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                               is a well constrained Laman graph.□


                        
                           Theorem 5.6
                           
                              Let 
                              
                                 G
                                 =
                                 
                                    (
                                    V
                                    ,
                                    E
                                    )
                                 
                               
                              be a well constrained graph with 
                              
                                 
                                    |
                                    V
                                    
                                       (
                                       G
                                       )
                                    
                                    |
                                 
                                 ≥
                                 3
                               
                              . The graph 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          E
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               
                              resulting from removing a vertex of degree three or higher from 
                              
                                 V
                                 
                                    (
                                    G
                                    )
                                 
                               
                              and the edges in 
                              
                                 E
                                 
                                    (
                                    G
                                    )
                                 
                               
                              incident on 
                              
                                 v
                               
                              is no longer well constrained.
                           


                        
                           Proof
                           Let 
                                 v
                               be the vertex with 
                                 
                                    deg
                                 
                                 
                                    (
                                    v
                                    )
                                 
                                 ≥
                                 3
                               removed from 
                                 V
                                 
                                    (
                                    G
                                    )
                                 
                              . By hypothesis 
                                 
                                    |
                                    E
                                    |
                                 
                                 =
                                 2
                                 
                                    |
                                    V
                                    |
                                 
                                 −
                                 3
                              . But 
                                 
                                    |
                                    
                                       
                                          V
                                       
                                       
                                          ′
                                       
                                    
                                    |
                                 
                                 =
                                 
                                    |
                                    V
                                    |
                                 
                                 −
                                 1
                               and 
                                 
                                    |
                                    
                                       
                                          E
                                       
                                       
                                          ′
                                       
                                    
                                    |
                                 
                                 =
                                 
                                    |
                                    E
                                    |
                                 
                                 −
                                 
                                    deg
                                 
                                 
                                    (
                                    v
                                    )
                                 
                              . Then 
                                 
                                    |
                                    
                                       
                                          E
                                       
                                       
                                          ′
                                       
                                    
                                    |
                                 
                                 +
                                 
                                    deg
                                 
                                 
                                    (
                                    v
                                    )
                                 
                                 =
                                 2
                                 
                                    (
                                    
                                       |
                                       
                                          
                                             V
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                    
                                    +
                                    1
                                    )
                                 
                                 −
                                 3
                              . That is 
                                 
                                    |
                                    
                                       
                                          E
                                       
                                       
                                          ′
                                       
                                    
                                    |
                                 
                                 =
                                 2
                                 
                                    |
                                    
                                       
                                          V
                                       
                                       
                                          ′
                                       
                                    
                                    |
                                 
                                 −
                                 3
                                 +
                                 
                                    (
                                    2
                                    −
                                    
                                       deg
                                    
                                    
                                       (
                                       v
                                       )
                                    
                                    )
                                 
                              . Now, 
                                 
                                    deg
                                 
                                 
                                    (
                                    v
                                    )
                                 
                                 ≥
                                 3
                               makes that 
                                 2
                                 −
                                 
                                    deg
                                 
                                 
                                    (
                                    v
                                    )
                                 
                                 ≤
                                 −
                                 1
                              . Hence 
                                 
                                    |
                                    
                                       
                                          E
                                       
                                       
                                          ′
                                       
                                    
                                    |
                                 
                                 <
                                 2
                                 
                                    |
                                    
                                       
                                          V
                                       
                                       
                                          ′
                                       
                                    
                                    |
                                 
                                 −
                                 3
                              .□

Taking into account the results shown above, to compute the minimal well constrained cluster we need to distinguish two situations. First consider that the cluster is a leaf node of the graph tree decomposition which contains the edge 
                           
                              (
                              u
                              ,
                              v
                              )
                           
                        . Then trivially the edge itself is the minimal well constrained cluster. Notice that if the cluster has exactly three vertices the minimal well constrained cluster is a triangle’s edge.

For clusters with more than three vertices we compute the 
                           m
                           w
                           
                              
                                 c
                              
                              
                                 C
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         in two steps. First we compute the lowest common ancestor of vertices 
                           u
                         and 
                           v
                        , denoted 
                           
                              
                                 
                                    LCA
                                 
                              
                              
                                 G
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                        , in the tree decomposition 
                           T
                         associated to the constraint graph at hand 
                           G
                        . Clearly this is the smallest cluster in 
                           T
                         which includes vertices 
                           u
                         and 
                           v
                        . Then we iteratively remove from 
                           
                              
                                 
                                    LCA
                                 
                              
                              
                                 G
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         all the two degree vertices except vertices 
                           u
                         and 
                           v
                        .

In the general case, the minimal well constrained cluster includes the two vertices considered 
                           u
                           ,
                           v
                         plus, at least, one vertex with degree three or higher. In this case, we recursively remove from the 
                           
                              
                                 
                                    LCA
                                 
                              
                              
                                 G
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         two out of the three subclusters induced by triplets 
                           
                              {
                              a
                              ,
                              b
                              ,
                              c
                              }
                           
                         in 
                           
                              
                                 
                                    LCA
                                 
                              
                              
                                 G
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         while keeping the subcluster, say 
                           
                              
                                 
                                    LCA
                                 
                              
                              
                                 a
                                 b
                              
                           
                        , such that 
                           u
                           ,
                           v
                           ∈
                           V
                           
                              (
                              
                                 
                                    
                                       LCA
                                    
                                 
                                 
                                    a
                                    b
                                 
                              
                              )
                           
                        . Then the procedure is recursively applied to 
                           
                              
                                 
                                    LCA
                                 
                              
                              
                                 a
                                 b
                              
                           
                         until no more degree 2 vertices different from 
                           u
                         and 
                           v
                         can be removed. Procedures are shown in Algorithms 1 and 2.


                        
                           
                              
                           
                        
                     


                        
                           
                              
                           
                        
                     


                        Fig. 12
                         illustrates how the algorithms compute the 
                           m
                           w
                           
                              
                                 c
                              
                              
                                 C
                              
                           
                           
                              (
                              a
                              ,
                              d
                              )
                           
                        . First vertices of degree 2, 
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 v
                              
                              
                                 3
                              
                           
                        , are sequentially removed. Then the triplet 
                           
                              {
                              a
                              ,
                              b
                              ,
                              c
                              }
                           
                         and clusters 
                           
                              
                                 
                                    LCA
                                 
                              
                              
                                 a
                                 b
                              
                           
                           ,
                           
                              
                                 
                                    LCA
                                 
                              
                              
                                 b
                                 c
                              
                           
                         and 
                           
                              
                                 
                                    LCA
                                 
                              
                              
                                 a
                                 c
                              
                           
                         are identified. Next the cluster 
                           
                              
                                 
                                    LCA
                                 
                              
                              
                                 a
                                 b
                              
                           
                         is selected because vertices 
                           a
                           ,
                           d
                         belong to 
                           V
                           
                              (
                              
                                 
                                    
                                       LCA
                                    
                                 
                                 
                                    a
                                    b
                                 
                              
                              )
                           
                        . Then the procedure is recursively applied to 
                           
                              
                                 
                                    LCA
                                 
                              
                              
                                 a
                                 b
                              
                           
                         until no more degree 2 vertices can be removed. The resulting cluster is the 
                           m
                           w
                           
                              
                                 c
                              
                              
                                 C
                              
                           
                           
                              (
                              a
                              ,
                              d
                              )
                           
                        .

The set of reductions that builds the minimal tree-decomposable cluster is well defined and is easily identified by visiting nodes in the tree decomposition rooted at 
                           
                              
                                 
                                    LCA
                                 
                              
                              
                                 C
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                        .

Next we describe how to compute the h-graph associated to a given graph 
                           G
                           =
                           
                              (
                              V
                              ,
                              E
                              )
                           
                         for which a tree decomposition 
                           T
                         is known. The approach takes advantage of two facts. First, as described in Section  3.2, the reduction system (
                           
                              
                                 
                                    C
                                 
                              
                              
                                 G
                              
                           
                           ,
                           →
                        ) is canonical. Therefore when more than one reduction applies, the specific sequence in which they are applied does not matter and we choose to apply first those reductions which rewrite edges in the starting term 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 G
                              
                           
                         into triangles. Second, dependencies between reductions over the starting term, if any, are co-dependencies. Having these facts in mind the algorithm includes three main steps. First we compute a starting graph by identifying in the tree decomposition 
                           T
                         the set of starting co-dependencies. Then a raw h-graph is computed by expanding the starting graph with the remaining co-dependencies and the full set of indirect dependencies. In the last stage, the h-graph is simplified.

The algorithm makes use of the following data structures. A reduction 
                           r
                         represents a tuple 
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    u
                                    v
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    v
                                    w
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    w
                                    u
                                 
                              
                              ,
                              u
                              ,
                              v
                              ,
                              w
                              )
                           
                         where 
                           
                              
                                 C
                              
                              
                                 u
                                 v
                              
                           
                           ,
                           
                              
                                 C
                              
                              
                                 v
                                 w
                              
                           
                           ,
                           
                              
                                 C
                              
                              
                                 w
                                 u
                              
                           
                         are the three clusters to be rewritten and 
                           u
                           ,
                           v
                           ,
                           w
                         is the hinges triplet for the reduction.

The set of clusters in the current term of the rewriting system is stored in a list 
                           C
                        .

The set of reductions which can be applied on the current set of clusters 
                           C
                         is stored in the list 
                           R
                        . This list is provided with the iterator 
                           R
                           .
                           
                              first
                           
                           
                              (
                              )
                           
                         and 
                           R
                           .
                           
                              next
                           
                           
                              (
                              )
                           
                        .

The list 
                           V
                         collects the set of the h-graph vertices. Each vertex 
                           v
                         in 
                           V
                           =
                           V
                           
                              (
                              
                                 
                                    H
                                 
                                 
                                    G
                                 
                              
                              )
                           
                         will store a reduction 
                           r
                        .

The procedure to compute the starting h-graph is described in Algorithm 3. The algorithm inputs a pointer to the tree decomposition 
                           T
                        . The starting h-graph is the empty graph and 
                           C
                         is initialized to the set of clusters corresponding to the leaf nodes in 
                           T
                        . 
                           R
                         initially stores the set of reductions which can be applied on the set of the tree decomposition leaf nodes. Clearly, for any pair of reductions in 
                           R
                         they are either independent or co-dependent on each other. Accordingly, the set of co-dependent edges 
                           E
                           C
                         is conveniently updated. Finally, reductions in 
                           R
                         are included in 
                           V
                         and the set of clusters 
                           C
                         is updated by serially applying the reductions in 
                           R
                         to the current rewriting system term.


                        
                           
                              
                           
                        
                     

Once the h-graph has been initialized, the computation proceeds as described in Algorithm 4. In the graph-based constructive geometric constraint solving approach, the solution constructor has figured out a solution to the constraint problem when all the vertices in the graph are placed with respect to a common framework of reference. This means that all the construction steps have been carried out. Equivalently, the underlying rewrite system has just rewritten the normal form and 
                           
                              |
                              C
                              |
                           
                           =
                           1
                         should hold for the number of clusters in the current term.


                        
                           
                              
                           
                        
                     

The loop in the algorithm first identifies one reduction which applies to the current term. Then the minimal well constrained clusters induced by the vertices in the reduction triplet within each cluster involved in the reduction considered are computed. Next h-graph edges are identified and included in the corresponding set of h-graph edges according to whether the dependencies are either co-dependent, EC, or indirect, EI. Finally the reduction under consideration is both added to the set of h-graph vertices, 
                           V
                           
                              (
                              
                                 
                                    H
                                 
                                 
                                    G
                                 
                              
                              )
                           
                        , and actually applied to the current term C to update it.

When the main loop in Algorithm 4 is over, we end up with a raw h-graph. For example, for the tree decompositions shown in Fig. 4, the h-graph generated would be the one depicted in Fig. 13
                        .

In general, the raw h-graph includes some extra edges. Taking into account that indirect dependence is transitive, directed edges 
                           
                              (
                              
                                 {
                                 a
                                 ,
                                 b
                                 ,
                                 c
                                 }
                              
                              ,
                              
                                 {
                                 a
                                 ,
                                 h
                                 ,
                                 f
                                 }
                              
                              )
                           
                        , 
                           
                              (
                              
                                 {
                                 a
                                 ,
                                 c
                                 ,
                                 d
                                 }
                              
                              ,
                              
                                 {
                                 a
                                 ,
                                 h
                                 ,
                                 f
                                 }
                              
                              )
                           
                         and 
                           
                              (
                              
                                 {
                                 c
                                 ,
                                 d
                                 ,
                                 e
                                 }
                              
                              ,
                              
                                 {
                                 a
                                 ,
                                 h
                                 ,
                                 f
                                 }
                              
                              )
                           
                           ∈
                           V
                           
                              (
                              
                                 
                                    H
                                 
                                 
                                    G
                                 
                              
                              )
                           
                         in the raw graph depicted in Fig. 13 are redundant. If we do not consider undirected edges, the raw h-graph is a directed acyclic graph. Thus the final h-graph is computed as the unique transitive reduction of the raw h-graph,  [23,24]. The h-graph output by the simplification process is shown in Fig. 7.

In the geometric constraint problem described in Fig. 1, when values for, say, distances 
                        
                           
                              d
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              d
                           
                           
                              2
                           
                        
                      are fixed while the value assigned to the angle 
                        λ
                      changes, the problem has one degree of freedom and 
                        λ
                      is the variant parameter. Consider now the geometric constraint problem abstracted by the graph 
                        G
                        =
                        
                           (
                           V
                           ,
                           E
                           )
                        
                      depicted in Fig. 14
                     . Edge 
                        
                           (
                           c
                           ,
                           d
                           )
                        
                        ∈
                        V
                        
                           (
                           G
                           )
                        
                      defines a variant parameter 
                        λ
                      for the degree of freedom in the underlying geometric problem. The associated h-graph 
                        
                           
                              H
                           
                           
                              G
                           
                        
                        =
                        
                           (
                           V
                           ,
                           
                              
                                 E
                              
                              
                                 C
                              
                           
                           ∪
                           
                              
                                 E
                              
                              
                                 S
                              
                           
                           )
                        
                      is shown in Fig. 7.

Constraint-based geometric problems with one degree of freedom can be found in the core of, among others, parametric solid modeling and dynamic geometry.  [11,12,10]. In these fields, knowing beforehand which is the set of values for 
                        λ
                      such that the geometric construction can actually be built plays a central role. This challenging and longtime standing problem used to be solved by regular sampling in the parameters space. See  [6].

A direct method to compute the set of values of 
                        λ
                      for which the construction plan solution to a constraint problem is feasible was described for the first time in  [25,10]. The method was formalized in  [11,12] where a correctness proof along with specific implementation details were given.

In this section we describe an efficient algorithm to compute as a preprocess the set of reduction steps in a tree decomposition of a graph 
                        G
                        =
                        
                           (
                           V
                           ,
                           E
                           )
                        
                      which depend on the variant parameter 
                        λ
                     . The hierarchy captured by the h-graph 
                        
                           
                              H
                           
                           
                              G
                           
                        
                        =
                        
                           (
                           V
                           ,
                           
                              
                                 E
                              
                              
                                 C
                              
                           
                           ∪
                           
                              
                                 E
                              
                              
                                 S
                              
                           
                           )
                        
                      associated to the tree decomposition of graph 
                        G
                      leverages the computation of dependencies and the method improves over the approach reported in  [11]. Recall that given a tree-decomposable graph 
                        G
                     , the associated 
                        
                           
                              H
                           
                           
                              G
                           
                        
                      is unique.

Dependencies are computed in two steps as described in Algorithm 5. Assume that the variant parameter is 
                        λ
                        =
                        
                           (
                           u
                           ,
                           v
                           )
                        
                        ∈
                        E
                        
                           (
                           G
                           )
                        
                     . First we collect the set of co-dependencies of the variant parameter which are those reductions in 
                        V
                        
                           (
                           
                              
                                 H
                              
                              
                                 G
                              
                           
                           )
                        
                      including edge 
                        
                           (
                           u
                           ,
                           v
                           )
                        
                     . This set, say DD, is computed visiting once each vertex in 
                        V
                        
                           (
                           
                              
                                 H
                              
                              
                                 G
                              
                           
                           )
                        
                     .

In the second step, we first store in a stack the indirect dependencies, if any, related to each co-dependence. Then all what we need to do is to figure out the set of indirect reductions ID by recursively visiting the reductions in 
                        V
                        
                           (
                           
                              
                                 H
                              
                              
                                 G
                              
                           
                           )
                        
                     . When the stack is empty, the ID set has been completed.


                     
                        
                           
                        
                     
                  

To illustrate how the algorithm works consider again the graph 
                        G
                        =
                        
                           (
                           V
                           ,
                           E
                           )
                        
                      in Fig. 14 where edge 
                        
                           (
                           c
                           ,
                           d
                           )
                        
                      defines the variant parameter 
                        λ
                      and the associated h-graph 
                        
                           
                              H
                           
                           
                              G
                           
                        
                        =
                        
                           (
                           V
                           ,
                           
                              
                                 E
                              
                              
                                 C
                              
                           
                           ∪
                           
                              
                                 E
                              
                              
                                 S
                              
                           
                           )
                        
                      is shown in Fig. 7. Reductions in 
                        V
                        
                           (
                           
                              
                                 H
                              
                              
                                 G
                              
                           
                           )
                        
                      which include vertices 
                        c
                      and 
                        d
                      as hinges are 
                        
                           
                              →
                           
                           
                              
                                 {
                                 a
                                 ,
                                 c
                                 ,
                                 d
                                 }
                              
                           
                        
                      and 
                        
                           
                              →
                           
                           
                              
                                 {
                                 c
                                 ,
                                 d
                                 ,
                                 e
                                 }
                              
                           
                        
                     . These reductions are co-depend and allow to fix the range for 
                        λ
                     . Reductions which indirectly depend on 
                        
                           
                              →
                           
                           
                              
                                 {
                                 a
                                 ,
                                 c
                                 ,
                                 d
                                 }
                              
                           
                        
                      and 
                        
                           
                              →
                           
                           
                              
                                 {
                                 c
                                 ,
                                 d
                                 ,
                                 e
                                 }
                              
                           
                        
                      are 
                        
                           
                              →
                           
                           
                              
                                 {
                                 b
                                 ,
                                 e
                                 ,
                                 f
                                 }
                              
                           
                        
                      and 
                        
                           
                              →
                           
                           
                              
                                 {
                                 a
                                 ,
                                 f
                                 ,
                                 h
                                 }
                              
                           
                        
                     . These reductions indirectly depend on 
                        λ
                     .

Notice that the complexity of the constraint problem does not matter. When the geometric constraint problem is solved by the tree decomposition approach, a parameter range is always figured out on a triangle. For a detailed description on how to compute feasible ranges for the variant parameter in geometric constraint problems with one degree of freedom see  [11,22]. As an example, assume that edges 
                        
                           (
                           a
                           ,
                           c
                           )
                        
                        ,
                        
                           (
                           a
                           ,
                           d
                           )
                        
                        ,
                        
                           (
                           c
                           ,
                           e
                           )
                        
                      and 
                        
                           (
                           e
                           ,
                           d
                           )
                        
                      are point–point distance constraints with values 
                        
                           
                              d
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              d
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              d
                           
                           
                              3
                           
                        
                      and 
                        
                           
                              d
                           
                           
                              4
                           
                        
                      respectively. Assume that 
                        λ
                        =
                        
                           (
                           c
                           ,
                           d
                           )
                        
                      is a point–point distance constraint for which we want to know the range of values such that both reductions, 
                        
                           
                              →
                           
                           
                              
                                 {
                                 a
                                 ,
                                 c
                                 ,
                                 d
                                 }
                              
                           
                        
                      and 
                        
                           
                              →
                           
                           
                              
                                 {
                                 c
                                 ,
                                 d
                                 ,
                                 e
                                 }
                              
                           
                        
                     , can be carried out. This range can now be figured out as follows. On the one hand, the triangle inequality for reduction 
                        
                           
                              →
                           
                           
                              
                                 {
                                 a
                                 ,
                                 c
                                 ,
                                 d
                                 }
                              
                           
                        
                      fixes that 
                        
                           |
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           −
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           |
                        
                        ≤
                        λ
                        ≤
                        
                           
                              d
                           
                           
                              1
                           
                        
                        +
                        
                           
                              d
                           
                           
                              2
                           
                        
                     . On the other hand for reduction 
                        
                           
                              →
                           
                           
                              
                                 {
                                 c
                                 ,
                                 d
                                 ,
                                 e
                                 }
                              
                           
                        
                     , we have that 
                        
                           |
                           
                              
                                 d
                              
                              
                                 3
                              
                           
                           −
                           
                              
                                 d
                              
                              
                                 4
                              
                           
                           |
                        
                        ≤
                        λ
                        ≤
                        
                           
                              d
                           
                           
                              3
                           
                        
                        +
                        
                           
                              d
                           
                           
                              4
                           
                        
                     . Denote 
                        
                           
                              λ
                           
                           
                              
                                 min
                              
                           
                        
                        =
                        max
                        
                           (
                           
                              |
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              −
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              |
                           
                           ,
                           
                              |
                              
                                 
                                    d
                                 
                                 
                                    3
                                 
                              
                              −
                              
                                 
                                    d
                                 
                                 
                                    4
                                 
                              
                              |
                           
                           )
                        
                      and 
                        
                           
                              λ
                           
                           
                              
                                 max
                              
                           
                        
                        =
                        min
                        
                           (
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 3
                              
                           
                           +
                           
                              
                                 d
                              
                              
                                 4
                              
                           
                           )
                        
                     . Then the set of values for 
                        λ
                      is 
                        
                           
                              λ
                           
                           
                              
                                 min
                              
                           
                        
                        ≤
                        λ
                        ≤
                        
                           
                              λ
                           
                           
                              
                                 max
                              
                           
                        
                     .

@&#CONCLUSIONS@&#

It is often found that parametric models used in real applications which are abstracted as geometric constraint problems fail when computing a solution instance for some parameter values. This fact naturally poses the question of how to compute ranges for parameters for which the solution instantiation succeeds.

When the 2D geometric constraint problem is solved by the tree decomposition approach, the symbolic solution is a graph decomposition represented as a ternary tree where each node captures the construction of a triangle and the leaf nodes capture the set of geometric elements in the problem. Thus construction feasibility is always solved applying geometric properties of triangles.

We find two different scenarios when computing the feasibility of a triangle. If the triangle is defined by three vertices (geometric elements) connected by three edges (constraints) all what we need to do is to apply the triangular inequality. If there are two or more triangles sharing an edge (co-dependencies), the feasibility range is just the intersection of the ranges computed for each of these triangles.

When two vertices are connected by an already completed construction, (indirect dependencies) feasible ranges can be computed only after propagating those parameter ranges that limit the feasibility of the already completed construction. This situation entails an intensive search in the tree decomposition to identify the set of constructions actually involved.

In existing approaches, parameter ranges are figured out on the fly while computing solution instances. This entails repeating searches in the tree decomposition in both when identifying dependencies for a given parameter and when computing feasibility ranges for different parameters in the problem at hand.

Considering that the set of dependencies in a constraint graph is unique, the h-graph introduced in this work captures both co-dependencies and indirect dependencies. The h-graph improves the performance of computing parameter ranges in two ways. First, the h-graph is computed as a preprocess once and for all independently of the parameter the range of which must be figured out. Second, the h-graph clearly avoids the search in the tree decomposition for the existence of dependencies when actually computing ranges of parameters.

In general, a tree decomposition that symbolically solves the geometric constraint problem is not the most convenient representation to be actually carried out to effectively compute solution instances. Thus usually the tree decomposition is transformed into some sort of functional program. Hence, an additional benefit we get with the h-graph derives from the fact that the h-graph defines a convenient representation for the construction to be directly executed. This plan naturally captures precedences between construction steps and fixes the order that should be applied to actually carry out the geometric construction. Moreover, computing ranges and instantiating solutions can be performed in a single step avoiding further searches in the tree decomposition.

@&#ACKNOWLEDGMENTS@&#

We thank the reviewers for their thorough review and highly appreciate the comments and suggestions, which significantly contributed to improve the paper. Robert Joan-Arinyo has been supported by the CICYT Spanish Research Agency under the project TIN2013-47137-C2-1-P.

@&#REFERENCES@&#

