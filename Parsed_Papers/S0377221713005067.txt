@&#MAIN-TITLE@&#Robustness of optimal portfolios under risk and stochastic dominance constraints

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Robustness of risk constrained portfolio selection problems.


                        
                        
                           
                           Robust FSD portfolio efficiency tests.


                        
                        
                           
                           Contamination technique.


                        
                        
                           
                           Stress testing of parameters in the Markowitz model.


                        
                        
                           
                           Stress testing with respect to additional scenarios.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Robustness and sensitivity analysis

Markowitz mean–variance model

Probabilistic risk constraints

Contamination technique

First order stochastic dominance constraints

Portfolio efficiency tests

@&#ABSTRACT@&#


               
               
                  Solutions of portfolio optimization problems are often influenced by a model misspecification or by errors due to approximation, estimation and incomplete information. The obtained results, recommendations for the risk and portfolio manager, should be then carefully analyzed. We shall deal with output analysis and stress testing with respect to uncertainty or perturbations of input data for static risk constrained portfolio optimization problems by means of the contamination technique. Dependence of the set of feasible solutions on the probability distribution rules out the straightforward construction of convexity-based global contamination bounds. Results obtained in our paper [Dupačová, J., & Kopa, M. (2012). Robustness in stochastic programs with risk constraints. Annals of Operations Research, 200, 55–74.] were derived for the risk and second order stochastic dominance constraints under suitable smoothness and/or convexity assumptions that are fulfilled, e.g. for the Markowitz mean–variance model. In this paper we relax these assumptions having in mind the first order stochastic dominance and probabilistic risk constraints. Local bounds for problems of a special structure are obtained. Under suitable conditions on the structure of the problem and for discrete distributions we shall exploit the contamination technique to derive a new robust first order stochastic dominance portfolio efficiency test.
               
            

@&#INTRODUCTION@&#

In conclusions of his famous paper (Markowitz, 1952) on portfolio selection, Markowitz stated that “what is needed is essentially a ‘probabilistic’ reformulation of security analysis”. He developed a model for portfolio optimization in an uncertain environment under various simplifications. Let us recall the basic formulation: The composition of portfolio of N assets is given by weights of the considered assets, 
                        
                           
                              
                                 x
                              
                              
                                 n
                              
                           
                           ,
                           n
                           =
                           1
                           ,
                           …
                           ,
                           N
                           ,
                           
                              
                                 ∑
                              
                              
                                 n
                              
                           
                           
                              
                                 x
                              
                              
                                 n
                              
                           
                           =
                           1
                        
                     . The unit investment in the nth asset provides the random return ρ
                     
                        n
                      over the considered fixed period. The assumed probability distribution of the vector ρ of returns of all assets is characterized by a known vector of expected returns Eρ
                     =
                     μ and by a fixed covariance matrix Σ
                     =[cov(ρ
                     
                        i
                     ,
                     ρ
                     
                        j
                     ), i, j
                     =1,…,
                     N] whose main diagonal consists of variances of individual returns. This allows to quantify the “yield from the investment” as the expectation 
                        
                           
                              
                                 E
                              
                              
                                 P
                              
                           
                           
                              
                                 ρ
                              
                              
                                 ⊤
                              
                           
                           x
                           =
                           
                              
                                 ∑
                              
                              
                                 n
                              
                           
                           
                              
                                 x
                              
                              
                                 n
                              
                           
                           
                              
                                 μ
                              
                              
                                 n
                              
                           
                           =
                           
                              
                                 μ
                              
                              
                                 ⊤
                              
                           
                           x
                        
                      of its total return and the “risk of the investment” as the variance of its total return, 
                        
                           
                              
                                 var
                              
                              
                                 P
                              
                           
                           
                              
                                 ρ
                              
                              
                                 ⊤
                              
                           
                           x
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           cov
                           (
                           
                              
                                 ρ
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 ρ
                              
                              
                                 j
                              
                           
                           )
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           
                              
                                 x
                              
                              
                                 j
                              
                           
                           =
                           
                              
                                 x
                              
                              
                                 ⊤
                              
                           
                           Σ
                           x
                        
                     . Investors aim at maximal possible yields and, at the same time, at minimal possible risks – hence, a typical decision problem with two criteria, “max” {E
                     
                        P
                     
                     ρ
                     ⊤
                     x,−var
                        P
                     
                     ρ
                     ⊤
                     x} or “min” {−E
                     
                        P
                     
                     ρ
                     ⊤
                     x, var
                        P
                     
                     ρ
                     ⊤
                     x}. The mean–variance efficiency introduced by Markowitz is fully in line with general concepts of multiobjective optimization. Accordingly, mean–variance efficient portfolios can be obtained by solving various optimization problems such as the risk-adjusted expected return problem
                        
                           (1)
                           
                              
                                 
                                    
                                       min
                                    
                                    
                                       x
                                       ∈
                                       X
                                    
                                 
                              
                              -
                              λ
                              
                                 
                                    μ
                                 
                                 
                                    ⊤
                                 
                              
                              x
                              +
                              1
                              /
                              2
                              
                                 
                                    x
                                 
                                 
                                    ⊤
                                 
                              
                              Σ
                              x
                           
                        
                     where the value of parameter λ
                     ⩾0 reflects investor’s risk aversion. Another possibility, favored in practice, is to minimize the portfolio variance subject to a lower bound for the total expected return, i.e.
                        
                           (2)
                           
                              
                                 
                                    
                                       min
                                    
                                    
                                       x
                                       ∈
                                       X
                                    
                                 
                              
                              
                              
                                 
                                    x
                                 
                                 
                                    ⊤
                                 
                              
                              Σ
                              x
                              
                              subject to
                              
                              
                                 
                                    μ
                                 
                                 
                                    ⊤
                                 
                              
                              x
                              ⩾
                              k
                           
                        
                     with parameter k, or to maximize the expected return under a constraint on the portfolio variance
                        
                           (3)
                           
                              
                                 
                                    
                                       max
                                    
                                    
                                       x
                                       ∈
                                       X
                                    
                                 
                              
                              
                              
                                 
                                    μ
                                 
                                 
                                    ⊤
                                 
                              
                              x
                              
                              subject to
                              
                              
                                 
                                    x
                                 
                                 
                                    ⊤
                                 
                              
                              Σ
                              x
                              ⩽
                              v
                              .
                           
                        
                     In the classical theory, the set 
                        
                           X
                           =
                           
                              
                                 
                                    x
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          N
                                       
                                    
                                    :
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    1
                                 
                              
                           
                        
                      is without nonnegativity constraints, which means that short sales are permitted. Under this simplification explicit forms of optimal solutions can be obtained. In what follows we shall allow in (1)–(3) for general convex polyhedral sets 
                     
                        
                           X
                        
                     .

It was the introduction of risk into the investment decisions which was the exceptional feature of this model and a real breakthrough, and the Markowitz model became a standard tool for portfolio optimization.

The optimal solution x
                     ∗(μ,
                     Σ;
                     λ) and the optimal value φ(μ,
                     Σ;
                     λ) of (1) depend on the chosen value of λ and on parameters μ, Σ. At the same time, one can hardly assume full knowledge of these input parameters. The impact of errors in expected returns, variances and covariances on the optimal return φ of the obtained portfolio was investigated, e.g. in a simulation study Chopra and Ziemba (1993). The results indicate that the errors in expected values are more influential than those in the second order moments. We refer to Fabozzi, Huang, and Zhou (2010) for discussions of suitable approaches dealing with parameters uncertainty for the Markowitz model, such as robust reformulations and advanced estimation techniques, and also to Dupačová (2012) for results based on parametric programming, stochastic sensitivity analysis and the worst-case analysis.

We shall deal with static mean-risk models for portfolios of assets with random returns ρ whose probability distribution P does not depend on the selected portfolio composition. (Recall the assumption of a small investor in the Markowitz model.) The yield from the portfolio x is again the expectation E
                     
                        P
                     
                     ρ
                     ⊤
                     x, the risk is understood now as a function 
                        
                           R
                        
                      which assigns a real number to uncertain outcomes ρ
                     ⊤
                     x of the decision x. The value of function 
                        
                           R
                        
                      should not depend on the realization of the uncertain return ρ but it depends on the decision and on the probability distribution P; accordingly we shall denote it 
                        
                           R
                           (
                           x
                           ,
                           P
                           )
                        
                     . It should posses some natural properties such as monotonicity, translation equivariance, positive homogeneity and subadditivity to be called coherent; see Artzner, Delbaen, Eber, and Heath (1999). The well-known risk measure Value at Risk (VaR), which is not coherent in general, and the coherent Conditional Value at Risk (CVaR) are special cases of 
                        
                           R
                        
                     . We refer to the recent survey paper Krokhmal, Zabarankin, and Uryasev (2011) for other possibilities.

For a known probability distribution P of returns the problems corresponding to f (1)–(3) are
                        
                           (4)
                           
                              
                                 
                                    
                                       min
                                    
                                    
                                       x
                                       ∈
                                       X
                                    
                                 
                              
                              
                              -
                              λ
                              
                                 
                                    E
                                 
                                 
                                    P
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    ⊤
                                 
                              
                              x
                              +
                              R
                              (
                              x
                              ,
                              P
                              )
                              ,
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    
                                       min
                                    
                                    
                                       x
                                       ∈
                                       X
                                    
                                 
                              
                              
                              R
                              (
                              x
                              ,
                              P
                              )
                              
                              subject to
                              
                              
                                 
                                    E
                                 
                                 
                                    P
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    ⊤
                                 
                              
                              x
                              ⩾
                              k
                              ,
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    
                                       max
                                    
                                    
                                       x
                                       ∈
                                       X
                                    
                                 
                              
                              
                              
                                 
                                    E
                                 
                                 
                                    P
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    ⊤
                                 
                              
                              x
                              
                              subject to
                              
                              R
                              (
                              x
                              ,
                              P
                              )
                              ⩽
                              v
                              .
                           
                        
                     The form (4) with a probability independent set of feasible decisions is convenient for applications of quantitative stability analysis techniques, whereas risk management regulations ask frequently for satisfaction of risk constraints with a fixed limit v displayed in (6). Solving (6) for various values of v one obtains directly the corresponding points [μ
                     ⊤
                     x
                     ∗(v),v] on the mean-risk efficient frontier. Numerical tractability of the mean-risk problems depends on the choice of the risk measure and on the assumed probability distribution P. Programs (4)–(6) are convex for variance of portfolio returns, 
                        
                           R
                           (
                           x
                           ,
                           P
                           )
                           =
                           
                              
                                 x
                              
                              
                                 ⊤
                              
                           
                           Σ
                           x
                        
                     , and for convex risk measures 
                        
                           R
                           (
                           •
                           ,
                           P
                           )
                        
                     , such as CVaR, but not for VaR; see Dupačová (2006) and Dupačová and Polívka (2007). As the probability distribution P is fully known only exceptionally, quantitative stability analysis with respect to changes of P is important. The selected approach should reflect the type of the risk function 
                        
                           R
                           (
                           x
                           ,
                           P
                           )
                        
                      and of the input information which, in general, does not consist only of the first and second moments. See e.g. Stoyanov, Rachev, and Fabozzi (2013) for analysis of influence of moments of fat-tailed return distributions on portfolio VaR and CVaR in a parametric setting. Aiming at numerically tractable approaches, one may design focused simulation studies and backtesting; also the worst-case analysis or robustification with respect to all probability distributions belonging to an uncertainty set 
                        
                           P
                        
                      is applicable in various situations, see e.g. Pflug and Wozabal (2007) and Zhu and Fukushima (2009). In this paper we shall approach the quantitative stability analysis with respect to changes of P by stress testing via contamination, see Dupačová (2006) and Dupačová and Kopa (2012) and Dupačová and Polívka (2007).

In our paper Dupačová and Kopa (2012), convexity and smoothness properties of risk functions 
                        
                           R
                           (
                           x
                           ,
                           P
                           )
                        
                      in (5) and (6) were exploited to get local contamination bounds for the optimal value. The results hold true, e.g. for portfolio optimization under the variance or CVaR constraints. Now we shall focus on relaxation of convexity and smoothness assumptions having in mind distributional robustness analysis and stress testing for risk averse portfolios with risk quantified by means of probabilistic constraints and for the first order stochastic dominance constraints. Probabilistic constraints appear in definition of VaR
                        α
                      of a portfolio
                        
                           (7)
                           
                              
                                 
                                    VaR
                                 
                                 
                                    α
                                 
                              
                              (
                              x
                              ,
                              P
                              )
                              =
                              
                                 min
                              
                              {
                              a
                              ∈
                              R
                              :
                              P
                              (
                              g
                              (
                              x
                              ,
                              ρ
                              )
                              ⩽
                              a
                              )
                              ⩾
                              α
                              }
                              ,
                           
                        
                     where g(x,
                     ρ) denotes the loss of portfolio x for return ρ, and they were considered in the context of risk modeling already by Telser (1955) and Kataoka (1963) for a bilinear loss function and Gaussian distribution of ρ. In the present paper, such special assumptions are not imposed. Subsequently, the first order stochastic dominance constraints will be exploited.

In Section 3, we shall describe the contamination technique and we shall deal with local contamination bounds under relaxed assumptions. The results will be applied in Section 4 to efficiency tests of portfolios under the first order stochastic dominance constraints.

Consider the following abstract formulation of (6) written now as a minimization problem:
                        
                           (8)
                           
                              
                                 
                                    
                                       min
                                    
                                    
                                       x
                                       ∈
                                       X
                                       (
                                       P
                                       )
                                    
                                 
                              
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                              (
                              x
                              ,
                              P
                              )
                           
                        
                     where P is the probability distribution of a random vector ρ with range 
                        
                           Ω
                           ⊂
                           
                              
                                 R
                              
                              
                                 M
                              
                           
                        
                     . The objective function G
                     0 quantifies the loss of portfolio and risk constraints enter the definition of the set of feasible solutions 
                        
                           X
                           (
                           P
                           )
                           ⊂
                           
                              
                                 R
                              
                              
                                 N
                              
                           
                        
                     . We denote 
                        
                           
                              
                                 X
                              
                              
                                 ∗
                              
                           
                           (
                           P
                           )
                        
                      the set of optimal solutions and φ(P) the optimal value of the objective function in (8) and we shall assume that φ(P) is finite. The considered set of feasible solutions is of the form
                        
                           (9)
                           
                              X
                              (
                              P
                              )
                              ≔
                              {
                              x
                              ∈
                              X
                              :
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                              
                              (
                              x
                              ,
                              P
                              )
                              ⩽
                              0
                              ,
                              
                              j
                              =
                              1
                              ,
                              …
                              ,
                              J
                              }
                              .
                           
                        
                     We shall focus on probabilistic risk constraints with
                        
                           (10)
                           
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                              
                              (
                              x
                              ,
                              P
                              )
                              ≔
                              
                                 
                                    R
                                 
                                 
                                    j
                                 
                              
                              (
                              x
                              ,
                              P
                              )
                              -
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              
                              and
                              
                              
                                 
                                    R
                                 
                                 
                                    j
                                 
                              
                              (
                              x
                              ,
                              P
                              )
                              ≔
                              P
                              (
                              
                                 
                                    g
                                 
                                 
                                    h
                                 
                              
                              (
                              x
                              ,
                              ρ
                              )
                              ⩾
                              0
                              ,
                              h
                              ∈
                              
                                 
                                    H
                                 
                                 
                                    j
                                 
                              
                              )
                              ,
                              
                              j
                              =
                              1
                              ,
                              …
                              ,
                              J
                           
                        
                     where 
                        
                           
                              
                                 g
                              
                              
                                 h
                              
                           
                           :
                           
                              
                                 R
                              
                              
                                 N
                              
                           
                           ×
                           Ω
                           →
                           R
                           
                           and
                           
                           
                              
                                 H
                              
                              
                                 j
                              
                           
                           ⊂
                           {
                           1
                           ,
                           …
                           ,
                           K
                           }
                        
                     . Individual probabilistic constraints, e.g. in definition (7) and in Kataoka (1963) and Telser (1955), correspond to H
                     
                        j
                      containing one element of {1,…,
                     K}, whereas the index set H
                     
                        j
                      in a joint probabilistic constraint contains more than one element; such constraints express a reliability requirement of a whole system. Probability levels v
                     
                        j
                     
                     ∈(0,1) are fixed, prescribed by regulations or chosen by the decision maker.

The set 
                        
                           X
                           (
                           P
                           )
                        
                      is typically nonconvex, sometimes even disconnected, and functions G
                     
                        j
                     (•,
                     P) need not be smooth. This is the reason why probabilistic programs have been recognized as hard optimization problems that are rather demanding from the computational point of view. The seminal results on convexity of 
                        
                           X
                           (
                           P
                           )
                        
                      were proved by Prékopa, cf. Prékopa (1971), under specific assumptions concerning both the function g and the probability distribution P. See Prékopa (2003) and Chapter 5 of Shapiro, Dentcheva, and Ruszczyński (2009) for details. A favorable class are, e.g. linear probabilistic constraints with Gaussian coefficients (van Ackooij, Henrion, Möller, & Zorgati, 2011) that appear in Kataoka (1963) and Telser (1955).

In practice, complete knowledge of P is rare; still the wish is to apply such solution of (8) which is reliable and robust even in situations when the true probability distribution P has been approximated or when it is known only partly. This gives a motivation for stability analysis of (8) with respect to perturbations of P. The probability distribution P plays a role of an abstract parameter and dependence of the set of feasible solutions on P complicates the stability considerations substantially. General stability results were proved by Römisch without any convexity assumptions; cf. Theorems 5 and 9 in Römisch (2003). They were detailed mainly for linear probabilistic programs with random right hand sides, which does not agree with the form of the considered risk constraints, and for generalized concave probability distributions, see, e.g. Römisch (2003) and Römisch and Schultz (1991). The main stumbling block for their application is the requirement of the metric regularity property, see, e.g. Chapter 2.3 of Bonnans and Shapiro (2000). For the first order stochastic dominance constraints stability and sensitivity analysis is even more involved; cf. Dentcheva, Henrion, and Ruszczyński (2007).

If ρ has a finitely discrete distribution
                     
                        
                           (11)
                           
                              P
                              (
                              ρ
                              =
                              
                                 
                                    ρ
                                 
                                 
                                    s
                                 
                              
                              )
                              =
                              
                                 
                                    p
                                 
                                 
                                    s
                                 
                              
                              ,
                              
                              s
                              =
                              1
                              ,
                              …
                              ,
                              S
                           
                        
                     with p
                     
                        s
                     
                     >0, the set 
                        
                           X
                        
                      in (9) is compact and functions g(•,
                     ρ
                     
                        s
                     ) are continuous for all s, then it is possible to rewrite problem (8)–(10) as a mixed integer program, see, e.g. Ruszczyński (2002). Consider only one probabilistic constraint, i.e. J
                     =1, H
                     1
                     ={1,…,
                     K}, and for each s
                     ∈{1,…,
                     S} introduce a binary variable z
                     
                        s
                      such that z
                     
                        s
                     
                     =0 guarantees that 
                        
                           g
                           (
                           x
                           ,
                           
                              
                                 ρ
                              
                              
                                 s
                              
                           
                           )
                           ⩽
                           0
                           
                           ∀
                           x
                           ∈
                           X
                        
                     , and a K-dimensional vector M
                     
                        s
                      whose components are sufficiently large. For a deterministic objective function G
                     0 the problem (8)–(10) can be written as
                        
                           (12)
                           
                              
                                 
                                    
                                    
                                       
                                          minimize
                                          
                                          
                                             
                                                G
                                             
                                             
                                                0
                                             
                                          
                                          (
                                          x
                                          )
                                          
                                          subject to
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          g
                                          (
                                          x
                                          ,
                                          
                                             
                                                ρ
                                             
                                             
                                                s
                                             
                                          
                                          )
                                          -
                                          
                                             
                                                M
                                             
                                             
                                                s
                                             
                                          
                                          
                                             
                                                z
                                             
                                             
                                                s
                                             
                                          
                                          ⩽
                                          0
                                          ,
                                          
                                          s
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          S
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (13)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                    
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    s
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    s
                                 
                              
                              ⩽
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              ,
                              x
                              ∈
                              X
                              ,
                              
                                 
                                    z
                                 
                                 
                                    s
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              
                              ∀
                              s
                              .
                           
                        
                     For convex functions G
                     0 and g
                     
                        h
                     (•,
                     ρ
                     
                        s
                     ) ∀h, s this is a large convex mixed integer program.

Sometimes, the wish may be to observe a stochastic ordering of outcomes. The concept of stochastic ordering was introduced in statistics already in the 1940s and is known under the name the first order stochastic dominance (FSD):
                        Definition 1
                        We say that a random variable ξ dominates a random variable ζ with respect to the first order stochastic dominance (ξ
                           ⪰
                           
                              FSD
                           
                           ζ) if
                              
                                 
                                    P
                                    (
                                    ξ
                                    ⩽
                                    y
                                    )
                                    ⩽
                                    P
                                    (
                                    ζ
                                    ⩽
                                    y
                                    )
                                    
                                    ∀
                                    y
                                    ∈
                                    R
                                    .
                                 
                              
                           
                        

In financial applications constraints based on the FSD allow us to incorporate random benchmarks (defined on the same probability space) instead of fixed thresholds. The FSD relation can be alternatively defined as follows:
                        
                           (i)
                           
                              ξ
                              ⪰
                              
                                 FSD
                              
                              ζ if and only if Eu(ξ)⩾Eu(ζ) for all nondecreasing utility functions u provided the expected values above are finite; see for example Chapter 3.2 in Levy (2006).


                              ξ
                              ⪰
                              
                                 FSD
                              
                              ζ if and only if 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ξ
                                       
                                       
                                          (
                                          -
                                          1
                                          )
                                       
                                    
                                    (
                                    y
                                    )
                                    ⩾
                                    
                                       
                                          F
                                       
                                       
                                          ζ
                                       
                                       
                                          (
                                          -
                                          1
                                          )
                                       
                                    
                                    (
                                    y
                                    )
                                 
                               for all y
                              ∈[0,1], or equivalently, if and only if VaR
                                 α
                              (−ξ)⩽ VaR
                                 α
                              (−ζ) for all α
                              ∈[0,1]; see, e.g. Ogryczak and Ruszczyński (2002).

Unfortunately, in both cases as well as in Definition 1, FSD constraints are expressed in general as a continuum of constraints; see Dentcheva et al. (2007) and Dentcheva and Ruszczyński (2004).

In the subsequent analysis of results under distributional uncertainty we shall follow, similarly as in Dupačová and Kopa (2012), the relatively simple ideas of output analysis based on the contamination technique initiated in Dupačová (1986) and Shapiro (1990). The considered special type of perturbations reduces the stability analysis of (8)–(10) to that for parametric programs with one-dimensional real parameter. At the same time, it gets on with needs for what-if-analysis or stress testing. As we shall see, it can be exploited also to study influence of changes in parameters in parametric models such as the Markowitz mean–variance model.

The contamination approach was initiated in mathematical statistics as one of tools for the analysis of robustness of estimators with respect to deviations from the assumed probability distribution and/or its parameters. Contamination means to model the perturbations of P by its contamination by another fixed probability distribution Q, i.e. to use P
                     
                        t
                     
                     ≔(1−
                     t)P
                     +
                     tQ, t
                     ∈[0,1]. It was developed and applied for program (8) with 
                        
                           X
                           (
                           P
                           )
                        
                      independent of P and for the expectation type objective G
                     0(x,P), cf. Dupačová (1996) and Dupačová (2006) and Dupačová, Bertocchi, and Moriggia (1998) and Dupačová and Polívka (2007), under assumption that the optimal value φ(t) is finite for all t
                     ∈[0,1] and the set of optimal solutions of the unperturbed program is compact. It proved to be a flexible tool which is suitable in various disparate situations: By contamination of discrete probability distributions one may model changes in scenario probabilities, scenario values and the impact of inclusion of additional, stress scenarios – the choice of a degenerated distribution Q concentrated in ρ
                     ∗
                     ∉
                     Ω corresponds to an additional scenario. See, e.g. Dupačová (1996) and Dupačová et al. (1998). The basic properties of the optimal value function are summarized in the following lemma.
                        Lemma 1
                        
                           Assume that 
                           
                              
                                 X
                                 (
                                 P
                                 )
                                 =
                                 X
                              
                            
                           is independent of P, the set of optimal solutions 
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       ∗
                                    
                                 
                                 (
                                 P
                                 )
                              
                            
                           of 
                           
                              (8)
                            
                           is nonempty and compact, the perturbed objective function G
                           
                              0
                           
                           (x,
                           
                           t)
                           ≔
                           G
                           
                              0
                           
                           (x,
                           
                           P
                           
                              t
                           
                           ) is a linear function of t and that its optimal value 
                           
                              
                                 φ
                                 (
                                 t
                                 )
                                 ≔
                                 
                                    
                                       min
                                    
                                    
                                       x
                                       ∈
                                       X
                                    
                                 
                                 
                                    
                                       G
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 x
                                 ,
                                 t
                                 )
                              
                            
                           is finite for all 0
                           ⩽
                           t
                           ⩽
                           1. Then φ(t) is a lower semicontinuous concave function on [0,
                           
                           1].
                        

Consult, e.g. Theorem 4.3.2 of Bank, Guddat, Klatte, Kummer, and Tammer (1982). This lemma allows us to construct global bounds for φ(t)
                        
                           (14)
                           
                              (
                              1
                              -
                              t
                              )
                              φ
                              (
                              0
                              )
                              +
                              t
                              φ
                              (
                              1
                              )
                              ⩽
                              φ
                              (
                              t
                              )
                              ⩽
                              φ
                              (
                              0
                              )
                              +
                              t
                              
                                 
                                    φ
                                 
                                 
                                    ′
                                 
                              
                              (
                              
                                 
                                    0
                                 
                                 
                                    +
                                 
                              
                              )
                              
                              ∀
                              t
                              ∈
                              [
                              0
                              ,
                              1
                              ]
                           
                        
                     valid for all 0⩽
                     t
                     ⩽1. The directional derivative
                        
                           (15)
                           
                              
                                 
                                    φ
                                 
                                 
                                    ′
                                 
                              
                              (
                              
                                 
                                    0
                                 
                                 
                                    +
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       min
                                    
                                    
                                       x
                                       ∈
                                       
                                          
                                             X
                                          
                                          
                                             ∗
                                          
                                       
                                       (
                                       P
                                       )
                                    
                                 
                              
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                              (
                              x
                              ,
                              Q
                              )
                              -
                              φ
                              (
                              P
                              )
                              .
                           
                        
                     
                  

In the presence of risk constraints the set of feasible solutions depends on P which means that the optimal value function is concave only exceptionally and the lower bound in (14) does not hold true.

The set of feasible solutions (9) for the contaminated probability distribution P
                     
                        t
                      equals
                        
                           (16)
                           
                              X
                              (
                              
                                 
                                    P
                                 
                                 
                                    t
                                 
                              
                              )
                              =
                              X
                              ∩
                              {
                              x
                              :
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                              
                              (
                              x
                              ,
                              
                                 
                                    P
                                 
                                 
                                    t
                                 
                              
                              )
                              ⩽
                              0
                              ,
                              
                              j
                              =
                              1
                              ,
                              …
                              ,
                              J
                              }
                              .
                           
                        
                     The probabilistic risk functions 
                        
                           R
                           (
                           x
                           ,
                           P
                           )
                        
                      in (10) are linear in P, hence, G
                     
                        j
                     (x,P
                     
                        t
                     )=(1−
                     t)G
                     
                        j
                     (x,
                     P)+
                     t G
                     
                        j
                     (x,
                     Q)≔
                     G
                     
                        j
                     (x,
                     t) ∀j are linear in t. We assume again that the perturbed objective function G
                     0(x,
                     t) is also linear in t. The perturbed problem (8) is then the linearly perturbed parametric program
                        
                           (17)
                           
                              
                                 
                                    
                                       min
                                    
                                    
                                       x
                                       ∈
                                       X
                                    
                                 
                              
                              
                              (
                              1
                              -
                              t
                              )
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                              (
                              x
                              ,
                              0
                              )
                              +
                              
                                 
                                    tG
                                 
                                 
                                    0
                                 
                              
                              (
                              x
                              ,
                              1
                              )
                           
                        
                     
                     
                        
                           (18)
                           
                              
                                 
                                    
                                    
                                       
                                          subject to
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          (
                                          1
                                          -
                                          t
                                          )
                                          
                                             
                                                G
                                             
                                             
                                                j
                                             
                                          
                                          (
                                          x
                                          ,
                                          0
                                          )
                                          +
                                          
                                             
                                                tG
                                             
                                             
                                                j
                                             
                                          
                                          (
                                          x
                                          ,
                                          1
                                          )
                                          ⩽
                                          0
                                          ,
                                          
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          J
                                          .
                                       
                                    
                                 
                              
                           
                        
                     We denote 
                        
                           X
                           (
                           t
                           )
                           ,
                           φ
                           (
                           t
                           )
                           ,
                           
                              
                                 X
                              
                              
                                 ∗
                              
                           
                           (
                           t
                           )
                        
                      the set of feasible solutions, the optimal value and the set of optimal solutions of (17) and (18). For 
                        
                           t
                           =
                           0
                           ,
                           X
                           (
                           0
                           )
                           ,
                           φ
                           (
                           0
                           )
                           ,
                           
                              
                                 X
                              
                              
                                 ∗
                              
                           
                           (
                           0
                           )
                        
                      denote the set of feasible solutions, the optimal value and the set of optimal solutions of the initial unperturbed problem.

For parameter dependent sets of feasible solutions the optimal value function φ(t) is concave only under rather strict assumptions such as G
                     
                        j
                     (x,t), j
                     =1,…,
                     J jointly concave on 
                        
                           X
                           ×
                           [
                           0
                           ,
                           1
                           ]
                        
                     ; cf. Corollary 3.2 of Kyparisis and Fiacco (1987). The form of (14) suggests that we should concentrate on the existence and form of the directional derivatives and on assumptions under which the sets 
                        
                           X
                           (
                           t
                           )
                        
                      remain fixed at least for small values of the contamination parameter t.

If the linear independence condition and the strict complementarity condition hold true at the optimal solution x
                     ∗(0) of the unperturbed convex problem, then for t
                     ⩽
                     t
                     0 small enough, the optimal value φ(t) is concave and a local upper bound can be constructed according to (14). The same statement can be obtained for nonconvex problems when also the second order sufficient condition is satisfied.
                        Theorem 1
                        
                           Let 
                           (8)–(10) 
                           be a twice differentiable program with probabilistic constraints, x
                           ∗
                           (P)
                           
                           =
                           
                           x
                           ∗
                           (0) its optimal solution. Assume that at x
                           ∗
                           (0) linear independence, the strict complementarity and the second order sufficient conditions are satisfied. Then there exists t
                           
                              0
                           
                           >
                           0 such that for all t
                           ∈
                           [0,
                           
                           t
                           
                              0
                           
                           ] the optimal value function φ(t) is concave and the local upper contamination bound is given by
                           
                              
                                 (19)
                                 
                                    φ
                                    (
                                    t
                                    )
                                    ⩽
                                    φ
                                    (
                                    0
                                    )
                                    +
                                    t
                                    
                                       
                                          φ
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    
                                       
                                          0
                                       
                                       
                                          +
                                       
                                    
                                    )
                                    
                                    ∀
                                    t
                                    ∈
                                    [
                                    0
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                    ]
                                    .
                                 
                              
                           
                        

We refer to Dupačová and Kopa (2012) for details and basic references.

There exist various formulas for directional derivative φ′(0+) based on the Lagrange function 
                        
                           L
                           (
                           x
                           ,
                           u
                           ,
                           t
                           )
                           =
                           
                              
                                 G
                              
                              
                                 0
                              
                           
                           (
                           x
                           ,
                           
                              
                                 P
                              
                              
                                 t
                              
                           
                           )
                           +
                           
                              
                                 ∑
                              
                              
                                 j
                              
                           
                           
                              
                                 u
                              
                              
                                 j
                              
                           
                           
                              
                                 G
                              
                              
                                 j
                              
                           
                           (
                           x
                           ,
                           
                              
                                 P
                              
                              
                                 t
                              
                           
                           )
                        
                      for the contaminated problem. The generic form is
                        
                           
                              
                                 
                                    φ
                                 
                                 
                                    ′
                                 
                              
                              (
                              
                                 
                                    0
                                 
                                 
                                    +
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       min
                                    
                                    
                                       x
                                       ∈
                                       
                                          
                                             X
                                          
                                          
                                             ∗
                                          
                                       
                                       (
                                       0
                                       )
                                    
                                 
                              
                              
                                 
                                    
                                       max
                                    
                                    
                                       u
                                       ∈
                                       
                                          
                                             U
                                          
                                          
                                             ∗
                                          
                                       
                                       (
                                       x
                                       ,
                                       0
                                       )
                                    
                                 
                              
                              
                                 
                                    ∂
                                 
                                 
                                    ∂
                                    t
                                 
                              
                              L
                              (
                              x
                              ,
                              u
                              ,
                              0
                              )
                           
                        
                     where 
                        
                           
                              
                                 U
                              
                              
                                 ∗
                              
                           
                           (
                           x
                           ,
                           0
                           )
                        
                      denotes the set of Lagrange multipliers coupled with the optimal solution 
                        
                           x
                           ∈
                           
                              
                                 X
                              
                              
                                 ∗
                              
                           
                           (
                           0
                           )
                        
                      of the unperturbed problem. For convex unperturbed programs with unique optimal solution x
                     ∗(0), multipliers u
                     ∗(0) and for L(x,
                     u,
                     t) linear in t it simplifies to
                        
                           (20)
                           
                              
                                 
                                    φ
                                 
                                 
                                    ′
                                 
                              
                              (
                              
                                 
                                    0
                                 
                                 
                                    +
                                 
                              
                              )
                              =
                              L
                              (
                              
                                 
                                    x
                                 
                                 
                                    ∗
                                 
                              
                              (
                              0
                              )
                              ,
                              
                                 
                                    u
                                 
                                 
                                    ∗
                                 
                              
                              (
                              0
                              )
                              ,
                              1
                              )
                              -
                              φ
                              (
                              0
                              )
                              .
                           
                        
                     Derivations of relevant formulas proceed in accordance with the assumed properties of problem (17) and (18); consult Section 4.3.2 of Bonnans and Shapiro (2000).

For the accepted structure of perturbations the lower bound for the optimal value function of (17) and (18) is based on Theorem 1 of Dupačová and Kopa (2012):
                        Theorem 2
                        
                           Dupačová and Kopa (2012)
                        


                        .Assume that in 
                           
                              (17) and (18)
                            
                           
                              
                                 X
                                 ⊂
                                 
                                    
                                       R
                                    
                                    
                                       N
                                    
                                 
                              
                            
                           is a nonempty convex set, G
                           
                              0
                           
                           (x) is independent of t, G(x,
                           
                           t) is a concave function of t
                           ∈
                           [0,
                           
                           1] and φ(t) is finite for all t
                           ∈
                           [0,
                           
                           1]. Then the optimal value function
                           
                              
                                 
                                    φ
                                    (
                                    t
                                    )
                                    ≔
                                    
                                       
                                          
                                             min
                                          
                                          
                                             x
                                             ∈
                                             X
                                          
                                       
                                    
                                    
                                    
                                       
                                          G
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    x
                                    )
                                    
                                    subject to
                                    
                                    G
                                    (
                                    x
                                    ,
                                    t
                                    )
                                    ⩽
                                    0
                                 
                              
                           
                           is quasi-concave on [0,
                           
                           1] with the lower bound
                           
                              
                                 (21)
                                 
                                    φ
                                    (
                                    t
                                    )
                                    ⩾
                                    
                                       min
                                    
                                    {
                                    φ
                                    (
                                    1
                                    )
                                    ,
                                    φ
                                    (
                                    0
                                    )
                                    }
                                    .
                                 
                              
                           
                        


                     Theorem 2 directly applies if there is only one probabilistic risk constraint and the objective function G
                     0 does not depend on P. However, the result can be extended to objective functions G
                     0(x,
                     P) which are concave in P:
                        
                           (22)
                           
                              φ
                              (
                              t
                              )
                              =
                              
                                 
                                    
                                       min
                                    
                                    
                                       x
                                       ∈
                                       X
                                       (
                                       t
                                       )
                                    
                                 
                              
                              
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                              (
                              x
                              ,
                              t
                              )
                              ⩾
                              
                                 
                                    
                                       min
                                    
                                    
                                       x
                                       ∈
                                       X
                                       (
                                       t
                                       )
                                    
                                 
                              
                              [
                              (
                              1
                              -
                              t
                              )
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                              (
                              x
                              ,
                              0
                              )
                              +
                              
                                 
                                    tG
                                 
                                 
                                    0
                                 
                              
                              (
                              x
                              ,
                              1
                              )
                              ]
                              ⩾
                              (
                              1
                              -
                              t
                              )
                              
                                 min
                              
                              
                                 
                                    
                                       φ
                                       (
                                       0
                                       )
                                       ,
                                       
                                          
                                             
                                                min
                                             
                                             
                                                X
                                                (
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          
                                             G
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       x
                                       ,
                                       0
                                       )
                                    
                                 
                              
                              +
                              t
                              
                                 min
                              
                              
                                 
                                    
                                       φ
                                       (
                                       1
                                       )
                                       ,
                                       
                                          
                                             
                                                min
                                             
                                             
                                                X
                                                (
                                                0
                                                )
                                             
                                          
                                       
                                       
                                          
                                             G
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       x
                                       ,
                                       1
                                       )
                                    
                                 
                              
                              ,
                           
                        
                     and also to multiple probabilistic risk constraints.


                     Multiple probabilistic risk constraints in (9) can be reformulated as G(x,
                     P)≔max
                        j
                     
                     G
                     
                        j
                     (x,
                     P)⩽0, but then the function G(x,
                     P) is convex in P. As the probabilistic risk constraints are linear in P, G(x,
                     t)≔max
                        j
                     
                     G
                     
                        j
                     (x, P
                     
                        t
                     ) is a convex piecewise linear function of t. It means that there exists 
                        
                           
                              
                                 t
                              
                              
                                 ̃
                              
                           
                           >
                           0
                        
                      such that G(x,
                     t) is a linear function of t on 
                        
                           [
                           0
                           ,
                           
                              
                                 t
                              
                              
                                 ̃
                              
                           
                           ]
                        
                      and we get the local lower bound 
                        
                           φ
                           (
                           t
                           )
                           ⩾
                           min
                           {
                           φ
                           (
                           0
                           )
                           ,
                           φ
                           (
                           
                              
                                 t
                              
                              
                                 ̃
                              
                           
                           )
                           }
                        
                      valid for 
                        
                           t
                           ∈
                           [
                           0
                           ,
                           
                              
                                 t
                              
                              
                                 ̃
                              
                           
                           ]
                        
                     . Notice that no convexity assumption with respect to x was required.

Similarly as in Dupačová and Kopa (2012), trivial upper bounds for φ(t) are available without any differentiability assumption if no constraint is active at x
                     ∗(0) or if for all constraints active at x
                     ∗(0), i.e. G
                     
                        j
                     (x
                     ∗(0),0)=0,j
                     ∈
                     J
                     0, inequalities G
                     
                        j
                     (x
                     ∗(0),1) ⩽0,j
                     ∈
                     J
                     0 hold true. Then for t small enough, x
                     ∗(0) is a feasible solution of (18), hence G
                     0(x
                     ∗(0),t)⩾
                     φ(t) for t small enough. Using linearity of G
                     0 with respect to t,
                        
                           
                              φ
                              (
                              t
                              )
                              ⩽
                              φ
                              (
                              0
                              )
                              +
                              t
                              (
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    ∗
                                 
                              
                              (
                              0
                              )
                              ,
                              1
                              )
                              -
                              φ
                              (
                              0
                              )
                              )
                              ;
                           
                        
                     compare with (14) and (15).

An upper bound for φ(t) can be also constructed whenever there is at disposal a feasible solution 
                        
                           x
                           ∈
                           X
                           (
                           
                              
                                 P
                              
                              
                                 t
                              
                           
                           )
                        
                     . This may occur due to the structure of the solved problem, e.g. for the FSD portfolio efficiency tests (see Section 4.2) where there is a particular 
                        
                           x
                           ∈
                           X
                           (
                           
                              
                                 P
                              
                              
                                 t
                              
                           
                           )
                           
                           ∀
                           t
                        
                     . Feasibility of x
                     ∗(1) for the unperturbed problem is another possibility. Even though the existence of such feasible direction can be proved under various assumptions, it is not easy in general to construct it. A direct search for 
                        
                           
                              
                                 x
                              
                              
                                 ˆ
                              
                           
                           ∈
                           X
                        
                      which satisfies constraints
                        
                           
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                              
                              (
                              x
                              ,
                              0
                              )
                              ⩽
                              0
                              
                              ∀
                              j
                              
                              and
                              
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                              
                              (
                              x
                              ,
                              1
                              )
                              ⩽
                              0
                              ∀
                              j
                           
                        
                     is manageable, namely, when 
                        
                           Q
                           =
                           
                              
                                 δ
                              
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                        
                      is a degenerated probability distribution. Using it means to augment 
                        
                           X
                        
                      by deterministic constraints g
                     
                        h
                     (x,
                     ρ
                     ∗)⩽0, h
                     ∈
                     H
                     
                        j
                     , j
                     =1,…,
                     J. Moreover, for problems with one joint probabilistic constraint one may solve
                        
                           
                              
                                 
                                    
                                       min
                                    
                                    
                                       x
                                       ∈
                                       X
                                    
                                 
                              
                              
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              (
                              x
                              ,
                              1
                              )
                              
                              subject to
                              
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              (
                              x
                              ,
                              0
                              )
                              ⩽
                              0
                              .
                           
                        
                     
                  

Assume that the covariance matrix Σ in (1) is a positive definite matrix, the set 
                           
                              X
                           
                         a nonempty convex polyhedron with nondegenerated vertices, λ
                        ⩾0 a chosen parameter. Under these assumptions, there is a unique optimal solution x
                        ∗(μ,
                        Σ;
                        λ) of (1).

To stress the parameter values in the Markowitz model we shall exploit the contamination technique with the local upper bound obtained according to Theorem 1. The application of its basic form to (1) is straightforward, with a selected parameter perturbation 
                           
                              
                                 
                                    μ
                                 
                                 
                                    t
                                 
                              
                              =
                              (
                              1
                              -
                              t
                              )
                              μ
                              +
                              t
                              
                                 
                                    μ
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    Σ
                                 
                                 
                                    t
                                 
                              
                              =
                              (
                              1
                              -
                              t
                              )
                              Σ
                              +
                              t
                              
                                 
                                    Σ
                                 
                                 
                                    ^
                                 
                              
                           
                         to be tested for 0⩽
                        t
                        ⩽1. The basic approach extends also to (2) or (3) when a known expected return μ or a fixed covariance matrix Σ are assumed.

To stress separately correlations one can exploit the suggestion of Kupiec (2002): The covariance matrix can be written as Σ
                        =
                        DCD with the diagonal matrix D of “volatilities” (standard deviations of the marginal distributions) and the correlation matrix C.

Changes in the covariances may be then modeled by “stressing” the correlation matrix C by a positive semidefinite stress correlation matrix 
                        
                           
                              
                                 
                                    C
                                 
                                 
                                    ^
                                 
                              
                           
                        
                        
                           
                              (23)
                              
                                 C
                                 (
                                 γ
                                 )
                                 =
                                 (
                                 1
                                 -
                                 γ
                                 )
                                 C
                                 +
                                 γ
                                 
                                    
                                       C
                                    
                                    
                                       ^
                                    
                                 
                              
                           
                        with parameter γ
                        ∈[0,1]. This type of perturbation of the initial quadratic program allows us again to apply the related parametric stability results to the perturbed problem (2)
                        
                           
                              (24)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          x
                                          ∈
                                          X
                                       
                                    
                                 
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ⊤
                                    
                                 
                                 DC
                                 (
                                 γ
                                 )
                                 Dx
                                 ,
                                 
                                 γ
                                 ∈
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           
                        with the constraint μ
                        ⊤
                        x
                        ⩾
                        k incorporated into the definition of 
                           
                              X
                           
                        .

Under the above assumptions, the optimal value φ(γ) of (24) is concave and continuous in γ
                        ∈[0,1]. The directional derivative is of the form (15)
                        
                           
                              
                                 
                                    
                                       φ
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       0
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       (
                                       0
                                       )
                                    
                                    
                                       ⊤
                                    
                                 
                                 D
                                 
                                    
                                       C
                                    
                                    
                                       ^
                                    
                                 
                                 
                                    
                                       Dx
                                    
                                    
                                       ∗
                                    
                                 
                                 (
                                 0
                                 )
                                 -
                                 φ
                                 (
                                 0
                                 )
                              
                           
                        and contamination bounds (14) have the form
                           
                              
                                 (
                                 1
                                 -
                                 γ
                                 )
                                 
                                    
                                       x
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       (
                                       0
                                       )
                                    
                                    
                                       ⊤
                                    
                                 
                                 
                                    
                                       DCDx
                                    
                                    
                                       ∗
                                    
                                 
                                 (
                                 0
                                 )
                                 +
                                 γ
                                 
                                    
                                       x
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       (
                                       1
                                       )
                                    
                                    
                                       ⊤
                                    
                                 
                                 D
                                 
                                    
                                       C
                                    
                                    
                                       ˆ
                                    
                                 
                                 
                                    
                                       Dx
                                    
                                    
                                       ∗
                                    
                                 
                                 (
                                 1
                                 )
                                 ⩽
                                 
                                    
                                       
                                          min
                                       
                                       
                                          x
                                          ∈
                                          X
                                       
                                    
                                 
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ⊤
                                    
                                 
                                 DC
                                 (
                                 γ
                                 )
                                 Dx
                                 ⩽
                                 (
                                 1
                                 -
                                 γ
                                 )
                                 
                                    
                                       x
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       (
                                       0
                                       )
                                    
                                    
                                       ⊤
                                    
                                 
                                 
                                    
                                       DCDx
                                    
                                    
                                       ∗
                                    
                                 
                                 (
                                 0
                                 )
                                 +
                                 γ
                                 
                                    
                                       x
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       (
                                       0
                                       )
                                    
                                    
                                       ⊤
                                    
                                 
                                 D
                                 
                                    
                                       C
                                    
                                    
                                       ^
                                    
                                 
                                 
                                    
                                       Dx
                                    
                                    
                                       ∗
                                    
                                 
                                 (
                                 0
                                 )
                                 .
                              
                           
                        
                     

They quantify the effect of the considered change in the input data on the optimal value φ(γ) of portfolio. See Dupačová and Polívka (2007) for additional results. In a similar way, one can quantify the influence of stressing parameters μ, C or μ, Σ in (1).
                           Example 1
                           For a numerical illustration consider a standard set of ten active benchmark stock portfolios that are formed, and annually rebalanced, based on individual stocks’ market capitalization of equity, each representing a decile of the cross-section of stocks in a given year. Furthermore, we use the one-month US Treasury bill as a riskless asset. Historical data on monthly value-weighted returns (month-end to month-end) from May 2005 to August 2008 obtained from Kenneth French’ data library serve as the original discrete distribution P taking all S
                              =40 scenarios with the same probabilities. The alternative distribution Q is given by 40 equiprobable scenarios from the crises period (September 2008–December 2011). We will apply the contamination bounds (22) and (19) to Markowitz problem (3) rewritten in the minimizing form:
                                 
                                    (25)
                                    
                                       
                                          
                                             
                                                min
                                             
                                             
                                                x
                                                ∈
                                                X
                                             
                                          
                                       
                                       -
                                       
                                          
                                             μ
                                          
                                          
                                             ⊤
                                          
                                       
                                       x
                                       
                                       subject to
                                       
                                       
                                          
                                             x
                                          
                                          
                                             ⊤
                                          
                                       
                                       Σ
                                       x
                                       ⩽
                                       v
                                    
                                 
                              where short sales are not allowed, that is, 
                                 
                                    X
                                    =
                                    
                                       
                                          
                                             x
                                             ∈
                                             
                                                
                                                   R
                                                
                                                
                                                   N
                                                
                                             
                                             :
                                             
                                                
                                                   ∑
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   n
                                                
                                             
                                             =
                                             1
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   n
                                                
                                             
                                             ⩾
                                             0
                                             ,
                                             n
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             N
                                          
                                       
                                    
                                 
                              . Parameters μ and Σ are estimated from the data for May 2005–August 2008 and v
                              =0.001. Let us contamine μ and the covariance matrix Σ (instead of the correlation matrix C considered in the theoretical part of this section) by 
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          ^
                                       
                                    
                                 
                               estimated from the crisis period data. The global lower bound (22) can be easily calculated solving the four optimization problems. The construction of upper bound (19) exploits (20) and it is generally valid only for sufficiently small t; however, in this Markowitz model the upper bound holds true for all t
                              ∈[0,1], see Fig. 1
                              .

The situation changes substantially when Value at Risk (7) is used in (25) instead of x
                              ⊤
                              Σx.

Let us consider the same assets and distributions of returns as in Example 1 but use a different risk measure-Value at Risk (7). Again, we formulate a minimizing expected loss problem:
                                 
                                    (26)
                                    
                                       
                                          
                                             
                                                min
                                             
                                             
                                                x
                                                ∈
                                                X
                                             
                                          
                                       
                                       -
                                       
                                          
                                             μ
                                          
                                          
                                             ⊤
                                          
                                       
                                       x
                                       
                                       subject to
                                       
                                       
                                          
                                             VaR
                                          
                                          
                                             α
                                          
                                       
                                       (
                                       -
                                       
                                          
                                             ρ
                                          
                                          
                                             ⊤
                                          
                                       
                                       x
                                       )
                                       ⩽
                                       v
                                    
                                 
                              for v
                              =0.02. Using the “big M” idea (12) and (13) it turns to the following mixed integer program:
                                 
                                    (27)
                                    
                                       
                                          
                                             
                                                min
                                             
                                             
                                                x
                                                ∈
                                                X
                                             
                                          
                                       
                                       -
                                       
                                          
                                             μ
                                          
                                          
                                             ⊤
                                          
                                       
                                       x
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                                
                                                   subject to
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               ρ
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   x
                                                   -
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   ⩽
                                                   v
                                                   ,
                                                   
                                                   s
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   S
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   ⩽
                                                   1
                                                   -
                                                   α
                                                   ,
                                                   
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   ∈
                                                   {
                                                   0
                                                   ,
                                                   1
                                                   }
                                                   ,
                                                   
                                                   s
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   S
                                                
                                             
                                          
                                       
                                    
                                 
                              where p
                              
                                 s
                              
                              =0.025 and the coefficients M
                              
                                 s
                               are sufficiently large numbers for all s. The contaminated distribution of ρ is carried now by the 80 scenarios, hence (27) gets extended for additional scenarios. First we choose α
                              =0.97 and Fig. 2
                               shows that the minimal mean loss is not continuous and it coincides with lower bound (22) for t
                              ⩽0.028. Moreover, x
                              ∗(t)=
                              x
                              ∗(0) is the optimal solution for t
                              ⩽0.028 what allows us to construct a trivial local upper bound 
                                 
                                    -
                                    
                                       
                                          μ
                                       
                                       
                                          t
                                       
                                       
                                          ⊤
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          ∗
                                       
                                    
                                    (
                                    0
                                    )
                                 
                              . It coincides with the minimal mean loss for t
                              ⩽0.028, however, it is no more valid for t
                              >0.028.

Finally, we consider α
                              =0.95; now, one of cumulative probabilities is equal to α. Contrary to the previous case, the minimal mean loss is not right continuous in 0, see Fig. 3
                              . This is due to the fact that the strict complementarity condition in the unperturbed problem is not fulfilled and x
                              ∗(0) is not a feasible solution for any contaminated problem. Therefore, in this case, the local upper bound (19) is not applicable.

In this section, we shall study robustness of portfolio efficiency tests with respect to the first order stochastic dominance relation. Consider N assets and a random vector of their returns ϱ. A decision maker may combine assets into portfolios and all portfolio possibilities are given by
                        
                           
                              X
                              =
                              
                                 
                                    
                                       x
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             N
                                          
                                       
                                       :
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             n
                                          
                                       
                                       =
                                       1
                                       ,
                                       
                                       
                                          
                                             x
                                          
                                          
                                             n
                                          
                                       
                                       ⩾
                                       0
                                       ,
                                       
                                       n
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       N
                                    
                                 
                              
                              .
                           
                        
                     Let 
                        
                           
                              
                                 F
                              
                              
                                 
                                    
                                       ϱ
                                    
                                    
                                       ⊤
                                    
                                 
                                 x
                              
                           
                           (
                           y
                           )
                        
                      denote the cumulative probability distribution function of returns of portfolio x. In the context of FSD portfolio efficiency, following Kopa and Post (2009); Kuosmanen (2004) and contrary to Definition 1, we define the first order stochastic dominance relation between portfolios in the strict form.
                        Definition 2
                        Portfolio 
                              
                                 x
                                 ∈
                                 X
                              
                            dominates portfolio 
                              
                                 τ
                                 ∈
                                 X
                              
                            by the first order stochastic dominance (ϱ
                           ⊤
                           x
                           ≻
                           
                              FSD
                           
                           ϱ
                           ⊤
                           τ) if and only if
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          
                                             
                                                ϱ
                                             
                                             
                                                ⊤
                                             
                                          
                                          x
                                       
                                    
                                    (
                                    y
                                    )
                                    ⩽
                                    
                                       
                                          F
                                       
                                       
                                          
                                             
                                                ϱ
                                             
                                             
                                                ⊤
                                             
                                          
                                          τ
                                       
                                    
                                    (
                                    y
                                    )
                                    
                                    ∀
                                    y
                                    ∈
                                    R
                                 
                              
                           with strict inequality for at least one 
                              
                                 y
                                 ∈
                                 R
                              
                           .

Alternatively, ϱ
                     ⊤
                     x
                     ≻
                     
                        FSD
                     
                     ϱ
                     ⊤
                     τ iff
                        
                           (28)
                           
                              
                                 
                                    H
                                 
                                 
                                    ϱ
                                 
                              
                              (
                              x
                              ,
                              τ
                              )
                              ≔
                              
                                 
                                    
                                       max
                                    
                                    
                                       y
                                       ∈
                                       R
                                    
                                 
                              
                              (
                              
                                 
                                    F
                                 
                                 
                                    
                                       
                                          ϱ
                                       
                                       
                                          ⊤
                                       
                                    
                                    x
                                 
                              
                              (
                              y
                              )
                              -
                              
                                 
                                    F
                                 
                                 
                                    
                                       
                                          ϱ
                                       
                                       
                                          ⊤
                                       
                                    
                                    τ
                                 
                              
                              (
                              y
                              )
                              )
                              ⩽
                              0
                           
                        
                     
                     
                        
                           (29)
                           
                              
                                 
                                    h
                                 
                                 
                                    ϱ
                                 
                              
                              (
                              x
                              ,
                              τ
                              )
                              ≔
                              
                                 
                                    
                                       min
                                    
                                    
                                       y
                                       ∈
                                       R
                                    
                                 
                              
                              (
                              
                                 
                                    F
                                 
                                 
                                    
                                       
                                          ϱ
                                       
                                       
                                          ⊤
                                       
                                    
                                    x
                                 
                              
                              (
                              y
                              )
                              -
                              
                                 
                                    F
                                 
                                 
                                    
                                       
                                          ϱ
                                       
                                       
                                          ⊤
                                       
                                    
                                    τ
                                 
                              
                              (
                              y
                              )
                              )
                              <
                              0
                              .
                           
                        
                     
                     
                        Definition 3
                        A given portfolio 
                              
                                 τ
                                 ∈
                                 X
                              
                            is FSD inefficient if there exists portfolio 
                              
                                 x
                                 ∈
                                 X
                              
                            such that ϱ
                           ⊤
                           x
                           ≻
                           
                              FSD
                           
                           ϱ
                           ⊤
                           τ. Otherwise, portfolio τ is FSD efficient.

This definition classifies portfolio 
                        
                           τ
                           ∈
                           X
                        
                      as FSD efficient if and only if no other portfolio is better (in the sense of the FSD relation) for all non-satiated decision makers. Following Kuosmanen (2004), Definition 3 formulates FSD efficiency in the sense of ”FSD admissibility”. Another definition of FSD efficiency, called “FSD optimality”, was introduced in Kopa and Post (2009). Alternatively, one may also employ a notion of almost stochastic dominance, cf. Levy (2009) and Lizyayev and Ruszczyński (2012). In this paper we focus on efficiency approach based on Definition 3.

In order to find a FSD dominating portfolio x, using (28) and (29), we may solve the following problem:
                        
                           (30)
                           
                              
                                 
                                    ξ
                                 
                                 
                                    ϱ
                                 
                              
                              (
                              τ
                              )
                              =
                              
                                 
                                    
                                       min
                                    
                                    
                                       x
                                    
                                 
                              
                              
                              
                                 
                                    h
                                 
                                 
                                    ϱ
                                 
                              
                              (
                              x
                              ,
                              τ
                              )
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                    
                                       
                                          s.t.
                                          
                                          
                                             
                                                H
                                             
                                             
                                                ϱ
                                             
                                          
                                          (
                                          x
                                          ,
                                          τ
                                          )
                                          ⩽
                                          0
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          x
                                          ∈
                                          X
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        Theorem 3
                        
                           A given portfolio τ is FSD efficient if and only if ξ
                           
                              ϱ
                           
                           (τ)
                           
                           =
                           
                           0. If ξ
                           
                              ϱ
                           
                           (τ)
                           <
                           0 then the optimal portfolio x
                           ∗ 
                           of 
                           
                              (30)
                            
                           dominates portfolio τ by FSD.
                        

If ξ
                           
                              ϱ
                           (τ)=0 then no FSD dominating portfolio exists. On the other hand, if ξ
                           
                              ϱ
                           (τ)<0 than the optimal solution x
                           ∗ of (30) FSD dominates τ.□

Since all existing portfolio efficiency tests have been derived for a discrete probability distribution P of returns we assume that ϱ takes S values 
                           
                              
                                 
                                    r
                                 
                                 
                                    s
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                          
                                             s
                                          
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             2
                                          
                                          
                                             s
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             N
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                              
                           
                        , called scenarios, with probabilities p
                        1,
                        p
                        2,…,
                        p
                        
                           S
                        . Contrary to the former tests, cf. Kopa and Post (2009) and Kuosmanen (2004), we do not assume equiprobable scenarios. Again, the scenarios are collected in the matrix
                           
                              
                                 R
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         S
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

For any portfolio 
                           
                              x
                              ∈
                              X
                           
                        , let (−Rx)[k] be the kth smallest element of (−Rx), i.e. (−R x)[1]
                        ⩽(−Rx)[2]
                        ⩽⋯⩽(−Rx)[S] and let I(x) be a permutation of the index set {1,2,…,
                        S} such that for all i(x)∈
                        I(x): −r
                        
                           i(x)
                        x
                        =(−Rx)[i]. Accordingly, we can order the corresponding probabilities and we denote 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                                 
                                    x
                                 
                              
                              =
                              
                                 
                                    p
                                 
                                 
                                    i
                                    (
                                    x
                                    )
                                 
                              
                           
                        . Hence, 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                                 
                                    x
                                 
                              
                              =
                              P
                              (
                              -
                              ϱ
                              x
                              =
                              
                                 
                                    (
                                    -
                                    Rx
                                    )
                                 
                                 
                                    [
                                    i
                                    ]
                                 
                              
                              )
                           
                        . Moreover, we consider cumulative probabilities: 
                           
                              
                                 
                                    q
                                 
                                 
                                    s
                                 
                                 
                                    x
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    s
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                                 
                                    x
                                 
                              
                           
                         and define 
                           
                              
                                 
                                    q
                                 
                                 
                                    0
                                 
                                 
                                    x
                                 
                              
                              =
                              0
                           
                        . The same notation is applied for the tested portfolio τ
                        =(τ
                        1,
                        τ
                        2,…,
                        τ
                        
                           N
                        )⊤.

As in Ogryczak and Ruszczyński (2002), we express the FSD relation using Value at Risk (VaR) that is defined for 
                           
                              α
                              ∈
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      s
                                                      -
                                                      1
                                                   
                                                   
                                                      x
                                                   
                                                
                                                ,
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      s
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                              s
                              =
                              1
                              ,
                              …
                              ,
                              S
                           
                         as:
                           
                              (31)
                              
                                 
                                    
                                       VaR
                                    
                                    
                                       α
                                    
                                 
                                 (
                                 -
                                 
                                    
                                       ϱ
                                    
                                    
                                       ⊤
                                    
                                 
                                 x
                                 )
                                 =
                                 
                                    
                                       (
                                       -
                                       Rx
                                       )
                                    
                                    
                                       [
                                       s
                                       ]
                                    
                                 
                                 .
                              
                           
                        
                        
                           Lemma 2
                           
                              Let 
                              
                                 
                                    x
                                    ,
                                    τ
                                    ∈
                                    X
                                 
                              
                              . Then ϱ
                              ⊤
                              x
                              ≻
                              
                                 FSD
                              
                              ϱ
                              ⊤
                              τ if and only if
                              
                                 
                                    (32)
                                    
                                       
                                          
                                             VaR
                                          
                                          
                                             α
                                          
                                       
                                       (
                                       -
                                       
                                          
                                             ϱ
                                          
                                          
                                             ⊤
                                          
                                       
                                       x
                                       )
                                       ⩽
                                       
                                          
                                             VaR
                                          
                                          
                                             α
                                          
                                       
                                       (
                                       -
                                       
                                          
                                             ϱ
                                          
                                          
                                             ⊤
                                          
                                       
                                       τ
                                       )
                                       
                                       for
                                       
                                       all
                                       
                                       α
                                       ∈
                                       (
                                       0
                                       ,
                                       1
                                       ]
                                    
                                 
                              
                              with a strict inequality for at least one α.
                           

Since we limit our attention to a discrete probability distribution of returns, the inequality between VaRs need not be verified in all 
                           
                              α
                              ∈
                              (
                              0
                              ,
                              1
                              ]
                           
                        , but only in at most S particular points.
                           Theorem 4
                           
                              A portfolio x dominates portfolio τ with respect to FSD (ϱ
                              ⊤
                              x
                              ≻
                              
                                 FSD
                              
                              ϱ
                              ⊤
                              τ) if and only if 
                              
                                 
                                    
                                       
                                          VaR
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                s
                                             
                                             
                                                τ
                                             
                                          
                                       
                                    
                                    (
                                    -
                                    
                                       
                                          ϱ
                                       
                                       
                                          ⊤
                                       
                                    
                                    x
                                    )
                                    ⩽
                                    
                                       
                                          VaR
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                s
                                             
                                             
                                                τ
                                             
                                          
                                       
                                    
                                    (
                                    -
                                    
                                       
                                          ϱ
                                       
                                       
                                          ⊤
                                       
                                    
                                    τ
                                    )
                                 
                               
                              for all s
                              
                              =
                              
                              1,
                              
                              2,
                              …
                              ,
                              
                              S with a strict inequality for at least one 
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          s
                                       
                                       
                                          τ
                                       
                                    
                                 
                              
                              .
                           

Functions VaR
                                 α
                              (−ϱ
                              ⊤
                              x) and VaR
                                 α
                              (−ϱ
                              ⊤
                              τ) are piece-wise constant in α with jumps in 
                                 
                                    α
                                    =
                                    
                                       
                                          q
                                       
                                       
                                          s
                                       
                                       
                                          x
                                       
                                    
                                 
                              , respectively in 
                                 
                                    α
                                    =
                                    
                                       
                                          q
                                       
                                       
                                          s
                                       
                                       
                                          τ
                                       
                                    
                                    ,
                                    s
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    S
                                 
                              , see (31). Therefore Lemma 2 directly implies the theorem.□

Inspired by Dupačová and Kopa (2012) we consider the following measure:
                           
                              (33)
                              
                                 ξ
                                 (
                                 τ
                                 ,
                                 R
                                 ,
                                 p
                                 )
                                 =
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                b
                                             
                                             
                                                s
                                             
                                          
                                          ,
                                          x
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          s
                                          =
                                          1
                                       
                                       
                                          S
                                       
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       s
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             s.t.
                                             
                                             
                                                
                                                   VaR
                                                
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         s
                                                      
                                                      
                                                         τ
                                                      
                                                   
                                                
                                             
                                             (
                                             -
                                             
                                                
                                                   ϱ
                                                
                                                
                                                   ⊤
                                                
                                             
                                             x
                                             )
                                             -
                                             
                                                
                                                   VaR
                                                
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         s
                                                      
                                                      
                                                         τ
                                                      
                                                   
                                                
                                             
                                             (
                                             -
                                             
                                                
                                                   ϱ
                                                
                                                
                                                   ⊤
                                                
                                             
                                             τ
                                             )
                                             ⩽
                                             
                                                
                                                   b
                                                
                                                
                                                   s
                                                
                                             
                                             ,
                                             
                                             s
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             S
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   b
                                                
                                                
                                                   s
                                                
                                             
                                             ⩽
                                             0
                                             ,
                                             
                                             s
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             S
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             x
                                             ∈
                                             X
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The objective function of (33) represents the sum of differences between VaRs of a portfolio x and VaRs of the tested portfolio τ. The differences are considered in points 
                           
                              
                                 
                                    q
                                 
                                 
                                    s
                                 
                                 
                                    τ
                                 
                              
                              ,
                              s
                              =
                              1
                              ,
                              …
                              ,
                              S
                           
                        . According to Theorem 4, the other points need not be taken into account. All differences must be non-positive and at least one negative to guarantee that portfolio x dominates portfolio τ. Moreover, minimizing these differences, we find portfolio x
                        ∗ that cannot be dominated by any other one. On the other hand, if no dominating portfolio exists, that is, portfolio τ is FSD efficient, then ξ(τ, R, p)=0 because the only feasible solutions of (33) are τ and portfolios 
                           
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                           
                         satisfying 
                           
                              R
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                              =
                              R
                              τ
                           
                        . Summarizing, Theorems 3 and 4 imply the following necessary and sufficient FSD portfolio efficiency test:
                           Theorem 5
                           
                              A given portfolio τ is FSD efficient if and only if ξ(τ,
                              
                              R,
                              
                              p)
                              
                              =
                              
                              0. If ξ(τ,R,p)
                              <
                              0 then the optimal portfolio x
                              ∗ 
                              in 
                              
                                 (33)
                               
                              is FSD efficient and it dominates portfolio τ by FSD.
                           

Consider a contamination of the original distribution of returns by an additional scenario 
                           
                              
                                 
                                    r
                                 
                                 
                                    ̃
                                 
                              
                              =
                              (
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    N
                                 
                              
                              )
                              :
                              ϱ
                              (
                              t
                              )
                              =
                              (
                              1
                              -
                              t
                              )
                              ϱ
                              +
                              t
                              
                                 
                                    δ
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ̃
                                       
                                    
                                 
                              
                              ,
                              t
                              ∈
                              [
                              0
                              ,
                              1
                              ]
                           
                        . Similarly to (30) we examine the problem
                           
                              (34)
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       ϱ
                                       (
                                       t
                                       )
                                    
                                 
                                 (
                                 τ
                                 )
                                 =
                                 
                                    
                                       
                                          min
                                       
                                       
                                          x
                                       
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       ϱ
                                       (
                                       t
                                       )
                                    
                                 
                                 (
                                 x
                                 ,
                                 τ
                                 )
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             s.t.
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   ϱ
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             (
                                             x
                                             ,
                                             τ
                                             )
                                             ⩽
                                             0
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             x
                                             ∈
                                             X
                                          
                                       
                                    
                                 
                              
                           
                        where
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   ϱ
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             (
                                             x
                                             ,
                                             τ
                                             )
                                             =
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      y
                                                      ∈
                                                      R
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   F
                                                
                                                
                                                   ϱ
                                                   
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   x
                                                
                                             
                                             (
                                             y
                                             )
                                             -
                                             
                                                
                                                   F
                                                
                                                
                                                   ϱ
                                                   
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   τ
                                                
                                             
                                             (
                                             y
                                             )
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   ϱ
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             (
                                             x
                                             ,
                                             τ
                                             )
                                             =
                                             
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      y
                                                      ∈
                                                      R
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   F
                                                
                                                
                                                   ϱ
                                                   
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   x
                                                
                                             
                                             (
                                             y
                                             )
                                             -
                                             
                                                
                                                   F
                                                
                                                
                                                   ϱ
                                                   
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   τ
                                                
                                             
                                             (
                                             y
                                             )
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           Definition 4
                           A given portfolio 
                                 
                                    τ
                                    ∈
                                    X
                                 
                               is directionally FSD inefficient with respect to an additional scenario 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ̃
                                       
                                    
                                 
                               if for each t there exists x(t) such that ϱ(t)⊤ 
                              x(t)≻
                              
                                 FSD
                              
                              ϱ(t)⊤
                              τ. Moreover, a given portfolio 
                                 
                                    τ
                                    ∈
                                    X
                                 
                               is directionally FSD efficient with respect to an additional scenario 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ̃
                                       
                                    
                                 
                               if ϱ(t)⊤ 
                              x
                              ≻
                              
                                 FSD
                              
                              ϱ(t)⊤
                              τ does not hold for any 
                                 
                                    x
                                    ∈
                                    X
                                 
                               and any t
                              ∈[0,1].

The definition classifies portfolio τ as directionally FSD efficient (inefficient) with respect to additional scenario 
                           
                              
                                 
                                    r
                                 
                                 
                                    ̃
                                 
                              
                           
                         if τ is FSD efficient (inefficient) when using the original distribution P as well as in any contaminated case P
                        
                           t
                        . FSD efficiency of portfolio τ for distribution Q is equivalent to 
                           
                              
                                 
                                    r
                                 
                                 
                                    ̃
                                 
                              
                              x
                              ⩽
                              
                                 
                                    r
                                 
                                 
                                    ̃
                                 
                              
                              τ
                              
                              ∀
                              x
                              ∈
                              X
                           
                        .

Using (34), portfolio 
                           
                              τ
                              ∈
                              X
                           
                         is directionally FSD efficient with respect to additional scenario 
                           
                              
                                 
                                    r
                                 
                                 
                                    ̃
                                 
                              
                           
                         if and only if
                           
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          t
                                          ∈
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                    
                                 
                                 
                                    
                                       ξ
                                    
                                    
                                       ϱ
                                       (
                                       t
                                       )
                                    
                                 
                                 (
                                 τ
                                 )
                                 =
                                 0
                                 .
                              
                           
                        If H
                        
                           ϱ(t)(x,
                        τ) is concave in t then ξ
                        
                           ϱ(t)(τ) is quasiconcave in t and the lower bound is:
                           
                              (35)
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       ϱ
                                       (
                                       t
                                       )
                                    
                                 
                                 (
                                 τ
                                 )
                                 ⩾
                                 (
                                 1
                                 -
                                 t
                                 )
                                 
                                    min
                                 
                                 {
                                 
                                    
                                       ξ
                                    
                                    
                                       ϱ
                                       (
                                       0
                                       )
                                    
                                 
                                 (
                                 τ
                                 )
                                 ,
                                 
                                    
                                       
                                          min
                                       
                                       
                                          x
                                          ∈
                                          X
                                          ,
                                          
                                             
                                                H
                                             
                                             
                                                ϱ
                                                (
                                                1
                                                )
                                             
                                          
                                          (
                                          x
                                          ,
                                          τ
                                          )
                                          ⩽
                                          0
                                       
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       ϱ
                                       (
                                       0
                                       )
                                    
                                 
                                 (
                                 x
                                 ,
                                 τ
                                 )
                                 }
                                 +
                                 t
                                 
                                    min
                                 
                                 {
                                 
                                    
                                       ξ
                                    
                                    
                                       ϱ
                                       (
                                       1
                                       )
                                    
                                 
                                 (
                                 τ
                                 )
                                 ,
                                 
                                    
                                       
                                          min
                                       
                                       
                                          x
                                          ∈
                                          X
                                          ,
                                          
                                             
                                                H
                                             
                                             
                                                ϱ
                                                (
                                                0
                                                )
                                             
                                          
                                          (
                                          x
                                          ,
                                          τ
                                          )
                                          ⩽
                                          0
                                       
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       ϱ
                                       (
                                       1
                                       )
                                    
                                 
                                 (
                                 x
                                 ,
                                 τ
                                 )
                                 }
                                 ;
                              
                           
                        see (22). As a consequence we can derive the following sufficient condition for directional FSD efficiency with respect to additional scenario 
                           
                              
                                 
                                    r
                                 
                                 
                                    ̃
                                 
                              
                           
                        .
                           Theorem 6
                           
                              Let H
                              
                                 ϱ(t)
                              
                              (x,
                              
                              τ) be concave in t. If
                              
                                 
                                    1.
                                    
                                       τ is FSD efficient with respect to the original distribution of returns

there is no portfolio x
                                       ≠
                                       τ having the same original distribution of returns as τ
                                    


                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ̃
                                                
                                             
                                             τ
                                             >
                                             
                                                
                                                   r
                                                
                                                
                                                   ̃
                                                
                                             
                                             x
                                          
                                        for all x
                                       ≠
                                       τ
                                    

Since τ is FSD efficient for the original distribution of ρ, Theorem 3 implies ξ
                              
                                 ϱ(0)(τ)=0. Combining it with Assumption 2,
                                 
                                    
                                       
                                          
                                             
                                                min
                                             
                                             
                                                x
                                                ∈
                                                X
                                                ,
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      ϱ
                                                      (
                                                      0
                                                      )
                                                   
                                                
                                                (
                                                x
                                                ,
                                                τ
                                                )
                                                ⩽
                                                0
                                             
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             ϱ
                                             (
                                             1
                                             )
                                          
                                       
                                       (
                                       x
                                       ,
                                       τ
                                       )
                                       =
                                       0
                                    
                                 
                              because τ is the only feasible solution of the problem. Similarly, Assumption 3 implies the uniqueness of τ when using the alternative distribution 
                                 
                                    Q
                                    =
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                    
                                 
                              , hence
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             ϱ
                                             (
                                             1
                                             )
                                          
                                       
                                       (
                                       τ
                                       )
                                       =
                                       0
                                       
                                       and
                                       
                                       
                                          
                                             
                                                min
                                             
                                             
                                                x
                                                ∈
                                                X
                                                ,
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      ϱ
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                                (
                                                x
                                                ,
                                                τ
                                                )
                                                ⩽
                                                0
                                             
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             ϱ
                                             (
                                             0
                                             )
                                          
                                       
                                       (
                                       x
                                       ,
                                       τ
                                       )
                                       =
                                       0
                                       .
                                    
                                 
                              Since ξ
                              
                                 ϱ(t)(τ) cannot be strictly positive, applying lower bound (35), we get ξ
                              
                                 ϱ(t)(τ)=0 for all t
                              ∈[0,1] and the rest of the proof directly follows from Theorem 3 applied for all contaminated problems and from Definition 4.□

Similarly, portfolio 
                           
                              τ
                              ∈
                              X
                           
                         is directionally FSD inefficient with respect to additional scenario 
                           
                              
                                 
                                    r
                                 
                                 
                                    ̃
                                 
                              
                           
                         if and only if
                           
                              
                                 
                                    
                                       
                                          max
                                       
                                       
                                          t
                                          ∈
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                    
                                 
                                 
                                    
                                       ξ
                                    
                                    
                                       ϱ
                                       (
                                       t
                                       )
                                    
                                 
                                 (
                                 τ
                                 )
                                 <
                                 0
                                 .
                              
                           
                        To compute max
                           t∈[0,1]
                        ξ
                        
                           ϱ(t)(τ) one needs to solve a minimax problem what may be computationally very demanding or even impossible. Therefore the following sufficient condition can be very useful in empirical testing. It applies the trivial global upper bound for (34) under assumption that some portfolio x is a feasible solution for all contaminated problems (34).
                           Theorem 7
                           
                              If there exists 
                              
                                 
                                    x
                                    ∈
                                    X
                                 
                               
                              such that ϱ
                              ⊤
                              x
                              ≻
                              
                                 FSD
                               
                              ϱ
                              ⊤
                              τ and 
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ̃
                                       
                                    
                                    x
                                    ⩾
                                    
                                       
                                          r
                                       
                                       
                                          ̃
                                       
                                    
                                    τ
                                 
                               
                              then τ is directionally FSD inefficient with respect to 
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ̃
                                       
                                    
                                 
                              
                              .
                           

Since 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ϱ
                                          
                                             
                                                (
                                                t
                                                )
                                             
                                             
                                                ⊤
                                             
                                          
                                          x
                                       
                                    
                                    (
                                    y
                                    )
                                 
                               is linear in t for all 
                                 
                                    x
                                    ∈
                                    X
                                    ,
                                    (
                                    
                                       
                                          F
                                       
                                       
                                          ϱ
                                          
                                             
                                                (
                                                t
                                                )
                                             
                                             
                                                ⊤
                                             
                                          
                                          x
                                       
                                    
                                    (
                                    y
                                    )
                                    -
                                    
                                       
                                          F
                                       
                                       
                                          ϱ
                                          
                                             
                                                (
                                                t
                                                )
                                             
                                             
                                                ⊤
                                             
                                          
                                          τ
                                       
                                    
                                    (
                                    y
                                    )
                                    )
                                 
                               is linear in t and H
                              
                                 ϱ(t)(x,τ) is convex in t, that is, 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          ϱ
                                          (
                                          t
                                          )
                                       
                                    
                                    (
                                    x
                                    ,
                                    τ
                                    )
                                    ⩽
                                    (
                                    1
                                    -
                                    t
                                    )
                                    
                                       
                                          H
                                       
                                       
                                          ϱ
                                       
                                    
                                    (
                                    x
                                    ,
                                    τ
                                    )
                                    +
                                    
                                       
                                          tH
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                    
                                    (
                                    x
                                    ,
                                    τ
                                    )
                                 
                               for all t
                              ∈[0,1]. Since ϱ
                              ⊤
                              x
                              ≻
                              
                                 FSD
                              
                              ϱ
                              ⊤
                              τ and 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ̃
                                       
                                    
                                    x
                                    ⩾
                                    
                                       
                                          r
                                       
                                       
                                          ̃
                                       
                                    
                                    τ
                                 
                               we have H
                              
                                 ϱ
                              (x,τ)⩽0 and 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                    
                                    (
                                    x
                                    ,
                                    τ
                                    )
                                    ⩽
                                    0
                                 
                              , and therefore, H
                              
                                 ϱ(t)(x,τ)⩽0. Hence ϱ(t)⊤
                              x
                              ≻
                              
                                 FSD
                              
                              ϱ(t)⊤
                              τ for all t
                              ∈[0,1] and τ is directionally FSD inefficient with respect to 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ̃
                                       
                                    
                                 
                               what completes the proof.□

Note that the required portfolio x can be easily found as a solution of (30) with the additional constraint: 
                           
                              
                                 
                                    r
                                 
                                 
                                    ̃
                                 
                              
                              x
                              ⩾
                              
                                 
                                    r
                                 
                                 
                                    ̃
                                 
                              
                              τ
                              .
                           
                        
                     

Assume that the probability distribution 
                           
                              
                                 
                                    P
                                 
                                 
                                    ‾
                                 
                              
                           
                         of random returns 
                           
                              
                                 
                                    ϱ
                                 
                                 
                                    ¯
                                 
                              
                           
                         takes again values r
                        
                           s
                        , s
                        =1,2,…,
                        S but with other probabilities 
                           
                              
                                 
                                    p
                                 
                                 
                                    ¯
                                 
                              
                              =
                              (
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    S
                                 
                              
                              )
                           
                        . We define the distance between P and 
                           
                              
                                 
                                    P
                                 
                                 
                                    ‾
                                 
                              
                           
                         as 
                           
                              d
                              (
                              
                                 
                                    P
                                 
                                 
                                    ‾
                                 
                              
                              ,
                              P
                              )
                              =
                              
                                 
                                    max
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              |
                           
                        .
                           Definition 5
                           A given portfolio 
                                 
                                    τ
                                    ∈
                                    X
                                 
                               is ∊-FSD inefficient if there exists portfolio 
                                 
                                    x
                                    ∈
                                    X
                                 
                               and 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          ‾
                                       
                                    
                                 
                               such that 
                                 
                                    d
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          ‾
                                       
                                    
                                    ,
                                    P
                                    )
                                    ⩽
                                    ∊
                                 
                               with 
                                 
                                    
                                       
                                          
                                             
                                                ϱ
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          ⊤
                                       
                                    
                                    x
                                    
                                       
                                          ≻
                                       
                                       
                                          FSD
                                       
                                    
                                    
                                       
                                          
                                             
                                                ϱ
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          ⊤
                                       
                                    
                                    τ
                                 
                              . Otherwise, portfolio τ is ∊-FSD efficient.

The introduced ∊-FSD efficiency is a robustification of the former FSD portfolio efficiency. It guarantees stability of the FSD efficiency classification with respect to small changes (prescribed by parameter ∊) in probability vector p. A given portfolio τ is ∊-FSD efficient if and only if no portfolio x FSD dominates τ neither for the original probabilities p nor for arbitrary probabilities 
                           
                              
                                 
                                    p
                                 
                                 
                                    ¯
                                 
                              
                           
                         from the ∊-neighborhood of the original vector p. For testing ∊-FSD efficiency of a given portfolio τ we modify (33) to a new measure of ∊-FSD efficiency:
                           
                              (36)
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       ∊
                                    
                                 
                                 (
                                 τ
                                 ,
                                 R
                                 ,
                                 p
                                 )
                                 =
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                b
                                             
                                             
                                                s
                                             
                                          
                                          ,
                                          x
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                ¯
                                             
                                          
                                          ,
                                          
                                             
                                                q
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          s
                                          =
                                          1
                                       
                                       
                                          S
                                       
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       s
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             s.t.
                                             
                                             
                                                
                                                   VaR
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         s
                                                      
                                                      
                                                         τ
                                                      
                                                   
                                                
                                             
                                             (
                                             -
                                             
                                                
                                                   ϱ
                                                
                                                
                                                   ⊤
                                                
                                             
                                             x
                                             )
                                             -
                                             
                                                
                                                   VaR
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         s
                                                      
                                                      
                                                         τ
                                                      
                                                   
                                                
                                             
                                             (
                                             -
                                             
                                                
                                                   ϱ
                                                
                                                
                                                   ⊤
                                                
                                             
                                             τ
                                             )
                                             ⩽
                                             
                                                
                                                   b
                                                
                                                
                                                   s
                                                
                                             
                                             ,
                                             
                                             s
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             S
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   s
                                                
                                                
                                                   τ
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                                
                                                   τ
                                                
                                             
                                             ,
                                             
                                             s
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             S
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      S
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             1
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             -
                                             ∊
                                             ⩽
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   p
                                                
                                                
                                                   i
                                                
                                             
                                             ⩽
                                             ∊
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             S
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             ⩾
                                             0
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             S
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   b
                                                
                                                
                                                   s
                                                
                                             
                                             ⩽
                                             0
                                             ,
                                             
                                             s
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             S
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             x
                                             ∈
                                             X
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           Theorem 8
                           
                              Portfolio 
                              
                                 
                                    τ
                                    ∈
                                    X
                                 
                               
                              is ∊-FSD efficient if and only if ξ
                              
                                 ∊
                              
                              (τ,
                              
                              R,
                              
                              p) given by 
                              
                                 (36)
                               
                              is equal to zero.
                           

The proof directly follows from Theorem 5 because (36) is obtained from (33) by an additional minimization over 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ¯
                                       
                                    
                                 
                               from ∊-neighborhood of the original probability vector p.□

@&#CONCLUSIONS@&#

To analyze the influence of perturbed input data in portfolio optimization problems with risk constraints, the contamination technique was applied under relaxed assumptions. When constructing contamination bounds for the optimal value the form of the constraints plays an important role. For the Markowitz model, e.g. the set of feasible solutions of perturbed problems (2) or (3) depends on contamination parameter t. Still, convexity (and smoothness) of these problems allows us to construct both the lower contamination bound and a local upper contamination bound. In the case of general probabilistic risk constraints local lower bounds can be constructed under modest assumptions, however derivation of local upper bounds is rather involved. Several instances of such bounds are presented.

For discrete distributions with non-equiprobable atoms, the obtained results are exploited to develop new robust FSD efficiency tests of a given portfolio with respect to an additional scenario or with respect to changes in scenario probabilities. Similarly as the already implemented simpler tests without robustness and with equal scenario probabilities in Kuosmanen (2004), our robust FSD efficiency tests are numerically demanding but they do not increase the computational complexity over the applicable mixed-integer programming procedures of Kuosmanen (2004).

@&#ACKNOWLEDGEMENT@&#

The research was supported by the project of the Czech Science Foundation P402/12/G097 “DYME/Dynamic Models in Economics”.

@&#REFERENCES@&#

