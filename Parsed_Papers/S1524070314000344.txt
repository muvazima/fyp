@&#MAIN-TITLE@&#The unified discrete surface Ricci flow

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Give unified framework of Ricci flow for all schemes with all background geometries.


                        
                        
                           
                           Give four novel schemes for discrete surface Ricci flow.


                        
                        
                           
                           Introduce explicit geometric interpretations to discrete Ricci energy for all schemes.


                        
                        
                           
                           Give geometric interpretations to the Hessian of Ricci energy for all schemes.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Unified

Ricci flow

Circle packing

Discrete Ricci energy

Hessian matrix

@&#ABSTRACT@&#


               
               
                  Ricci flow deforms the Riemannian metric proportionally to the curvature, such that the curvature evolves according to a heat diffusion process and eventually becomes constant everywhere. Ricci flow has demonstrated its great potential by solving various problems in many fields, which can be hardly handled by alternative methods so far.
                  This work introduces the unified theoretic framework for discrete surface Ricci flow, including all the common schemes: tangential circle packing, Thurston’s circle packing, inversive distance circle packing and discrete Yamabe flow. Furthermore, this work also introduces a novel schemes, virtual radius circle packing and the mixed type schemes, under the unified framework. This work gives explicit geometric interpretation to the discrete Ricci energies for all the schemes with all back ground geometries, and the corresponding Hessian matrices.
                  The unified frame work deepens our understanding to the discrete surface Ricci flow theory, and has inspired us to discover the new schemes, improved the flexibility and robustness of the algorithms, greatly simplified the implementation and improved the efficiency. Experimental results show the unified surface Ricci flow algorithms can handle general surfaces with different topologies, and is robust to meshes with different qualities, and is effective for solving real problems.
               
            

@&#INTRODUCTION@&#

Ricci flow was introduced by Hamilton for the purpose of studying low dimensional topology. Ricci flow deforms the Riemannian metric proportional to the curvature, such that the curvature evolves according to a heat diffusion process, and eventually becomes constant everywhere. In pure theory field, Ricci flow has been used for the proof of Poincaré’s conjecture. In engineering fields, surface Ricci flow has been broadly applied for tackling many important problems, such as parameterization in graphics [1], deformable surface registration in vision [2], manifold spline construction in geometric modeling [3] and cancer detection in medical imaging [4]. More applications in engineering and medicine fields can be found in [5].

Suppose 
                        
                           (
                           S
                           ,
                           g
                           )
                        
                      is a metric surface, according to the Gauss–Bonnet theorem, the total Gaussian curvature 
                        
                           
                              ∫
                              
                                 S
                              
                           
                           
                              
                                 KdA
                              
                              
                                 g
                              
                           
                        
                      equals to 
                        
                           2
                           π
                           χ
                           (
                           S
                           )
                        
                     , where K is the Gaussian curvature, 
                        
                           χ
                           (
                           S
                           )
                        
                      the Euler characteristics of S. Ricci flow deforms the Riemannian metric conformally, namely, 
                        
                           g
                           (
                           t
                           )
                           =
                           
                              
                                 e
                              
                              
                                 2
                                 u
                                 (
                                 t
                                 )
                              
                           
                           g
                           (
                           0
                           )
                        
                     , where 
                        
                           u
                           (
                           t
                           )
                           :
                           S
                           →
                           R
                        
                      is the conformal factor. The normalized Ricci flow can be written as
                        
                           (1.1)
                           
                              
                                 
                                    du
                                    (
                                    t
                                    )
                                 
                                 
                                    dt
                                 
                              
                              =
                              
                                 
                                    2
                                    π
                                    χ
                                    (
                                    S
                                    )
                                 
                                 
                                    A
                                    (
                                    0
                                    )
                                 
                              
                              -
                              K
                              (
                              t
                              )
                              .
                           
                        
                     where 
                        
                           A
                           (
                           0
                           )
                        
                      is the initial surface area. Hamilton [6] and chow [7] proved the convergence of surface Ricci flow. Surface Ricci flow is the negative gradient flow of the Ricci energy. It is a powerful tool for designing Riemannian metrics using prescribed curvatures, which has great potential for many applications in engineering fields. Surface Ricci flow implies the celebrated surface uniformization theorem as shown in Fig. 1
                     . For surfaces with boundaries, uniformization theorem still holds as illustrated in Fig. 2
                     , where surfaces are conformally mapped to the circle domains on surfaces with constant curvatures.

Conformal metric deformation transforms infinitesimal circles to infinitesimal circles as shown in Fig. 3
                     . Intuitively, one approximates the surface by a triangulated polyhedron (a triangle mesh), covers each vertex by a disk of finite size (a cone), and deforms the disk radii preserving the combinatorial structure of the triangulation and the intersection angles among the circles. This deformation simulates the smooth conformal mapping with very high fidelity. Rodin and Sullivan [8] proved that if the triangulation of a simply connected planar domain is subdivided infinite times, the induced discrete conformal mappings converge to the smooth Riemann mapping. The discrete version of surface Ricci flow was introduced by Chow and Luo in [9] in 2003. It is based on the circle packing method.

Historically, many schemes of circle packing or circle pattern have been invented. The discrete surface can be constructed by gluing Spherical, Euclidean or Hyperbolic triangles isometrically along their edges. Accordingly, we say the triangle mesh has spherical 
                        
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                        
                     , Euclidean 
                        
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                        
                      or hyperbolic 
                        
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                        
                      background geometry. Under each background geometry, there are six schemes, tangential circle packing, Thurston’s circle packing, inversive distance circle packing, discrete Yamabe flow, virtual radius circle packing and mixed type scheme. There are 18 combinations in total. Among them, the hyperbolic and spherical virtual radius circle packing and mixed type schemes are first introduced in this work.

Most of the existing schemes were invented and developed individually in the past. This work seeks a coherent theoretic framework, which can unify all the existing schemes, and predicts undiscovered ones. This leads to deeper understandings of discrete surface Ricci flow and provides approaches for further generalization. In practice, the theoretic discovery of virtual radius circle packing gives novel computational algorithm; the mixed schemes improves the flexibility; the unified framework greatly simplifies the implementation; the geometric interpretations offer better intuitions.

This work has the following contributions:
                           
                              1.
                              This work establishes a unified framework for discrete surface Ricci flow, which covers most existing schemes: tangential circle packing, Thurston’s circle packing, inversive distance circle packing, discrete Yamabe flow, virtual radius circle packing and mixed type schemes, in Spherical, Euclidean and hyperbolic background geometry. In Euclidean case, our unified framework is equivalent to Glickenstein’s geometric formulation [10]. To the best of our knowledge, the unified frameworks for both hyperbolic and spherical schemes are reported for the first time.

This work introduces 4 novel schemes for discrete surface Ricci flow: virtual radius circle packing and mixed type schemes under both hyperbolic and Spherical background geometries, which are naturally deduced from our unification work. To the best of our knowledge, these are introduced to the literature for the first time.

This work gives an explicit geometric interpretation to the discrete Ricci energy for all the 18 schemes. The geometric interpretations to 2 Yamabe flow schemes (both Euclidean and Hyperbolic) were first made by Bobenko et al. [11].

This work also provides an explicit geometric interpretation to the Hessian of discrete Ricci energy for all the 18 schemes. The interpretation in Euclidean case is due to Glickenstein [10]. To the best of our knowledge, the interpretation in Hyperbolic and Spherical cases are introduced for the first time. Recently, Glickenstein and Thomas discovered the similar result independently [12].

The paper is organized as follows: Section 2 briefly reviews the most related theoretic works; Section 3 introduces the unified framework for different schemes of discrete surface Ricci flow, which covers 18 schemes in total; Section 4 explains the geometric interpretation of the Hessian matrix of discrete Ricci energy for all schemes with different background geometries; Section 5 gives a geometric interpretation of Ricci energy; Experimental results are reported in Section 6, different schemes are systematically compared. The work concludes in Section 7, future directions are discussed; Finally, in the appendix, we give the implementation details and reorganize all the formulae.

In his work on constructing hyperbolic metrics on 3-manifolds, Thurston [13] studied a Euclidean (or a hyperbolic) circle packing on a triangulated closed surface with prescribed intersection angles. His work generalizes Koebe’s and Andreev’s results of circle packing on a sphere [14–16]. Thurston conjectured that the discrete conformal mapping based on circle packing converges to the smooth Riemann mapping when the discrete tessellation becomes finer and finer. Thurston’s conjecture has been proved by Rodin and Sullivan [8]. Chow and Luo established the intrinsic connection between circle packing and surface Ricci flow [9].

The rigidity for classical circle packing was proved by Thurston [13], Marden and Rodin [17], Colin de Verdiére [18], Chow and Luo [9], Stephenson [19], and He [20].

Bowers and Stephenson [21] introduced inversive distance circle packing which generalizes Andreev–Thurston’s intersection angle circle packing. See Stephenson [19] for more information. Guo gave a proof for local rigidity [22] of inversive distance circle packing. Luo gave a proof for global rigidity in [23].

Luo introduced and studied the combinatorial Yamabe problem for piecewise flat metrics on triangulated surfaces [24]. Springborn et al. [25] considered this combinatorial conformal change of piecewise flat metrics and found an explicit formula of the energy function. Glickenstein [26,27] studied the combinatorial Yamabe flow on 3-dimensional piecewise flat manifolds. Bobenko–Pinkall–Springborn introduced a geometric interpretation to Euclidean and hyperbolic Yamabe flow using the volume of generalized hyperbolic tetrahedron in [11]. Combinatorial Yamabe flow on hyperbolic surfaces with boundary has been studied by Guo in [28]. The existence of the solution to Yamabe flow with topological surgeries has been proved recently in [29,30].

The Euclidean virtual radius circle packing first appeared in [5]. The hyperbolic and spherical virtual radius circle packing are introduced in this work.

The Euclidean mixed type circle packing appeared in [5] and Glickenstein’s talk [31]. This work introduces hyperbolic and spherical mixted type schemes.

Recently Glickenstein [10] set the theory of combinatorial Yamabe flow of piecewise flat metric in a broader context including the theory of circle packing on surfaces. This work focuses on the hyperbolic and spherical unified frameworks.

The variational approach to circle packing was first introduced by Colin de Verdiére [18]. Since then, many works on variational principles on circle packing or circle pattern have appeared. For example, see Brägger [32], Rivin [33], Leibon [34], Chow and Luo [9], Bobenko and Springborn [35], Guo and Luo [36], and Springborn [37]. Variational principles for polyhedral surfaces including the topic of circle packing were studied systematically in Luo [38]. Many energy functions are derived from the cosine law and its derivative. Tangent circle packing is generalized to tangent circle packing with a family of discrete curvature. For exposition of this work, see also Luo et al. [39].

Recently, Gu et al. established discrete uniformization theorem based on Euclidean [29] and hyperbolic [30] Yamabe flow. In a series of papers on developing discrete uniformization theorem [40–43], Sa’ar Hersonsky proved several important theorems based on discrete harmonic maps and cellular decompositions. His approach is complementary to the work mentioned above.

This section systematically introduces the unified framework for discrete surface Ricci flow. The whole theory is explained using the variational principle on discrete surfaces based on derivative cosine law [39]. The elementary concepts and some of schemes can be found in [38] and the chapter 4 in [5].

In practice, smooth surfaces are usually approximated by discrete surfaces. Discrete surfaces are represented as two dimensional simplicial complexes which are manifolds, as shown in Fig. 4
                        .
                           Definition 3.1
                           Triangular Mesh


                           Suppose 
                                 
                                    Σ
                                 
                               is a two dimensional simplicial complex, furthermore it is also a manifold, namely, for each point p of 
                                 
                                    Σ
                                 
                              , there exists a neighborhood of 
                                 
                                    p
                                    ,
                                    U
                                    (
                                    p
                                    )
                                 
                              , which is homeomorphic to the whole plane or the upper half plane. Then 
                                 
                                    Σ
                                 
                               is called a triangular mesh.

If 
                                 
                                    U
                                    (
                                    p
                                    )
                                 
                               is homeomorphic to the whole plane, then p is called an interior point; if 
                                 
                                    U
                                    (
                                    p
                                    )
                                 
                               is homeomorphic to the upper half plane, then p is called a boundary point.

The fundamental concepts from smooth differential geometry, such as Riemannian metric, curvature and conformal structure, are generalized to the simplicial complex, respectively.

In the following discussion, we use 
                           
                              Σ
                              =
                              (
                              V
                              ,
                              E
                              ,
                              F
                              )
                           
                         to denote the mesh with vertex set V, edge set E and face set F. A discrete surface is with Euclidean (hyperbolic or spherical) background geometry if it is constructed by isometrically gluing triangles in 
                           
                              
                                 
                                    E
                                 
                                 
                                    2
                                 
                              
                           
                         (
                           
                              
                                 
                                    H
                                 
                                 
                                    2
                                 
                              
                           
                         or 
                           
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                           
                        ) (see Fig. 5
                        ).
                           Definition 3.2
                           Discrete Riemannian Metric


                           A discrete metric on a triangular mesh is a function defined on the edges, 
                                 
                                    l
                                    :
                                    E
                                    →
                                    
                                       
                                          R
                                       
                                       
                                          +
                                       
                                    
                                 
                              , which satisfies the triangle inequality: on each face 
                                 
                                    [
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          k
                                       
                                    
                                    ]
                                    ,
                                    
                                       
                                          l
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          l
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          l
                                       
                                       
                                          k
                                       
                                    
                                 
                               are the lengths of edges against 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          k
                                       
                                    
                                 
                               respectively,
                                 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             l
                                          
                                          
                                             j
                                          
                                       
                                       >
                                       
                                          
                                             l
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             j
                                          
                                       
                                       +
                                       
                                          
                                             l
                                          
                                          
                                             k
                                          
                                       
                                       >
                                       
                                          
                                             l
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       
                                          
                                             l
                                          
                                          
                                             i
                                          
                                       
                                       >
                                       
                                          
                                             l
                                          
                                          
                                             j
                                          
                                       
                                       .
                                    
                                 
                              A triangular mesh with a discrete Riemannian metric is called a discrete metric surface.

Suppose 
                                 
                                    Σ
                                 
                               is a discrete metric surface, if each face of 
                                 
                                    Σ
                                 
                               is a spherical, (Euclidean or hyperbolic) triangle, then we say 
                                 
                                    Σ
                                 
                               is with spherical, (Euclidean or hyperbolic) background geometry. We use 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          E
                                       
                                       
                                          2
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          2
                                       
                                    
                                 
                               to represent spherical Euclidean or hyperbolic background metric.

Triangles with different background geometries satisfy different cosine laws:
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             1
                                             =
                                             
                                                
                                                   cos
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   cos
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   cos
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                
                                                   sin
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   sin
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   E
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             cos
                                             
                                                
                                                   l
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   cos
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   cos
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   cos
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                
                                                   sin
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   sin
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             cosh
                                             
                                                
                                                   l
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   cosh
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   cosh
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   cosh
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                
                                                   sinh
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   sinh
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The discrete Gaussian curvature is defined as angle deficit, as shown in Fig. 6
                        .
                           Definition 3.4
                           Discrete Gauss Curvature


                           The discrete Gauss curvature function on a mesh is defined on vertices, 
                                 
                                    K
                                    :
                                    V
                                    →
                                    R
                                 
                              ,
                                 
                                    
                                       K
                                       (
                                       v
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         2
                                                         π
                                                         -
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  jk
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               jk
                                                            
                                                         
                                                         ,
                                                      
                                                      
                                                         v
                                                         
                                                         
                                                         ∉
                                                         
                                                         ∂
                                                         M
                                                      
                                                   
                                                   
                                                      
                                                         π
                                                         -
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  jk
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               jk
                                                            
                                                         
                                                         ,
                                                      
                                                      
                                                         v
                                                         
                                                         ∈
                                                         ∂
                                                         M
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              where 
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          i
                                       
                                       
                                          jk
                                       
                                    
                                 
                              ’s are corner angle at 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                 
                               in the face 
                                 
                                    [
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          k
                                       
                                    
                                    ]
                                 
                              , and 
                                 
                                    ∂
                                    M
                                 
                               represents the boundary of the mesh.

The Gauss–Bonnet theorem still holds in the discrete case.
                           Theorem 3.5
                           Discrete Gauss–Bonnet Theorem


                           
                              Suppose 
                              
                                 
                                    Σ
                                 
                               
                              is a triangular mesh with Euclidean background metric. The total curvature is a topological invariant,
                              
                                 
                                    (3.1)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                v
                                                ∉
                                                ∂
                                                Σ
                                             
                                          
                                       
                                       K
                                       (
                                       v
                                       )
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                v
                                                ∈
                                                ∂
                                                Σ
                                             
                                          
                                       
                                       K
                                       (
                                       v
                                       )
                                       +
                                       ∊
                                       A
                                       (
                                       Σ
                                       )
                                       =
                                       2
                                       π
                                       χ
                                       (
                                       Σ
                                       )
                                       ,
                                    
                                 
                              
                              where 
                              
                                 
                                    χ
                                 
                               
                              is the characteristic Euler number, and K is the Gauss curvature, 
                              
                                 
                                    A
                                    (
                                    Σ
                                    )
                                 
                               
                              is the total area, 
                              
                                 
                                    ∊
                                    =
                                    {
                                    +
                                    1
                                    ,
                                    0
                                    ,
                                    -
                                    1
                                    }
                                 
                               
                              if 
                              
                                 
                                    Σ
                                 
                               
                              is with spherical, Euclidean or hyperbolic background geometry.
                           


                        
                           Definition 3.6
                           Circle Packing Metric


                           Suppose 
                                 
                                    Σ
                                    =
                                    (
                                    V
                                    ,
                                    E
                                    ,
                                    F
                                    )
                                 
                               is a triangle mesh with spherical, Euclidean or hyperbolic background geometry. Each vertex 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                 
                               is associated with a circle with radius 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          i
                                       
                                    
                                 
                              . The circle radius function is denoted as 
                                 
                                    γ
                                    :
                                    V
                                    →
                                    
                                       
                                          R
                                       
                                       
                                          >
                                          0
                                       
                                    
                                 
                              ; a function defined on the vertices 
                                 
                                    ∊
                                    :
                                    V
                                    →
                                    {
                                    +
                                    1
                                    ,
                                    0
                                    ,
                                    -
                                    1
                                    }
                                 
                               is called the scheme coefficient; a function defined on edges 
                                 
                                    η
                                    :
                                    E
                                    →
                                    R
                                 
                               is called the discrete conformal structure coefficient. A circle packing metric is a 4-tuple 
                                 
                                    (
                                    Σ
                                    ,
                                    γ
                                    ,
                                    η
                                    ,
                                    ∊
                                    )
                                 
                              , the edge length is determined by the 4-tuple and the background geometry.

In the smooth case, changing a Riemannian metric by a scalar function, 
                           
                              g
                              →
                              
                                 
                                    e
                                 
                                 
                                    2
                                    u
                                 
                              
                              g
                           
                        , is called a conformal metric deformation. The discrete analogy to this is as follows.
                           Definition 3.7
                           Discrete Conformal Equivalence


                           Two circle packing metrics 
                                 
                                    (
                                    
                                       
                                          Σ
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          γ
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          η
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          ∊
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    ,
                                    k
                                    =
                                    1
                                    ,
                                    2
                                 
                              , are conformally equivalent if 
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          Σ
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          η
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          η
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          ∊
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          ∊
                                       
                                       
                                          2
                                       
                                    
                                 
                              . (
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                    
                                 
                               may not equals to 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                              .)

The discrete analogy to the concept of conformal factor in the smooth case is.
                           Definition 3.8
                           Discrete Conformal Factor


                           Discrete conformal factor for a circle packing metric 
                                 
                                    (
                                    Σ
                                    ,
                                    γ
                                    ,
                                    η
                                    ,
                                    ∊
                                    )
                                 
                               is a function defined on each vertex 
                                 
                                    u
                                    :
                                    V
                                    →
                                    R
                                 
                              ,
                                 
                                    (3.2)
                                    
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         log
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               E
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         log
                                                         tanh
                                                         
                                                            
                                                               
                                                                  
                                                                     γ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               H
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         log
                                                         tan
                                                         
                                                            
                                                               
                                                                  
                                                                     γ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Suppose 
                                 
                                    Σ
                                    =
                                    (
                                    V
                                    ,
                                    E
                                    ,
                                    F
                                    )
                                 
                               is triangle mesh with spherical, Euclidean or hyperbolic background geometry. Given a circle packing metric 
                                 
                                    (
                                    Σ
                                    ,
                                    γ
                                    ,
                                    η
                                    ,
                                    ∊
                                    )
                                 
                              , for an edge 
                                 
                                    [
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                    ]
                                    ∈
                                    E
                                 
                              , its length 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          ij
                                       
                                    
                                 
                               is given by
                                 
                                    (3.3)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               ij
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         =
                                                         2
                                                         
                                                            
                                                               η
                                                            
                                                            
                                                               ij
                                                            
                                                         
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               
                                                                  
                                                                     u
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     u
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               ε
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               2
                                                               
                                                                  
                                                                     u
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               ε
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               2
                                                               
                                                                  
                                                                     u
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               E
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         cosh
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               ij
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               4
                                                               
                                                                  
                                                                     η
                                                                  
                                                                  
                                                                     ij
                                                                  
                                                               
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           u
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                     +
                                                                     
                                                                        
                                                                           u
                                                                        
                                                                        
                                                                           j
                                                                        
                                                                     
                                                                  
                                                               
                                                               +
                                                               (
                                                               1
                                                               +
                                                               
                                                                  
                                                                     ε
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     2
                                                                     
                                                                        
                                                                           u
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                  
                                                               
                                                               )
                                                               (
                                                               1
                                                               +
                                                               
                                                                  
                                                                     ε
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     2
                                                                     
                                                                        
                                                                           u
                                                                        
                                                                        
                                                                           j
                                                                        
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               (
                                                               1
                                                               -
                                                               
                                                                  
                                                                     ε
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     2
                                                                     
                                                                        
                                                                           u
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                  
                                                               
                                                               )
                                                               (
                                                               1
                                                               -
                                                               
                                                                  
                                                                     ε
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     2
                                                                     
                                                                        
                                                                           u
                                                                        
                                                                        
                                                                           j
                                                                        
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               H
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         cos
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               ij
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               -
                                                               4
                                                               
                                                                  
                                                                     η
                                                                  
                                                                  
                                                                     ij
                                                                  
                                                               
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           u
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                     +
                                                                     
                                                                        
                                                                           u
                                                                        
                                                                        
                                                                           j
                                                                        
                                                                     
                                                                  
                                                               
                                                               +
                                                               (
                                                               1
                                                               -
                                                               
                                                                  
                                                                     ε
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     2
                                                                     
                                                                        
                                                                           u
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                  
                                                               
                                                               )
                                                               (
                                                               1
                                                               -
                                                               
                                                                  
                                                                     ε
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     2
                                                                     
                                                                        
                                                                           u
                                                                        
                                                                        
                                                                           j
                                                                        
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               (
                                                               1
                                                               +
                                                               
                                                                  
                                                                     ε
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     2
                                                                     
                                                                        
                                                                           u
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                  
                                                               
                                                               )
                                                               (
                                                               1
                                                               +
                                                               
                                                                  
                                                                     ε
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     2
                                                                     
                                                                        
                                                                           u
                                                                        
                                                                        
                                                                           j
                                                                        
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              The schemes are named as follows:
                                 
                                    
                                       
                                       
                                       
                                       
                                       
                                          
                                             Scheme
                                             
                                                
                                                   
                                                      
                                                         
                                                            ε
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ε
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            η
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             Tangential circle packing
                                             +1
                                             +1
                                             +1
                                          
                                          
                                             Thurston’s circle packing
                                             +1
                                             +1
                                             
                                                
                                                   
                                                      [
                                                      0
                                                      ,
                                                      1
                                                      ]
                                                   
                                                
                                             
                                          
                                          
                                             Inversive distance circle packing
                                             +1
                                             +1
                                             
                                                
                                                   
                                                      >
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             Yamabe flow
                                             0
                                             0
                                             
                                                
                                                   
                                                      >
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             Virtual radius circle packing
                                             −1
                                             −1
                                             
                                                
                                                   
                                                      >
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             Mixed type
                                             
                                                
                                                   
                                                      {
                                                      -
                                                      1
                                                      ,
                                                      0
                                                      ,
                                                      +
                                                      1
                                                      }
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      {
                                                      -
                                                      1
                                                      ,
                                                      0
                                                      ,
                                                      +
                                                      1
                                                      }
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      >
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                        Figs. 7 and 8
                        
                         illustrate all the schemes with for discrete surfaces with Euclidean background geometry.
                           Remark 3.10
                           From the definition, the tangential circle packing is a special case of Thurston’s circle packing; Thurston’s circle packing is a special case of inversive distance circle packing. In the following discussion, we unify all three types as inversive distance circle packing.


                        
                           Definition 3.11
                           Discrete Surface Ricci Flow


                           A discrete surface with 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          E
                                       
                                       
                                          2
                                       
                                    
                                 
                               or 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          2
                                       
                                    
                                 
                               background geometry, and a circle packing metric 
                                 
                                    (
                                    Σ
                                    ,
                                    γ
                                    ,
                                    η
                                    ,
                                    ∊
                                    )
                                 
                              , the discrete surface Ricci flow is
                                 
                                    (3.4)
                                    
                                       
                                          
                                             
                                                
                                                   du
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             t
                                             )
                                          
                                          
                                             dt
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             K
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       t
                                       )
                                       ,
                                    
                                 
                              where 
                                 
                                    
                                       
                                          
                                             
                                                K
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                 
                               is the target curvature at the vertex 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                 
                              .

The target curvature must satisfy certain constraints to ensure the existence of the solution to the flow, such as Gauss–Bonnet equation Eq. (3.1), but also some additional ones described in [13,17,9], for instances.

The discrete surface Ricci flow has exactly the same formula as the smooth counter part Eq. (1.1). Furthermore, similar to the smooth case, discrete surface Ricci flow is also variational: the discrete Ricci flow is the negative gradient flow of the discrete Ricci energy.
                           Definition 3.12
                           Discrete Ricci Energy


                           A discrete surface with 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          E
                                       
                                       
                                          2
                                       
                                    
                                 
                               or 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          2
                                       
                                    
                                 
                               background geometry, and a circle packing metric 
                                 
                                    (
                                    Σ
                                    ,
                                    γ
                                    ,
                                    η
                                    ,
                                    ∊
                                    )
                                 
                              . For a triangle 
                                 
                                    [
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          k
                                       
                                    
                                    ]
                                 
                               with inner angles 
                                 
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                              , the discrete Ricci energy on the face is given by
                                 
                                    (3.5)
                                    
                                       
                                          
                                             E
                                          
                                          
                                             f
                                          
                                       
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       =
                                       
                                          ∫
                                          
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   u
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                       
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             du
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             θ
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             du
                                          
                                          
                                             j
                                          
                                       
                                       +
                                       
                                          
                                             θ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             du
                                          
                                          
                                             k
                                          
                                       
                                       .
                                    
                                 
                              
                           

The discrete Ricci energy for the whole mesh is defined as
                                 
                                    (3.6)
                                    
                                       
                                          
                                             E
                                          
                                          
                                             Σ
                                          
                                       
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       ⋯
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             n
                                          
                                       
                                       )
                                       =
                                       
                                          ∫
                                          
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             ⋯
                                             ,
                                             
                                                
                                                   u
                                                
                                                
                                                   n
                                                
                                             
                                             )
                                          
                                       
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             K
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       
                                          
                                             du
                                          
                                          
                                             i
                                          
                                       
                                       .
                                    
                                 
                              
                           

From definition, we get the relation between the surface Ricci energy and the face Ricci energy
                           
                              (3.7)
                              
                                 
                                    
                                       E
                                    
                                    
                                       Σ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 2
                                 π
                                 )
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          f
                                          ∈
                                          F
                                       
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       f
                                    
                                 
                                 .
                              
                           
                        
                     

The description of the energy in terms of an integral requires the fact that the inside is a closed form so that it is defined independent of the integration path. This follows from the following symmetry lemma, which has fundamental importance. In this work, we give three proofs. The following one is algebraic, more difficult to verify, but leads to computational algorithm directly. The second one is based on the geometric interpretation to the Hessian matrix in Section 4. The third one is based on the geometric interpretation to the discrete Ricci energy. The later two proofs are more geometric and intuitive.
                           Lemma 3.13
                           Symmetry


                           
                              A discrete surface with 
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          E
                                       
                                       
                                          2
                                       
                                    
                                 
                               
                              or 
                              
                                 
                                    
                                       
                                          H
                                       
                                       
                                          2
                                       
                                    
                                 
                               
                              background geometry, and a circle packing metric 
                              
                                 
                                    (
                                    Σ
                                    ,
                                    γ
                                    ,
                                    η
                                    ,
                                    ∊
                                    )
                                 
                              
                              , then for any pair of vertices 
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              :
                              
                                 
                                    (3.8)
                                    
                                       
                                          
                                             ∂
                                             
                                                
                                                   K
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   u
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             ∂
                                             
                                                
                                                   K
                                                
                                                
                                                   j
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

From the relation in Eq. (3.7), it is sufficient and necessary to show the symmetry for each triangle 
                                 
                                    [
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          k
                                       
                                    
                                    ]
                                 
                               for all schemes,
                                 
                                    
                                       
                                          
                                             ∂
                                             
                                                
                                                   θ
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   u
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             ∂
                                             
                                                
                                                   θ
                                                
                                                
                                                   j
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

This is proven by finding the explicit formula for the Hessain matrix of the face Ricci energy,
                                 
                                    (3.9)
                                    
                                       
                                          
                                             ∂
                                             (
                                             
                                                
                                                   θ
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   θ
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                             
                                                
                                                   θ
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          
                                             ∂
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   u
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                       =
                                       -
                                       
                                          
                                             1
                                          
                                          
                                             2
                                             A
                                          
                                       
                                       L
                                       Θ
                                       
                                          
                                             L
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       D
                                       ,
                                    
                                 
                              where
                                 
                                    (3.10)
                                    
                                       A
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       sin
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                       s
                                       (
                                       
                                          
                                             l
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       s
                                       (
                                       
                                          
                                             l
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 
                              the matrix L
                              
                                 
                                    (3.11)
                                    
                                       L
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         s
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         s
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         s
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              and the matrix 
                                 
                                    Θ
                                 
                              
                              
                                 
                                    (3.12)
                                    
                                       Θ
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         -
                                                         1
                                                      
                                                      
                                                         cos
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                      
                                                         cos
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         cos
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                      
                                                         -
                                                         1
                                                      
                                                      
                                                         cos
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         cos
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                      
                                                         cos
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              and
                                 
                                    (3.13)
                                    
                                       D
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         τ
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                         )
                                                      
                                                      
                                                         τ
                                                         (
                                                         i
                                                         ,
                                                         k
                                                         ,
                                                         j
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         τ
                                                         (
                                                         j
                                                         ,
                                                         i
                                                         ,
                                                         k
                                                         )
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         τ
                                                         (
                                                         j
                                                         ,
                                                         k
                                                         ,
                                                         i
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         τ
                                                         (
                                                         k
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                      
                                                         τ
                                                         (
                                                         k
                                                         ,
                                                         j
                                                         ,
                                                         i
                                                         )
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              where 
                                 
                                    s
                                    (
                                    x
                                    )
                                 
                               and 
                                 
                                    τ
                                    (
                                    i
                                    ,
                                    j
                                    ,
                                    k
                                    )
                                 
                               are defined as
                                 
                                    
                                       
                                       
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      s
                                                      (
                                                      x
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      τ
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            E
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                             
                                             
                                                
                                                   
                                                      1
                                                      /
                                                      2
                                                      (
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            ε
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            ε
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            k
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      sinh
                                                      x
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      cosh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            cosh
                                                         
                                                         
                                                            
                                                               
                                                                  ε
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            cosh
                                                         
                                                         
                                                            
                                                               
                                                                  ε
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      sin
                                                      x
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      cos
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            cos
                                                         
                                                         
                                                            
                                                               
                                                                  ε
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            cos
                                                         
                                                         
                                                            
                                                               
                                                                  ε
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

By symbolic computation, it is straightforward to verify the symmetry of Eq. (3.9).□

This section focuses on the geometric interpretation to Hessian matrix of the discrete Ricci energy on each face for 
                        
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                        
                      and 
                        
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                        
                      cases. This gives the second proof of the symmetry Lemma 3.13.

The interpretation in Euclidean case is due to Glickenstein [10] (He [44] in the case of circle packings) and illustrated in [5]. In the current work, we build the connection to the Power Delaunay triangulation and power voronoi diagram.

We only focus on one triangle 
                           
                              [
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    k
                                 
                              
                              ]
                           
                        , with corner angles 
                           
                              
                                 
                                    θ
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    k
                                 
                              
                           
                        , conformal factors 
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    k
                                 
                              
                           
                         and edge lengths 
                           
                              
                                 
                                    l
                                 
                                 
                                    ij
                                 
                              
                           
                         for edge 
                           
                              [
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              ]
                              ,
                              
                                 
                                    l
                                 
                                 
                                    jk
                                 
                              
                           
                         for 
                           
                              [
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    k
                                 
                              
                              ]
                           
                         and 
                           
                              
                                 
                                    l
                                 
                                 
                                    ki
                                 
                              
                           
                         for 
                           
                              [
                              
                                 
                                    v
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              ]
                           
                        .

As shown in Figs. 7 and 8, the power of q with respect to 
                              
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                              
                            is
                              
                                 
                                    pow
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    q
                                    )
                                    =
                                    |
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    q
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    ∊
                                    
                                       
                                          γ
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        

The power center o of the triangle satisfies
                              
                                 
                                    pow
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    o
                                    )
                                    =
                                    pow
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    o
                                    )
                                    =
                                    pow
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    o
                                    )
                                    .
                                 
                              
                           
                        

The power circle C centered at o with radius 
                              
                                 γ
                              
                           , where 
                              
                                 γ
                                 =
                                 pow
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 o
                                 )
                              
                           .

Therefore, for tangential, Thurton’s and inversive distance circle packing cases, the power circle is orthogonal to three circles at the vertices 
                              
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       C
                                    
                                    
                                       k
                                    
                                 
                              
                           ; for Yamabe flow case, the power circle is the circumcircle of the triangle; for virtual radius circle packing, the power circle is the equator of the sphere, which goes through three points 
                              
                                 {
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                                 n
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       j
                                    
                                 
                                 n
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                    
                                 
                                 n
                                 }
                              
                           , where 
                              
                                 n
                              
                            is the normal to the plane.

Through the power center, we draw line perpendicular to three edges, the perpendicular feets are 
                              
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       j
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       w
                                    
                                    
                                       k
                                    
                                 
                              
                            respectively. The distance from the power center to the perpendicular feet are 
                              
                                 
                                    
                                       h
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       j
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       h
                                    
                                    
                                       k
                                    
                                 
                              
                            respectively. Then it can be shown easily that
                              
                                 (4.1)
                                 
                                    
                                       
                                          ∂
                                          
                                             
                                                θ
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          ∂
                                          
                                             
                                                θ
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          ∂
                                          
                                             
                                                θ
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          ∂
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          ∂
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          ∂
                                          
                                             
                                                θ
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           furthermore,
                              
                                 (4.2)
                                 
                                    
                                       
                                          ∂
                                          
                                             
                                                θ
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    =
                                    -
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          ∂
                                          
                                             
                                                θ
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    =
                                    -
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          ∂
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    =
                                    -
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

These two formula induces the formula for the Hessian of the Ricci energy of the whole surface. One can treat the circle packing 
                              
                                 (
                                 Σ
                                 ,
                                 γ
                                 ,
                                 η
                                 ,
                                 ε
                                 )
                              
                            as a power triangulation, which has a dual power diagram 
                              
                                 
                                    
                                       Σ
                                    
                                    
                                       ¯
                                    
                                 
                              
                           . Each edge 
                              
                                 
                                    
                                       e
                                    
                                    
                                       ij
                                    
                                 
                                 ∈
                                 Σ
                              
                            has a dual edge 
                              
                                 
                                    
                                       e
                                    
                                    
                                       ¯
                                    
                                 
                                 ∈
                                 
                                    
                                       Σ
                                    
                                    
                                       ¯
                                    
                                 
                              
                           , then
                              
                                 (4.3)
                                 
                                    
                                       
                                          ∂
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          ∂
                                          
                                             
                                                K
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          |
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                ij
                                             
                                          
                                          |
                                       
                                       
                                          |
                                          
                                             
                                                e
                                             
                                             
                                                ij
                                             
                                          
                                          |
                                       
                                    
                                    ,
                                 
                              
                           and
                              
                                 (4.4)
                                 
                                    
                                       
                                          ∂
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    =
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       
                                          ∂
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

This gives a geometric proof for the symmetry Lemma 3.13 in Euclidean case.

Suppose on the edge 
                              
                                 [
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       j
                                    
                                 
                                 ]
                              
                           , the distance from 
                              
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                              
                            to the perpendicular foot 
                              
                                 
                                    
                                       w
                                    
                                    
                                       k
                                    
                                 
                              
                            is 
                              
                                 
                                    
                                       d
                                    
                                    
                                       ij
                                    
                                 
                              
                           , the distance from 
                              
                                 
                                    
                                       v
                                    
                                    
                                       j
                                    
                                 
                              
                            to 
                              
                                 
                                    
                                       w
                                    
                                    
                                       k
                                    
                                 
                              
                            is 
                              
                                 
                                    
                                       d
                                    
                                    
                                       ji
                                    
                                 
                              
                           , then 
                              
                                 
                                    
                                       l
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       ij
                                    
                                 
                                 +
                                 
                                    
                                       d
                                    
                                    
                                       ji
                                    
                                 
                              
                           , and
                              
                                 
                                    
                                       
                                          ∂
                                          
                                             
                                                l
                                             
                                             
                                                ij
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          d
                                       
                                       
                                          ij
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          ∂
                                          
                                             
                                                l
                                             
                                             
                                                ij
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          d
                                       
                                       
                                          ji
                                       
                                    
                                    ,
                                 
                              
                           furthermore
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          ij
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          d
                                       
                                       
                                          jk
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          d
                                       
                                       
                                          ki
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          d
                                       
                                       
                                          ik
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          d
                                       
                                       
                                          kj
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          d
                                       
                                       
                                          ji
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        

This shows the power circle interpretation is equivalent to Glikenstain’s formulation.

Let 
                           
                              
                                 
                                    ▵
                                 
                                 
                                    123
                                 
                              
                           
                         be a hyperbolic triangle whose vertices are labeled by 1–3. Let 
                           
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    3
                                 
                              
                           
                         be three positive numbers associated to the vertices, and 
                           
                              
                                 
                                    ∊
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    ∊
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    ∊
                                 
                                 
                                    3
                                 
                              
                              ∈
                              {
                              -
                              1
                              ,
                              0
                              ,
                              1
                              }
                           
                         be indicators of the type of the vertices.

For the mixed type of discrete conformal geometry, the edge length of 
                           
                              
                                 
                                    ▵
                                 
                                 
                                    123
                                 
                              
                           
                         is given by
                           
                              
                                 cosh
                                 
                                    
                                       l
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 4
                                 
                                    
                                       η
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       sinh
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       (
                                       1
                                       -
                                       
                                          
                                             ∊
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       cosh
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       1
                                       +
                                       
                                          
                                             ∊
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       sinh
                                       
                                          
                                             r
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       (
                                       1
                                       -
                                       
                                          
                                             ∊
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       cosh
                                       
                                          
                                             r
                                          
                                          
                                             j
                                          
                                       
                                       +
                                       1
                                       +
                                       
                                          
                                             ∊
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       cosh
                                    
                                    
                                       
                                          
                                             ∊
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    
                                       cosh
                                    
                                    
                                       
                                          
                                             ∊
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       j
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              {
                              i
                              ,
                              j
                              ,
                              k
                              }
                              =
                              1
                              ,
                              2
                              ,
                              3
                           
                        .

Via the cosine law, the edge lengths 
                           
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    l
                                 
                                 
                                    3
                                 
                              
                           
                         determine the angles 
                           
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    3
                                 
                              
                           
                        .

When 
                           
                              
                                 
                                    ∊
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    ∊
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    ∊
                                 
                                 
                                    3
                                 
                              
                              =
                              0
                           
                        , this is the case of Yamabe flow. There is a circle passing through the three vertices of 
                           
                              
                                 
                                    ▵
                                 
                                 
                                    123
                                 
                              
                           
                        . It is still called the power circle.

When 
                           
                              
                                 
                                    ∊
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    ∊
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    ∊
                                 
                                 
                                    3
                                 
                              
                              =
                              1
                           
                        , this is the case of inversive distance circle packing. Centered at each vertex i, there is a circle with radius 
                           
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                           
                        . Then there is the power circle orthogonal to the three circles centered at the vertices.

When 
                           
                              
                                 
                                    ∊
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    ∊
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    ∊
                                 
                                 
                                    3
                                 
                              
                              =
                              -
                              1
                           
                        , this is the case of virtual radius circle packing. Let 
                           
                              
                                 
                                    ▵
                                 
                                 
                                    123
                                 
                              
                           
                         be on the equator plane of the ball model of the hyperbolic space 
                           
                              
                                 
                                    H
                                 
                                 
                                    3
                                 
                              
                           
                        . For each vertex i, let 
                           
                              
                                 
                                    ii
                                 
                                 
                                    ′
                                 
                              
                           
                         be the geodesic arc perpendicular to the equator plane with length 
                           
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                           
                        . Assume 
                           
                              
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    3
                                 
                                 
                                    ′
                                 
                              
                           
                         are above the equator plane. There is a hemisphere passing through 
                           
                              
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    3
                                 
                                 
                                    ′
                                 
                              
                           
                         and orthogonal to the equator plane. The power circle in this case is the intersection of the hemisphere and the equator plane.

For a mix type, the power circle can still be defined.

For any type, let 
                           
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                           
                         be the distance from the center of the power circle to the edge ij whose length is 
                           
                              
                                 
                                    l
                                 
                                 
                                    k
                                 
                              
                           
                        .
                           Theorem 4.1
                           
                              Let
                              
                                 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             -
                                             1
                                          
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             +
                                             1
                                          
                                       
                                       =
                                       tanh
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       .
                                    
                                 
                              
                           


                              Then
                              
                                 
                                    
                                       
                                          
                                             ∂
                                             
                                                
                                                   θ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             ∂
                                             
                                                
                                                   θ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              which equal to
                              
                                 
                                    
                                       
                                          
                                             tanh
                                             
                                                
                                                   h
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   sinh
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   l
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                             2
                                             
                                                
                                                   cosh
                                                
                                                
                                                   
                                                      
                                                         ∊
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   cosh
                                                
                                                
                                                   
                                                      
                                                         ∊
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   2
                                                
                                             
                                             cosh
                                             
                                                
                                                   l
                                                
                                                
                                                   3
                                                
                                             
                                             -
                                             
                                                
                                                   cosh
                                                
                                                
                                                   2
                                                   
                                                      
                                                         ∊
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   1
                                                
                                             
                                             -
                                             
                                                
                                                   cosh
                                                
                                                
                                                   2
                                                   
                                                      
                                                         ∊
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

This gives a geometric proof for the symmetry Lemma 3.13 in hyperbolic case.

We only need to prove the theorem for the case of 
                           
                              
                                 
                                    ∊
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    ∊
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    ∊
                                 
                                 
                                    3
                                 
                              
                              =
                              1
                           
                        . General case can be proved similarly.
                           Proof
                           
                              
                                 
                                    
                                       Step 1. Denote the center of the power circle by o, the radius by r. Let 
                                          
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                          
                                        be the distance from o to the vertices 1–3. Then
                                          
                                             (4.5)
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            cosh
                                                            x
                                                            =
                                                            cosh
                                                            r
                                                            cosh
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            cosh
                                                            y
                                                            =
                                                            cosh
                                                            r
                                                            cosh
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            cosh
                                                            z
                                                            =
                                                            cosh
                                                            r
                                                            cosh
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

Let 
                                          
                                             α
                                          
                                        be the angle 
                                          
                                             ∠
                                             13
                                             o
                                          
                                        and 
                                          
                                             β
                                          
                                        the angle 
                                          
                                             ∠
                                             23
                                             o
                                          
                                       . Then 
                                          
                                             α
                                             +
                                             β
                                             =
                                             
                                                
                                                   θ
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       . Therefore
                                          
                                             (4.6)
                                             
                                                1
                                                +
                                                2
                                                cos
                                                α
                                                cos
                                                β
                                                cos
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      3
                                                   
                                                
                                                =
                                                
                                                   
                                                      cos
                                                   
                                                   
                                                      2
                                                   
                                                
                                                α
                                                +
                                                
                                                   
                                                      cos
                                                   
                                                   
                                                      2
                                                   
                                                
                                                β
                                                +
                                                
                                                   
                                                      cos
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      3
                                                   
                                                
                                                .
                                             
                                          
                                       By the cosine law,
                                          
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            cos
                                                            α
                                                            =
                                                            
                                                               
                                                                  -
                                                                  cosh
                                                                  x
                                                                  +
                                                                  cosh
                                                                  z
                                                                  cosh
                                                                  
                                                                     
                                                                        l
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                               
                                                                  sinh
                                                                  z
                                                                  sinh
                                                                  
                                                                     
                                                                        l
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            cos
                                                            β
                                                            =
                                                            
                                                               
                                                                  -
                                                                  cosh
                                                                  y
                                                                  +
                                                                  cosh
                                                                  z
                                                                  cosh
                                                                  
                                                                     
                                                                        l
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                               
                                                               
                                                                  sinh
                                                                  z
                                                                  sinh
                                                                  
                                                                     
                                                                        l
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            cos
                                                            
                                                               
                                                                  θ
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                            =
                                                            
                                                               
                                                                  -
                                                                  cosh
                                                                  
                                                                     
                                                                        l
                                                                     
                                                                     
                                                                        3
                                                                     
                                                                  
                                                                  +
                                                                  cosh
                                                                  
                                                                     
                                                                        l
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                                  cosh
                                                                  
                                                                     
                                                                        l
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                               
                                                                  sinh
                                                                  
                                                                     
                                                                        l
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                                  sinh
                                                                  
                                                                     
                                                                        l
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

Substituting the three formulas into the Eq. (4.6), we obtain a relation between the 6 numbers 
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   l
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   l
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                          
                                       .

Substituting the Eq. (4.5) into this relation, we obtain a relation between 
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   l
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   l
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   r
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   r
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   r
                                                
                                                
                                                   3
                                                
                                             
                                          
                                        and r.

Solving for r, we get 
                                          
                                             
                                                
                                                   cosh
                                                
                                                
                                                   2
                                                
                                             
                                             r
                                             =
                                             
                                                
                                                   N
                                                
                                                
                                                   D
                                                
                                             
                                          
                                       , where
                                          
                                             
                                                N
                                                =
                                                1
                                                +
                                                2
                                                cosh
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      1
                                                   
                                                
                                                cosh
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      2
                                                   
                                                
                                                cosh
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      3
                                                   
                                                
                                                -
                                                
                                                   
                                                      cosh
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      1
                                                   
                                                
                                                -
                                                
                                                   
                                                      cosh
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      2
                                                   
                                                
                                                -
                                                
                                                   
                                                      cosh
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      3
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                D
                                                =
                                                
                                                   
                                                      cosh
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                1
                                                -
                                                
                                                   
                                                      cosh
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                +
                                                2
                                                cosh
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      2
                                                   
                                                
                                                cosh
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      3
                                                   
                                                
                                                (
                                                cosh
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      2
                                                   
                                                
                                                cosh
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      3
                                                   
                                                
                                                -
                                                cosh
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                +
                                                
                                                   
                                                      cosh
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                1
                                                -
                                                
                                                   
                                                      cosh
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                +
                                                2
                                                cosh
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      3
                                                   
                                                
                                                cosh
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                cosh
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      3
                                                   
                                                
                                                cosh
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      1
                                                   
                                                
                                                -
                                                cosh
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                +
                                                
                                                   
                                                      cosh
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      3
                                                   
                                                
                                                (
                                                1
                                                -
                                                
                                                   
                                                      cosh
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                                +
                                                2
                                                cosh
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      1
                                                   
                                                
                                                cosh
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                cosh
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      1
                                                   
                                                
                                                cosh
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      2
                                                   
                                                
                                                -
                                                cosh
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                                .
                                             
                                          
                                       
                                    


                                       Step 2. Since 
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   3
                                                
                                             
                                          
                                        is the height of the triangle 
                                          
                                             
                                                
                                                   ▵
                                                
                                                
                                                   o
                                                   12
                                                
                                             
                                          
                                        with bottom the edge 12. By the standard formula of height of a hyperbolic triangle, we have
                                          
                                             
                                                
                                                   
                                                      sinh
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      3
                                                   
                                                
                                                =
                                                
                                                   
                                                      1
                                                      +
                                                      2
                                                      cosh
                                                      x
                                                      cosh
                                                      y
                                                      cosh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            cosh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      x
                                                      -
                                                      
                                                         
                                                            cosh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      y
                                                      -
                                                      
                                                         
                                                            cosh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            sinh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    

After substituting the Eq. (4.5) into the above formula, we have
                                          
                                             
                                                
                                                   
                                                      tanh
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      3
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            cosh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      r
                                                      (
                                                      2
                                                      cosh
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      cosh
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      cosh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            cosh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            cosh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                      -
                                                      
                                                         
                                                            sinh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            cosh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      r
                                                      (
                                                      2
                                                      cosh
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      cosh
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      cosh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            cosh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            cosh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    

After substituting the equation 
                                          
                                             
                                                
                                                   cosh
                                                
                                                
                                                   2
                                                
                                             
                                             r
                                             =
                                             
                                                
                                                   N
                                                
                                                
                                                   D
                                                
                                             
                                          
                                       , we have
                                          
                                             
                                                
                                                   
                                                      tanh
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      3
                                                   
                                                
                                                =
                                                
                                                   
                                                      N
                                                      (
                                                      2
                                                      cosh
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      cosh
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      cosh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            cosh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            cosh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                      -
                                                      D
                                                      
                                                         
                                                            sinh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                   
                                                      N
                                                      (
                                                      2
                                                      cosh
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      cosh
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      cosh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            cosh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            cosh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    

After substituting the expressions of 
                                          
                                             N
                                          
                                        and 
                                          
                                             D
                                          
                                        in step 1, we have
                                          
                                             
                                                
                                                   
                                                      tanh
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      3
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            [
                                                            (
                                                            cosh
                                                            
                                                               
                                                                  l
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            cosh
                                                            
                                                               
                                                                  l
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                            -
                                                            cosh
                                                            
                                                               
                                                                  l
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            )
                                                            cosh
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            +
                                                            (
                                                            cosh
                                                            
                                                               
                                                                  l
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            cosh
                                                            
                                                               
                                                                  l
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                            -
                                                            cosh
                                                            
                                                               
                                                                  l
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            )
                                                            cosh
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  sinh
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  l
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                            cosh
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                            ]
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      N
                                                      (
                                                      2
                                                      cosh
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      cosh
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      cosh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            cosh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            cosh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    


                                       Step 3. By direct calculation, we have
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      ∂
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      -
                                                      1
                                                   
                                                   
                                                      sin
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      sinh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      sinh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                                (
                                                cosh
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      3
                                                   
                                                
                                                -
                                                
                                                   
                                                      cosh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      cosh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      -
                                                      cosh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            sinh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                                cosh
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      1
                                                   
                                                
                                                -
                                                
                                                   
                                                      cosh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      cosh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      -
                                                      cosh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            sinh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                                cosh
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                =
                                                
                                                   
                                                      (
                                                      cosh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      cosh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      -
                                                      cosh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                      cosh
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      (
                                                      cosh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      cosh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      -
                                                      cosh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      cosh
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            sinh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      cosh
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                      
                                                      ·
                                                      
                                                         
                                                            sinh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    

Comparing with the last formula of step 2, we have
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      ∂
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      tanh
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            sinh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      2
                                                      cosh
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      cosh
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      cosh
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            cosh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            cosh
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                .
                                                
                                                □
                                             
                                          
                                       
                                    

According to a general principle of the relation of hyperbolic geometry and spherical geometry, to obtain a formula in spherical geometry, we only need to replace 
                           
                              sinh
                           
                         and 
                           
                              cosh
                           
                         in hyperbolic geometry by 
                           
                              
                                 
                                    -
                                    1
                                 
                              
                              sin
                           
                         and 
                           
                              cos
                           
                        .

For the mixed type of discrete conformal geometry with spherical background geometry, the edge length of 
                           
                              
                                 
                                    ▵
                                 
                                 
                                    123
                                 
                              
                           
                         is given by
                           
                              
                                 cosh
                                 
                                    
                                       l
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 -
                                 4
                                 
                                    
                                       η
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       sin
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       (
                                       1
                                       -
                                       
                                          
                                             ∊
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       cos
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       1
                                       +
                                       
                                          
                                             ∊
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       sin
                                       
                                          
                                             r
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       (
                                       1
                                       -
                                       
                                          
                                             ∊
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       cos
                                       
                                          
                                             r
                                          
                                          
                                             j
                                          
                                       
                                       +
                                       1
                                       +
                                       
                                          
                                             ∊
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       cos
                                    
                                    
                                       
                                          
                                             ∊
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       cos
                                    
                                    
                                       
                                          
                                             ∊
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       j
                                    
                                 
                                 .
                              
                           
                        
                     

Via the cosine law, the edge lengths 
                           
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    l
                                 
                                 
                                    3
                                 
                              
                           
                         determine the angles 
                           
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    3
                                 
                              
                           
                        .

We can define power circles similarly. Let 
                           
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                           
                         be the distance from the center of the power circle to the edge ij whose length is 
                           
                              
                                 
                                    l
                                 
                                 
                                    k
                                 
                              
                           
                        .
                           Theorem 4.3
                           
                              Let
                              
                                 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       =
                                       tan
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       .
                                    
                                 
                              
                              Then
                              
                                 
                                    
                                       
                                          
                                             ∂
                                             
                                                
                                                   θ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             ∂
                                             
                                                
                                                   θ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              which equal to
                              
                                 
                                    
                                       
                                          
                                             tan
                                             
                                                
                                                   h
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   sin
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   l
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                             -
                                             2
                                             
                                                
                                                   cos
                                                
                                                
                                                   
                                                      
                                                         ∊
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   cos
                                                
                                                
                                                   
                                                      
                                                         ∊
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   2
                                                
                                             
                                             cos
                                             
                                                
                                                   l
                                                
                                                
                                                   3
                                                
                                             
                                             +
                                             
                                                
                                                   cos
                                                
                                                
                                                   2
                                                   
                                                      
                                                         ∊
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   cos
                                                
                                                
                                                   2
                                                   
                                                      
                                                         ∊
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

This gives a geometric proof for the symmetry Lemma 3.13 in spherical case.

This theorem is also proved by using the general principle: replace 
                           
                              sinh
                           
                         and 
                           
                              cosh
                           
                         in hyperbolic geometry by 
                           
                              
                                 
                                    -
                                    1
                                 
                              
                              sin
                           
                         and 
                           
                              cos
                           
                        .

Here we can give the second proof for the symmetry Lemma 3.13 based on the geometric interpretation to the Hessian, which is geometric and intuitive.
                           Proof
                           Formula (4.1) show the symmetry for all schemes with Euclidean background geometry; Theorem 4.1 proves the symmetry for the hyperbolic cases; Theorem 4.3 for the spherical cases.□

The geometric interpretation to Ricci energies of Euclidean and hyperbolic Yamabe schemes were discovered by Bobenko et al. in [11]. The interpretation to Ricci energies of Euclidean schemes (without the mixed type) are illustrated in [5]. In the current work, we generalize the geometric interpretations to all the schemes in all background geometries covered by the unified framework, as shown in Fig. 13.

We use the upper half space model for 
                        
                           
                              
                                 H
                              
                              
                                 3
                              
                           
                        
                     , with Riemannian metric
                        
                           
                              
                                 
                                    ds
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          dx
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          dy
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          dz
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                     the xy-plane is the ideal boundary. Consider a triangle 
                        
                           [
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 k
                              
                           
                           ]
                        
                     , its Ricci energy is closely related to the volume of a generalized hyperbolic tetrahedron whose vertices can be in 
                        
                           
                              
                                 H
                              
                              
                                 3
                              
                           
                        
                     , truncated by a horosphere or truncated by a hyperbolic plane.

In Fig. 9
                     , the generalized hyperbolic tetrahedron has 4 vertices 
                        
                           
                              
                                 w
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 k
                              
                           
                        
                     . The tetrahedron vertex 
                        
                           
                              
                                 w
                              
                              
                                 0
                              
                           
                        
                      is called the top vertex. The 4 faces of the tetrahedron are hyperbolic planes, the 6 edges are geodesics. The 6 edge lengths of the generalized tetrahedron are 
                        
                           -
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                           ,
                           -
                           
                              
                                 u
                              
                              
                                 j
                              
                           
                           ,
                           -
                           
                              
                                 u
                              
                              
                                 k
                              
                           
                        
                      and 
                        
                           
                              
                                 λ
                              
                              
                                 ij
                              
                           
                           ,
                           
                              
                                 λ
                              
                              
                                 jk
                              
                           
                           ,
                           
                              
                                 λ
                              
                              
                                 ki
                              
                           
                        
                     . The generalized tetrahedron is uniquely determined by these 6 edge lengths.

The followings are the common principles for constructing the generalized tetrahedron for all the schemes,
                        
                           1.
                           For all 
                                 
                                    
                                       
                                          E
                                       
                                       
                                          2
                                       
                                    
                                 
                               schemes, the top vertex 
                                 
                                    
                                       
                                          w
                                       
                                       
                                          0
                                       
                                    
                                 
                               is ideal (at infinity) and truncated by a horosphere; for all 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          2
                                       
                                    
                                 
                               schemes, the top vertex is hyperideal (exceeding the boundary of 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          3
                                       
                                    
                                 
                              ) and truncated by a hyperbolic plane; for all 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                 
                               schemes, the top vertex is in 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          3
                                       
                                    
                                 
                              .

For 
                                 
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                 
                              , if the corresponding vertex 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                 
                               is of inversive distance circle packing 
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    +
                                    1
                                 
                              , then it is hyperideal and truncated by a hyperbolic plane; if 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                 
                               is of Yamabe flow 
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    0
                                 
                              , then it is ideal and truncated by a horosphere; if 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                 
                               is virtual radius circle packing 
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    -
                                    1
                                 
                              , then it is in 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          3
                                       
                                    
                                 
                              . Same results holds for 
                                 
                                    
                                       
                                          w
                                       
                                       
                                          j
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          w
                                       
                                       
                                          k
                                       
                                    
                                 
                              .

The edges on the truncated tetrahedron, connecting to the top vertex on the original tetrahedron, have lengths 
                                 
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                 
                               and 
                                 
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          k
                                       
                                    
                                 
                               respectively.

For the edge lengths 
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          ij
                                       
                                    
                                 
                              , there is a unified formula for three geometries: Euclidean, hyperbolic, spherical,
                                 
                                    (5.1)
                                    
                                       
                                          
                                             η
                                          
                                          
                                             ij
                                          
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      -
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

The triangle associated to the top vertex 
                        
                           
                              
                                 w
                              
                              
                                 0
                              
                           
                        
                      is the triangle 
                        
                           [
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 k
                              
                           
                           ]
                        
                     . It is obtained by truncating by a horosphere, truncating by a hyperbolic plane or intersecting with a sphere. Given 
                        
                           -
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                           ,
                           -
                           
                              
                                 u
                              
                              
                                 j
                              
                           
                           ,
                           -
                           
                              
                                 u
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 ij
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 jk
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 ki
                              
                           
                        
                     , using cosine law, we can calculate the edge lengths of the triangle 
                        
                           [
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 k
                              
                           
                           ]
                        
                     . They are exactly given by the formula Eq. (3.3). That means the triangle 
                        
                           [
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 k
                              
                           
                           ]
                        
                      has lengths 
                        
                           
                              
                                 l
                              
                              
                                 ij
                              
                           
                           ,
                           
                              
                                 l
                              
                              
                                 jk
                              
                           
                           ,
                           
                              
                                 l
                              
                              
                                 ki
                              
                           
                        
                      and angles 
                        
                           
                              
                                 θ
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 k
                              
                           
                        
                     .

Here we can give the third proof for the symmetry lemma based on the geometric interpretation to the Ricci energy, which is more geometric, intuitive and much easier to verify.
                        Proof
                        As shown in Fig. 9, for a generalized hyperbolic tetrahedron, the four vertices can have any types. The three vertical edges have lengths 
                              
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                 
                              
                            with dihedral angles 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                 
                              
                           . The bottom edges have lengths 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       jk
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       ki
                                    
                                 
                              
                            with dihedral angles 
                              
                                 
                                    
                                       β
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       jk
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       ki
                                    
                                 
                              
                           .

Let V be the volume of the generalized hyperbolic tetrahedron. By Schläfli formula
                              
                                 (5.2)
                                 
                                    dV
                                    =
                                    -
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             -
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                             d
                                             
                                                
                                                   θ
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   u
                                                
                                                
                                                   j
                                                
                                             
                                             d
                                             
                                                
                                                   θ
                                                
                                                
                                                   j
                                                
                                             
                                             -
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                
                                             
                                             d
                                             
                                                
                                                   θ
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   λ
                                                
                                                
                                                   ij
                                                
                                             
                                             d
                                             
                                                
                                                   β
                                                
                                                
                                                   ij
                                                
                                             
                                             +
                                             
                                                
                                                   λ
                                                
                                                
                                                   jk
                                                
                                             
                                             d
                                             
                                                
                                                   β
                                                
                                                
                                                   jk
                                                
                                             
                                             +
                                             
                                                
                                                   λ
                                                
                                                
                                                   ki
                                                
                                             
                                             d
                                             
                                                
                                                   β
                                                
                                                
                                                   ki
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

During the Ricci flow, the conformal structure coefficients 
                              
                                 
                                    
                                       η
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                                 
                                    
                                       η
                                    
                                    
                                       jk
                                    
                                 
                                 ,
                                 
                                    
                                       η
                                    
                                    
                                       ki
                                    
                                 
                              
                            are invariant, so 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       jk
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       ki
                                    
                                 
                              
                            are fixed. Because the generalized tetrahedron is determined by the edge lengths 
                              
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       jk
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       ki
                                    
                                 
                              
                           , during the flow, all dihedral angles 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       jk
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       ki
                                    
                                 
                              
                            are functions of 
                              
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                 
                              
                           , the volume V is also the function of 
                              
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                 
                              
                           .

Consider the function,
                              
                                 (5.3)
                                 
                                    W
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                       
                                    
                                    -
                                    
                                       
                                          λ
                                       
                                       
                                          ij
                                       
                                    
                                    
                                       
                                          β
                                       
                                       
                                          ij
                                       
                                    
                                    -
                                    
                                       
                                          λ
                                       
                                       
                                          jk
                                       
                                    
                                    
                                       
                                          β
                                       
                                       
                                          jk
                                       
                                    
                                    -
                                    
                                       
                                          λ
                                       
                                       
                                          ki
                                       
                                    
                                    
                                       
                                          β
                                       
                                       
                                          ki
                                       
                                    
                                    -
                                    2
                                    V
                                 
                              
                           hence,
                              
                                 
                                    dW
                                    =
                                    
                                       
                                          θ
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          du
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          du
                                       
                                       
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          du
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    d
                                    
                                       
                                          θ
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    d
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          k
                                       
                                    
                                    d
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                       
                                    
                                    -
                                    
                                       
                                          λ
                                       
                                       
                                          ij
                                       
                                    
                                    d
                                    
                                       
                                          β
                                       
                                       
                                          ij
                                       
                                    
                                    -
                                    
                                       
                                          λ
                                       
                                       
                                          jk
                                       
                                    
                                    d
                                    
                                       
                                          β
                                       
                                       
                                          jk
                                       
                                    
                                    -
                                    
                                       
                                          λ
                                       
                                       
                                          ki
                                       
                                    
                                    d
                                    
                                       
                                          θ
                                       
                                       
                                          ki
                                       
                                    
                                    -
                                    2
                                    dV
                                 
                              
                           substitute Schläfli formula Eq. (5.2), we have
                              
                                 
                                    dW
                                    =
                                    
                                       
                                          θ
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          du
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          du
                                       
                                       
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          du
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                           therefore
                              
                                 
                                    W
                                    =
                                    ∫
                                    
                                       
                                          θ
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          du
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          du
                                       
                                       
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          du
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    c
                                    .
                                 
                              
                           
                           W in fact, is the discrete Ricci energy on face in Eq. (3.5). This shows the differential 1-form
                              
                                 (5.4)
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          du
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          du
                                       
                                       
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          du
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                           is exact, therefore closed. Namely, the Hessian matrix
                              
                                 
                                    
                                       
                                          ∂
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       
                                          ∂
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                u
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           is symmetric.□

The formula Eq. (5.3) represents the Ricci energy on a face as the volume of the generalized hyperbolic tetrahedron with other terms of conformal factors and conformal structure coefficients. This formula was introduced first by Bobenko et al. in [11] for Euclidean and hyperbolic Yamabe flow. In the current work, we generalize it to all 18 schemes. The differential in Eq. (5.4) is independent of the choice of horospheres, since the Schläfli formula is independent of the choice of horospher for an ideal vertex.

@&#EXPERIMENTAL RESULTS@&#

In this section, we report our experimental results based on unified Ricci flow. We thoroughly compare different schemes in terms of robustness, conformality, efficiency and initialization difficulty.

We implemented the unified Ricci flow algorithms using generic C++ language on Windows platform. The method is based on optimizing the convex energy using Newton’s method. The sparse linear systems are solved using Eigen library [45]. The mesh representation is based on dynamic halfedge data structure. The current implementation covers all schemes: tangential circle packing, Thurston’s circle packing, inversive distance circle packing, Yamabe flow, virtual radius circle packing and mixed type schemes, for discrete surfaces with Euclidean and hyperbolic background geometries. The algorithms can handle surfaces different topologies. The package is accessible for the whole research community.

The computational time is tested on the desktop with 2.00GHz CPU, 3.00G RAM. The geometric data sets are from the public databases, such as [46,47]. The human face surfaces were scanned from a high speed and high resolution, phase shifting scanner, as described in [48]. We tested our algorithm on a huge amount of various models, including different sizes and topology types. Some of them are without any refinement or geometric processing, in order to test the robustness of the algorithms. Some of them are re-meshed using the algorithm in [49].


                        Figs. 1 and 2 demonstrate the generality of Ricci flow method to handle surfaces with all possible topologies. Fig. 1 shows the uniformization for closed surfaces, where surfaces are conformally mapped to the unit sphere, Euclidean plane or the hyperbolic disk. Fig. 2 illustrates the uniformization for surfaces with boundaries, where compact surface with boundaries are mapped to constant curvature spaces, such that all boundaries are mapped to geodesic circles. Suggested by Glickenstein: Although there is not currently a robust theory of Ricci flow with boundary in the smooth setting, the discrete Ricci flow can compute the canonical conformal mapping with high efficacy and efficiency. These two figures cover all the topology types of compact surfaces.

The uniformization of the genus zero closed surface can be computed using Ricci flow with spherical background geometry, or Euclidean background geometry. The spherical Ricci energy is non-convex, therefore the spherical Ricci flow is not so stable as the Euclidean Ricci flow. For surface with multiple boundaries, we used Ricci flow method with Koebe’s iteration [50].

In the following we compare different schemes of surface Ricci flow in details.

In practice, the biggest challenge for Ricci flow algorithm is the robustness. Given a target curvature 
                              
                                 
                                    
                                       K
                                    
                                    
                                       ‾
                                    
                                 
                              
                           , we need to ensure the following two points:
                              
                                 1.
                                 The target curvature is admissible, namely, the solution to the Ricci flow Eq. (3.4) exists.

The solution is reachable. It is possible that the flow hits the boundary of the admissible curvature space before it hits the target curvature.

For Tangential circle packing, Thurston’s circle packing, there are theorems describing the admissible curvature spaces [13,9]. For Euclidean (or hyperbolic) Yamabe flow, if the Delaunay condition is preserved during the flow by edge swapping, the admissible curvature space is given in the recent works [29,30].

We test robustness to the mesh qualities of different schemes. As shown in Fig. 10
                           , the low quality meshes are simplified from the raw data, they have many obtuse angles and degenerated triangles; the high quality meshes are obtained using the method in [49]. We use different schemes to compute Riemann mappings. For surfaces with high mesh qualities, all schemes succeed with comparable running time. For surfaces with low mesh qualities, tangential circle packing outperforms all other schemes. The other schemes either crash in the flow process, or pass through with carefully chosen small step length, therefore, the running times are much longer.

If we allow the connectivity to be modified during the flow, to preserve the power Delaunay condition, then all schemes succeed on both surfaces. This shows the preserving the power Delaunay condition greatly improves the robustness of the Ricci flow algorithms.


                           Fig. 11
                            compares the qualities of different schemes: tangential circle packing, inversive distance circle packing, Yamabe flow and virtual radius circle packing. The parameterization is denoted as 
                              
                                 φ
                                 :
                                 M
                                 →
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                              
                           . We calculate each corner angle in the mesh before and after the discrete conformal mapping. Then we compute the ratio between two angle values, take the logarithm. The histogram of the logarithm of the angle ratios is a good measurement for the quality of the discrete conformal mapping. If the mapping has high conformality, then all angle ratios are close to 1, and the histogram is a delta function at 0. Otherwise, the histogram is with high standard deviation. From the histograms in Fig. 11, we can see the tangential circle packing produces mappings with lower conformity. The other three schemes produce mappings with similar conformality.


                           Fig. 12
                           
                            and Table 1
                            show one experiment for comparing the convergence rates of different schemes on four different genus one surfaces. In the experiment, the curvature error threshold is set to 
                              
                                 1
                                 e
                                 -
                                 6
                              
                            the step length in Newton’s method is chosen to be 
                              
                                 5
                                 e
                                 -
                                 1
                              
                           . In the Table 1, each item shows the running time in seconds, and iterations in the optimization. From the table, we can see the running time and iterations of different schemes are similar.

In practice, tangential circle packing is more robust to lower quality mesh qualities, the step length can be chosen to be larger, therefore, it converges faster than other schemes.

In practice, the discrete surfaces are given as triangular meshes, in the initialization stage, we need to convert the edge length function to circle packing metric 
                              
                                 (
                                 Σ
                                 ,
                                 γ
                                 ,
                                 η
                                 ,
                                 ∊
                                 )
                              
                           . For different schemes, this conversion has different level of difficulties.

For tangential circle packing and Yamabe flow, the initializations are easy and the resulting circle packing metrics are unique. The initialization is difficult for Thurston’s circle packing, which requires the intersection angles between two vertex circles are acute, furthermore, the resulting conformal structure coefficient 
                              
                                 η
                                 :
                                 E
                                 →
                                 R
                              
                            may not be unique. For inversive distance, virtual radius and mixed type schemes, the initializations are relatively easier, but the resulting circle packing metrics may not be unique.

In theory, the conformal structure coefficient 
                              
                                 η
                              
                            will affect the admissible curvature space [13,9]. In practice, we haven’t found that different choices of 
                              
                                 η
                              
                           ’s make differences in terms of conformality or robustness.

@&#CONCLUSION@&#

This work establishes a unified framework for discrete surface Ricci flow, which covers most existing schemes: tangential circle packing, Thurston’s circle packing, inversive distance circle packing, discrete Yamabe flow, virtual radius circle packing and mixed scheme, with Spherical, Euclidean and hyperbolic background geometry. The unified frameworks for hyperbolic and spherical schemes are introduced to the literature for the first time. For Euclidean schemes, our formulation is equivalent to Glickenstein’s geometric construction.

Four newly discovered schemes are introduced, which are hyperbolic and Euclidean virtual radius circle packing and the mixed schemes.

This work introduces a geometric interpretation to the Hessian of discrete Ricci energy for all schemes, which generalizes Glickenstein’s formulation in Euclidean case.

This work also gives explicit geometric interpretations to the discrete Ricci energy for all the schemes, which generalizes Bobenko et al. construction [11] for Yamabe flow cases.

The unified frame work deepen our understanding to the discrete surface Ricci flow theory, and inspired us to discover the novel schemes of virtual radius circle packing and the mixed scheme, improved the flexibility and robustness of the algorithms, greatly simplified the implementation and improved the efficiency.

Experimental results show the unified surface Ricci flow algorithms can handle surfaces with all possible topologies. We further compare different schemes in terms of conformality, robustness, convergence rate, and the difficulty level of construction.

In the future, we will focus on answering the following open problems: whether all possible discrete surface Ricci flow schemes are the variations of the current unified approach on the primal meshes and the dual diagrams and so on.

In the appendix, we explain the unified surface Ricci flow Algorithm 1 in details, and reorganize all the formulae necessary for the coding purpose.
                        Algorithm 1
                        Unified Surface Ricci Flow 
                              
                                 
                                    
                                    
                                       
                                          
                                             Require: The inputs include:
                                       
                                       
                                          
                                              1. A triangular mesh 
                                                
                                                   Σ
                                                
                                             , embedded in 
                                                
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             ;
                                       
                                       
                                          
                                              2. The background geometry, 
                                                
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                              or 
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             ;
                                       
                                       
                                          
                                              3. The circle packing scheme, 
                                                
                                                   ∊
                                                   ∈
                                                   {
                                                   +
                                                   1
                                                   ,
                                                   0
                                                   ,
                                                   -
                                                   1
                                                   }
                                                
                                             ;
                                       
                                       
                                          
                                              4. A target curvature 
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                   ,
                                                   ∑
                                                   
                                                      
                                                         
                                                            
                                                               K
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   2
                                                   π
                                                   χ
                                                   (
                                                   Σ
                                                   )
                                                
                                              and 
                                                
                                                   
                                                      
                                                         
                                                            
                                                               K
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ∈
                                                   (
                                                   -
                                                   ∞
                                                   ,
                                                   2
                                                   π
                                                   )
                                                
                                             .
                                       
                                       
                                          
                                              5. Step length 
                                                
                                                   δ
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          
                                             Ensure: A discrete metric conformal to the original one, which realizes the target curvature 
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          1: Initialize the circle radii 
                                                
                                                   γ
                                                
                                             , discrete conformal factor u and conformal structure coefficient 
                                                
                                                   η
                                                
                                             , obtain the initial
                                       
                                       
                                          
                                             circle packing metric 
                                                
                                                   (
                                                   Σ
                                                   ,
                                                   γ
                                                   ,
                                                   η
                                                   ,
                                                   ∊
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          2: while 
                                             
                                                
                                                   
                                                      
                                                         max
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         
                                                            
                                                               K
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   >
                                                   threshold
                                                
                                              
                                             do
                                          
                                       
                                       
                                          3:  Compute the circle radii 
                                                
                                                   γ
                                                
                                              from the conformal factor u
                                          
                                       
                                       
                                          4:  Compute the edge length from 
                                                
                                                   γ
                                                
                                              and 
                                                
                                                   η
                                                
                                             
                                          
                                       
                                       
                                          5:  Compute the corner angle 
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         jk
                                                      
                                                   
                                                
                                              from the edge
                                       
                                       
                                          
                                             length using cosine law
                                       
                                       
                                          6:  Compute the vertex curvature K
                                          
                                       
                                       
                                          7:  Compute the Hessian matrix H
                                          
                                       
                                       
                                          8:  Solve linear system 
                                                
                                                   H
                                                   δ
                                                   u
                                                   =
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                   -
                                                   K
                                                
                                             
                                          
                                       
                                       
                                          9:  Update conformal factor 
                                                
                                                   u
                                                   ←
                                                   u
                                                   -
                                                   δ
                                                   t
                                                   ×
                                                   δ
                                                   u
                                                
                                             
                                          
                                       
                                       
                                          10: end while
                                          
                                       
                                       
                                          11: Output the result circle packing metric.
                                       
                                    
                                 
                              
                           
                        

Depending on different schemes, the initialization of the circle packing is different. The mesh has induced Euclidean metric 
                           
                              
                                 
                                    l
                                 
                                 
                                    ij
                                 
                              
                           
                        . For inversive distance circle packing, we choose
                           
                              
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       
                                          min
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                              
                           
                        this ensures all the vertex circles are separated. For Yamabe flow, we choose all 
                           
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                              
                           
                         to be 1. For virtual radius circle packing, we choose all 
                           
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                              
                           
                        ’s to be 1. Then 
                           
                              
                                 
                                    γ
                                 
                                 
                                    ij
                                 
                              
                           
                         can be computed using the 
                           
                              
                                 
                                    l
                                 
                                 
                                    ij
                                 
                              
                           
                         formula in Table 2
                        .

The computation for circle radii from conformal factor uses the formulae in the first column in Table 2.

The computation of edge lengths from conformal factor u and conformal structure coefficient 
                           
                              η
                           
                         uses the formulae in the 2nd column in Table 2.

The computation from edge length l to the corner angle 
                           
                              θ
                           
                         uses the cosine law formulae,
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   k
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             
                                                
                                                   γ
                                                
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   γ
                                                
                                                
                                                   j
                                                
                                                
                                                   2
                                                
                                             
                                             -
                                             2
                                             
                                                
                                                   l
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   l
                                                
                                                
                                                   j
                                                
                                             
                                             cos
                                             
                                                
                                                   θ
                                                
                                                
                                                   k
                                                
                                             
                                             
                                             
                                                
                                                   E
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             cosh
                                             
                                                
                                                   l
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             cosh
                                             
                                                
                                                   l
                                                
                                                
                                                   i
                                                
                                             
                                             cosh
                                             
                                                
                                                   l
                                                
                                                
                                                   j
                                                
                                             
                                             -
                                             sinh
                                             
                                                
                                                   l
                                                
                                                
                                                   i
                                                
                                             
                                             sinh
                                             
                                                
                                                   l
                                                
                                                
                                                   j
                                                
                                             
                                             cos
                                             
                                                
                                                   θ
                                                
                                                
                                                   k
                                                
                                             
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             cos
                                             
                                                
                                                   l
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             cos
                                             
                                                
                                                   l
                                                
                                                
                                                   i
                                                
                                             
                                             cos
                                             
                                                
                                                   l
                                                
                                                
                                                   j
                                                
                                             
                                             -
                                             sin
                                             
                                                
                                                   l
                                                
                                                
                                                   i
                                                
                                             
                                             sin
                                             
                                                
                                                   l
                                                
                                                
                                                   j
                                                
                                             
                                             cos
                                             
                                                
                                                   θ
                                                
                                                
                                                   k
                                                
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                             
                                             .
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The vertex curvature is defined as angle deficit
                           
                              
                                 K
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   2
                                                   π
                                                   -
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            [
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            ]
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         jk
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                   ∉
                                                   
                                                   ∂
                                                   Σ
                                                   ,
                                                
                                             
                                             
                                                
                                                   π
                                                   -
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            [
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            ]
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         jk
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                   ∉
                                                   
                                                   ∂
                                                   Σ
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        
                           
                              
                                 
                                    
                                       ∂
                                       (
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    
                                       ∂
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 
                                 =
                                 -
                                 
                                    
                                       1
                                    
                                    
                                       2
                                       A
                                    
                                 
                                 L
                                 Θ
                                 
                                    
                                       L
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 D
                                 ,
                              
                           
                        where
                           
                              
                                 A
                                 =
                                 sin
                                 
                                    
                                       θ
                                    
                                    
                                       i
                                    
                                 
                                 s
                                 (
                                 
                                    
                                       l
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 s
                                 (
                                 
                                    
                                       l
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ,
                              
                           
                        and
                           
                              
                                 L
                                 =
                                 diag
                                 (
                                 s
                                 (
                                 
                                    
                                       l
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ,
                                 s
                                 (
                                 
                                    
                                       l
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 ,
                                 s
                                 (
                                 
                                    
                                       l
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 )
                                 ,
                              
                           
                        and
                           
                              
                                 D
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   τ
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   )
                                                
                                                
                                                   τ
                                                   (
                                                   i
                                                   ,
                                                   k
                                                   ,
                                                   j
                                                   )
                                                
                                             
                                             
                                                
                                                   τ
                                                   (
                                                   j
                                                   ,
                                                   i
                                                   ,
                                                   k
                                                   )
                                                
                                                
                                                   0
                                                
                                                
                                                   τ
                                                   (
                                                   j
                                                   ,
                                                   k
                                                   ,
                                                   i
                                                   )
                                                
                                             
                                             
                                                
                                                   τ
                                                   (
                                                   k
                                                   ,
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                
                                                   τ
                                                   (
                                                   k
                                                   ,
                                                   j
                                                   ,
                                                   i
                                                   )
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

If the 
                           
                              Σ
                           
                         is with 
                           
                              
                                 
                                    H
                                 
                                 
                                    2
                                 
                              
                           
                         background geometry, then the Hessian matrix H is positive define; else if 
                           
                              Σ
                           
                         is with 
                           
                              
                                 
                                    E
                                 
                                 
                                    2
                                 
                              
                           
                         background geometry, then H is positive definite on the linear subspace 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              =
                              0
                           
                        . The linear system can be solved using any sparse linear solver, such as Eigen [45].

For discrete surface Ricci flow with topological surgeries, we can add one more step right after step 4. In this new step, we modify the connectivity of 
                           
                              Σ
                           
                         to keep the triangulation to be (Power) Delaunay. This will greatly improves the robustness as proved in [29,30].

@&#REFERENCES@&#

