@&#MAIN-TITLE@&#Graph perturbations and corresponding spectral changes in Internet topologies

@&#HIGHLIGHTS@&#


               Hightlights
               
                  
                     
                        
                           
                           The physical meaning of the normalized Laplacian spectrum for the Internet.


                        
                        
                           
                           Graph perturbations and changes in the weighted spectral distribution.


                        
                        
                           
                           Graph perturbations and changes in the multiplicity of the eigenvalue 1.


                        
                        
                           
                           The two spectral metrics are asymptotically independent of network size.


                        
                        
                           
                           The two spectral metrics are a good choice for study on the Internet optimization.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Weighted spectral distribution

Evolving topology

Autonomous system (AS)

Internet topology

Normalized Laplacian spectrum

@&#ABSTRACT@&#


               
               
                  The normalized Laplacian spectrum (NLS) is a powerful tool for comparing graphs with different sizes. Recently, we showed that two NLS features, namely the weighted spectral distribution (WSD) and the multiplicity of the eigenvalue 1 (ME1), are particularly relevant to the Internet topology at the inter-domain level. In this paper, we examine the physical meaning of the two metrics for the Internet. We show that the WSD reflects the transformation from single-homed nodes to multi-homed nodes for better fault-tolerance and that the ME1 quantifies the initial star-based structure associated with node classification, both of which are critical to the robustness of the Internet structure. We then investigate the relation between the metrics and graph perturbations (i.e., small changes in a graph). We show that these two NLS metrics can be a good choice for study on the Internet optimization. Our work reveals novel insights into the Internet structure and provides useful knowledge for statistical analysis on complex networks.
               
            

@&#INTRODUCTION@&#

Graph spectra (i.e., eigenvalue sets of several matrices, including adjacency, Laplacian and normalized Laplacian matrices) contain a large amount of information on graph structure [1,2]. In contrast to the spectral radii (i.e., maximum eigenvalues) of adjacency and Laplacian matrices, Cetinkaya et al. demonstrated that the normalized Laplacian spectral radius is a good indicator of the connectivity when comparing networks with different sizes [3,4]. The Internet topology evolves over time [5–7]; i.e., metrics weakly related to network size are more important.

The Positive-Feedback Preference (PFP) model [8] is an Internet topology generator based on the Interactive growth mechanism whose inputs are not related to network size and only correspond to mechanisms for the addition of nodes and links. Through comparisons with other commonly used metrics, Jiao et al. [9] found that only the WSD and the ME1 of the NLS are independent of network size and provide sensitive discriminations for each input of the generator PFP; i.e., the two metrics are suitable for capturing evolving features of Internet topologies. Therefore, it is of value to study the relation between graph perturbations in Internet topologies and corresponding changes of the two spectral metrics.

The eigenvectors associated with the largest eigenvalues of the adjacency spectrum can be used to analyze clustering features of the Internet [10], and the eigenvalue power law of the spectrum in the Internet is a direct consequence of the degree distribution of a star-based structure [11]. A metric based on the adjacency spectrum is the natural connectivity [12], which represents the weighted sum of closed walks of all lengths. The second smallest eigenvalue of the Laplacian spectrum, also known as the algebraic connectivity [13], reflects how well connected the overall graph is. Compared with the metrics based on the adjacency and Laplacian spectra, the metrics based on the NLS are more suitable for the comparative analysis of networks with different sizes [3,4,9]. The WSD (i.e., a metric of the NLS) counts the number of N-cycles normalized by the degree of each node in the cycle, which is strongly associated with the distribution of random walk cycles in a network [14]. Fay et al. used the WSD to distinguish different types of graphs, e.g., graphs from network topology generators, Internet application graphs and dK-random graphs [15]. Additionally, Jiao et al. designed an algorithm using the 4-cycle graph structure to calculate the WSD [16]. The NLS eigenvalues lie in the range of zero to two [14] and are quasi-symmetrical about 1 [3,4], while the ranges of the adjacency and Laplacian eigenvalues are not limited [17]. The largest NLS eigenvalues obey a power law [18], and the ME1 of the NLS remains stable over time in spite of the explosive growth of the Internet [19,20]. AS graphs simulated by the Internet topology generator Inet [21] and real topologies were compared and analyzed by Vukadinovic et al. [19,20]. Additionally, they observed that there is a significant difference in the ME1 of the NLS and related the lower bound of the ME1 to a structural classification of nodes in AS graphs [19,20]. Haddadi et al. [22] used the WSD to tune input parameters of Internet topology generators. However, the relation between graph perturbations in AS-level Internet topologies and corresponding changes of the NLS has not been further investigated.

The existing Internet topology generators (e.g., Waxman [23], BA [24], GLP [25], Inet-3.0 [26] and PFP [8]) were compared using the metrics of degree distribution, average neighbor connectivity, clustering coefficient, rich club connectivity, shortest path distribution and WSD [27]. Based on the work of Haddadi et al. [27], Inet-3.0 and PFP outperform other generators because Waxman and BA are too simplistic in the assumptions they make about the connectivity of graphs and only Inet-3.0 and PFP generate topologies with a sufficiently dense core. Additionally, the existing topology generators fail to capture local connectivity, and the metrics such as clustering and WSD should be focused on for tuning and optimizing the topology generators [27].

In this paper, our contributions focus on the relation between graph perturbations in AS-level Internet topologies and corresponding changes of the WSD and the ME1 of the NLS. According to the relation, we can further understand structural characteristics of the Internet topology, and the spectral features of synthetic Internet AS graphs can be tuned and optimized.

Denote by 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           )
                        
                      an undirected and simple graph, where V is the node set and E is the edge set. Let 
                        
                           ∥
                           V
                           ∥
                           =
                           n
                        
                     , 
                        
                           ∥
                           E
                           ∥
                           =
                           m
                        
                     , and dv
                      be the degree of node v in graph G. The normalized Laplacian of graph G is the matrix L(G) defined as follows:

                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          L
                                          
                                             (
                                             G
                                             )
                                          
                                          
                                             (
                                             u
                                             ,
                                             v
                                             )
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            if
                                                            
                                                         
                                                         u
                                                         =
                                                         v
                                                         
                                                         and
                                                         
                                                         
                                                            d
                                                            v
                                                         
                                                         ≠
                                                         0
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         
                                                            1
                                                            
                                                               
                                                                  
                                                                     d
                                                                     u
                                                                  
                                                                  ·
                                                                  
                                                                     d
                                                                     v
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            if
                                                            
                                                         
                                                         u
                                                         
                                                         and
                                                         
                                                         v
                                                         
                                                         
                                                            are
                                                            
                                                            adjacent
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      otherwise
                                                   
                                                
                                             
                                          
                                          
                                          
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

If A is the adjacency matrix of graph G (where 
                        
                           
                              a
                              
                                 i
                                 j
                              
                           
                           =
                           1
                        
                      if there is an edge between vi
                      and vj
                      and 
                        
                           
                              a
                              
                                 i
                                 j
                              
                           
                           =
                           0
                        
                      otherwise) and D is a diagonal matrix with 
                        
                           
                              d
                              
                                 i
                                 i
                              
                           
                           =
                           
                              d
                              
                                 v
                                 i
                              
                           
                        
                     , 
                        
                           L
                           
                              (
                              G
                              )
                           
                           =
                           
                              D
                              
                                 −
                                 1
                                 /
                                 2
                              
                           
                           
                              (
                              D
                              −
                              A
                              )
                           
                           
                              D
                              
                                 −
                                 1
                                 /
                                 2
                              
                           
                        
                     . The NLS is the eigenvalue set of L(G): 
                        
                           0
                           =
                           
                              λ
                              1
                           
                           ≤
                           ⋯
                           ≤
                           
                              λ
                              n
                           
                           ≤
                           2
                        
                     . To find a lower bound for the ME1, Vukadinovic et al. classified nodes in AS graphs into 
                        
                           P
                           
                              (
                              G
                              )
                           
                           =
                           
                              {
                              v
                              ∈
                              V
                              |
                              
                                 d
                                 v
                              
                              =
                              1
                              }
                           
                        
                      called “pendants”, 
                        
                           Q
                           (
                           G
                           )
                           =
                           {
                           v
                           ∈
                           V
                           |
                           ∃
                           w
                           ,
                           (
                           v
                           ,
                           w
                           )
                           ∈
                           E
                           ,
                           w
                           ∈
                           P
                           (
                           G
                           )
                           }
                        
                      called “quasi-pendants” and 
                        
                           R
                           (
                           G
                           )
                           =
                           V
                           ∖
                           (
                           Q
                           (
                           G
                           )
                           ∪
                           P
                           (
                           G
                           )
                           )
                        
                      called “inners” [19,20]. Let p, q, r respectively be the cardinalities of the sets P(G), Q(G) and R(G). Denote by Inner(G) the subgraph of G induced by R(G). Let inn be the number of isolated nodes in Inner(G). Then, Vukadinovic et al. demonstrated the lower bound of the ME1 [19,20]:

                        
                           (2)
                           
                              
                                 
                                    
                                       
                                          M
                                          E
                                          1
                                          ≥
                                          p
                                          −
                                          q
                                          +
                                          i
                                          n
                                          n
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Let 
                        
                           I
                           n
                           n
                           e
                           r
                           
                              (
                              G
                              )
                           
                           =
                           
                              (
                              
                                 V
                                 I
                              
                              ,
                              
                                 E
                                 I
                              
                              )
                           
                        
                      and dI
                     (v) be the degree of node v in subgraph Inner(G). Jiao et al. [9] further divided Inner(G) into 
                        
                           P
                           I
                           =
                           {
                           v
                           ∈
                           
                              V
                              I
                           
                           |
                           
                              d
                              I
                           
                           
                              (
                              v
                              )
                           
                           =
                           1
                           ∧
                           ∀
                           
                              (
                              v
                              ,
                              w
                              )
                           
                           ∈
                           
                              E
                              I
                           
                           ,
                           
                              d
                              I
                           
                           
                              (
                              w
                              )
                           
                           >
                           1
                           }
                        
                      called “inner pendants”, 
                        
                           Q
                           I
                           =
                           {
                           v
                           ∈
                           
                              V
                              I
                           
                           |
                           ∃
                           w
                           ,
                           
                              (
                              v
                              ,
                              w
                              )
                           
                           ∈
                           
                              E
                              I
                           
                           ,
                           w
                           ∈
                           P
                           I
                           }
                        
                      called “inner quasi-pendants”, 
                        
                           R
                           I
                           =
                        
                      {v ∈ VI
                     |dI
                     (v) ≥ 2∧∀(v, w) ∈ EI, w ∈ QI} called “inner restricted nodes”, 
                        
                           B
                           I
                           =
                           {
                           v
                           ∈
                           
                              V
                              I
                           
                           |
                           
                              d
                              I
                           
                           
                              (
                              v
                              )
                           
                           =
                           1
                           ∧
                        
                     
                     
                        
                           ∀
                           
                              (
                              v
                              ,
                              w
                              )
                           
                           ∈
                           
                              E
                              I
                           
                           ,
                           
                              d
                              I
                           
                           
                              
                                 (
                                 w
                                 )
                              
                              =
                              1
                              }
                           
                        
                      called “inner binate nodes”, 
                        
                           I
                           I
                           =
                           {
                           v
                           ∈
                           
                              V
                              I
                           
                           |
                           
                              d
                              I
                           
                           
                              (
                              v
                              )
                           
                           =
                           0
                           }
                        
                      called “inner isolated nodes” and 
                        
                           O
                           I
                           =
                           
                              V
                              I
                           
                           
                              ∖
                              S
                              I
                           
                        
                      called “inner other nodes” where 
                        
                           S
                           I
                           =
                           P
                           I
                           ∪
                           Q
                           I
                           ∪
                           R
                           I
                           ∪
                           B
                           I
                           ∪
                           I
                           I
                        
                      called “inner summation nodes”. Let pi, qi, ri, bi, ii, si, oi respectively be the cardinalities of the sets PI, QI, RI, BI, II, SI and OI. Then, Jiao et al. confirmed the following approximate equation relationship [9]:

                        
                           (3)
                           
                              
                                 
                                    
                                       
                                          r
                                          ≈
                                          s
                                          i
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    
                                       
                                          M
                                          E
                                          1
                                          ≈
                                          p
                                          −
                                          q
                                          +
                                          p
                                          i
                                          +
                                          r
                                          i
                                          −
                                          q
                                          i
                                          +
                                          i
                                          i
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

To find a collective metric of the NLS, Fay and Haddadi et al. defined the WSD as the sum over all N-cycles 
                        
                           C
                           =
                           
                              u
                              1
                           
                           
                              u
                              2
                           
                           …
                           
                              u
                              N
                           
                        
                      in graph G 
                     [14,15,22,27]:

                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          W
                                          
                                             (
                                             G
                                             ,
                                             N
                                             )
                                          
                                          =
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   ⋯
                                                   ,
                                                   n
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         1
                                                         −
                                                         
                                                            λ
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                
                                                N
                                             
                                          
                                          =
                                          
                                             ∑
                                             C
                                          
                                          
                                             1
                                             
                                                
                                                   d
                                                   
                                                      u
                                                      1
                                                   
                                                
                                                
                                                   d
                                                   
                                                      u
                                                      2
                                                   
                                                
                                                …
                                                
                                                   d
                                                   
                                                      u
                                                      N
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Calculating the eigenvalues of a large (even sparse) matrix is computationally expensive. Therefore, Fay and Haddadi et al. [14,15,22,27] estimated the distribution of eigenvalues 
                        
                           f
                           (
                           λ
                           =
                           θ
                           )
                        
                      using Sylvester's Law of Inertia [28] to calculate the percentage of eigenvalues that fall in a given interval, and the WSD can be transformed into:

                        
                           (6)
                           
                              
                                 
                                    
                                       
                                          W
                                          
                                             (
                                             G
                                             ,
                                             N
                                             )
                                          
                                          ≈
                                          
                                             ∑
                                             
                                                θ
                                                ∈
                                                Ω
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         1
                                                         −
                                                         θ
                                                      
                                                      )
                                                   
                                                
                                                N
                                             
                                             ·
                                             f
                                             
                                                (
                                                λ
                                                =
                                                θ
                                                )
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     where Ω denotes equally spaced bins in [0, 2]. According to Eqs. (5) and (6), the WSD is weakly related to the ME1. In general, the sum of 4-cycles with the normalization of node degrees represents the quasi-randomness of a graph in the non-regular case [15]. Thus, Fay and Haddadi et al. [14,15] considered four to be the suitable value of parameter N.
                     
                  

An intuitive application of the relation studied in this paper is to optimize the NLS features in synthetic Internet AS graphs. The core problem of the optimization is to select an appropriate cost function (e.g., spectral radius [29], algebraic connectivity [30] and weighted spectrum [22]) that reflects those aspects of the graph that are important to the user. Such a selection process is inherently subjective; i.e., there is no "best" cost function in general [22]. Once a suitable cost function is selected, the real meaning of “network optimization” is to tune synthetic graphs to produce output that optimally matches said cost function with minimum changes.

To verify the correctness of our contributions, we consider the WSD and the ME1 of the NLS as the cost function to optimize synthetic AS graphs. Please note that the main theme of this paper is to study the graph perturbation properties of the WSD and the ME1. The "network optimization" is one example for the application of our contributions. Our observed real topology dataset comes from the ITDK of CAIDA Skitter project [31,32], which is obtained by running traceroutes over a large range of IP addresses and mapping the prefixes to AS numbers using RouteViews BGP data. Because the Skitter data represents paths that have actually been traversed by packets to their destinations, rather than paths calculated and propagated by the BGP system, it is more likely to faithfully represent the AS topology than the BGP data alone.

To compare two AS graphs, the WSD and the ME1 only need to be calculated two times, while they have to be calculated many times to lead the optimization of the NLS. The ITDK provides mappings from routers to regions and mappings from routers to AS nodes. Thus, the AS subgraphs of different regions can be constructed where the connection relationships between AS nodes are built by the links between routers located in a certain region. AS nodes may span across regions; i.e., some AS nodes may be allocated into different AS subgraphs. The Chinese AS subgraph with 84 nodes has been obtained by Zhou et al. [33], who compared the small-scale graph with the global topology and found that the Chinese AS-level topology preserves well structural characteristics of the global Internet. The connection patterns between routers are strongly related to geographical distance, and all AS nodes exceeding a certain threshold in size are maximally dispersed geographically [34], which is an important evidence for the study of Zhou et al. [33]. Additionally, the Chinese AS graph with 84 nodes has been utilized for comparisons between the existing topology generators [27]. Therefore, the geographical decomposition of the global Internet topology is an effective method to decrease the time for calculating the WSD and the ME1.

The NLS eigenvalues are quasi-symmetrical about 1 [3,4] and 
                        
                           
                              (
                              1
                              −
                              θ
                              )
                           
                           N
                        
                      tends to zero with θ close to 1 and increasing N. Thus, the WSD is strongly related to the WSD
                     
                        
                           t
                        
                      derived from Eq. (6), where 
                        
                           Ω
                           ∈
                           
                              
                                 {
                                 
                                    (
                                    
                                       2
                                       (
                                       i
                                       −
                                       1
                                       )
                                       /
                                       k
                                       ,
                                    
                                 
                                 
                                    
                                       2
                                       i
                                       /
                                       k
                                    
                                    ]
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              t
                           
                        
                     , 
                        
                           θ
                           =
                           (
                           2
                           i
                           −
                           1
                           )
                           /
                           k
                        
                      and t < k/2. The parameter k represents the number of equally spaced bins in [0, 2], which depends on the granularity required.


                     Table 1 lists some subgraphs with the largest number of nodes and shows that the graph of the US in the snapshot of April 2013 can be further decomposed into various US regions. If 
                        
                           k
                           =
                           30
                        
                      and 
                        
                           t
                           =
                           10
                        
                     , the WSD is approximately equal to 2WSD
                     
                        
                           t
                        
                     , as shown in Table 1. Thus, the WSD can be replaced by WSD
                     
                        
                           t
                        
                      for faster calculation [9]. According to the quasi-symmetry of eigenvalues about 1 [3,4], the eigenvalues from 0 to 1 are sufficient for the description of the WSD [14,22,27], and we can determine that 
                        
                           M
                           E
                           1
                           ≈
                           n
                           −
                           2
                           ·
                           
                              
                                 (
                                 1
                                 −
                                 e
                                 p
                                 s
                                 )
                              
                              −
                           
                        
                      
                     [9] where 
                        
                           e
                           p
                           s
                           =
                           
                              10
                              
                                 −
                                 6
                              
                           
                        
                      and 
                        
                           
                              (
                              1
                              −
                              e
                              p
                              s
                              )
                           
                           −
                        
                      is the number of eigenvalues smaller than 
                        
                           1
                           −
                           e
                           p
                           s
                        
                      calculated by Sylvester's Law of Inertia [28].

The WSD is weakly related to the ME1; i.e., graph perturbations with WSD
                     
                        
                           t
                        
                      should be under the constraint that the ME1 is unaltered. Based on Eq. (4), the constraint means that 
                        
                           s
                           t
                           a
                           v
                           a
                           l
                           u
                           e
                           =
                        
                     
                     
                        
                           p
                           −
                           q
                           +
                           p
                           i
                           +
                           r
                           i
                           −
                           q
                           i
                           +
                           i
                           i
                        
                      should be constant. Let di
                      and dj
                      be the degrees of nodes i and j, respectively, and f(di
                     ) and f(dj
                     ) be the frequencies of those degrees. Winick [26] defined the weighted value of dj
                      with respect to di
                      as

                        
                           (7)
                           
                              
                                 
                                    
                                       
                                          M
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          =
                                          max
                                          
                                             (
                                             
                                                1
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  log
                                                                  
                                                                     
                                                                        d
                                                                        i
                                                                     
                                                                     
                                                                        d
                                                                        j
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         2
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  log
                                                                  
                                                                     
                                                                        f
                                                                        (
                                                                        
                                                                           d
                                                                           i
                                                                        
                                                                        )
                                                                     
                                                                     
                                                                        f
                                                                        (
                                                                        
                                                                           d
                                                                           f
                                                                        
                                                                        )
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         2
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          ·
                                          
                                             d
                                             j
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     which has been used for calculating the probability linking node i to node j in the topology generator Inet-3.0 [26]. In subgraph Inner(G), let Nr(v) be the set of nodes attached to node v. According to the notations defined in Section 2, we divide PI into 
                        
                           P
                           
                              I
                              1
                           
                           =
                           
                              {
                              v
                              ∈
                              P
                              I
                              |
                           
                           ∃
                           w
                           ∈
                           Q
                           I
                           ,
                           v
                           =
                        
                     
                     
                        
                           
                              arg
                              u
                           
                           
                              max
                              
                                 u
                                 ∈
                                 N
                                 r
                                 (
                                 w
                                 )
                                 ∩
                                 P
                                 I
                              
                           
                           
                              M
                              
                                 (
                                 u
                                 ,
                                 w
                                 )
                              
                              }
                           
                        
                      and 
                        
                           P
                           
                              I
                              2
                           
                           
                              =
                              P
                              I
                              ∖
                              P
                           
                           
                              I
                              1
                           
                        
                     ; i.e., 
                        
                           C
                           a
                           r
                           d
                           (
                           P
                           
                              I
                              1
                           
                           )
                           =
                           q
                           i
                        
                      (denote by Card( · ) the cardinality of a set). In subgraph 
                        
                           I
                           n
                           n
                           e
                           r
                           
                              (
                              G
                              )
                           
                           =
                           
                              (
                              
                                 V
                                 I
                              
                              ,
                              
                                 E
                                 I
                              
                              )
                           
                        
                     , QI will not be altered if the connection relationships of nodes in PI
                     1 have not been changed.


                     
                        Theorem 1
                        For an Internet AS graph 
                              
                                 G
                                 =
                                 (
                                 V
                                 ,
                                 E
                                 )
                              
                           , 
                              
                                 s
                                 t
                                 a
                                 v
                                 a
                                 l
                                 u
                                 e
                                 =
                                 p
                                 −
                                 q
                                 +
                                 p
                                 i
                                 +
                                 r
                                 i
                                 −
                                 q
                                 i
                                 +
                                 i
                                 i
                              
                            is constant when (see Appendix A for the proof)

                              
                                 (i)
                                 Add an edge (u, v)∉E, where u ≠ v, u ∈ Q(G) and v ∈ Q(G)∪VI
                                    .

Delete an edge (u, v) ∈ E, where u ≠ v, u ∈ Q(G), du
                                     > 2, v ∈ Q(G)∪VI, dv
                                     > 2 if v ∈ Q(G), Card({(w, v) ∈ E|w ∈ Q(G)}) > 1 if v ∈ PI, and Card({(w, v) ∈ E|w ∈ Q(G)}) > 2 if v ∈ II.

Add an edge (u, v)∉E, where u ≠ v, u ∈ QI and v ∈ PI
                                    2∪RI∪II.

Delete an edge (u, v) ∈ E, where u ≠ v, u ∈ QI, dI
                                    (u) > 2, v ∈ PI
                                    2∪RI, Card({(w, v) ∈ E|w ∈ Q(G)}) > 1 if v ∈ PI
                                    2, and Card({(w, v)|w ∈ Q(G)}) > 0 if v ∈ RI∧Card({(w, v) ∈ E|w ∈ 
                                       
                                          
                                             
                                                Q
                                                I
                                             
                                             }
                                          
                                          )
                                          =
                                          2
                                       
                                     (denote by dI
                                    (u) the degree of node u in Inner(G)).⬜

Denote by AddSet the edge set to be added associated with the above operators (i) and (iii) and by DelSet the edge set to be deleted associated with the above operators (ii) and (iv). Based on Eq. (4), the ME1 can be controlled if graph perturbations with WSD
                     
                        
                           t
                        
                      are restricted in AddSet and DelSet. The real AS subgraph of RU listed in Table 1 is used for the following illustration.

Let Wt
                     (u, v) be the WSD
                     
                        
                           t
                        
                     of a graph induced by adding or deleting an edge (u, v) ∈ AddSet ∪DelSet for AS graph G. We sort edges (u, v) ∈ AddSet using two metrics, 
                        
                           M
                           
                              C
                              1
                           
                           =
                           
                              |
                              
                                 d
                                 u
                              
                              −
                              
                                 d
                                 v
                              
                              |
                           
                        
                      and 
                        
                           M
                           
                              C
                              2
                           
                           =
                           max
                           
                              (
                              
                                 d
                                 u
                              
                              ,
                              
                                 d
                                 v
                              
                              )
                           
                        
                     . The Wt
                     (u, v) curves of the two metrics are shown in Fig. 1.
                  

Edges with top largest MC
                     1 link two nodes with high-small degrees, and edges with top smallest MC
                     2 link two nodes with small-small degrees. According to Table 1 and Fig. 1, connecting two nodes with high-small degrees can steadily decrease WSD
                     
                        
                           t
                        
                     . Because k-degree node u corresponds to at least k
                     2 4-cycles (i.e., u–vi
                     –u–vj
                     –u with i,j  =  1,2,…,k) where v
                     1,v
                     2,…,vk
                      are all nodes attached to node u, the 4-cycle number of a high-degree node is extremely large compared to that of a small-degree node. Based on Eq. (5), WSD
                     
                        
                           t
                        
                      is decided by the 4-cycle number and node degrees. For a high-degree node, the degree increasing by 1 extremely decreases the sum over all 4-cycles (normalized by the node degrees) of that node. For edges with high-small degrees, Fig. 2(
                     a) shows the ratio of the number of newly increased 4-cycles induced by adding an edge to the original 4-cycle number of the two connected nodes. The very small ratio shown in Fig. 2(a) provides the evidence for Fig. 1(
                     a). For an edge with small-small degrees, both the number of newly increased 4-cycles induced by adding the edge and the original 4-cycle number of the two connected nodes are small, which induces the uncertainty of WSD
                     
                        
                           t
                        
                     , as shown in Fig. 1(
                     b).

Deleting an edge is an inverse process of adding an edge; i.e., shearing an edge with high-small degrees tends to increase WSD
                     
                        
                           t
                        
                     . The number of edges with small-small degrees in DelSet is small because small-degree nodes tend to link high-degree nodes based on the attachment models of Internet topologies [26]. Thus, all edges in DelSet are included in Fig. 2(b).

Denote by AddSet(TA
                     ) the top TA
                      edges in AddSet with decreasing order of MC
                     1. Sort the edges with increasing order of Wt
                     (u, v), and let 
                        
                           A
                           d
                           d
                           S
                           e
                           t
                           
                              (
                              
                                 T
                                 A
                              
                              )
                           
                           =
                           
                              
                                 {
                                 
                                    e
                                    i
                                    a
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 T
                                 A
                              
                           
                        
                      where 
                        
                           
                              W
                              t
                           
                           
                              (
                              
                                 e
                                 1
                                 a
                              
                              )
                           
                           ≤
                        
                     
                     
                        
                           
                              W
                              t
                           
                           
                              (
                              
                                 e
                                 2
                                 a
                              
                              )
                           
                           ≤
                           ⋯
                           ≤
                           
                              W
                              t
                           
                           
                              (
                              
                                 e
                                 
                                    
                                       T
                                       A
                                    
                                 
                                 a
                              
                              )
                           
                        
                     . Simultaneously, denote by DelSet(TD
                     ) the top TD
                      edges in DelSet with decreasing order of MC
                     1. Let 
                        
                           D
                           e
                           l
                           S
                           e
                           t
                           
                              (
                              
                                 T
                                 D
                              
                              )
                           
                           =
                           
                              
                                 {
                                 
                                    e
                                    i
                                    d
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 T
                                 D
                              
                           
                        
                      where 
                        
                           
                              W
                              t
                           
                           
                              (
                              
                                 e
                                 1
                                 d
                              
                              )
                           
                           ≥
                           
                              W
                              t
                           
                           
                              (
                              
                                 e
                                 2
                                 d
                              
                              )
                           
                           ≥
                           ⋯
                           ≥
                        
                     
                     
                        
                           
                              W
                              t
                           
                           
                              (
                              
                                 e
                                 
                                    
                                       T
                                       D
                                    
                                 
                                 d
                              
                              )
                           
                        
                     . Denote by 
                        
                           
                              
                                 W
                                 ¯
                              
                              A
                           
                           
                              (
                              s
                              )
                           
                        
                      the WSD
                     
                        
                           t
                        
                      of a graph induced by adding a series of edges 
                        
                           
                              {
                              
                                 e
                                 i
                                 a
                              
                              }
                           
                           
                              i
                              =
                              1
                           
                           s
                        
                      to AS graph G and by 
                        
                           
                              
                                 W
                                 ¯
                              
                              D
                           
                           
                              (
                              s
                              )
                           
                        
                      the WSD
                     
                        
                           t
                        
                      of a graph induced by deleting a series of edges 
                        
                           
                              {
                              
                                 e
                                 i
                                 d
                              
                              }
                           
                           
                              i
                              =
                              1
                           
                           s
                        
                      from AS graph G. Please note that the consecutive deletion should not alter nodes in sets P(G) and QI; otherwise, the stavalue value may not be constant. If the deletion of edge 
                        
                           e
                           s
                           d
                        
                      alters nodes in P(G) and QI, add the edge to AS graph G again and let 
                        
                           
                              
                                 W
                                 ¯
                              
                              D
                           
                           
                              (
                              s
                              )
                           
                           =
                           
                              
                                 W
                                 ¯
                              
                              D
                           
                           
                              (
                              s
                              −
                              1
                              )
                           
                        
                     . The 
                        
                           
                              
                                 W
                                 ¯
                              
                              A
                           
                           
                              (
                              s
                              )
                           
                        
                      and 
                        
                           
                              
                                 W
                                 ¯
                              
                              D
                           
                           
                              (
                              s
                              )
                           
                        
                      curves in Fig. 3 show that WSD
                     
                        
                           t
                        
                     monotonically decreases or increases.

Denote by 
                        
                           
                              
                                 M
                                 ¯
                              
                              A
                           
                           
                              (
                              
                                 s
                                 A
                              
                              )
                           
                        
                      the ME1 of a graph induced by adding a series of edges 
                        
                           
                              {
                              
                                 e
                                 i
                                 a
                              
                              }
                           
                           
                              i
                              =
                              1
                           
                           
                              s
                              A
                           
                        
                      and by 
                        
                           
                              
                                 M
                                 ¯
                              
                              D
                           
                           
                              (
                              
                                 s
                                 D
                              
                              )
                           
                        
                      the ME1 of a graph induced by deleting a series of edges 
                        
                           
                              {
                              
                                 e
                                 i
                                 d
                              
                              }
                           
                           
                              i
                              =
                              1
                           
                           
                              s
                              D
                           
                        
                     . The consecutive deletion should not alter nodes in sets P(G) and QI. The statistical values of 
                        
                           
                              
                                 M
                                 ¯
                              
                              A
                           
                           
                              (
                              
                                 s
                                 A
                              
                              )
                           
                        
                      and 
                        
                           
                              
                                 M
                                 ¯
                              
                              D
                           
                           
                              (
                              
                                 s
                                 D
                              
                              )
                           
                        
                     , where 
                        
                           
                              s
                              A
                           
                           ∈
                           
                              {
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              C
                              a
                              r
                              d
                              
                                 (
                                 A
                                 d
                                 d
                                 S
                                 e
                                 t
                                 )
                              
                              }
                           
                        
                      and 
                        
                           
                              s
                              D
                           
                           ∈
                           
                              {
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              C
                              a
                              r
                              d
                              
                                 (
                                 D
                                 e
                                 l
                                 S
                                 e
                                 t
                                 )
                              
                              }
                           
                        
                     , are listed in Table 2
                     , which verifies the invariability of the ME1.
                  

In general, it is not necessary to decrease the WSD
                     
                        
                           t
                        
                      of an AS graph by an extreme amount; i.e., the parameter TA
                      may be obviously smaller compared to the scenario in Fig. 3(a). According to the analyses of Fig. 4
                     , a lower bound Tlow
                      (e.g., 5000 for RU and 1000 for DE) should be given for the TA
                      value; i.e., with a smaller value of TA
                     ( ≥ Tlow
                     ), the 
                        
                           
                              
                                 W
                                 ¯
                              
                              A
                           
                           
                              (
                              s
                              )
                           
                        
                      curve corresponds to a faster descent speed (because edges with large values of MC
                     1 are sorted ahead in the edge set 
                        
                           
                              {
                              
                                 e
                                 i
                                 a
                              
                              }
                           
                           
                              i
                              =
                              1
                           
                           
                              T
                              A
                           
                        
                     ). A faster descent speed of the curve implies that graph perturbations of AS graph G may be much smaller with a given WSD
                     
                        
                           t
                        
                     .


                     Inputs: An AS graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           )
                        
                     , a given WSD
                     
                        
                           t
                        
                     (Wobj
                     ) and two given thresholds (Tlow, Tupper
                     ).


                     Step 1. Let Worg
                      be the WSD
                     
                        
                           t
                        
                      value of AS graph G. If Wobj
                      > Worg
                     , calculate the edge set 
                        
                           D
                           e
                           l
                           S
                           e
                           t
                           
                              (
                              
                                 T
                                 D
                              
                              )
                           
                           =
                           
                              
                                 {
                                 
                                    e
                                    i
                                    d
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 T
                                 D
                              
                           
                        
                     , where 
                        
                           
                              W
                              t
                           
                           
                              (
                              
                                 e
                                 1
                                 d
                              
                              )
                           
                           ≥
                           ⋯
                           ≥
                           
                              W
                              t
                           
                           
                              (
                              
                                 e
                                 
                                    
                                       T
                                       D
                                    
                                 
                                 d
                              
                              )
                           
                        
                      and 
                        
                           
                              T
                              D
                           
                           =
                           C
                           a
                           r
                           d
                           
                              (
                              D
                              e
                              l
                              S
                              e
                              t
                              )
                           
                        
                     , and use the bisection method (because 
                        
                           
                              
                                 W
                                 ¯
                              
                              D
                           
                           
                              (
                              s
                              )
                           
                        
                      monotonically increases) to calculate

                        
                           (8)
                           
                              
                                 
                                    
                                       
                                          
                                             s
                                             
                                                o
                                                b
                                                j
                                             
                                          
                                          =
                                          
                                             arg
                                             s
                                          
                                          
                                             min
                                             
                                                s
                                                =
                                                1
                                                ,
                                                ⋯
                                                ,
                                                
                                                   T
                                                   D
                                                
                                             
                                          
                                          
                                             |
                                             
                                                
                                                   W
                                                   ¯
                                                
                                                D
                                             
                                             
                                                (
                                                s
                                                )
                                             
                                             −
                                             
                                                W
                                                
                                                   o
                                                   b
                                                   j
                                                
                                             
                                             |
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Then, delete the edges 
                        
                           
                              {
                              
                                 e
                                 i
                                 d
                              
                              }
                           
                           
                              i
                              =
                              1
                           
                           
                              s
                              
                                 o
                                 b
                                 j
                              
                           
                        
                      from AS graph G and conclude the algorithm.

If Wobj
                      < Worg
                     , calculate the edge set AddSet, let 
                        
                           
                              T
                              A
                           
                           :
                           =
                           
                              T
                              
                                 l
                                 o
                                 w
                              
                           
                        
                     , and go to Step 2.


                     Step 2. Calculate 
                        
                           A
                           d
                           d
                           S
                           e
                           t
                           
                              (
                              
                                 T
                                 A
                              
                              )
                           
                           =
                           
                              
                                 {
                                 
                                    e
                                    i
                                    a
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 T
                                 A
                              
                           
                        
                     , where 
                        
                           
                              W
                              t
                           
                           
                              (
                              
                                 e
                                 1
                                 a
                              
                              )
                           
                           ≤
                           ⋯
                           ≤
                           
                              W
                              t
                           
                           
                              (
                              
                                 e
                                 
                                    
                                       T
                                       A
                                    
                                 
                                 a
                              
                              )
                           
                        
                     . If 
                        
                           
                              
                                 W
                                 ¯
                              
                              A
                           
                           
                              (
                              
                                 T
                                 A
                              
                              )
                           
                           <
                           
                              W
                              
                                 o
                                 b
                                 j
                              
                           
                        
                     , use the bisection method (because 
                        
                           
                              
                                 W
                                 ¯
                              
                              A
                           
                           
                              (
                              s
                              )
                           
                        
                      monotonically decreases) to calculate

                        
                           (9)
                           
                              
                                 
                                    
                                       
                                          
                                             s
                                             
                                                o
                                                b
                                                j
                                             
                                          
                                          =
                                          
                                             arg
                                             s
                                          
                                          
                                             min
                                             
                                                s
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                
                                                   T
                                                   A
                                                
                                             
                                          
                                          
                                             |
                                             
                                                
                                                   W
                                                   ¯
                                                
                                                A
                                             
                                             
                                                (
                                                s
                                                )
                                             
                                             −
                                             
                                                W
                                                
                                                   o
                                                   b
                                                   j
                                                
                                             
                                             |
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Then, add the edges 
                        
                           
                              {
                              
                                 e
                                 i
                                 a
                              
                              }
                           
                           
                              i
                              =
                              1
                           
                           
                              s
                              
                                 o
                                 b
                                 j
                              
                           
                        
                      to AS graph G, and conclude the algorithm.

If 
                        
                           
                              
                                 W
                                 ¯
                              
                              A
                           
                           
                              (
                              
                                 T
                                 A
                              
                              )
                           
                           ≥
                           
                              W
                              
                                 o
                                 b
                                 j
                              
                           
                        
                      and TA
                      ≤ Tupper
                     , let 
                        
                           
                              T
                              A
                           
                           :
                           =
                           
                              T
                              A
                           
                           +
                           1000
                        
                      and go to Step 2. If TA
                      > Tupper
                     , conclude the algorithm and AS graph G cannot be perturbed with Wobj
                     .⬜

The time complexity of the algorithm depends on the calculation of 
                        
                           
                              {
                              
                                 
                                    W
                                    t
                                 
                                 
                                    (
                                    
                                       e
                                       i
                                       a
                                    
                                    )
                                 
                              
                              }
                           
                           
                              i
                              =
                              1
                           
                           
                              T
                              A
                           
                        
                     (or 
                        
                           
                              {
                              
                                 
                                    W
                                    t
                                 
                                 
                                    (
                                    
                                       e
                                       i
                                       d
                                    
                                    )
                                 
                              
                              }
                           
                           
                              i
                              =
                              1
                           
                           
                              T
                              D
                           
                        
                     ),which is proportional to the parameter TA
                     (or TD
                     ). The bisection methods used in Eqs. (8) and (9) only correspond to 
                        
                           
                              
                                 W
                                 ¯
                              
                              D
                           
                           
                              (
                              s
                              )
                           
                        
                      and 
                        
                           
                              
                                 W
                                 ¯
                              
                              A
                           
                           
                              (
                              s
                              )
                           
                        
                      calculated log2(TD
                     ) and log2(TA
                     ) times.

The statistical values of the real AS subgraph RU are listed in Table 3, which implies that there is an extremely small influence on the ME1 for the above algorithm, and the perturbations with a given WSD
                     
                        
                           t
                        
                      are effective and can control the alteration of connection relationships between nodes.

Perturbation effects of four other metrics with different Wobj
                      values are shown in Fig. 5:
                      with descending Wobj
                     , the curves in Fig. 5(a)–(c) ascend and the curve in Fig. 5(d) moves toward the y-axis. The phenomena are induced by the increase of edges to decrease Wobj
                     .

To explain the eigenvalue power law of Internet AS graphs, Francesc et al. [11] constructed a deterministic star-based model of Internet topologies, as shown in Fig. 6(
                     a). The model has two components: the tree component that contains all nodes that belong exclusively to trees having a depth of one (i.e., star subgraphs) and the core component that contains all roots of the trees [36].
                  

Francesc's model is closer to Internet AS topologies before 1999 because most of the tree-nodes have a degree of one [36]. However, increasingly more single-homed nodes want to become multi-homed for better fault-tolerance [37]. Based on the extension of Francesc's model shown in Fig. 6(b), we illustrate the physical meaning of the WSD and the ME1.

In Fig. 6(b), dotted lines connect various single-homed nodes to nodes in the core component, which provides better fault-tolerance because of the increased number of multi-homed nodes. More multi-homed nodes means that more edges linking high-small degree nodes are added into the AS graph. According to Sections 4 and 5, the consecutive addition of these edges can steadily decrease the WSD. Thus, the WSD plausibly represents the occupancy of multi-homed nodes in AS graphs.

The ME1 shows the classification of nodes in P(G), Q(G), PI, QI, RI, BI and II defined in Section 2. In Fig. 6(b), for a root node in the core component, if all of its child nodes in the tree component are transformed into multi-homed nodes, it tends to fall in QI and BI, such as nodes 18, 19 and 20 in QI and node 17 in BI; otherwise, it tends to fall in Q(G), such as nodes 14, 15 and 16. Thus, the core of an Internet AS graph is composed of nodes in Q(G)∪QI and part of the nodes in BI. In Fig. 6(b), nodes 9, 10, 11 and 13 fall in PI because they are attached to nodes in Q(G) by dotted lines, while node 12 falls in RI because it is attached to a node in QI by a dotted line. In the real RU AS subgraph in the snapshot of April 2013, there are 155 nodes in PI, which is an extremely larger amount than the 4 nodes in RI because the highest-degree nodes of AS graphs mainly fall in Q(G) and these nodes can attract more nodes to connect with them. In Fig. 6(b), nodes 2 and 4 are attached to nodes in Q(G) by dotted lines, so they fall in II(node 5 falls in PI). The highest-degree nodes in Q(G) induce the number of nodes in II to be large; for example, 599 nodes of the real RU AS subgraph (April 2013) fall in II.

According to the above analyses, the structural classification of the ME1 plausibly reflects the initial star-based structure of the Internet and the tendency that increasingly more single-homed nodes want to become multi-homed for better fault-tolerance.

Additionally, we use the stochastic model PFP [8] to illustrate the structural classification. PFP has three inputs, where p* and q* are probabilities for selecting mechanisms to add 1-degree nodes, 
                        
                           1
                           −
                           
                              p
                              *
                           
                           −
                           
                              q
                              *
                           
                        
                      is a probability for selecting one mechanism to add 2-degree nodes, and δ is used to calculate the nonlinear preferential attachment probability. In the evolving Internet topology, most of the newly added small-degree nodes are linked by other nodes with a very small probability. Thus, the newly added 1-degree nodes are the main source of P(G), and the newly added 2-degree nodes are the main source of subgraph Inner(G). The newly added 2-degree nodes tend to link two (or one) quasi-pendants (with high degree and linked by pendants in P(G)); i.e., after removing nodes in P(G) and Q(G), the degree of nodes in subgraph Inner(G) corresponds to zero or one with a very high probability, which can explain the structural classification of the ME1.

Based on deterministic and stochastic models of the Internet topology, we have explained the generation process of the structural classification of the ME1. The right-hand side of Eq. (4), i.e., 
                        
                           s
                           t
                           a
                           v
                           a
                           l
                           u
                           e
                           =
                           p
                           −
                           q
                           +
                           p
                           i
                           +
                           r
                           i
                           −
                           q
                           i
                           +
                           i
                           i
                        
                     , can be adjusted using the alteration of connection relationships. Thus, the left-hand side of Eq. (4), i.e., the ME1, can be perturbed in a controllable way. In general, parameters p and q depend on the fraction of 1-degree nodes and the preferential attachment model, which have been paid more attention by existing topology generators, e.g., PFP and Inet-3.0. Therefore, we only consider the adjustment in subgraph Inner(G).

In subgraph Inner(G), divide OI into 
                        
                           O
                           
                              I
                              1
                           
                           =
                           
                              {
                              
                                 v
                                 ∈
                                 O
                                 I
                                 |
                              
                              
                                 C
                                 a
                                 r
                                 d
                                 (
                                 
                                    N
                                    r
                                    (
                                    v
                                    )
                                    ∖
                                    Q
                                    I
                                 
                                 )
                                 =
                                 1
                              
                              }
                           
                        
                      and 
                        
                           O
                           
                              I
                              2
                           
                           =
                        
                      
                     OI\OI
                     1, where Nr(v) includes all nodes attached to node v.

The notations used in this section are defined in Sections 2 and 4.


                     
                        Theorem 2
                        
                           
                              
                                 s
                                 t
                                 a
                                 v
                                 a
                                 l
                                 u
                                 e
                                 :
                                 =
                                 s
                                 t
                                 a
                                 v
                                 a
                                 l
                                 u
                                 e
                                 −
                                 2
                              
                            if adding an edge (v
                           1, v
                           2), where v
                           1, v
                           2 ∈ II.


                     
                        Theorem 3
                        
                           
                              
                                 s
                                 t
                                 a
                                 v
                                 a
                                 l
                                 u
                                 e
                                 :
                                 =
                                 s
                                 t
                                 a
                                 v
                                 a
                                 l
                                 u
                                 e
                                 −
                                 2
                              
                            if adding an edge (v
                           1, v
                           2), where v
                           1 ∈ II, v
                           2 ∈ PI
                           2.


                     
                        Theorem 4
                        
                           
                              
                                 s
                                 t
                                 a
                                 v
                                 a
                                 l
                                 u
                                 e
                                 :
                                 =
                                 s
                                 t
                                 a
                                 v
                                 a
                                 l
                                 u
                                 e
                                 +
                                 l
                                 −
                                 1
                              
                            if adding an edge (v
                           1, v
                           2), where v
                           1 ∈ II and v
                           2
                           
                              
                                 ∈
                                 {
                                 
                                    v
                                    ∈
                                    O
                                    I
                                    |
                                    C
                                    a
                                    r
                                    d
                                    (
                                    
                                       N
                                       r
                                       
                                          (
                                          v
                                          )
                                       
                                       ∩
                                       O
                                       
                                          I
                                          1
                                       
                                    
                                    )
                                    =
                                    l
                                 
                                 }
                              
                           .


                     
                        Theorem 5
                        
                           
                              
                                 s
                                 t
                                 a
                                 v
                                 a
                                 l
                                 u
                                 e
                                 :
                                 =
                                 s
                                 t
                                 a
                                 v
                                 a
                                 l
                                 u
                                 e
                                 −
                                 1
                              
                            if adding an edge (v
                           1, v
                           2), where v
                           1 ∈ PI
                           2, v
                           2 ∈ OI.


                     
                        Theorem 6
                        
                           
                              
                                 s
                                 t
                                 a
                                 v
                                 a
                                 l
                                 u
                                 e
                                 :
                                 =
                                 s
                                 t
                                 a
                                 v
                                 a
                                 l
                                 u
                                 e
                                 +
                                 2
                              
                            induced by the following three operators: (i) delete an edge (v
                           1, v
                           2) where v
                           1, v
                           2 ∈ BI and 
                              
                                 
                                    v
                                    2
                                 
                                 =
                                 N
                                 r
                                 
                                    (
                                    
                                       v
                                       1
                                    
                                    )
                                 
                              
                           ; (ii) if 
                              
                                 C
                                 a
                                 r
                                 d
                                 (
                                 
                                    {
                                    
                                       
                                          (
                                          
                                             v
                                             1
                                          
                                          ,
                                          w
                                          )
                                       
                                       
                                          ∈
                                          E
                                          |
                                          w
                                          ∈
                                          Q
                                       
                                       
                                          (
                                          G
                                          )
                                       
                                    
                                    }
                                 
                                 )
                                 =
                                 1
                              
                           , add an edge (v
                           1, w
                           1) where (v
                           1, w
                           1)∉E and w
                           1 ∈ Q(G); and (iii) if Card({(v
                           2, w) ∈ E|w ∈ 
                              
                                 
                                    
                                       Q
                                       (
                                       G
                                       )
                                    
                                    }
                                 
                                 )
                                 =
                                 1
                              
                           , add an edge (v
                           2, w
                           2) where (v
                           2, w
                           2)∉E and w
                           2 ∈ Q(G).


                     
                        Theorem 7
                        
                           
                              
                                 s
                                 t
                                 a
                                 v
                                 a
                                 l
                                 u
                                 e
                                 :
                                 ≥
                                 s
                                 t
                                 a
                                 v
                                 a
                                 l
                                 u
                                 e
                                 +
                                 1
                              
                            induced by the following four operators: i) let v
                           1 ∈ OI and delete all edges {(v
                           1, v
                           2)}, where v
                           2 ∈ Nr(v
                           1)\QI; ii) if v
                           1 is transformed into PI induced by i) and 
                              
                                 C
                                 a
                                 r
                                 d
                                 (
                                 
                                    {
                                    
                                       
                                          (
                                          
                                             v
                                             1
                                          
                                          ,
                                          w
                                          )
                                       
                                       
                                          ∈
                                          E
                                          |
                                          w
                                          ∈
                                          Q
                                       
                                       
                                          (
                                          G
                                          )
                                       
                                    
                                    }
                                 
                                 )
                                 =
                                 0
                              
                           , add an edge (v
                           1, w
                           1) where (v
                           1, w
                           1)∉E and w
                           1 ∈ Q(G); iii) if v
                           1 is transformed into II induced by i) and Card({(v
                           1, w) ∈ E|w ∈ Q(G)}) < 2, add one or two edges to ensure 
                              
                                 C
                                 a
                                 r
                                 d
                                 (
                                 
                                    {
                                    
                                       
                                          (
                                          
                                             v
                                             1
                                          
                                          ,
                                          w
                                          )
                                       
                                       
                                          ∈
                                          E
                                          |
                                          w
                                          ∈
                                          Q
                                       
                                       
                                          (
                                          G
                                          )
                                       
                                    
                                    }
                                 
                                 )
                                 =
                                 2
                              
                           ; and iv) if v
                           2 is transformed into PI∪BI induced by i) and 
                              
                                 C
                                 a
                                 r
                                 d
                                 (
                                 
                                    {
                                    
                                       
                                          (
                                          
                                             v
                                             2
                                          
                                          ,
                                          w
                                          )
                                       
                                       
                                          ∈
                                          E
                                          |
                                          w
                                          ∈
                                          Q
                                       
                                       
                                          (
                                          G
                                          )
                                       
                                    
                                    }
                                 
                                 )
                                 =
                                 0
                              
                           , add an edge (v
                           2, w
                           2) where (v
                           2, w
                           2)∉E and w
                           2 ∈ Q(G). (see Appendix A for the proofs)

According to the analyses of Section 6, nodes in Q(G), QI and part of the nodes in BI generate the core of Internet AS graphs; i.e., in Francesc's deterministic model shown in Fig. 6, the periphery of AS graphs is composed of nodes in P(G), PI, RI, II and the rest of the nodes in BI. In Fig. 6, the nodes in BI originate from the star subgraph having only two nodes (one root and one leaf), e.g., nodes 17 and 8. Thus, the core and peripheral nodes plausibly represent equal portions in BI; i.e., the number of core and peripheral nodes are 
                        
                           q
                           +
                           q
                           i
                           +
                           b
                           i
                           /
                           2
                        
                      and 
                        
                           p
                           +
                           p
                           i
                           +
                           r
                           i
                           +
                           i
                           i
                           +
                           b
                           i
                           /
                           2
                        
                     , respectively. Therefore, 
                        
                           p
                           −
                           q
                           +
                           p
                           i
                           +
                           r
                           i
                           −
                           q
                           i
                           +
                           i
                           i
                        
                      can be considered as the peripheral node number minus the core node number, which is a further explanation for the physical meaning of the ME1. Theorems 2–7 exhibit some intuitive methods to adjust the core and peripheral node percentages, which effectively perturbs the ME1 according to our requirement.

In this section, our contributions are used for the optimization of synthetic Internet AS graphs generated by Inet-3.0. The core problem of "optimization" is to select a cost function that reflects those aspects of the graph that are important to the user [22,29,30]. We consider the WSD and the ME1 of the NLS as the cost function. Then, the real meaning of "network optimization" is to tune synthetic AS graphs to optimally match the cost function with minimum changes. We use the generator Inet-3.0 because its inputs (i.e., node degree distribution and fraction of 1-degree nodes) are easy to evaluate according to real Internet AS subgraphs obtained in Section 3.

The WSD is a collective metric of the NLS, but Eq. (6) provides a two-dimensional display of the eigenvalue distribution with different weights 
                        
                           
                              (
                              
                                 1
                                 −
                                 θ
                              
                              )
                           
                           N
                        
                     . To compare two AS graphs G
                     1 and G
                     2, based on Eq. (6), Fay et al. [14] defined a new metric as follows:

                        
                           (10)
                           
                              
                                 
                                    
                                       
                                          D
                                          
                                             (
                                             G
                                             ,
                                             N
                                             )
                                          
                                          =
                                          
                                             ∑
                                             
                                                θ
                                                ∈
                                                Ω
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         1
                                                         −
                                                         θ
                                                      
                                                      )
                                                   
                                                
                                                N
                                             
                                             ·
                                             
                                                |
                                                
                                                   
                                                      f
                                                      1
                                                   
                                                   
                                                      (
                                                      λ
                                                      =
                                                      θ
                                                      )
                                                   
                                                   −
                                                   
                                                      f
                                                      2
                                                   
                                                   
                                                      (
                                                      λ
                                                      =
                                                      θ
                                                      )
                                                   
                                                
                                                |
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where f
                     1 and f
                     2 are the eigenvalue distributions of G
                     1 and G
                     2, respectively, and Ω denotes equally spaced bins in [0, 2]. Based on the fact that the WSD can be replaced by WSD
                     
                        
                           t
                        
                      for faster calculation, D(G, N) can be replaced by Dt
                     (G, N), where 
                        
                           Ω
                           ∈
                           
                              
                                 {
                                 
                                    (
                                    
                                       2
                                       (
                                       i
                                       −
                                       1
                                       )
                                       /
                                       k
                                       ,
                                    
                                 
                                 
                                    
                                       2
                                       i
                                       /
                                       k
                                    
                                    ]
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              t
                           
                        
                     , 
                        
                           θ
                           =
                        
                     
                     
                        
                           (
                           2
                           i
                           −
                           1
                           )
                           /
                           k
                        
                     , 
                        
                           k
                           =
                           30
                        
                      and 
                        
                           t
                           =
                           10
                        
                     . Specifically, D(G, N) ≈ 2 · Dt
                     (G, N).

In contrast to WSD
                     
                        
                           t
                        
                     , Dt
                     (G, N) contains more information. Thus, the Dt
                     (G, N) metric, which measures the difference between a synthetic graph and the corresponding real Internet AS subgraph, can be used for more accurate optimization of the WSD.

According to the studies of Sections 4–7, we can design the ME1 optimization algorithm (see Appendix B) and the WSD optimization algorithm (see Appendix C). To verify the correctness of our contributions, we use the algorithms to optimize 6-by-100 synthetic AS graphs generated by Inet-3.0 according to the NLS features of six real Internet AS subgraphs. The experimental results of these graphs are shown in Table 4 and Fig. 7
                     , which verify that the optimization of the NLS is effective and that the corresponding perturbations on AS graphs are very small.
                  

The WSD represents the local connectivity of AS graphs [27], which is potentially critical when studying properties of routing protocols. Additionally, based on Sections 6 and 7, we have further explained the physical meaning of the WSD and the ME1: the WSD measures the fault-tolerance of AS graphs because the consecutive addition of edges with high-small degrees increases the multi- homed node percentage and steadily decreases the WSD; the ME1 reflects the decomposition of core and peripheral nodes that is generated by the initial star-based structure of the Internet and the tendency that increasingly more single-homed nodes want to become multi-homed.

Moreover, the WSD and the ME1 of the NLS remain stable in spite of the explosive growth of the Internet [9]. Thus, it is worth selecting the two spectral metrics as the cost function to tune synthetic AS graphs. There is no "best" cost function in general [22,29,30]; i.e., other features of the Internet may not be optimized by the work of this paper. However, our contributions are useful explorations for the study of complex features embedded in the Internet AS topology.

Research to date has analyzed the Internet AS-level topology at a worldwide level of detail, which is useful when the Internet is analyzed at a very coarse level. However, it may be misleading if the analysis is more focused on a specific geographical region [38]. Currently, increasingly more literature has focused on region-level Internet topologies [39,40] because the region competitiveness is reflected in the AS growth pattern. The structural similarities between region graphs and the global AS-level topology have been analyzed in Section 3. Therefore, the subgraphs based on geographical decomposition are sufficient for the research of graph perturbations with the NLS. Additionally, the average time to optimize synthetic AS graphs of the US (Oct 2011 with 6331 AS nodes) is restricted to seven hours, which is tolerable for our computers.

@&#CONCLUSION@&#

This paper focuses on the relation between graph perturbations and corresponding changes in the WSD and the ME1, and analyzes the physical meaning of the two spectral metrics embedded in Internet AS graphs, e.g., node classification, initial star-based structure, multi-homed transformation and core-periphery decomposition. The two metrics reflect the NLS features with eigenvalues not only toward 0 (and 2) but also restricted to 1; i.e., they can be considered as the cost function representing the NLS. Additionally, they are independent of the network size of evolving AS graphs. Therefore, our contributions are useful for understanding the Internet structure and leading future applications of the NLS in AS graphs.

@&#ACKNOWLEDGMENT@&#

We would like to thank the anonymous reviewers for their comments and suggestions, which helped improve this paper, and the CAIDA Skitter project for providing real topology datasets and information for the decomposition of the topology. This paper is supported by the National Natural Science Foundation of China (Grant nos. 61402485 and 71201169).


                     
                        Proof of Theorem 1
                        Operations (i), (ii), (iii) and (iv) cannot alter the 1-degree node number and the connection relationships of nodes in P(G). Thus, p and q are unaltered. Operators (i) and (ii) are unrelated to subgraph Inner(G), which means that pi, qi, ri, ii are unaltered. Operators (iii) and (iv) cannot alter nodes in QI. Thus, the alterations induced by operator (iii) are restricted to two possible scenarios: either nodes in PI
                           2 are transformed into RI or nodes in II are transformed into PI
                           2; i.e., 
                              
                                 p
                                 i
                                 +
                                 r
                                 i
                                 +
                                 i
                                 i
                              
                            is unaltered. The alterations induced by operator iv) are restricted to two possible scenarios: either nodes in PI
                           2 are transformed into II or nodes in RI are transformed into PI
                           2; i.e., 
                              
                                 p
                                 i
                                 +
                                 r
                                 i
                                 +
                                 i
                                 i
                              
                            is unaltered. Therefore, stavalue
                           
                              
                                 =
                                 p
                                 −
                                 q
                                 +
                                 p
                                 i
                                 +
                              
                           
                           
                              
                                 r
                                 i
                                 −
                                 q
                                 i
                                 +
                                 i
                                 i
                              
                            is constant.⬜


                     
                        Proof of Theorem 2
                        The addition of the edge induces the state that 
                              
                                 i
                                 i
                                 :
                                 =
                                 i
                                 i
                                 −
                                 2
                              
                            and p, q, pi, qi, ri are unaltered; i.e., 
                              
                                 s
                                 t
                                 a
                                 v
                                 a
                                 l
                                 u
                                 e
                                 =
                                 p
                                 −
                                 q
                                 +
                                 p
                                 i
                                 +
                                 r
                                 i
                                 −
                                 q
                                 i
                                 +
                                 i
                                 i
                              
                            decreases by 2.⬜


                     
                        Proof of Theorem 3
                        The addition of the edge induces the state that 
                              
                                 i
                                 i
                                 :
                                 =
                                 i
                                 i
                                 −
                                 1
                              
                           , 
                              
                                 q
                                 i
                                 :
                                 =
                                 q
                                 i
                                 +
                                 1
                              
                            and p, q, pi, ri are unaltered; i.e., 
                              
                                 s
                                 t
                                 a
                                 v
                                 a
                                 l
                                 u
                                 e
                                 =
                                 p
                                 −
                                 q
                                 +
                                 p
                                 i
                                 +
                                 r
                                 i
                                 −
                                 q
                                 i
                                 +
                                 i
                                 i
                              
                            decreases by 2.⬜


                     
                        Proof of Theorem 4
                        The addition of the edge induces the state that 
                              
                                 i
                                 i
                                 :
                                 =
                                 i
                                 i
                                 −
                                 1
                              
                           , 
                              
                                 p
                                 i
                                 :
                                 =
                                 p
                                 i
                                 +
                                 1
                              
                           , 
                              
                                 q
                                 i
                                 :
                                 =
                                 q
                                 i
                                 +
                                 1
                              
                           , 
                              
                                 r
                                 i
                                 :
                                 =
                                 r
                                 i
                                 +
                                 l
                              
                            and p, q are unaltered; i.e., 
                              
                                 s
                                 t
                                 a
                                 v
                                 a
                                 l
                                 u
                                 e
                                 =
                                 p
                                 −
                                 q
                                 +
                                 p
                                 i
                                 +
                                 r
                                 i
                                 −
                                 q
                                 i
                                 +
                                 i
                                 i
                              
                            decreases by 1 if 
                              
                                 l
                                 =
                                 0
                              
                            and increases by 
                              
                                 l
                                 −
                                 1
                              
                            if l ≥ 2.⬜


                     
                        Proof of Theorem 5
                        The addition of the edge induces the state that 
                              
                                 p
                                 i
                                 :
                                 =
                                 p
                                 i
                                 −
                                 1
                              
                            and p, q, qi, ri, ii are unaltered; i.e., 
                              
                                 s
                                 t
                                 a
                                 v
                                 a
                                 l
                                 u
                                 e
                                 =
                                 p
                                 −
                                 q
                                 +
                                 p
                                 i
                                 +
                                 r
                                 i
                                 −
                                 q
                                 i
                                 +
                                 i
                                 i
                              
                            decreases by 1.⬜


                     
                        Proof of Theorem 6
                        Nodes v
                           1 and v
                           2 cannot be transformed into pendants based on the operators (ii) and (iii); i.e., p and q are unaltered. Operator (i) induces the state that 
                              
                                 i
                                 i
                                 :
                                 =
                                 i
                                 i
                                 +
                                 2
                              
                            and pi, qi, ri are unaltered; i.e., 
                              
                                 s
                                 t
                                 a
                                 v
                                 a
                                 l
                                 u
                                 e
                                 =
                                 p
                                 −
                                 q
                                 +
                                 p
                                 i
                                 +
                                 r
                                 i
                                 −
                                 q
                                 i
                                 +
                                 i
                                 i
                              
                            increases by 2.⬜


                     
                        Proof of Theorem 7
                        The structural classification of nodes belonging to PI, RI, II, BI and QI cannot be altered by operator (i) due to v
                           1, v
                           2 ∈ OI. Nodes v
                           1 and v
                           2 cannot be transformed into pendants based on the operators (ii)–iv); i.e., p and q are unaltered. Node v
                           2 cannot be transformed into II. If node v
                           2 is transformed into PI, the number of newly increased nodes in QI is no more than the number of newly increased nodes in PI; i.e., 
                              
                                 p
                                 i
                                 −
                                 q
                                 i
                              
                            does not decrease. Node v
                           1 must be transformed into II, PI or RI according to different Card(Nr(v
                           1)∩QI) values; i.e., 
                              
                                 s
                                 t
                                 a
                                 v
                                 a
                                 l
                                 u
                                 e
                                 =
                                 p
                                 −
                                 q
                                 +
                                 p
                                 i
                                 +
                                 r
                                 i
                                 −
                                 q
                                 i
                                 +
                                 i
                                 i
                              
                            increases and 
                              
                                 s
                                 t
                                 a
                                 v
                                 a
                                 l
                                 u
                                 e
                                 :
                                 ≥
                                 s
                                 t
                                 a
                                 v
                                 a
                                 l
                                 u
                                 e
                                 +
                                 1
                              
                           .⬜

Based on the ME1 stabilization [19], the eigenvalue power law [18] and the quasi-symmetry of the NLS about 1 [3,4], objective parameters for the optimization can be evaluated [9], e.g., the ME1 mobj
                     (1) and the distribution of eigenvalues falling in intervals 
                        
                           
                              {
                              
                                 (
                                 
                                    2
                                    (
                                    i
                                    −
                                    1
                                    )
                                    /
                                    k
                                    ,
                                 
                              
                              
                                 
                                    2
                                    i
                                    /
                                    k
                                 
                                 ]
                              
                              }
                           
                           
                              i
                              =
                              1
                           
                           t
                        
                     (i.e., 
                        
                           
                              {
                              
                                 w
                                 
                                    o
                                    b
                                    j
                                 
                                 i
                              
                              }
                           
                           
                              i
                              =
                              1
                           
                           t
                        
                     ).

According to Theorems 2–7, we can design the optimization algorithm for synthetic Internet AS subgraphs generated by Inet-3.0. The algorithm is designed as follows:


                     Inputs: A synthetic Internet AS subgraph G, three objective values mobj
                     (1), 
                        
                           
                              {
                              
                                 w
                                 
                                    o
                                    b
                                    j
                                 
                                 i
                              
                              }
                           
                           
                              i
                              =
                              1
                           
                           t
                        
                      and 
                        
                           
                              W
                              
                                 o
                                 b
                                 j
                              
                           
                           =
                           
                              ∑
                              
                                 l
                                 =
                                 1
                              
                              t
                           
                           
                              
                                 
                                    (
                                    
                                       1
                                       −
                                       
                                          
                                             
                                                2
                                                l
                                                −
                                                1
                                             
                                             k
                                          
                                       
                                    
                                    )
                                 
                                 N
                              
                              ·
                              
                                 w
                                 
                                    o
                                    b
                                    j
                                 
                                 l
                              
                           
                        
                     (i.e., the WSDt
                      of the real AS subgraph) and a threshold T.


                     Step 1. Estimate 
                        
                           M
                           E
                           1
                           ≈
                           n
                           −
                           2
                           ·
                           
                              
                                 (
                                 1
                                 −
                                 e
                                 p
                                 s
                                 )
                              
                              −
                           
                        
                      and the WSDt
                      of graph G. Divide graph G into P(G), Q(G) and R(G), and divide subgraph Inner(G) into PI(PI
                     1∪PI
                     2), QI, RI, II, BI and OI(OI
                     1∪OI
                     2). If 
                        
                           M
                           E
                           1
                           >
                           
                              m
                              
                                 o
                                 b
                                 j
                              
                           
                           
                              (
                              1
                              )
                           
                           +
                           2
                        
                     , go to Step 2. If 
                        
                           M
                           E
                           1
                           <
                           
                              m
                              
                                 o
                                 b
                                 j
                              
                           
                           
                              (
                              1
                              )
                           
                           −
                           2
                        
                     , go to Step 3. Otherwise, conclude the optimization.


                     Step 2. Let 
                        
                           A
                           l
                           t
                           S
                           e
                           t
                           =
                           
                              {
                              
                                 
                                    (
                                    
                                       v
                                       1
                                    
                                    ,
                                    
                                       v
                                       2
                                    
                                    )
                                 
                                 
                                    |
                                 
                                 
                                    v
                                    1
                                 
                                 ∈
                                 O
                                 I
                                 ,
                                 
                                    v
                                    2
                                 
                                 ∈
                                 P
                                 
                                    I
                                    2
                                 
                              
                              }
                           
                           
                              ∪
                              {
                           
                           
                              
                                 (
                                 
                                    v
                                    1
                                 
                                 ,
                                 
                                    v
                                    2
                                 
                                 )
                              
                              
                                 |
                              
                              
                                 v
                                 1
                              
                              ≠
                              
                                 v
                                 2
                              
                              ,
                              
                                 v
                                 1
                              
                              ∈
                              I
                              I
                              ∪
                              P
                              
                                 I
                                 2
                              
                              ∪
                           
                           S
                           e
                           t
                           ,
                        
                      
                     v
                     2 ∈ II}, where 
                        
                           
                              S
                              e
                              t
                              =
                              {
                              
                                 
                                    v
                                    ¯
                                 
                                 
                                    ∈
                                    O
                                    I
                                    |
                                 
                              
                              C
                              a
                              r
                              d
                              
                                 (
                                 
                                    N
                                    r
                                    
                                       (
                                       
                                          v
                                          ¯
                                       
                                       )
                                    
                                    ∩
                                    O
                                    
                                       I
                                       1
                                    
                                 
                                 )
                              
                              =
                              0
                           
                           
                              }
                           
                        
                     . If 
                        
                           C
                           a
                           r
                           d
                           (
                           
                              A
                              l
                              t
                              S
                              e
                              t
                           
                           )
                           =
                           0
                        
                     , conclude the optimization. If Card(AltSet) > 0, do the following:

Denote by 
                        
                           A
                           l
                           t
                           S
                           e
                           t
                           
                              (
                              T
                              )
                           
                           =
                           
                              
                                 {
                                 
                                    e
                                    i
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              T
                           
                        
                      the top T edges in AltSet with decreasing order of MC
                     1
                     
                        
                           
                              =
                              |
                           
                           
                              d
                              u
                           
                           −
                           
                              d
                              v
                           
                           
                              |
                           
                        
                      if WSDt
                      ≥ Wobj
                      and by 
                        
                           A
                           l
                           t
                           S
                           e
                           t
                           
                              (
                              T
                              )
                           
                           =
                           
                              
                                 {
                                 
                                    e
                                    i
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              T
                           
                        
                      the top T edges in AltSet with increasing order of 
                        
                           M
                           
                              C
                              2
                           
                           =
                           max
                           
                              (
                              
                                 d
                                 u
                              
                              ,
                              
                                 d
                                 v
                              
                              )
                           
                        
                      if WSDt
                      < Wobj
                     .

Denote by Gi
                      the graph induced by adding the edge ei
                      into graph G. Let

                        
                           (B.1)
                           
                              
                                 
                                    
                                       
                                          
                                             D
                                             t
                                          
                                          
                                             (
                                             
                                                G
                                                i
                                             
                                             ,
                                             N
                                             )
                                          
                                          =
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             t
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         1
                                                         −
                                                         
                                                            
                                                               
                                                                  2
                                                                  l
                                                                  −
                                                                  1
                                                               
                                                               k
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                                N
                                             
                                             ·
                                             
                                                |
                                                
                                                   
                                                      w
                                                      
                                                         
                                                            G
                                                            i
                                                         
                                                      
                                                      l
                                                   
                                                   −
                                                   
                                                      w
                                                      
                                                         o
                                                         b
                                                         j
                                                      
                                                      l
                                                   
                                                
                                                |
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              {
                              
                                 w
                                 
                                    
                                       G
                                       i
                                    
                                 
                                 l
                              
                              }
                           
                           
                              l
                              =
                              1
                           
                           t
                        
                      denotes the distribution of eigenvalues falling in 
                        
                           
                              {
                              
                                 (
                                 
                                    2
                                    (
                                    l
                                    −
                                    1
                                    )
                                    /
                                    k
                                    ,
                                 
                              
                              
                                 
                                    2
                                    l
                                    /
                                    k
                                 
                                 ]
                              
                              }
                           
                           
                              l
                              =
                              1
                           
                           t
                        
                     (
                        
                           k
                           =
                           30
                        
                      and 
                        
                           t
                           =
                           10
                        
                      are selected in this paper). We calculate

                        
                           (B.2)
                           
                              
                                 
                                    
                                       
                                          i
                                          *
                                          =
                                          
                                             arg
                                             i
                                          
                                          
                                             min
                                             
                                                i
                                                =
                                                1
                                                ,
                                                ⋯
                                                ,
                                                T
                                             
                                          
                                          
                                             D
                                             t
                                          
                                          
                                             (
                                             
                                                G
                                                i
                                             
                                             ,
                                             N
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     and add edge 
                        
                           e
                           
                              i
                              *
                           
                        
                      to graph G. Go to Step 1.


                     Step 3. Let 
                        
                           A
                           l
                           t
                           S
                           e
                           
                              t
                              1
                           
                           =
                           
                              {
                              
                                 
                                    (
                                    
                                       v
                                       1
                                    
                                    ,
                                    
                                       v
                                       2
                                    
                                    )
                                 
                                 
                                    |
                                 
                                 
                                    v
                                    1
                                 
                                 ∈
                                 I
                                 I
                                 ,
                                 
                                    v
                                    2
                                 
                                 ∈
                                 S
                                 e
                                 t
                              
                              }
                           
                        
                     , where 
                        
                           S
                           e
                           t
                           =
                           {
                           
                              
                                 v
                                 ¯
                              
                              ∈
                              O
                              I
                              
                                 |
                                 C
                                 a
                                 r
                                 d
                                 (
                              
                              
                                 N
                                 r
                                 (
                                 
                                    v
                                    ¯
                                 
                                 )
                              
                           
                           ∩
                        
                      
                     OI
                     1) ≥ 2}. If Card(AltSet
                     1) > 0, calculate i* similar to Eq. (B.2) and add edge 
                        
                           
                              e
                              
                                 i
                                 *
                              
                           
                           ∈
                           A
                           l
                           t
                           S
                           e
                           
                              t
                              1
                           
                        
                      to graph G. If 
                        
                           C
                           a
                           r
                           d
                           (
                           
                              A
                              l
                              t
                              S
                              e
                              
                                 t
                                 1
                              
                           
                           )
                           =
                           0
                        
                     , go to Step 4.


                     Step 4. Let 
                        
                           A
                           l
                           t
                           S
                           e
                           
                              t
                              2
                           
                           =
                           
                              {
                              
                                 
                                    (
                                    
                                       v
                                       1
                                    
                                    ,
                                    
                                       v
                                       2
                                    
                                    )
                                 
                                 
                                    |
                                 
                                 
                                    v
                                    1
                                 
                                 ,
                                 
                                    v
                                    2
                                 
                                 ∈
                                 B
                                 I
                                 ,
                                 
                                    v
                                    2
                                 
                                 ∈
                                 N
                                 r
                                 
                                    (
                                    
                                       v
                                       1
                                    
                                    )
                                 
                              
                              }
                           
                        
                     .

If Card(AltSet
                     2) > 0, do the following: denote by 
                        
                           A
                           l
                           t
                           S
                           e
                           
                              t
                              2
                           
                           
                              (
                              T
                              )
                           
                           =
                           
                              
                                 {
                                 
                                    e
                                    i
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              T
                           
                        
                      the top T edges in AltSet
                     2 with decreasing order of MC
                     1 if WSDt
                      ≤ Wobj
                      and by 
                        
                           A
                           l
                           t
                           S
                           e
                           
                              t
                              2
                           
                           
                              (
                              T
                              )
                           
                           =
                           
                              
                                 {
                                 
                                    e
                                    i
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              T
                           
                        
                      the top T edges in AltSet
                     2 with increasing order of MC
                     2 if WSDt
                      > Wobj
                     . Denote by Gi
                      the graph induced by deleting edge ei
                      from graph G. We calculate

                        
                           (B.3)
                           
                              
                                 
                                    
                                       
                                          
                                             i
                                             *
                                          
                                          =
                                          
                                             arg
                                             i
                                          
                                          
                                             min
                                             
                                                i
                                                =
                                                1
                                                ,
                                                ⋯
                                                ,
                                                T
                                             
                                          
                                          
                                             D
                                             t
                                          
                                          
                                             (
                                             
                                                G
                                                i
                                             
                                             ,
                                             N
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     and delete edge 
                        
                           e
                           
                              i
                              *
                           
                        
                      from graph G. Additionally, some edges (zero, one or two) from the operators (ii) and (iii) in Theorem 6 are added to graph G (please note that a method similar to Eq. (B.2) is used for the addition of edges). If 
                        
                           C
                           a
                           r
                           d
                           (
                           
                              A
                              l
                              t
                              S
                              e
                              
                                 t
                                 2
                              
                           
                           )
                           =
                           0
                        
                     , go to Step 5.


                     Step 5. Select a node 
                        
                           
                              v
                              1
                           
                           =
                           
                              arg
                              v
                           
                           
                              min
                              
                                 v
                                 ∈
                                 O
                                 I
                              
                           
                           
                              (
                              
                                 C
                                 a
                                 r
                                 d
                                 (
                                 
                                    N
                                    r
                                    (
                                    v
                                    )
                                    ∖
                                    Q
                                    I
                                 
                                 )
                              
                              )
                           
                        
                      and delete all edges (v
                     1, v
                     2), where v
                     2 ∈ Nr(v
                     1)\QI. Additionally, some edges from the operators (ii)– iv) in Theorem 7 are added to graph G. If node v
                     1 cannot be found, conclude the optimization. Otherwise, go to Step 1.⬜

The threshold T can be small for fast calculation of the algorithm (e.g., we select 
                        
                           T
                           =
                           5
                        
                      in this paper) because the WSD optimization is another important task.

Based on Sections 4 and 5, the WSD optimization can keep the ME1 unaltered. Hence, this algorithm should be run after the ME1 optimization. To optimize the synthetic Internet AS graph G with optimized ME1, we should pay more attention to the Dt
                     (G, N) metric, which measures the difference between a synthetic graph G and the corresponding real AS subgraph.

Denote by Dist
                     (ei
                     ) the Dt
                     (G, N) of a graph induced by adding or deleting an edge ei
                      for AS graph G and by AddSet(TA
                     ) the top TA
                      edges in AddSet (see Section 4) with decreasing order of 
                        
                           M
                           
                              C
                              1
                           
                           =
                           
                              |
                              
                                 d
                                 u
                              
                              −
                              
                                 d
                                 v
                              
                              |
                           
                        
                     . Let 
                        
                           A
                           d
                           d
                           S
                           e
                           t
                           
                              (
                              
                                 T
                                 A
                              
                              )
                           
                           =
                           
                              
                                 {
                                 
                                    e
                                    i
                                    a
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 T
                                 A
                              
                           
                        
                     , where 
                        
                           D
                           i
                           
                              s
                              t
                           
                           
                              (
                              
                                 e
                                 1
                                 a
                              
                              )
                           
                           ≤
                           D
                           i
                           
                              s
                              t
                           
                           
                              (
                              
                                 e
                                 2
                                 a
                              
                              )
                           
                           ≤
                           ⋯
                           ≤
                           D
                           i
                           
                              s
                              t
                           
                           
                              (
                              
                                 e
                                 
                                    
                                       T
                                       A
                                    
                                 
                                 a
                              
                              )
                           
                        
                     . Simultaneously, denote by DelSet(TD
                     ) the top TD
                      edges in DelSet (see Section 4) with decreasing order of MC
                     1. Let 
                        
                           D
                           e
                           l
                           S
                           e
                           t
                           
                              (
                              
                                 T
                                 D
                              
                              )
                           
                           =
                           
                              
                                 {
                                 
                                    e
                                    i
                                    d
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 T
                                 D
                              
                           
                        
                     , where 
                        
                           D
                           i
                           
                              s
                              t
                           
                           
                              (
                              
                                 e
                                 1
                                 d
                              
                              )
                           
                           ≤
                           D
                           i
                           
                              s
                              t
                           
                           
                              (
                              
                                 e
                                 2
                                 d
                              
                              )
                           
                           ≤
                           ⋯
                           ≤
                           D
                           i
                           
                              s
                              t
                           
                           
                              (
                              
                                 e
                                 
                                    
                                       T
                                       D
                                    
                                 
                                 d
                              
                              )
                           
                        
                     . Denote by 
                        
                           
                              
                                 W
                                 ¯
                              
                              A
                           
                           
                              (
                              s
                              )
                           
                        
                      and 
                        
                           
                              
                                 D
                                 ¯
                              
                              A
                           
                           
                              (
                              s
                              )
                           
                        
                     , respectively, the WSDt
                      and Dt
                     (G, N) of a graph induced by adding a series of edges 
                        
                           
                              {
                              
                                 e
                                 i
                                 a
                              
                              }
                           
                           
                              i
                              =
                              1
                           
                           s
                        
                      to AS graph G and by 
                        
                           
                              
                                 W
                                 ¯
                              
                              D
                           
                           
                              (
                              s
                              )
                           
                        
                      and 
                        
                           
                              
                                 D
                                 ¯
                              
                              D
                           
                           
                              (
                              s
                              )
                           
                        
                     , respectively, the WSDt
                      and Dt
                     (G, N) of a graph induced by deleting a series of edges 
                        
                           
                              {
                              
                                 e
                                 i
                                 d
                              
                              }
                           
                           
                              i
                              =
                              1
                           
                           s
                        
                      from AS graph G. If the deletion of edge 
                        
                           e
                           s
                           d
                        
                      alters the nodes in sets P(G) and QI, add the edge to AS graph G again and let 
                        
                           
                              
                                 W
                                 ¯
                              
                              D
                           
                           
                              (
                              s
                              )
                           
                           =
                           
                              
                                 W
                                 ¯
                              
                              D
                           
                           
                              (
                              s
                              −
                              1
                              )
                           
                        
                      and 
                        
                           
                              
                                 D
                                 ¯
                              
                              D
                           
                           
                              (
                              s
                              )
                           
                           =
                           
                              
                                 D
                                 ¯
                              
                              D
                           
                           
                              (
                              s
                              −
                              1
                              )
                           
                        
                     .

According to the analyses of Fig. 8, we can obtain that i) there are some relationships between 
                        
                           
                              
                                 W
                                 ¯
                              
                              A
                           
                           
                              (
                              s
                              )
                           
                        
                      and 
                        
                           
                              
                                 D
                                 ¯
                              
                              A
                           
                           
                              (
                              s
                              )
                           
                        
                      that are induced by different weighting values 
                        
                           
                              (
                              
                                 1
                                 −
                                 θ
                              
                              )
                           
                           N
                        
                     (
                        
                           θ
                           ∈
                           (
                           
                              2
                              (
                              i
                              −
                              1
                              )
                              /
                              k
                              ,
                              2
                              i
                              /
                              k
                           
                           ]
                        
                     ) of the eigenvalue distribution and ii) TA
                      (or TD
                     ) can be smaller compared to the study of Section 4. To optimize the Dt
                     (G, N) metric, the algorithm of Section 5 should be improved as follows:

                        
                           (i)
                           The thresholds TA
                               and TD
                               are set as constant and smaller values, e.g., 
                                 
                                    
                                       T
                                       A
                                    
                                    =
                                    
                                       T
                                       D
                                    
                                    =
                                    3000
                                 
                               for US (Oct 2011) and 
                                 
                                    
                                       T
                                       D
                                    
                                    =
                                    2000
                                 
                               for RU (Apr 2013).

The Wt
                              (ei
                              ) metric is replaced by Dist
                              (ei
                              ), and the Dist
                              (ei
                              ) metric is used to sort the edges in AddSet(TA
                              ) and DelSet(TD
                              ).

When sobj
                               in Eq. (8) or Eq. (9) is calculated, we calculate
                                 
                                    (C.1)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                      
                                                         o
                                                         b
                                                         j
                                                      
                                                      *
                                                   
                                                   =
                                                   
                                                      arg
                                                      s
                                                   
                                                   
                                                   
                                                      min
                                                      
                                                         s
                                                         ∈
                                                         S
                                                         e
                                                         t
                                                      
                                                   
                                                   
                                                      
                                                         D
                                                         ¯
                                                      
                                                      A
                                                   
                                                   
                                                      (
                                                      s
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

or

                        
                           (C.2)
                           
                              
                                 
                                    
                                       
                                          
                                             s
                                             
                                                o
                                                b
                                                j
                                             
                                             *
                                          
                                          =
                                          
                                             arg
                                             s
                                          
                                          
                                          
                                             min
                                             
                                                s
                                                ∈
                                                S
                                                e
                                                t
                                             
                                          
                                          
                                             
                                                D
                                                ¯
                                             
                                             D
                                          
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           S
                           e
                           t
                           =
                           {
                           s
                           |
                           s
                           =
                           
                              s
                              
                                 o
                                 b
                                 j
                              
                           
                           −
                           i
                           ·
                           
                              T
                              *
                           
                           ;
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ;
                           s
                           ≥
                           1
                           }
                        
                      and T* is 1, 2 or 3. Then, add (or delete) the edges 
                        
                           
                              {
                              
                                 e
                                 i
                                 a
                              
                              }
                           
                           
                              i
                              =
                              1
                           
                           
                              s
                              
                                 o
                                 b
                                 j
                              
                              *
                           
                        
                      (or 
                        
                           
                              {
                              
                                 e
                                 i
                                 d
                              
                              }
                           
                           
                              i
                              =
                              1
                           
                           
                              s
                              
                                 o
                                 b
                                 j
                              
                              *
                           
                        
                     ) for AS graph G and conclude the algorithm.⬜

@&#REFERENCES@&#

