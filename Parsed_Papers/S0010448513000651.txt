@&#MAIN-TITLE@&#Curvature-guided adaptive 
                  T
               -spline surface fitting

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We present an adaptive 
                                 T
                              -spline fitting algorithm, with several new components.


                        
                        
                           
                           We propose a curvature-guided fitting strategy to effectively capture model features.


                        
                        
                           
                           We introduce a process for faithful re-parameterization.


                        
                        
                           
                           We present a process for re-placing the initial structure of the spline surface.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Surface fitting




                     




                        T




                     -splines

Curvature

Re-parameterization

Knot re-placement

@&#ABSTRACT@&#


               
               
                  The problem of fitting spline surfaces to triangular mesh models is of importance in computer-aided design. Many fitting algorithms have been developed. This paper proposes several novel plug-and-play components or strategies: the use of   
                        T
                     -splines for fitting, a curvature-guided strategy, faithful re-parameterization and initial spline knot re-placement, which can be used to enhance fitting algorithms. We also present an adaptive 
                        T
                     -spline fitting algorithm integrating these components and strategies. Extensive experiments have been conducted to demonstrate these components. Our fitting algorithm can generate spline surfaces that well respect the geometrical features of input mesh models and have a more compact representation.
               
            

@&#INTRODUCTION@&#

Triangular meshes and splines are two popular representations for free-form surfaces. Triangular meshes are convenient for visualization and description of complicated shapes of arbitrary topology. With the development of laser scanners or other 3D data acquisition equipments  [1], triangular mesh models are easily obtained. Spline surfaces are widely used in the computer-aided design and manufacturing (CAD/CAM) industry and engineering computation as well. They are represented concisely by parametric equations and are good for the description of smooth shapes and shape analysis. In particular, non-uniform rational 
                        B
                     -splines (NURBS) have been an industry standard in CAD/CAM  [2]. For some applications, there is a need to convert a model in triangular mesh representation into splines. The conversion can be achieved by surface fitting or reconstruction. This paper investigates effective techniques for spline surface fitting.

Extensive research has been done on surface fitting. Some interesting methods have been developed for reconstructing 
                        B
                     -spline surfaces to fit a triangular mesh  [3–5]. These methods either initiate the fitting process with a control mesh that is sufficiently dense or refine the control mesh globally when the approximation error is large. Both of these strategies often result in an over-refined control mesh. In fact, the refinement of the control mesh is desired only in the areas where the fitting result is poor, but the 
                        B
                     -spline surfaces do not have local refinement. An adaptive approach was proposed in  [6] that uses a collection of 
                        B
                     -spline patches on different layers, with the base layer of patches representing the overall shape and the overlay patches representing the local details. In the overlay patches, however, several rings of control points near the margin of the control mesh must be fixed with the corresponding control points in the lower level in order to maintain continuity. In the work of  [7], an approach based on patchwork surface construction was presented. The adaptivity of this method lies in that, when the resulting surface is not accurate enough, the selected faces are chosen to be split and re-approximated. One problem of the method in  [7] is that the total number of patches in the result surface could be very large and many unnecessary extraordinary points might be introduced even though the topology of the object is simple.

Besides, geometrical features  [8–10] in free-form surfaces seem to be overlooked in many previous surface fitting approaches. In fact, surface features are important for shape description in that they reflect some identities of a model. Therefore, features should be appropriately reconstructed during surface fitting in order to achieve satisfactory result. A feature sensitive parameterization technique was introduced in  [11] to embed the feature information into the parameterization of the triangular mesh and distort the parameter domain so that larger parameter intervals are allocated to feature areas. While this technique could indirectly facilitate non-adaptive 
                        B
                     -spline surface fitting, its use becomes less apparent in adaptive fitting.

The research effort reported in this paper initially was on fitting spline surfaces to triangular meshes of arbitrary topology as in [4,7,12]. However, we soon realized that even the surface fitting of a mesh with simple topology has many open questions, such as how to efficiently achieve adaptive fitting, how to generate good parameterization for fitting purpose, how to generate good initial knot placement for spline surface fitting, and how to automatically allocate more control points in those highly curved feature regions to better represent the features. The solutions to these problems also surely facilitate the surface fitting of arbitrarily topological models. Thus this paper focuses on fitting a spline surface to a triangular mesh that is topologically equivalent to a disc and presents several plug-and-play technical components and strategies, which can be easily integrated into many existing surface fitting algorithms for enhancement to produce visually smooth spline surfaces with concise control meshes and geometrical features well respected. The main contributions of the paper include:
                        
                           •
                           We propose to use 
                                 T
                              -spline surfaces for adaptive surface fitting. Adaptive surface fitting refines fitting only in the required areas where the fitting results are not satisfactory. Thus adaptive fitting is attractive in handling complicated models with unevenly distributed details. 
                                 T
                              -splines are a new free-form surface technology that solve most of the limitations inherent in the NURBS representation  [13,14]. In particular, 
                                 T
                              -splines allow local refinement, making them a good candidate for adaptive fitting  [15,12]. While 
                                 T
                              -splines are more powerful than 
                                 B
                              -splines, they also bring some technical challenges. For example, 
                                 T
                              -splines in a general setting are likely rational, which makes the computation (especially differentiation) complicated. While previous 
                                 T
                              -spline fitting methods  [12,16] directly use 
                                 T
                              -splines and thus output rational surfaces, we deliberately design our algorithm so that all the 
                                 T
                              -splines constructed in our algorithm are standard or semi-standard  [14], which guarantees that they are piecewise polynomial, thus simplifying the fitting process.

We propose to use curvature to guide the fitting process so that the feature regions receive special attention. Features are characterized as the regions where there is a large variation in surface normal. While features were not paid enough attention to in many previous fitting algorithms, which often results in loss of features in the fitting results, we present a simple strategy that will automatically allocate more control points in the feature regions so that the features can be well represented in the fitting surface.

We introduce a process called re-parameterization. This is inspired by Hoschek’s work for approximation  [17]. With re-parameterization using the current fitting result, the parameterization of the triangular mesh is improved towards an intrinsic one that is able to help optimize the fitting result as shown in  [17]. We present a method that guarantees the re-parameterization to be faithful.

We present a process for re-placing the initial control grid structure of the spline surface. Since 
                                 T
                              -spline surfaces have flexible knot structure, it is very difficult to provide a good initial 
                                 T
                              -spline knot (or structure) placement which is needed in the surface fitting procedure. Our proposed method heuristically constructs knot re-placement by taking the current fitting result and the characteristics of the input model into consideration and ensures that the 
                                 T
                              -splines defined over the generated knot structure are standard or semi-standard. As a result, we can obtain a reasonable 
                                 T
                              -spline structure, which helps generate a concise fitting result.

The rest of the paper is organized as follows. First, we present an overview of our adaptive fitting algorithm in Section  2. Then, several technical components are explained in subsequent sections. In particular, Section  3 describes parameterization and re-parameterization; Section  4 discusses initial 
                        T
                     -spline structure placement and re-placement; and Section  5 gives adaptive least-squares 
                        T
                     -spline fitting with curvature guidance. Next, Section  6 presents experimental results to demonstrate the effectiveness of our algorithm. Finally, the paper is concluded in Section  7.

A 
                        T
                     -spline surface 
                        
                           S
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      is defined by  [13,14]
                     
                        
                           (1)
                           
                              
                                 S
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              =
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                 
                              
                           
                        
                      where 
                        
                           
                              P
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              w
                           
                           
                              i
                           
                        
                      and 
                        
                           
                              B
                           
                           
                              i
                           
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      are the control points, weights, and 
                        T
                     -spline blending functions, respectively. As a major difference from the control points of 
                        B
                     -spline surfaces, 
                        
                           
                              P
                           
                           
                              i
                           
                        
                      in 
                        
                           S
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      can be a 
                        T
                     -junction, which means the terminal point of a partial row or column. The existence of 
                        T
                     -junction points makes the 
                        T
                     -spline structure more flexible and allows local refinement.

Our surface fitting problem can roughly be stated: given a triangular mesh 
                        
                           T
                        
                      in 
                        
                           
                              R
                           
                           
                              3
                           
                        
                      space with a vertex set 
                        D
                        =
                        
                           {
                           
                              
                                 
                                    d
                                 
                              
                              
                                 
                                    1
                                 
                              
                           
                           ,
                           
                              
                                 
                                    d
                                 
                              
                              
                                 
                                    2
                                 
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    d
                                 
                              
                              
                                 
                                    m
                                 
                              
                           
                           }
                        
                     , which is topologically equivalent to a disc, we look for a 
                        T
                     -spline surface 
                        
                           S
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      such that the distances between the surface and each vertex 
                        
                           
                              
                                 d
                              
                           
                           
                              
                                 i
                              
                           
                        
                      are within a given error tolerance 
                        ε
                     :
                        
                           (2)
                           
                              
                                 dist
                              
                              
                                 (
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       
                                          i
                                       
                                    
                                 
                                 ,
                                 
                                    S
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 )
                              
                              ≤
                              ε
                              ,
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              m
                              .
                           
                        
                      Moreover, we also require that the resulting 
                        T
                     -spline surface should have a concise representation and well respect the geometrical features of the original triangular mesh. Fig. 1
                      shows an example of two different fitting results with the same error tolerance, where Fig. 1(a) is the input triangular mesh, Fig. 1(b) is a fitting result with salient geometrical features such as the eyes, the nose and the mouth being well respected, and Fig. 1(c) is the normal fitting result that does not preserve features very well.

To solve the above problem, we propose a 
                        T
                     -spline surface fitting algorithm that wraps the existing least-squares fitting solutions by another iteration in which the parameterization and the initial 
                        T
                     -spline knot placement are updated. While this increases the computation cost, it will decrease the number of control points of the resulting 
                        T
                     -spline surface and make the 
                        T
                     -spline topology more concise. Meanwhile, we also propose to improve the conventional least-squares fitting by using curvature to guide the fitting process. By such means, geometrical features of the model will receive adequate attention and will be well represented in the resulting 
                        T
                     -spline surface.

The flowchart of our algorithm is given in Fig. 2
                     . The algorithm consists of several components. Parameterization is to parameterize the input mesh. Re-parameterization is to improve the mesh parameterization. Initial 
                        T
                     -spline structure placement is to arrange the initial topology of 
                        T
                     -splines. Re-placement is to improve the initial topology of 
                        T
                     -splines. Curvature-guided 
                        T
                     -spline fitting is to adaptively find the optimal 
                        T
                     -spline surface. They can work in a plug-and-play way. In particular, the new components–faithful re-parameterization, knot structure re-placement, curvature-guided fitting and the appropriate use of 
                        T
                     -splines–can be incorporated into other existing fitting algorithms to enhance their performance.

Below is how the algorithm works in general. Given an input triangular mesh 
                        
                           T
                        
                     , we first parameterize 
                        
                           T
                        
                      by assigning a pair of parameter values to each vertex of 
                        
                           T
                        
                     , and also set up an initial 
                        T
                     -spline structure. Next, based on the parameterization and the 
                        T
                     -spline initialization, a curvature-guided 
                        T
                     -spline fitting routine is used to find a candidate result surface in an adaptive way such that the distances between 
                        
                           
                              
                                 d
                              
                           
                           
                              
                                 i
                              
                           
                        
                      and the obtained 
                        T
                     -spline surface are below 
                        ε
                     . The stop criterion for the algorithm is based on the estimation of whether the current candidate could be further improved in the next iteration (more details are to be discussed in Section  6), and is checked each time a candidate result surface is found. If the criterion is met, the algorithm terminates and the current candidate result surface is regarded as the final output; Otherwise, the current parameterization is re-calculated and the initial 
                        T
                     -spline knots are re-placed, using the current result surface as a reference. With the new parameterization and the knot placement, the surface fitting routine is carried out again to find the next candidate 
                        T
                     -spline result.

This section describes two processes related to parameter calculation: parameterization and re-parameterization.

Parameterization is a process of finding a mapping 
                           ψ
                         that assigns each vertex 
                           
                              
                                 
                                    d
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                         of the mesh 
                           
                              T
                           
                         a pair of parameter values 
                           
                              
                                 
                                    u
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         in 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         space. The set of points 
                           
                              
                                 
                                    u
                                 
                              
                              
                                 
                                    1
                                 
                              
                           
                           ,
                           
                              
                                 
                                    u
                                 
                              
                              
                                 
                                    2
                                 
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    u
                                 
                              
                              
                                 
                                    m
                                 
                              
                           
                         collectively form a planar triangulation 
                           
                              P
                           
                         that maintains the same connectivity as 
                           
                              T
                           
                        . Many parameterization algorithms have been developed. Refer to  [18,19] for a good survey. In this paper, we adopt a parameterization algorithm based on mean value coordinates  [20], which is simple and also effective.

Once the parameterization for the mesh is obtained, 
                           
                              dist
                           
                           
                              (
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                              ,
                              
                                 S
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              )
                           
                         in Eq. (2) can be measured by the parametric distance 
                           
                              ‖
                              
                                 S
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              −
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                              ‖
                           
                        . Other possible measurements for the point–surface distance can be found in  [21].

As a linkage between meshes and spline surfaces, parameterization has a substantial impact on surface fitting. Without prior information on the underlying parametric representation of a mesh, there inevitably exist some deficiencies in initial parameterization results, especially for triangular meshes with complicated geometry.

Re-parameterization is to improve the initial parameterization of a mesh. Here we present a re-parameterization process that makes use of the previously obtained 
                           T
                        -splines during the iterations of surface fitting. Our approach is called faithful re-parameterization, which improves the parameter values without introducing unwanted effects such as overlapping of triangles. It is achieved by two steps: calculating the initial updates and finding the corrections for global re-parameterization. Once the parameterization is updated, it can be used in the next iteration of surface fitting.

Suppose 
                              
                                 S
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                            is a 
                              T
                           -spline surface that approximates the triangular mesh 
                              
                                 T
                              
                           . For each vertex 
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                            in 
                              
                                 T
                              
                           , an offset vector is defined as the directed edge from 
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                            to the corresponding point 
                              
                                 S
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            on the 
                              T
                           -spline surface, where 
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            is the associated parameter pair for 
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                           . For conciseness, we denote 
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                            by 
                              P
                            and the point 
                              
                                 S
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            by 
                              S
                           . We examine whether the offset vector 
                              
                                 
                                    P
                                    S
                                 
                                 
                                    ⃗
                                 
                              
                            is orthogonal to the 
                              T
                           -spline surface. If it is not the case, it suggests that there would exist another point with parameter 
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                            on the 
                              T
                           -spline surface such that the vector from 
                              P
                            to this point is orthogonal to the surface. It can be seen that the approximation error at 
                              P
                            can further be reduced if we change the parameter of 
                              P
                            to 
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                           . However, identifying such a point usually is a nonlinear problem. As a trade-off, we find an approximate correction term 
                              
                                 Δ
                              
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                              
                                 (
                                 
                                    Δ
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    Δ
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            for each 
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                            in a more efficient way, based on a similar technique that Hoschek  [17] used to re-parameterize curves.

Let 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    
                                       u
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    
                                       v
                                    
                                 
                              
                            denote the partial derivatives of the 
                              T
                           -spline surface at 
                              S
                           . 
                              
                                 
                                    S
                                 
                                 
                                    ′
                                 
                              
                            is a point on the tangent plane spanned by 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    
                                       u
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    
                                       v
                                    
                                 
                              
                            such that 
                              
                                 
                                    P
                                    
                                       
                                          S
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    ⃗
                                 
                              
                            is orthogonal to the tangent plane. Then 
                              
                                 
                                    P
                                    
                                       
                                          S
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    ⃗
                                 
                              
                            equals 
                              k
                              
                                 n
                              
                           , where 
                              
                                 n
                              
                              =
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    
                                       u
                                    
                                 
                              
                              ×
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    
                                       v
                                    
                                 
                              
                            is the normal vector of the plane and 
                              k
                            is a scalar factor. From the triangle 
                              △
                              P
                              Q
                              
                                 
                                    S
                                 
                                 
                                    ′
                                 
                              
                            shown in Fig. 3
                           (a), we have the following equation: 
                              
                                 (3)
                                 
                                    
                                       (
                                       
                                          
                                             P
                                             S
                                          
                                          
                                             ⃗
                                          
                                       
                                       +
                                       
                                          Δ
                                       
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                S
                                             
                                          
                                          
                                             
                                                u
                                             
                                          
                                       
                                       )
                                    
                                    ⋅
                                    
                                       (
                                       
                                          n
                                       
                                       ×
                                       
                                          
                                             
                                                S
                                             
                                          
                                          
                                             
                                                v
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    0
                                    .
                                 
                              
                            Solving the equation gives 
                              
                                 Δ
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                           : 
                              
                                 (4)
                                 
                                    
                                       Δ
                                    
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          
                                             (
                                             
                                                S
                                             
                                             
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             −
                                             
                                                
                                                   
                                                      d
                                                   
                                                
                                                
                                                   
                                                      i
                                                   
                                                
                                             
                                             )
                                          
                                          ⋅
                                          
                                             (
                                             
                                                n
                                             
                                             ×
                                             
                                                
                                                   
                                                      S
                                                   
                                                
                                                
                                                   
                                                      v
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                
                                                   u
                                                
                                             
                                          
                                          ⋅
                                          
                                             (
                                             
                                                n
                                             
                                             ×
                                             
                                                
                                                   
                                                      S
                                                   
                                                
                                                
                                                   
                                                      v
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                    .
                                 
                              
                            Similarly, we have 
                              
                                 (5)
                                 
                                    
                                       Δ
                                    
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          
                                             (
                                             
                                                S
                                             
                                             
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             −
                                             
                                                
                                                   
                                                      d
                                                   
                                                
                                                
                                                   
                                                      i
                                                   
                                                
                                             
                                             )
                                          
                                          ⋅
                                          
                                             (
                                             
                                                n
                                             
                                             ×
                                             
                                                
                                                   
                                                      S
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                
                                                   v
                                                
                                             
                                          
                                          ⋅
                                          
                                             (
                                             
                                                n
                                             
                                             ×
                                             
                                                
                                                   
                                                      S
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

If 
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                            is on the boundary of the mesh, one parameter should remain fixed and thus a special treatment is needed. Suppose a boundary vertex 
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                            has parameter 
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       b
                                    
                                 
                                 )
                              
                            where 
                              
                                 
                                    v
                                 
                                 
                                    b
                                 
                              
                            is fixed. We only need to correct 
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                           , which is to ensure that the point still remains on the boundary after correction. Refer to Fig. 3(b). We find 
                              
                                 Δ
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                            that makes 
                              
                                 
                                    S
                                    
                                       
                                          S
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    ⃗
                                 
                              
                              ⊥
                              
                                 
                                    P
                                    
                                       
                                          S
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    ⃗
                                 
                              
                           , which leads to the following equation: 
                              
                                 (6)
                                 
                                    
                                       (
                                       
                                          
                                             P
                                             S
                                          
                                          
                                             ⃗
                                          
                                       
                                       +
                                       
                                          Δ
                                       
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                S
                                             
                                          
                                          
                                             
                                                u
                                             
                                          
                                       
                                       )
                                    
                                    ⋅
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          
                                             u
                                          
                                       
                                    
                                    =
                                    0
                                    .
                                 
                              
                            Thus 
                              
                                 (7)
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       −
                                       
                                          
                                             
                                                (
                                                
                                                   S
                                                
                                                
                                                   (
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         b
                                                      
                                                   
                                                   )
                                                
                                                −
                                                
                                                   
                                                      
                                                         d
                                                      
                                                   
                                                   
                                                      
                                                         i
                                                      
                                                   
                                                
                                                )
                                             
                                             ⋅
                                             
                                                
                                                   
                                                      S
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                
                                             
                                             ⋅
                                             
                                                
                                                   
                                                      S
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       0
                                       .
                                    
                                 
                              
                            Analogously, if a boundary vertex 
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                            has a parameter 
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       b
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            where 
                              
                                 
                                    u
                                 
                                 
                                    b
                                 
                              
                            is fixed, the correction term can be expressed by: 
                              
                                 (8)
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       0
                                    
                                 
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       −
                                       
                                          
                                             
                                                (
                                                
                                                   S
                                                
                                                
                                                   (
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         b
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                −
                                                
                                                   
                                                      
                                                         d
                                                      
                                                   
                                                   
                                                      
                                                         i
                                                      
                                                   
                                                
                                                )
                                             
                                             ⋅
                                             
                                                
                                                   
                                                      S
                                                   
                                                
                                                
                                                   
                                                      v
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                
                                                
                                                   
                                                      v
                                                   
                                                
                                             
                                             ⋅
                                             
                                                
                                                   
                                                      S
                                                   
                                                
                                                
                                                   
                                                      v
                                                   
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

Once 
                              
                                 Δ
                              
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                            is computed, we can then replace the parameter 
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                            of 
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                            by 
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                              +
                              
                                 Δ
                              
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                           .

Note that if we update each parameter point 
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                            by applying the previously calculated correction term 
                              
                                 Δ
                              
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                           , it likely happens that some edges in the new triangulation 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    ̃
                                 
                              
                            intersect, which should be avoided in a good parameterization. For example, in Fig. 4
                           (a) the local region of the parameterization containing vertices 
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                              ,
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       j
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       k
                                    
                                 
                              
                            is shown, with three respective correction terms also marked in dashed lines. After applying these corrections to the vertices (see Fig. 4(b)), it can be seen that the new edge 
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    j
                                    k
                                 
                              
                            intersects with two other edges. This implies that the parameterization is “over-corrected” and the original connectivity of the mesh is not faithfully preserved, which may cause unpredictable results in surface fitting.

Therefore, a mechanism is required to add appropriate constraints to the correction terms in order to avoid self-intersections. We introduce a set of scalar factors 
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           , and let the parameter correction for vertex 
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                            be: 
                              
                                 (9)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          
                                             i
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          
                                             i
                                          
                                       
                                    
                                    +
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                    
                                    
                                       Δ
                                    
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          
                                             i
                                          
                                       
                                    
                                    .
                                 
                              
                            Here, the correction term 
                              
                                 Δ
                              
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                            is adjusted to be 
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              
                                 Δ
                              
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                            and the purpose of which is to prevent over-corrections. When 
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              =
                              0
                           , no correction is made for vertex 
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                           . Since the original parameterization is assumed to have no self-intersection, as long as all 
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                            are small enough, the updated parameterization would always be faithful. On the other hand, we want the correction terms to keep their original magnitude as much as possible in order to maximize the effect of re-parameterization. Therefore, our goal is to find the largest possible values for 
                              
                                 
                                    β
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    β
                                 
                                 
                                    m
                                 
                              
                            under the condition that there is no self-intersection in 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    ̃
                                 
                              
                           .

Let 
                              
                                 
                                    g
                                 
                                 
                                    i
                                 
                              
                            denote an arbitrary triangle face in 
                              
                                 P
                              
                            whose vertices are 
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       i1
                                    
                                 
                              
                              ,
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       i2
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       i3
                                    
                                 
                              
                           . Let 
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                            be the corresponding face in 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    ̃
                                 
                              
                           , with vertices 
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    
                                       i1
                                    
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    
                                       i2
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    
                                       i3
                                    
                                 
                              
                           . It can be seen that, the occurrence of self-intersection can be avoided if we make sure that for any face 
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                            in 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    ̃
                                 
                              
                           , each vertex in 
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                            stays at the same side of its opposing edge as it does in 
                              
                                 
                                    g
                                 
                                 
                                    i
                                 
                              
                           . This condition is equivalent to the direction of the normal vectors of 
                              
                                 
                                    g
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                            being the same, which we can be formulated as follows: 
                              
                                 (10)
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             
                                                i1
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             
                                                i2
                                             
                                          
                                       
                                       ×
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             
                                                i1
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             
                                                i3
                                             
                                          
                                       
                                       )
                                    
                                    ⋅
                                    
                                       (
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             
                                                i1
                                             
                                          
                                       
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             
                                                i2
                                             
                                          
                                       
                                       ×
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             
                                                i1
                                             
                                          
                                       
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             
                                                i3
                                             
                                          
                                       
                                       )
                                    
                                    >
                                    0
                                 
                              
                            where 
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       a
                                    
                                 
                              
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       b
                                    
                                 
                              
                            (or 
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    
                                       a
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    
                                       b
                                    
                                 
                              
                           ) is the directional edge from 
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       a
                                    
                                 
                              
                            to 
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       b
                                    
                                 
                              
                            (or from 
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    
                                       j
                                    
                                 
                              
                            to 
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    
                                       k
                                    
                                 
                              
                           ). Substituting 
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    
                                       ik
                                    
                                 
                              
                            of Eq. (9) into (10) gives: 
                              
                                 (11)
                                 
                                    
                                       
                                          (
                                          
                                             (
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                                
                                                   
                                                      i1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                                
                                                   
                                                      i2
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   β
                                                
                                                
                                                   i
                                                   1
                                                
                                             
                                             
                                                Δ
                                             
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                                
                                                   
                                                      i1
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   β
                                                
                                                
                                                   i
                                                   2
                                                
                                             
                                             
                                                Δ
                                             
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                                
                                                   
                                                      i2
                                                   
                                                
                                             
                                             )
                                          
                                          ×
                                          
                                             (
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                                
                                                   
                                                      i1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                                
                                                   
                                                      i3
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   β
                                                
                                                
                                                   i
                                                   1
                                                
                                             
                                             
                                                Δ
                                             
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                                
                                                   
                                                      i1
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   β
                                                
                                                
                                                   i
                                                   3
                                                
                                             
                                             
                                                Δ
                                             
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                                
                                                   
                                                      i3
                                                   
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       ⋅
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   u
                                                
                                             
                                             
                                                
                                                   i1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   u
                                                
                                             
                                             
                                                
                                                   i2
                                                
                                             
                                          
                                          ×
                                          
                                             
                                                
                                                   u
                                                
                                             
                                             
                                                
                                                   i1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   u
                                                
                                             
                                             
                                                
                                                   i3
                                                
                                             
                                          
                                          )
                                       
                                       >
                                       0
                                       .
                                    
                                 
                              
                           
                        

The left side of (11) has only three unknowns 
                              
                                 
                                    β
                                 
                                 
                                    i
                                    1
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    i
                                    2
                                 
                              
                            and 
                              
                                 
                                    β
                                 
                                 
                                    i
                                    3
                                 
                              
                            and we can represent it by a function 
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       i
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       i
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       i
                                       3
                                    
                                 
                                 )
                              
                           , which is typically a degree two polynomial in 
                              
                                 
                                    β
                                 
                                 
                                    i
                                    1
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    i
                                    2
                                 
                              
                            and 
                              
                                 
                                    β
                                 
                                 
                                    i
                                    3
                                 
                              
                           . If we solve all the inequalities 
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       i
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       i
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       i
                                       3
                                    
                                 
                                 )
                              
                              >
                              0
                            together, we can get the values for 
                              
                                 
                                    β
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    β
                                 
                                 
                                    m
                                 
                              
                           . However, it is too complicated to solve multi-variable quadratic inequalities. Thus we seek to simplify the problem somehow. Rather than using an independent 
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                            for each 
                              
                                 Δ
                              
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                           , we use a global 
                              β
                            for all the parameter correction terms. Then 
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       i
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       i
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       i
                                       3
                                    
                                 
                                 )
                              
                            becomes a univariate quadratic function 
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 β
                                 )
                              
                           : 
                              
                                 (12)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       β
                                       )
                                    
                                    =
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          β
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                    β
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    >
                                    0
                                    ,
                                    
                                    β
                                    ∈
                                    
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                    
                                    .
                                 
                              
                           
                        

Now our task is simplified to solving 
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 β
                                 )
                              
                              >
                              0
                            for each triangle face and finding the largest possible 
                              β
                            that satisfies all the inequalities within the valid domain of 
                              β
                           , i.e., 
                              β
                              ∈
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           . It can be guaranteed that no over-correction of parameters would ever occur if all the correction terms are scaled by such a 
                              β
                           . By a careful observation, it can be found that 
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 0
                                 )
                              
                            (i.e. 
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                           ) is always a positive number. Because when 
                              β
                              =
                              0
                           , no parameter correction will actually be made and the normal vector for each triangle face will remain in its original direction.

The solution to the quadratic inequality of (12) is determined by its coefficients 
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                           . Let us first discuss the situation where 
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              =
                              0
                           . If 
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                              ≥
                              0
                           , then we will always have 
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 β
                                 )
                              
                              >
                              0
                           , no matter what value 
                              β
                            takes among 
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           . On the other hand, if 
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                              <
                              0
                           , the allowed range for 
                              β
                            would be 
                              
                                 [
                                 0
                                 ,
                                 min
                                 
                                    (
                                    −
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                b
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    ,
                                    1
                                    )
                                 
                                 )
                              
                           .

Now we can assume that 
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              ≠
                              0
                           , in which case 
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 β
                                 )
                              
                            defines a parabola. To discuss the solution of (12), let 
                              Δ
                              =
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              −
                              4
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                           , and 
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    −
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          Δ
                                       
                                    
                                 
                                 
                                    2
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    −
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          Δ
                                       
                                    
                                 
                                 
                                    2
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                            be the two roots, provided 
                              Δ
                              >
                              0
                           . The solution to (12) in general falls into the following cases: 
                              
                                 1.
                                 
                                    
                                       Δ
                                       <
                                       0
                                    :

In such a case, the whole parabola would be above the 
                                       β
                                     axis (as shown in Fig. 5
                                    (a)), due to the fact that 
                                       
                                          
                                             f
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                       >
                                       0
                                    . Therefore, the solution to (12) is 
                                       0
                                       ≤
                                       β
                                       ≤
                                       1
                                    .


                                    
                                       Δ
                                       =
                                       0
                                    :

A possible situation is illustrated in Fig. 5(b), and the solution to (12) is 
                                       0
                                       ≤
                                       β
                                       <
                                       −
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             2
                                             
                                                
                                                   a
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    , if 
                                       −
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             2
                                             
                                                
                                                   a
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       ∈
                                       
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                    ; or 
                                       0
                                       ≤
                                       β
                                       ≤
                                       1
                                    , if 
                                       −
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             2
                                             
                                                
                                                   a
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       ∉
                                       
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                    .


                                    
                                       Δ
                                       >
                                       0
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                       
                                       ∈
                                       
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             2
                                          
                                       
                                       ∈
                                       
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                    :

As illustrated in Fig. 5(c), the solution to (12) is 
                                       0
                                       ≤
                                       β
                                       <
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                       
                                    .


                                    
                                       Δ
                                       >
                                       0
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                       
                                       ∈
                                       
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             2
                                          
                                       
                                       ∉
                                       
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                    : As illustrated in Fig. 5(d), the solution to (12) is 
                                       0
                                       ≤
                                       β
                                       <
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                       
                                    .


                                    
                                       Δ
                                       >
                                       0
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                       
                                       ∉
                                       
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             2
                                          
                                       
                                       ∈
                                       
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                    :

As illustrated in Fig. 5(e), the solution to (12) is 
                                       0
                                       ≤
                                       β
                                       <
                                       
                                          
                                             r
                                          
                                          
                                             2
                                          
                                       
                                    .


                                    
                                       Δ
                                       >
                                       0
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                       
                                       ∉
                                       
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             2
                                          
                                       
                                       ∉
                                       
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                    :

This case is illustrated by Fig. 5(f)–(h). It is obvious that in such a case, the solution to (12) is 
                                       0
                                       ≤
                                       β
                                       ≤
                                       1
                                    .

After solving the inequalities for each triangle face, the largest possible value for 
                              β
                            can be obtained by combining the solutions together. Then the parameters are updated using 
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                              +
                              β
                              
                                 Δ
                              
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                           . With 
                              β
                            being a constraint for the correction terms, now the parameters will not be over-corrected.

This section describes two processes related to the initial 
                        T
                     -spline structure: placement and re-placement.

An initial 
                           T
                        -spline structure is required to be set up for surface fitting to start with. Specifically, we have to specify the parameter domain, the 
                           T
                        -mesh topology (i.e., knot structure), and the control point weights.

The parameter domain 
                           Ω
                           ⊂
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         of the 
                           T
                        -spline surface to be reconstructed is set to be the domain that the triangular mesh is parameterized to, which is 
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                           ×
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                        . Since our fitting approach is in an adaptive fashion, we would like to begin with a relatively simple 
                           T
                        -mesh structure. For example, we can choose the initial surface to be a bicubic 
                           B
                        -spline patch with a 4×4 control grid. The knot vectors along the 
                           U
                         and 
                           V
                         directions are both set to be 
                           
                              {
                              −
                              2
                              μ
                              ,
                              −
                              μ
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              +
                              μ
                              ,
                              1
                              +
                              2
                              μ
                              }
                           
                        , where 
                           μ
                         is a non-negative number. In general, we would like to let 
                           μ
                           =
                           0
                         to impose multiple knots on the boundary. In the parameter space, the lines corresponding to these knots (except for the first and the last one of each direction) form the pre-image of the control mesh of the surface. We denote this structure by 
                           M
                        . Fig. 6
                         shows this initial pre-image. In the figure, the domain of the surface is highlighted. The dashed lines are phantom edges that are needed for the surface definition.

We also let all the control point weights be one. Denote by 
                           W
                         the set of all control point weights. Then 
                           M
                         and 
                           W
                         define a class of 
                           T
                        -splines that have the same pre-image 
                           M
                         and the same weights 
                           W
                        . We denote this class by 
                           
                              
                                 S
                              
                              
                                 M
                                 ,
                                 W
                              
                           
                        . For any surface in the class 
                           
                              
                                 S
                              
                              
                                 M
                                 ,
                                 W
                              
                           
                           ,
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                           ≡
                           1
                        . A 
                           T
                        -spline surface that satisfies such a condition is known as a standard/semi-standard 
                           T
                        -spline surface, which is actually a piecewise polynomial surface. An interesting property of 
                           T
                        -splines is that if we perform a local refinement on a standard/semi-standard 
                           T
                        -spline surface, the result will still be a standard/semi-standard 
                           T
                        -spline surface  [14].

The initial 
                           T
                        -spline structure setup described in the previous subsection is simple, but has a few drawbacks. First, the characteristics of the model are not taken into account in the initial 
                           T
                        -spline knot placement. Second, the initial setup is too far away from the final one, which could affect the overall computation time. While the optimal initial 
                           T
                        -spline structure is very difficult to find if not impossible, we here present a heuristic approach to construct a reasonable initial 
                           T
                        -spline structure using the mesh as well as the 
                           T
                        -spline surface obtained in the previous iteration as references. Let 
                           M
                         be the knot structure of the previously obtained 
                           T
                        -spline surface. We want to build a new initial 
                           T
                        -spline structure 
                           
                              
                                 M
                              
                              
                                 ′
                              
                           
                         based on the input triangular mesh 
                           
                              T
                           
                         and 
                           M
                        . The 
                           T
                        -spline structure re-placement consists of two steps.

First, a tensor product knot structure 
                           
                              
                                 M
                              
                              
                                 t
                                 p
                              
                           
                         is derived from 
                           M
                        . Each knot in the 
                           U
                         and 
                           V
                         knot vectors of 
                           M
                         is examined. For a knot 
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                         in the 
                           U
                         knot vector, find all the vertical edges in 
                           M
                         that are associated to it. The lengths of these vertical edges are accumulated and the sum is denoted by 
                           
                              
                                 l
                              
                              
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        . If 
                           
                              
                                 l
                              
                              
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                              
                           
                         is larger than a certain threshold, say, 0.7, it is indicated that the impact 
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                         has on the surface is likely global rather than local. It could be more effective for the representation to use a complete knot line instead of a couple of partial edges, which could help to reduce the number of 
                           T
                        -junctions and make the structure of the 
                           T
                        -spline control grid simpler. Therefore, in the new tensor product knot structure 
                           
                              
                                 M
                              
                              
                                 t
                                 p
                              
                           
                        , a complete knot line 
                           u
                           =
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                         is included (see Fig. 7
                         for an illustration). The knots in the 
                           V
                         knot vector of 
                           M
                         are handled with the same strategy. In this way, a tensor product knot structure 
                           
                              
                                 M
                              
                              
                                 t
                                 p
                              
                           
                         can be obtained. All the control point weights in 
                           
                              
                                 M
                              
                              
                                 t
                                 p
                              
                           
                         are set to one.

Second, based on 
                           
                              
                                 M
                              
                              
                                 t
                                 p
                              
                           
                        , we continue to construct 
                           
                              
                                 M
                              
                              
                                 ′
                              
                           
                         using the mesh 
                           
                              T
                           
                        . We pick a few vertices of the mesh that have the largest mean curvatures (the calculation of which will be described in Section  5.2). For each of these vertices, we find its closest point on the existing knot lines of 
                           
                              
                                 M
                              
                              
                                 t
                                 p
                              
                           
                         by the parameter coordinates, and refine 
                           
                              
                                 M
                              
                              
                                 t
                                 p
                              
                           
                         by inserting a knot at the location of the closest point using the 
                           T
                        -spline local refinement algorithm. The 
                           T
                        -spline local refinement algorithm also updates the control point weights accordingly. In this way, the constructed 
                           
                              
                                 M
                              
                              
                                 ′
                              
                           
                         and the control point weights together are guaranteed to define a class of standard/semi-standard 
                           T
                        -spline surfaces.


                        Fig. 8
                        (a) is an example showing the pre-image of a re-placed initial 
                           T
                        -spline structure. The corresponding optimal surface is shown in Fig. 8(b).

Our 
                        T
                     -spline fitting process itself is an iterative least-squares procedure consisting of three sub-components, shown in the flowchart in Fig. 9
                     . Given a 
                        T
                     -spline knot structure, the optimal 
                        T
                     -spline surface is computed using least-squares optimization. Then the quality of the obtained surface is checked, taking surface features into account. If the surface passes the quality checking, the obtained 
                        T
                     -spline surface is considered a qualified candidate. Otherwise, the current 
                        T
                     -spline structure is adaptively refined. The refined 
                        T
                     -spline structure is used in least-squares optimization again to find the next best surface. The details are elaborated next.

The computation of the optimal 
                           T
                        -spline surface from a given topology is done in a similar fashion described in  [15], except that the points we deal with here are 3D, rather than the 
                           z
                        -values. Given a 
                           T
                        -mesh knot structure (i.e., the 
                           T
                        -spline pre-image 
                           M
                        ) and a set of control point weights 
                           W
                        , a class of 
                           T
                        -spline surfaces 
                           
                              
                                 S
                              
                              
                                 M
                                 ,
                                 W
                              
                           
                         is defined. 
                           M
                         and 
                           W
                         are either set in initial structure placement or generated by later adaptive structure refinements. In 
                           
                              
                                 S
                              
                              
                                 M
                                 ,
                                 W
                              
                           
                        , all the 
                           T
                        -spline surfaces have the same 
                           T
                        -mesh topology and weights; only their geometry is different. Therefore, we seek the geometrically optimal 
                           T
                        -spline surface in 
                           
                              
                                 S
                              
                              
                                 M
                                 ,
                                 W
                              
                           
                        , which best fits the triangular mesh under criteria given in Eq. (2). Note that any 
                           T
                        -spline surface in 
                           
                              
                                 S
                              
                              
                                 M
                                 ,
                                 W
                              
                           
                         is standard/semi-standard due to our configurations in initial 
                           T
                        -spline structure placement and the use of 
                           T
                        -spline local knot insertion in 
                           T
                        -spline structure refinement (which will be discussed in Section  5.3). Therefore the optimal surface we intend to find is actually a piecewise polynomial surface, which can thus be written as 
                           
                              (13)
                              
                                 
                                    S
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 .
                              
                           
                        
                     

We are trying to find a surface 
                           
                              S
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         in the class 
                           
                              
                                 S
                              
                              
                                 M
                                 ,
                                 W
                              
                           
                         that minimizes the sum of the squared parametric distances between the vertices of the mesh and the surface. Moreover, to generate a visually fair surface, we often need to add a fairness functional term 
                           
                              
                                 J
                              
                              
                                 
                                    fair
                                 
                              
                           
                           
                              (
                              f
                              )
                           
                         into the objective function  [22]. We choose the thin plate energy as the fairness term, which physically represents the bending energy stored in a thin sheet of metal that is being deformed to the shape of the surface. The smaller the value of the fairness term is, the smoother the surface shape would be. The optimization problem hence becomes minimizing the following objective function: 
                           
                              (14)
                              
                                 F
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       
                                          ‖
                                          
                                             S
                                          
                                          
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                             
                                                
                                                   v
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   j
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 σ
                                 
                                    
                                       J
                                    
                                    
                                       
                                          fair
                                       
                                    
                                 
                                 
                                    (
                                    S
                                    )
                                 
                              
                           
                         where 
                           σ
                         is a tradeoff constant that balances the approximation accuracy and fairness. A larger 
                           σ
                         will lead to a smoother surface, while a smaller 
                           σ
                         will give a more accurate approximation. The simple thin plate energy 
                           
                              
                                 J
                              
                              
                                 
                                    fair
                                 
                              
                           
                           
                              (
                              S
                              )
                           
                         is formulated as:


                        
                           
                              (15)
                              
                                 
                                    
                                       J
                                    
                                    
                                       
                                          fair
                                       
                                    
                                 
                                 
                                    (
                                    
                                       S
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∬
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          u
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    +
                                    2
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          u
                                          v
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    +
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          v
                                          v
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    )
                                 
                                 d
                                 u
                                 d
                                 v
                                 .
                              
                           
                        
                     

Note that the objective function is quadratic in control points. To solve the optimization problem, we differentiate the objective function with respect to each control point 
                           
                              
                                 P
                              
                              
                                 g
                              
                           
                         and let the partial derivative equal zero: 
                           
                              
                                 ∂
                                 F
                              
                              
                                 ∂
                                 
                                    
                                       P
                                    
                                    
                                       g
                                    
                                 
                              
                           
                           =
                           0
                        . This leads to 
                           
                              (16)
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       
                                          B
                                       
                                       
                                          g
                                       
                                    
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    +
                                    σ
                                    
                                       
                                          m
                                       
                                       
                                          g
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       g
                                    
                                 
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              
                           
                         for 
                           g
                           =
                           1
                           ,
                           …
                           ,
                           n
                        , where 
                           
                              
                                 m
                              
                              
                                 g
                                 i
                              
                           
                         are coefficients contributed from the fairness functional.

If we introduce an 
                           n
                           ×
                           n
                         matrix 
                           A
                           =
                           
                              (
                              
                                 
                                    a
                                 
                                 
                                    g
                                    i
                                 
                              
                              )
                           
                        , two 
                           n
                           ×
                           1
                         vectors 
                           B
                           =
                           
                              (
                              
                                 
                                    b
                                 
                                 
                                    g
                                 
                              
                              )
                           
                         and 
                           P
                           =
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    g
                                 
                              
                              )
                           
                         with 
                           
                              (17)
                              
                                 
                                    
                                       a
                                    
                                    
                                       g
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       
                                          B
                                       
                                       
                                          g
                                       
                                    
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    +
                                    σ
                                    
                                       
                                          m
                                       
                                       
                                          g
                                          i
                                       
                                    
                                    )
                                 
                              
                           
                         and 
                           
                              (18)
                              
                                 
                                    
                                       b
                                    
                                    
                                       g
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       g
                                    
                                 
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         then the above linear equations can be written as 
                           
                              (19)
                              
                                 A
                                 ⋅
                                 P
                                 =
                                 B
                                 .
                              
                           
                         The solution of the linear system is the solution of the least-squares problem that minimizes (14), which gives the control points defining the optimal 
                           T
                        -spline surface.

Once the optimal surface is obtained, its quality needs to be checked. One way of quality checking is to test whether the parametric distance of each vertex of the triangular mesh to the 
                           T
                        -spline surface is below the given tolerance 
                           ε
                        .

It is observed that many free-form models contain geometrical features that reflect geometrical details on the models, and even if the obtained surface passes the quality check for an error tolerance, the features are still missing or not well respected, which implies that the tolerance may not be small enough for the features. This observation suggests that we should adapt the given error tolerance according to the feature distribution. We need to pay more attention to the feature areas because they are more difficult to achieve a good approximation than the non-feature areas. Thus for a feature area, a high fitting precision (i.e., a low error tolerance) should be adopted in order to generate faithful reconstruction.

Curvatures describe the amount by which the shape deviates from a plane. In general, a surface region that contains geometrical features would have higher curvature values while the non-feature regions would have lower curvature values. At a point on a surface, an infinite number of curvatures in various directions can be defined. The mean curvature 
                           h
                         is the average of two principal curvatures at the point, and thus serves as a good measurement for features. For a triangular mesh, the discrete mean curvature at a vertex 
                           
                              
                                 
                                    d
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                         can be computed using the information of its 1-ring neighborhood  [23,24]: 
                           
                              (20)
                              
                                 
                                    
                                       h
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    ‖
                                    
                                       
                                          1
                                       
                                       
                                          4
                                          A
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                
                                                   val
                                                
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       (
                                       cot
                                       
                                          
                                             α
                                          
                                          
                                             j
                                          
                                       
                                       +
                                       cot
                                       
                                          
                                             β
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             
                                                d
                                             
                                          
                                          
                                             
                                                j
                                             
                                          
                                       
                                       −
                                       
                                          
                                             
                                                d
                                             
                                          
                                          
                                             
                                                i
                                             
                                          
                                       
                                       )
                                    
                                    ‖
                                 
                              
                           
                         where 
                           A
                         is the sum of the area of the triangle faces adjacent to 
                           
                              
                                 
                                    d
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 β
                              
                              
                                 j
                              
                           
                         are the two angles opposite to the edge connecting 
                           
                              
                                 
                                    d
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    d
                                 
                              
                              
                                 
                                    j
                                 
                              
                           
                         as illustrated in Fig. 10
                        , and 
                           
                              
                                 
                                    val
                                 
                              
                              
                                 i
                              
                           
                         is the valence of 
                           
                              
                                 
                                    d
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                        . Fig. 11
                        (a) shows the color plot of mean curvatures of the Stegosaurus model, where the color red represents high curvature values and the color blue represents low curvature values. It can be seen that there is a good correspondence between high curvature regions and surface features.

We let the mean curvatures calculated at each vertex serve as a guidance for the error tolerance and introduce the curvature-guided variant error tolerance 
                           
                              
                                 ε
                              
                              
                                 i
                              
                           
                         for vertex 
                           
                              
                                 
                                    d
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                        : 
                           
                              (21)
                              
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                                 ε
                              
                           
                         where 
                           
                              
                                 k
                              
                              
                                 i
                              
                           
                         is a curvature guidance factor determined by the discrete mean curvature at vertex 
                           
                              
                                 
                                    d
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                        : 
                           
                              (22)
                              
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 max
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ̄
                                                   
                                                
                                             
                                             
                                                
                                                   max
                                                
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ̄
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ̄
                                                   
                                                
                                             
                                             
                                                
                                                   max
                                                
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ̄
                                                   
                                                
                                             
                                             
                                                
                                                   min
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    η
                                    )
                                 
                                 .
                              
                           
                         Here 
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 i
                              
                           
                           =
                           log
                           
                              (
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              +
                              1
                              )
                           
                         is the logarithm of the mean curvature 
                           
                              
                                 h
                              
                              
                                 i
                              
                           
                        , the purpose of which is to concentrate the curvature values. 
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 
                                    max
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 
                                    min
                                 
                              
                           
                         are the maximum and minimum values among all the 
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 i
                              
                           
                           
                           
                              (
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              m
                              )
                           
                         which are used to normalize the mean curvature values to the interval of 
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                        . A small value 
                           η
                         is used as a threshold to filter the curvatures values that are too big. In this paper, we choose 
                           η
                           =
                           0.05
                        . In this manner, we would have smaller tolerances for the vertices in the high mean curvature areas.

Now, instead of Eq. (2), we use 
                           
                              ‖
                              
                                 S
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              −
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                              ‖
                           
                           ≤
                           
                              
                                 ε
                              
                              
                                 i
                              
                           
                         to determine whether a vertex 
                           
                              
                                 
                                    d
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                         is satisfactorily approximated. If all the vertices in the triangular mesh pass the quality test, the 
                           T
                        -spline surface is considered acceptable. Otherwise, further treatment is required. Also, it is trivial that the values of 
                           
                              
                                 ε
                              
                              
                                 i
                              
                           
                         do not change throughout the algorithm and therefore only need to be calculated once. Fig. 11(b) shows the result after an error checking process. In the figure, the red points represent the vertices that fail the test. It can be seen that most of these points are concentrated at the regions with features.

If the 
                           T
                        -mesh structure of the current 
                           T
                        -spline surface class 
                           
                              
                                 S
                              
                              
                                 M
                                 ,
                                 W
                              
                           
                         is not appropriate, even the best fit surface of the class might not well represent the shape of the input triangular mesh. Therefore, when the preset error tolerance is not met, the current 
                           T
                        -mesh structure needs to be improved by refinement.

We refine the 
                           T
                        -mesh at the regions where some points fail the error checking. These points are called the violating points and the regions containing the violating points are called the offending regions. Our strategy is to insert edges to split the offending regions.

While there are different ways to split a region, we follow the principle that an offending region should, in general, be split in half in the direction where the region has a larger knot difference. Specifically, assume a region is a rectangular box whose lower-left corner has coordinates 
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    
                                       min
                                    
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    
                                       min
                                    
                                 
                              
                              )
                           
                         and whose upper-right corner has coordinates 
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                              )
                           
                        . If 
                           
                              
                                 u
                              
                              
                                 
                                    max
                                 
                              
                           
                           −
                           
                              
                                 u
                              
                              
                                 
                                    min
                                 
                              
                           
                           >
                           
                              
                                 v
                              
                              
                                 
                                    max
                                 
                              
                           
                           −
                           
                              
                                 v
                              
                              
                                 
                                    min
                                 
                              
                           
                        , then we split the region vertically at 
                           u
                           =
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                              +
                              
                                 
                                    u
                                 
                                 
                                    
                                       min
                                    
                                 
                              
                              )
                           
                           /
                           2
                        . If 
                           
                              
                                 u
                              
                              
                                 
                                    max
                                 
                              
                           
                           −
                           
                              
                                 u
                              
                              
                                 
                                    min
                                 
                              
                           
                           <
                           
                              
                                 v
                              
                              
                                 
                                    max
                                 
                              
                           
                           −
                           
                              
                                 v
                              
                              
                                 
                                    min
                                 
                              
                           
                        , then we split the region horizontally at 
                           v
                           =
                           
                              (
                              
                                 
                                    v
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                              +
                              
                                 
                                    v
                                 
                                 
                                    
                                       min
                                    
                                 
                              
                              )
                           
                           /
                           2
                        . In case both the knot differences are the same, then either direction could be chosen for splitting. Fig. 12
                         provides some illustrations. The offending regions are highlighted in the figures. For the offending region in Fig. 12(a), we split it with a horizontal edge; analogously, for the one in Fig. 12(b), we split it with a vertical edge.

The actual splitting of a region is accomplished by performing a local refinement in which the two endpoints of the edge used to split the region are inserted into the 
                           T
                        -mesh using the 
                           T
                        -spline local knot insertion algorithm. The knot insertion algorithm might introduce a few extra points into the 
                           T
                        -mesh.

After the refinement is completed, a new 
                           T
                        -mesh structure and the corresponding set of weights are obtained and thus a new class of 
                           T
                        -spline surfaces can be defined. The new class of 
                           T
                        -spline surfaces has more degrees of freedom than the old one. It is worth pointing out that since the new 
                           T
                        -mesh structure and weights are obtained by the 
                           T
                        -spline local knot insertion algorithm, the 
                           T
                        -spline surfaces in the new class are still standard or semi-standard. That is, they are piecewise polynomial surfaces. What remains to define a 
                           T
                        -spline surface is the geometry of control points, which could be determined by another routine of least-squares optimization.

@&#EXPERIMENTS@&#

This section presents our experimental results to demonstrate the proposed algorithm and various components. In our implementation, we adopt the preconditioned complex bi-conjugate gradient (PCBCG) solver  [25] to solve linear systems due to its good performance and stability. 
                        Example 1
                        This example demonstrates how the curvature-guided 
                              T
                           -spline fitting, one of the major components of our algorithm, is carried out, given a parameterization and an initial 
                              T
                           -spline structure placement. As depicted by Fig. 9, the fitting process is further comprised of a few sub-components, and might require several internal loops. A step by step illustration of fitting the Stegosaurus model is given in Fig. 13
                           . Fig. 13(a) shows the input mesh. We begin with a preliminary 4×4
                              T
                           -mesh topology which is shown in Fig. 13(b). In the calculation of the least-squares optimal surface, both the geometric error and the shape fairness are considered. Unless explicitly specified, the fairness factor 
                              σ
                            is set to be 
                              1
                              
                                 
                                    0
                                 
                                 
                                    −
                                    4
                                 
                              
                            in this paper. Each time the optimal surface is found, the surface is checked with the curvature-guided variant error tolerances. For this model, the global error tolerance 
                              ε
                            is set to be 0.5% of the scale of the triangular mesh. Obviously, the surface shown in Fig. 13(b) is far from satisfactory and many vertices in the mesh violate the error tolerance. Therefore, the 
                              T
                           -mesh needs to be refined, followed by another instance of calculating the optimal surface.


                     Fig. 13(c) and (d) show two of the subsequent intermediate results after a few more internal loops. It can be observed that as the 
                        T
                     -mesh is being gradually refined, the optimal 
                        T
                     -spline surface contains more and more geometrical details and gains more resemblance to the input mesh. Some statistics for these 
                        T
                     -spline surfaces is provided in Table 1
                     , which includes for each surface the number of control points, the number of knots in both parameter directions, the percentage of the violating vertices, and the maximum and average approximation error. It can be seen that the approximation error is reduced as more control points are added to the 
                        T
                     -mesh.

Eventually, Fig. 13(e) shows the final qualified fitting 
                        T
                     -spline surface, whose maximum error is below 0.37%. Fig. 13(f)–(h) display the pre-image of the 
                        T
                     -mesh in 2D, the mapping of the pre-image on the surface and the 
                        T
                     -mesh, respectively. The average approximation error is even lower, which is just 0.04%. The geometry of the triangular mesh is well represented by the 
                        T
                     -spline surface and it can be seen that more control points are located at the regions with rich geometrical details.

The surface has 2544 control points. There are 174 and 75 knots in the two parameter directions respectively and a 
                        B
                     -spline surface defined by these knots would have to host 
                        174
                        ×
                        75
                        =
                        13
                        
                        050
                      control points. The permit of the existence of 
                        T
                     -junctions has brought a lot of flexibility into the construction of the control grid and enables the resulting 
                        T
                     -spline surface to keep only a concise set of control points.


                     
                        Example 2
                        This example investigates the effectiveness of the re-placement of the initial 
                              T
                           -mesh structure and the re-parameterization of the triangular mesh. Using the 
                              T
                           -spline surface shown in Fig. 13(e) as a reference, a new initial 
                              T
                           -mesh topology (see Fig. 14
                           (a)) and a re-parameterization of the mesh (see Fig. 14(b)) are obtained. Next, we use them as the initial settings in surface fitting, both individually and simultaneously. Fig. 14(c) shows the surface fitting result which uses the 
                              T
                           -mesh topology in Fig. 14(a) as the initial setting. From the left to the right in Fig. 14(c) are the resulting 
                              T
                           -spline surface, the 
                              T
                           -mesh pre-image, the surface with mapped pre-image and the 
                              T
                           -mesh. Similarly, Fig. 14(d) is the surface fitting result that adopts the re-parameterization in Fig. 14(b). Finally, the 
                              T
                           -spline surface in Fig. 14(e) is obtained by using both the new 
                              T
                           -mesh initialization and the re-parameterization. The statistics of the surface fitting results is given in Table 2
                           . While the approximation errors remain roughly at the same level as the 
                              T
                           -spline surface shown in Fig. 13(e), all of the newly obtained surfaces have fewer control points. In the case where both the new 
                              T
                           -mesh initialization and the re-parameterization are used, a surface with the fewest number of control points is achieved. Since the quality of the surfaces is not compromised, the new results can be regarded as having higher efficiency in representation.


                     
                        Example 3
                        This example demonstrates the performance of executing the entire proposed algorithm for a number of iterations. Let 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    i
                                 
                              
                            be the surface fitting result after the main loop shown in Fig. 2 is executed for 
                              i
                            iterations. Fig. 15
                           (b)–(d) show the surface 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    3
                                 
                              
                            that approximate the triangular mesh in Fig. 15(a). The corresponding 
                              T
                           -meshes for them are displayed in Fig. 15(e)–(g), respectively. The related statistics for these surfaces is given in Table 3
                           , from which it can be seen that the number of control points is being gradually reduced, from 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    1
                                 
                              
                            to 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    3
                                 
                              
                           . Moreover, it can be observed in Fig. 15 that as the iterations go on, the distribution of the control points in the 
                              T
                           -mesh of the surface becomes more reasonable. In the 
                              T
                           -mesh for 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    3
                                 
                              
                            (shown in Fig. 15(g)), more control points are concentrated in the eye, nose and mouth areas.

According to our experience, a good result can be obtained in 2–5 iterations of the overall algorithm. We demand that the result from current iteration must show an improvement of 3% against the previous one. The improvement can be reflected either in lower final approximation error or fewer number of control points in the final 
                        T
                     -mesh. When neither of these two targets is improved, the overall algorithm terminates.

We also compare our approach with the traditional 
                        B
                     -spline surface fitting. Fig. 16
                      shows the result of fitting the same model using a non-uniform 
                        B
                     -spline surface. In order to achieve the same fitting precision as 
                        
                           
                              
                                 S
                              
                           
                           
                              3
                           
                        
                     , the result 
                        B
                     -spline surface finally needs 2444 control points, which is 63% more than that of 
                        
                           
                              
                                 S
                              
                           
                           
                              3
                           
                        
                     . From its control grid shown in Fig. 16(b), it can be noticed that several regions on the surface are unnecessarily over-refined. 
                        Example 4
                        We further analyze the effect of the curvature guidance in surface fitting. Surface 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    a
                                 
                              
                            in Fig. 17
                           (a) is obtained with the curvature guidance enabled during the surface fitting process and it has 1688 control points. Surface 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    b
                                 
                              
                            in Fig. 17(b) is obtained by using the same global error tolerance as for 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    a
                                 
                              
                           , but only the curvature guidance is disabled during surface fitting. 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    b
                                 
                              
                            has fewer control points, but the surface quality is quite low, especially in the eye and mouth areas where details are lost. If one wants to achieve a similar surface quality as 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    a
                                 
                              
                            without using the curvature guidance in surface fitting, the global error tolerance thus has to be set to a very small value. This leads to surface 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    c
                                 
                              
                            in Fig. 17(c), which has 2024 control points that are 20% more than the control points of 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    a
                                 
                              
                           . From Fig. 17(f), it can be seen that the distribution of the control points for 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    c
                                 
                              
                            is quite uniform, placing as many control points in the non-feature areas as in the feature areas. This would lower the efficiency of the surface representation, which is not preferred in applications.

Finally, more examples of fitting various models are provided in Fig. 18
                     . From the leftmost column to the rightmost column are the input meshes, the resulting 
                        T
                     -spline surfaces, the pre-images and the 
                        T
                     -meshes. The number of control points and the approximation errors for these surfaces are given in Table 4
                     .

@&#CONCLUSION@&#

We have described several plug-and-play components and strategies to enhance the spline surface fitting. The use of these components and strategies promises an adaptive 
                        T
                     -spline fitting algorithm that well captures the surface features and generates a compact 
                        T
                     -spline representation. The experiments have successfully demonstrated the effectiveness of these components and strategies. Adapting them to more general surface fitting problems such as fitting an arbitrarily topological mesh is a worthwhile goal and is being studied.

@&#ACKNOWLEDGMENT@&#

This work is supported by ARC 9/09 Grant (MOE2008-T2-1-075) from Singapore.

@&#REFERENCES@&#

