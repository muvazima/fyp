@&#MAIN-TITLE@&#The reconstructed residual error: A novel segmentation evaluation measure for reconstructed images in tomography

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We introduce the reconstructed residual error, a new segmentation evaluation measure.


                        
                        
                           
                           The method provides a spatial map of the errors in a segmented image in tomography.


                        
                        
                           
                           The original projection images are exploited in an unsupervised approach.


                        
                        
                           
                           Validation is performed through simulations and experimental micro-CT data.


                        
                        
                           
                           The method can improve gray level estimates and discriminate between segmentations.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Computed tomography

Image segmentation

Segmentation evaluation

@&#ABSTRACT@&#


               
               
                  In this paper, we present the reconstructed residual error, which evaluates the quality of a given segmentation of a reconstructed image in tomography. This novel evaluation method, which is independent of the methods that were used to reconstruct and segment the image, is applicable to segmentations that are based on the density of the scanned object. It provides a spatial map of the errors in the segmented image, based on the projection data. The reconstructed residual error is a reconstruction of the difference between the recorded data and the forward projection of that segmented image. The properties and applications of the algorithm are verified experimentally through simulations and experimental micro-CT data. The experiments show that the reconstructed residual error is close to the true error, that it can improve gray level estimates, and that it can help discriminating between different segmentations.
               
            

@&#INTRODUCTION@&#

In many applications of tomography [1], such as the delineation of anatomical structures (in medical imaging) and object detection (in computer vision), the reconstructed image must be segmented before the results can be analyzed. Segmentation is defined as the classification of image pixels into distinct classes, based on similarity with respect to some characteristic. Numerous methods have been proposed, such as global and local thresholding, region growing, clustering, and atlas-guided approaches [2–4].

Given a segmentation, objectively evaluating the accuracy of that segmentation is not a trivial task [5,6]. Supervised methods evaluate a segmentation algorithm by comparing its output with gold standard segmentations. However, since such segmentations are typically not available in practice, they must often be generated manually, which is not easy and may make the evaluation subjective. Unsupervised methods (also sometimes called stand-alone methods 
                     [7]) do not need gold standards, as they evaluate the segmentation results directly, using one or more of the de facto standard criteria of Haralick and Shapiro [2]. These methods are objective and applicable to a wide variety of images, but their analysis is restricted to the segmentation result itself. A possibility that is often overlooked, in the specific case of tomography, is exploiting the available projection images, which can provide external information about the segmented image.

The current paper introduces the reconstructed residual error, which does exploit the original projection images. Our method is applicable to reconstruction problems for which the segmentation is based on the density of the scanned object, where we use the term density to refer to the particular physical property of the object of which linear projections are acquired during the scanning process (e.g., mass density, X-ray attenuation, electron beam scattering, etc.). The reconstructed residual error is an unsupervised evaluation in the terminology of [6], since it is an objective evaluation at the level of the segmentation itself that does not need a reference image [6, Fig. 1]. In contrast to the unsupervised methods surveyed in [6], the proposed method does not have to rely on the criteria of Haralick and Shapiro, since it uses the projection images as external information.

The reconstructed residual error evaluates a given segmentation by providing a spatial map of the errors. It is computed by reconstructing the difference between the recorded data and the forward projection of that segmentation. The computation of the error map is independent of the methods that were used for reconstructing the image and determining the segmentation.

The remainder of this paper is organized as follows. In Section 2, the reconstructed residual error is defined and its properties are described in detail. Section 3 reports on the results of experiments, using both simulations and experimental micro-CT data. These results are discussed in Section 4, and conclusions are drawn in Section 5.

Here, we describe the reconstructed residual error. We first present an intuitive overview of its computation, before giving a complete description of its properties.

@&#OVERVIEW@&#


                        Fig. 1
                         presents an overview of the computation of the reconstructed residual error. The example is based on a two-dimensional slice through objects with simple geometrical shapes and only two different gray levels (Fig. 1a). The original projection data (Fig. 1b) is a sinogram, acquired by rotating around the object. This sinogram is then reconstructed (Fig. 1c) and segmented (Fig. 1e). For this overview figure, the segmented reconstruction was computed by thresholding Fig. 1c, and subsequently choosing gray levels. The reconstructed residual error is computed from the original projection data (Fig. 1b) and the segmented reconstruction (Fig. 1e). The original (non-segmented) reconstruction (Fig. 1c) is not used.

To compute the reconstructed residual error, the segmented reconstruction (Fig. 1e) is first projected forward. The result of this operation (Fig. 1d) is then subtracted from the original projections, resulting in the residual projection error (Fig. 1g). The residual projection error is then reconstructed to provide the reconstructed residual error (Fig. 1h), which provides a spatial map of the segmentation error. From Fig. 1h, it is clear that both gray levels of the segmented reconstruction are incorrect. The erroneous lines and dots in the segmented reconstruction (Fig. 1e), which are caused by artifacts in the reconstruction (Fig. 1c), are also clearly visible in Fig. 1h. Note that the true error (Fig. 1i), which is the difference between the original object (Fig. 1a) and the segmented reconstruction, is quite close to the reconstructed residual error.

An alternative that might be considered, is to simply compute the difference between the original and the segmented reconstruction (Fig. 1f). However, this difference can be expected to show much more reconstruction artifacts, as is explained in Section 2.4. An intuitive way to see this is that, for phantom experiments, the segmented reconstruction can potentially be identical to the phantom, in which case the residual projection error (Fig. 1g) would be zero. Hence, a perfect segmentation would result in the reconstructed residual error (Fig. 1h) being zero everywhere, while the difference between the original and the segmented reconstruction (Fig. 1f) will always exhibit the reconstruction artifacts of the original reconstruction (Fig. 1c).

The projection process in tomography can be modeled as a linear operator that is determined by the projection geometry. This leads to a system of linear equations,
                           
                              (1)
                              
                                 Wx
                                 +
                                 n
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       ̃
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    p
                                 
                                 
                                    ̃
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    m
                                 
                              
                           
                         is the measured projection data, 
                           
                              n
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    m
                                 
                              
                           
                         is the noise, and 
                           
                              x
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                         is the unknown image. The linear operator is represented by the 
                           
                              m
                              ×
                              n
                           
                         matrix 
                           
                              W
                           
                        , the projection matrix. An approximate solution 
                           
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                         of (1) can then be computed, for example by minimizing some norm 
                           
                              ‖
                              Wx
                              -
                              
                                 
                                    p
                                 
                                 
                                    ̃
                                 
                              
                              ‖
                           
                        .

In Sections 2.4 and 2.5, we assume that 
                           
                              n
                              =
                              0
                           
                         and explicitly refer to the ground truth object as 
                           
                              g
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                        , which leads to 
                           
                              p
                              =
                              Wg
                           
                        , where 
                           
                              p
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    m
                                 
                              
                           
                         are noiseless projections. We denote a general reconstruction algorithm as an operator 
                           
                              R
                              :
                              
                                 
                                    R
                                 
                                 
                                    m
                                 
                              
                              →
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                        , which leads to 
                           
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              R
                              Wg
                           
                        . The so-called shortest least squares solution is denoted as 
                           
                              
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                              =
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                              p
                           
                        , with 
                           
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                           
                         the Moore–Penrose pseudoinverse [8, Section 7.3] of 
                           
                              W
                           
                        . We denote the row (or image) space of 
                           
                              W
                           
                         by 
                           
                              R
                              (
                              W
                              )
                           
                        , and the null space by 
                           
                              N
                              (
                              W
                              )
                           
                        . See again [8] for details on these concepts from linear algebra.

A segmentation partitions the pixels of an image into sets 
                           
                              
                                 
                                    Y
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    Y
                                 
                                 
                                    d
                                 
                              
                           
                        , where d is the number of classes (segments) in the segmented image. Determining d can be a difficult problem [9]. However, since the proposed method operates on an already segmented image, we can assume d to be known. If it is assumed that the segmentation is based on the density of the scanned object, then it is possible to assign a gray level 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    k
                                 
                              
                           
                         to each class 
                           
                              
                                 
                                    Y
                                 
                                 
                                    k
                                 
                              
                           
                         that is also related to that density. In Section 2, we assume that segmentation has been performed and gray levels have been assigned, resulting in a segmented image 
                           
                              s
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                        . The actual segmentation algorithm and the way in which the gray levels were selected is not relevant for the definition and the properties of the proposed method. In Section 3, we do detail how we performed these operations in the experiments.

Here, we define the reconstructed residual error. Inputs are the segmented image 
                           
                              s
                           
                         and the measured projection data 
                           
                              
                                 
                                    p
                                 
                                 
                                    ̃
                                 
                              
                           
                        . First, 
                           
                              s
                           
                         is forward projected to give 
                           
                              
                                 
                                    p
                                 
                                 
                                    s
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    m
                                 
                              
                           
                        , so 
                           
                              
                                 
                                    p
                                 
                                 
                                    s
                                 
                              
                              =
                              Ws
                           
                        . The residual projection error 
                        
                           
                              
                                 
                                    p
                                 
                                 
                                    e
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    m
                                 
                              
                           
                         is then defined as 
                           
                              
                                 
                                    p
                                 
                                 
                                    e
                                 
                              
                              =
                              
                                 
                                    p
                                 
                                 
                                    ̃
                                 
                              
                              -
                              
                                 
                                    p
                                 
                                 
                                    s
                                 
                              
                           
                        . Second, the residual error is reconstructed by computing an approximate solution of the system
                           
                              (2)
                              
                                 We
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       ̃
                                    
                                 
                                 -
                                 
                                    
                                       p
                                    
                                    
                                       s
                                    
                                 
                                 ,
                              
                           
                        as for the system of (1). Here, 
                           
                              e
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                         corresponds to the (unknown) error image. The approximate solution 
                           
                              
                                 
                                    e
                                 
                                 
                                    ˆ
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                         is then defined to be the reconstructed residual error. The least squares solution is again denoted by 
                           
                              
                                 
                                    e
                                 
                                 
                                    +
                                 
                              
                           
                        , as for 
                           
                              
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                           
                        .

The theoretical treatment of the reconstructed residual error in Sections 2.4 and 2.5 is applicable in two and three dimensions, and is independent of the geometry of the scanner (e.g., parallel beam, cone beam, etc.), since that simply results in a different 
                           
                              W
                           
                         in (1) and (2).

In this section, we study the reconstructed residual error under the assumption that the Moore–Penrose pseudoinverse 
                           
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                           
                         is used, both for the original reconstruction and to compute the reconstructed residual error itself. Doing so makes the reconstruction algorithm a well-defined operator, and allows us to be mathematically rigorous. However, despite being useful as a mathematical model, the Moore–Penrose pseudoinverse is not a practical reconstruction method due to, e.g., its susceptibility to noise and high computational cost. Therefore, inverting the projection matrix is not attempted in practice, and iterative methods are used to solve the reconstruction problem [10]. Hence, after our initial analysis using the pseudoinverse, we switch to practical reconstruction methods in Section 2.5 and show that these also result in an error map that is close to the true one.

First, we formally define what we mean by the term artifact. Typically, a reconstructed image contains different types of artifacts, with causes such as scanner imperfections, noise, the reconstruction algorithm, and the segmentation algorithm. In the current paper, we consider all differences between the ground truth object and the (possibly segmented) final image to be artifacts.
                           Definition 1
                           The artifacts of an image 
                                 
                                    y
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          n
                                       
                                    
                                 
                               are 
                                 
                                    g
                                    -
                                    y
                                 
                              , where 
                                 
                                    g
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          n
                                       
                                    
                                 
                               is the ground truth object.

Each image 
                           
                              y
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                         can be split into two orthogonal components, with the first in the row space and the second in the null space of 
                           
                              W
                           
                        . We write this as 
                           
                              y
                              =
                              
                                 
                                    y
                                 
                                 
                                    R
                                 
                              
                              +
                              
                                 
                                    y
                                 
                                 
                                    N
                                 
                              
                           
                        , with 
                           
                              
                                 
                                    y
                                 
                                 
                                    R
                                 
                              
                              ,
                              
                              
                                 
                                    y
                                 
                                 
                                    N
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    y
                                 
                                 
                                    R
                                 
                              
                              ⊥
                              
                                 
                                    y
                                 
                                 
                                    N
                                 
                              
                           
                        . Below, we reiterate a few basic properties of 
                           
                              W
                           
                         and 
                           
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                           
                        , for convenience.
                           
                              
                                 Property 1: 
                                    
                                       R
                                       (
                                       W
                                       )
                                       ⊥
                                       N
                                       (
                                       W
                                       )
                                    
                                 .


                                 Property 2: 
                                    
                                       
                                          
                                             WW
                                          
                                          
                                             +
                                          
                                       
                                       W
                                       =
                                       W
                                    
                                 .


                                 Property 3: 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             +
                                          
                                       
                                       Wy
                                       =
                                       
                                          
                                             y
                                          
                                          
                                             R
                                          
                                       
                                    
                                 .

Property 3 implies that the shortest least squares reconstruction 
                           
                              
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                           
                         exactly recovers the row space component of 
                           
                              g
                           
                        , since 
                           
                              
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                              =
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                              p
                              =
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                              Wg
                              =
                              
                                 
                                    g
                                 
                                 
                                    R
                                 
                              
                           
                        .
                           Proposition 1
                           
                              
                                 
                                    g
                                    -
                                    
                                       
                                          x
                                       
                                       
                                          +
                                       
                                    
                                    ∈
                                    N
                                    (
                                    W
                                    )
                                 
                              , i.e., the artifacts of the shortest least squares solution are in the null space of 
                              
                                 
                                    W
                                 
                              .

We have 
                           
                              
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                              =
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                              p
                              =
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                              Wg
                           
                        . It is instructive to split 
                           
                              
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                           
                         into the ground truth and a component that represents the artifacts, as 
                           
                              
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                              =
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                              Wg
                              =
                              g
                              +
                              (
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                              W
                              -
                              I
                              )
                              g
                           
                        . On forward projection, the second component disappears, since 
                           
                              
                                 
                                    WW
                                 
                                 
                                    +
                                 
                              
                              W
                              -
                              W
                              =
                              0
                           
                        . Hence, 
                           
                              
                                 
                                    Wx
                                 
                                 
                                    +
                                 
                              
                              =
                              Wg
                           
                        , and the artifacts are indeed in 
                           
                              N
                              (
                              W
                              )
                           
                        .

The implication of Proposition 1 is that the reconstruction artifacts of 
                           
                              
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                           
                         cannot be studied or further reduced by comparing them with the projection data 
                           
                              p
                           
                         after forward projection.

This changes when the reconstruction is segmented. Reconstruction artifacts are typically non-homogeneous structures such as streaks and blurring. Segmentation into regions that each have a given gray level 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    k
                                 
                              
                           
                        , however, results in an image that is composed of homogeneous regions, since the segmentation removes the small variations of the gray levels within each region. Hence, it removes a large part of the reconstruction artifacts, while, of course, also introducing new artifacts. These new artifacts are typically very different from reconstruction artifacts, and mainly consist of erroneous gray levels and wrongly classified pixels at the edges of different regions in the image. In contrast with reconstruction artifacts, which are in the null space of 
                           
                              W
                           
                        , segmentation artifacts are not expected to have zero ray sums. In a homogeneous region with a gray level offset, individual pixels all share the same error, resulting in a nonzero total contribution. This means that the artifacts of 
                           
                              s
                           
                         are expected to have a (large) component in 
                           
                              R
                              (
                              W
                              )
                           
                        , and can be studied and further reduced by comparing them with the projection data after forward projection. The reconstructed residual error is an application of this.

Denote the segmentation artifacts 
                           
                              a
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                         of 
                           
                              s
                           
                         as 
                           
                              a
                              ≡
                              g
                              -
                              s
                           
                        . We then have the following proposition.
                           Proposition 2
                           
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          +
                                       
                                    
                                    =
                                    
                                       
                                          a
                                       
                                       
                                          R
                                       
                                    
                                 
                              , i.e., the reconstructed residual error exactly recovers the row space component of 
                              
                                 
                                    a
                                 
                              .

From (2) (with noiseless 
                           
                              p
                           
                         substituted for 
                           
                              
                                 
                                    p
                                 
                                 
                                    ̃
                                 
                              
                           
                        ) and 
                           
                              
                                 
                                    p
                                 
                                 
                                    s
                                 
                              
                              =
                              Ws
                           
                        , we have 
                           
                              
                                 
                                    e
                                 
                                 
                                    +
                                 
                              
                              =
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                              (
                              p
                              -
                              
                                 
                                    p
                                 
                                 
                                    s
                                 
                              
                              )
                              =
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                              Wg
                              -
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                              Ws
                              =
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                              Wa
                              =
                              
                                 
                                    a
                                 
                                 
                                    R
                                 
                              
                           
                        .

This means that the reconstructed residual error is a reconstruction of the segmentation artifacts in the same way that the original image is a reconstruction of the scanned object, i.e., we have 
                           
                              
                                 
                                    e
                                 
                                 
                                    +
                                 
                              
                              =
                              
                                 
                                    a
                                 
                                 
                                    R
                                 
                              
                           
                         and 
                           
                              
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                              =
                              
                                 
                                    g
                                 
                                 
                                    R
                                 
                              
                           
                        . The main implication of Proposition 2 is that the reconstructed residual error can be used to study the segmentation artifacts directly, starting from the segmented reconstruction.

Finally, we briefly return to the alternative of using the difference between the reconstruction and the segmented reconstruction, 
                           
                              
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                              -
                              s
                           
                        , as an estimate of the segmentation artifacts 
                           
                              a
                           
                        , as mentioned in Section 2.1. We compare the artifacts of 
                           
                              
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                              -
                              s
                           
                         with those of 
                           
                              
                                 
                                    e
                                 
                                 
                                    +
                                 
                              
                           
                        . The artifacts of 
                           
                              
                                 
                                    e
                                 
                                 
                                    +
                                 
                              
                           
                         are 
                           
                              a
                              -
                              
                                 
                                    e
                                 
                                 
                                    +
                                 
                              
                           
                        . The artifacts of 
                           
                              
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                              -
                              s
                           
                        , seen as an estimate of 
                           
                              a
                           
                        , are exactly the artifacts of 
                           
                              
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                           
                        , since 
                           
                              a
                              -
                              (
                              
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                              -
                              s
                              )
                              =
                              g
                              -
                              s
                              -
                              
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                              +
                              s
                              =
                              g
                              -
                              
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                           
                        . And, since 
                           
                              ‖
                              a
                              ‖
                              ≪
                              ‖
                              g
                              ‖
                           
                        , we typically expect that 
                           
                              ‖
                              a
                              -
                              
                                 
                                    e
                                 
                                 
                                    +
                                 
                              
                              ‖
                              ≪
                              ‖
                              g
                              -
                              
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                              ‖
                           
                        , which would imply that the artifacts of 
                           
                              
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                              -
                              s
                           
                         make it a poor estimate of 
                           
                              a
                           
                        .

Leaving behind the “perfect” reconstruction algorithm that is the Moore–Penrose pseudoinverse, we now investigate how the results from Section 2.4 change when 
                           
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                           
                         is replaced by a practical reconstruction algorithm. In Section 3, we show experimentally that doing so still results in useful maps of the segmentation artifacts. There, we employ several different reconstruction algorithms, not restricted to linear ones for the reconstruction of the original image.

If a general, possibly non-linear, reconstruction algorithm is used for the initial reconstruction, then Proposition 1 is no longer applicable. However, the reconstructed residual error is computed from a segmented reconstruction 
                           
                              s
                           
                        , which is still expected to have a (large) component in 
                           
                              R
                              (
                              W
                              )
                           
                        . Hence, the effectiveness of the reconstructed residual error is not affected. Moreover, depending on the component of the artifacts that is in 
                           
                              R
                              (
                              W
                              )
                           
                        , it might be possible to study the artifacts of the original reconstructed image directly, without a separate segmentation step. An obvious example of this are discrete algorithms such as DART (Discrete Algebraic Reconstruction Technique), which directly produce a fully segmented result [11].

A general reconstruction algorithm can also replace 
                           
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                           
                         for the computation of the reconstructed residual error itself. The result is then no longer exactly the row space component of 
                           
                              a
                           
                        . We have the following proposition.
                           Proposition 3
                           
                              For a general reconstruction algorithm 
                              
                                 
                                    R
                                 
                              , 
                                 
                                    
                                       
                                          e
                                       
                                       
                                          ˆ
                                       
                                    
                                    =
                                    R
                                    Wa
                                 
                              , i.e., the reconstructed residual error is the reconstruction of the segmentation artifacts 
                              
                                 
                                    a
                                 
                              .

From (2) (with noiseless 
                           
                              p
                           
                         substituted for 
                           
                              
                                 
                                    p
                                 
                                 
                                    ̃
                                 
                              
                           
                        ) and 
                           
                              
                                 
                                    p
                                 
                                 
                                    s
                                 
                              
                              =
                              Ws
                           
                        , we have 
                           
                              
                                 
                                    e
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              R
                              (
                              p
                              -
                              
                                 
                                    p
                                 
                                 
                                    s
                                 
                              
                              )
                              =
                              R
                              (
                              Wg
                              -
                              Ws
                              )
                              =
                              R
                              Wa
                           
                        .


                        Proposition 3 states that 
                           
                              
                                 
                                    e
                                 
                                 
                                    ˆ
                                 
                              
                           
                         is a reconstruction of 
                           
                              a
                           
                         in the same sense that 
                           
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                           
                         is a reconstruction of the ground truth, since 
                           
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              R
                              Wg
                           
                        . Together with the shortest least squares solution often not being a desirable solution anyway, due to noise in the projection data, this implies that 
                           
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                           
                         can be replaced by a suitable more general reconstruction algorithm for computing the reconstructed residual error.

@&#EXPERIMENTS AND RESULTS@&#

In this section, we describe the experiments, for both simulated and experimental data, that were carried out to investigate the properties of the reconstructed residual error. To improve the clarity of the presented results, the simulation experiments are based on two-dimensional slices and parallel-beam geometry. However, as was already mentioned in Section 2.3, the method is readily applicable to three-dimensional objects and other geometries such as cone beam. The application in Section 3.3 uses cone-beam geometry. Since computing the reconstructed residual error is essentially a reconstruction problem, the quality of the result depends on the number of available projections. To demonstrate that the algorithm is also useful when only relatively few projections are available, most experiments were based on synthetic datasets with only 90 projections.

Three phantom images were created, the first one (Fig. 2
                     a) is of size 
                        
                           64
                           ×
                           64
                        
                      pixels, to allow exact least squares computations using 
                        
                           
                              
                                 W
                              
                              
                                 +
                              
                           
                        
                     . The experiment using Phantom 1 was performed on a grid of size 
                        
                           64
                           ×
                           64
                        
                      pixels. Phantoms 2 and 3 (Fig. 2b and c) are of size 
                        
                           2048
                           ×
                           2048
                        
                      pixels. These phantoms have a higher resolution than the reconstruction grid, which is of size 
                        
                           512
                           ×
                           512
                        
                      pixels, to reduce the effect of the pixelation on the reconstructions.

Below, we provide a brief overview of the reconstruction algorithms that were used in the experiments.
                        
                           (1)
                           FBP (Filtered Backprojection) is an analytical technique that is directly related to the inverse Radon transform [1]. A standard implementation of FBP was used, with a Ram–Lak filter and linear interpolation in the projection domain.

CGLS (Conjugate Gradient Least Squares) is an algebraic technique that computes the shortest least squares solution of (1) 
                              [12]. We used 300 iterations of CGLS to approximate the effect of 
                                 
                                    
                                       
                                          W
                                       
                                       
                                          +
                                       
                                    
                                 
                              , allowing for the use of a larger reconstruction area than is possible when using the pseudoinverse directly.

SIRT (Simultaneous Iterative Reconstruction Technique) is an algebraic technique that computes a weighted least squares solution of (1) 
                              [13]. SIRT was implemented as defined in [14], performing 300 iterations.

PDART [15] (Partially Discrete Algebraic Reconstruction Technique) is a partially discrete technique that assumes that only the densest material is homogeneous. The gray level of the densest material is exploited as prior knowledge. A total of 300 iterations was performed.

We used the well-known global thresholding method by Otsu [16] to compute all segmentations. Otsu’s method provides a threshold (or several thresholds for the multi-level version of the algorithm) that can then be used to assign each pixel of the image to a segmentation class 
                        
                           
                              
                                 Y
                              
                              
                                 k
                              
                           
                        
                     . If appropriate gray levels 
                        
                           
                              
                                 ρ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 ρ
                              
                              
                                 d
                              
                           
                        
                      are known, e.g., through prior knowledge about the scanned object, they can then be assigned to the pixels in the sets 
                        
                           
                              
                                 Y
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 Y
                              
                              
                                 d
                              
                           
                        
                     , resulting in the segmented image 
                        
                           s
                           ∈
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        
                     . We did not assume such prior knowledge in the experiments, and have used the mean of all pixel values of the original reconstruction that share a segmentation class as an initial estimate,
                        
                           (3)
                           
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    |
                                    
                                       
                                          Y
                                       
                                       
                                          k
                                       
                                    
                                    |
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       y
                                       ∈
                                       
                                          
                                             Y
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                              y
                              ,
                              
                              for
                              
                              each
                              
                              k
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              d
                              }
                              .
                           
                        
                     In the experiments of Sections 3.2 and 3.3, the reconstructed residual error itself is used to improve upon these initial estimates.

For all experiments, the reconstructed residual error was computed using 300 iterations of SIRT, to make the results comparable.

To determine numerically how close a given error image 
                        
                           e
                           ∈
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        
                      is to the true error, we used the relative Euclidean distance 
                     
                        
                           d
                           :
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                           →
                           R
                        
                     , defined as
                        
                           (4)
                           
                              d
                              (
                              e
                              )
                              =
                              
                                 
                                    ‖
                                    e
                                    -
                                    
                                       
                                          e
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    ‖
                                    
                                       
                                          e
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 e
                              
                              
                                 t
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        
                      is the true error.

We now provide an overview of the experiments that follow. First, the basic properties of the algorithm are studied (Section 3.1). Then, two applications are presented. It is demonstrated that the technique can be used to detect and correct errors in the estimate of the gray levels (Section 3.2). Finally, the technique is applied to experimental micro-CT data (Section 3.3), to interpret the differences between two segmentations.

The first experiment demonstrates the least squares approach from Section 2.4. Both the original and the segmented reconstruction were split into their row and null space components. To be able to compute 
                           
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                           
                         in practice, a small reconstruction area of size 
                           
                              64
                              ×
                              64
                           
                         pixels was used, and only 32 projections were taken. This results in a system matrix 
                           
                              W
                           
                         of size 
                           
                              2048
                              ×
                              4096
                           
                        , and 
                           
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                           
                         of size 
                           
                              4096
                              ×
                              2048
                           
                        . A synthetic dataset was created from Phantom 1 (Fig. 2a), also shown in Fig. 3
                        d, using 32 equiangular parallel beam projections. Different from the other simulation experiments, noise was not added to this dataset. The reconstruction (Fig. 3e) was then computed using the Moore–Penrose pseudoinverse 
                           
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                           
                        , making it the exact shortest least squares solution. The reconstruction was segmented using Otsu’s method (Fig. 3g). The gray levels of the segmented reconstruction were determined using (3) on the pixels of the original reconstruction, with the Otsu segmentation classes as 
                           
                              
                                 
                                    Y
                                 
                                 
                                    k
                                 
                              
                           
                         (
                           
                              k
                              =
                              1
                              ,
                              2
                           
                        ).

The artifacts of the reconstruction are shown separately (Fig. 3f), and split into row and null space components. As shown theoretically by Proposition 1, the artifacts are completely in the null space component (Fig. 3j). The row space component (Fig. 3a) is zero everywhere. The artifacts of the segmented reconstruction are also shown separately (Fig. 3h). The main assumption that was made in Section 2.4, was that the segmentation artifacts have a (large) component in the row space of 
                           
                              W
                           
                        . This assumption is confirmed by again splitting these artifacts into row and null space components. The null space component (Fig. 3k) is not zero, but most of the artifacts are clearly in the row space component (Fig. 3b). Using the least squares approach of Section 2.4, this row space component is exactly 
                           
                              
                                 
                                    e
                                 
                                 
                                    +
                                 
                              
                           
                        . However, when the reconstructed residual error is computed using SIRT (Fig. 3c), the result is very close to 
                           
                              
                                 
                                    e
                                 
                                 
                                    +
                                 
                              
                           
                        , indicating that SIRT is an acceptable practical alternative for 
                           
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                           
                         in this case. The true error (Fig. 3m), which is the difference between the original object (Fig. 3d) and the segmented reconstruction (Fig. 3g), is close to both 
                           
                              
                                 
                                    e
                                 
                                 
                                    +
                                 
                              
                           
                         and the reconstructed residual error as computed with SIRT. The difference between the original and the segmented reconstruction (Fig. 3i) can clearly not be used as an alternative. This is confirmed numerically through the first row of Table 1
                        , where (A) is the distance, as defined by (4), between Fig. 3b and m, (B) is the distance between Fig. 3c and m, and (C) is the distance between Fig. 3i and m.

The second experiment makes the transition from the least squares approach to a more practical approach on a larger reconstruction grid. For this experiment, a synthetic dataset was created from Phantom 2 (Fig. 2b), using 90 parallel beam projections, evenly spaced at 
                           
                              2
                              °
                           
                         intervals. A detector with 512 pixels was used, to simulate the practical situation where the detector pixel size equals the width of the reconstruction grid. Poisson noise, corresponding to 
                           
                              
                                 
                                    10
                                 
                                 
                                    5
                                 
                              
                           
                         initial photons per detector pixel, was applied to the synthetic dataset. The dataset was then reconstructed using 300 iterations of SIRT (Fig. 4
                        a), and segmented using Otsu’s method (Fig. 4d). The gray levels of Fig. 4d were determined using (3) on the pixels of Fig. 4a, with the Otsu segmentation classes as 
                           
                              
                                 
                                    Y
                                 
                                 
                                    k
                                 
                              
                           
                         (
                           
                              k
                              =
                              1
                              ,
                              2
                           
                        ).

Using 300 iterations of CGLS as an approximation of 
                           
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                           
                        , the artifacts of both the original and the segmented reconstruction were then split into their row and null space components. The artifacts of the reconstruction are again mainly in the null space component (Fig. 4c), even though SIRT has replaced 
                           
                              
                                 
                                    W
                                 
                                 
                                    +
                                 
                              
                           
                         as the reconstruction algorithm. The row space component (Fig. 4b) is small. For the artifacts of the segmented reconstruction, this is clearly different. The gray level error of the “bone” material, which is quite subtle because the gray levels were computed from the original reconstruction, clearly shows as an artifact in the row space component (Fig. 4e). The null space component (Fig. 4f) is small.

If the reconstructed residual error is computed using SIRT (Fig. 5
                        a), then the result is close to the row space component of the segmentation artifacts (Fig. 4e). The reconstructed residual error is also close to the true error (Fig. 5b). As before, Table 1 (second row) numerically confirms that both the row space component (A) and the reconstructed residual error (B) are closer to the true error than the difference between the original and the segmented reconstruction (C).

The third experiment demonstrates that relatively subtle differences between segmented reconstructions can be visualized using the reconstructed residual error. This experiment is based on Phantom 3. A synthetic dataset was created, again using 90 parallel beam projections. Poisson noise, again corresponding to 
                           
                              
                                 
                                    10
                                 
                                 
                                    5
                                 
                              
                           
                         initial photons per detector pixel, was applied. The dataset was then reconstructed twice, once using FBP (Fig. 6
                        a), and once using 300 iterations of SIRT (Fig. 6d). The gray levels were again computed from the original reconstruction, using the Otsu segmentation classes.

As before, the reconstructed residual error (Fig. 6b and e) is close to the true error (Fig. 6c and f, respectively). This is again confirmed numerically through Table 1 (third and fourth row). The gray level errors are apparently quite small, in particular for the segmented SIRT reconstruction (Fig. 6e). However, as we show numerically in Section 3.2, Fig. 6e can still be used to correct the gray levels from Fig. 6d.

In this section, we demonstrate that the gray level estimates of a segmented reconstruction can be improved using the reconstructed residual error. Visually, Figs. 3c, 5a, and 6b already suggest that the gray levels of the different objects are not correct, since there is a clear and relatively uniform error inside the objects. In Fig. 6e, this effect is less obvious, but Table 2
                         shows that this result can still be used to correct the gray levels.


                        Table 2 provides a numerical overview of the corrections that were achieved for the experiments of Section 3.1. The true gray levels 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    k
                                 
                              
                           
                         were taken from the phantoms (Fig. 2), with 
                           
                              k
                              =
                              1
                              ,
                              2
                           
                         for Phantoms 1 and 2, and 
                           
                              k
                              =
                              1
                              ,
                              2
                              ,
                              3
                           
                         for Phantom 3. The estimated gray levels 
                           
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                           
                         are the gray levels of the segmented reconstructions, computed using (3) from the original reconstructions. The estimated gray level errors 
                           
                              
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                           
                         were computed from the reconstructed residual error using (3), the same procedure as for the 
                           
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                           
                        . The sum of 
                           
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                           
                         is shown as the corrected gray level 
                           
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                           
                        .

From comparison of the corrected gray levels 
                           
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                           
                         with the true gray levels 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    k
                                 
                              
                           
                         from the phantom, it is clear that 
                           
                              
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                           
                         is a good estimate of the difference between 
                           
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    k
                                 
                              
                           
                        , and that it can be used to correct 
                           
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                           
                        . The corrections that are applied to the gray levels are relatively small. However, they still have a visible effect on the segmented reconstructions. This is clear from the reconstructed residual error (Fig. 7
                        ) for reconstructions in which the corrected gray levels were used, when Figs. 7a–c are compared with Figs. 5a, 6b, and 6e, respectively.

In this experiment, the reconstructed residual error was computed for experimental cone beam data. A dataset of an ex vivo mouse femur was acquired with a SkyScan 1172 micro-CT scanner using 376 projections at 
                           
                              0.5
                              °
                           
                         intervals, at a detector resolution of 
                           
                              5
                              
                              μ
                              m
                           
                        . The SkyScan NRecon software package was used to correct for ring and beam-hardening artifacts.

The dataset was reconstructed using two different algorithms. First, it was reconstructed using 300 iterations of SIRT (Fig. 8
                        a) and segmented using Otsu’s method (Fig. 8b). The gray levels of the segmented reconstruction were estimated using (3) and the SIRT reconstruction. Second, it was reconstructed using 300 iterations of PDART (Fig. 9
                        c), using the gray level from the bone material of the segmented SIRT reconstruction as prior knowledge.

For the segmented SIRT reconstruction, the reconstructed residual error (Fig. 9a) shows that the gray level for the bone is underestimated. Corrections for the gray levels were computed by applying (3) to the reconstructed residual error of Fig. 9a. With corrected gray levels for the segmented reconstruction, the reconstructed residual error (Fig. 9b) does not show a systematic error anymore, in the sense that the bone now contains both positive and negative errors. For the initial PDART reconstruction (Fig. 8c), the reconstructed residual error (Fig. 9c) also shows that the gray level for the bone is underestimated. Additionally, Fig. 9c suggests that the bone structures are too wide, since they have a region of negative errors at their edges. From Fig. 9c, the gray levels can again be corrected using (3). For this particular algorithm, it makes sense to redo the reconstruction with the corrected gray levels, since those gray levels are an input of the algorithm. Fig. 8d shows the resulting PDART reconstruction after six such correction steps.

@&#DISCUSSION@&#

In tomography, most techniques that are used for segmentation and segmentation evaluation do no exploit the projection data. There are a few algorithms that do exploit this information during segmentation [17,18], however, they compute a quality measure that is a single number (the projection distance in [17] and the segmentation inconsistency in [18]). In contrast, the reconstructed residual error is a spatial map of the segmentation quality. This allows studying local variations of the error, which is not possible using a single number. Moreover, it allows evaluating any given segmentation, including those that have been computed through a technique that is not tomography-aware.

The reconstructed residual error can exploit the projection data because the artifacts of the reconstruction, which are typically largely in the null space of the system matrix (Figs. 3j and 4c), are largely in the row space after the segmentation step (Figs. 3b and 4e). Computing the exact row space component of the segmentation artifacts is infeasible in practice, due to computational constraints and noise. However, a regular reconstruction algorithm such as SIRT can be substituted without much degradation of the results (compare Figs. 3c and 5a with Figs. 3b and 4e, respectively). This allows using the reconstructed residual error for practical datasets.

Using the reconstructed residual error, it seems possible to detect even small errors in the gray levels (Fig. 6b and e), as is evident from Table 2. Larger errors in the gray levels are visible too (Fig. 9a and b), but more important in this case is that structural problems in the original reconstruction are also revealed (Fig. 9c).

The results for experimental micro-CT data also illustrate another type of analysis that is enabled by the proposed method. After correction of the initial gray levels of the segmented SIRT reconstruction (Fig. 8b), the reconstructed residual error (Fig. 9b) suggests an uneven density of the bone. The conclusion might be that this effect is real, or that it is due to the scanning process. However, when the PDART algorithm is used (Fig. 8d), the uneven density almost completely disappears (Fig. 9d). Hence, this segmentation is compatible with the bone material having a homogeneous density. Given the relatively small differences between the segmented images (Fig. 8b and d), it is not obvious how to choose between them without access to the reconstructed residual error.

@&#CONCLUSIONS@&#

We have introduced the reconstructed residual error, as a way to evaluate the segmentation quality of a reconstructed image in cases where the segmentation is based on the density of the scanned object. We have used the Moore–Penrose pseudoinverse as a mathematical model for investigating the properties of the technique, and then generalized this approach to practical reconstruction algorithms.

The reconstructed residual error provides an accurate map of the errors in a segmented tomogram. Visually, this map can be used to study the distribution of the errors. Numerically, it can be used to improve the gray level estimates. The method has also been applied successfully to experimental datasets.

The necessary tools to implement the technique in practice are a forward projector and a reconstruction algorithm. The computational cost of the algorithm is modest, since only a single forward projection and a single reconstruction are needed. These aspects make the adoption of the method quite feasible in practice.

@&#ACKNOWLEDGMENTS@&#

The mouse femur dataset is courtesy of Phil Salmon, Bruker microCT. This work was financially supported by the IWT TomFood project (IWT is the agency for Innovation by Science and Technology–Flanders, Belgium) and by the NWO (the Netherlands Organisation for Scientific Research – The Netherlands, Research Programme 639.072.005). This work was conducted in the framework of the Extrema COST Action MP1207.

@&#REFERENCES@&#

