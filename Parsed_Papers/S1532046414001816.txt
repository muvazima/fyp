@&#MAIN-TITLE@&#Combining data and meta-analysis to build Bayesian networks for clinical decision support

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We focus on complex clinical problems where data is available in small amounts.


                        
                        
                           
                           Our methodology compensates for the lack of data by using published evidence.


                        
                        
                           
                           It combines multivariate data with univariate meta-analysis to build BN models.


                        
                        
                           
                           The method is illustrated by a medical case study on trauma care.


                        
                        
                           
                           Our method outperformed data-driven techniques and MESS model in the case study.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Clinical decision support

Bayesian networks

Evidence-based medicine

Evidence synthesis

Meta-analysis

@&#ABSTRACT@&#


               
               
                  Complex clinical decisions require the decision maker to evaluate multiple factors that may interact with each other. Many clinical studies, however, report ‘univariate’ relations between a single factor and outcome. Such univariate statistics are often insufficient to provide useful support for complex clinical decisions even when they are pooled using meta-analysis. More useful decision support could be provided by evidence-based models that take the interaction between factors into account. In this paper, we propose a method of integrating the univariate results of a meta-analysis with a clinical dataset and expert knowledge to construct multivariate Bayesian network (BN) models. The technique reduces the size of the dataset needed to learn the parameters of a model of a given complexity. Supplementing the data with the meta-analysis results avoids the need to either simplify the model – ignoring some complexities of the problem – or to gather more data. The method is illustrated by a clinical case study into the prediction of the viability of severely injured lower extremities. The case study illustrates the advantages of integrating combined evidence into BN development: the BN developed using our method outperformed four different data-driven structure learning methods, and a well-known scoring model (MESS) in this domain.
               
            

@&#INTRODUCTION@&#

It is a challenge to build effective decision-support models for complex clinical problems; such problems involve multiple interacting factors [1,2] and to account for both the factors and their interaction a ‘multivariate’ model is needed [3]; these can have many forms: our focus is on Bayesian networks. In general, a multivariate model can be built in a number of ways: (1) purely from data using statistical and machine learning techniques [4], (2) from a combination of clinical knowledge and data [5–7] or (3) from published literature using multivariate meta-analysis techniques [8]. Each of these techniques has been shown to be successful in certain conditions but in this paper, we focus on clinical problems where none of these techniques is sufficient, on its own, to build a useful decision support model. That is, our focus is on problems that are complex, important but also rare: their rarity makes it hard to collect very large datasets (so called ‘big data’); their complexity demands a sophisticated multivariate model but their importance ensures that a large number of relevant research studies is available.

In these domains, the first method of building models – purely from data – results in simple models that cannot deal with the complexity of the problem [1] because there is not enough data to support a complex model. The third approach fails because clinical studies rarely publish information detailed enough for multivariate meta-analysis [9]. Instead, many medical studies report ‘univariate’ relations between a single factor and an outcome. Randomised controlled trials, for example, analyse the effect of a single treatment by using randomisation to decrease the confounding effect of other variables [10]. Similarly, many observational studies report the relation between individual risk factors and outcomes even when their dataset contains information about multiple factors. The second approach – combining knowledge and data – could work but it ignores the large body of published evidence; our challenge is therefore to exploit the results of a meta-analysis of studies reporting univariate relations to supplement a dataset that is otherwise inadequate to support a complex multivariate model.

Decision support directly from univariate relations is limited, as the effects of interactions between variables are not taken into account. For example, evidence about individual effects of a treatment and a comorbidity factor can be analysed in separate meta-analyses. However, if the treatment and comorbidity factor interact with each other, their joint effect may be completely different from their individual effects. As a result, decision support provided by the meta-analysis of individual effects may be invalid for a patient who is exposed to both the treatment and the comorbidity factor (see [2,10,11] for a more detailed discussion of generalising clinical evidence).

To improve this situation, we propose a method of combining the results of meta-analyses, clinical knowledge and data to provide decision support for complex decision problems where the data is scarce. Our method combines ‘univariate’ meta-analysis following a systematic review, with a small ‘multivariate’ dataset and expert knowledge. Bayesian networks (BN) offer a powerful framework to combine evidence from different sources [1,5,12,13]. Our methodology integrates the evidence from a meta-analysis into BN development by using it first to identify the BN structure and then to help determine the BN parameters; this second step uses auxiliary parameter learning models similar in some ways to techniques that can be used for meta-analysis. We illustrate the application and results of this method with a clinical case study into the prediction of the outcomes of severely injured lower extremities.

In the remainder of this paper, Section 2 recaps of a Bayesian meta-analysis technique to combine probabilities. Section 3 describes our methodology for developing a BN based on the results of a meta-analysis. Sections 4–6 present the case-study, results and conclusions respectively.

The method we propose in Section 3 assumes a possibly small multivariate patient dataset is available together with univariate results of a meta-analysis of probabilities. In this section, we give a recap of the meta-analysis of probabilities by briefly presenting an existing Bayesian technique [14,15]. The results obtained from this meta-analysis technique can be used in the method of Section 3, though other techniques could also be used. The recap also serves to introduce hierarchical Bayesian models, which are also used in Section 3.

Meta-analysis is an important form of clinical evidence as it combines and summarises the relevant published evidence that is identified by a systematic literature review. Meta-analysis can be used to combine different types of statistics including odds ratios, risk ratios and probabilities [14]. We focus on the meta-analysis of probabilities as the parameters of a BN are composed of probabilities. Fig. 1
                      shows a random-effects Bayesian meta-analysis model that takes the variation between studies into account, and does not assume normality for the distribution of the individual studies.

The binomial distribution is the probability distribution of the number of positive outcomes in n independent experiments where the probability of a positive outcome is p for every experiment. In the meta-analysis model, the result of each individual study i is modelled with the binomial distribution shown below, where ri
                      is the number of positive outcomes observed in the study i, pi
                      is the true study probability of the study i, and ni
                      is the sample size of the study i.
                        
                           
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              ∼
                              Binomial
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        
                     
                  

The normal distribution is a convenient way of modelling the pooled estimate and the variation between studies. We use an inverse logit transformation to model the true study probability pi
                      with the normal distribution. The mean μ of this distribution represents the transformed pooled estimate, and the variance τ
                     2 represents the variation between studies.
                        
                           
                              logit
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              
                                 
                                    θ
                                 
                                 
                                    i
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    θ
                                 
                                 
                                    i
                                 
                              
                              ∼
                              Normal
                              (
                              μ
                              ,
                              
                                 
                                    τ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        
                     
                  

The predictive probability distribution can also be calculated by using an inverse logit transformation of this normal distribution. The predictive distribution is a recommended way of presenting the results of a meta-analysis as it represents the uncertainty from both the pooled estimate and the variation between studies (see [14] and chapter 8 of [16] for more detailed information on predictive distributions in meta-analysis).
                        
                           
                              
                                 
                                    θ
                                 
                                 
                                    new
                                 
                              
                              ∼
                              Normal
                              (
                              μ
                              ,
                              
                                 
                                    τ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        
                     
                     
                        
                           
                              logit
                              (
                              
                                 
                                    p
                                 
                                 
                                    new
                                 
                              
                              )
                              =
                              
                                 
                                    θ
                                 
                                 
                                    new
                                 
                              
                           
                        
                     
                  

Finally, priors must be selected for the pooled estimate and between-study standard deviation. The non-informative priors shown below can be used if informative priors are not available.
                        
                           
                              μ
                              ∼
                              Normal
                              (
                              0
                              ,
                              1000
                              )
                           
                        
                     
                     
                        
                           
                              τ
                              ∼
                              Uniform
                              (
                              0
                              ,
                              2
                              )
                           
                        
                     In order to calculate the posteriors of μ, τ
                     2 and pnew
                     , we enter the observed number of positive outcomes ri
                      and sample sizes ni
                      from each reviewed study. The posteriors can be calculated by using the dynamic discretisation algorithm [17] in AgenaRisk [18] or the Markov Chain Monte Carlo (MCMC) sampling technique in OpenBUGS [19].

The previous section described a Bayesian meta-analysis technique for pooling probabilities. In this section, we present a methodology that uses data, expert knowledge and the pooled probabilities from a meta-analysis to define the structure (Section 3.1) and parameters (Section 3.2) of a BN decision support model. Our methodology assumes that expert knowledge, a meta-analysis of univariate relations from a relevant systematic review and some data about multivariate relations are available. However, the amount of data may be insufficient to learn the parameters of some relations in the BN.

A BN structure can be developed in two stages: selecting variables, and identifying the relations between those variables. Domain experts use the results of a meta-analysis to select the important variables for the BN. The experts review every variable that is considered to be clinically important in the meta-analysis. During the review, they define mechanistic relations between each of these variables and the outcome. These definitions enable us to (1) build a causal BN structure that is consistent with clinical knowledge and (2) identify the variables that are clinically important considering the aims and scope of the model. Variables that are outside the scope of the model are excluded even when they have a clinically significant effect in the meta-analysis.

The mechanistic relations between the observed factors and outcome may depend on clinical factors that are not available in the data or not examined in the meta-analysis. For example, the data may not distinguish between the measurements and true state of a variable, or may exclude a part of the important causal factors in the domain (see [6] and chapters 1 and 2 of [20] for a more detailed discussion of this issue). In this case, latent variables are used to model clinical knowledge in the BN.

Meta-analysis of a univariate relation provides a probability conditioned on a single variable, such as P(Y|X
                        1). Such probability distribution cannot be directly used for a BN variable that is conditioned on multiple parents such as P(Y|X
                        1,...,
                        Xn
                        ). In this section, we present a parameter learning method for combining the results of a univariate meta-analysis and data to learn the parameters of a BN variable that has multiple parents. Our method uses auxiliary Bayesian models to learn the parameters of the BN used for decision support. These auxiliary models are hierarchical models with a structure that is conceptually similar to the Bayesian meta-analysis model described in Section 2. We introduce the proposed method by a simple example in Section 3.2.1, and examine the application of this method to more complex BN models in Section 3.2.2. The conditional probabilities provided by a meta-analysis may be relevant to variables that are not directly linked in the BN structure. We examine this issue in Section 3.2.3.

In this section, we introduce our parameter learning method with the simple BN shown in Fig. 2
                           .

This BN has 3 variables and each of its variables has 2 states:
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    Y
                                    =
                                    {
                                    
                                       
                                          y
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    }
                                 
                              
                           
                        

The conditional probability distribution (CPD) of a discrete variable is encoded in a node probability table (NPT) in a BN. Table 1
                            shows the NPT of the variable Y. We require 4 parameters for this NPT: 
                              
                                 P
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ,
                                 P
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ,
                                 P
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            and 
                              
                                 P
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           .

The parameters of the variable Y can be learnt from data using the maximum likelihood estimate (MLE) approach. For example, 
                              
                                 P
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                           ) can be estimated by dividing 
                              
                                 M
                                 [
                                 y
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                                 ]
                              
                            to 
                              
                                 M
                                 [
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                                 ]
                              
                           , where 
                              
                                 M
                                 [
                                 y
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                                 ]
                              
                            represents the count of data instances where Y
                           =
                           y
                           1, 
                              
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                              
                           , and 
                              
                                 M
                                 [
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                                 ]
                              
                            represents the count of data instances where 
                              
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                              
                           .
                              
                                 
                                    P
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             |
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          M
                                          [
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                             
                                                1
                                             
                                          
                                          ]
                                       
                                       
                                          M
                                          [
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                             
                                                1
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                        

Suppose we have a dataset, with a sample size of M
                           =250, to learn the parameters of the BN in Fig. 2. Fig. 3
                            shows a part of the relevant counts from this imaginary dataset. There are only 3 data instances where Y
                           =
                           y
                           1, 
                              
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                              
                            as shown by 
                              
                                 M
                                 [
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                                 ]
                                 =
                                 3
                              
                            in this figure.

Our aim is to estimate the parameters of the BN. Although the overall sample size of the data is not small, there is not an adequate amount of data for learning some of the parameters. For example, there are only a few data instances to learn the probability of 
                              
                                 P
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            since 
                              
                                 M
                                 [
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                                 ]
                                 =
                                 3
                              
                            and 
                              
                                 M
                                 [
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                                 ]
                                 =
                                 10
                              
                           .

As well as the data, suppose we have the results of a meta-analysis that analyses the relation between Y and X
                           1. This meta-analysis pools the conditional probabilities of 
                              
                                 P
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            reported in different studies. The result of the meta-analysis is reported by the mean, 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       pnew
                                    
                                 
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                           , and variance, 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       pnew
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                           , of the predictive distribution of the pooled conditional probability (see Table 2
                           ). A way of calculating these statistics is described in Section 2.

The results of the meta-analysis cannot be directly used for the BN parameters since the variable Y is conditioned on both X
                           1 and X
                           2 in the BN model whereas it is conditioned only on X
                           1 in the meta-analysis. In other words, there is no parameter to use 
                              
                                 P
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            directly in the NPT of the variable Y (see Table 1).

In the remainder of this section, we present a novel technique that combines the data shown in Fig. 3 and the meta-analysis results shown in Table 2 to learn the parameters 
                              
                                 P
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            and 
                              
                                 P
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            for the NPT of the variable Y. The generalisation of this method for a larger number of parents and states is described in Section 3.2.2.


                           Fig. 4
                            shows a BN representation of the implemented technique. The BN representation is divided into five components that are described in the remainder of this section:
                              
                                 1.
                                 
                                    Data: This part uses the binomial distribution to model the relation between the conditional probability distributions (CPD) that we aim to estimate and the observed counts in the data. For example, the number of data instances where 
                                       
                                          
                                             
                                                X
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                       
                                    , 
                                       
                                          
                                             
                                                X
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                             
                                                1
                                             
                                          
                                       
                                     and Y
                                    =
                                    y
                                    1, shown by 
                                       
                                          M
                                          [
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                             
                                                1
                                             
                                          
                                          ]
                                       
                                    , has a binomial distribution where the probability parameter is 
                                       
                                          P
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                     and the number of trials parameter is 
                                       
                                          M
                                          [
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                             
                                                1
                                             
                                          
                                          ]
                                       
                                    . The binomial distributions used in this part are shown below: 
                                       
                                          
                                             M
                                             
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             ∼
                                             Binomial
                                             
                                                
                                                   
                                                      M
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     2
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      P
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               |
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     2
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                     
                                    
                                       
                                          
                                             M
                                             
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             ∼
                                             Binomial
                                             
                                                
                                                   
                                                      M
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     2
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      P
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               |
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     2
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                     
                                    
                                       
                                          
                                             M
                                             [
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                                
                                                   1
                                                
                                             
                                             ]
                                             ∼
                                             Binomial
                                             
                                                
                                                   
                                                      M
                                                      ,
                                                      P
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                     
                                    
                                       
                                          
                                             M
                                             [
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             ]
                                             ∼
                                             Binomial
                                             
                                                
                                                   
                                                      M
                                                      ,
                                                      P
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 


                                    Probability distributions for NPT: This part contains the CPDs that we aim to estimate for the NPT of Y. We assign uniform priors for these distributions, informative expert priors can also be used when available: 
                                       
                                          
                                             P
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             |
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             ∼
                                             Uniform
                                             (
                                             0
                                             ,
                                             1
                                             )
                                          
                                       
                                     
                                    
                                       
                                          
                                             P
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             |
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             ∼
                                             Uniform
                                             (
                                             0
                                             ,
                                             
                                             1
                                             )
                                          
                                       
                                    
                                 


                                    Marginalisation of NPT distributions: Since the variable Y is conditioned only on 1 variable in the meta-analysis and 2 variables in the BN, we model the probability distribution from the meta-analysis, 
                                       
                                          P
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                    , as the marginalisation of the probability distribution from the BN parameters 
                                       
                                          P
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                     and 
                                       
                                          P
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    : 
                                       
                                          
                                             P
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             |
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             (
                                             P
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             |
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   X
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             *
                                             P
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             )
                                             =
                                             P
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             |
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             P
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             +
                                             P
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             |
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             P
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                    
                                 


                                    Probabilities required for marginalisation: In order to calculate the marginalisation in part 3, we need the probability distributions of 
                                       
                                          P
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                     and 
                                       
                                          P
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    . We assign uniform priors for these variables. We also assign a constraint to ensure that the sum of 
                                       
                                          P
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                     and 
                                       
                                          P
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                     is equal to 1. 
                                       
                                          
                                             P
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             ∼
                                             Uniform
                                             (
                                             0
                                             ,
                                             1
                                             )
                                          
                                       
                                     
                                    
                                       
                                          
                                             P
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             ∼
                                             Uniform
                                             (
                                             0
                                             ,
                                             1
                                             )
                                          
                                       
                                     
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             P
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             =
                                             P
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             +
                                             P
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             =
                                             1
                                          
                                       
                                    
                                 


                                    Values from meta-analysis: The pooled estimate 
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                pnew
                                             
                                          
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                     from the meta-analysis is modelled with the normal distribution truncated to a unit interval as it represents a probability value, denoted by TNormal
                                    [0,
                                    
                                    1] (μ,
                                    σ
                                    2). We use 
                                       
                                          P
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                     from the marginalisation in part 3 and 
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                pnew
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                     from the predictive distribution as the mean and variance of this normal distribution respectively. The values from the meta-analysis are modelled as: 
                                       
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   pnew
                                                
                                             
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             |
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             ∼
                                             
                                                
                                                   TNormal
                                                
                                                
                                                   [
                                                   0
                                                   ,
                                                   1
                                                   ]
                                                
                                             
                                             (
                                             P
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             |
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             ,
                                             
                                                
                                                   σ
                                                
                                                
                                                   pnew
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             |
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             )
                                          
                                       
                                    
                                 

In the following section, we describe the generalisation of this technique for estimating the parameters of variables with more parents or states.

Let Y be a BN variable that has n parents, and 
                              X
                           
                           ={X
                           1,
                           X
                           2,…,
                           Xn
                           } be the set of parents of Y (see Fig. 5
                           ). Both Y and its parents have multiple states:
                              
                                 
                                    Y
                                    =
                                    {
                                    
                                       
                                          y
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          k
                                       
                                    
                                    }
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    {
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                    }
                                 
                              
                           
                        

Our dataset contains a total of M data instances about 
                              X
                            and Y (see Table 3
                           ). We also have pooled conditional probability and variance estimates of the predictive distribution of P(Y|Xi
                           ) from a meta-analysis (see Table 4
                           ). A way of calculating these predictive distributions is described in Section 2.


                           Fig. 6
                            shows an abstract graphical illustration of the generalised auxiliary parameter learning model. This model is a generalisation of the model shown in Fig. 4. This illustration is not a BN; it is a schema for building an auxiliary parameter learning model for any number of states and parent variables. The size of the auxiliary parameter learning model grows rapidly with increasing number of parents and states.

In Fig. 6, the variables shown by ellipses are unknown variables that will be estimated by the model. The variables shown by rounded rectangles are observed with the values from the meta-analysis, and the variables shown by rectangles are observed from the dataset. The constraints that sum probabilities to 1 are not included in this figure to simplify the illustration. By running this auxiliary model, we estimate probability distributions for the parameters P(Y|
                              X
                           ) required by the NPT of Y. Since the BN requires only a point estimate of the parameter, not the entire distribution; we use the mean of this distribution as the BN parameter.

According to our model, the data related to Y, i.e. M[Y,
                           
                              X
                           ], is generated by the binomial distribution with the probability of success P(Y|
                              X
                           ) and the number of trials M[
                              X
                           ].
                              
                                 
                                    M
                                    [
                                    Y
                                    ,
                                    X
                                    ]
                                    ∼
                                    Binomial
                                    (
                                    M
                                    [
                                    X
                                    ]
                                    ,
                                    P
                                    (
                                    Y
                                    |
                                    X
                                    )
                                    )
                                 
                              
                           
                           M[Y,
                           
                              X
                           ] represents the count of data instances for specific values of X
                           1,…,
                           Xn
                            and Y. For example, 
                              
                                 M
                                 [
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                    
                                       4
                                    
                                 
                                 ]
                              
                            represents the number of data instances where 
                              
                                 Y
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                    
                                       4
                                    
                                 
                              
                           . Similarly M[
                              X
                           ] represent the number of data instances where X
                           1,…,
                           Xn
                            have certain values.

Our aim is to estimate the CPD of P(Y|
                              X
                           ). We assign a uniform prior for this distribution; informative expert priors can also be used when available.
                              
                                 
                                    P
                                    (
                                    Y
                                    |
                                    X
                                    )
                                    ∼
                                    Uniform
                                    (
                                    0
                                    ,
                                    
                                    1
                                    )
                                 
                              
                           
                        

The meta-analysis results are conditioned on a fewer variables than the CPD in the BN. Therefore, the expected values of the meta-analysis results are modelled as a marginalisation of the CPD. The meta-analysis provided the pooled conditional probability estimates about P(Y|Xi
                           ) that are modelled as the marginalisation of P(Y|
                              X
                           )
                              
                                 
                                    P
                                    (
                                    Y
                                    |
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             X
                                             ⧹
                                             {
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             }
                                          
                                       
                                    
                                    P
                                    (
                                    Y
                                    |
                                    X
                                    )
                                    P
                                    (
                                    X
                                    ⧹
                                    {
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                    }
                                    )
                                 
                              
                           
                           
                              
                                 P
                                 (
                                 X
                                 ⧹
                                 {
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 }
                                 )
                              
                            is also estimated by the binomial distribution below where M denotes the total number of data instances, and 
                              
                                 M
                                 [
                                 X
                                 ⧹
                                 {
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 }
                                 ]
                              
                            denotes the counts of data instances with 
                              
                                 X
                                 ⧹
                                 {
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                           . 
                              
                                 P
                                 (
                                 X
                                 ⧹
                                 {
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 }
                                 )
                              
                            has a uniform prior.
                              
                                 
                                    M
                                    [
                                    X
                                    ⧹
                                    {
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                    }
                                    ]
                                    ∼
                                    Binomial
                                    (
                                    M
                                    ,
                                    P
                                    (
                                    X
                                    ⧹
                                    {
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                    }
                                    )
                                    )
                                 
                              
                           
                           
                              
                                 
                                    P
                                    (
                                    X
                                    ⧹
                                    {
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                    }
                                    )
                                    ∼
                                    Uniform
                                    (
                                    0
                                    ,
                                    1
                                    )
                                 
                              
                           
                        

The pooled estimates from the meta-analysis 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       Pnew
                                       (
                                       Y
                                       |
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                            are modelled with a normal distribution truncated to a unit interval [0–1] as it represents a probability. The mean of this distribution is the marginalisation of the CPD, i.e. P(Y|Xi
                           ), and the variance 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       P
                                       (
                                       Y
                                       |
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                            represents the degree of uncertainty we assign to the meta-analysis results. We enter the mean and variance of the predictive distribution in meta-analysis as observations for 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       Pnew
                                       (
                                       Y
                                       |
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       Pnew
                                       (
                                       Y
                                       |
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           . We use the truncated normal distribution as it is convenient to define the expected value and variance parameters for it but 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       Pnew
                                       (
                                       Y
                                       |
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                            may not be normally distributed as it represents a probability value between 0 and 1.
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          Pnew
                                          (
                                          Y
                                          |
                                          
                                             
                                                X
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    ∼
                                    
                                       
                                          TNormal
                                       
                                       
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                    
                                    (
                                    P
                                    (
                                    Y
                                    |
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          Pnew
                                          (
                                          Y
                                          |
                                          
                                             
                                                X
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                           
                        

Finally, we introduce constraints to ensure that the sum of every probability distribution is equal to 1.
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             Y
                                          
                                       
                                    
                                    P
                                    (
                                    Y
                                    |
                                    X
                                    )
                                    =
                                    1
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             X
                                             ⧹
                                             {
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             }
                                          
                                       
                                    
                                    P
                                    (
                                    X
                                    ⧹
                                    {
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                    }
                                    )
                                    =
                                    1
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             Y
                                          
                                       
                                    
                                    P
                                    (
                                    Y
                                    |
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    1
                                 
                              
                           
                        

The method described in Sections 3.2.1 and 3.2.2 assumes that the variables analysed in the meta-analysis are neighbours in the BN. In this section we look at how this assumption can be relaxed to handle the more general case where the BN contains other – intermediate – variables between the variables analysed in the meta-analysis. This situation is illustrated in Fig. 7
                           ; the meta-analysis combines the published probabilities for P(Y|X) but the BN contains another variable I between X and Y so that the values in P(Y|X) are no longer parameters of the BN. We examine how we can use information from a meta-analysis about non-neighbouring variables to estimate the parameters of a variable in the BN. In particular, we use P(Y|X), calculated from a meta-analysis, to estimate P(I|X), giving the parameters of the X
                           →
                           I relation, when we know or have data for P(Y|I) describing the other intermediate relation I
                           →
                           Y.

Since every variable in a BN is conditioned on its parents, P(Y|X) provided from the meta-analysis is equal to:
                              
                                 
                                    P
                                    (
                                    Y
                                    |
                                    X
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             I
                                          
                                       
                                    
                                    P
                                    (
                                    Y
                                    |
                                    I
                                    )
                                    P
                                    (
                                    I
                                    |
                                    X
                                    )
                                 
                              
                           
                        

Based on this, we can estimate every parameter of P(I|X) as:
                              
                                 
                                    P
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    X
                                    )
                                    =
                                    
                                       
                                          P
                                          (
                                          Y
                                          |
                                          X
                                          )
                                          -
                                          
                                             
                                                ∑
                                             
                                             
                                                m
                                                ∈
                                                S
                                             
                                          
                                          P
                                          (
                                          Y
                                          |
                                          
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                          )
                                          P
                                          (
                                          
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                          |
                                          X
                                          )
                                       
                                       
                                          P
                                          (
                                          Y
                                          |
                                          
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           In this equation, S is the set of states of the variable I except the state ik
                           :
                              
                                 
                                    S
                                    =
                                    Val
                                    (
                                    I
                                    )
                                    ⧹
                                    {
                                    
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                    }
                                 
                              
                           
                        

Consequently, the parameters of P(I|X) can be estimated given that meta-analysis provides us with P(Y|X), and we know or have data to learn P(Y|I). In order to get a point estimate for parameters of P(I|X), the number of the states of I must not exceed the number of the states of Y. Otherwise, we can get an interval for the values in P(I|X) but cannot estimate the exact values.

For example, let X, I and Y in Fig. 7 have two states each with the values {x
                           1,
                           x
                           2}, {i
                           1,
                           i
                           2}, {y
                           1,
                           y
                           2} respectively. Suppose a meta-analysis provides us with P(y
                           1|x
                           1)=0.8, and we learn the probabilities P(y
                           1|i
                           1)=0.9, P(y
                           1|i
                           2)=0.3 from the data. Since I has two states: P(i
                           2|x
                           1)=1−
                           P(i
                           1|x
                           1). From these values, we can calculate P(i
                           1|x
                           1) as:
                              
                                 
                                    P
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                    |
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          P
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          -
                                          P
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          |
                                          
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          P
                                          (
                                          
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          P
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          |
                                          
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          P
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          -
                                          P
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          |
                                          
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          (
                                          1
                                          -
                                          P
                                          (
                                          
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          )
                                       
                                       
                                          P
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          |
                                          
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    =
                                    0.833
                                 
                              
                           When I has more states than Y, we cannot get the exact values of the BN parameters but we can find an interval of possible values. Let I has the states {i
                           1,
                           i
                           2,
                           i
                           3} instead of {i
                           1,
                           i
                           2}. Since I has three states, P(i
                           3|x
                           1)=1−
                           P(i
                           1|x
                           1)−
                           P(i
                           2|x
                           1). Let P(y
                           1|i
                           3)=0.5, and the other values be the same as in the example above. The parameters of P(i
                           1|x
                           1) can be calculated by solving the equation below, for each independent value of Y:
                              
                                 
                                    P
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                    |
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          P
                                          (
                                          Y
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          -
                                          (
                                          P
                                          (
                                          Y
                                          |
                                          
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          P
                                          (
                                          
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          +
                                          P
                                          (
                                          Y
                                          |
                                          
                                             
                                                i
                                             
                                             
                                                3
                                             
                                          
                                          )
                                          P
                                          (
                                          
                                             
                                                i
                                             
                                             
                                                3
                                             
                                          
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          )
                                       
                                       
                                          P
                                          (
                                          Y
                                          |
                                          
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           In this case, we cannot get an exact value for P(I|x
                           1) as the intermediate variable I has more states than Y, resulting in more unknowns than equations. Instead, P(I|x
                           1) can get any value as long as it satisfies the following conditions:
                              
                                 
                                    P
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                    |
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    =
                                    -
                                    1.5
                                    +
                                    2
                                    P
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                    |
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                           
                           
                              
                                 
                                    P
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          3
                                       
                                    
                                    |
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    =
                                    2
                                    .5
                                    -
                                    3
                                    P
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                    |
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                           
                           
                              
                                 
                                    0
                                    ⩽
                                    P
                                    (
                                    I
                                    |
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    ⩽
                                    1
                                 
                              
                           
                        

We could use expert knowledge, by eliciting additional constraints, to narrow down the set of acceptable values for the parameters of I. In our example, P(i
                           1|x
                           1) can get any value between 0.75 and 0.83 to satisfy the conditions above. However, some of these values may not make sense to the domain experts, and we can eliminate these values by adding additional constraints. For example, the experts could say that P(i
                           1|x
                           1) should only get values above 0.8 and we could reflect it by adding the P(i
                           1|x
                           1)>0.8 constraint to the conditions above.

The technique described above can also be applied when more intermediate variables are present. Fig. 8
                            shows a BN that has n intermediate variables between Y and X. A similar case, where 2 intermediate variables are present, is encountered in the case study described in the following section (see Section 4.4.1). An exact estimate can be found given that we know or have data for P(Y|X), P(Y|Ik
                           ) for k
                           =2,…,
                           n, and that Y does not have fewer states than I
                           1.
                              
                                 
                                    P
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    X
                                    )
                                    =
                                    
                                       
                                          P
                                          (
                                          Y
                                          |
                                          X
                                          )
                                          -
                                          
                                             
                                                ∑
                                             
                                             
                                                m
                                                ∈
                                                S
                                             
                                          
                                          P
                                          (
                                          Y
                                          |
                                          
                                             
                                                I
                                             
                                             
                                                n
                                             
                                          
                                          )
                                          P
                                          (
                                          
                                             
                                                I
                                             
                                             
                                                n
                                             
                                          
                                          |
                                          
                                             
                                                I
                                             
                                             
                                                n
                                                -
                                                1
                                             
                                          
                                          )
                                          …
                                          P
                                          (
                                          
                                             
                                                I
                                             
                                             
                                                2
                                             
                                          
                                          |
                                          
                                             
                                                i
                                             
                                             
                                                1
                                             
                                             
                                                m
                                             
                                          
                                          )
                                          P
                                          (
                                          
                                             
                                                i
                                             
                                             
                                                1
                                             
                                             
                                                m
                                             
                                          
                                          |
                                          X
                                          )
                                       
                                       
                                          P
                                          (
                                          Y
                                          |
                                          
                                             
                                                i
                                             
                                             
                                                1
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           where 
                              
                                 S
                                 =
                                 Val
                                 (
                                 
                                    
                                       I
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ⧹
                                 {
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 }
                              
                           .

Using the method described in Section 3, we developed a BN to predict viability of a Lower Extremity with Vascular Trauma (LEVT). This section presents the development of the LEVT BN, and Section 5 presents its results.

@&#BACKGROUND@&#

Injuries to the blood vessels of the lower extremity are potentially devastating and can result in death, severe disability or limb loss. Delays or errors in treatment decisions may lead to irreversible consequences and worsen outcome. One of the most difficult surgical decisions is whether to attempt salvage or perform an amputation of a severely injured extremity. Accurate risk stratification and outcome prediction, for a given injury pattern, has the potential to improve outcome by reducing delays and errors in decision-making.

Limb tissues may be permanently damaged as a direct consequence of the energy transfer during injury or die because of a prolonged disruption to their blood supply. The extent of tissue damage, or loss, is directly related to future outcome and is the primary determinant of the need for amputation. Following a lower extremity vascular injury, early reperfusion of the affected tissues is essential to ensure their viability. Reperfusion entails surgical reconstruction of the damaged blood vessels. Predicting the outcome of vascular reconstruction and the projected tissue viability would inform treatment decisions and risks. We developed a BN model for predicting the viability of a traumatic lower extremity with vascular injury after salvage is attempted. The BN is built in collaboration with the Trauma Sciences Unit at the Royal London Hospital and the United States Army Institute of Surgical Research (USAISR). Two trauma surgeons (the 2nd and 4th authors) were involved in development of the LEVT BN. A dataset of 521 lower extremity injuries and 487 patients collected by USAISR, and a systematic review and meta-analysis of the relevant prognostic factors were used to develop the LEVT BN.

A number of research studies that describe the factors that affect outcome following LEVT have been published. Our first step was to conduct a systematic review of these studies and perform a meta-analysis of the factors. The systematic review included 45 articles containing information regarding 3164 lower extremity repairs. The study protocol is published in the PROSPERO register of systematic reviews [22].

We used the model described in Section 2 to pool the relevant conditional probabilities and calculate the predictive distributions. The meta-analysis models were calculated using AgenaRisk [18]. Table 5
                         shows the means and variances of the posterior predictive distributions. In the following sections, we use these results to define the structure and parameters of a BN model.

The structure of the BN was defined using the methodology described in Section 3.1. The systematic review identified clinical factors that are potentially associated with the outcome of interest. A meta-analysis of these factors identified the strength of this association (see Table 5). A domain expert (2nd author) examined these variables and described the mechanistic relation between each of the variables and the outcome. These relations were modelled in a causal BN structure. Knowledge of mechanistic relations enabled us to identify variables outside the intended scope of the BN. For example, nerve injuries were not included in the model even though they are associated with an increased probability of amputation. The domain expert identified that although nerve injuries may affect function of the related tissues (sensation and movement) they do not affect viability of the tissue. As the intended scope of our model was to predict limb viability, this variable was excluded.

For some variables, our dataset held more detailed information than the results of the meta-analysis. For example, soft-tissue injury was identified as one of the most important prognostic variables by the meta-analysis, the information in our dataset allowed us to model this variable in more detailed states for the BN. Similarly, detailed information on the degree of ischaemia was present in the dataset but not in the meta-analysis. Therefore, the BN models some variables in more detail than the information obtained from the meta-analysis.

Several latent variables were introduced as the domain expert identified the mechanistic relations between the observed clinical factors and outcomes. These variables were clinically important but neither the dataset nor the reviewed studies contained them as they cannot be directly observed [6]. For example, both soft tissue injuries and vessel injuries that require a graft repair have high probabilities of amputation in the meta-analysis. However, each of these factors is related to amputation through a different mechanism. Graft repairs can lead to amputation if the graft blocks or bursts, and thus disrupts the blood flow to the extremity. A variable representing the degree of ‘blood supply’ is required to model this relation. Although the degree of blood supply can be estimated by several measurements, the precise state of this variable is difficult to observe and therefore is not available in the dataset. Soft tissue injuries lead to amputation if insufficient tissue remains to allow repair. Similarly, a latent variable representing the degree of ‘soft tissue cover’ is required to model this relation. Table 6
                         shows a list of the observed and latent variables in the LEVT BN structure. These variables and the LEVT BN structure are described in the following section.

The LEVT BN is divided into 5 components, corresponding to the 5 boxes shown in Fig. 9
                        . A summary of the variables and relations in each of these components are shown below:
                           
                              •
                              
                                 Lower extremity outcome: A viable lower extremity requires an adequate blood supply and sufficient viable soft tissue to allow a repair. The ‘Nonviable Extremity’ variable represents extremities that are amputated as a result of insufficient viable tissue. ‘Nonviable Extremity’ is the main outcome variable that the LEVT BN aims to predict.


                                 Ischaemia: Tissue ischaemia results when there is an imbalance between the supply of oxygen to tissue and the tissues oxygen requirements to sustain life. This results from a disruption in the blood supply to the tissue. Initially ischaemia may be reversible, but if prolonged will result in permanent death of the affected tissues. Since our model is built for lower extremities with vascular injuries, most of the extremities within the scope of our model will be partly or completely ischaemic until the vascular injury is repaired. The severity of ischaemic damage depends on the time elapsed since the beginning of ischaemia (Ischaemia Time) and the degree of obstruction (Ischaemia Degree). A second important cause of ischaemia is the development of a complication called compartment syndrome. Compartment syndrome results when the swelling of injured tissues compresses the blood vessels, disrupting the blood supply.


                                 Soft tissue damage: This part of the model predicts the projected amount of viable soft tissue in the lower extremity. A critical amount of soft tissue is necessary to repair the lower extremity and protect it from infection. Therefore, the degree of soft tissue cover is one of the main factors affecting limb viability. Our model estimates the amount of soft tissue (Soft Tissue Cover) based on the amount of non-viable tissue due to the direct damage from the injury (Soft Tissue Injury) and ischaemia (Ischaemic Damage). Certain injury types (Mechanism of Injury), such as blast injuries, are likely to cause more severe soft tissue injuries.


                                 Success of arterial repair: This part of the model predicts the success of a vascular repair operation represented by the ‘Repair Failure’ variable. ‘Arterial Repair’ variable represents the type of the repair operation, and have two states: ‘Graft’ and ‘Primary Repair’. ‘Graft’ represents bypassing of the injured artery by a vein harvested from the patient. ‘Primary repair’ represents a simpler repair operation such as stitching of a small laceration in the artery. ‘Graft’ repairs have higher rate of failure compared to ‘Primary Repair’ as this operation is more complex and applied to more severe cases. Injury characteristics often define the type of the arterial repair. For example, an arterial injury cannot be treated by primary repair if a significant part of the artery is missing, thus a graft is necessary.
                                    
                                       The ‘Multiple Levels’ variable represent whether vascular injuries are present at multiple levels of the same extremity. Repairs of such injuries have a higher probability of failure as they are more likely to block.

‘Anatomical Site’ variable represents the location of the main arterial injury. Our model includes injuries above the knee (femoral artery), at the knee (popliteal artery) or below the knee (tibial arteries). Reconstruction of a femoral artery often has better outcomes compared to a popliteal or a tibial artery.


                                 Blood circulation: ‘Blood Supply’ variable represents the degree of blood supply to the lower extremity. This variable essentially depends on the ‘Repair Failure’ variable. If the vascular repair fails, the extremity will not have adequate blood supply; so there is a deterministic relation between the negative repair failure and inadequate blood supply. In other words, a repair failure leads to inadequate blood supply, and inadequate blood supply leads to a non-viable extremity in our model. However, a successful arterial repair may not guarantee adequate blood supply throughout the lower extremity; side factors including ‘Shock’ and ‘Microcirculation’ can also affect the outcomes. The ‘Shock’ variable represents an overall deficiency of blood supply throughout the body. The ‘Microcirculation’ variable represents the severity of injury in the smaller vessels of the lower extremity.

A single vessel supplies blood to the lower extremity. This divides into three branches, called tibial arteries, below the knee. Modelling tibial arteries is important since, in this segment, limb viability is related to the number of tibial arteries injured. In order to model this difference, we modified the BN structure for injuries below the knee by adding a variable about the number of injured tibial arteries. This modification is shown by the variable with dashed lines in Fig. 10
                        . Our model assumes that a repair failure leads to a non-viable extremity if all 3 tibial arteries are injured. However, there is a chance of a successful outcome if only 1 or 2 tibial arteries are injured. Apart from this difference, the BN models for above the knee, at the knee and below the knee injuries are exactly the same.

After building the BN structure, we examined the amount of data available for learning each parameter in the BN. The data were insufficient, or not available, to learn the parameters of some relations. In this section, we describe the techniques used to learn the parameters when they have (1) insufficient amount of data, (2) no data at all (latent variables), and (3) adequate amount of data.

When there is insufficient data to learn a parameter, we combined the results of the meta-analysis and data by using the technique described in Section 3.2. We used the mean and variance of the relevant predictive distributions from the meta-analysis (see Table 5) as observations to the μPnew
                            and 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       Pnew
                                    
                                    
                                       2
                                    
                                 
                              
                            variables in the auxiliary learning model of this technique (see Fig. 6). For example, Table 7
                            shows the amount of available data to learn the NPT of the ‘repair failure’ variable. The data is not evenly distributed to learn this NPT. While there is plenty of data to learn some parameters, only a few instances is available to learn others. We used the meta-analysis results for the parameters that have less than 20 instances of data (shown by bold fonts in 7). We observed that using meta-analysis results did not change the probabilities significantly when it was applied to the parameters with more than 20 instances of data in our case study. Therefore, we used a purely data driven approach for those parameters (see Section 4.4.3). However, it should be noted that different thresholds may be suitable to other applications in different domains.

The meta-analysis provides us the pooled probabilities of an unsuccessful outcome conditioned on each individual clinical factor (see Table 5). The variable equivalent to an unsuccessful outcome is ‘nonviable extremity’ in the LEVT BN but the meta-analysis results can also be used for the NPT of the ‘repair failure’ variable as (1) our model assumes a deterministic relation between an unsuccessful outcome and repair failure, and thus we know the parameters of the intermediate variables between them and (2) the parents of ‘repair failure’ can influence ‘nonviable extremity’ through only one pathway (see Section 3.2.3). For example, the ‘arterial repair’ variable can affect ‘nonviable extremity’ through the following pathway in our model:
                              
                                 
                                    
                                       
                                          Arterial
                                          
                                          Repair
                                       
                                       
                                          (
                                          AR
                                          )
                                       
                                    
                                    →
                                    
                                       
                                          
                                          Repair
                                          
                                          Failure
                                       
                                       
                                          (
                                          RF
                                          )
                                       
                                    
                                    →
                                    
                                       
                                          
                                          Blood
                                          
                                          Supply
                                       
                                       
                                          (
                                          BS
                                          )
                                       
                                    
                                    →
                                    
                                       
                                          Nonviable
                                          
                                          Extremity
                                          
                                       
                                       
                                          (
                                          NE
                                          )
                                       
                                    
                                 
                              
                           
                        

The probability provided by the meta-analysis, P(NE
                           =
                           True|AR
                           =
                           Graft), is equivalent to marginalisation of ‘repair failure’ and ‘blood supply’ from this pathway:
                              
                                 
                                    P
                                    (
                                    NE
                                    =
                                    True
                                    |
                                    AR
                                    =
                                    Graft
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             BS
                                             ,
                                             RF
                                          
                                       
                                    
                                    P
                                    (
                                    NE
                                    =
                                    True
                                    |
                                    BS
                                    )
                                    P
                                    (
                                    BS
                                    |
                                    RF
                                    )
                                    P
                                    (
                                    RF
                                    |
                                    AR
                                    =
                                    Graft
                                    )
                                 
                              
                           
                        

In our model, a repair failure always leads to inadequate blood supply, and inadequate blood supply always leads to a nonviable extremity so that:
                              
                                 
                                    P
                                    (
                                    BS
                                    =
                                    Low
                                    |
                                    RF
                                    =
                                    True
                                    )
                                    =
                                    1
                                    ,
                                    P
                                    (
                                    NE
                                    =
                                    True
                                    |
                                    BS
                                    =
                                    Low
                                    )
                                    =
                                    1
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    P
                                    (
                                    BS
                                    =
                                    Low
                                    |
                                    RF
                                    =
                                    ¬
                                    True
                                    )
                                    =
                                    0
                                    ,
                                    P
                                    (
                                    NE
                                    =
                                    True
                                    |
                                    BS
                                    =
                                    ¬
                                    Low
                                    )
                                    =
                                    0
                                 
                              
                           By using these values in the marginalisation equation above, we get P(NE
                           =
                           True|AR
                           =
                           Graft)=
                           P(RF
                           =
                           True|AR
                           =
                           Graft). Consequently, we can use the probabilities from the meta-analysis for learning the relation between ‘repair failure’ and its parents.

We used the OpenBUGS software [19] to calculate the posteriors of the auxiliary learning model. We used the Gelman and Rubin diagnostic technique [23], sample plots and autocorrelation plots to assess the convergence. We discarded the first 10,000 samples in MCMC as the burn-in samples, and calculated the posterior distributions based on the next 70,000 samples.


                           Table 8
                            shows extracts of the NPTs of the ‘Repair Failure’ variable and the amount of data available to learn its parameters. The values written in bold and italic fonts are the parameters learned by combining the results of the meta-analysis with the data, and the values written in normal fonts are the parameters learned purely from the data. The results of these approaches differ substantially as the data gets smaller. The effects of this difference to the model performance are discussed in Section 5.1.

The BN contained several latent variables as described in Section 4.3 (see Table 6 for a list of these variables). Ranked nodes were used to model the NPT of these variables [24]. A ranked node is an approximation of the truncated normal distribution to the multinomial distribution with ordinal scale. We used the framework proposed by Fenton et al. [24] to elicit the parameters of ranked nodes. For each of the latent variables we first asked the domain experts to describe the relation between the variable and its parents. Afterwards, we selected a suitable ranked node function and elicited initial weights that imitate the described relation. We presented the behaviour of the ranked node under various combinations of observations to the domain experts, and refined the weights based on their comments.

After the parameters with insufficient or no data were defined, the remainder of the parameters were learned purely from the data. The expectation–maximisation (EM) algorithm [25] was used to learn those parameters as the dataset contained missing values. Small correction factors were used at the maximisation step of the EM algorithm to avoid zero probabilities. The parameters that were already defined in the previous steps were kept fixed while EM was applied. For example, EM was applied to the parameters of the ‘Arterial Repair’ variable with more than 20 instances of data. The other parameters of this variable had been already learnt by using meta-analysis results at this stage, so they were kept fixed while the EM was applied.

@&#RESULTS@&#

The performance of the LEVT BN was evaluated using a 10-fold cross-validation [26]. We used multiple performance measures to assess the discrimination, calibration and accuracy of the model. Receiver operating characteristic (ROC) curves, and sensitivity and specificity values was used to assess the discrimination, the Hosmer–Lemeshow (HL) [27] test was used to assess the calibration. The HL test divides the data into multiple subgroups, and calculates a chi-square statistic comparing the observed outcomes to the outcomes expected by the model in each subgroup. Low p-values indicate a lack of calibration. In large datasets, small differences between the expected and observed outcomes can lead to low p-values in a HL test but the visual representation of this test provides a concise summary of the model calibration. The Brier score (BS) and Brier skill score (BSS) was used to assess the accuracy [28,29]. BS is the mean squared difference between the predicted probability and observed outcome. A BS of 0 indicates a perfect model and 1 is the worst score achievable. BSS measures the improvement of the model’s prediction relative to the average probability of the event in the data or another reference probability. A BSS of 1 indicates a perfect model, and a negative value indicates a worse prediction than the average probability. The area under the ROC curve (AUROC) of the LEVT BN was 0.91. When operated at 80% and 90% sensitivity, the specificity was 81% and 70% respectively. BS and BSS of the LEVT BN were 0.06 and 0.33 respectively. The BN was well calibrated with a HL statistic of 12.7 (p-value: 0.13). Fig. 11
                      shows a graphical representation of the HL tests. The predictions of the model are divided into deciles in this figure; the expected number of outcomes according to the model and the number of outcomes in the data are compared for each decile.

The main reason of using our method for parameter learning was that the available data were insufficient to learn parts of the BN structure. Since the BN model in Fig. 8 has a complicated structure compared to the available data, a purely data driven parameter learning approach would probably overfit the model. To show the consequences of not doing anything to compensate for the lack of data, we learned the parameters of the same BN structure from data without using any information from the meta-analysis. The parameters of the variables that had no data (i.e. ranked nodes, see Section 4.4.3) were defined using the same parameters values elicited from experts. The data-driven parameter learning algorithm had poor discrimination, calibration and accuracy. The AUROC was 0.68, the specificity was 29% and 45% at the 90% and 80% sensitivity levels, and the HL test indicated poor calibration (p-value: 0.01). The BS and BSS were 0.10 and 0.02. Our method outperformed the data-driven parameter learning algorithm in all measures. In summary, the purely data driven parameter learning overfitted the training data as the data was inadequate to learn some parts of the BN parameters (Table 7). This underlines the need to exploit other sources of information such as published evidence. Our method overcomes the overfitting problem by using information from the meta-analysis when the data is insufficient.

The mangled extremity severity score (MESS) [30] is a well-known scoring system [31] that was developed to provide decision support in the management of patients with severe lower extremity injuries. MESS calculates a score based on the injury mechanism, the degree of shock, the ischaemic status and the patient’s age. If the score is above a certain threshold value MESS recommends an early amputation. Our method outperformed MESS in predicting the ‘Nonviable Extremity’ variable (Fig. 12
                        ). MESS had an AUROC of 0.75. When operated at 90% and 80% sensitivity, its specificity was 40% and 60% respectively. The HL test indicated poor calibration (p-value=0.01). BS and BSS of MESS could not be calculated as its outputs are not probabilities.

We compared the performance of our method to three different data-driven structure learning algorithms. These algorithms learn both the structure and parameters from data so they do not use expert knowledge at all in model development. These algorithms avoid overfitting by penalising large BN structures. The following structure algorithms were used:
                           
                              1.
                              
                                 A score based learning algorithm:hill climbing (HC) algorithm with the BIC score [32–34].


                                 A constraint based algorithm:grow shrink (GS) algorithm [33].


                                 A combination of score and constraint based approaches:max–min hill climbing (MMHC) algorithm [35].


                                 A score based EM algorithm:structural EM (SEM) algorithm with the BIC score [36].

The first three algorithms require complete datasets so we imputed the missing values in the dataset using the Amelia package [37] in the R statistical software for these algorithms (see [37] for a description of the imputation technique used in Amelia). The HC, GS and MMHC algorithms are readily implemented in the BNLearn package of R [38]. The SEM algorithm is able to handle missing values when learning structure therefore it is not necessary to impute the missing values beforehand. We used the SEM algorithm implemented in the structure learning package of the Bayes net toolbox of Matlab [39].

The LEVT BN had a better AUROC and substantially better performance at the operating points with higher sensitivity levels (see Table 9
                        ). The LEVT BN had better BS and BSS than the structure learning algorithms. The LEVT BN and BNs developed by HC and GS approaches were well calibrated. Since the amount of data was insufficient to learn the relation between some variables, the structure learning algorithms avoided overfitting by learning simple BN structures. The BN structures learned by HC, MMHC, GS and SEM algorithms are shown in Fig. 13
                        .

@&#CONCLUSION@&#

This paper presented a novel methodology to build BN decision support models from the results of a meta-analysis, expert knowledge and data. The main contribution of this methodology was a novel parameter learning technique that combines univariate statistics with data to learn multivariate BN parameters. Our method was successfully applied to a trauma case-study of severely injured lower extremities. We developed a BN model that accurately predicts the viability of a lower extremity with vascular trauma. The case study demonstrated the benefits of integrating different sources of evidence into BN development. In a 10-fold cross-validation, the BN built by our approach outperformed the MESS scoring system and four different data-driven structure learning techniques. The AUROC of the LEVT BN was 0.91; whereas it was 0.84 for the best performing structure learning technique, 0.75 for MESS, and 0.68 when meta-analysis values were not used for defining the LEVT BN parameters.

The techniques presented in this paper can be applied to a wider scope of problems than trauma care. Using our method, models that reflect complexity of clinical decisions can be built even when there is insufficient patient data. Our method enables the use of information from other sources such as published evidence and meta-analysis of systematic reviews. It offers a Bayesian way of combining multivariate patient data with published statistics conditioned on a smaller number of variables.

As further research, our auxiliary parameter learning model could be expanded to a unified parameter learning framework that combines data, published evidence and domain knowledge. Qualitative expert constraints [7,40,41] could be integrated into our parameter learning method to incorporate expert knowledge alongside data and meta-analysis. Moreover, the variance estimated from the auxiliary parameter learning model (Section 3.2) could be used to show how well the parameters are understood. In our case study, we applied our parameter learning technique to the parameters that had less than 20 instances of relevant data. The effects using different data thresholds could be explored. Finally, Bayesian parameter learning methods estimate the entire probability distribution of a parameter. The expected value of this distribution is used for the relevant NPT but the variance is often ignored. Ways of integrating the variance to inference and parameter estimation techniques could be investigated.

@&#ACKNOWLEDGMENTS@&#

We thank two anonymous reviewers for their valuable comments and suggestions that have helped us to improve this paper.

@&#REFERENCES@&#

