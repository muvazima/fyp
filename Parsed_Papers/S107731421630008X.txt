@&#MAIN-TITLE@&#Rejection based multipath reconstruction for background estimation in video sequences with stationary objects

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a new temporal-spatial block-based Background estimation approach to compute a foreground-free image for video sequences.


                        
                        
                           
                           Threshold-free clustering is proposed to discover similar blocks over time which contain the background data.


                        
                        
                           
                           An iterative spatial reconstruction selects blocks to obtain the final background.


                        
                        
                           
                           The performance improvement is validated in two datasets (36 sequences) using 13 state-of-the-art algorithms.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Background estimation

Stationary foreground

Background visibility

Clustering

Smoothness

Multipath

@&#ABSTRACT@&#


               
               
                  Background estimation in video consists in extracting a foreground-free image from a set of training frames. Moving and stationary objects may affect the background visibility, thus invalidating the assumption of many related literature where background is the temporal dominant data. In this paper, we present a temporal-spatial block-level approach for background estimation in video to cope with moving and stationary objects. First, a Temporal Analysis module obtains a compact representation of the training data by motion filtering and dimensionality reduction. Then, a threshold-free hierarchical clustering determines a set of candidates to represent the background for each spatial location (block). Second, a Spatial Analysis
module iteratively reconstructs the background using these candidates. For each spatial location, multiple reconstruction hypotheses (paths) are explored to obtain its neighboring locations by enforcing inter-block similarities and intra-block homogeneity constraints in terms of color discontinuity, color dissimilarity and variability. The experimental results show that the proposed approach outperforms the related state-of-the-art over challenging video sequences in presence of moving and stationary objects.
               
            

@&#INTRODUCTION@&#

Segregating relevant moving objects is widely used in several applications of image processing and computer vision. This task often requires to estimate a foreground-free image (or background) under several visual challenges such as in Background Subtraction algorithms (Bouwmans, 2014; Sobral and Vacavant, 2014). Background estimation (BE) finds applications not only in moving object segregation from video sequences (Park and Byun, 2013) but also to represent redundancy in video compression (Paul, 2012), to repair deteriorated images for inpainting (Chen et al., 2010), to implement video-based privacy protection (Nakashima et al., 2011) and to obtain object-free images for computational photography (Granados et al., 2008).

Several state-of-the-art BE approaches easily capture the background by assuming the availability of a set of frames without foreground objects (training frames) (Bouwmans, 2014). This assumption may not be correct in many video-surveillance scenarios (e.g. shopping malls, airports or train stations), where many foreground objects may exist due to crowds and stationary objects, making very challenging the capture of the background. In general, BE faces two problems related with spatio-temporal scene variations: background visibility and photometric factors. The former occurs when pixels or regions of the background are seen for short periods of time in the training frames (e.g. due to stationary objects or to high-density of moving foreground), thus the predominant temporal data is not the background. The latter affects BE performance by modifying the background (illumination changes) or by affecting to the employed features (shadows and camouflages). The presence of stationary objects is a major limitation in current approaches as background visibility is highly decreased in the training frames.

To overcome the above-mentioned limitations, we propose a block-level BE approach based on a temporal-spatial strategy that reconstructs an object-free background in presence of moving and stationary objects. For each spatial location, a temporal analysis module obtains a number of background candidates (blocks) via motion filtering, dimensionality reduction and threshold-free hierarchical clustering. Then, the spatial analysis module selects the most suitable candidate for each spatial location according to available candidates in neighboring locations. First, the spatial strategy partially approximates the background by setting a number of initial locations (seeds) based on the motion activity along the training frames. Second, an iterative process estimates the remaining background based on inter-block and intra-block smoothness constraints. The experimental work validates the utility of the proposed approach, outperforming selected approaches in various datasets especially when dealing with stationary objects.

The contribution of the proposed approach is fourfold. First, we propose a threshold-free clustering technique to determine background candidates without requiring parameter tuning to achieve optimal performance (Hsiao and Leou, 2013; Reddy et al., 2011). Second, we obtain an initial background estimation (seeds selection) containing more data than state-of-the-art approaches (Baltieri et al., 2010; Reddy et al., 2009; 2011) without introducing additional errors. Thus, fewer spatial locations need to be reconstructed, making the proposed approach less prone to estimation errors as compared to related approaches. Third, the iterative reconstruction estimates different hypotheses of the neighboring background at each location and selects one of them, unlike approaches based on single-hypothesis estimations which may have low-accuracy (Baltieri et al., 2010; Colombari and Fusiello, 2010; Reddy et al., 2009; 2011). Fourth, a new performance measure is proposed to avoid the use of a unique threshold (Baltieri et al., 2010; Reddy et al., 2009; 2011).

The paper is organized as follows: Section 2 discusses the related work and Section 3 overviews the proposed approach. Sections 4 and 5 describe the temporal and spatial analysis, respectively. Section 6 shows the experimental work. Finally, Section 7 presents some conclusions.

@&#RELATED WORK@&#

Different terms are used for BE (Balcilar and Sonmez, 2015; Reddy et al., 2011): Bootstrapping (Hsiao and Leou, 2013; Maddalena and Petrosino, 2012), Background initialization (Colombari and Fusiello, 2010; Park and Byun, 2013), Background generation (Colque and Camara-Chavez, 2011; Zhang et al., 2012) or Background reconstruction (Crivelli et al., 2011). Moreover, BE literature can be categorized as (Maddalena and Petrosino, 2014b): Temporal Statistics, Sub-intervals of Stable Intensity, Iterative Model Completion and Optimal Labeling. In this section, we instead review related approaches focusing on the applied strategy: temporal and spatial. These strategies may use data in a batch or an online fashion, operating at pixel or region (block) level.

Approaches using temporal strategies are common in Background Subtraction (Maddalena and Petrosino, 2014b), where the first frame is taken as the background image, which is updated by the successive frames (Maddalena and Petrosino, 2012; St-Charles et al., 2015; Zezhi and Ellis, 2014). Beyond these techniques, Robust Principal Component Analysis (RPCA) (Bouwmans and Zahzah, 2014) models the background image of a video sequence by low-rank subspace analysis, while the foreground is represented by the correlated sparse outliers. However, RPCA methods lose the temporal and spatial structure when representing each frame as a column vector, thus limiting the initialization capabilities. EigenBackground (EB) methods compute a basis of eigenvectors from the training frames to model the background at image (Oliver et al., 2000) or block level (Hu et al., 2009). EB methods require a temporal consistency of the background for successful performance where short-term background occlusions are assumed (Tian et al., 2013). RPCA and EB methods do not consider multiple basis to account for the range of appearances exhibited in the training frames and the relations between the basis of adjacent spatial locations, thus decreasing their performance in presence of slow-motion or stationary foreground. The temporal median at pixel level is widely used (Eng et al., 2003; Maddalena and Petrosino, 2014a), but stationary objects for more than 50% of the training frames are included in the background. Motion information can be used to remove foreground objects from the background model such as optical flow (Chia-Chih and Aggarwal, 2008; Gutchess et al., 2001; Lin et al., 2009) or inter-frame differences (Hsiao and Leou, 2013; Lin et al., 2009; Zhang et al., 2012). Temporal continuous stability of pixel intensity is also employed to obtain hypotheses for the background model in each spatial location (Chia-Chih and Aggarwal, 2008; Gutchess et al., 2001; Wang and Suter, 2006) where non-continuous intervals are wrongly assumed as different background representations. Therefore, clustering of non-continuous intervals is preferred to address such assumption  (Baltieri et al., 2010; Benalia and Ait-Aoudia, 2012; Colombari and Fusiello, 2010; Reddy et al., 2009; 2011). Furthermore, temporal variability of pixel values is used to keep occluded background values and to avoid wrong model updates with foreground data (Park and Byun, 2013).

Although, some approaches only use temporal analysis (Maddalena and Petrosino, 2014a; Wang and Suter, 2006), a spatial analysis is needed in presence of moving and stationary objects since background may no longer be the dominant temporal information in the training frames. Smoothness constraints may be imposed in the background to decide whether new pixels or blocks belong to the background employing features such as color (Zhang et al., 2012). In Reddy et al. (2011) and Reddy et al. (2009), the Discrete Cosine Transform (DCT) is embedded in a Markov Random Field (MRF) framework to introduce smoothness in neighbors, while iterative background estimations correct possible errors (Reddy et al., 2011). Alternatively, DCT can be replaced by the Hadamard transform to decrease computational complexity, which is combined with iterative corrections based on gradient features between candidates and their neighbors (Baltieri et al., 2010). Smoothness can also be cast as finding the best partially-overlapping block between candidates and the already set background locations (Colombari and Fusiello, 2010). Moreover, block-level color and gradient constraints with the neighborhood can be applied to estimate the background (Shrotre and Karam, 2013). Furthermore, other approaches encode spatial smoothness and temporal information in energy minimization frameworks such as Loopy Belief Propagation (Guo et al., 2012; Xun and Huang, 2008), Graph Cuts (Chen et al., 2010), Conditional Mixed-State MRFs (Crivelli et al., 2011) or dynamic MRFs (Park and Byun, 2013). Recently, Chacon-Murguia et al. (2014) introduce spatial constraints through image segmentation. Additionally, spatial information also considers optical flow in the neighborhood (Gutchess et al., 2001), correcting its density by handling objects moving at different depths (Chia-Chih and Aggarwal, 2008).

In summary, several BE strategies have been proposed where recent approaches use temporal information and apply smoothness constraints over the estimated background. The main limitation of current approaches involves situations of low background visibility where existing smoothness schemes do not successfully deal with stationary objects.

The proposed approach performs a temporal-spatial analysis at block level (see Fig. 1
                     ) over a set of T training frames It
                     , 
                        
                           F
                           =
                           
                              {
                              
                                 I
                                 1
                              
                              .
                              .
                              .
                              
                                 I
                                 T
                              
                              }
                           
                           ,
                        
                      to extract the reconstructed background image B free of moving and stationary objects. First, the Splitting module divides each It
                      into non-overlapping blocks 
                        
                           R
                           
                              t
                           
                           s
                        
                      of size W × W, where s is the bi-dimensional index for the spatial location of each block. Second, the Temporal Analysis module creates a number of background candidates 
                        
                           C
                           
                              l
                           
                           s
                        
                      for each spatial location s, where 
                        
                           l
                           ∈
                           {
                           1
                           …
                           
                              N
                              s
                           
                           }
                        
                      and N
                     
                        s
                      ≤ T is the number of candidates. The Temporal Analysis consists of the Motion Filtering stage to discard 
                        
                           R
                           
                              t
                           
                           s
                        
                      blocks, where moving objects exist and the Dimensionality Reduction stage to decrease the amount of data analyzed by the Clustering stage which obtains a set of background candidates. Finally, the SpatialAnalysis module reconstructs the background of each spatial location s, partially estimated in the Seed Selection stage, by the Multipath Reconstruction stage to iteratively fill each spatial location s with the optimal candidate 
                        
                           C
                           
                              *
                           
                           s
                        
                      using inter-block and intra-block smoothness constraints. The temporal and spatial analysis modules are described in Sections 4 and 5, respectively. The key symbols we use in this paper are given in Table 1
                     .

The Temporal Analysis module generates the background candidates of each spatial location s. It contains three stages (Fig. 1): Motion Filtering, Dimensionality Reduction and Clustering.
                  

The Motion filtering stage discards 
                           
                              R
                              
                                 t
                              
                              s
                           
                         blocks corresponding to moving objects that cannot be candidates for the reconstructed background B. For all training frames, we compute the motion activity at block level 
                           
                              λ
                              
                                 t
                              
                              s
                           
                        :

                           
                              (1)
                              
                                 
                                    λ
                                    
                                       
                                       
                                          t
                                       
                                       s
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                   i
                                                   f
                                                   
                                                
                                             
                                             
                                                
                                                   ∃
                                                   p
                                                   ∈
                                                   s
                                                   :
                                                   
                                                   
                                                      |
                                                      
                                                         I
                                                         
                                                            t
                                                         
                                                         p
                                                      
                                                      −
                                                      
                                                         I
                                                         
                                                            t
                                                            −
                                                            k
                                                         
                                                         p
                                                      
                                                      |
                                                   
                                                   >
                                                   η
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                             
                                                
                                                   o
                                                   t
                                                   h
                                                   e
                                                   r
                                                   w
                                                   i
                                                   s
                                                   e
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           
                        
                     

where p is the bi-dimensional index for pixel locations in s and the threshold η is computed automatically (Kapur et al., 1985) to detect intensity changes between 
                           
                              k
                              −
                           
                        separated frame differences due to moving objects (k should be small). 
                           
                              λ
                              
                                 t
                              
                              s
                           
                         takes the value 1(0) when motion (no motion) is detected, thus rejecting (keeping) the associated block 
                           
                              R
                              
                                 t
                              
                              s
                           
                        . Note that Eq. (1) implies the visualization of the background for k consecutive frames, as often assumed in existing literature (Chia-Chih and Aggarwal, 2008; Reddy et al., 2011). Finally, the selected data to compose the background at each location s is represented by 
                           
                              
                                 Y
                                 s
                              
                              =
                              
                                 
                                    {
                                    
                                       R
                                       
                                          v
                                       
                                       s
                                    
                                    }
                                 
                                 
                                    v
                                    =
                                    1
                                    .
                                    .
                                    .
                                    
                                       M
                                       S
                                    
                                 
                              
                              ,
                           
                         where M
                        
                           s
                         is the number of blocks without motion and M
                        
                           s
                         ≤ T, ∀s.

To further reduce the data to process, we apply Principal Component Analysis (PCA) (Jolliffe, 2005) to 
                           
                              Y
                              s
                           
                         as the useful data to generate background candidates is driven by the block variance. Pixel locations with variations over time are relevant to group blocks whereas pixel locations without variability are redundant. PCA determines a transformation basis to project data where pixels with low variance over time are removed. PCA is applied to all blocks in 
                           
                              
                                 Y
                                 s
                              
                              ,
                           
                         where each block is previously rasterized into a column vector of size 3W
                        2 by concatenating its RGB channels. Finally, we obtain a matrix 
                           
                              
                                 Z
                                 s
                              
                              =
                              
                                 
                                    {
                                    
                                       U
                                       
                                          v
                                       
                                       s
                                    
                                    }
                                 
                                 
                                    v
                                    =
                                    1
                                    .
                                    .
                                    .
                                    
                                       M
                                       s
                                    
                                 
                              
                              ,
                           
                         where 
                           
                              
                                 |
                                 
                                    U
                                    
                                       v
                                    
                                    s
                                 
                                 |
                              
                              ≤
                              
                                 |
                                 
                                    R
                                    
                                       v
                                    
                                    s
                                 
                                 |
                              
                           
                         and ∣ · ∣ denotes the cardinality, i.e. the number of elements, representing the data in the PCA domain which is used exclusively for the clustering stage (Section 4.3). Note that the Spatial Analysis module (Section 5) uses the W × W blocks 
                           
                              R
                              
                                 t
                              
                              s
                           
                         to estimate the background image B instead of the PCA-reduced data 
                           
                              U
                              
                                 v
                              
                              s
                           
                        .

This stage generates a number of candidates 
                           
                              C
                              
                                 l
                              
                              s
                           
                         to be the background B
                        
                           s
                         for each location s. Instead of using the raw data, we group the PCA-reduced data 
                           
                              Z
                              s
                           
                         into clusters 
                           
                              K
                              
                                 l
                              
                              s
                           
                         which are structured as partitions 
                           
                              
                                 P
                                 
                                    
                                       N
                                       s
                                    
                                 
                                 s
                              
                              =
                              
                                 {
                                 
                                    K
                                    
                                       1
                                    
                                    s
                                 
                                 …
                                 
                                    K
                                    
                                       
                                          N
                                          s
                                       
                                    
                                    s
                                 
                                 }
                              
                           
                         where N
                        
                           s
                         is the total number of clusters. As the optimum N
                        
                           s
                         is not known for each s, hypotheses for the partitions are created for different values of N
                        
                           s
                        . The optimal partition is found by validation indexes that maximize inter-cluster differences and intra-cluster similarities. The proposed approach provides a threshold-free clustering that leads to sub-optimal solutions containing the desired candidates. The candidates 
                           
                              C
                              
                                 l
                              
                              s
                           
                         represent each cluster 
                           
                              K
                              
                                 l
                              
                              s
                           
                         where the best candidate 
                           
                              C
                              
                                 *
                              
                              s
                           
                         is selected in the Spatial Analysis module (Section 5).

For generating the clusters, we employ agglomerative hierarchical clustering (AHC) (Jain et al., 1999) over matrices 
                           
                              Z
                              s
                           
                        , where the distance between two clusters is defined as the highest Euclidean distance among members 
                           
                              U
                              
                                 v
                              
                              s
                           
                         of both clusters. The AHC cluster structure can be represented as dendrograms, i.e. tree-like diagrams depicting partition hypotheses at different cluster distances. Thus, we limit the number of clustering hypotheses between a minimum and maximum value (
                           
                              N
                              
                                 m
                                 i
                                 n
                              
                              s
                           
                         and 
                           
                              
                                 N
                                 
                                    m
                                    a
                                    x
                                 
                                 s
                              
                              ,
                           
                         respectively). 
                           
                              N
                              
                                 m
                                 i
                                 n
                              
                              s
                           
                         is set to 1 (i.e. one cluster) which corresponds to an always-visible background. For each location s, 
                           
                              N
                              
                                 m
                                 a
                                 x
                              
                              s
                           
                         is set to the number of identified Sub-intervals of Stable Intensity (SSI) (Chia-Chih and Aggarwal, 2008; Gutchess et al., 2001), as SSIs may be caused by objects or background. SSIs are continuous temporal intervals without intensity variations, computed at block level using motion information from Eq. 1. Finally, partition hypotheses 
                           
                              
                                 {
                                 
                                    P
                                    
                                       b
                                    
                                    s
                                 
                                 }
                              
                              
                                 b
                                 =
                                 
                                    N
                                    
                                       m
                                       i
                                       n
                                    
                                    s
                                 
                                 ,
                                 .
                                 .
                                 .
                                 ,
                                 
                                    N
                                    
                                       m
                                       a
                                       x
                                    
                                    s
                                 
                              
                           
                         are generated where b is the number of clusters in the partition. Fig. 2
                         shows a dendrogram for clustering eight blocks and an example of SSIs on top of Fig. 2, where 
                           
                              
                                 N
                                 
                                    m
                                    a
                                    x
                                 
                                 s
                              
                              =
                              5
                           
                        .

Subsequently, clustering validation determines the best partition 
                           
                              P
                              
                                 *
                              
                              s
                           
                         containing the optimal number of clusters 
                           N
                           
                              s
                           
                        . This validation employs the Silhouette θSI
                         and Davies-Bouldin θDB
                         indexes (Wang et al., 2009). θSI
                         measures the compactness and separation among clusters; a higher average value of this measure implies a better quality of the cluster. θDB
                         measures the similarity between each cluster and its highest similar one; small values in this index correspond to compact clusters whose centroid is far from the others. After computing both indexes for each hypothesized partition 
                           
                              
                                 P
                                 
                                    b
                                 
                                 s
                              
                              ,
                           
                         we normalize them by considering that maximum θSI
                         and minimum θDB
                         are preferred:

                           
                              (2)
                              
                                 
                                    
                                       θ
                                       
                                          S
                                          I
                                       
                                    
                                    
                                       (
                                       
                                          P
                                          
                                             b
                                          
                                          s
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          S
                                          I
                                          
                                             (
                                             
                                                P
                                                
                                                   b
                                                
                                                s
                                             
                                             )
                                          
                                          −
                                          m
                                          i
                                          n
                                          
                                             (
                                             L
                                             )
                                          
                                       
                                       
                                          m
                                          a
                                          x
                                          (
                                          L
                                          )
                                          −
                                          m
                                          i
                                          n
                                          (
                                          L
                                          )
                                       
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       θ
                                       
                                          D
                                          B
                                       
                                    
                                    
                                       (
                                       
                                          P
                                          
                                             b
                                          
                                          s
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          D
                                          B
                                          
                                             (
                                             
                                                P
                                                
                                                   b
                                                
                                                s
                                             
                                             )
                                          
                                          −
                                          m
                                          a
                                          x
                                          
                                             (
                                             M
                                             )
                                          
                                       
                                       
                                          m
                                          a
                                          x
                                          (
                                          M
                                          )
                                          −
                                          m
                                          i
                                          n
                                          (
                                          M
                                          )
                                       
                                    
                                    ,
                                 
                              
                           
                        where the sets 
                           
                              L
                              =
                              
                                 
                                    {
                                    
                                       θ
                                       
                                          S
                                          I
                                       
                                    
                                    
                                       (
                                       
                                          P
                                          
                                             b
                                          
                                          s
                                       
                                       )
                                    
                                    }
                                 
                                 
                                    b
                                    =
                                    N
                                    
                                       
                                       
                                          m
                                          i
                                          n
                                       
                                       s
                                    
                                    ,
                                    .
                                    .
                                    .
                                    ,
                                    N
                                    
                                       
                                       
                                          m
                                          a
                                          x
                                       
                                       s
                                    
                                 
                              
                           
                         and 
                           
                              M
                              =
                              
                                 
                                    {
                                    
                                       θ
                                       
                                          D
                                          B
                                       
                                    
                                    
                                       (
                                       
                                          P
                                          
                                             b
                                          
                                          s
                                       
                                       )
                                    
                                    }
                                 
                                 
                                    b
                                    =
                                    N
                                    
                                       
                                       
                                          m
                                          i
                                          n
                                       
                                       s
                                    
                                    ,
                                    .
                                    .
                                    .
                                    ,
                                    N
                                    
                                       
                                       
                                          m
                                          a
                                          x
                                       
                                       s
                                    
                                 
                              
                           
                         are all θSI
                         and θDB
                         scores, respectively. Then, both scores are combined for each partition 
                           
                              P
                              
                                 b
                              
                              s
                           
                         to determine the optimal 
                           
                              P
                              
                                 *
                              
                              s
                           
                        :

                           
                              (4)
                              
                                 
                                    
                                       P
                                       
                                          *
                                       
                                       s
                                    
                                    =
                                    
                                       
                                          a
                                          r
                                          g
                                          m
                                          a
                                          x
                                       
                                       
                                          b
                                          =
                                          
                                             N
                                             
                                                m
                                                i
                                                n
                                             
                                             s
                                          
                                          ,
                                          .
                                          .
                                          .
                                          ,
                                          
                                             N
                                             
                                                m
                                                a
                                                x
                                             
                                             s
                                          
                                       
                                    
                                    
                                    
                                    
                                       (
                                       
                                          θ
                                          
                                             S
                                             I
                                          
                                       
                                       
                                          (
                                          
                                             P
                                             
                                                b
                                             
                                             s
                                          
                                          )
                                       
                                       +
                                       
                                          θ
                                          
                                             D
                                             B
                                          
                                       
                                       
                                          (
                                          
                                             P
                                             
                                                b
                                             
                                             s
                                          
                                          )
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                        Fig. 3
                         presents an example of clustering validation with 11 partitions, where the optimal one contains 3 clusters with the highest 
                           
                              
                                 θ
                                 
                                    S
                                    I
                                 
                              
                              
                                 (
                                 
                                    P
                                    
                                       b
                                    
                                    s
                                 
                                 )
                              
                              +
                              
                                 θ
                                 
                                    D
                                    B
                                 
                              
                              
                                 (
                                 
                                    P
                                    
                                       b
                                    
                                    s
                                 
                                 )
                              
                           
                         value.

Finally, we compute each background candidate 
                           
                              C
                              
                                 l
                              
                              s
                           
                         as the average of members in the cluster 
                           
                              
                                 K
                                 
                                    l
                                 
                                 s
                              
                              ,
                           
                         using the W × W blocks 
                           
                              R
                              
                                 t
                              
                              s
                           
                         instead of the PCA-reduced data 
                           
                              
                                 U
                                 
                                    v
                                 
                                 s
                              
                              ,
                           
                         similarly to the widely used K-means clustering (Hartigan, 1975), which also reduces noise in the final candidate.

This module obtains each background block B
                     
                        s
                      by selecting the best candidate 
                        
                           C
                           
                              *
                           
                           s
                        
                      among the set of background candidates 
                        
                           C
                           
                              l
                           
                           s
                        
                     . For each location, a multipath reconstruction of the background is proposed to enforce background smoothness among selected candidates in neighboring locations. The reconstruction process is divided in two stages (see Fig. 1): Seed Selection and Multipath Reconstruction. For the latter, the explanation is divided into Sequential Multipath Reconstruction (Section 5.2) and Rejection based Multipath Reconstruction (Section 5.3) for readability.

An initial partial background estimation is provided for selected locations by seed blocks S
                        
                           s
                         defined as highly-reliable background candidates. Existing approaches often establish this candidate-seed correspondence for the s locations with one cluster and, therefore, a unique candidate 
                           
                              C
                              
                                 l
                              
                              s
                           
                         for B
                        
                           s
                         is selected in such locations  (Baltieri et al., 2010; Reddy et al., 2009; 2011). When these single-candidate clusters do not exist, a major cluster
                        
                           
                              
                                 C
                                 ^
                              
                              
                                 
                                    l
                                    ′
                                 
                              
                              s
                           
                         at each spatial location s can be identified as the cluster with maximum size:

                           
                              (5)
                              
                                 
                                    
                                       
                                          C
                                          ^
                                       
                                       
                                          
                                             l
                                             ′
                                          
                                       
                                       s
                                    
                                    =
                                    
                                       C
                                       
                                          
                                             l
                                             ′
                                          
                                       
                                       s
                                    
                                    :
                                    
                                       |
                                       
                                          K
                                          
                                             
                                                l
                                                ′
                                             
                                          
                                          s
                                       
                                       |
                                    
                                    >
                                    
                                       |
                                       
                                          K
                                          
                                             l
                                          
                                          s
                                       
                                       |
                                    
                                    ,
                                    ∀
                                    l
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       N
                                       s
                                    
                                    ,
                                 
                              
                           
                        where major clusters are selected as seeds when their cardinality is equal to the maximum one for all locations 
                           
                              
                                 
                                    m
                                    a
                                    x
                                 
                                 s
                              
                              
                                 {
                                 
                                    |
                                    
                                       K
                                       
                                          
                                             l
                                             ′
                                          
                                       
                                       s
                                    
                                    |
                                 
                                 }
                              
                           
                        . However, Eq. (5) initializes few blocks where stationary objects may be temporally dominant and be wrongly selected as seeds. Errors in this initial background estimation are critical since they are propagated in the subsequent stages.

We address such limitation by proposing a unified analysis of stationarity and motion activity along training frames. We detect locations s with low motion or without stationary objects over time as suitable locations to initialize with seeds. For such detection, we assume that stationary objects occluding the background in I
                        1 are not going to remain in the same location in IT
                        . This assumption is reasonable, as objects not moving for all training frames can be considered as background. Hence, an activity score at block level ξ
                        
                           s
                         is computed as:

                           
                              (6)
                              
                                 
                                    
                                       ξ
                                       s
                                    
                                    =
                                    m
                                    a
                                    x
                                    
                                       
                                          {
                                          f
                                          
                                             (
                                             
                                                I
                                                
                                                   1
                                                
                                                p
                                             
                                             ,
                                             
                                                F
                                                p
                                             
                                             ∖
                                             
                                                {
                                                
                                                   I
                                                   
                                                      1
                                                   
                                                   p
                                                
                                                }
                                             
                                             )
                                          
                                          +
                                          f
                                          
                                             (
                                             
                                                I
                                                
                                                   T
                                                
                                                p
                                             
                                             ,
                                             
                                                F
                                                p
                                             
                                             ∖
                                             
                                                {
                                                
                                                   I
                                                   
                                                      T
                                                   
                                                   p
                                                
                                                }
                                             
                                             )
                                          
                                          }
                                       
                                       
                                          ∀
                                          
                                          p
                                          ∈
                                          s
                                       
                                    
                                    ,
                                 
                              
                           
                        
                     

where p is a pixel location; 
                           
                              
                                 F
                                 p
                              
                              ,
                              
                              
                                 I
                                 
                                    1
                                 
                                 p
                              
                           
                         and 
                           
                              I
                              
                                 T
                              
                              p
                           
                         are the gray-level pixel values at location p of the training sequence, initial and final frame, respectively; 
                           
                              
                                 F
                                 p
                              
                              ∖
                              
                                 {
                                 
                                    I
                                    
                                       1
                                    
                                    p
                                 
                                 }
                              
                           
                         and 
                           
                              
                                 F
                                 p
                              
                              ∖
                              
                                 {
                                 
                                    I
                                    
                                       T
                                    
                                    p
                                 
                                 }
                              
                           
                         are the set of training frames except the initial and final ones, respectively. The function f( ·, ·) computes the average value for the absolute pixel-level difference:

                           
                              (7)
                              
                                 
                                    f
                                    
                                       (
                                       
                                          I
                                          
                                             t
                                          
                                          p
                                       
                                       ,
                                       
                                          I
                                          p
                                       
                                       )
                                    
                                    =
                                    
                                       1
                                       
                                          |
                                          
                                             I
                                             p
                                          
                                          |
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             |
                                             
                                                I
                                                p
                                             
                                             |
                                          
                                       
                                       
                                          q
                                          =
                                          1
                                       
                                    
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   1
                                                   
                                                   i
                                                   f
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                      |
                                                      
                                                         I
                                                         
                                                            t
                                                         
                                                         p
                                                      
                                                      −
                                                      
                                                         I
                                                         
                                                            q
                                                         
                                                         p
                                                      
                                                      |
                                                   
                                                   >
                                                   τ
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   o
                                                   t
                                                   h
                                                   e
                                                   r
                                                   w
                                                   i
                                                   s
                                                   e
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 I
                                 p
                              
                              =
                              
                                 {
                                 
                                    I
                                    
                                       q
                                    
                                    p
                                 
                                 }
                              
                           
                         is a generic set of pixels at location p and τ is a detection threshold computed automatically (Kapur et al., 1985). The forward activity score 
                           
                              f
                              
                                 (
                                 
                                    I
                                    
                                       1
                                    
                                    p
                                 
                                 ,
                                 
                                    F
                                    p
                                 
                                 ∖
                                 
                                    {
                                    
                                       I
                                       
                                          1
                                       
                                       p
                                    
                                    }
                                 
                                 )
                              
                           
                         compares the pixels of the first frame against the other frames. Similarly, the backward activity score 
                           
                              f
                              
                                 (
                                 
                                    I
                                    
                                       T
                                    
                                    p
                                 
                                 ,
                                 
                                    F
                                    p
                                 
                                 ∖
                                 
                                    {
                                    
                                       I
                                       
                                          T
                                       
                                       p
                                    
                                    }
                                 
                                 )
                              
                           
                         compares the pixels of the last frame against the other frames. Finally, the initial background estimation with seeds S
                        
                           s
                         is obtained only in locations with minimum ξ
                        
                           s
                        :

                           
                              (8)
                              
                                 
                                    
                                       S
                                       s
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      C
                                                      ^
                                                   
                                                   
                                                      l
                                                   
                                                   s
                                                
                                             
                                             
                                                
                                                   i
                                                   f
                                                   
                                                   
                                                      ξ
                                                      s
                                                   
                                                   =
                                                   m
                                                   i
                                                   n
                                                   
                                                      
                                                         {
                                                         
                                                            ξ
                                                            
                                                               s
                                                               ′
                                                            
                                                         
                                                         }
                                                      
                                                      
                                                         ∀
                                                         
                                                            s
                                                            ′
                                                         
                                                         ∈
                                                         I
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ⌀
                                             
                                             
                                                
                                                   o
                                                   t
                                                   h
                                                   e
                                                   r
                                                   w
                                                   i
                                                   s
                                                   e
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 C
                                 ^
                              
                              
                                 l
                              
                              s
                           
                         is the major cluster and the empty locations s will be filled by the Multipath Reconstruction. Fig. 4 presents an example of the activity scores where locations with minimum ξ
                        
                           s
                         conform the seeds S
                        
                           s
                        . The initial partial background 
                           
                              B
                              ˜
                           
                         to be reconstructed is obtained using the seeds, i.e. 
                           
                              
                                 
                                    B
                                    ˜
                                 
                                 s
                              
                              =
                              
                                 S
                                 s
                              
                              ,
                           
                         ∀s.

This subsection describes the framework for Sequential Multipath Reconstruction (SMR) to iteratively reconstruct the background from the initial estimation (Eq. (8)).

If we consider the location index s as a bi-dimensional vector (i.e. B
                        
                           s
                         ≡ B
                        (i, j)), the 4-connected neighborhood 
                           
                              V
                              
                                 4
                              
                              s
                           
                         is defined as:

                           
                              (9)
                              
                                 
                                    
                                       V
                                       
                                          4
                                       
                                       s
                                    
                                    =
                                    
                                       {
                                       
                                          B
                                          
                                             (
                                             i
                                             −
                                             1
                                             ,
                                             j
                                             )
                                          
                                       
                                       ,
                                       
                                          B
                                          
                                             (
                                             i
                                             ,
                                             j
                                             +
                                             1
                                             )
                                          
                                       
                                       ,
                                       
                                          B
                                          
                                             (
                                             i
                                             +
                                             1
                                             ,
                                             j
                                             )
                                          
                                       
                                       ,
                                       
                                          B
                                          
                                             (
                                             i
                                             ,
                                             j
                                             −
                                             1
                                             )
                                          
                                       
                                       }
                                    
                                    ,
                                 
                              
                           
                        whereas the 8-connected neighborhood 
                           
                              V
                              
                                 8
                              
                              s
                           
                         is defined as:

                           
                              
                                 
                                    
                                       V
                                       
                                          8
                                       
                                       s
                                    
                                    
                                       =
                                       {
                                    
                                    
                                       B
                                       
                                          (
                                          i
                                          −
                                          1
                                          ,
                                          j
                                          )
                                       
                                    
                                    ,
                                    
                                       B
                                       
                                          (
                                          i
                                          −
                                          1
                                          ,
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                    ,
                                    
                                       B
                                       
                                          (
                                          i
                                          ,
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                    ,
                                    
                                       B
                                       
                                          (
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       B
                                       
                                          (
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          )
                                       
                                    
                                    ,
                                    
                                       B
                                       
                                          (
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          −
                                          1
                                          )
                                       
                                    
                                    ,
                                    
                                       B
                                       
                                          (
                                          i
                                          ,
                                          j
                                          −
                                          1
                                          )
                                       
                                    
                                    ,
                                    
                                       B
                                       
                                          (
                                          i
                                          −
                                          1
                                          ,
                                          j
                                          −
                                          1
                                          )
                                       
                                    
                                    
                                       }
                                       .
                                    
                                 
                              
                           
                        
                     

SMR starts each iteration of the background reconstruction from a partial background 
                           
                              B
                              ˜
                           
                         with empty locations. Then, SMR chooses a background block 
                           
                              
                                 B
                                 ˜
                              
                              s
                           
                         with maximum number of non-empty neighbors in 
                           
                              
                                 V
                                 
                                    8
                                 
                                 s
                              
                              ,
                           
                         where empty locations are reconstructed by m paths or hypotheses. Each path starts from one side of 
                           
                              
                                 B
                                 ˜
                              
                              s
                           
                         (top, bottom, left or right), employs a direction (clockwise or counterclockwise) and sequentially fills all empty locations 
                           
                              
                                 s
                                 ′
                              
                              ∈
                              
                                 V
                                 
                                    8
                                 
                                 s
                              
                           
                         with candidates 
                           
                              C
                              
                                 l
                              
                              
                                 s
                                 ′
                              
                           
                        . Multi-path reconstruction improves robustness against wrong candidate selections due to objects or other artifacts. Fig. 5
                        (a) shows the selected block 
                           
                              
                                 B
                                 ˜
                              
                              s
                           
                         whose neighborhood 
                           
                              V
                              
                                 8
                              
                              s
                           
                         is explored using 8 paths traversed as presented in Fig. 5(b). Some blocks already exist in each path and therefore, they are not reconstructed. Fig. 5(c) presents an example where some 
                           
                              
                                 B
                                 ˜
                              
                              s
                           
                         neighbors exist.

For each m-path, we select suitable candidates to fill empty locations by employing a fitness function Φ based on the inter-block color discontinuity in the neighborhood 
                           
                              V
                              
                                 4
                              
                              
                                 s
                                 ′
                              
                           
                         of the location to be filled:

                           
                              (11)
                              
                                 
                                    Φ
                                    
                                       (
                                       
                                          C
                                          
                                             l
                                          
                                          
                                             s
                                             ′
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       1
                                       
                                          |
                                          
                                             V
                                             
                                                4
                                             
                                             
                                                s
                                                ′
                                             
                                          
                                          |
                                       
                                    
                                    
                                       ∑
                                       
                                          
                                             s
                                             
                                                ′
                                                ′
                                             
                                          
                                          ∈
                                          
                                             V
                                             
                                                4
                                             
                                             
                                                s
                                                ′
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          1
                                          W
                                       
                                       
                                          ∑
                                          
                                             p
                                             ,
                                             
                                                p
                                                ′
                                             
                                             ∈
                                             E
                                          
                                       
                                       
                                          |
                                          
                                             C
                                             
                                                l
                                             
                                             
                                                s
                                                ′
                                             
                                          
                                          
                                             (
                                             p
                                             )
                                          
                                          −
                                          
                                             
                                                C
                                                ˜
                                             
                                             
                                                s
                                                
                                                   ′
                                                   ′
                                                
                                             
                                          
                                          
                                             (
                                             
                                                p
                                                ′
                                             
                                             )
                                          
                                          |
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        
                     

where the 
                           
                              
                                 C
                                 ˜
                              
                              
                                 s
                                 
                                    ′
                                    ′
                                 
                              
                           
                         are the already set neighbors in 
                           
                              
                                 s
                                 
                                    ′
                                    ′
                                 
                              
                              ∈
                              
                                 V
                                 
                                    4
                                 
                                 
                                    s
                                    ′
                                 
                              
                           
                         (temporary blocks selected during the path reconstruction or previously estimated 
                           
                              
                                 B
                                 ˜
                              
                              
                                 s
                                 ′
                              
                           
                        ). 
                           E
                         denotes the set of pixel locations pairs p and p′ in the border between blocks 
                           
                              C
                              
                                 l
                              
                              
                                 s
                                 ′
                              
                           
                         and 
                           
                              
                                 
                                    C
                                    ˜
                                 
                                 
                                    s
                                    
                                       ′
                                       ′
                                    
                                 
                              
                              ,
                           
                         respectively. Therefore, Φ employs 14 borders depending on the non-empty locations in 
                           
                              V
                              
                                 4
                              
                              
                                 s
                                 ′
                              
                           
                        . Fig. 6
                         shows the 
                           
                              V
                              
                                 4
                              
                              
                                 s
                                 ′
                              
                           
                         reconstruction scheme using Φ for the location 
                           
                              
                                 s
                                 ′
                              
                              ∈
                              
                                 V
                                 
                                    4
                                 
                                 s
                              
                           
                        . Fig. 6(a) presents the pixel locations considered to compare two adjacent blocks and Fig. 6(b) illustrates the 
                           
                              V
                              
                                 4
                              
                              
                                 s
                                 ′
                              
                           
                         neighborhood employed.

For each m-path, the candidate 
                           
                              
                                 C
                                 ˜
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         is selected by minimizing Φ:

                           
                              (12)
                              
                                 
                                    
                                       
                                          C
                                          ˜
                                       
                                       
                                          
                                             s
                                             ′
                                          
                                          ,
                                          m
                                       
                                    
                                    =
                                    
                                       
                                          a
                                          r
                                          g
                                          m
                                          i
                                          n
                                       
                                       
                                          ∀
                                          l
                                          ∈
                                          {
                                          1
                                          ,
                                          .
                                          .
                                          ,
                                          
                                             N
                                             
                                                s
                                                ′
                                             
                                          
                                          }
                                       
                                    
                                    
                                    
                                    Φ
                                    
                                       (
                                       
                                          C
                                          
                                             l
                                          
                                          
                                             s
                                             ′
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              m
                              ∈
                              
                                 {
                                 1
                                 …
                                 8
                                 }
                              
                           
                         and 
                           
                              
                                 C
                                 
                                    l
                                 
                                 
                                    s
                                    ′
                                 
                              
                              
                              ∀
                              l
                           
                         are the available candidates. Fig. 5(e) shows the reconstruction of 
                           
                              V
                              
                                 4
                              
                              s
                           
                         starting from the initial estimation in Fig. 5(c) where Fig. 5(d) presents a temporary 
                           
                              V
                              
                                 8
                              
                              s
                           
                         
                        single-path reconstruction.
                     

Finally, we obtain the best estimation for the 
                           
                              V
                              
                                 4
                              
                              s
                           
                         neighborhood using the 
                           
                              m
                              =
                              1
                              …
                              8
                           
                         paths. We select the best candidate 
                           
                              C
                              
                                 *
                              
                              
                                 s
                                 ′
                              
                           
                        among the temporary blocks 
                           
                              
                                 C
                                 ˜
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                        :

                           
                              (13)
                              
                                 
                                    
                                       C
                                       
                                          *
                                       
                                       
                                          s
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          a
                                          r
                                          g
                                          m
                                          i
                                          n
                                       
                                       
                                          ∀
                                          m
                                          ∈
                                          {
                                          1
                                          ,
                                          .
                                          .
                                          .
                                          ,
                                          8
                                          }
                                       
                                    
                                    
                                    
                                    Φ
                                    
                                       (
                                       
                                          
                                             C
                                             ˜
                                          
                                          
                                             
                                                s
                                                ′
                                             
                                             ,
                                             m
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              Φ
                              (
                              
                                 
                                    C
                                    ˜
                                 
                                 
                                    
                                       s
                                       ′
                                    
                                    ,
                                    m
                                 
                              
                              )
                           
                         is the Φ
value obtained by the candidate during the m-path reconstruction (Eq. (11)). As temporary blocks in 
                           
                              V
                              
                                 4
                              
                              s
                           
                         (top-center, bottom-center, middle-left and middle-right locations) employ three borders and temporary blocks in 
                           
                              V
                              
                                 8
                              
                              s
                           
                         (top-left, top-right, bottom-left and bottom-right locations) employ only two borders, we only select 
                           
                              C
                              
                                 *
                              
                              
                                 s
                                 ′
                              
                           
                         for 
                           
                              V
                              
                                 4
                              
                              s
                           
                         due to its higher reliability. Then, the process of selecting 
                           
                              
                                 B
                                 ˜
                              
                              s
                           
                         and reconstructing its 
                           
                              V
                              
                                 4
                              
                              s
                           
                         is repeated until the complete background is generated. A summary of SMR is given in Algorithm 1
                        .

SMR focuses on smoothness between adjacent blocks (external continuity, Φ similarity in Eq. (11)) and, therefore, objects far from block boundaries may be unnoticed (e.g. stationary objects). These objects may have the minimum Φ value and be wrongly selected as the best candidate (Eq. (13)). Moreover, another source of error exists as all external borders are not analyzed in 
                           
                              V
                              
                                 8
                              
                              s
                           
                         .

Extending SMR, we propose a Rejection based Multipath Reconstruction (RMR) scheme to overcome these limitations by rejecting reconstructions with high uncertainty, i.e. where some candidates 
                           
                              C
                              
                                 l
                              
                              
                                 s
                                 ′
                              
                           
                         have similar Φ value to the selected 
                           
                              C
                              
                                 *
                              
                              
                                 s
                                 ′
                              
                           
                         in Eq. (13). We disambiguate such selection by analyzing internal variations via intra-block heterogeneity Ψ and similarities to adjacent neighbors via inter-block color dissimilarity Ω. Fig. 7
                         presents the diagram of operations performed by RMR.

RMR starts from an initial background estimation 
                           
                              B
                              ˜
                           
                         containing seeds S
                        
                           s
                         and empty locations (Estimate initial background stage in Fig. 7). Then, RMR iteratively chooses a location s to reconstruct its empty neighbors via multiple paths 
                           
                              m
                              ∈
                              
                                 {
                                 1
                                 …
                                 8
                                 }
                              
                           
                         similarly to SMR (Find location 
                        s stage in Fig. 7).

For each m-path, we then obtain the best candidate 
                           
                              
                                 C
                                 ˜
                              
                              
                                 Φ
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         using Φ as in Eq. (12). To infer high uncertain selections in the location s′, a subset of candidates is obtained from the available ones 
                           
                              
                                 {
                                 
                                    C
                                    
                                       l
                                    
                                    
                                       s
                                       ′
                                    
                                 
                                 }
                              
                              
                                 l
                                 =
                                 1
                                 .
                                 .
                                 .
                                 
                                    N
                                    
                                       s
                                       ′
                                    
                                 
                              
                           
                         :

                           
                              (14)
                              
                                 
                                    
                                       C
                                       
                                          
                                             s
                                             ′
                                          
                                          ,
                                          m
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          C
                                          
                                             l
                                          
                                          
                                             s
                                             ′
                                          
                                       
                                       
                                       ∀
                                       l
                                       
                                       :
                                       
                                          |
                                          Φ
                                          
                                             (
                                             
                                                C
                                                
                                                   l
                                                
                                                
                                                   s
                                                   ′
                                                
                                             
                                             )
                                          
                                          −
                                          Φ
                                          
                                             (
                                             
                                                
                                                   C
                                                   ˜
                                                
                                                
                                                   Φ
                                                
                                                
                                                   
                                                      s
                                                      ′
                                                   
                                                   ,
                                                   m
                                                
                                             
                                             )
                                          
                                          |
                                       
                                       <
                                       ρ
                                       }
                                    
                                    ,
                                 
                              
                           
                        where ρ is a similarity threshold with a small value to obtain highly similar candidates to the best selection 
                           
                              
                                 C
                                 ˜
                              
                              
                                 Φ
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         that satisfy the smoothness constraints of the neighborhood.

To resolve such uncertainty in the selection using Φ, we employ intra-block heterogeneityΨ and inter-block color dissimilarity Ω to the subset of candidates 
                           
                              
                                 C
                                 
                                    l
                                 
                                 
                                    s
                                    ′
                                 
                              
                              ∈
                              
                                 C
                                 
                                    l
                                 
                                 
                                    
                                       s
                                       ′
                                    
                                    ,
                                    m
                                 
                              
                           
                        :

                           
                              (15)
                              
                                 
                                    Ψ
                                    
                                       (
                                       
                                          C
                                          
                                             l
                                          
                                          
                                             s
                                             ′
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          ∑
                                          64
                                       
                                       
                                          q
                                          =
                                          1
                                       
                                    
                                    
                                       
                                          |
                                          
                                             A
                                             q
                                          
                                          
                                             (
                                             
                                                C
                                                
                                                   l
                                                
                                                
                                                   s
                                                   ′
                                                
                                             
                                             )
                                          
                                          |
                                       
                                       2
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    Ω
                                    
                                       (
                                       
                                          C
                                          
                                             l
                                          
                                          
                                             s
                                             ′
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       1
                                       
                                          |
                                          
                                             V
                                             
                                                4
                                             
                                             
                                                s
                                                ′
                                             
                                          
                                          |
                                       
                                    
                                    
                                       ∑
                                       
                                          
                                             s
                                             
                                                ′
                                                ′
                                             
                                          
                                          ∈
                                          
                                             V
                                             
                                                4
                                             
                                             
                                                s
                                                ′
                                             
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   ∈
                                                   
                                                      s
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                      
                                                         ′
                                                         ′
                                                      
                                                   
                                                   ∈
                                                   
                                                      s
                                                      
                                                         ′
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    1
                                    −
                                    g
                                    
                                       (
                                       
                                          C
                                          
                                             l
                                          
                                          
                                             s
                                             ′
                                          
                                       
                                       
                                          (
                                          
                                             p
                                             ′
                                          
                                          )
                                       
                                       ,
                                       
                                          
                                             C
                                             ˜
                                          
                                          
                                             s
                                             
                                                ′
                                                ′
                                             
                                          
                                       
                                       
                                          (
                                          
                                             p
                                             
                                                ′
                                                ′
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        where Aq
                         are the coefficients of the Discrete Cosine Transform (A
                        1 is set to 0 to remove zero-frequency data) (Ahmed et al., 1974) and g( ·, ·) is the cosine similarity (Dony and Wesolkowski, 1999) between two pixels p′ and p′′ from blocks 
                           
                              C
                              
                                 l
                              
                              
                                 s
                                 ′
                              
                           
                         and 
                           
                              
                                 C
                                 ˜
                              
                              
                                 s
                                 
                                    ′
                                    ′
                                 
                              
                           
                        . Fig. 8
                         illustrates the scheme to compute Ω between blocks 
                           
                              C
                              
                                 l
                              
                              
                                 s
                                 ′
                              
                           
                         and 
                           
                              
                                 C
                                 ˜
                              
                              
                                 s
                                 
                                    ′
                                    ′
                                 
                              
                           
                        . 
                           
                              Ψ
                              (
                              
                                 C
                                 
                                    l
                                 
                                 
                                    s
                                    ′
                                 
                              
                              )
                           
                         measures the variability of RGB values for the block considered whereas 
                           
                              Ω
                              (
                              
                                 C
                                 
                                    l
                                 
                                 
                                    s
                                    ′
                                 
                              
                              )
                           
                         measures the average pixel-level difference between RGB values of pixels in 
                           
                              C
                              
                                 l
                              
                              
                                 s
                                 ′
                              
                           
                         and 
                           
                              
                                 C
                                 ˜
                              
                              
                                 s
                                 
                                    ′
                                    ′
                                 
                              
                           
                        . Fig. 9
                         presents a comparative example of the 
                           
                              V
                              
                                 4
                              
                              s
                           
                         reconstruction. SMR selects a wrong candidate when an artifact appears in Fig. 9(a) (e.g. block 
                           
                              C
                              
                                 *
                              
                              
                                 s
                                 ′
                              
                           
                         with part of a blue bus occluding the background). As the measures Ψ and Ω have high values for this artifact, RMR correctly reconstructs the background as depicted in Fig. 9(b). Note that the use of inter-block measures (Φ and Ω) minimizes discontinuities between blocks, thus reducing the block effect.

For each m-path, we apply 
                           
                              Ψ
                              (
                              
                                 C
                                 
                                    l
                                 
                                 
                                    s
                                    ′
                                 
                              
                              )
                           
                         and 
                           
                              Ω
                              (
                              
                                 C
                                 
                                    l
                                 
                                 
                                    s
                                    ′
                                 
                              
                              )
                           
                         to the subset of candidates 
                           
                              
                                 C
                                 
                                    l
                                 
                                 
                                    s
                                    ′
                                 
                              
                              ∈
                              
                                 C
                                 
                                    l
                                 
                                 
                                    
                                       s
                                       ′
                                    
                                    ,
                                    m
                                 
                              
                           
                         in order to obtain two additional best candidates 
                           
                              
                                 C
                                 ˜
                              
                              
                                 Ψ
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         and 
                           
                              
                                 C
                                 ˜
                              
                              
                                 Ω
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         as:

                           
                              (17)
                              
                                 
                                    
                                       
                                          C
                                          ˜
                                       
                                       
                                          Ψ
                                       
                                       
                                          
                                             s
                                             ′
                                          
                                          ,
                                          m
                                       
                                    
                                    =
                                    
                                       
                                          a
                                          r
                                          g
                                          m
                                          i
                                          n
                                       
                                       
                                          ∀
                                          
                                             C
                                             
                                                l
                                             
                                             
                                                s
                                                ′
                                             
                                          
                                          ∈
                                          
                                             C
                                             
                                                l
                                             
                                             
                                                s
                                                ′
                                             
                                          
                                          ,
                                          
                                          l
                                          ∈
                                          
                                             {
                                             1
                                             .
                                             .
                                             .
                                             
                                                N
                                                
                                                   s
                                                   ′
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                    
                                    Ψ
                                    
                                       (
                                       
                                          C
                                          
                                             l
                                          
                                          
                                             s
                                             ′
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    
                                       
                                          C
                                          ˜
                                       
                                       
                                          Ω
                                       
                                       
                                          
                                             s
                                             ′
                                          
                                          ,
                                          m
                                       
                                    
                                    =
                                    
                                       
                                          a
                                          r
                                          g
                                          m
                                          i
                                          n
                                       
                                       
                                          ∀
                                          
                                             C
                                             
                                                l
                                             
                                             
                                                s
                                                ′
                                             
                                          
                                          ∈
                                          
                                             C
                                             
                                                l
                                             
                                             
                                                s
                                                ′
                                             
                                          
                                          ,
                                          
                                          l
                                          ∈
                                          
                                             {
                                             1
                                             .
                                             .
                                             .
                                             
                                                N
                                                
                                                   s
                                                   ′
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                    
                                    Ω
                                    
                                       (
                                       
                                          C
                                          
                                             l
                                          
                                          
                                             s
                                             ′
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        Thus, we infer highly-uncertain candidates when the three best selections 
                           
                              
                                 
                                    C
                                    ˜
                                 
                                 
                                    Φ
                                 
                                 
                                    
                                       s
                                       ′
                                    
                                    ,
                                    m
                                 
                              
                              ,
                           
                        
                        
                           
                              
                                 C
                                 ˜
                              
                              
                                 Ψ
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         and 
                           
                              
                                 C
                                 ˜
                              
                              
                                 Ω
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         disagree (Reject reconstruction? stage in Fig. 7). Therefore, we reject the assignment of a candidate to the background when:

                           
                              (19)
                              
                                 
                                    R
                                    e
                                    j
                                    e
                                    c
                                    t
                                    i
                                    o
                                    n
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   1
                                                   
                                                   i
                                                   f
                                                
                                             
                                             
                                                
                                                   ¬
                                                   (
                                                   
                                                      
                                                         C
                                                         ˜
                                                      
                                                      
                                                         Φ
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         m
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         C
                                                         ˜
                                                      
                                                      
                                                         Ψ
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         m
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         C
                                                         ˜
                                                      
                                                      
                                                         Ω
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         m
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   o
                                                   t
                                                   h
                                                   e
                                                   r
                                                   w
                                                   i
                                                   s
                                                   e
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

This rejection identifies when the candidate 
                           
                              
                                 C
                                 ˜
                              
                              
                                 Ψ
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         is more homogeneous (low Ψ) or the candidate 
                           
                              
                                 C
                                 ˜
                              
                              
                                 Ω
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         is more similar to its neighborhood (low Ω) as compared to 
                           
                              
                                 C
                                 ˜
                              
                              
                                 Φ
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                        . Hence, no assignment is done since a more suitable candidate may be employed (
                           
                              
                                 C
                                 ˜
                              
                              
                                 Ψ
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         or 
                           
                              
                                 C
                                 ˜
                              
                              
                                 Ω
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                        ). The 
                           
                              V
                              
                                 4
                              
                              s
                           
                         reconstruction of 
                           
                              
                                 B
                                 ˜
                              
                              s
                           
                         is not performed when any m-path is rejected. Conversely, the 
                           
                              V
                              
                                 4
                              
                              s
                           
                         reconstruction is performed as for SMR when none of the m-paths is rejected.

After rejecting all remaining locations (Remaining locations in
                        
                           
                              B
                              ˜
                           
                         
                        to reject? stage in Fig. 7), we analyze these rejected locations to complete the background reconstruction. Another iterative process begins to determine the next location 
                           
                              
                                 B
                                 ˜
                              
                              s
                           
                         (Find first rejected locationstage in Fig. 7) and to select the candidate
                           
                              
                                 C
                                 ˜
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         for each m-path (Multi-candidate selection stage in Fig. 7) using a set of rules:

                           
                              (20)
                              
                                 
                                    
                                       
                                          C
                                          ˜
                                       
                                       
                                          
                                             s
                                             ′
                                          
                                          ,
                                          m
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         C
                                                         ˜
                                                      
                                                      
                                                         Φ
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         m
                                                      
                                                   
                                                   
                                                   
                                                   i
                                                   f
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         C
                                                         ˜
                                                      
                                                      
                                                         Φ
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         m
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         C
                                                         ˜
                                                      
                                                      
                                                         Ψ
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         m
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         C
                                                         ˜
                                                      
                                                      
                                                         Ω
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         C
                                                         ˜
                                                      
                                                      
                                                         Ψ
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         m
                                                      
                                                   
                                                   
                                                   
                                                   i
                                                   f
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         C
                                                         ˜
                                                      
                                                      
                                                         Φ
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         m
                                                      
                                                   
                                                   ≠
                                                   
                                                      
                                                         C
                                                         ˜
                                                      
                                                      
                                                         Ψ
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         C
                                                         ˜
                                                      
                                                      
                                                         Ω
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         m
                                                      
                                                   
                                                   
                                                   
                                                   i
                                                   f
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         C
                                                         ˜
                                                      
                                                      
                                                         Φ
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         m
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         C
                                                         ˜
                                                      
                                                      
                                                         Ψ
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         m
                                                      
                                                   
                                                   ∧
                                                   
                                                      
                                                         C
                                                         ˜
                                                      
                                                      
                                                         Ω
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         m
                                                      
                                                   
                                                   ≠
                                                   
                                                      
                                                         C
                                                         ˜
                                                      
                                                      
                                                         Φ
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        
                     

where 
                           
                              
                                 C
                                 ˜
                              
                              
                                 Φ
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         is selected when all blocks are the same, 
                           
                              
                                 C
                                 ˜
                              
                              
                                 Ψ
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         is selected when it has better homogeneity than 
                           
                              
                                 C
                                 ˜
                              
                              
                                 Φ
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         as this may denote the presence of an artifact and 
                           
                              
                                 C
                                 ˜
                              
                              
                                 Ω
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         is selected when the second condition does not occur and 
                           
                              
                                 C
                                 ˜
                              
                              
                                 Ω
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         has better color similarity than 
                           
                              
                                 C
                                 ˜
                              
                              
                                 Φ
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         with its neighbors, i.e. there is a block with better Ω denoting that 
                           
                              
                                 C
                                 ˜
                              
                              
                                 Φ
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         may contain an artifact.

After selecting the m-candidates 
                           
                              
                                 
                                    C
                                    ˜
                                 
                                 
                                    Φ
                                 
                                 
                                    
                                       s
                                       ′
                                    
                                    ,
                                    m
                                 
                              
                              ,
                           
                        
                        
                           
                              
                                 C
                                 ˜
                              
                              
                                 Ψ
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         and 
                           
                              
                                 C
                                 ˜
                              
                              
                                 Ω
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         for all m-paths in Eq. (20), we combine them to obtain the best candidate 
                           
                              C
                              
                                 *
                              
                              
                                 s
                                 ′
                              
                           
                        for the location s′:

                           
                              (21)
                              
                                 
                                    
                                       C
                                       
                                          *
                                       
                                       
                                          s
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          a
                                          r
                                          g
                                          m
                                          i
                                          n
                                       
                                       
                                          m
                                          ∈
                                          {
                                          1
                                          ,
                                          .
                                          .
                                          .
                                          ,
                                          8
                                          }
                                       
                                    
                                    
                                    
                                    Γ
                                    
                                       (
                                       
                                          
                                             C
                                             ˜
                                          
                                          
                                             Φ
                                          
                                          
                                             
                                                s
                                                ′
                                             
                                             ,
                                             m
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                             ˜
                                          
                                          
                                             Ψ
                                          
                                          
                                             
                                                s
                                                ′
                                             
                                             ,
                                             m
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                             ˜
                                          
                                          
                                             Ω
                                          
                                          
                                             
                                                s
                                                ′
                                             
                                             ,
                                             m
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        where Γ combines the Φ, Ψ
and Ωmeasures for the candidates for each m-path as:

                           
                              (22)
                              
                                 
                                    Γ
                                    
                                    =
                                    
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      Φ
                                                      ¯
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            C
                                                            ˜
                                                         
                                                         
                                                            
                                                               s
                                                               ′
                                                            
                                                            ,
                                                            m
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   i
                                                   f
                                                   
                                                   
                                                   
                                                   
                                                   
                                                      
                                                         C
                                                         ˜
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         m
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         C
                                                         ˜
                                                      
                                                      
                                                         Φ
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Φ
                                                      ¯
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            C
                                                            ˜
                                                         
                                                         
                                                            Ψ
                                                         
                                                         
                                                            
                                                               s
                                                               ′
                                                            
                                                            ,
                                                            m
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      Ψ
                                                      ¯
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            C
                                                            ˜
                                                         
                                                         
                                                            Ψ
                                                         
                                                         
                                                            
                                                               s
                                                               ′
                                                            
                                                            ,
                                                            m
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      Ω
                                                      ¯
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            C
                                                            ˜
                                                         
                                                         
                                                            Ψ
                                                         
                                                         
                                                            
                                                               s
                                                               ′
                                                            
                                                            ,
                                                            m
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                   
                                                   i
                                                   f
                                                   
                                                   
                                                   
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            C
                                                            ˜
                                                         
                                                         
                                                            
                                                               s
                                                               ′
                                                            
                                                            ,
                                                            m
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            C
                                                            ˜
                                                         
                                                         
                                                            Ψ
                                                         
                                                         
                                                            
                                                               s
                                                               ′
                                                            
                                                            ,
                                                            m
                                                         
                                                      
                                                      )
                                                   
                                                   ∧
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   (
                                                   
                                                      Ω
                                                      ¯
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            C
                                                            ˜
                                                         
                                                         
                                                            Ψ
                                                         
                                                         
                                                            
                                                               s
                                                               ′
                                                            
                                                            ,
                                                            m
                                                         
                                                      
                                                      )
                                                   
                                                   ≤
                                                   
                                                      Ω
                                                      ¯
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            C
                                                            ˜
                                                         
                                                         
                                                            Φ
                                                         
                                                         
                                                            
                                                               s
                                                               ′
                                                            
                                                            ,
                                                            m
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Φ
                                                      ¯
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            C
                                                            ˜
                                                         
                                                         
                                                            Ψ
                                                         
                                                         
                                                            
                                                               s
                                                               ′
                                                            
                                                            ,
                                                            m
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      Ψ
                                                      ¯
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            C
                                                            ˜
                                                         
                                                         
                                                            Ψ
                                                         
                                                         
                                                            
                                                               s
                                                               ′
                                                            
                                                            ,
                                                            m
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   i
                                                   f
                                                   
                                                   
                                                   
                                                   
                                                   
                                                      
                                                         C
                                                         ˜
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         m
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         C
                                                         ˜
                                                      
                                                      
                                                         Ψ
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Φ
                                                      ¯
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            C
                                                            ˜
                                                         
                                                         
                                                            Ω
                                                         
                                                         
                                                            
                                                               s
                                                               ′
                                                            
                                                            ,
                                                            m
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      Ω
                                                      ¯
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            C
                                                            ˜
                                                         
                                                         
                                                            Ω
                                                         
                                                         
                                                            
                                                               s
                                                               ′
                                                            
                                                            ,
                                                            m
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   i
                                                   f
                                                   
                                                   
                                                   
                                                   
                                                   
                                                      
                                                         C
                                                         ˜
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         m
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         C
                                                         ˜
                                                      
                                                      
                                                         Ω
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    ,
                                 
                              
                           
                        where the location 
                           
                              
                                 s
                                 ′
                              
                              ∈
                              
                                 V
                                 
                                    4
                                 
                                 s
                              
                           
                        ; 
                           
                              
                                 Φ
                                 ¯
                              
                              ,
                           
                        
                        
                           
                              Ψ
                              ¯
                           
                         and 
                           
                              Ω
                              ¯
                           
                         are the normalized measures to the range [0,1] by their maximum value for all m-paths. Each case represents a different rejection, where the first one is applied when no rejection is detected in s′, while the second, third and fourth cases apply to rejections due to Ψ and Ω, only Ψ and only Ω, respectively. This reconstruction of 
                           
                              V
                              
                                 4
                              
                              s
                           
                         updates 
                           
                              B
                              ˜
                           
                         and it is iteratively performed until the entire background 
                           
                              B
                              ˜
                           
                         is reconstructed (Background
                        
                           
                              B
                              ˜
                           
                        
                        
completed?stage in Fig. 7). The final estimated background B corresponds to the last iterative update of 
                           
                              B
                              ˜
                           
                        . A summary of RMR is presented in algorithm 2
                        .

We evaluate the temporal and spatial analysis of the proposed approach, Rejection based Multipath Reconstruction (RMR), and provide comparisons against representative state-of-the-art approaches.

For evaluation we use 29 real sequences selected from public datasets (TRECVID
                              1
                           
                           
                              1
                              
                                 http://trecvid.nist.gov/trecvid.data.html.
                              
                           , PBI
                              2
                           
                           
                              2
                              
                                 http://www.diegm.uniud.it/fusiello/demo/bkg/.
                              
                            (Colombari and Fusiello, 2010), AVSS 2007
                              3
                           
                           
                              3
                              
                                 http://www.eecs.qmul.ac.uk/~andrea/avss2007.html.
                              
                           , LIRIS 2012
                              4
                           
                           
                              4
                              
                                 http://liris.cnrs.fr/voir/activities-dataset/videoframes.html.
                              
                            (Wolf et al., 2014), CDNET 
                              5
                           
                           
                              5
                              
                                 http://changedetection.net/.
                              
                            (Wang et al., 2014), Wallflower
                              6
                           
                           
                              6
                              
                                 http://research.microsoft.com/en-us/um/people/jckrumm/WallFlower/TestImages.htm.
                              
                            (Toyama et al., 1999), LIMU
                              7
                           
                           
                              7
                              
                                 http://limu.ait.kyushu-u.ac.jp/dataset/en/.
                              
                           , CUHK
                              8
                           
                           
                              8
                              
                                 http://www.ee.cuhk.edu.hk/~xgwang/CUHK_square.html.
                              
                            (Wang et al., 2012), COST211
                              9
                           
                           
                              9
                              
                                 http://www.csd.uoc.gr/~tziritas/cost.html.
                              
                           , IDIAP
                              10
                           
                           
                              10
                              
                                 http://www.idiap.ch/~odobez/RESSOURCES/DataRelease-TrafficJunction.php.
                              
                            (Varadarajan and Odobez, 2009), PETS 2009
                              11
                           
                           
                              11
                              
                                 http://www.cvg.reading.ac.uk/PETS2009/.
                              
                            (Ellis et al., 2009), SAIVT-Campus (Xu et al., 2012)), covering different scenarios and complexities (see Fig. 10
                           ), mainly stationary objects and crowds. Ground-truth data
                              12
                           
                           
                              12
                              Software and ground-truth data available at http://www-vpu.eps.uam.es/publications/BE_RMR.
                              
                            has been manually composed from instants where the scene (or part of it) is foreground-free. Table 2
                            describes the properties of video sequences in terms of foreground Stationarity, according to size and duration; Visibility, according to duration and size of the background visualized along time; Shadows and Illumination changes, according to the amount of these photometric factors. The ID of the video sequences displayed in Table 2 is used to report results. Additionally, comparisons are provided for the SBMI2015 dataset 
                              13
                           
                           
                              13
                              
                                 http://sbmi2015.na.icar.cnr.it/SBIdataset.html.
                              
                            (Maddalena and Petrosino, 2015) that contains 7 video sequences with their ground-truth images for the task of BE.

We compute performance via six different error measures adopted from SBMI2015 (Maddalena and Petrosino, 2015). Three SBMI2015 measures employ the absolute gray-level difference Δ, which is defined for each pixel as:

                              
                                 (23)
                                 
                                    
                                       Δ
                                       
                                          (
                                          p
                                          )
                                       
                                       =
                                       
                                          
                                             |
                                             B
                                             (
                                             p
                                             )
                                             −
                                             G
                                             T
                                             (
                                             p
                                             )
                                             |
                                          
                                          Y
                                       
                                       
                                       ,
                                    
                                 
                              
                           where B and GT denote the estimated and the ground-truth backgrounds, respectively. | · |
                              Y
                            is the pixel-level absolute difference using the luminance information Y.The first measure, Average Gray-level Error (AGE), is the mean Δ value over the image. The second measure, Average of Error pixels (AE), determines pixel errors by thresholding Δ with 
                              
                                 α
                                 =
                                 20
                              
                            and computes the percentage of error pixels in the image. The third measure, Average of Clustered Error pixels (ACE), considers the average number of error pixels where their 4-connected neighbors are error pixels. The lower the value, the better performance for AGE, AE and ACE. The remaining three measures are Peak-Signal-to-Noise-Ratio (PSNR), Multi-Scale Structural Similarity index (MS-SSIM) and Color image Quality Measure (CQM). The higher the value, the better performance for these three measures.

Additionally, we propose a threshold-free error measure to avoid the threshold dependency exhibited by AE. A number of thresholds αi
                            are employed to generate a curve with the corresponding AE values where the Area Under the Curve (AUC) is reported for performance evaluation.

For the proposed approach, we use 
                              
                                 W
                                 =
                                 16
                              
                            as the block size similarly to (Baltieri et al., 2010; Reddy et al., 2009; 2011). We heuristically set 
                              
                                 k
                                 =
                                 3
                              
                            for inter-frame differences in Eq. 1 to increase the motion detected as compared to consecutive frame differences. Finally, 
                              
                                 ρ
                                 =
                                 5
                              
                            is heuristically set to select candidates with color discontinuity similar to the minimum value in Eq. 14, as they may be part of the background. Note that we use less heuristic parameters than related state-of-the-art approaches (Baltieri et al., 2010; Hsiao and Leou, 2013; Reddy et al., 2009; 2011).

We compare the proposed clustering to generate background candidates (Section 4.3) against the sequential clustering of algorithm DCT (Reddy et al., 2011), which is chosen as a top-ranked state-of-the-art result (as shown in Section 6.5). DCT clustering requires two thresholds to associate blocks into clusters; while the proposed clustering is automatic. We measure performance by inspecting whether any of the candidates 
                           
                              C
                              
                                 l
                              
                              s
                           
                         contains GT
                        
                           s
                         so the spatial analysis may be able to reconstruct the background. First, we determine the best matching between candidates and ground-truth 
                           
                              B
                              
                                 b
                                 e
                                 s
                                 t
                              
                              s
                           
                         as follows:

                           
                              (24)
                              
                                 
                                    
                                       B
                                       
                                          b
                                          e
                                          s
                                          t
                                       
                                       s
                                    
                                    =
                                    
                                       
                                          a
                                          r
                                          g
                                          m
                                          i
                                          n
                                       
                                       
                                          C
                                          
                                             l
                                          
                                          s
                                       
                                    
                                    
                                    
                                    
                                    
                                       (
                                       
                                          
                                             m
                                             a
                                             x
                                          
                                          p
                                       
                                       
                                          (
                                          Δ
                                          
                                             (
                                             
                                                C
                                                
                                                   l
                                                
                                                s
                                             
                                             
                                                (
                                                p
                                                )
                                             
                                             ,
                                             G
                                             
                                                T
                                                s
                                             
                                             
                                                (
                                                p
                                                )
                                             
                                             )
                                          
                                          )
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        Second, we compute the AE measure (
                           
                              α
                              =
                              20
                           
                        ) between 
                           
                              B
                              
                                 b
                                 e
                                 s
                                 t
                              
                              s
                           
                         and the ground-truth data. Fig. 11
                         compares mean AE performance for the proposed and selected approaches where both present similar scores, 1.157% for RMR and 0.699% for DCT. Attending to each sequence performance, both algorithms achieve low errors for all sequences except for 2 and 18, where some selected blocks of 
                           
                              B
                              
                                 b
                                 e
                                 s
                                 t
                              
                              s
                           
                         differ from the ground-truth data due to variations in the illumination and reflections, respectively. Although RMR clustering slightly reduces performance compared to DCT (Reddy et al., 2011), it has the advantage of being automatic (threshold-free), thus avoiding the adjustment needed in DCT clustering for different environments.

We compare the performance of the RMR Seed Selection with the one proposed in DCT (Reddy et al., 2011) where seed locations are selected when only a single candidate exists. As shown in Table 3
                        , RMR initializes a higher percentage of the reconstructed background 
                           
                              B
                              ˜
                           
                         (19.02%) than DCT (10.01%), measured with Reconstruction Percentage RP, i.e. amount of reconstructed blocks in the initialization, while keeping the correct selection of initial 
                           
                              
                                 B
                                 s
                              
                              ˜
                           
                         blocks, i.e. S
                        
                           s
                        , measured with AE (
                           
                              α
                              =
                              20
                           
                        ). Low RP occurs when many block locations contain variations along the training frames, which is induced by low background visibility (7, 25, 28), background variations due to shadows (2, 16) or changing backgrounds (18) and large stationary objects (5, 8 and 26). Starting with a higher amount of initialized background blocks 
                           
                              
                                 B
                                 ˜
                              
                              s
                           
                         provides more information for the iterative reconstructions which leads to improvements in the background estimation performance. Note that AE is computed over a partial reconstructed background whose average percentage RP is almost the double in RMR than in DCT, i.e. the initial estimation of the background contains more pixels and it may lead to more error pixels.

We compare RMR with SMR to show the benefits of iterative rejection. We avoid the threshold dependency of AE by computing multiple results using α ∈ [0, 30]. The overall results for all sequences are shown in Fig. 12
                         in terms of average AE. Fig. 12(a) shows that SMR and RMR present similar results for low α values whereas Fig. 12(b) indicates that RMR outperforms SMR due to its rejection capability. The Area Under the Curve (AUC) for SMR and RMR (lower area means better performance) is 392.86 and 359.13 for the evaluation interval α ∈ [0, 15] and 83.40 and 49.79 for α ∈ [15, 30].

The RMR improvement over SMR is illustrated by the examples in Fig. 13
                        , where reconstructions of 
                           
                              V
                              
                                 4
                              
                              s
                           
                         for SMR and RMR are presented. For reconstructing the blue locations, SMR selects erroneous blocks, corresponding to artifacts (stationary objects), while RMR selects proper blocks. This occurs as SMR does not cope with the lack of not analyzing external edges of 
                           
                              V
                              
                                 4
                              
                              s
                           
                         (black arrows), thus allowing discontinuities in that areas and due to failures of the fact that 
                           
                              
                                 C
                                 ˜
                              
                              
                                 Φ
                              
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         is the best candidate (as can be shown in the three examples of the figure). RMR solves these problems by analyzing Ψ and Ω of similar blocks belonging to 
                           
                              C
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         (Eq. (14)) and performing the rejection scheme.

We compare the proposed approach RMR against BE-specific approaches and top-ranked background subtraction algorithms. For BE, we select DCT (Reddy et al., 2011), the Median (MED) (Maddalena and Petrosino, 2014a), RSM (Wang and Suter, 2006) and IMBS-1 (Bloisi et al., 2014). For Background Subtraction, we use SuBSENSE (St-Charles et al., 2015), 3dSOBS+ (Maddalena and Petrosino, 2014a), Fuzzy (El Baf et al., 2008), SC-SOBS (Maddalena and Petrosino, 2012), IMBS-2 (Bloisi et al., 2014), LOBSTER (St-Charles and Bilodeau, 2014), SGMM-SOD (Evangelio et al., 2014) and two algorithms based on low-rank and sparse decomposition, LRGeomCG (Vandereycken, 2013) and FPCP (Rodriguez and Wohlberg, 2013). For these non-specific BE algorithms, we use the estimated background after processing all training frames. Note that their BE results may not reflect their performance for foreground detection. We use the BGSLibrary (Sobral and Vacavant, 2014) (Fuzzy, LOBSTER and SuBSENSE) and the LRSLibrary (Sobral et al., 2015) (LRGeomGC and FPCP). IMBS-1 uses IMBS initialization over the training frames, while IMBS-2 uses the default algorithm. We use default parameters for all approaches.


                        Fig. 14
                         compares AE performance for the threshold α ∈ [0, 30] where results are split in two intervals to improve visibility. RMR has the best performance for both threshold intervals, followed by SGMM-SOD and DCT. The first sweep of the AE threshold (α ∈ [0, 15]) presents high variation as low α values do not allow small variability with the ground-truth which should be handled as training frames may contain additive noise. Therefore, the sweep α ∈ [15, 30] is preferable to compute the performance. Table 4
                         includes further details in terms of AUC and SBMI2015 error measures. For all measures RMR outperforms state-of-the-art results, coping with stationary objects much better. Due to the variability of AE for α ∈ [0, 15], AUC from α ∈ [15, 30] better reflects the performance, being the best state-of-the-art approaches SGMM-SOD and DCT as both use smoothness constraints. Improvements can be analyzed regarding two sets of measures; the first includes AUC (significant AUC interval 
                           α ∈ [15, 30]), AGE, AE and ACE; and the second one includes MS-SSIM, PSNR and CQM. For the first set of measures, we reduce the error in a range of 10.3 % (AGE) to 25.0% (AUC) compared to SGMM-SOD. For the second set of measures, the improvement compared to SGMM-SOD ranges from 1.6% (MS-SSIM) to 6.3% (PSNR). Additionally, experiments in the SBMI2015 dataset have been carried out (see Table 5
                        ) where again the proposed approach RMR outperforms the related work and where best compared approaches are again SGMM-SOD and DCT.

In Fig. 15, sequence results are shown in terms of AUC against the DCT and SGMM-SOD approach (best related works), for α ∈ [15, 30]. As shown in Fig. 15, the proposed approach is better than DCT in 23 sequences and worse in 6, while compared to SGMM-SOD the proposed approach is better in 19 and worse in 10. The reasons of performance decrease can be compiled into failure of background smoothness assumption (sequences 4, 20 and 23), block effect (sequences 13 and 26), differences between reconstructed background and ground-truth caused by illumination changes or dynamic objects (sequences 2, 5, 12, 18, 28) and erroneous initialization in all algorithms where high error propagation occurs (sequences 1 and 25). Therefore, regarding the stationarity challenge, improvement is obtained in almost all sequences by RMR.


                        Fig. 16
                        
                         shows eight examples of the qualitative results in presence of stationarity, low visibility and camouflages issues. In these examples, unlike most of the state-of-the-art approaches, the proposed approach removes long-term stationary objects and crowds from the reconstructed background B (see 3, 4, 6, 13, 19, 24 and 29). However, video sequence 4 (CUHK) introduces erroneous white blocks due to a higher continuity of a block 
                           
                              C
                              
                                 l
                              
                              
                                 s
                                 ′
                              
                           
                         with a white car that is later propagated. Also, video sequence 25 (tramp) induces errors (also in all the compared state-of-the-art) due to the combination of several problems: inter-block color discontinuity measure Φ fails in one iteration, correct 
                           
                              C
                              
                                 l
                              
                              
                                 s
                                 ′
                              
                           
                         does not belong to 
                           
                              C
                              
                                 
                                    s
                                    ′
                                 
                                 ,
                                 m
                              
                           
                         so the failure of Φ is not handled and the blocks with foreground motion are not correctly removed due to moving regions bigger than the block size.

The comparative evaluation shows low performance of recent Background Subtraction algorithms (IMBS-2, LOBSTER, SuBSENSE, SC-SOBS, 3dSOBS+ LRGeomCG and FPCP) when applied to capture the background in situations with crowds or stationary objects. Some of these algorithms (IMBS-2, LOBSTER, SuBSENSE, 3dSOBS+ and SC-SOBS) are much faster than DCT and RMR at the cost of significant performance decreases because of the background assumptions, i.e. foreground is not representative in the training frames, which does not apply to stationary objects or crowds. Therefore, the spatial constrains introduced by RMR or DCT are needed to improve performance for background estimation in complex situations. One exception is SGMM-SOD that removes foreground ghosts based on spatial constraints, allowing a faster background update when stationary objects leave the scene. However, such update depends on the temporal duration of the stationary objects and training frames, obtaining errors when background has low visibility (see sequences 19, 24 and 29 in Fig. 16) whereas RMR does not have such duration constraints.

The computational cost of the proposed approach is mainly due to the Clustering and Multipath Reconstruction stages, that require approximately 28% and 70% of processing time. Our unoptimized MATLAB implementation of the proposed approach has an average running time of 5.3 μs/pixel (e.g. 200 color 350x240 frames in around 4.5 min). Regarding the state-of-the-art, our proposal performs faster than other approaches. For example, RPCA methods use MATLAB implementations to run in the range 9.82–476 μs/pixel (Bouwmans and Zahzah, 2014). More complex background estimation approaches report a running time ranging from 65 to 312 μs/pixel (Colombari and Fusiello, 2010; Xun and Huang, 2008), all using MATLAB. The implementation of the proposed approach is currently restricted to offline operation, however significant speedups can be achieved by using other programming languages or by parallel processing.

@&#CONCLUSIONS@&#

We presented a block-wise BE approach to estimate the background of video sequences with moving and stationary objects. A clustering approach without the need of thresholds is performed over motion-filtered and dimension reduced data, which determines the candidate blocks to be background. Subsequently, a Rejection based Multipath Reconstruction based on background smoothness constraints selects the most suitable candidate. This multipath scheme includes a Seed Selection stage to initially estimate the background which is locally reconstructed using different paths (hypotheses), thus increasing the robustness against errors. An evaluation metric based on a sweep of threshold values is proposed to avoid the threshold dependency of existing metric AE. The experiments validate the performance of the clustering analysis and the Seed Selection technique and provide comparisons against related work, demonstrating the advantages of the proposed approach. The results show that BE is highly complex since no algorithm is able to correctly perform in all situations.

As future work, we will explore the use of multi-resolution schemes, the improvement of background smoothness (e.g. by applying deblocking filters (List et al., 2003)) and the initialization-maintenance-detection interaction to improve Background Subtraction performance.

@&#ACKNOWLEDGMENT@&#

This work was partially supported by the Spanish Government (HAVideo, TEC2014-53176-R) and by the TEC department (Universidad Autónoma de Madrid).

@&#REFERENCES@&#

