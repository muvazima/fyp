@&#MAIN-TITLE@&#Surface design based on direct curvature editing

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Surface design based on direct curvature editing is introduced.


                        
                        
                           
                           A point-based curvature control is extended to a curve-based control.


                        
                        
                           
                           A log-aesthetic curve is embedded into existing design surfaces.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Curvature control

B-spline curve and surfaces

Log-aesthetic curves

Cross curvature

@&#ABSTRACT@&#


               
               
                  This paper presents a novel method for modifying the shapes of existing uniform bi-cubic B-spline surfaces by interactively editing the curvatures along isoparametric curves. The method allows us to edit the curvatures of the two intersecting isoparametric curves at each knot with specified positions, unit tangents, and unit normals. The user adjusts the radii of circles, representing the radii of curvature in the 
                        u
                      and 
                        v
                      isoparametric directions directly via a GUI without having to work with control points and knots. Such shape specifications are converted into iterative repositionings of the control points on the basis of geometrical rules. Using these point-based curvature-editing techniques, we successfully embedded log-aesthetic curves into existing surfaces along their isoparametric curves. Moreover, we were able to distribute the cross curvature with log-aesthetic variation along the isoparametric curves. We applied our technique to the design of automobile hood surfaces to demonstrate the effectiveness of our algorithms.
               
            

@&#INTRODUCTION@&#

In the field of structural mechanics, it is well known that a higher stress concentration occurs in regions with a smaller radius of curvature  [1]. The presence of such regions causes an object to experience a considerable increase in maximum stress. Therefore, engineers must design the geometry to minimize stress concentration by avoiding high curvatures. Curvature control also plays important roles in fluid dynamics. The surface curvature distribution of airfoils and blades near the leading edge is essential for optimum aerodynamic, thermoeconomic, and overall performance of turbomachinery-based power plants  [2].

In aesthetic surface design, a new design can be accelerated by the reuse of existing designs if the B-spline forms are available from previous designs, in whole or part  [3]. The designer can interactively make local modifications to the existing B-spline surfaces defined by knots and control points. However, modifying the surfaces to a desired shape via direct manipulation of knots and control points is difficult. Accordingly, researchers have developed tools that allow the user to change shapes of surfaces in an intuitive way and convert them into modifications in control points locations and knot vectors  [4]. Séquin  [5] envisioned a CAD system, in which a designer specifies boundary conditions and constraints for a car hood surface panel, and then picks a suitable cost functional, from which the system generates a desired surface via optimization.

In this paper, we introduce a novel method for modifying the shape of existing uniform bi-cubic B-spline surfaces by interactively editing the curvatures or fitting to prescribed curvature values along isoparametric curves. The point-based curvature control method allows us to edit the curvatures of two isoparametric curves at each knot with specified positions, unit tangents, and unit normals. Users adjust the radii of circles representing the radii of curvature of the 
                        u
                      and 
                        v
                      isoparametric curves via a graphical user interface (GUI), without having to work with control points and knots. Such shape specifications are converted into iterative repositionings of the control points on the basis of geometrical rules. We further extend this point-based curvature control technique to curve-based curvature control, where we successfully embedded log-aesthetic curves  [6,7] into existing surfaces.

The contributions of this paper can be summarized as follows: 
                        
                           •
                           we introduce a novel method for editing curvatures of two isoparametric curves at the knots of uniform bi-cubic B-spline surfaces;

we prove that changing the curvature of one isoparametric curve at a knot does not affect the curvature of the other intersecting isoparametric curve at the same knot as long as the position at the knot does not change;

we extend point-based curvature control to curve-based control, which allows us to embed a log-aesthetic curve into the surface together with cross curvature (see Section  4.2 for definition) control.

The rest of the paper is organized as follows. In Section  2, we review the literature on direct surface curvature editing, log-aesthetic curves, and iterative geometric interpolation algorithms. In Sections  3 and 4, we examine point-based and curved-based curvature control, respectively. In Section  5, we apply our technique to the design of automobile hood surfaces to demonstrate the effectiveness of our algorithms. In Section  6, we conclude the paper.

@&#RELATED WORK@&#

In this section we review the literature on direct surface curvature editing, log-aesthetic curves, and iterative geometric interpolation algorithms.

Andersson  [8] developed a tool for directly modifying the curvatures of surfaces by solving non-linear partial differential equations. However, his discussions were confined to surfaces expressed as graphs of real-valued functions over the plane. Furthermore, no practical examples are given in his paper, except for a sketch of procedures.

Du and Qin  [9] introduced an integrated approach that combines the partial differential equation (PDE) surfaces, and physics-based modeling techniques to allow users to interactively modify a point, normal, and curvature. The formulation results in non-linear equations, so they did not solve them precisely, but instead approximated the curvature by adjusting the distances between two neighboring points.

Eigensatz and Pauly  [10] formulated an optimization framework that allows the user to directly manipulate or preserve positional, metric, and curvature constraints anywhere on the surface of a triangular mesh model.

Nasri et al. [11] presented an algorithm for interpolating curves with prescribed cross curvature on Catmull–Clark subdivision surfaces using polygonal complexes. However, curvature control of the feature curve was not conducted.

In his review paper of CAD tools for aesthetic engineering, Séquin  [5] stated that one of the key CAD problems is the embedding of beautiful or fair curves on an optimized surface and described that the most direct connection for drawing a fair curve between two points on a smooth surface is a geodesic curve [12,13]. However, sometimes the geodesic curve may be too restrictive for design purposes, as it is necessary to solve a two-point boundary value problem to connect two points. Accordingly, a designer cannot control the curve, since it is an intrinsic curve on the freeform surface. As an alternative, he suggested a curve on a surface, whose geodesic curvature is either constant or linearly varying as a function of arc-length.

Harada et al.  [14] showed that many aesthetic curves in nature and in artificial objects exhibit monotonically varying curvature, and hence their logarithmic curvature histograms (LCH) can be approximated by straight lines. The shapes of these curves depend on the slope of LCH 
                           α
                        , so they are called log-aesthetic curves   [6]. We examined the shape of a butterfly wing, and a Japanese sword blade. Fig. 1
                        (a) depicts the common bluebottle swallowtail or blue triangle butterfly whose scientific name is Graphium sarpedon, while Fig. 1(c) shows its logarithmic curvature graph, which is defined in (32) corresponding to the red curve indicated in (b). The straight line in (c) is a least squares fit having a slope of 
                           α
                           =
                           −
                           0.44
                        . Fig. 2
                        (a)–(c) illustrates the Japanese sword blade, its boundary curves extracted by the computer vision techniques, and the logarithmic curvature graph corresponding to the red portion in (b), respectively. It is clear from Fig. 2(c) that the logarithmic curvature graph is almost a straight line having a slope of 
                           α
                           =
                           −
                           0.99
                        . Mathematical details of the logarithmic curvature graph are discussed in Section  4.3.

Furthermore, LCH of a clothoid curve (also called an Euler spiral or the spiral of Cornu) and the logarithmic spiral are straight lines with slopes of 1 and −1, respectively. The general formula for a log-aesthetic curve as a function of arc-length was derived by Miura [16]. Recently, Ziatdinov et al.  [17] introduced analytic parametric equations for log-aesthetic curves consisting of trigonometric and incomplete gamma functions. Yoshida et al.  [7] extended log-aesthetic planar curves to log-aesthetic space curves.

Recently, in contrast to the standard surface fitting methods, iterative geometric fitting methods that do not require the solution of a linear system have received attention  [18–23]. These methods employ a surprisingly simple geometric-based algorithm which iteratively updates the control points in a global manner based on a local point surface distance computation and a repositioning procedure.

Iterative geometric interpolation algorithms were introduced by Yamaguchi [18] for uniform cubic B-spline curves and surfaces; Böhm et al.  [19] for triangular splines; Lin et al.  [20] for nonuniform cubic B-spline curves and surfaces; Fan et al.  [21] for Doo–Sabin subdivision surfaces, and Maekawa et al.  [22] for Loop and Catmull–Clark subdivision surfaces. Lin  [23] proved a conjecture proposed by Maekawa et al. [22] that repositioning the control points parallel to the position error vectors interpolates the input points. Kineri et al.  [24] extended the iterative geometric interpolation algorithm to preserve the reflectional symmetry of the model while fitting the surface. This technique is important in fitting industrial products such as airplanes, trains, and automobiles that possess reflectional symmetry.

A recent study evolved the iterative geometric interpolation algorithm to interpolate a sequence of data points, unit tangent vectors, and curvature vectors  [25–27].

This section together with Section  4, constitutes the main body of this paper. In this section, we introduce point-based curvature control, and in Section  4 we study curve-based curvature control. Both curvature control methods extend the technique of interpolating a sequence of data points under tangent and curvature vectors constraints  [27] in order to directly edit the curvatures of the two intersecting isoparametric curves at knots of the uniform bi-cubic B-spline surfaces. Furthermore, in Section  3.3 we show that the curvature of the 
                        v
                     -direction feature curve is not affected by the modification of the 
                        u
                     -direction feature curve and vice versa as long as the position of the point of interest on the surface remains unchanged during the modifications. The input to our algorithm is an unclamped uniform bi-cubic B-spline surface. If the input surface is clamped, we can unclamp it using the unclamping algorithm described in  [4]. If the knot spacing is not uniform, we can adjust the knot vectors such that the spacing becomes uniform by knot insertion  [4].

Let us consider a uniform bi-cubic B-spline surface 
                           
                              r
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         with control points 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 I
                                 J
                              
                           
                         where 
                           0
                           ≤
                           I
                           ≤
                           n
                         and 
                           0
                           ≤
                           J
                           ≤
                           m
                        . There are 
                           
                              (
                              n
                              −
                              2
                              )
                           
                           ×
                           
                              (
                              m
                              −
                              2
                              )
                           
                         patches in this surface. The basis functions of uniform B-splines are based on a knot sequence that has uniform spacing, and hence they are not functions of knots. We describe the 
                           
                              (
                              i
                              ,
                              j
                              )
                           
                        -th uniform bi-cubic B-spline patch 
                           
                              
                                 
                                    r
                                 
                              
                              
                                 i
                                 j
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         shown in Fig. 3
                         as
                           
                              (1)
                              
                                 
                                    
                                       
                                          r
                                       
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             1
                                          
                                          
                                             u
                                          
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    M
                                    ]
                                 
                                 
                                    
                                       
                                          [
                                          
                                             P
                                          
                                          ]
                                       
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    
                                       
                                          [
                                          M
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    [
                                    
                                       
                                          
                                             1
                                          
                                       
                                       
                                          
                                             v
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                         where 
                           1
                           ≤
                           i
                           ≤
                           n
                           −
                           2
                           ,
                           1
                           ≤
                           j
                           ≤
                           m
                           −
                           2
                        , 
                           
                              (2)
                              
                                 
                                    [
                                    M
                                    ]
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       6
                                    
                                 
                                 
                                    [
                                    
                                       
                                          
                                             1
                                          
                                          
                                             4
                                          
                                          
                                             1
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             −
                                             3
                                          
                                          
                                             0
                                          
                                          
                                             3
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             3
                                          
                                          
                                             −
                                             6
                                          
                                          
                                             3
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             −
                                             1
                                          
                                          
                                             3
                                          
                                          
                                             −
                                             3
                                          
                                          
                                             1
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                         and the control points 
                           
                              
                                 
                                    [
                                    
                                       P
                                    
                                    ]
                                 
                              
                              
                                 i
                                 j
                              
                           
                         are defined as 
                           
                              (3)
                              
                                 
                                    
                                       
                                          [
                                          
                                             P
                                          
                                          ]
                                       
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                   j
                                                   −
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                   j
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                   j
                                                   +
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   i
                                                   j
                                                   −
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   i
                                                   j
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   i
                                                   j
                                                   +
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                   j
                                                   −
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                   j
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                   j
                                                   +
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   i
                                                   +
                                                   2
                                                   j
                                                   −
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   i
                                                   +
                                                   2
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   i
                                                   +
                                                   2
                                                   j
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   i
                                                   +
                                                   2
                                                   j
                                                   +
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                     

The 
                           v
                           =
                           0
                         isoparametric curve, which we call the 
                           u
                        -direction feature curve, is depicted in Fig. 3(a) and is given by 
                           
                              (4)
                              
                                 
                                    
                                       
                                          r
                                       
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    0
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       6
                                    
                                 
                                 
                                    [
                                    
                                       
                                          
                                             1
                                          
                                          
                                             u
                                          
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    M
                                    ]
                                 
                                 
                                    
                                       
                                          [
                                          
                                             P
                                          
                                          ]
                                       
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    [
                                    
                                       
                                          
                                             1
                                          
                                       
                                       
                                          
                                             4
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                         Since the last element of the right-most column vector is zero, the 4×4 control points reduce to 4×3 as follows: 
                           
                              
                                 (5)
                                 
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       0
                                       )
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          6
                                       
                                    
                                    
                                       [
                                       
                                          
                                             
                                                1
                                             
                                             
                                                u
                                             
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       M
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      i
                                                      −
                                                      1
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      i
                                                      −
                                                      1
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      i
                                                      −
                                                      1
                                                      j
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      i
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      i
                                                      j
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      i
                                                      +
                                                      1
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      i
                                                      +
                                                      1
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      i
                                                      +
                                                      1
                                                      j
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      i
                                                      +
                                                      2
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      i
                                                      +
                                                      2
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      i
                                                      +
                                                      2
                                                      j
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                1
                                             
                                          
                                          
                                             
                                                4
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                       ]
                                    
                                 
                              
                              
                                 (6)
                                 
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                1
                                             
                                             
                                                u
                                             
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       M
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                   
                                                   
                                                      i
                                                      −
                                                      1
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                   
                                                   
                                                      i
                                                      +
                                                      1
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                   
                                                   
                                                      i
                                                      +
                                                      2
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 i
                                 j
                              
                           
                         are the control points of the 
                           u
                        -direction feature curve given by 
                           
                              (7)
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       6
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          i
                                          j
                                          −
                                          1
                                       
                                    
                                    +
                                    4
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          i
                                          j
                                          +
                                          1
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Nasri  [28] calls the 4×3 matrix of (5) the polygonal complex to indicate simply a polygonal mesh whose limit of binary subdivision is a curve rather than a surface. Thick lines in Fig. 3(a) and (b) represent the polygonal complex.

Similarly, the control points of the 
                           v
                        -direction feature curve 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 i
                                 j
                              
                           
                        , which is depicted in Fig. 3(b), can be obtained as follows: 
                           
                              (8)
                              
                                 
                                    
                                       
                                          T
                                       
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       6
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          i
                                          −
                                          1
                                          j
                                       
                                    
                                    +
                                    4
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                          j
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

Suppose that we are given an existing B-spline surface, and want to change the curvature of the isoparametric curves at knots 
                           
                              
                                 
                                    r
                                 
                              
                              
                                 i
                                 j
                              
                           
                           
                              (
                              0
                              ,
                              0
                              )
                           
                        . In other words, we are given the position vector 
                           
                              
                                 
                                    r
                                 
                              
                              
                                 i
                                 j
                              
                           
                           
                              (
                              0
                              ,
                              0
                              )
                           
                        , the unit tangent 
                           
                              
                                 
                                    t
                                 
                              
                              
                                 i
                                 j
                              
                              
                                 u
                              
                           
                         or 
                           
                              
                                 
                                    t
                                 
                              
                              
                                 i
                                 j
                              
                              
                                 v
                              
                           
                        , and the curvature vector 
                           
                              
                                 
                                    k
                                 
                              
                              
                                 i
                                 j
                              
                              
                                 u
                              
                           
                           =
                           
                              
                                 κ
                              
                              
                                 i
                                 j
                              
                              
                                 u
                              
                           
                           
                              
                                 
                                    n
                                 
                              
                              
                                 i
                                 j
                              
                              
                                 u
                              
                           
                         or 
                           
                              
                                 
                                    k
                                 
                              
                              
                                 i
                                 j
                              
                              
                                 v
                              
                           
                           =
                           
                              
                                 κ
                              
                              
                                 i
                                 j
                              
                              
                                 v
                              
                           
                           
                              
                                 
                                    n
                                 
                              
                              
                                 i
                                 j
                              
                              
                                 v
                              
                           
                         at knots, where superscripts 
                           u
                         and 
                           v
                         denote the direction of the feature curves, and 
                           
                              
                                 κ
                              
                              
                                 i
                                 j
                              
                              
                                 u
                              
                           
                           ,
                           
                              
                                 κ
                              
                              
                                 i
                                 j
                              
                              
                                 v
                              
                           
                         and 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 i
                                 j
                              
                              
                                 u
                              
                           
                           ,
                           
                              
                                 
                                    n
                                 
                              
                              
                                 i
                                 j
                              
                              
                                 v
                              
                           
                         are the curvatures and unit normal vectors, respectively. We control the curvature values 
                           
                              
                                 κ
                              
                              
                                 i
                                 j
                              
                              
                                 u
                              
                           
                         or 
                           
                              
                                 κ
                              
                              
                                 i
                                 j
                              
                              
                                 v
                              
                           
                         of the feature curve. Our user interface uses the CallBack function of AntTweakBar, an intuitive GUI library, to adjust the magnitude of the radius of curvature of the isoparametric curve as shown in Fig. 4
                        . The numeric value of the curvature shown in the dialog box is increased or decreased by turning the circle of the RotoSlider of the AntTweakBar library. Let us consider the control of 
                           
                              
                                 κ
                              
                              
                                 i
                                 j
                              
                              
                                 u
                              
                           
                        ; the control of 
                           
                              
                                 κ
                              
                              
                                 i
                                 j
                              
                              
                                 v
                              
                           
                         can be performed similarly. First, we project the three consecutive control points of the 
                           u
                        -direction feature curve 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 i
                                 −
                                 1
                                 j
                              
                           
                           ,
                           
                              
                                 
                                    S
                                 
                              
                              
                                 i
                                 j
                              
                           
                           ,
                           
                              
                                 
                                    S
                                 
                              
                              
                                 i
                                 +
                                 1
                                 j
                              
                           
                         onto the osculating plane 
                           A
                         spanned by 
                           
                              
                                 
                                    t
                                 
                              
                              
                                 i
                                 j
                              
                              
                                 u
                              
                           
                         and 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 i
                                 j
                              
                              
                                 u
                              
                           
                         at 
                           
                              
                                 
                                    r
                                 
                              
                              
                                 i
                                 j
                              
                           
                           
                              (
                              0
                              ,
                              0
                              )
                           
                        , and denote them as 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                                 −
                                 1
                                 j
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                                 j
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                                 +
                                 1
                                 j
                              
                           
                        . Then, we have
                           
                              
                                 (9)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          −
                                          1
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          i
                                          −
                                          1
                                          j
                                       
                                    
                                    −
                                    
                                       (
                                       
                                          (
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                i
                                                −
                                                1
                                                j
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   r
                                                
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             (
                                             0
                                             ,
                                             0
                                             )
                                          
                                          )
                                       
                                       ⋅
                                       
                                          
                                             
                                                b
                                             
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             u
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          u
                                       
                                    
                                    ,
                                 
                              
                              
                                 (10)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    −
                                    
                                       (
                                       
                                          (
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   r
                                                
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             (
                                             0
                                             ,
                                             0
                                             )
                                          
                                          )
                                       
                                       ⋅
                                       
                                          
                                             
                                                b
                                             
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             u
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          u
                                       
                                    
                                    ,
                                 
                              
                              
                                 (11)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                          j
                                       
                                    
                                    −
                                    
                                       (
                                       
                                          (
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                i
                                                +
                                                1
                                                j
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   r
                                                
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             (
                                             0
                                             ,
                                             0
                                             )
                                          
                                          )
                                       
                                       ⋅
                                       
                                          
                                             
                                                b
                                             
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             u
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          u
                                       
                                    
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 
                                    b
                                 
                              
                              
                                 i
                                 j
                              
                              
                                 u
                              
                           
                           =
                           
                              
                                 
                                    t
                                 
                              
                              
                                 i
                                 j
                              
                              
                                 u
                              
                           
                           ×
                           
                              
                                 
                                    n
                                 
                              
                              
                                 i
                                 j
                              
                              
                                 u
                              
                           
                        . We interactively adjust the curvature of the isoparametric curve by changing the radius of the circle (see Fig. 4), which represents the radius of curvature 
                           1
                           /
                           
                              
                                 κ
                              
                              
                                 i
                                 j
                              
                              
                                 u
                              
                           
                        , via the following equations: 
                           
                              
                                 (12)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                          −
                                          1
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          −
                                          1
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          u
                                       
                                    
                                    
                                       (
                                       
                                          ‖
                                          
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                i
                                                +
                                                1
                                                j
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                i
                                                −
                                                1
                                                j
                                             
                                          
                                          ‖
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   12
                                                
                                                
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   
                                                      (
                                                      0
                                                      ,
                                                      0
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  S
                                                               
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         −
                                                         1
                                                         j
                                                      
                                                   
                                                   )
                                                
                                                ×
                                                
                                                   
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      u
                                                   
                                                
                                                )
                                             
                                             ⋅
                                             
                                                
                                                   
                                                      b
                                                   
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   u
                                                
                                             
                                          
                                       
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 (13)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          3
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       (
                                       0
                                       ,
                                       0
                                       )
                                    
                                    −
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          −
                                          1
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          1
                                       
                                       
                                          4
                                       
                                    
                                    
                                       ‖
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                             +
                                             1
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                             −
                                             1
                                             j
                                          
                                       
                                       ‖
                                    
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          u
                                       
                                    
                                    ,
                                 
                              
                              
                                 (14)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          −
                                          1
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          u
                                       
                                    
                                    
                                       (
                                       
                                          ‖
                                          
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                i
                                                +
                                                1
                                                j
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                i
                                                −
                                                1
                                                j
                                             
                                          
                                          ‖
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   12
                                                
                                                
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   
                                                      (
                                                      0
                                                      ,
                                                      0
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  S
                                                               
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         −
                                                         1
                                                         j
                                                      
                                                   
                                                   )
                                                
                                                ×
                                                
                                                   
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      u
                                                   
                                                
                                                )
                                             
                                             ⋅
                                             
                                                
                                                   
                                                      b
                                                   
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   u
                                                
                                             
                                          
                                       
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                                 −
                                 1
                                 j
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                                 j
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                                 +
                                 1
                                 j
                              
                           
                         are the control points after editing. The proof of convergence of this algorithm is given in  [27]. In practice, it is recommended that 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                                 −
                                 1
                                 j
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                                 j
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                                 +
                                 1
                                 j
                              
                           
                         are adjusted iteratively so that 
                           
                              ‖
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    j
                                 
                              
                              −
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    −
                                    1
                                    j
                                 
                              
                              ‖
                           
                           =
                           
                              ‖
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    j
                                 
                              
                              −
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    +
                                    1
                                    j
                                 
                              
                              ‖
                           
                         to avoid unwanted artifacts  [27].

Once the control points of the feature curve are updated, we feed back the changes to the surface control points. If we denote the repositioning vectors by 
                           
                              
                                 
                                    δ
                                 
                              
                              
                                 λ
                                 j
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 λ
                                 j
                              
                           
                           −
                           
                              
                                 
                                    S
                                 
                              
                              
                                 λ
                                 j
                              
                           
                        , where 
                           λ
                           =
                           i
                           −
                           1
                           ,
                           i
                           ,
                           i
                           +
                           1
                        , and using (7), we have 
                           
                              
                                 (15)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          λ
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          λ
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          
                                             δ
                                          
                                       
                                       
                                          λ
                                          j
                                       
                                    
                                 
                              
                              
                                 (16)
                                 
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          6
                                       
                                    
                                    
                                       (
                                       
                                          (
                                          
                                             
                                                
                                                   P
                                                
                                             
                                             
                                                λ
                                                j
                                                −
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   δ
                                                
                                             
                                             
                                                λ
                                                j
                                             
                                          
                                          )
                                       
                                       +
                                       4
                                       
                                          (
                                          
                                             
                                                
                                                   P
                                                
                                             
                                             
                                                λ
                                                j
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   δ
                                                
                                             
                                             
                                                λ
                                                j
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                
                                                   P
                                                
                                             
                                             
                                                λ
                                                j
                                                +
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   δ
                                                
                                             
                                             
                                                λ
                                                j
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                         Accordingly, the new surface control points can be written as 
                           
                              
                                 (17)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          λ
                                          j
                                          −
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          λ
                                          j
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          
                                             δ
                                          
                                       
                                       
                                          λ
                                          j
                                       
                                    
                                    ,
                                 
                              
                              
                                 (18)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          λ
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          λ
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          
                                             δ
                                          
                                       
                                       
                                          λ
                                          j
                                       
                                    
                                    ,
                                 
                              
                              
                                 (19)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          λ
                                          j
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          λ
                                          j
                                          +
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          
                                             δ
                                          
                                       
                                       
                                          λ
                                          j
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

In some situations, the user may want to change the positions 
                           
                              
                                 
                                    r
                                 
                              
                              
                                 i
                                 j
                              
                           
                           
                              (
                              0
                              ,
                              0
                              )
                           
                         at knots along the feature curve to 
                           
                              
                                 
                                    V
                                 
                              
                              
                                 i
                                 j
                              
                           
                        . In those cases we iteratively construct the sequence 
                           
                              
                                 
                                    (
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                    )
                                 
                              
                              
                                 k
                              
                           
                        
                        [18,27]: 
                           
                              (20)
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       
                                          (
                                          k
                                          +
                                          1
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 
                                    (
                                    6
                                    
                                       
                                          
                                             V
                                          
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          i
                                          −
                                          1
                                          j
                                       
                                       
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                    −
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                          j
                                       
                                       
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Farin  [29] stated that this method amounts to solving the system by Gauss–Seidel iteration, and that it will always converge.

In the following, we show that the curvature of the 
                           v
                        -direction feature curve is not affected by the modification of the 
                           u
                        -direction feature curve and vice versa as long as the position of 
                           
                              
                                 
                                    r
                                 
                              
                              
                                 i
                                 j
                              
                           
                           
                              (
                              0
                              ,
                              0
                              )
                           
                         remains unchanged during the modifications. Let us denote the control points of the curvature of the 
                           u
                        -direction feature curve after modification by 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                                 j
                              
                           
                        .

Since the position 
                           
                              
                                 
                                    r
                                 
                              
                              
                                 i
                                 j
                              
                           
                           
                              (
                              0
                              ,
                              0
                              )
                           
                         does not change before and after the curvature editing process, we can write 
                           
                              (21)
                              
                                 
                                    
                                       
                                          r
                                       
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    (
                                    0
                                    ,
                                    0
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       6
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          i
                                          −
                                          1
                                          j
                                       
                                    
                                    +
                                    4
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       6
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                          −
                                          1
                                          j
                                       
                                    
                                    +
                                    4
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                          j
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Using the repositioning vector 
                           
                              
                                 
                                    δ
                                 
                              
                              
                                 i
                                 j
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                                 j
                              
                           
                           −
                           
                              
                                 
                                    S
                                 
                              
                              
                                 i
                                 j
                              
                           
                        , (21) can be rewritten as follows: 
                           
                              (22)
                              
                                 
                                    
                                       
                                          δ
                                       
                                    
                                    
                                       i
                                       −
                                       1
                                       j
                                    
                                 
                                 +
                                 4
                                 
                                    
                                       
                                          δ
                                       
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       
                                          δ
                                       
                                    
                                    
                                       i
                                       +
                                       1
                                       j
                                    
                                 
                                 =
                                 
                                    0
                                 
                                 .
                              
                           
                        
                     

Based on (8), the control points of the 
                           v
                        -direction feature curve 
                           
                              
                                 
                                    
                                       
                                          T
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                                 j
                              
                           
                         can be expressed in terms of the control points of the modified surface 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 ̃
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       6
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                          −
                                          1
                                          j
                                       
                                    
                                    +
                                    4
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       6
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          i
                                          −
                                          1
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          
                                             δ
                                          
                                       
                                       
                                          i
                                          −
                                          1
                                          j
                                       
                                    
                                    +
                                    4
                                    
                                       (
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       +
                                       
                                          
                                             
                                                δ
                                             
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          
                                             δ
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          T
                                       
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       6
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             δ
                                          
                                       
                                       
                                          i
                                          −
                                          1
                                          j
                                       
                                    
                                    +
                                    4
                                    
                                       
                                          
                                             δ
                                          
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          
                                             δ
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          T
                                       
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 .
                              
                           
                         Similarly we can show that 
                           
                              
                                 
                                    
                                       
                                          T
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                                 j
                                 −
                                 1
                              
                           
                           =
                           
                              
                                 
                                    T
                                 
                              
                              
                                 i
                                 j
                                 −
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          T
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                                 j
                                 +
                                 1
                              
                           
                           =
                           
                              
                                 
                                    T
                                 
                              
                              
                                 i
                                 j
                                 +
                                 1
                              
                           
                        . This clearly shows that the process of curvature control of the 
                           v
                        -direction feature curve does not affect the control points of the 
                           u
                        -direction feature curve. In other words, we are able to control the curvatures in both directions independently, which is an important property in surface design. The curvature of 
                           u
                         and 
                           v
                         isoparametric curves shown in Fig. 4(a) are −6.67 and −1.63, respectively. Fig. 4(b) clearly shows that despite the curvature modification in the 
                           v
                        -direction from −1.63 to −4.22, the curvature in the 
                           u
                        -direction −6.67 remains the same after the modification.

The previous section discussed point-based curvature control, but there are many aesthetic design applications that require curvature control along the feature curves. In this section, we introduce a novel interactive method for embedding log-aesthetic curves into the surface as feature curves.

Curvature control of the feature curve requires increasing the curve’s degree of freedom  [27]. This can be done by inserting two knots in each knot span of the 
                           u
                        -knot vector alone, the 
                           v
                        -knot vector alone, or both the 
                           u
                         and the 
                           v
                         knot vectors. For the sake of generality, we study the case of ternary subdivision in both directions  [30] in the Appendix. From (A.4) the 
                           u
                        -direction feature curve of the ternary subdivided patch is given by 
                           
                              (24)
                              
                                 
                                    
                                       
                                          r
                                       
                                    
                                    
                                       k
                                       l
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    0
                                    )
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             1
                                          
                                          
                                             u
                                          
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    M
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                   l
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                
                                                
                                                   k
                                                   l
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                   l
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                
                                                
                                                   k
                                                   +
                                                   2
                                                   l
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                         where 
                           k
                           =
                           3
                           i
                           ,
                           l
                           =
                           3
                           j
                        , and 
                           
                              (25)
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       k
                                       l
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       6
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             R
                                          
                                       
                                       
                                          k
                                          l
                                          −
                                          1
                                       
                                    
                                    +
                                    4
                                    
                                       
                                          
                                             R
                                          
                                       
                                       
                                          k
                                          l
                                       
                                    
                                    +
                                    
                                       
                                          
                                             R
                                          
                                       
                                       
                                          k
                                          l
                                          +
                                          1
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Replacing the subscripts 
                           i
                         and 
                           j
                         by 
                           k
                         and 
                           l
                        , respectively, in related equations, and 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                                 j
                              
                           
                         by 
                           
                              
                                 
                                    R
                                 
                              
                              
                                 k
                                 l
                              
                           
                        , we are able to apply the point-based curvature control (12)–(14) to the red control points grouped by the dashed line as shown in Fig. 5
                        .

Suppose that we have a 
                           u
                        -direction feature curve 
                           
                              
                                 
                                    r
                                 
                              
                              
                                 i
                                 j
                              
                           
                           
                              (
                              u
                              ,
                              0
                              )
                           
                        ; there exists a 
                           u
                           =
                           0
                         isoparametric curve, which intersects the feature curve at 
                           
                              
                                 
                                    r
                                 
                              
                              
                                 i
                                 j
                              
                           
                           
                              (
                              0
                              ,
                              0
                              )
                           
                        . We call the curvature of the 
                           u
                           =
                           0
                         isoparametric curve at 
                           
                              
                                 
                                    r
                                 
                              
                              
                                 i
                                 j
                              
                           
                           
                              (
                              0
                              ,
                              0
                              )
                           
                         as cross curvature and vice versa. Nasri et al.  [11] controlled the curvature of the cross-section of the limit surface of the Catmull–Clark surface by the plane perpendicular to the limit curve at the limit point corresponding to the center control point. This is not the same as the curvature of the other isoparametric curve, which can be either smaller (if it crosses the controlled path at other than a right angle), or larger (if its osculating plane does not contain the surface normal) [11].

We can add further emphasis to the feature curve by imposing cross curvature control along it. Suppose that we have a uniform bi-cubic B-spline surface with 
                           
                              (
                              n
                              +
                              1
                              )
                           
                           ×
                           
                              (
                              m
                              +
                              1
                              )
                           
                         control points. Replacing 
                           
                              S
                           
                         by 
                           
                              T
                           
                         and the related subscripts of (9) to (19), we are able to obtain the control points of the 
                           v
                        -direction feature curves 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 i
                                 λ
                              
                           
                           ,
                           i
                           =
                           1
                           ,
                           …
                           ,
                           n
                           −
                           1
                           ,
                           λ
                           =
                           j
                           −
                           1
                           ,
                           j
                           ,
                           j
                           +
                           1
                        , which can be used to obtain the surface control points 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                                 −
                                 1
                                 λ
                              
                           
                           ,
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                                 λ
                              
                           
                           ,
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                                 +
                                 1
                                 λ
                              
                           
                           ,
                           i
                           =
                           1
                           ,
                           …
                           ,
                           n
                           −
                           1
                           ,
                           λ
                           =
                           j
                           −
                           1
                           ,
                           j
                           ,
                           j
                           +
                           1
                        , by solving the following tridiagonal matrix system: 
                           
                              (26)
                              
                                 
                                    
                                       1
                                    
                                    
                                       6
                                    
                                 
                                 
                                    [
                                    
                                       
                                          
                                             4
                                          
                                          
                                             1
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             ⋯
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             4
                                          
                                          
                                             1
                                          
                                          
                                             0
                                          
                                          
                                             ⋯
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             ⋯
                                          
                                          
                                             0
                                          
                                          
                                             1
                                          
                                          
                                             4
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             ⋯
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             1
                                          
                                          
                                             4
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   1
                                                   λ
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   2
                                                   λ
                                                
                                             
                                          
                                       
                                       
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   n
                                                   −
                                                   2
                                                   λ
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                   λ
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                
                                                
                                                   1
                                                   λ
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                      
                                                      
                                                         0
                                                         λ
                                                      
                                                   
                                                
                                                
                                                   6
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                
                                                
                                                   2
                                                   λ
                                                
                                             
                                          
                                       
                                       
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                
                                                
                                                   n
                                                   −
                                                   2
                                                   λ
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                   λ
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                      
                                                      
                                                         n
                                                         λ
                                                      
                                                   
                                                
                                                
                                                   6
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                         where the boundary control points 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 0
                                 λ
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 n
                                 λ
                              
                           
                         are obtained using (9) to (19). It is well known that a tridiagonal matrix system can be obtained in 
                           O
                           
                              (
                              n
                              )
                           
                         operations  [31]. Similarly the control points of the 
                           u
                        -direction feature curves 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 λ
                                 j
                              
                           
                         can be used in (26) to obtain the surface control points 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 λ
                                 j
                                 −
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    P
                                 
                              
                              
                                 λ
                                 j
                              
                           
                           ,
                           
                              
                                 
                                    P
                                 
                              
                              
                                 λ
                                 j
                                 +
                                 1
                              
                           
                         where 
                           λ
                           =
                           i
                           −
                           1
                           ,
                           i
                           ,
                           i
                           +
                           1
                           ,
                           j
                           =
                           1
                           ,
                           …
                           ,
                           m
                           −
                           1
                        .

A general formula for log-aesthetic curve was defined by Miura  [16] as follows: 
                              
                                 (27)
                                 
                                    log
                                    
                                       (
                                       ρ
                                       
                                          
                                             d
                                             s
                                          
                                          
                                             d
                                             ρ
                                          
                                       
                                       )
                                    
                                    =
                                    α
                                    log
                                    ρ
                                    +
                                    c
                                    ,
                                 
                              
                            where 
                              ρ
                            is the radius of curvature of the curve, 
                              α
                            and 
                              c
                            are the slope and the y-intercept, respectively of the straight line in the double logarithmic graph as shown in Fig. 6
                           . It is known that the slopes of a clothoid, a Nielsen’s spiral, a logarithmic spiral, the involute of a circle, and a circle are 
                              −
                              1
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              2
                              ,
                              ∞
                           , respectively  [17].

It is easy to derive from (27) that 
                              
                                 (28)
                                 
                                    
                                       
                                          d
                                          s
                                       
                                       
                                          d
                                          ρ
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                α
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          Λ
                                       
                                    
                                    ,
                                 
                              
                            where 
                              Λ
                              =
                              
                                 
                                    e
                                 
                                 
                                    −
                                    c
                                 
                              
                           .

Let the reference point 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    r
                                 
                              
                            be any point on the curve except for the point whose radius of curvature is either 0 or 
                              ∞
                           . The following constraints are placed at the reference point (see Fig. 7
                           )  [17]: 
                              
                                 •
                                 scaling: 
                                       ρ
                                       =
                                       1
                                     at 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             r
                                          
                                       
                                    , which means that 
                                       s
                                       =
                                       0
                                     and 
                                       θ
                                       =
                                       0
                                     at the reference point;

translation: 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             r
                                          
                                       
                                     is placed at the origin of the Cartesian coordinate system;

rotation: the tangent line to the curve at 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             r
                                          
                                       
                                     is parallel to the 
                                       x
                                    -axis.

Substituting the following relation between curvature 
                              κ
                            and tangent angle 
                              θ
                           
                           
                              
                                 (29)
                                 
                                    κ
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          ρ
                                       
                                    
                                    =
                                    
                                       
                                          d
                                          θ
                                       
                                       
                                          d
                                          s
                                       
                                    
                                    ,
                                 
                              
                            into (28), we obtain 
                              
                                 (30)
                                 
                                    
                                       
                                          d
                                          θ
                                       
                                       
                                          d
                                          ρ
                                       
                                    
                                    =
                                    
                                       
                                          d
                                          s
                                       
                                       
                                          ρ
                                          d
                                          ρ
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                α
                                                −
                                                2
                                             
                                          
                                       
                                       
                                          Λ
                                       
                                    
                                    .
                                 
                              
                            Integrating (30) with respect to 
                              θ
                            yields 
                              
                                 (31)
                                 
                                    ρ
                                    
                                       (
                                       θ
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      Λ
                                                      θ
                                                   
                                                
                                                ,
                                             
                                             
                                                α
                                                =
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            (
                                                            α
                                                            −
                                                            1
                                                            )
                                                         
                                                         Λ
                                                         θ
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            α
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                             
                                                otherwise ,
                                             
                                          
                                       
                                    
                                 
                              
                            or 
                              
                                 (32)
                                 
                                    κ
                                    
                                       (
                                       θ
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      −
                                                      Λ
                                                      θ
                                                   
                                                
                                                ,
                                             
                                             
                                                α
                                                =
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            (
                                                            α
                                                            −
                                                            1
                                                            )
                                                         
                                                         Λ
                                                         θ
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            1
                                                            −
                                                            α
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                             
                                                otherwise .
                                             
                                          
                                       
                                    
                                 
                              
                            From geometry we have 
                              
                                 (33)
                                 
                                    d
                                    x
                                    =
                                    cos
                                    θ
                                    d
                                    s
                                    ,
                                    
                                    d
                                    y
                                    =
                                    sin
                                    θ
                                    d
                                    s
                                    ,
                                 
                              
                            and 
                              d
                              s
                              =
                              ρ
                              d
                              θ
                            from (29), the parametric equation for the log-aesthetic curve is given as follows  [17]: 
                              
                                 
                                    (34)
                                    
                                       x
                                       
                                          (
                                          ψ
                                          )
                                       
                                       =
                                       
                                          
                                             ∫
                                          
                                          
                                             0
                                          
                                          
                                             ψ
                                          
                                       
                                       ρ
                                       
                                          (
                                          θ
                                          )
                                       
                                       cos
                                       
                                          (
                                          θ
                                          )
                                       
                                       d
                                       θ
                                       ,
                                    
                                 
                                 
                                    (35)
                                    
                                       y
                                       
                                          (
                                          ψ
                                          )
                                       
                                       =
                                       
                                          
                                             ∫
                                          
                                          
                                             0
                                          
                                          
                                             ψ
                                          
                                       
                                       ρ
                                       
                                          (
                                          θ
                                          )
                                       
                                       sin
                                       
                                          (
                                          θ
                                          )
                                       
                                       d
                                       θ
                                       .
                                    
                                 
                              
                           
                        

Yoshida et al.  [7] presented an interactive control method for log-aesthetic space curves whose logarithmic curvature and torsion graphs are both linear. The linearity of these graphs imposes the constraint that the curvature and torsion be monotonically varying. They determine the curve segment of the log-aesthetic curve by specifying the positions of the two endpoints, their tangents, the slopes, 
                              α
                            and 
                              β
                            of the straight lines of the logarithmic curvature and torsion graphs. The curvature parameter 
                              Λ
                            and the torsion 
                              ν
                            at the reference points are obtained through minimization  [6]. In a manner similar to that of the planar curve case, we obtain curvatures and torsions for the log-aesthetic space curves as follows:
                              
                                 
                                    (36)
                                    
                                       κ
                                       
                                          (
                                          s
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         −
                                                         Λ
                                                         s
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   α
                                                   =
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            Λ
                                                            α
                                                            s
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      
                                                         −
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               α
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    (37)
                                    
                                       τ
                                       
                                          (
                                          s
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         −
                                                         
                                                            (
                                                            Ω
                                                            s
                                                            +
                                                            log
                                                            ν
                                                            )
                                                         
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   β
                                                   =
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            Ω
                                                            β
                                                            s
                                                            +
                                                            
                                                               
                                                                  ν
                                                               
                                                               
                                                                  β
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         −
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               β
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    (38)
                                    
                                       τ
                                       
                                          (
                                          s
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         −
                                                         
                                                            (
                                                            −
                                                            Ω
                                                            s
                                                            +
                                                            log
                                                            ν
                                                            )
                                                         
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   β
                                                   =
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            −
                                                            Ω
                                                            β
                                                            s
                                                            +
                                                            
                                                               
                                                                  ν
                                                               
                                                               
                                                                  β
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         −
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               β
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   otherwise.
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            Log-aesthetic space curves are defined as curves whose functions of the radius of curvature and the radius of torsion are given by (36) and either (37) or (38), respectively. Curves defined by the intrinsic equations (36) and (37) are called type 1 curves, while those defined by (36) and (38) are called type 2 curves. The radius of curvature and the radius of torsion of type 1 curves increase monotonically with respect to arc length. In contrast, the radius of curvature of type 2 curves increases monotonically whereas their radius of torsion decreases monotonically.

If we denote the prime ′ by the differentiation with respect to the arc length, the points on the log-aesthetic space can be obtained by solving the system of first order differential equations known as the Frenet–Serret system
                              
                                 (39)
                                 
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    κ
                                    
                                       (
                                       s
                                       )
                                    
                                    
                                       n
                                    
                                    ,
                                    
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    −
                                    κ
                                    
                                       (
                                       s
                                       )
                                    
                                    
                                       t
                                    
                                    +
                                    τ
                                    
                                       (
                                       s
                                       )
                                    
                                    
                                       b
                                    
                                    ,
                                    
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    −
                                    τ
                                    
                                       (
                                       s
                                       )
                                    
                                    
                                       n
                                    
                                    ,
                                 
                              
                            together with 
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 t
                              
                              
                                 (
                                 s
                                 )
                              
                            as an initial value problem, where initial values at 
                              s
                              =
                              0
                            are given by 
                              
                                 
                                    (40)
                                    
                                       
                                          r
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                [
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ]
                                             
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                       
                                       
                                          t
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                [
                                                1
                                                ,
                                                0
                                                ,
                                                0
                                                ]
                                             
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                [
                                                0
                                                ,
                                                1
                                                ,
                                                0
                                                ]
                                             
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                       
                                       
                                          b
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                       =
                                       
                                          t
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                       ×
                                       
                                          n
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                       .
                                    
                                 
                              
                           
                        

The designer first determines the shape of the feature curve through (29) and (35) by selecting the slope 
                           α
                        , 
                           y
                        -intercept 
                           c
                         of the straight line in the double logarithmic graph, and the tangent angles at the starting point and the ending point of the feature curve, i.e. 
                           
                              
                                 θ
                              
                              
                                 s
                              
                           
                         and 
                           
                              
                                 θ
                              
                              
                                 e
                              
                           
                         adjusting the RotoSlider of the AntTweakBar library interactively as shown in Fig. 8
                        .

The ratio of the length between the starting point and the ending point of the feature curve to that of the normalized log-aesthetic curve will be the scale 
                           
                              
                                 S
                              
                              
                                 c
                              
                           
                        . The positions of the feature curve can be computed from (34) and (35) using some numerical integration scheme, e.g. Gaussian quadrature, followed by the multiplication of the scale factor 
                           
                              
                                 S
                              
                              
                                 c
                              
                           
                        .

In this section, we give an example of point-based curvature control and two examples of embedding log-aesthetic curves into an automobile hood design.


                        Fig. 9
                        (a) shows an automobile wheel well, represented by a uniform bi-cubic B-spline surface of 5×8 control points, consisting of ten patches. We apply point-based curvature control at two locations of the surface where the magnitude of Gaussian curvature values are large, namely 0.05 and −0.03 as shown in Fig. 10
                        (b). Fig. 9(b) shows the two osculating circles adjusting the radii of curvatures for an elliptic point with Gaussian curvature value of 0.05. We modify the curvatures of the two intersecting isoparametric curves at the knot from −0.20 to −0.18 in the 
                           u
                        -direction, and from −0.32 to −0.30 in the 
                           v
                        -direction in order to reduce the high curvature value yielding Gaussian curvature value of 0.04 to avoid stress concentration. Similarly we reduce the curvature value of the hyperbolic point from −0.08 to −0.06 in the 
                           u
                        -direction, and from 0.41 to 0.30 in the 
                           v
                        -direction yielding Gaussian curvature value of −0.02. Fig. 10(a) and (b) shows the wheel well and its Gaussian curvature distribution before the curvature modifications, and (c) and (d) after the curvature modifications. Here we note that the curvatures of the two isoparametric curves passing through the point are generally not equal to the principal curvatures of the surface at the point. This is the reason why the product of the two curvatures of the isoparametric lines does not agree with the Gaussian curvature. However, if the magnitude of the curvatures of the two isoparametric curves decreases, it is obvious that the magnitude of the Gaussian curvature also decreases. This is illustrated by the changes in the blue and red colors turning from the dark color (see Fig. 10(b)) to the light color (see Fig. 10(d)), which implies that the point-based curvature control is successful.

The automobile hood B-spline surface consisting of 11×11 control points shown in Fig. 11
                           (a) has a feature curve at its center, so the feature curve is a planar curve. The curvature plot as well as the osculating circles of the cross curvature along the feature curve are depicted in Fig. 11(b) and (c), respectively. The designer first determines the shape of the feature curve through (29) and (35) by selecting the slope 
                              α
                            and y-intercept 
                              c
                            of the straight line in the double logarithmic graph, and the tangent angles at the starting point and the ending point of the feature curve, i.e.  
                              
                                 
                                    θ
                                 
                                 
                                    s
                                 
                              
                            and 
                              
                                 
                                    θ
                                 
                                 
                                    e
                                 
                              
                           . The ratio of the length between the starting point and the ending point of the feature curve to that of the normalized log-aesthetic curve will be the scale 
                              
                                 
                                    S
                                 
                                 
                                    c
                                 
                              
                           . The positions of the feature curve can be computed from (34) and (35) using some numerical integration scheme, e.g. Gaussian quadrature, followed by the multiplication of the scale factor 
                              
                                 
                                    S
                                 
                                 
                                    c
                                 
                              
                           . We divide the feature curve equally by the number of spans, and evaluate the positions, unit tangents, and curvature vectors at the division points. We first interpolate the positions using (20). Since all the calculations are performed in standard form, coordinate transformation must be performed such that the position and orientation of the aesthetic curve match at the starting point of the isoparametric feature curve.

Then, we insert two knots in each span along the feature curve direction, described in the Appendix, to increase the degree of freedom in order to apply the curve-based curvature control technique. Fig. 12
                           (a) illustrates the log-aesthetic curve with 
                              α
                              =
                              0.5
                              ,
                              c
                              =
                              0.5
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    s
                                 
                              
                              =
                              0.0
                              
                              
                                 [
                                 
                                    rad
                                 
                                 ]
                              
                            and 
                              
                                 
                                    θ
                                 
                                 
                                    e
                                 
                              
                              =
                              1.2
                              
                              
                                 [
                                 
                                    rad
                                 
                                 ]
                              
                           , which is embedded into the original surface shown in Fig. 11. Fig. 12(b) is the modified surface. The curvature plot along the feature curve shown in Fig. 12(c) clearly shows that the feature curve is a monotonically varying log-aesthetic curve, whereas that of the original surface shown in Fig. 11(b) varies without any rule.

Since curvature control between two intersecting isoparametric lines is independent, we are able to conduct cross curvature control without changing the feature curve. The cross curvatures at the starting and ending points are evaluated from the existing surface. We can modify these cross curvature values at both ends, say within 10% of the magnitude. From (32) we are able to find the corresponding tangent angles 
                              
                                 
                                    θ
                                 
                                 
                                    s
                                 
                              
                            and 
                              
                                 
                                    θ
                                 
                                 
                                    e
                                 
                              
                           . Let us assume that we have 
                              N
                            spans along the feature curve, so the intermediate cross curvatures 
                              
                                 
                                    κ
                                 
                                 
                                    i
                                 
                                 
                                    c
                                    r
                                 
                              
                            can be computed as follows: 
                              
                                 
                                    (41)
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             θ
                                          
                                          
                                             s
                                          
                                       
                                       +
                                       
                                          
                                             Δ
                                             θ
                                          
                                          
                                             N
                                          
                                       
                                       i
                                       ,
                                       
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       N
                                       −
                                       1
                                       ,
                                    
                                 
                                 
                                    (42)
                                    
                                       
                                          
                                             κ
                                          
                                          
                                             i
                                          
                                          
                                             c
                                             r
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         −
                                                         Λ
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   α
                                                   =
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               (
                                                               α
                                                               −
                                                               1
                                                               )
                                                            
                                                            Λ
                                                            
                                                               
                                                                  θ
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               1
                                                               −
                                                               α
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   otherwise .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            Based on (42), we obtain the control points of the cross feature curves for each cross curvature 
                              
                                 
                                    κ
                                 
                                 
                                    i
                                 
                                 
                                    c
                                    r
                                 
                              
                            using (9) to (19). The surface control points can be obtained by solving (26). In this example 
                              α
                              =
                              1.0
                            and 
                              c
                              =
                              0.0
                            are used. Fig. 12(d) and (e) depicts the osculating circles of the cross curvatures along the feature curve where the radius of the circles vary log-aesthetically, whereas those of the original surface shown in Fig. 11(c) varies without any rule. Note that for the sake of clarity, the center of curvature is set opposite in the Figs. 11, 12, 14 and 15
                           
                           . Fig. 13(a) and (b) depicts the Gaussian curvature distribution of the surfaces of Figs. 11(a) and 12(b), respectively, which clearly show that the changes in the surface are limited only in the vicinity along the feature curve.

The automobile hood B-spline surface consisting of 20×10 control points shown in Fig. 14(a) has symmetric space feature curves. Fig. 14(b) shows the curvature plot along the left feature curve and the osculating circles of the cross curvature along the right feature curve.

The user first determines the curve segment of the log-aesthetic curve by specifying the positions of the two endpoints, their tangents, the slopes, 
                              α
                            and 
                              β
                            of straight lines of the logarithmic curvature and torsion graphs, and the torsion parameter 
                              Ω
                           . Once these input parameters are determined, one can find the intrinsic equations from (36) and (37) for a type 1 curve and from (36) and (38) for a type 2 curve. Fig. 15(a) and (b) shows the log-aesthetic curve with 
                              α
                              =
                              0.2
                              ,
                              β
                              =
                              0.7
                           , and 
                              Ω
                              =
                              0.1
                            of the type 1 curve. The shape of the space feature curve can be obtained by solving the system of first order differential equations (39) with initial values (44). The rest of the processes are the same as those for the planar feature curve. We note here that our algorithm cannot interpolate torsions at knots, and hence the resulting space curve does not reflect the torsions of the space log-aesthetic curve exactly at knots. In this example we let the cross curvature be constant along the feature curve.


                           Fig. 15(c) displays the embedded surface, while (d) shows the curvature plot along the left feature curve and the osculating circles of the cross curvature along the right feature curve of the embedded surface.

The curvature plot along the feature curve depicted in Fig. 15(d) shows clearly that the feature curve is a log-aesthetic curve, whereas that of the original surface (see Fig. 14(b)) varies without any rule. Moreover, Fig. 15(d) shows that the cross curvatures along the feature curve are constant through the constant radius of the osculating circles, whereas those of the original surface varies without any rule.

The proposed method allows us to edit the curvatures of two isoparametric curves at the knots of existing uniform bi-cubic B-spline surfaces. The positions and the directions of unit tangents and unit normals at knots can also be edited interactively, or one can use those of the predefined values. Using these point-based techniques, we successfully embedded log-aesthetic curves into existing B-spline surfaces. Moreover, we were able to distribute the cross curvature with log-aesthetic variation along the isoparametric curves, where the cross curvatures could be maintained during the feature curve editing process.

The limitations of the proposed algorithm are as follows. 
                        
                           •
                           The feature curve constraints could be imposed only on the isoparametric curve of the surface.

Although the log-aesthetic space curve is computed based on the intrinsic equations, our interpolation algorithm is not able to interpolate the torsion.

A large deformation of the feature curve from the original surface may induce unwanted bumps near the feature curves.

We hope to combine advantages of our method and so called fully free-form deformation features (
                                 δ
                              - F4) [32,33] so that we are able to extend the feature curve constraints of the isoparametric curve to an arbitrary curve on a surface.

We plan to extend the current bi-cubic B-spline surfaces to higher degree surfaces.

@&#ACKNOWLEDGMENTS@&#

This work is supported by the Japan Society for the Promotion of Science, Grants-in-Aid for Scientific Research under grant number 24360060. We would like to thank Ahmad Nasri for motivating this research, Abadulwahed Abbas and Shoichi Okaniwa for their constructive discussions at the early stage of the research, and Hiroshi Tadenuma for his assistance.

We consider the left bottom 
                        
                           
                              1
                           
                           
                              9
                           
                        
                      of the uniform bi-cubic B-spline patch 
                        0
                        ≤
                        u
                        ≤
                        
                           
                              1
                           
                           
                              3
                           
                        
                        ,
                        0
                        ≤
                        v
                        ≤
                        
                           
                              1
                           
                           
                              3
                           
                        
                      (see Fig. A.1
                     ) as follows: 
                        
                           (A.1)
                           
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    i
                                    j
                                 
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                u
                                             
                                             
                                                3
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                9
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             
                                                27
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              
                                 [
                                 M
                                 ]
                              
                              
                                 
                                    
                                       [
                                       
                                          P
                                       
                                       ]
                                    
                                 
                                 
                                    i
                                    j
                                 
                              
                              
                                 
                                    
                                       [
                                       M
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 [
                                 
                                    
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                9
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             
                                                27
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          1
                                       
                                       
                                          u
                                       
                                       
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                u
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              
                                 [
                                 M
                                 ]
                              
                              
                                 [
                                 S
                                 ]
                              
                              
                                 
                                    
                                       [
                                       
                                          P
                                       
                                       ]
                                    
                                 
                                 
                                    i
                                    j
                                 
                              
                              
                                 
                                    
                                       [
                                       S
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       [
                                       M
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 [
                                 
                                    
                                       
                                          1
                                       
                                    
                                    
                                       
                                          v
                                       
                                    
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              ,
                           
                        
                      where 
                        
                           (A.2)
                           
                              
                                 [
                                 S
                                 ]
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    27
                                 
                              
                              
                                 [
                                 
                                    
                                       
                                          10
                                       
                                       
                                          16
                                       
                                       
                                          1
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          4
                                       
                                       
                                          19
                                       
                                       
                                          4
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          16
                                       
                                       
                                          10
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          10
                                       
                                       
                                          16
                                       
                                       
                                          1
                                       
                                    
                                 
                                 ]
                              
                              .
                           
                        
                      Let 
                        
                           (A.3)
                           
                              
                                 
                                    
                                       [
                                       
                                          R
                                       
                                       ]
                                    
                                 
                                 
                                    k
                                    l
                                 
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             
                                                k
                                                −
                                                1
                                                l
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             
                                                k
                                                −
                                                1
                                                l
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             
                                                k
                                                −
                                                1
                                                l
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             
                                                k
                                                −
                                                1
                                                l
                                                +
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             
                                                k
                                                l
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             
                                                k
                                                l
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             
                                                k
                                                l
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             
                                                k
                                                l
                                                +
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             
                                                k
                                                +
                                                1
                                                l
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             
                                                k
                                                +
                                                1
                                                l
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             
                                                k
                                                +
                                                1
                                                l
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             
                                                k
                                                +
                                                1
                                                l
                                                +
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             
                                                k
                                                +
                                                2
                                                l
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             
                                                k
                                                +
                                                2
                                                l
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             
                                                k
                                                +
                                                2
                                                l
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             
                                                k
                                                +
                                                2
                                                l
                                                +
                                                2
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              =
                              
                                 [
                                 S
                                 ]
                              
                              
                                 
                                    
                                       [
                                       
                                          P
                                       
                                       ]
                                    
                                 
                                 
                                    i
                                    j
                                 
                              
                              
                                 
                                    
                                       [
                                       S
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                              ,
                           
                        
                      where 
                        k
                        =
                        3
                        i
                        ,
                        l
                        =
                        3
                        j
                     , then (A.1) can be rewritten as 
                        
                           (A.4)
                           
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    k
                                    l
                                 
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          1
                                       
                                       
                                          u
                                       
                                       
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                u
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              
                                 [
                                 M
                                 ]
                              
                              
                                 
                                    
                                       [
                                       
                                          R
                                       
                                       ]
                                    
                                 
                                 
                                    k
                                    l
                                 
                              
                              
                                 
                                    
                                       [
                                       M
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 [
                                 
                                    
                                       
                                          1
                                       
                                    
                                    
                                       
                                          v
                                       
                                    
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              .
                           
                        
                     
                  

@&#REFERENCES@&#

