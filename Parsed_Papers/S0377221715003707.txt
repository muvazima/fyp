@&#MAIN-TITLE@&#Optimal design of bilateral contracts for energy procurement

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A robust approach to the optimization of bilateral contracts in energy management.


                        
                        
                           
                           The modeling of different layers of agents operation within a smart grid environment.


                        
                        
                           
                           From the algorithmic viewpoint, the design of an algorithm that factors in long term information within a short term model.


                        
                        
                           
                           The optimization tools provide information for both strategic planning and bilateral contract design.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Distributed energy resource

Bilateral contract

Dynamic resource allocation

@&#ABSTRACT@&#


               
               
                  In this paper, we consider the problem of optimizing the portfolio of an aggregator that interacts with the energy grid via bilateral contracts. The purpose of the contracts is to achieve the pointwise procurement of energy to the grid. The challenge raised by the coordination of scattered resources and the securing of obligations over the planning horizon is addressed through a twin-time scale model, where robust short term operational decisions are contingent on long term resource usage incentives that embed the full extent of contract specifications.
               
            

A contract is said to be valid at week t if week t is within the contract’s validity period and if it has a positive number of request tokens left at the end of week t − 1. A resource contract that has announced a maintenance for week t is not valid at week t.

Contract Level information.

Projected Flow information.

set of weeks.

set of time slots in week t.

duration of time slot s ∈ S(t).

set of time slots types.

type of time slot s ∈ S(t).

set of demands (grid contracts).

set of resources (generator’s contracts).

set of valid demand contracts in time slot s ∈ S(t).

set of valid resource contracts in time slot s ∈ S(t).

set of valid and compatible demand/resource contract pairs in time slot s ∈ S(t).

set of valid resources in time slot s ∈ S(t) that are compatible with demand i.

set of valid demands in time slot s ∈ S(t) that are compatible with resource i.

set of demand contracts in time slots of type k.

subset of valid demand contracts in 
                           
                              
                                 D
                                 ^
                              
                              k
                           
                         forming the ℓth horizontal slice of the corresponding demand histogram.

number of slices in histogram associated with demand 
                           
                              
                                 D
                                 ^
                              
                              k
                           
                        .

slide indices for time slot type k: Lk
                         = [1, … , nk
                        ].

static feasibility set associated with resource set R and demand set D.

robust feasible at week t.

set of feasible demand request scenarios.

subset of feasible demand request scenarios compatible with the uniform forecast.

amount of mobilization m used in time slots of type k along the ℓth slice (to respond to simultaneous requests from demands 
                           
                              
                                 D
                                 ^
                              
                              
                                 k
                                 ℓ
                              
                           
                        ).

binary decision variable set to 1 if resource i is assigned to demand j in time slot s ∈ S(t).

binary parameters set to 1 if demand j makes a request in time slot s ∈ S(t).

upper bound on the expected number of simultaneous requests from demands 
                           
                              
                                 D
                                 ^
                              
                              
                                 k
                                 ℓ
                              
                           
                         in time slots of type k.

expected number of requests from demand j in time slots of type k.

number of request tokens for resource i at the beginning of week t.

number of requests tokens for demand j at the beginning of week t.

adjusted cost of resource i for demand j at time slot s ∈ S(t).

cost for the mobilization of resource i for one unit of time.

set of mobilizations for time slots of type k for demands in 
                           
                              
                                 D
                                 ^
                              
                              
                                 k
                                 ℓ
                              
                           
                        .

total cost of resource mobilization for mobilization m ∈ M
                        
                           kℓ.

mobilization incidence matrix associated with slice ℓ of time slot type k.

duration of time slot s ∈ S(t).

power delivered (resp. received) for resource (resp. demand) ℓ.

@&#INTRODUCTION@&#

Recent technological advances, together with adequate policies, explain the increased penetration of renewable energy in several countries (Bürer & Wüstenhagen, 2009; Moosavian, Rahim, Selvaraj, & Solangi, 2013; Timilsina, Kurdgelashvili, & Narbel, 2012). This brings issues related to reserve requirements (Matos et al., 2009), management of distributed energy (involving synchronization of excess production with the grid (Lopes, Hatziargyriou, Mutale, Djapic, & Jenkins, 2007)), security and load forecast (Mills, 2010), as well as the related financial aspects.

Distributed generators (of heat and power, for instance) can integrate the grid’s operation through ancillary services and demand-side management, providing load reduction in the advent of contingencies (Walawalkar, Fernands, Thakur, & Chevva, 2010). Alternatively, load reduction can be provided by curtailment service providers, which use aggregation to form bids on wholesale markets. However, current distribution networks do not allow for the procurement of significant amounts of energy from generators connected along the distribution network. This is mostly due to standard relays and switches architectures, which are not designed to monitor power flows in multiple directions (F. E. R. Commission, 2007).

While it is currently difficult for distributed generators to trade energy with the grid, the situation is likely to change. Indeed, the falling cost of technologies such as photovoltaic units (Bazilian et al., 2013), and the possibility of pairing them with storage units (Ru, Kleissl, & Martinez, 2013), suggest the advent of dynamic network management in the near future.

To the best of our knowledge, little has yet been achieved to address the challenges that will be faced by distributed generators that are unlikely to have direct access to wholesale markets. In this context, and inspired by current practice in demand-response management, namely the bilateral contractual structure involved in incentive programs (Moghaddam, Abdollahi, & Rashidinejad, 2011), we posit an energy aggregator that acts as a third party between the grid and distributed generators, and that provides offers to the grid via aggregation (Gkatzikis, Koutsopoulos, & Salonidis, 2013).

In our framework, we assume that the aggregator is endowed with a portfolio of internal and external bilateral contracts with its clients and the grid, respectively. Internal contracting serves as a flexible tool to adjust any client participation to the aggregator’s external activities on the grid, so that it be tailored to each client’s financial goals and specific processes. External operations may be positioned at several levels, such as ancillary services, wholesale markets or load curtailment. In the current study, we focus on the management of bilateral contracts designed for the pointwise involvement of the aggregator’s clients in the delivery of energy to the grid, in response to contingencies (spinning reserve).

Notwithstanding the fact that the settlement of bilateral contracts can be tightly coupled to bid production on the market, we do not specifically address this issue, which has been well documented in a number of recent studies (Corchero & Heredia, 2011; Pandžić, Morales, Conejo, & Kuzle, 2013). Although pool operations intervene in the aggregator’s operations, we yet believe that the management of the two-sided portfolio is important per se, and that it raises challenges that need to be addressed independently and prior to any pool activity.

The aim of this paper is to propose a model for an energy aggregator providing contingency reserve using distributed generators, and to devise an efficient algorithm for its operations, which are set in a stochastic and dynamic environment, whose time horizon typically spans several months. Due to the fact that discrete decisions are involved, the resulting multi-stage stochastic program can only be tackled for small portfolios. Alternatively, addressing the curse of dimensionality directly through statistical learning schemes (Powell, 2007) is problematic on account of the involved combinatorics. In this respect, our contribution is twofold. First, we position an energy aggregator attached to the smart grid which manages a two-sided portfolio of forward contracts, respectively with its clients and the pool. Second, we devise a two-frame model that involves a robust mixed integer short term formulation, covering the aggregator against any weekly demand scenarios, together with a long term model that captures the full extent of all contracts, based on the available configurations. On the algorithmic side, this naturally leads to an optimization framework where a long term model passes information to a short term model.

The paper is organized as follows. The problem’s formulation is presented in Section 2, while the algorithmic framework is developed in Section 3, and a numerical experiment is documented in Section 4. The conclusion is then followed by the list of notation. The conclusion is then followed by the Appendix.

In this section, we first introduce and describe the energy aggregator, the corresponding contractual framework, and the time frames underlying the activities involved. Next, we present our optimization model.

We recall that the energy aggregator manages a two-sided portfolio of bilateral contracts that involves distributed generators and the grid. A grid contract is set for an amount of power to be delivered to the grid, upon request by the grid, within the aggregator’s specific time frames. Let D be the set of grid contracts, referred to as demands in the sequel. Each demand contract j ∈ D allows for a finite number of requests from the grid 
                        
                           r
                           j
                           dem
                        
                     . The aggregator responds to any such request by forwarding it to a relevant set of contracted generators. A generator contract is set for an amount of power to be produced by the generator, upon request by the aggregator, within generator specific time frames. Let R be the set of generator contracts, referred to as resources in the sequel. Correspondingly, and for each i ∈ R, let 
                        
                           r
                           i
                           res
                        
                      be the maximum number of requests the aggregator can submit to resource i.

Energy delivery must be monitored. At the beginning of each week, before any demand request has been received, the aggregator broadcasts to all parties involved a mobilization schedule that assigns available and compatible resources to available demands, for each weekly time slot. Mobilized resources can then be used to respond to requests. We assume the following general structure for both demand and resource contracts, which involve a fixed cost to be paid in advance for the total amount of power to be delivered throughout the entire contract validity period, and variable mobilization costs on the basis of which resources are paid for their availability. We assume that the aggregator’s portfolio is fixed, hence optimization is performed with respect to mobilization costs alone. We denote by 
                        
                           C
                           i
                           mob
                        
                      the associated marginal cost of mobilizing resource i ∈ R.

The heterogeneous nature of the aggregator resources, whose underlying processes can involve hard operational constraints (ramping delay, successive requests delay) restricts the compatibility of resources and demands. The subset of resources available to meet a request from demand contract j is denoted by the set Rj
                     ⊂R. Similarly, the subset of demands for which resource i is compatible is expressed as Di
                     ⊂D. Finally, in order to manage uncertainties associated with their processes, each resource contract allows for a predefined number of maintenance periods (mi
                     )
                        i ∈ R
                     , during which the generator is not available to meet the requests.

Some key assumptions underlying the model are that (i) the aggregator has sufficient resources to meet the demand within its pool of resources; it then remains for the aggregator to minimize its costs by selecting which resources to mobilize at the current week, without putting at risk the feasibility of the portfolio in the long run, (ii) the aggregator is risk-averse, that is, resources that are mobilized at the current must have sufficient request ‘tokens’ to respond to any possible weekly request scenario, (iii) at most one request falls within any given time slot, and (iv) the mobilization schedule is fixed through the week.

Note that resource contracts are not targeted toward generators with high availability randomness, such as stand-alone PV units. Also, even though maintenance periods allows for some flexibility, we assume that they are announced at least one week in advance, while the remaining resources are reliable. This should not be too restrictive though, as PV units can be coupled with storage to provide the required reliability (Ru et al., 2013).

In this study, we consider a time horizon of several months, partitioned into a finite set T of weeks, each week t ∈ T being itself partitioned into a finite set of time slots S(t) of possibly uneven durations. Let Rts
                     ⊂R and Dts
                     ⊂D denote the subsets of contracts available and eligible for receiving or sending requests, respectively, during time slot s ∈ S(t). A contract with no remaining tokens is unavailable for the rest of the time horizon. Contract eligibility is encapsulated in notation DRts
                     ⊂Rts
                      × Dts
                     , representing the sets of compatible resource-demand couples that are available in time slot s. We denote by 
                        
                           R
                           j
                           
                              t
                              s
                           
                        
                      (resp. 
                        
                           D
                           i
                           
                              t
                              s
                           
                        
                     ) the set of available resources (resp. demands) compatible with demand j (resp. resource i) in time slot s.

We now introduce the model’s variables and constraints. Let 
                        
                           (
                           
                              x
                              
                                 i
                                 j
                              
                              
                                 t
                                 s
                              
                           
                           )
                        
                      be the mobilization schedule for week t, where 
                        
                           x
                           
                              i
                              j
                           
                           
                              t
                              s
                           
                        
                      is set to 1 if resource i is assigned to demand j in week t and time slot s ∈ S(t). The mobilization schedule must ensure that sufficient power is gathered for each demand, that is, 
                        
                           
                              x
                              
                                 t
                                 s
                              
                           
                           ∈
                           
                              X
                              pow
                           
                           
                              (
                              
                                 R
                                 
                                    t
                                    s
                                 
                              
                              ,
                              
                                 D
                                 
                                    t
                                    s
                                 
                              
                              )
                           
                           ,
                        
                      where

                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          
                                             X
                                             pow
                                          
                                          
                                             (
                                             R
                                             ,
                                             D
                                             )
                                          
                                          =
                                          
                                             {
                                             x
                                             :
                                             
                                                
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               j
                                                               
                                                               :
                                                               
                                                               (
                                                               i
                                                               ,
                                                               j
                                                               )
                                                               ∈
                                                               D
                                                               R
                                                            
                                                         
                                                         
                                                            x
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                         ≤
                                                         1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         i
                                                         ∈
                                                         R
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               i
                                                               
                                                               :
                                                               
                                                               (
                                                               i
                                                               ,
                                                               j
                                                               )
                                                               ∈
                                                               D
                                                               R
                                                            
                                                         
                                                         
                                                            power
                                                            i
                                                         
                                                         
                                                         
                                                            x
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                         ≈
                                                         
                                                            power
                                                            j
                                                         
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         j
                                                         ∈
                                                         D
                                                      
                                                   
                                                
                                             
                                             }
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     These constraints are separable by time slot. The first one ensures that each resource is assigned to at most one demand in any given time slot. In the second, the parameter power
                        j
                      in 
                        
                           R
                           ×
                           R
                        
                      is the interval of valid power levels (for demand j). The symbol ≈ specifies that demand should be approximately satisfied, i.e., up to a prespecified tolerance.

All fixed costs are assumed to be paid in advance, and any resource contract that ends with a positive number of requests represents a lost in value for the aggregator. Since the situation is similar for grid contracts, the aggregator is expected to agree on all demand requests. The aggregator’s objective is to minimize the total mobilization costs:

                        
                           (2)
                           
                              
                                 cost
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       t
                                       ∈
                                       T
                                    
                                 
                                 
                                    ∑
                                    
                                       s
                                       ∈
                                       S
                                       (
                                       t
                                       )
                                    
                                 
                                 
                                    ∑
                                    
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       ∈
                                       D
                                       
                                          R
                                          
                                             t
                                             s
                                          
                                       
                                    
                                 
                                 
                                    λ
                                    
                                       t
                                       s
                                    
                                 
                                 
                                    c
                                    i
                                    mob
                                 
                                 
                                 
                                    x
                                    
                                       i
                                       j
                                    
                                    
                                       t
                                       s
                                    
                                 
                                 ,
                              
                           
                        
                     where λts
                      is the duration of time slot s ∈ S(t).

Stochasticity impacts the aggregator’s operations at two levels: demand requests and resource maintenance. Maintenance notices are given at the beginning of the week, allowing to account for them directly within the sets Rts
                      and DRts
                     , which are thereby random. Let y be a demand scenario, such that 
                        
                           y
                           j
                           
                              t
                              s
                           
                        
                      is set to 1 if a request from demand j is received in time slot s of week t. We assume that the width of time slots is sufficiently small, so that the probability of more than one request within a single time slot is negligible. Independent of any particular assumption on the demands distribution, we must have that y ∈ Y, where

                        
                           
                              
                                 
                                    
                                       
                                          Y
                                          ⊂
                                          
                                             {
                                             
                                                y
                                                j
                                                
                                                   t
                                                   s
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                             s
                                             ∈
                                             S
                                             
                                                (
                                                t
                                                )
                                             
                                             ,
                                             j
                                             ∈
                                             
                                                D
                                                
                                                   t
                                                   s
                                                
                                             
                                             :
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   S
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                y
                                                j
                                                
                                                   t
                                                   s
                                                
                                             
                                             ≤
                                             
                                                r
                                                j
                                                dem
                                             
                                             }
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     A sequence of mobilizations (xt
                     )
                        t ∈ T
                      that covers a scenario y ∈ Y is such that

                        
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             ∑
                                             
                                                s
                                                ∈
                                                S
                                                (
                                                t
                                                )
                                             
                                          
                                          
                                             ∑
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                D
                                                
                                                   R
                                                   
                                                      t
                                                      s
                                                   
                                                
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                             
                                                t
                                                s
                                             
                                          
                                          
                                             y
                                             j
                                             
                                                t
                                                s
                                             
                                          
                                          ≤
                                          
                                             r
                                             i
                                             res
                                          
                                          ,
                                          
                                          i
                                          ∈
                                          R
                                          .
                                       
                                    
                                 
                              
                           
                        
                     The mobilization xt
                      chosen at the beginning of week t is a function of all past information 
                        
                           
                              (
                              
                                 y
                                 
                                    t
                                    ′
                                 
                              
                              )
                           
                           
                              
                                 t
                                 ′
                              
                              <
                              t
                           
                        
                      and 
                        
                           
                              
                                 (
                                 
                                    R
                                    
                                       t
                                       ′
                                    
                                 
                                 )
                              
                              
                                 
                                    t
                                    ′
                                 
                                 ≤
                                 t
                              
                           
                           ,
                        
                      and it covers the aggregator against any demand scenario at week t:

                        
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                             t
                                          
                                          
                                             (
                                             
                                                
                                                   (
                                                   
                                                      y
                                                      
                                                         t
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      t
                                                      ′
                                                   
                                                   <
                                                   t
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   (
                                                   
                                                      R
                                                      
                                                         t
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      t
                                                      ′
                                                   
                                                   ≤
                                                   t
                                                
                                             
                                             )
                                          
                                          ∈
                                          
                                             X
                                             week
                                             t
                                          
                                          
                                             (
                                             
                                                
                                                   (
                                                   
                                                      y
                                                      
                                                         t
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      t
                                                      ′
                                                   
                                                   <
                                                   t
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   (
                                                   
                                                      R
                                                      
                                                         t
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      t
                                                      ′
                                                   
                                                   ≤
                                                   t
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     where

                        
                           (3)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             X
                                             week
                                             t
                                          
                                          
                                             (
                                             
                                                
                                                   (
                                                   
                                                      y
                                                      
                                                         t
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      t
                                                      ′
                                                   
                                                   <
                                                   t
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   (
                                                   
                                                      R
                                                      
                                                         t
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      t
                                                      ′
                                                   
                                                   ≤
                                                   t
                                                
                                             
                                             )
                                          
                                          
                                             =
                                             {
                                          
                                          
                                             x
                                             
                                                t
                                                s
                                             
                                          
                                          ∈
                                          
                                             X
                                             pow
                                          
                                          
                                             (
                                             
                                                R
                                                
                                                   t
                                                   s
                                                
                                             
                                             ,
                                             
                                                D
                                                
                                                   t
                                                   s
                                                
                                             
                                             )
                                          
                                          ,
                                          
                                          s
                                          ∈
                                          S
                                          
                                             (
                                             t
                                             )
                                          
                                          :
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   t
                                                   ′
                                                
                                                ≤
                                                t
                                             
                                          
                                          
                                             ∑
                                             
                                                s
                                                ∈
                                                S
                                                (
                                                
                                                   t
                                                   ′
                                                
                                                )
                                             
                                          
                                          
                                             ∑
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                D
                                                
                                                   R
                                                   
                                                      
                                                         t
                                                         ′
                                                      
                                                      s
                                                   
                                                
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                             
                                                
                                                   t
                                                   ′
                                                
                                                s
                                             
                                          
                                          
                                             y
                                             j
                                             
                                                
                                                   t
                                                   ′
                                                
                                                s
                                             
                                          
                                          ≤
                                          
                                             r
                                             
                                                t
                                                i
                                             
                                             res
                                          
                                          
                                             ,
                                             
                                             y
                                             ∈
                                             Y
                                             ,
                                             
                                             i
                                             ∈
                                             R
                                             }
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     In the sequel, parameters 
                        
                           
                              (
                              
                                 y
                                 
                                    t
                                    ′
                                 
                              
                              )
                           
                           
                              
                                 t
                                 ′
                              
                              <
                              t
                           
                        
                      and 
                        
                           
                              (
                              
                                 R
                                 
                                    t
                                    ′
                                 
                              
                              )
                           
                           
                              
                                 t
                                 ′
                              
                              ≤
                              t
                           
                        
                      are dropped whenever the context is clear, and we simply write 
                        
                           
                              x
                              t
                           
                           ∈
                           
                              X
                              week
                              t
                           
                        
                     .

At a high level, the aggregator’s problem is expressed as the multi stage mixed integer stochastic program:

                        Program 1
                        
                           
                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   min
                                                   x
                                                
                                                
                                                E
                                                
                                                   [
                                                   cost
                                                   (
                                                   x
                                                   )
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                s.t.
                                                
                                                
                                                   x
                                                   t
                                                
                                                ∈
                                                
                                                   X
                                                   week
                                                   t
                                                
                                                
                                                t
                                                ∈
                                                T
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

As mentioned above, and implicit to the formulation is the assumption that the aggregator’s resources are a priori sufficient to cover any demand scenario: the issue is how to achieve this at minimal cost, and using a minimal amount or resources. Considering the risk-averse environment within which the aggregator operates, together with the fact that failures not only impact the aggregator’s welfare in the short term, but perhaps more importantly impact negatively his ability to secure future contracts with the grid, uncovered time slots are to be avoided at all cost, and are simply not considered. (Obviously, in practice, failure to cover a time slot will yield severe penalties for the aggregator.)

As an illustration, consider the small Portfolio 1 described in Table 1
                     , where time slots are set to days for simplicity. In Table 1, column Pow refers to energy per request; columns t
                     0 and tn
                      refer to first and last weeks of the contract, respectively; column Req refers to maximum number of requests in the contract; and columns Mon through Sun refer to weekly availability.

In Portfolio 1, either of the two resources R1 and R2 can alone cover requests from the only demand D1. Resource 1 is only available 2 days a week, while Resource 2 is available 6 days a week. Observe that while the combined resources allow for a total of 15 requests, only 10 requests can be satisfied between Wednesday and Saturday. Table 2
                      provides the data of a demand scenario history and two associated sequences of mobilization policies leading to either the failure to cover all time slots (top), or a coverage of the entire time horizon (bottom). Entries in each column correspond to a (weekly) mobilization policy (set at the beginning of the week) where either resource R1 or R2 is assigned to cover demand D1. Circles correspond to requests, and uncovered time slots are labeled with symbol ‘*’. Mobilization costs are displayed at the bottom.

Straightforward combinatorics yields that at least 4 percent of all possible request scenario cannot be covered. Indeed,

                        
                           (4)
                           
                              
                                 
                                    
                                       
                                          (
                                          
                                             60
                                             11
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             30
                                             1
                                          
                                          )
                                       
                                       +
                                       
                                          (
                                          
                                             60
                                             12
                                          
                                          )
                                       
                                    
                                    
                                       (
                                       
                                          90
                                          12
                                       
                                       )
                                    
                                 
                                 ≈
                                 0.04
                                 ,
                              
                           
                        
                     where the denominator corresponds to the number of ways the 12 demand requests fall in any one of the 6 × 15 = 90 contracted days, and the numerator is the number of ways at least 11 requests occur between Wednesday and Saturday, where only 10 requests can be satisfied by R1, the only available resource on those days.

The above analysis does not account for the weekly robustness of Program 1, which would have provided an estimate of weeks when robust weekly constraints are violated. Inspection of Portfolio 1 suggests to favor the use of R2 over R1 on Monday and Tuesday, as R1 must cover the rest of the week. To simplify the exposition, let us refer to Monday and Tuesday as day type 1 and Wednesday to Saturday as day type 2. Consider the following policy: resource R2 is mobilized on days of type 1 until a single request token is left. Next, it is mobilized each week on a single day of type 1, while resource R1 covers the rest of the week. If, on a given week, 7 requests have been received on days of type 2, and less than 2 requests on days of type 1, then R1 has 3 tokens left to cover 4 time slots (Wednesday to Saturday), on which demand D1 can still make more than 3 requests. It follows that the aggregator can no longer guarantee the feasibility of the portfolio. It is readily seen that this is the only failure under the mobilization policy, and the resulting probability of failure, given equiprobable demand scenarios, is given by the sum of the following two binomial probabilities:

                        
                           
                              
                                 
                                    
                                       
                                          p
                                          ′
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          P
                                          {
                                          7
                                          
                                          requests
                                          
                                          on
                                          
                                          day
                                          
                                          type
                                          
                                          2
                                          
                                          and
                                          
                                          0
                                          
                                          on
                                          
                                          day
                                          
                                          type
                                          
                                          1
                                          }
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             (
                                             
                                                0
                                                7
                                             
                                             )
                                          
                                          
                                             
                                                (
                                                2
                                                /
                                                3
                                                )
                                             
                                             7
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          p
                                          
                                             ′
                                             ′
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          P
                                          {
                                          7
                                          
                                          requests
                                          
                                          on
                                          
                                          day
                                          
                                          type
                                          
                                          2
                                          
                                          and
                                          
                                          1
                                          
                                          on
                                          
                                          day
                                          
                                          type
                                          
                                          1
                                          }
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             (
                                             
                                                1
                                                8
                                             
                                             )
                                          
                                          
                                             
                                                (
                                                2
                                                /
                                                3
                                                )
                                             
                                             7
                                          
                                          
                                             (
                                             1
                                             /
                                             3
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     which yield a probability of failure

                        
                           (5)
                           
                              
                                 
                                    p
                                    ′
                                 
                                 +
                                 
                                    p
                                    
                                       ′
                                       ′
                                    
                                 
                                 ≈
                                 0.21
                                 .
                              
                           
                        
                     
                  

The mathematical model takes the form of a multistage mixed integer stochastic program, and is thus algorithmically challenging. As typical forward contracts span periods between 3 months to a year, exact resolution schemes such as Ahmed, King, and Parija (2003), Lulli and Sen (2004) must be ruled out, while scenario based heuristics proposed in Løkketangen and Woodruff (1996),Carøe and Schultz (1999) involve but a small number of scenarios, which in our case are difficult to sample. Moreover, taking into account the large number of states (number of requests and maintenances left in each contract), the set of scenarios required to properly implement non-anticipativity would by far exceed our computational capabilities. It is otherwise difficult to see how approximate dynamic programming (Powell, 2007) can properly account for the problem combinatorial features.

The resolution scheme we present enforces short term feasibility of the portfolio, covering for every possible demand scenario at the current week, while making use of its resources so to best account for the full validity period of all contracts. We devise a two-time scale model in which a simpler long term model passes long term information to a short term model, where a single week of operations is considered. The two formulations are solved in sequence, over a rolling time horizon. Numerical experiments are conducted based on simulated demand and maintenance scenarios.

The short term formulation yields a robust optimization problem that involves binary decision variables, where the minimized costs are provided by the long term model. The latter is expressed as a min-cost flow problem and is based on expected amounts of demand requests that occur in various time slot types. Its solution is expressed in terms of the number of times a resource can safely be used to respond to a given demand, for a given time slot type, without jeopardizing the feasibility of the portfolio. The type of a time slot is specified by the demand and resource contracts that are online within its range.

The main simplifying assumption behind the long term formulation consists in replacing the demand stochastic process by expected number of events falling under various time slot types. (Note that such quantities may be fractional). The feasibility of a demand scenario is then independent of the exact order in which the requests are received. Its solution is used by the short term model to value the use of resources at the current week different time slots.

The rest of this section is organized as follows. In Section 3.1 we discuss robust short term feasibility. In Section 3.2 we introduce the short term model and present a preliminary heuristic to value the use of resources at the current week, which will be used as benchmark. The notion of time slot type, and the underlying static representation of the aggregators activity, is introduced in Section 3.3. Finally, the long term model is presented in Section 3.4 together with the incentives it provides to the short term formulation.

Mobilization schedules must account for every possible weekly demand scenario. For example, a resource assigned to a single demand over a full week should either (i) be assigned to no more time slots than it has request tokens, or (ii) be assigned to a demand that has at most as many request tokens as the resource does. The following result provides necessary and sufficient conditions for the covering of any weekly demand scenario in the general case, where one resource can cover multiple demands on different time slots.

                           Theorem 1
                           
                              Let
                              
                                 
                                    r
                                    
                                       t
                                       i
                                    
                                    res
                                 
                               
                              and
                              
                                 
                                    r
                                    
                                       t
                                       j
                                    
                                    dem
                                 
                               
                              are the number of requests left in resource i and demand j, respectively, at the beginning of week t. A mobilization policy
                              
                                 
                                    
                                       x
                                       t
                                    
                                    ∈
                                    
                                       X
                                       week
                                       t
                                    
                                 
                               
                              if and only if
                              
                                 
                                    
                                       x
                                       
                                          t
                                          s
                                       
                                    
                                    ∈
                                    
                                       X
                                       pow
                                    
                                    
                                       (
                                       
                                          R
                                          
                                             t
                                             s
                                          
                                       
                                       ,
                                       
                                          D
                                          
                                             t
                                             s
                                          
                                       
                                       )
                                    
                                 
                               
                              for each s ∈ S(t) and
                              
                                 
                                    (6)
                                    
                                       
                                          
                                             r
                                             
                                                t
                                                i
                                             
                                             res
                                          
                                          ≥
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   D
                                                   i
                                                
                                             
                                          
                                          min
                                          
                                             {
                                             
                                                ∑
                                                
                                                   s
                                                   :
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   ∈
                                                   D
                                                   
                                                      R
                                                      
                                                         t
                                                         s
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                                
                                                   t
                                                   s
                                                
                                             
                                             ,
                                             
                                                r
                                                
                                                   t
                                                   j
                                                
                                                dem
                                             
                                             }
                                          
                                          ,
                                          
                                          i
                                          ∈
                                          R
                                          .
                                       
                                    
                                 
                              
                           

See the Appendix.□

The above result allows the characterization of weekly feasibility through a system of linear inequalities.

                           Theorem 2
                           
                              A mobilization policy
                              
                                 
                                    
                                       x
                                       t
                                    
                                    ∈
                                    
                                       X
                                       week
                                       t
                                    
                                 
                               
                              if and only if
                              
                                 
                                    
                                       x
                                       
                                          t
                                          s
                                       
                                    
                                    ∈
                                    
                                       X
                                       pow
                                    
                                    
                                       (
                                       
                                          R
                                          
                                             t
                                             s
                                          
                                       
                                       ,
                                       
                                          D
                                          
                                             t
                                             s
                                          
                                       
                                       )
                                    
                                 
                               
                              for each s ∈ S(t) and there exist binary vectors (zij
                              ) and
                              
                                 
                                    (
                                    
                                       
                                          x
                                          ˜
                                       
                                       
                                          i
                                          j
                                       
                                       s
                                    
                                    )
                                 
                               
                              such that
                              
                                 
                                    (7)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      r
                                                      i
                                                      res
                                                   
                                                   ≥
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         
                                                            D
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         r
                                                         
                                                            t
                                                            j
                                                         
                                                         dem
                                                      
                                                      
                                                         z
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            s
                                                            :
                                                            
                                                               (
                                                               i
                                                               j
                                                               )
                                                            
                                                            ∈
                                                            D
                                                            
                                                               R
                                                               
                                                                  t
                                                                  s
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         x
                                                         
                                                            i
                                                            j
                                                         
                                                         
                                                            t
                                                            s
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            x
                                                            ˜
                                                         
                                                         
                                                            i
                                                            j
                                                         
                                                         
                                                            t
                                                            s
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                   i
                                                   ∈
                                                   R
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (8)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         s
                                                         :
                                                         
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                         
                                                         ∈
                                                         D
                                                         
                                                            R
                                                            
                                                               t
                                                               s
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      x
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                         s
                                                      
                                                   
                                                   −
                                                   
                                                      r
                                                      
                                                         t
                                                         j
                                                      
                                                      dem
                                                   
                                                   −
                                                   μ
                                                   ≤
                                                   M
                                                   
                                                      z
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   ∈
                                                   D
                                                   R
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (9)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         s
                                                         :
                                                         
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                         
                                                         ∈
                                                         D
                                                         
                                                            R
                                                            
                                                               t
                                                               s
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      x
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                         s
                                                      
                                                   
                                                   −
                                                   
                                                      r
                                                      
                                                         t
                                                         j
                                                      
                                                      dem
                                                   
                                                   ≥
                                                   −
                                                   M
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         z
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   ∈
                                                   D
                                                   R
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (10)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         ˜
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                         s
                                                      
                                                   
                                                   ≤
                                                   
                                                      x
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                         s
                                                      
                                                   
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   ∈
                                                   D
                                                   
                                                      R
                                                      
                                                         t
                                                         s
                                                      
                                                   
                                                   
                                                   s
                                                   ∈
                                                   S
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                               
                              
                                 
                                    (11)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         ˜
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                         s
                                                      
                                                   
                                                   ≤
                                                   
                                                      z
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   ∈
                                                   D
                                                   
                                                      R
                                                      
                                                         t
                                                         s
                                                      
                                                   
                                                   
                                                   s
                                                   ∈
                                                   S
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                               
                              
                                 
                                    (12)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         ˜
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                         s
                                                      
                                                   
                                                   ≥
                                                   
                                                      x
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                         s
                                                      
                                                   
                                                   +
                                                   
                                                      z
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   −
                                                   1
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   ∈
                                                   D
                                                   
                                                      R
                                                      
                                                         t
                                                         s
                                                      
                                                   
                                                   
                                                   s
                                                   ∈
                                                   S
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              from any 0 < μ < 1.
                           

See the Appendix.□

Let 
                           
                              q
                              
                                 i
                                 j
                              
                              
                                 t
                                 s
                              
                           
                         be the cost associated with the mobilization of resource i for demand j on time slot type s ∈ S(t), and consider the single stage optimization program:

                           Program 2
                           
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      min
                                                      
                                                         x
                                                         t
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         s
                                                         ∈
                                                         S
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                         ∈
                                                         D
                                                         R
                                                         (
                                                         t
                                                         ,
                                                         s
                                                         )
                                                      
                                                   
                                                   
                                                      q
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                         s
                                                      
                                                   
                                                   
                                                   
                                                      x
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                         s
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   s.t
                                                   
                                                   
                                                      x
                                                      t
                                                   
                                                   ∈
                                                   
                                                      X
                                                      week
                                                      t
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

This short term model is solved from one week to the next, over a rolling time horizon, on the basis of simulated demand requests and resource maintenances. For each week t ∈ T, the following operations are performed:

                           
                              1.
                              Simulate weekly resource maintenances 
                                    
                                       
                                          (
                                          
                                             m
                                             i
                                             t
                                          
                                          )
                                       
                                       
                                          i
                                          ∈
                                          
                                             R
                                             t
                                          
                                       
                                    
                                 .

Update the available resource sets on account of activated maintenance periods:

                                    
                                       
                                          
                                             
                                                R
                                                
                                                   t
                                                   s
                                                
                                             
                                             =
                                             
                                                {
                                                i
                                                ∈
                                                
                                                   R
                                                   
                                                      t
                                                      s
                                                   
                                                
                                                
                                                :
                                                
                                                
                                                   m
                                                   
                                                      i
                                                   
                                                   t
                                                
                                                =
                                                1
                                                }
                                             
                                             ,
                                             
                                             s
                                             ∈
                                             S
                                             
                                                (
                                                t
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              

Set the coefficients of the short term model objective (Program 2) according to long term information (Equations (13) or (24) in the sequel).

Solve the short term model and broadcast the optimal mobilization x obtained from the solution of Program 2.

Simulate weekly demand requests (yts
                                 )
                                    s ∈ S(t).

Update contract states:

                                    
                                       
                                          
                                             
                                                
                                                   
                                                      r
                                                      
                                                         t
                                                         +
                                                         1
                                                         
                                                         j
                                                      
                                                      dem
                                                   
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      
                                                         r
                                                         
                                                            t
                                                            j
                                                         
                                                         dem
                                                      
                                                      −
                                                      
                                                         ∑
                                                         
                                                            s
                                                            ∈
                                                            S
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                      
                                                         y
                                                         j
                                                         
                                                            t
                                                            s
                                                         
                                                      
                                                      ,
                                                      
                                                      j
                                                      ∈
                                                      
                                                         D
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      r
                                                      
                                                         t
                                                         +
                                                         1
                                                         
                                                         i
                                                      
                                                      res
                                                   
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      
                                                         r
                                                         
                                                            t
                                                            i
                                                         
                                                         res
                                                      
                                                      −
                                                      
                                                         ∑
                                                         
                                                            s
                                                            ∈
                                                            S
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            j
                                                            ∈
                                                            
                                                               D
                                                               t
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         x
                                                         
                                                            i
                                                            j
                                                         
                                                         
                                                            t
                                                            s
                                                         
                                                      
                                                      
                                                         y
                                                         j
                                                         
                                                            t
                                                            s
                                                         
                                                      
                                                      ,
                                                      
                                                      i
                                                      ∈
                                                      
                                                         R
                                                         t
                                                      
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

Remove fulfilled contract from the availability lists:

                                    
                                       
                                          
                                             
                                                
                                                   
                                                      R
                                                      
                                                         t
                                                         +
                                                         1
                                                         
                                                         s
                                                      
                                                   
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      {
                                                      i
                                                      ∈
                                                      
                                                         R
                                                         
                                                            t
                                                            s
                                                         
                                                      
                                                      :
                                                      
                                                         r
                                                         
                                                            t
                                                            i
                                                         
                                                         res
                                                      
                                                      >
                                                      0
                                                      }
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      D
                                                      
                                                         t
                                                         +
                                                         1
                                                         
                                                         s
                                                      
                                                   
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      
                                                         {
                                                         i
                                                         ∈
                                                         
                                                            D
                                                            
                                                               t
                                                               s
                                                            
                                                         
                                                         :
                                                         
                                                            r
                                                            
                                                               t
                                                               i
                                                            
                                                            dem
                                                         
                                                         >
                                                         0
                                                         }
                                                      
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

Before introducing the long term model in the next section, let us consider the following simple scheme to set the coefficients in the objective of Program 2. The Contract Level (CL) information is defined as

                           
                              (13)
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          t
                                          s
                                       
                                    
                                    =
                                    
                                       
                                          r
                                          
                                             t
                                             j
                                          
                                          dem
                                       
                                       −
                                       
                                          r
                                          
                                             t
                                             i
                                          
                                          res
                                       
                                    
                                    
                                    t
                                    ∈
                                    T
                                    ,
                                    
                                    s
                                    ∈
                                    S
                                    
                                       (
                                       t
                                       )
                                    
                                    ,
                                    
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    ∈
                                    D
                                    
                                       R
                                       
                                          t
                                          s
                                       
                                    
                                    ,
                                 
                              
                           
                        and can be used to detect the resources having an amount of request tokens that exceeds the demand for which they are mobilized, the rational being that an uncovered time slot can only arise if at least one resource runs out of tokens before a demand.

The CL information is evaluated at week t = 1 for Portfolio 1 (Tables 1 and 2) in Table 3
                        , and was actually used in the simulation at the top of Table 2. Over 100 simulations based on a uniform demand distribution were performed, sequentially solving Program 2 using the CL information allowed to fully cover 19 of the scenarios, out of the 79 expected to be feasible (see equation (5)).

The long term formulation requires to first cast the aggregator’s problem within a static framework defined in terms of the total number of requests received in time slot types, characterized by available demand-resource configuration pairs 
                           
                              (
                              
                                 
                                    D
                                    ^
                                 
                                 k
                              
                              ,
                              
                                 
                                    R
                                    ^
                                 
                                 k
                              
                              )
                              ⊂
                              D
                              ×
                              R
                           
                        .

Let (πk
                        )
                           k ∈ K
                         be a partition of the time horizon, where class πk
                         (time slots of type k), are characterized by the set of online and compatible demand-resource pairs 
                           
                              (
                              
                                 
                                    D
                                    ^
                                 
                                 k
                              
                              ,
                              
                                 
                                    R
                                    ^
                                 
                                 k
                              
                              )
                              ⊂
                              D
                              ×
                              R
                           
                        . A uniform distribution of demand yields the expected number of requests 
                           
                              
                                 y
                                 ¯
                              
                              
                                 k
                                 j
                              
                           
                         from contract j in time slots of type k:

                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                
                                                   k
                                                   j
                                                
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               r
                                                               j
                                                               dem
                                                            
                                                            
                                                               |
                                                               
                                                                  π
                                                                  k
                                                               
                                                               |
                                                            
                                                            
                                                            /
                                                            
                                                               r
                                                               j
                                                               res
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                            if
                                                            
                                                            j
                                                            ∈
                                                            
                                                               
                                                                  D
                                                                  ^
                                                               
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                            otherwise.
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Let k(t, s) ∈ K be the type of time slot s ∈ S(t), and define 
                           
                              
                                 Y
                                 uni
                              
                              ⊂
                              Y
                           
                         as the set of compatible demand scenarios, i.e., 
                           
                              y
                              ∈
                              
                                 Y
                                 uni
                              
                           
                         if and only if y ∈ Y and

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ⌊
                                                
                                                   
                                                      y
                                                      ¯
                                                   
                                                   
                                                      k
                                                      j
                                                   
                                                
                                                ⌋
                                             
                                             ≤
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   S
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                1
                                             
                                             
                                                (
                                                k
                                                
                                                   (
                                                   s
                                                   ,
                                                   t
                                                   )
                                                
                                                =
                                                
                                                   π
                                                   k
                                                
                                                )
                                             
                                             
                                                y
                                                j
                                                
                                                   t
                                                   s
                                                
                                             
                                             ≤
                                             
                                                ⌈
                                                
                                                   
                                                      y
                                                      ¯
                                                   
                                                   
                                                      k
                                                      j
                                                   
                                                
                                                ⌉
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Note that the uniformity assumption is readily generalized to forecast data, and is otherwise consistent with a Bayesian approach given that no predictive information is available.

The key to the long term model formulation is the expression of the aggregate forecast in terms of the maximum number of requests issued simultaneously from demand subsets. The left-hand side of Fig. 1 displays a request scenario’s history. It corresponds to requests from demands j
                        1, j
                        2 and j
                        3 occurring on time slots of a given type, say Monday mornings, for weeks t = 1, … , 15. The corresponding histogram is shown in the middle. The data on the right-hand side corresponds to the maximum number of simultaneous requests from demand subsets { j
                        1, j
                        2, j
                        3}, { j
                        2, j
                        3} and { j
                        2}.

The following procedure is instrumental in computing quantities relevant to the analysis. Consider the sequence of nested sets

                           
                              (15)
                              
                                 
                                    
                                       
                                          D
                                          ^
                                       
                                       
                                          k
                                          
                                             n
                                             k
                                          
                                       
                                    
                                    ⊂
                                    …
                                    ⊂
                                    
                                       
                                          D
                                          ^
                                       
                                       
                                          k
                                          1
                                       
                                    
                                    ⊂
                                    
                                       D
                                       k
                                    
                                 
                              
                           
                        and the vector 
                           
                              
                                 
                                    y
                                    ^
                                 
                                 k
                              
                              ∈
                              
                                 R
                                 
                                    n
                                    k
                                 
                              
                              ,
                           
                         recursively constructed as follows: first, set

                           
                              (16)
                              
                                 
                                    
                                       
                                          D
                                          ^
                                       
                                       
                                          k
                                          1
                                       
                                    
                                    =
                                    
                                       {
                                       j
                                       ∈
                                       
                                          
                                             D
                                             ^
                                          
                                          k
                                       
                                       :
                                       
                                          
                                             y
                                             ¯
                                          
                                          
                                             k
                                             j
                                          
                                       
                                       >
                                       0
                                       }
                                    
                                 
                              
                           
                        and let 
                           
                              
                                 y
                                 ^
                              
                              
                                 k
                                 1
                              
                           
                         be the smallest quantity such that

                           
                              (17)
                              
                                 
                                    
                                       
                                          D
                                          ^
                                       
                                       
                                          k
                                          2
                                       
                                    
                                    =
                                    
                                       {
                                       j
                                       ∈
                                       
                                          
                                             D
                                             ^
                                          
                                          
                                             k
                                             1
                                          
                                       
                                       :
                                       
                                          
                                             y
                                             ¯
                                          
                                          
                                             k
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             y
                                             ^
                                          
                                          
                                             k
                                             1
                                          
                                       
                                       >
                                       0
                                       }
                                    
                                    ≠
                                    
                                       
                                          D
                                          ^
                                       
                                       
                                          k
                                          ,
                                          1
                                       
                                    
                                    ,
                                 
                              
                           
                        then update 
                           
                              
                                 
                                    y
                                    ¯
                                 
                                 
                                    k
                                    j
                                 
                              
                              ←
                              
                                 
                                    y
                                    ¯
                                 
                                 
                                    k
                                    j
                                 
                              
                              −
                              
                                 
                                    y
                                    ^
                                 
                                 
                                    k
                                    1
                                 
                              
                           
                         for each 
                           
                              j
                              ∈
                              
                                 
                                    D
                                    ^
                                 
                                 
                                    k
                                    1
                                 
                              
                           
                         and repeat the operation until no positive components remains in vector 
                           
                              
                                 
                                    y
                                    ¯
                                 
                                 k
                              
                              ,
                           
                         for each k ∈ K.

                           Theorem 3
                           
                              Let
                              
                                 
                                    
                                       D
                                       ^
                                    
                                    
                                       k
                                       ℓ
                                    
                                 
                               
                              and
                              
                                 
                                    
                                       y
                                       ^
                                    
                                    
                                       k
                                       ℓ
                                    
                                 
                               
                              obtained from procedure (
                              
                                 14
                              
                              )–(
                              
                                 17
                              
                              ). Then
                              
                                 
                                    
                                       y
                                       ^
                                    
                                    
                                       k
                                       ℓ
                                    
                                 
                               
                              is an upper bound on the number of requests received simultaneously from the demands
                              
                                 
                                    
                                       
                                          D
                                          ^
                                       
                                       
                                          k
                                          ℓ
                                       
                                    
                                    ,
                                 
                               
                              in any one time slot of type k, in any compatible scenario
                              
                                 
                                    y
                                    ∈
                                    
                                       Y
                                       uni
                                    
                                 
                              
                              .
                           

See the Appendix.□

Assuming that the set of mobilizations 
                           
                              
                                 X
                                 pow
                              
                              
                                 (
                                 
                                    
                                       D
                                       ^
                                    
                                    
                                       k
                                       ℓ
                                    
                                 
                                 ,
                                 
                                    R
                                    k
                                 
                                 )
                              
                           
                         are provided explicitly for each time slot type, let us consider the problem of addressing requests, independent of their arrival order, within the static framework described in the previous section. We now show that, if fractional requests are allowed, the aggregator’s problem reduces to a minimum cost flow problem. To this aim, let M
                        
                           kℓ be an ordering of 
                           
                              
                                 X
                                 pow
                              
                              
                                 (
                                 
                                    
                                       D
                                       ^
                                    
                                    
                                       k
                                       ℓ
                                    
                                 
                                 ,
                                 
                                    R
                                    k
                                 
                                 )
                              
                           
                         and let δ
                        
                           kℓ be the corresponding mobilization-resource incidence matrix:

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                δ
                                                
                                                   m
                                                   i
                                                
                                                
                                                   k
                                                   ℓ
                                                
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            the
                                                            
                                                            m
                                                            
                                                            -th
                                                            
                                                            mobilization
                                                            
                                                            of
                                                            
                                                            
                                                               X
                                                               pow
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     D
                                                                     ^
                                                                  
                                                                  
                                                                     k
                                                                     ℓ
                                                                  
                                                               
                                                               ,
                                                               
                                                                  R
                                                                  k
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            uses
                                                            
                                                            resource
                                                            
                                                            i
                                                            
                                                            for
                                                            one
                                                            
                                                            of
                                                            
                                                            the
                                                            
                                                            demands
                                                            
                                                            in
                                                            
                                                            
                                                               
                                                                  D
                                                                  ^
                                                               
                                                               
                                                                  k
                                                                  ℓ
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            otherwise.
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Let 
                           
                              C
                              m
                              
                                 k
                                 ℓ
                              
                           
                         be the cost associated with mobilization m ∈ M
                        
                           kℓ such that

                           
                              (18)
                              
                                 
                                    
                                       C
                                       m
                                       
                                          k
                                          ℓ
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          ,
                                          j
                                          ∈
                                          D
                                          
                                             R
                                             
                                                k
                                                ℓ
                                             
                                          
                                       
                                    
                                    
                                       δ
                                       
                                          m
                                          i
                                       
                                       
                                          k
                                          ℓ
                                       
                                    
                                    1
                                    
                                       {
                                       j
                                       ∈
                                       
                                          
                                             D
                                             ^
                                          
                                          
                                             k
                                             ℓ
                                          
                                       
                                       }
                                    
                                    
                                       c
                                       i
                                    
                                    ,
                                 
                              
                           
                        and let variable w
                        
                           kℓm
                         > 0 denote the number of time slots on which joint requests from demands 
                           
                              
                                 D
                                 ^
                              
                              
                                 k
                                 ℓ
                              
                           
                         are satisfied by mobilization m. In other words, variable w
                        
                           kℓm
                         represents the number of resource tokens that are used in mobilization m for addressing joint requests from demands 
                           
                              
                                 D
                                 ^
                              
                              
                                 k
                                 ℓ
                              
                           
                         on time slots of type k. Let

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   w
                                                   ¯
                                                
                                                
                                                   k
                                                   i
                                                
                                             
                                             =
                                             
                                                ∑
                                                
                                                   ℓ
                                                   ≤
                                                   
                                                      n
                                                      k
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   m
                                                   ∈
                                                   
                                                      M
                                                      
                                                         k
                                                         ℓ
                                                      
                                                   
                                                
                                             
                                             
                                                δ
                                                
                                                   m
                                                   i
                                                
                                                
                                                   k
                                                   ℓ
                                                
                                             
                                             
                                                w
                                                
                                                   k
                                                   ℓ
                                                   m
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        be the total amount of tokens from resource i used to respond to requests on time slots of type k, and let 
                           
                              
                                 y
                                 ^
                              
                              
                                 t
                                 ·
                              
                           
                         be the aggregate forecast constructed following procedure (15)–(17), at the beginning of week t. Now, consider the set of flow constraints 
                           
                              W
                              (
                              
                                 y
                                 ^
                              
                              ,
                              
                                 r
                                 res
                              
                              )
                           
                         defined by the inequalities

                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   m
                                                   ∈
                                                   
                                                      M
                                                      
                                                         k
                                                         ,
                                                         ℓ
                                                      
                                                   
                                                
                                             
                                             
                                                w
                                                
                                                   k
                                                   ℓ
                                                   m
                                                
                                             
                                             ≥
                                             
                                                
                                                   y
                                                   ^
                                                
                                                
                                                   k
                                                   ℓ
                                                
                                             
                                             
                                             k
                                             ∈
                                             K
                                             
                                             ℓ
                                             ∈
                                             
                                                L
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                             
                                                
                                                   w
                                                   ¯
                                                
                                                
                                                   k
                                                   i
                                                
                                             
                                             ≥
                                             
                                                r
                                                
                                                   i
                                                
                                                res
                                             
                                          
                                       
                                       
                                       
                                          
                                             i
                                             ∈
                                             R
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                                
                                                   k
                                                   ℓ
                                                   m
                                                
                                             
                                             ≥
                                             0
                                             
                                             k
                                             ∈
                                             K
                                             
                                             ℓ
                                             ∈
                                             
                                                L
                                                k
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        together with the mathematical program:

                           Program 3
                           
                              
                                 
                                    (21)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      min
                                                      
                                                         w
                                                         ∈
                                                         W
                                                         (
                                                         
                                                            
                                                               y
                                                               ^
                                                            
                                                            t
                                                         
                                                         ,
                                                         
                                                            r
                                                            t
                                                            res
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                   
                                                      ∑
                                                      
                                                         k
                                                         ∈
                                                         K
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         ℓ
                                                         ∈
                                                         
                                                            L
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         m
                                                         ∈
                                                         
                                                            M
                                                            
                                                               k
                                                               ℓ
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      C
                                                      m
                                                      
                                                         k
                                                         ℓ
                                                      
                                                   
                                                   
                                                      w
                                                      
                                                         k
                                                         ℓ
                                                         m
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

whose optimal solution ensures that a maximum number of demand requests are satisfied at minimum cost. Constraint (19) models demand satisfaction and ensures that, given a sufficient amount of resources, all demands are satisfied, and then all components of constraint (20) are tight. Otherwise, the slack variable associated with resource constraints (20) provide information on missing resources. More formally:

                           Theorem 4
                           
                              If resources are sufficient to satisfy all demand, that is, there exists a
                              
                                 
                                    w
                                    ∈
                                    W
                                    (
                                    
                                       
                                          y
                                          ^
                                       
                                       t
                                    
                                    ,
                                    
                                       r
                                       
                                          t
                                          ·
                                       
                                       res
                                    
                                    )
                                 
                               
                              such that
                              
                                 
                                    (22)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         m
                                                         ∈
                                                         
                                                            M
                                                            
                                                               k
                                                               ℓ
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      w
                                                      
                                                         k
                                                         ℓ
                                                         m
                                                      
                                                      *
                                                   
                                                   =
                                                   
                                                      
                                                         y
                                                         ^
                                                      
                                                      
                                                         t
                                                         k
                                                         ℓ
                                                      
                                                   
                                                   ,
                                                   
                                                   k
                                                   ∈
                                                   K
                                                   ,
                                                   ℓ
                                                   ∈
                                                   
                                                      L
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (23)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         k
                                                         ∈
                                                         K
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         ℓ
                                                         ∈
                                                         
                                                            L
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         m
                                                         ∈
                                                         
                                                            M
                                                            
                                                               k
                                                               ℓ
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      δ
                                                      
                                                         m
                                                         i
                                                      
                                                      
                                                         k
                                                         ℓ
                                                      
                                                   
                                                   
                                                      w
                                                      
                                                         k
                                                         ℓ
                                                         m
                                                      
                                                      *
                                                   
                                                   ≤
                                                   
                                                      r
                                                      
                                                         t
                                                         i
                                                      
                                                      res
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   i
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              then constraints (
                              
                                 20
                              
                              ) are tight in Program 
                              
                                 3
                              
                              .
                           

See the Appendix.□

With respect to an optimal solution of Program 3, two situations may arise. First, there exists an index i ∈ R such that (20) is not tight, i.e., resource i is lacking request tokens, and then at least one of the component of (19) is tight, say component (k, ℓ), where additional resources are required to satisfy demands 
                           
                              
                                 D
                                 ^
                              
                              
                                 k
                                 ℓ
                              
                           
                        . The opposite situation entails that all demands are covered. This is consistent with our general positioning of the aggregator’s problem, where resources are assumed to be sufficient to cover demand. In this context, the mobilization policy of the current week should be such that the long term model remains feasible in subsequent weeks.

To satisfy the above requirement, we factor in bounds on the use of each resource (provided by the long term solution) and restrain the current week’s mobilization accordingly. The stochastic nature of the aggregated forecast 
                           
                              w
                              ¯
                           
                         (on the basis of which the long term model is built) suggests not to implement this as hard constraints. In the proposed scheme, the coefficients of the short term objective are corrected in the following manner. Consider the restriction 
                           
                              
                                 x
                                 ^
                              
                              
                                 (
                                 w
                                 )
                              
                           
                         of the long term solution w to the time slots at current week t, that is, the expected amount of resource i used to satisfy requests from demand j in time slot s ∈ S(t), for each (i, j) ∈ DRts
                        :

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                   ^
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   t
                                                   s
                                                
                                             
                                             
                                                (
                                                w
                                                )
                                             
                                             =
                                             
                                                p
                                                
                                                   t
                                                   ,
                                                   k
                                                   (
                                                   t
                                                   s
                                                   )
                                                
                                             
                                             
                                             
                                                ∑
                                                
                                                   ℓ
                                                   ∈
                                                   
                                                      L
                                                      
                                                         k
                                                         (
                                                         t
                                                         ,
                                                         s
                                                         )
                                                      
                                                   
                                                   :
                                                   j
                                                   ∈
                                                   
                                                      
                                                         D
                                                         ^
                                                      
                                                      
                                                         k
                                                         ℓ
                                                      
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   m
                                                   ∈
                                                   
                                                      M
                                                      
                                                         k
                                                         (
                                                         t
                                                         ,
                                                         s
                                                         )
                                                         ℓ
                                                      
                                                   
                                                
                                             
                                             
                                                δ
                                                
                                                   m
                                                   i
                                                
                                                
                                                   k
                                                   (
                                                   t
                                                   ,
                                                   s
                                                   )
                                                   ℓ
                                                
                                             
                                             
                                                w
                                                
                                                   k
                                                   (
                                                   t
                                                   ,
                                                   s
                                                   )
                                                   ℓ
                                                   m
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where ptk
                         is the conditional probability that a request in a time slot of type k occurs at current week t under the uniform demand assumption, and is expressed as

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                p
                                                
                                                   t
                                                   k
                                                
                                             
                                             =
                                             
                                                |
                                                
                                                   {
                                                   s
                                                   ∈
                                                   S
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   :
                                                   k
                                                   
                                                      (
                                                      t
                                                      s
                                                      )
                                                   
                                                   =
                                                   k
                                                   }
                                                
                                                |
                                                /
                                                |
                                             
                                             
                                                π
                                                k
                                             
                                             
                                                |
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Since incorporating the constraints

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                p
                                                
                                                   t
                                                   ,
                                                   k
                                                   (
                                                   t
                                                   s
                                                   )
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                                
                                                   t
                                                   s
                                                
                                             
                                             ≤
                                             
                                                
                                                   x
                                                   ^
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   t
                                                   s
                                                
                                             
                                             
                                                (
                                                w
                                                )
                                             
                                             
                                             
                                                (
                                                i
                                                j
                                                )
                                             
                                             ∈
                                             D
                                             
                                                R
                                                
                                                   t
                                                   s
                                                
                                             
                                             ,
                                             
                                             s
                                             ∈
                                             S
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        may make the short term model infeasible, we look for a feasible mobilization schedule x
                        * such that

                           
                              
                                 
                                    
                                       p
                                       
                                          t
                                          ,
                                          ·
                                       
                                    
                                    
                                    
                                       
                                          x
                                       
                                       *
                                    
                                    ∈
                                    arg
                                    
                                       min
                                       
                                          
                                             x
                                             t
                                          
                                          ∈
                                          
                                             X
                                             t
                                             week
                                          
                                       
                                    
                                    
                                       ∥
                                       
                                          
                                             x
                                             ^
                                          
                                          t
                                       
                                       
                                          (
                                          w
                                          )
                                       
                                       ,
                                       
                                          x
                                          t
                                       
                                       ∥
                                    
                                    .
                                 
                              
                           
                        Equivalently, the square of the norm can be minimized:

                           
                              (24)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∥
                                             
                                             
                                                
                                                   x
                                                   ^
                                                
                                                t
                                             
                                             
                                                (
                                                w
                                                )
                                             
                                             ,
                                             
                                                x
                                                t
                                             
                                             
                                                
                                                   ∥
                                                
                                                2
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   S
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                ∑
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   D
                                                   R
                                                   (
                                                   t
                                                   ,
                                                   s
                                                   )
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         x
                                                         ^
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                         s
                                                      
                                                   
                                                   
                                                      (
                                                      w
                                                      )
                                                   
                                                   −
                                                   
                                                      x
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                         s
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   S
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                ∑
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   D
                                                   R
                                                   (
                                                   t
                                                   ,
                                                   s
                                                   )
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         x
                                                         ^
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                         s
                                                      
                                                   
                                                   
                                                      (
                                                      w
                                                      )
                                                   
                                                   )
                                                
                                                2
                                             
                                             −
                                             2
                                             
                                                
                                                   x
                                                   ^
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   t
                                                   s
                                                
                                             
                                             
                                                (
                                                w
                                                )
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                                
                                                   t
                                                   s
                                                
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      x
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                         s
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   S
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                ∑
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   D
                                                   R
                                                   (
                                                   t
                                                   ,
                                                   s
                                                   )
                                                
                                             
                                             
                                                [
                                                1
                                                −
                                                2
                                                
                                                   
                                                      x
                                                      ^
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      t
                                                      s
                                                   
                                                
                                                
                                                   (
                                                   w
                                                   )
                                                
                                                ]
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                                
                                                   t
                                                   s
                                                
                                             
                                             +
                                             constant
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where we used 
                           
                              
                                 
                                    (
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                       
                                          t
                                          s
                                       
                                    
                                    )
                                 
                                 2
                              
                              =
                              
                                 x
                                 
                                    i
                                    j
                                 
                                 
                                    t
                                    s
                                 
                              
                              ,
                           
                         as 
                           
                              
                                 x
                                 
                                    i
                                    j
                                 
                                 
                                    t
                                    s
                                 
                              
                              ∈
                              
                                 {
                                 0
                                 ,
                                 1
                                 }
                              
                           
                        . We now have:

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                p
                                                
                                                   t
                                                   ,
                                                   ·
                                                
                                             
                                             
                                             
                                                
                                                   x
                                                
                                                *
                                             
                                             ∈
                                             arg
                                             
                                                min
                                                
                                                   
                                                      x
                                                      t
                                                   
                                                   ∈
                                                   
                                                      X
                                                      t
                                                      week
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   S
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                ∑
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   D
                                                   R
                                                   (
                                                   t
                                                   ,
                                                   s
                                                   )
                                                
                                             
                                             
                                                [
                                                1
                                                −
                                                2
                                                
                                                   
                                                      x
                                                      ^
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      t
                                                      s
                                                   
                                                
                                                
                                                   (
                                                   w
                                                   )
                                                
                                                ]
                                             
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                                
                                                   t
                                                   s
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        We then set the long term information in the short term model (Program 2) to

                           
                              (25)
                              
                                 
                                    
                                       q
                                       
                                          i
                                          j
                                       
                                       
                                          t
                                          s
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             p
                                             
                                                t
                                                ,
                                                k
                                                (
                                                t
                                                s
                                                )
                                             
                                          
                                          )
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       1
                                       −
                                       2
                                       
                                          
                                             x
                                             ^
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             t
                                             s
                                          
                                       
                                       
                                          (
                                          w
                                          )
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        which is referred to as the projected flow (PF) information in the sequel.

Consider again Portfolio 1 (Tables 1 and 2), which involves two time slot types (referred to as day types above): Mondays and Tuesdays for k = 1, and the remaining week days for k = 2, and thus K = {1, 2}. As a single resource suffices to cover a request, mobilizations can be expressed directly in terms of the mobilized resource. We have M
                        1 = {R1} and M
                        2 = {R1, R2}, and 
                           
                              
                                 
                                    w
                                    ¯
                                 
                                 
                                    k
                                    i
                                 
                              
                              =
                              
                                 w
                                 
                                    k
                                    1
                                    i
                                 
                              
                           
                        . That is, the amount of resource i assigned to day type k matches the flow of the corresponding mobilization on the unique slice 1. Variable w
                        
                           kℓm
                         represents the amount of resource i mobilized in time slot of type k to cover the demands 
                           
                              
                                 
                                    D
                                    ^
                                 
                                 
                                    k
                                    ℓ
                                 
                              
                              ,
                           
                         where k ∈ {1, 2}, ℓ = 1 and m ∈ 1, 2. Mobilization 1 (resp. mobilization 2) corresponds to the use of resource R1 (resp. resource R2) and 
                           
                              
                                 
                                    D
                                    ^
                                 
                                 11
                              
                              =
                              
                                 
                                    D
                                    ^
                                 
                                 12
                              
                              =
                              
                                 {
                                 1
                                 }
                              
                              ,
                           
                         that is, a single demand is involved. Recalling that c
                        1 = 2 and c
                        2 = 5, Program 3 takes the form:

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                min
                                                
                                                   w
                                                   ≥
                                                   0
                                                
                                             
                                             
                                             2
                                             
                                                (
                                                
                                                   w
                                                   111
                                                
                                                +
                                                
                                                   w
                                                   211
                                                
                                                )
                                             
                                             +
                                             5
                                             
                                                w
                                                112
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             s.t.
                                             
                                             
                                                w
                                                111
                                             
                                             +
                                             
                                                w
                                                112
                                             
                                             ≥
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                1
                                                1
                                             
                                             =
                                             4
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                w
                                                211
                                             
                                             ≥
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                1
                                                2
                                             
                                             =
                                             8
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                   ¯
                                                
                                                11
                                             
                                             +
                                             
                                                
                                                   w
                                                   ¯
                                                
                                                21
                                             
                                             ≥
                                             
                                                r
                                                1
                                                res
                                             
                                             =
                                             10
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                   ¯
                                                
                                                12
                                             
                                             ≥
                                             
                                                r
                                                2
                                                res
                                             
                                             =
                                             5
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Its optimal solution is illustrated on the right-hand side of Fig. 2
                        . For example, at week t = 1 and for time slot s = 1, resource i = 1 (D1) and demand i = 2 (R2), we have 
                           
                              
                                 p
                                 11
                              
                              =
                              1
                              /
                              15
                           
                         and 
                           
                              
                                 
                                    x
                                    ^
                                 
                                 21
                                 11
                              
                              =
                              1
                              /
                              3
                              ,
                           
                         and the corrected cost

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                q
                                                21
                                                11
                                             
                                             =
                                             
                                                
                                                   (
                                                   1
                                                   /
                                                   15
                                                   )
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                [
                                                1
                                                −
                                                2
                                                
                                                   (
                                                   1
                                                   /
                                                   3
                                                   )
                                                
                                                ]
                                             
                                             =
                                             5
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The PF information at week t = 1 is summarized in Table 4
                        . The left-hand side of Fig. 2 provides a graphical comparison between the CL and PF information.

A simulation run using FB information on Portfolio 1 is presented at the bottom of Table 2, and compared with one based on CL information. Note that all time slots are now covered. CL and FP information are compared on Portfolio 1 in Table 5
                        , where 100 simulations have been performed. The PF information provides a coverage of 83 percent of all scenarios, compared to 19 percent for the CL information. While the FB information performs better, both schemes ‘agree’ that Portfolio 1 cannot be covered with probability 1, which confirms our previous
                        
                        
                         observations.

We now contrast CL and FP’s long term information on the larger Portfolio 2 given in Table 6. The meaning of the columns are as in Table 1, and the additional column mainly refers to maximum number of maintenances. Table 7 provides the total number of eligible mobilization candidates per time slot types. Fig. 3 and Fig. 4 give the total power gathered and the available contracts in each time slot type, respectively.

The results of 50 simulation runs are summarized in Table 8
                      and Table 9
                     , respectively. The statistics are gathered for each time slot type, showing average mobilization costs, average number of uncovered time slots (failures) and the proportion of runs where demand is fully covered. At the bottom, we provide the average number of unused resource tokens, for each resource, as well as the total proportion of unused power.

Considering the distribution of uncovered time slots for the different types, both algorithms (information type) broadly agree that resources are lacking on time slots of type 1, time slot of type 7 (weeks 1 through 16), and time slot of type 10 (weeks 17 through 24). The CL information otherwise manages a lower average mobilization cost of 887.62, compared to 1037.64 when using the FP information. However, the extra mobilization cost allows the FP scheme to fully cover 76 percent of scenarios, compared to none for the CL scheme, and this is achieved using only 2 percent of additional resources.

@&#CONCLUSION@&#

In the present work, we have introduced a novel approach to model an energy aggregator interacting with the smart grid through bilateral contracts. While the management of this contractual framework yields a hard combinatorial problem, we could yet propose for its solution original and efficient optimizing tools aimed at maximizing the aggregator’s profitability. Our deterministic two-time frame can be viewed as a semi-online mathematical model that covers the aggregator against a family of adversarial demand scenarios in the long run, while ensuring short term feasibility. The next challenge consists in addressing a probabilistic generalization of the model. This will be done in a companion paper.

@&#ACKNOWLEDGMENTS@&#

We thank the anonymous referees for the time spent and the help provided during the refereeing process.


                     
                        Proof of Theorem 1
                        (⇒) Let 
                              
                                 x
                                 ∈
                                 
                                    X
                                    week
                                    t
                                 
                              
                            and suppose their exists a resource i such that

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      
                                                         D
                                                         i
                                                      
                                                   
                                                
                                                min
                                                
                                                   {
                                                   
                                                      ∑
                                                      
                                                         s
                                                         :
                                                         
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                         
                                                         ∈
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               t
                                                               s
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      x
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                         s
                                                      
                                                   
                                                   ,
                                                   
                                                      r
                                                      
                                                         t
                                                         j
                                                      
                                                      dem
                                                   
                                                   }
                                                
                                                >
                                                
                                                   r
                                                   
                                                      t
                                                      i
                                                   
                                                   res
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           We can choose y ∈ Y such that

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      
                                                         D
                                                         i
                                                      
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      s
                                                      
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                      ∈
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            t
                                                            s
                                                         
                                                      
                                                   
                                                
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      t
                                                      s
                                                   
                                                
                                                
                                                   y
                                                   j
                                                   
                                                      t
                                                      s
                                                   
                                                
                                                =
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      
                                                         D
                                                         i
                                                      
                                                   
                                                
                                                min
                                                
                                                   {
                                                   
                                                      ∑
                                                      
                                                         s
                                                         :
                                                         
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                         
                                                         ∈
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               t
                                                               s
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      x
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                         s
                                                      
                                                   
                                                   ,
                                                   
                                                      r
                                                      
                                                         t
                                                         j
                                                      
                                                      dem
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           But then

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      
                                                         D
                                                         i
                                                      
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      s
                                                      :
                                                      
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                      ∈
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            t
                                                            s
                                                         
                                                      
                                                   
                                                
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      t
                                                      s
                                                   
                                                
                                                
                                                   y
                                                   j
                                                   
                                                      t
                                                      s
                                                   
                                                
                                                >
                                                
                                                   r
                                                   
                                                      t
                                                      i
                                                   
                                                   res
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           and thus 
                              
                                 x
                                 ∉
                                 
                                    X
                                    week
                                    t
                                 
                                 ,
                              
                            contradicting the hypothesis.

(⇐) Let 
                              
                                 x
                                 ∈
                                 
                                    X
                                    week
                                    t
                                 
                              
                            and suppose that there exists a resource i such that

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      s
                                                      ∈
                                                      S
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                      ∈
                                                      D
                                                      
                                                         R
                                                         
                                                            t
                                                            s
                                                         
                                                      
                                                   
                                                
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      t
                                                      s
                                                   
                                                
                                                
                                                   y
                                                   j
                                                   
                                                      t
                                                      s
                                                   
                                                
                                                >
                                                
                                                   r
                                                   
                                                      t
                                                      i
                                                   
                                                   res
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           According to (6) we have

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      D
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      s
                                                      ∈
                                                      S
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                                
                                                   y
                                                   j
                                                   
                                                      t
                                                      s
                                                   
                                                
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      t
                                                      s
                                                   
                                                
                                             
                                          
                                          
                                             ≤
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      D
                                                   
                                                
                                                min
                                                
                                                   {
                                                   
                                                      ∑
                                                      
                                                         s
                                                         ∈
                                                         S
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                   
                                                      x
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                         s
                                                      
                                                   
                                                   ,
                                                   
                                                      r
                                                      
                                                         t
                                                         j
                                                      
                                                      dem
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             ≤
                                          
                                          
                                             
                                                
                                                   r
                                                   
                                                      t
                                                      i
                                                   
                                                   res
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           contradicting the hypothesis.□

Constraints (8) and (9) require that

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   z
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                =
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               if
                                                               
                                                               
                                                                  ∑
                                                                  
                                                                     s
                                                                     ∈
                                                                     S
                                                                     (
                                                                     t
                                                                     )
                                                                  
                                                               
                                                               
                                                                  x
                                                                  
                                                                     i
                                                                     j
                                                                  
                                                                  s
                                                               
                                                               >
                                                               
                                                                  r
                                                                  i
                                                                  R
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            
                                                               if
                                                               
                                                               
                                                                  ∑
                                                                  
                                                                     s
                                                                     ∈
                                                                     S
                                                                     (
                                                                     t
                                                                     )
                                                                  
                                                               
                                                               
                                                                  x
                                                                  
                                                                     i
                                                                     j
                                                                  
                                                                  s
                                                               
                                                               ≤
                                                               
                                                                  r
                                                                  i
                                                                  R
                                                               
                                                               .
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           Constraints (10)–(12) require that

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   w
                                                   
                                                      i
                                                      j
                                                   
                                                   s
                                                
                                                =
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                   s
                                                
                                                
                                                
                                                   z
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           and thus constraint (7) requires that

                              
                                 
                                    
                                       
                                          
                                             
                                                r
                                                i
                                                res
                                             
                                          
                                          
                                             ≥
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      
                                                         D
                                                         t
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      r
                                                      j
                                                      D
                                                   
                                                   
                                                      z
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         s
                                                         ∈
                                                         S
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                   
                                                      x
                                                      
                                                         i
                                                         j
                                                      
                                                      s
                                                   
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         z
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      
                                                         D
                                                         t
                                                      
                                                   
                                                
                                                min
                                                
                                                   {
                                                   
                                                      r
                                                      j
                                                      D
                                                   
                                                   ,
                                                   
                                                      ∑
                                                      
                                                         s
                                                         ∈
                                                         S
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                   
                                                      x
                                                      
                                                         i
                                                         j
                                                      
                                                      s
                                                   
                                                   }
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                           □

The argument is geometric. Consider the histogram associated with the quantities 
                              
                                 
                                    
                                       y
                                       ¯
                                    
                                    
                                       k
                                       j
                                    
                                 
                                 ,
                                 j
                                 ∈
                                 
                                    
                                       D
                                       ^
                                    
                                    k
                                 
                              
                           . Given an appropriate ordering of 
                              
                                 
                                    
                                       D
                                       ^
                                    
                                    k
                                 
                                 ,
                              
                            the histogram can be partitioned into a finite number of horizontal slices, the ℓth slice having height 
                              
                                 
                                    
                                       y
                                       ^
                                    
                                    
                                       k
                                       ,
                                       ℓ
                                    
                                 
                                 ,
                              
                            and horizontally covering the columns associated with demands in 
                              
                                 
                                    D
                                    ^
                                 
                                 
                                    k
                                    ,
                                    ℓ
                                 
                              
                           . The conclusion follows.□

By contradiction, let w′ satisfy constraints (22) and (23) and w
                           * be an optimal solution of Program 2 such that there exists i ∈ R such that

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      ∈
                                                      K
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      ℓ
                                                      ≤
                                                      
                                                         n
                                                         k
                                                      
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      m
                                                      ∈
                                                      
                                                         M
                                                         
                                                            k
                                                            ℓ
                                                         
                                                      
                                                   
                                                
                                                
                                                   δ
                                                   
                                                      m
                                                      i
                                                   
                                                   
                                                      k
                                                      ℓ
                                                   
                                                
                                                
                                                   w
                                                   m
                                                   
                                                      *
                                                      k
                                                      ℓ
                                                   
                                                
                                                >
                                                
                                                   r
                                                   
                                                      t
                                                      i
                                                   
                                                   res
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Now consider the following equivalent expression of Program 2:

                              
                                 (26)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   min
                                                   
                                                      ψ
                                                      ,
                                                      w
                                                   
                                                
                                                
                                                   f
                                                   ^
                                                
                                                
                                                   (
                                                   w
                                                   )
                                                
                                                =
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   c
                                                   i
                                                
                                                
                                                   ψ
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (27)
                                 
                                    
                                       
                                          
                                             
                                                s.t.
                                                
                                                   ∑
                                                   
                                                      m
                                                      ∈
                                                      
                                                         M
                                                         
                                                            k
                                                            ℓ
                                                         
                                                      
                                                   
                                                
                                                
                                                   w
                                                   m
                                                   
                                                      k
                                                      ℓ
                                                   
                                                
                                                ≥
                                                
                                                   
                                                      y
                                                      ^
                                                   
                                                   t
                                                   
                                                      k
                                                      ℓ
                                                   
                                                
                                                
                                                ∀
                                                k
                                                
                                                ℓ
                                                ≤
                                                
                                                   n
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (28)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ψ
                                                   i
                                                
                                                ≥
                                                
                                                   r
                                                   
                                                      t
                                                      i
                                                   
                                                   res
                                                
                                                
                                                ∀
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (29)
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   ψ
                                                   i
                                                
                                                =
                                                
                                                   ∑
                                                   
                                                      k
                                                      ∈
                                                      K
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      ℓ
                                                      ≤
                                                      
                                                         n
                                                         k
                                                      
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      m
                                                      ∈
                                                      
                                                         M
                                                         
                                                            k
                                                            ℓ
                                                         
                                                      
                                                   
                                                
                                                
                                                   δ
                                                   
                                                      m
                                                      i
                                                   
                                                   
                                                      k
                                                      ℓ
                                                   
                                                
                                                
                                                   w
                                                   m
                                                   
                                                      k
                                                      ℓ
                                                   
                                                
                                                
                                                ∀
                                                i
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   w
                                                   m
                                                   
                                                      k
                                                      ℓ
                                                   
                                                
                                                ≥
                                                0
                                                
                                                ∀
                                                k
                                                
                                                ℓ
                                                ∈
                                                
                                                   L
                                                   k
                                                
                                                
                                                ∀
                                                m
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Expressing w′ and w
                           * in terms of the new variable yields

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   ψ
                                                   ′
                                                
                                                =
                                                
                                                   ∑
                                                   
                                                      k
                                                      ∈
                                                      K
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      ℓ
                                                      ≤
                                                      
                                                         n
                                                         k
                                                      
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      m
                                                      ∈
                                                      
                                                         M
                                                         
                                                            k
                                                            ℓ
                                                         
                                                      
                                                   
                                                
                                                
                                                   δ
                                                   
                                                      m
                                                      i
                                                   
                                                   
                                                      k
                                                      ,
                                                      ℓ
                                                   
                                                
                                                
                                                   w
                                                   m
                                                   
                                                      ′
                                                      k
                                                      ℓ
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   ψ
                                                   *
                                                
                                                =
                                                
                                                   ∑
                                                   
                                                      k
                                                      ∈
                                                      K
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      ℓ
                                                      ≤
                                                      
                                                         n
                                                         k
                                                      
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      m
                                                      ∈
                                                      
                                                         M
                                                         
                                                            k
                                                            ℓ
                                                         
                                                      
                                                   
                                                
                                                
                                                   δ
                                                   
                                                      m
                                                      i
                                                   
                                                   
                                                      k
                                                      ,
                                                      ℓ
                                                   
                                                
                                                
                                                   w
                                                   m
                                                   
                                                      *
                                                      k
                                                      ℓ
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           From the optimality of w
                           * we deduce: 
                              
                                 
                                    ∑
                                    i
                                 
                                 
                                    c
                                    i
                                 
                                 
                                    ψ
                                    i
                                    *
                                 
                                 ≤
                                 
                                    c
                                    i
                                 
                                 
                                    ∑
                                    i
                                 
                                 
                                    ψ
                                    i
                                    ′
                                 
                                 ,
                              
                            while the feasibility of w′ implies that 
                              
                                 
                                    ψ
                                    i
                                    ′
                                 
                                 ≤
                                 
                                    ψ
                                    i
                                    *
                                 
                                 ,
                                 
                                 ∀
                                 i
                              
                           . The strict positivity of c implies that w′ is optimal, which in turn implies that 
                              
                                 
                                    ∑
                                    i
                                 
                                 
                                    c
                                    i
                                 
                                 
                                    ψ
                                    i
                                    *
                                 
                                 =
                                 
                                    c
                                    i
                                 
                                 
                                    ∑
                                    i
                                 
                                 
                                    ψ
                                    i
                                    ′
                                 
                                 ,
                              
                           . The contradiction follows from the inequality 
                              
                                 
                                    ψ
                                    i
                                    *
                                 
                                 >
                                 
                                    ψ
                                    i
                                    ′
                                 
                              
                           .□

@&#REFERENCES@&#

