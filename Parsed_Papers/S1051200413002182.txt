@&#MAIN-TITLE@&#Perceptual encryption with compression for secure vector map data processing

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We design a lossy/lossless compression and perceptual encryption algorithm for vector map.


                        
                        
                           
                           Our algorithm ensures access control and copyright protection of vector map.


                        
                        
                           
                           Each object is performed independently for random access about specified location.


                        
                        
                           
                           All objects are compressed as a unit of minimum coding object (MCO) units.


                        
                        
                           
                           All objects are perceptually encrypted using mean points and directions of MCO.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Vector map data

Vector compression

Perceptual encryption

Copy detection

Access control

@&#ABSTRACT@&#


               
               
                  With the rapidly rising interest in geographic information system (GIS) contents, a large volume of valuable map data has been unlawfully distributed by pirates. Therefore, the secure storage and transmission of classified national digital map datasets have been increasingly threatened. As the importance of secure, large-volume map datasets has increased, vector map security techniques that focus on secure network and data encryption have been studied. These techniques are required to ensure access control and prevent illegal copying of digital maps. This paper presents perceptual encryption on the vector compression domain for copy protection and access control of vector maps. Our algorithm compresses all vector data of polylines and polygons by lossless minimum coding object (MCO) units and perceptually encrypts using two processes using the mean points and directions of MCOs. The first process changes the position of vector data by randomly permuting the mean points of MCOs, the so-called position encryption. The second process changes the geographic shape by circularly encrypting the directions of vertices in MCOs by the XOR operator. Experimental results have verified that our algorithm can encrypt GIS digital maps effectively and simply and can also improve the compression ratio, unlike general data encryption techniques, and thus, our algorithm is very effective for a large volume of GIS datasets.
               
            

@&#INTRODUCTION@&#

A geographic information system (GIS) is designed to capture, store, manipulate, analyze, and manage all kinds of geographic information. As such, GIS is the emerging system for cartography, statistical analysis, and database technology [1–3]. Many countries have greatly spread the application of geographic information in both the public and the private sector by constructing a GIS frame and network at a national level. In recent mobile applications such as navigation, smart phone, and Wi-Fi, GIS has rapidly grown into a new paradigm of Where 2.0 with Web GIS through Internet mapping, mobile mash-up services, and social communities. The data structure of the geographical dataset, as shown in Fig. 1
                     , consists of spatial data fields and object data fields. The spatial data are classified as vector data and raster data. The former can be displayed as vector graphics, which uses geometrical primitives such as points, lines, curves, and shapes or polygons, whereas raster data appear as an image. Geographical features are often expressed as vectors by considering those features as geometrical shapes.

The security of a geographical dataset encrypts map data or controls user access to prevent damage to or theft of the dataset, which can happen in the integration process with a number of datasets of geographical information. Cases in which second- or third-party consumers illegally distribute datasets established by private or national institutes have been frequently reported. Some countries have invested significant amounts of their budgets to the development and construction of security solutions as a part of an integrated construction project of national geographic information to link systems of institutes.

Looking into recent techniques for geographical dataset security, network security techniques for secure transmission of map data have been researched extensively [4–8]. Researchers have worked on the cryptography-based data encryption of database files or data profiles [9–11] and on the watermarking and hashing of vector maps or raster maps for copyright protection [12–20]. Conventional approaches to dataset security that are based on authentication and watermarking have some limitations. These limitations are as follows. First, the cryptography of data files and profiles increases complexity because of complex encryption algorithms. Some objects that illustrate contour lines in map expression fields, such as houses, roads, and main sewers, can be frequently activated or nonactivated, and the switching of map expression can occur on the basis of various event types. Thus, because the encryption and decryption of a dataset must always be performed when cases such as the above occur, the flexibility of such a system is very low. In particular, database management systems (DBMSs) based on security techniques [10] are vulnerable to the conversion of data format. Therefore, the security technique must preserve the security of the dataset in various formats. Second, the network security technique cannot preserve security in the case of data leakage in offline or loophole exposure of network administration. Third, the conventional works cannot perform the indexing when layers or objects in an encrypted map are detected and displayed. This indexing is very useful in GIS. Finally, map watermarking, which is the post-processing of security, determines whether pirated map data are illegally copied. In short, it is difficult to create a basic solution for map dataset security.

To compensate for limitations in the conventional approaches described above, we present the perceptual encryption of layer units on vector compression to protect against illegal copying and distribution and to control access of a large volume of map datasets. Our algorithm perceptually encrypts a vector map by using position and direction parameters in vector compression domains that imply lossless hierarchical compression. The main advantages of our algorithm are the high efficiency of perceptual encryption using low-complexity indexing for special or only desired objects in the encrypted map without a decryption process for the total map, as well as the improvement of the compression ratio for a large volume of map datasets.

The remainder of this paper is organized as follows. In Section 2, we describe map security techniques and related works regarding map datasets. In Section 3, we explain the proposed perceptual encryption in detail. In Section 4, we discuss the experimental results, and we conclude the paper in Section 5.

A vector map consists of a number of data layers that contain geographical features of roads, railroads, rivers, buildings, and so on, as well as spatial and nonspatial data. Each layer contains object sets of points, lines or polylines, polygons, and characters. Geometric types of points, lines or polylines, and polygons are represented by one or more vertices. In addition, vector maps can be stored and distributed using various formats according to the production environments [21–24]. Despite the various formats, all geometric data contain consecutive vertices of floating points on a 2D plane, and any layer in a map can be generated by a geometric dataset. Most geographical features can be represented by polylines and polygons.

Watermarking and encryption techniques have been studied by many researchers to address the security of the content of the many kinds of vector map data. Vector map watermarking has been extensively researched as a solution for the protection of spatial data since the early 2000s [12–20]. However, because the purpose of vector map watermarking is to verify whether a pirated map has been copied, this seems to be the end step of this security strategy. Therefore, vector map watermarking is not a suitable method for ensuring secure transmission and storage of a map.

Perceptual encryption of multimedia contents degrades the quality of the content according to the security or quality requirements for previewing the secure media content [25]. Fig. 2
                      shows the concept of perceptual encryption. The control factor handles the quality degradation corresponding to the encryption strength. In general, perceptual encryption is realized by partial encryption algorithms with a format-compliant feature. The focus of most perceptual encryption algorithms has been on images and video in a compressed domain [26–30]. These various perceptual encryption techniques for multimedia were investigated, and it has been found that perceptual encryption techniques for GIS as the vector data, which is an important multimedia tool, have been inadequate thus far. Only conventional network securities and file encryptions are applied for map security. However, these methods present several issues regarding computation complexity and fast database access. Encrypting a large volume of map data using existing encryption algorithms, such as Advanced Encryption Standard (AES), Data Encryption Standard (DES), etc., consumes a vast amount of processing time and computational volume. In addition, when an authorized user wants to access a map of some specified locations from the encrypted map database, the database server must decrypt all the map data files related to the specified locations. This causes a large temporal delay and computational cost. We address current vector map encryption techniques in this section.

Map cryptographic techniques for the security of vector maps have been researched in the context of secure map datasets. Many conventional works [4–8] manage map datasets by using access control on the Web or a database. Bertino et al. [4] discuss technical challenges raised by the unique requirements of secure geospatial data management such as access control, security, and privacy policies, as well as the development of secure and, in particular, interoperable GIS applications. The authors [5] present an approach to the definition of an access control system for spatial data on the Web. Similar works have been published on access control using semantic R-trees [6] and Web-oriented GIS [7]. In addition, a role-based access control model [8] was presented, but access control and management on Web or databases do not maintain security in the outflow of an authenticated user.

The following are approaches to cryptography for map datasets. Dakroury et al. [9] combined AES and RSA cryptography with a simple watermarking technique for the copyright protection of vector maps in online/offline services. This algorithm encrypts map data using an AES block cipher operator of 256 bits. Because Dakroury et al. [9] tested a low-volume map of low complexity and memory, data processing seemed to take a short time. The complexity of this algorithm will increase for a large volume of the map datasets that are widely used for vector mapping in navigation systems or Web GIS or for detailed numerical maps such as those used in military or government services. Furthermore, because this algorithm encrypts map data without considering geographical features, it has a disadvantage in that it has to decrypt the entire map data in order to extract parts of layers or features. Li [10] encrypted the vector dataset in an external Oracle DBMS by using DES and an R-tree spatial index. This algorithm encrypts the spatial index when the map dataset is transmitted to the client and designs the key management of public and private keys on a PKI system. However, this algorithm does not keep the security of the vector map on the DBMS because it focuses on DBMS security and does not provide support for various data formats. Wu et al. [11] proposed a compound chaos-based encryption algorithm of vector data by considering the storage characteristics and sensitivity of the initial values and parameters of chaos-based systems. This algorithm does not provide support for various data formats and object indexing. Aiming at low complexity, fast object indexing and online/offline availability to overcome the disadvantages of conventional works, we present in this paper a partial encryption algorithm using position and direction parameters in the vector compression domain as a kind of perceptual encryption technique. By randomly modifying all the verticesʼ positions and their directions from the preceding vertices via our encryption scheme, the original vector map data that indicate specified geographical locations can be tangled up, making them unrecognizable perceptually, that is, by the human eye. We propose developing the perceptual encryption on polyline and polygon datasets so that it can be applied across various data formats. We present some map cryptography and compression algorithms to ensure the security and transmission efficiency of GIS maps. If these algorithms are combined with vector map compression, the efficiency of both security and compression will be improved. We also address current vector map encryption techniques in this section.

Many researchers have worked on the loss or lossless compression of the vector map. For the secure transmission and storage of a large volume of map datasets or a detailed map, lossless compression is more useful than lossy compression because a map dataset has to be reversible. In this subsection, we discuss some works on vector map compression. Kolesnikov et al. [31] presented a compression algorithm using polygon approximation and encoded low-resolution data and quantization errors by arithmetic coding for progressive transmission of vector maps in a narrowband network. Despite high compression and short computation time, Kolesnikov et al.ʼs algorithm [31] can be applied only to polygon data. Furthermore, their algorithm has a long processing time and causes the compression ratio to decrease rapidly when handling complex topography such as that on a digital map. Kolesnikov et al. [32] also presented the data reduction algorithm by using a near-optimal approximation of multiple polygonal curves. Because their data reduction algorithm simplifies loss compression, it is difficult to apply to a detailed map that demands the precision of vector data. Shekhar et al. [33] designed a dictionary algorithm for map compression that minimizes errors of approximation for locations of spatial objects in a map. Because their algorithm is irreversible, it is difficult to apply to the lossless compression of a large volume of map datasets. Loup et al. [34] presented compression based on a wavelet transform of longitudes and latitudes in a vector map. However, it is difficult to compact spectral energies from large numerical maps and to apply reversible applications because of quantization errors and integer loss in the transform process. For map simplification, Xingchun et al. [35] presented an accelerated algorithm of the Douglas–Peucker algorithm for polyline simplification of vector maps. Park et al. [36] presented the hybrid line simplification for segmenting and simplifying linear features on the basis of quantitative characteristics of a line. However, these algorithms are irreversible and therefore, have difficulty being applied to the secure transmission of a detailed map. General data compression algorithms, such as zlib, 7-zip, rar, and alz [37–40], can be performed for lossless compression of vector maps, but these compression algorithms cannot produce high compression efficiency and cannot be used to easily access data without recovering the compressed data.

We have designed a hierarchical lossless compression algorithm of polylines and polygons for the secure transmission and storage of a large volume of map datasets or detailed numerical maps. This compression algorithm will be effective for combining map cryptography.

@&#OVERVIEW@&#

In this paper, we propose a novel perceptual map encryption and compression technique based on spatial energy compaction (SEC). In our technique, individual compression processes are first performed on each object (polyline or polygon) of the vector map. To classify components that are similar to compact spatial redundancies, the mean distance of each object and the verticesʼ directions from its mean position are separated in the compression process. While an object is compressed, our perceptual encryption is performed for the separated mean distance and directions of related vertices. Generally, the process of compression and encryption for a large volume of map datasets requires a long execution time and has a high computational cost. The aim of this paper is to present perceptual encryption for the secure transmission and storage of a large volume of map datasets with a high compression ratio to achieve low complexity and fast object indexing in a compressed map. Because our encryption uses only one coordinate value and sign bit in the number of vertices of the related object, the computational cost for map encryption is minimized. In addition, because compression and encryption schemes are applied to each object of map data individually, the necessary objects at the specified location in the map data can be decoded and decrypted without decoding and decrypting all of the map data.

Our algorithm consists of SEC-based compression and perceptual encryption of spatial positions and directions, as shown in Fig. 3
                        . Our algorithm encrypts two parameters of MCO units, mean distance and direction information generated from the compression, through a separating process. It ensures that two separate encryptions are independent. Because the position encryption randomizes the positions of all the objects and the direction encryption randomizes all the vertices of each object, the algorithms proposed in this paper provide perceptual encryption such that a vector map cannot be realized visually. Meanwhile, an encrypted map can be decrypted completely by using the same algorithm with the encryption schemes while the map data is decoded.

A vector map contains a number of layers. We consider that a layer L contains a number of objects of polylines and polygons, 
                           L
                           =
                           {
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           |
                           i
                           ∈
                           [
                           1
                           ,
                           |
                           L
                           |
                           ]
                           }
                        , and an object 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         contains a series of vertices, 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           =
                           {
                           
                              
                                 v
                              
                              
                                 i
                                 j
                              
                           
                           |
                           j
                           ∈
                           [
                           1
                           ,
                           |
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           |
                           ]
                           }
                        . 
                           |
                           L
                           |
                         and 
                           |
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           |
                         are cardinalities of a layer L and an object 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        . Thus, 
                           
                              
                                 v
                              
                              
                                 i
                                 j
                              
                           
                         indicates jth vertex in ith object 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         of a layer L and is defined as two coordinate values: 
                           
                              
                                 v
                              
                              
                                 i
                                 j
                              
                           
                           =
                           (
                           
                              
                                 x
                              
                              
                                 i
                                 j
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 i
                                 j
                              
                           
                           )
                        . An object has two different types of polylines and polygons. Coordinate values of a vertex are represented as 64-bit floating points.

We generate MCOs of objects in layers and encode them individually. An MCO consists of its label or ID, data size of the MCO, minimum bounding rectangle (MBR) coordinate, and a series of compressed vertex data. The MBR coordinate represents the position where this MCO belongs to the MBR, and this coordinate makes for easy accessibility of the data. Data compression is performed on MCOs for accessibility to any object in a layer. Fig. 4
                         shows the structure of an MCO.

The vertex data must be processed by considering the precision degree for data accuracy. We divide all vertices in an object 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         to integer part 
                           
                              
                                 Z
                              
                              
                                 i
                              
                           
                         and fraction part 
                           
                              
                                 D
                              
                              
                                 i
                              
                           
                           ;
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 Z
                              
                              
                                 i
                              
                           
                           +
                           
                              
                                 D
                              
                              
                                 i
                              
                           
                           =
                           {
                           
                              
                                 v
                              
                              
                                 i
                                 j
                              
                           
                           =
                           
                              
                                 z
                              
                              
                                 i
                                 j
                              
                           
                           +
                           
                              
                                 d
                              
                              
                                 i
                                 j
                              
                           
                           |
                           j
                           ∈
                           [
                           1
                           ,
                           |
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           |
                           ]
                           }
                        . Two parts are controlled by multiplying the precision degree and are processed separately.
                           
                              (1)
                              
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             v
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             z
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       +
                                       
                                          
                                             d
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       |
                                    
                                    j
                                    ∈
                                    
                                       [
                                       1
                                       ,
                                       |
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       |
                                       ]
                                    
                                    }
                                 
                                 
                                 where 
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 
                                    ⌊
                                    
                                       
                                          v
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    ×
                                    
                                       
                                          10
                                       
                                       
                                          
                                             
                                                c
                                             
                                             
                                                z
                                             
                                          
                                       
                                    
                                    ⌋
                                 
                                  and 
                                 
                                    
                                       d
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       10
                                    
                                    
                                       
                                          
                                             c
                                          
                                          
                                             d
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    ×
                                    
                                       
                                          10
                                       
                                       
                                          
                                             
                                                c
                                             
                                             
                                                z
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          z
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    )
                                 
                              
                           
                         
                        
                           
                              
                                 c
                              
                              
                                 z
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 d
                              
                           
                         are the precision degrees for integer part and fraction part, respectively. Generally, the decimal place in vector map is six. If two degrees are set to 2, two decimal places will be converted to integers. This means that the basic precision of processing data is measured in centimeters in transverse Mercator (TM) coordinate typed map data. In our paper, we set 
                           
                              
                                 c
                              
                              
                                 z
                              
                           
                           =
                           0
                         and 
                           
                              
                                 c
                              
                              
                                 d
                              
                           
                           =
                           6
                         in order to map data after lossy compression has at least 1-m precision.

The integer part 
                              
                                 
                                    Z
                                 
                                 
                                    i
                                 
                              
                            will be compressed by SEC using the data structure of a Shapefile format. A Shapefile contains 2D coordinate values: MBR for a layer and MBRs for objects in a layer. An MBR of a layer L is denoted as 
                              B
                              (
                              L
                              )
                              =
                              (
                              
                                 
                                    B
                                 
                                 
                                    min
                                 
                              
                              (
                              L
                              )
                              ,
                              
                                 
                                    B
                                 
                                 
                                    max
                                 
                              
                              (
                              L
                              )
                              )
                           . Another MBR of an object 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                            is denoted as 
                              B
                              (
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              (
                              
                                 
                                    B
                                 
                                 
                                    min
                                 
                              
                              (
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                              
                                 
                                    B
                                 
                                 
                                    max
                                 
                              
                              (
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              )
                              )
                           . The process of SEC is shown in Fig. 5
                           . In the SEC process, we find positive values 
                              {
                              Δ
                              
                                 
                                    B
                                 
                                 
                                    +
                                 
                              
                              (
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              )
                              }
                            among differences between object MBRs and a layer MBR,
                              
                                 (2)
                                 
                                    Δ
                                    
                                       
                                          B
                                       
                                       
                                          +
                                       
                                    
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             min
                                          
                                       
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       −
                                       
                                          
                                             B
                                          
                                          
                                             min
                                          
                                       
                                       (
                                       L
                                       )
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             max
                                          
                                       
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       −
                                       
                                          
                                             B
                                          
                                          
                                             max
                                          
                                       
                                       (
                                       L
                                       )
                                       )
                                    
                                    
                                    for 
                                    
                                       
                                          B
                                       
                                       
                                          min
                                       
                                    
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    >
                                    
                                       
                                          B
                                       
                                       
                                          min
                                       
                                    
                                    (
                                    L
                                    )
                                     and 
                                    
                                       
                                          B
                                       
                                       
                                          max
                                       
                                    
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          B
                                       
                                       
                                          max
                                       
                                    
                                    (
                                    L
                                    )
                                 
                              
                            and find vertices 
                              {
                              Δ
                              
                                 
                                    z
                                 
                                 
                                    i
                                    j
                                 
                                 
                                    +
                                 
                              
                              }
                            where the distances between the minimum coordinate 
                              
                                 
                                    B
                                 
                                 
                                    min
                                 
                              
                              (
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              )
                            of 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                            and the integer parts 
                              
                                 
                                    z
                                 
                                 
                                    i
                                    j
                                 
                              
                            of vertices 
                              
                                 
                                    v
                                 
                                 
                                    i
                                    j
                                 
                              
                              (
                              ⊂
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              )
                            are positive.
                              
                                 (3)
                                 
                                    Δ
                                    
                                       
                                          z
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          +
                                       
                                    
                                    =
                                    
                                       
                                          z
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          B
                                       
                                       
                                          min
                                       
                                    
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    
                                    for 
                                    
                                       
                                          z
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    >
                                    
                                       
                                          B
                                       
                                       
                                          min
                                       
                                    
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              
                            Positive distance MBRs 
                              {
                              Δ
                              
                                 
                                    B
                                 
                                 
                                    +
                                 
                              
                              (
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              )
                              }
                            are stored in the MBR code field of jth MCOʼs structure, as shown in Fig. 4. These MBRs are used as reference values for minimizing data sizes of vertices in an MCO. Each vertex value in an MCO presents a minimized differential value by Eq. (3). Furthermore, the MBRs can search their objects quickly without decoding payload. The payload of an MCO consists of MCO offset, deviation sign, and intensity for the integer part, and hierarchical byte code of the fractional part, as shown in Fig. 4.

Define the deviation 
                              
                                 
                                    Δ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    i
                                    j
                                 
                              
                            of an integer part of 
                              
                                 
                                    v
                                 
                                 
                                    i
                                    j
                                 
                              
                            by subtracting the mean 
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                            of positive distances 
                              {
                              Δ
                              
                                 
                                    z
                                 
                                 
                                    i
                                    j
                                 
                                 
                                    +
                                 
                              
                              }
                            from the distance 
                              Δ
                              
                                 
                                    z
                                 
                                 
                                    i
                                    j
                                 
                              
                           ,
                              
                                 (4)
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    Δ
                                    
                                       
                                          z
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    −
                                    Δ
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                       
                                          +
                                       
                                    
                                    =
                                    sgn
                                    
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       )
                                    
                                    ×
                                    
                                       |
                                       
                                          
                                             Δ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       |
                                    
                                    
                                    where 
                                    Δ
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                       
                                          +
                                       
                                    
                                    =
                                    
                                       ∑
                                       j
                                    
                                    Δ
                                    
                                       
                                          z
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          +
                                       
                                    
                                    
                                       
                                          /
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                            
                           
                              
                                 
                                    N
                                 
                                 
                                    i
                                 
                              
                            is the number of positive distances in an object 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           . We obtain deviations 
                              
                                 
                                    Δ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    Z
                                 
                                 
                                    i
                                 
                              
                            of all vertices in an object 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              :
                              
                                 
                                    Δ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    Z
                                 
                                 
                                    i
                                 
                              
                              =
                              {
                              
                                 
                                    Δ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    i
                                    j
                                 
                              
                              |
                              j
                              ∈
                              [
                              1
                              ,
                              |
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              |
                              ]
                              }
                           . Because deviations are signed value vectors, we separate them into signs and amplitudes. The deviation amplitude 
                              |
                              
                                 
                                    Δ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    i
                                    j
                                 
                              
                              |
                            should be smaller than the integer part 
                              
                                 
                                    z
                                 
                                 
                                    i
                                    j
                                 
                              
                            because of the correlation of neighboring vertices. Fig. 6
                            illustrates an example of the SEC process for a polyline object. The sign and amplitude of deviation of the integer part are stored by turns in the integer code, as shown in Fig. 4. The deviation signs are denoted as
                              
                                 (5)
                                 
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                s
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          sgn
                                          
                                             (
                                             
                                                
                                                   Δ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   z
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             )
                                          
                                          |
                                       
                                       j
                                       ∈
                                       
                                          [
                                          1
                                          ,
                                          |
                                          
                                             
                                                P
                                             
                                             
                                                j
                                             
                                          
                                          |
                                          ]
                                       
                                       }
                                    
                                 
                              
                            The mean distance 
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                            and deviation signs 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                            are perceptually encrypted.

Unlike the integer part, the fractional part 
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                            in Eq. (1) can be used to describe the precise position of vector data, and it is sensitive to small variations. Therefore, it is difficult to find the correlation of fractional numbers. Any geographical application such as mobile or navigation uses the approximated vertex data generally. The fractional part is less necessary to special applications or any user that does not ask for a precise position. Therefore, the SEC process for the fraction part compresses them hierarchically according to degree of precision, as shown Fig. 6. Users can decode the fraction part to the degree of precision as the user chooses.

Considering that 
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                 
                              
                            in Eq. (1) is W bits, we segment the fractional number 
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                 
                              
                            to H bits (
                              W
                              >
                              H
                           ) to hierarchically control the precision. Thus, lth segmented bits 
                              
                                 
                                    A
                                 
                                 
                                    l
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                 
                              
                              )
                            of 
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                 
                              
                            can be defined as
                              
                                 (6)
                                 
                                    
                                       
                                          A
                                       
                                       
                                          l
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          d
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    ≫
                                    (
                                    W
                                    −
                                    H
                                    ×
                                    l
                                    )
                                    
                                    where 
                                    l
                                    ∈
                                    
                                       [
                                       0
                                       ,
                                       
                                          ⌈
                                          
                                             W
                                             H
                                          
                                          ⌉
                                       
                                       ]
                                    
                                 
                              
                            For example, when W is 24 bits and H is 4 bits, the number of segmented bits including NULL bits is 7. The segmented bits are as follows: 
                              
                                 
                                    A
                                 
                                 
                                    0
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                 
                              
                              )
                              :
                              0
                            bit (NULL), 
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                 
                              
                              )
                              :
                              0
                              
                                 th
                              
                              –
                              3
                              
                                 rd
                              
                            bits, 
                              
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                 
                              
                              )
                              :
                              4
                              
                                 th
                              
                              –
                              7
                              
                                 th
                              
                               
                              bits
                           , …, 
                              
                                 
                                    A
                                 
                                 
                                    6
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                 
                              
                              )
                              :
                              20
                              
                                 th
                              
                              –
                              23
                              
                                 rd
                              
                               
                              bits
                           . If the precision degree needs to be two levels, bits of 
                              
                                 
                                    A
                                 
                                 
                                    0
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                 
                              
                              )
                              ,
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                 
                              
                              )
                              ,
                              
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                 
                              
                              )
                            will be stored. Thus, the fraction part can be stored hierarchically by the precision degree. The code for the fraction part is given in Fig. 4.

Through the above process, we code an object of polyline or polygon to MCO data as shown in Fig. 3 and again compress MCO data by the entropy coder. The entropy coder can be used by LZ77, zlib based on Huffman coding, 7z based on LZMA (Lempel–Ziv–Markov chain algorithm), and so on. All of the entropy-coded MCO data are stored to a format similar to the SHP format. Principal data of MCO code for an object 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                            are MBR (
                              Δ
                              
                                 
                                    B
                                 
                                 
                                    min
                                 
                              
                              (
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                              Δ
                              
                                 
                                    B
                                 
                                 
                                    max
                                 
                              
                              (
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              )
                           ), sign and amplitude of deviation for the integer part, and hierarchical code for the fractional part.

Our algorithm perceptually encrypts two parameters of 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         by two different keys, called position key 
                           
                              
                                 K
                              
                              
                                 P
                              
                           
                         and direction key 
                           
                              
                                 K
                              
                              
                                 D
                              
                           
                        . Two encrypted parameters are the mean distance 
                           Δ
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 i
                              
                              
                                 +
                              
                           
                         and deviation signs 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                         that are generated in the compression step. They are included in the MCO code for an object.

We encrypt the mean distance 
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                            of 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                            by the perceptual position encryption 
                              
                                 
                                    C
                                 
                                 
                                    P
                                 
                              
                              (
                              ⋅
                              )
                            with a position key 
                              
                                 
                                    K
                                 
                                 
                                    P
                                 
                              
                           .
                              
                                 (7)
                                 
                                    E
                                    
                                       (
                                       Δ
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                          
                                          
                                             +
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          C
                                       
                                       
                                          P
                                       
                                    
                                    
                                       (
                                       Δ
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                          
                                          
                                             +
                                          
                                       
                                       ,
                                       
                                          
                                             K
                                          
                                          
                                             P
                                          
                                       
                                       )
                                    
                                 
                              
                            Because the encrypted position 
                              E
                              (
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                              )
                            is a geospatial coordinate, the geospatial region of layer should be divided into small gridded regions for the coordinate permutation. Hence, we divide a layer L into 
                              N
                              ×
                              N
                            gridded local areas (GLAs) within a layer MBR, (
                              
                                 
                                    B
                                 
                                 
                                    min
                                 
                              
                              (
                              L
                              )
                              ,
                              
                                 
                                    B
                                 
                                 
                                    max
                                 
                              
                              (
                              L
                              )
                           ), and a gridded number 
                              
                                 
                                    2
                                 
                                 
                                    N
                                 
                              
                           , as shown in Fig. 7
                           .

Given 
                              
                                 
                                    B
                                 
                                 
                                    min
                                 
                              
                              (
                              L
                              )
                              =
                              (
                              
                                 
                                    x
                                 
                                 
                                    min
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    min
                                 
                              
                              )
                            and 
                              
                                 
                                    B
                                 
                                 
                                    max
                                 
                              
                              (
                              L
                              )
                              =
                              (
                              
                                 
                                    x
                                 
                                 
                                    max
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    max
                                 
                              
                              )
                           , a GLA is a 2D rectangular area with the size 
                              Δ
                              G
                              x
                              ×
                              Δ
                              G
                              y
                            on two axes.
                              
                                 (8)
                                 
                                    Δ
                                    G
                                    x
                                    =
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                max
                                             
                                          
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                min
                                             
                                          
                                       
                                       
                                          
                                             2
                                          
                                          
                                             N
                                          
                                       
                                    
                                    ,
                                    
                                    Δ
                                    G
                                    y
                                    =
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                max
                                             
                                          
                                          −
                                          
                                             
                                                y
                                             
                                             
                                                min
                                             
                                          
                                       
                                       
                                          
                                             2
                                          
                                          
                                             N
                                          
                                       
                                    
                                 
                              
                            Therefore, (
                              m
                              ,
                              n
                           )th GLA 
                              G
                              (
                              m
                              ,
                              n
                              )
                            can be defined as a center point 
                              g
                              (
                              m
                              ,
                              n
                              )
                              =
                              (
                              (
                              m
                              +
                              1
                              /
                              2
                              )
                              Δ
                              G
                              x
                              ,
                              (
                              n
                              +
                              1
                              /
                              2
                              )
                              Δ
                              G
                              y
                              )
                            and a size 
                              Δ
                              G
                              =
                              (
                              Δ
                              G
                              x
                              ,
                              Δ
                              G
                              y
                              )
                            for (
                              m
                              ,
                              n
                              ∈
                              [
                              1
                              ,
                              
                                 
                                    2
                                 
                                 
                                    N
                                 
                              
                              ]
                           ). The number of GLAs depends on N, which can be used as the key. The position encryption randomly permutes 
                              
                                 
                                    2
                                 
                                 
                                    N
                                 
                              
                              ×
                              
                                 
                                    2
                                 
                                 
                                    N
                                 
                              
                            GLAs by permutation table T; 
                              T
                              (
                              G
                              (
                              m
                              ,
                              n
                              )
                              )
                              =
                              G
                              (
                              
                                 
                                    m
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                              )
                            for 
                              m
                              ,
                              n
                              ,
                              
                                 
                                    m
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              [
                              1
                              ,
                              
                                 
                                    2
                                 
                                 
                                    N
                                 
                              
                              ]
                           . Hereby, an object 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                            in a GLA can be described by the index 
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                            and deviation 
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                            on a GLA.
                              
                                 (9)
                                 
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       ⌊
                                       
                                          
                                             Δ
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                                
                                                   +
                                                
                                             
                                          
                                          
                                             Δ
                                             G
                                          
                                       
                                       ⌋
                                    
                                    ,
                                    
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    Δ
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                       
                                          +
                                       
                                    
                                    −
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    Δ
                                    G
                                 
                              
                            From Eq. (9), the mean distance 
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                            can be rewritten as 
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                              =
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              Δ
                              G
                              +
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                           . By encrypting again the permuted index 
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           , the mean distance 
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                            of an object 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                            is encrypted by the perceptual position encryption 
                              
                                 
                                    C
                                 
                                 
                                    P
                                 
                              
                              (
                              ⋅
                              )
                            as follows:
                              
                                 (10)
                                 
                                    E
                                    
                                       (
                                       Δ
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                          
                                          
                                             +
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          C
                                       
                                       
                                          P
                                       
                                    
                                    
                                       (
                                       Δ
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                          
                                          
                                             +
                                          
                                       
                                       ,
                                       
                                          
                                             K
                                          
                                          
                                             P
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          E
                                       
                                       
                                          P
                                       
                                    
                                    (
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          P
                                       
                                    
                                    )
                                    Δ
                                    G
                                    +
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                            
                           
                              
                                 
                                    E
                                 
                                 
                                    P
                                 
                              
                            can be used in the encryption algorithms XOR, AES, DES, and others. For our scheme, we used an XOR operator that has the lowest complexity and similar encryption efficiencies through experiments. In our experiment, we used 
                              N
                              =
                              8
                            randomly extracted from hashed keys of 256 bits. As a result, the geographical position of a target object, such as the question mark in Fig. 7, can be randomized onto GLAs so that the human eye can perceive it via the position encryption process.

Although the perceptual position encryption perceptually encrypts the positions of all objects in the target vector map, the encrypted map maintains to some degree the geometric shape of the object. Any pirate who has intercepted the original and encrypted vector maps can trace back the encryption key by matching the object pairs having the same vertex number and shape through some complex processes, such as known plaintext attack (KPA). We secondarily perform encryption on the directions of all vertices in an object to prevent this kind of KPA and to improve security.

The deviation signs 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                            [see Eq. (5)] in the MCO payload of an object 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                            represent the directions of vertices in 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           . The perceptual direction encryption 
                              
                                 
                                    C
                                 
                                 
                                    D
                                 
                              
                              (
                              ⋅
                              )
                            encrypts the deviation signs 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                            using the direction key 
                              
                                 
                                    K
                                 
                                 
                                    D
                                 
                              
                           .
                              
                                 (11)
                                 
                                    E
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          C
                                       
                                       
                                          D
                                       
                                    
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          D
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          E
                                       
                                       
                                          D
                                       
                                    
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          D
                                       
                                    
                                    )
                                 
                              
                            
                           
                              
                                 
                                    E
                                 
                                 
                                    D
                                 
                              
                              (
                              ⋅
                              )
                            is used as an XOR cipher that is the same as 
                              
                                 
                                    E
                                 
                                 
                                    P
                                 
                              
                              (
                              ⋅
                              )
                            in perceptual position encryption. Fig. 8
                            shows an example of perceptual direction encryption. When vector data are compressed by our scheme, as described in Section 3.1, each sign vector 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                            and deviation 
                              
                                 
                                    Δ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    Z
                                 
                                 
                                    i
                                 
                              
                            are separated in the SEC process. Here, each sign value 
                              
                                 
                                    s
                                 
                                 
                                    i
                                    j
                                 
                              
                            of 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                            represents a directivity component of related vertex 
                              
                                 
                                    z
                                 
                                 
                                    i
                                    j
                                 
                              
                            about the mean distance 
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                           . As we apply our direction encryption to these sign values 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                           , vector directions of every vertex in the object are changed randomly, as shown on the right side of Fig. 8. In Fig. 8, after the direction encryption, the objectʼs shape is completely distorted from the original, perceptually. Because 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                            has only 
                              2
                              
                                 
                                    N
                                 
                                 
                                    i
                                 
                              
                            bits of data size, our encryption scheme can be performed simply with low computational complexity.

We generate two keys using counter (CTR) mode encryption [41] for low complexity and low overload of padding data. CTR-mode encryption was recommended for block cipher modes of operation by the National Institute of Standards and Technology (NIST) in SP800-38A. This encryption generates the key stream using the CTR, which increases one by one every time and encrypts simply the plain text by the key stream. We hash the message M to a key value with one block size among 64/128/256 bits and encrypt a hashed message 
                              
                                 
                                    M
                                 
                                 
                                    h
                                 
                              
                            by an AES block cipher with a CNT value cnt. The CNT value consists of nonce, which is allocated for a relative vector map and increments using vector map components. This length is the same as the message length. Our algorithm uses the increment parameter j for the order of objects for encrypting. Thus, we attain the stability of perceptual encryption by CTR-mode encryption [41].


                           Fig. 9
                            shows the generation process of the position key 
                              
                                 
                                    K
                                 
                                 
                                    P
                                 
                              
                            and the direction key 
                              
                                 
                                    K
                                 
                                 
                                    D
                                 
                              
                           . Two keys are generated by varying on the order i of the MCO to avoid index redundancy. The lengths of 
                              
                                 
                                    K
                                 
                                 
                                    P
                                 
                              
                            and 
                              
                                 
                                    K
                                 
                                 
                                    D
                                 
                              
                            are determined by perceptual position encryption and the number of vertices in an object 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           , respectively.

As shown in Fig. 7, the number of GLAs affects the permutation complexity of each object in the process of perceptual position encryption. Moreover, it is possible for some MCOs of objects to be included in the same local area by following our perceptual position encryption. In this case, they will be permuted to the same coordinate if the same key is used. To avoid this redundancy, we vary the position key 
                              
                                 
                                    K
                                 
                                 
                                    P
                                 
                              
                            depending on the MCO order j as follows:
                              
                                 (12)
                                 
                                    
                                       
                                          K
                                       
                                       
                                          P
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      P
                                                   
                                                
                                                (
                                                i
                                                −
                                                1
                                                )
                                                ≪
                                                1
                                                +
                                                1
                                                ,
                                             
                                             
                                                if 
                                                MSB of 
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      P
                                                   
                                                
                                                (
                                                i
                                                −
                                                1
                                                )
                                                =
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      P
                                                   
                                                
                                                (
                                                i
                                                −
                                                1
                                                )
                                                ≪
                                                1
                                                ,
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                            and divide 
                              
                                 
                                    K
                                 
                                 
                                    P
                                 
                              
                              (
                              i
                              )
                            to keys on 
                              x
                              ,
                              y
                            axes.
                              
                                 (13)
                                 
                                    
                                       
                                          K
                                       
                                       
                                          P
                                       
                                    
                                    (
                                    j
                                    )
                                    =
                                    
                                       (
                                       
                                          
                                             k
                                          
                                          
                                             P
                                          
                                       
                                       (
                                       j
                                       ,
                                       x
                                       )
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             P
                                          
                                       
                                       (
                                       j
                                       ,
                                       y
                                       )
                                       )
                                    
                                 
                              
                            where 
                              
                                 
                                    k
                                 
                                 
                                    P
                                 
                              
                              (
                              j
                              ,
                              x
                              )
                            and 
                              
                                 
                                    k
                                 
                                 
                                    P
                                 
                              
                              (
                              j
                              ,
                              y
                              )
                            are, respectively, even and odd bits of 
                              
                                 
                                    K
                                 
                                 
                                    P
                                 
                              
                              (
                              j
                              )
                           . 
                              
                                 
                                    K
                                 
                                 
                                    P
                                 
                              
                              (
                              j
                              )
                            and 
                              
                                 
                                    K
                                 
                                 
                                    D
                                 
                              
                              (
                              j
                              )
                            are applied to two perceptual encryptions in each of Eqs. (13) and (14).

Performing the above process minimizes the redundancy of keys because keys are different on the orders of objects about existing different objects in a GLA. Moreover, encrypted objects move to various positions, even though they are within identical GLAs.

@&#EXPERIMENTAL RESULTS@&#

To evaluate the performance of our perceptual encryption and compression technique, we used many different scaled maps. Fig. 10
                      shows different scaled maps that contain layers of a contour at an elevation of 100 m, including buildings, administrative districts, rivers, and eight kinds of streets. Each test map has different layers and objects. Figs. 11
                      and 12
                      show layers of building and street in Cost city map of Fig. 10(a) and in downtown map of Fig. 10(b). Many methods compress the vector data using vector simplification [35,36]. However, these simplification methods are not suitable for highly detailed maps, which are the focus of this paper. Most conventional works on vector map security depend on data encryption and network protocol for access control. However, our algorithm perceptually encrypts objects of geographical features of vector maps based on lossy and lossless compression. Because the comparative evaluation of our algorithm and existing algorithms for vector map security is ambiguous, we evaluated the performance of compression and perceptual encryption of our algorithm. Our algorithms compress the scaled map using the structure of MCOs and perceptually encrypt mean distances and deviation signs of MCOs. Therefore, we evaluated several cases of compression and two perceptual encryption cases of our algorithm.

To evaluate compression performance, we measured the RMSE (root mean square error) of the compressed maps as a unit of meter and the compression ratio on varying precisions. All vertex data have the precision of 6 decimal places. We analyzed the performance of lossless/lossy compression without or with perceptual encryption. Lossless and lossy compressions of our algorithm are classified by the precision degree in the fraction part, which is determined by the precision level l of the segmented bits in Eq. (6). The integer part is compressed by lossless SEC. We set two parameters H and W in the fraction part [Eq. (6)] to 8 bits and 20 bits. Therefore, the precision level l is from 0 to 3 and segmented bits are 
                           
                              
                                 A
                              
                              
                                 0
                              
                           
                           (
                           
                              
                                 d
                              
                              
                                 i
                                 j
                              
                           
                           )
                         (0th bit), 
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 d
                              
                              
                                 i
                                 j
                              
                           
                           )
                         (1th–8th bits), 
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                           (
                           
                              
                                 d
                              
                              
                                 i
                                 j
                              
                           
                           )
                         (9th–16th bits), 
                           
                              
                                 A
                              
                              
                                 3
                              
                           
                           (
                           
                              
                                 d
                              
                              
                                 i
                                 j
                              
                           
                           )
                         (17th–19th bits).

We performed lossless compression by setting l to 3 of the maximum level in the fraction part. This means that all of the segmented bits in the fraction part are preserved without loss: (
                              
                                 
                                    A
                                 
                                 
                                    0
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                 
                              
                              )
                              ,
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                 
                              
                              )
                              ,
                              
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                 
                              
                              )
                              ,
                              
                                 
                                    A
                                 
                                 
                                    3
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                 
                              
                              )
                           ). We compared our algorithm with zlib and 7z with public compression algorithms of 7z, zip, and rar. Table 1
                            summarizes the number of MCOs (objects), bytes of the original layer, and bytes of the compressed layer using our algorithm and using public compression algorithms. Moreover, this table lists the RMSE of compressed layers. We calculated only the data sizes for vertices and fields of each layer. These results confirm that our algorithm with 7z and zlib compresses vector maps from 20% to 48%, which is 12% to 54% lower than 7z, zip, and rar. All RMSE results are zero because they are lossless compression. Our algorithm enables users to randomly access a specified location on a compressed map without decoding the entire map because our algorithm processes MCOs individually.

We performed lossy compression by varying l from 2 to 0 in the fraction part and compressed lossy MCO data with 7z. Because the lossy compression removed segmented bits of levels from 
                              l
                              +
                              1
                            to 3, the lower level is the higher compression. The precision level 
                              l
                              =
                              3
                            indicates the lossless compression. Table 2
                            summarizes the results of loss compression with 7z including the RMSE. The level decreases, and the compression ratio increases from 1% to 3%. When l is 0, the RMSE increases rapidly. From these results, we know that 
                              l
                              =
                              1
                            is the best precision level considering both compression ratio and RMSE. In this level, the compression ratio is from 19.5% to 42.7%, and the RMSE is from 0.039 to 0.045, which are very small. This means that our algorithm has a ±4-cm margin of error topographically in practice, which can be disregarded in GIS systems.


                           Fig. 13
                            shows any magnified polygons in the original map and the lossy compressed map by precision level 
                              l
                              =
                              1
                           . Although the lossy compression by precision level 
                              l
                              =
                              1
                            causes a loss of 2% or more data, there is no perceptual difference between two layers subjectively. Furthermore, the corresponding RMSEs in meters are low enough to be ignored in Table 2. For a more reliable evaluation, we performed subjective quality assessment of lossy compressed maps by asking the opinion of two preselected volunteer groups. One was an expert group composed of 13 people working in various fields, such as watermarking, encryption, image compression, and GIS. The other was a non-expert group composed of 28 undergraduates studying various disciplines. We conducted this survey for our evaluation using these two groups as subjects, asking them if they could identify any difference between the original and our lossy compressed map, when the size is expanded from a 
                              10
                               
                              km
                              ×
                              10
                               
                              km
                            scale, as shown in Fig. 13. Table 3
                            summarizes the survey results of the subjective quality assessment of our lossy compression. As can be seen in Table 3, all the members of the expert group indicated that they could not see any degradation in the compressed vector map, whereas only one person in the non-expert group said that he could see some artifacts in the compressed map by expanding the vector maps. Generally, only 2.4% of the volunteers identified degradations caused by our lossy compression algorithm in the compressed map. These results confirm that our algorithm can service hierarchical map data with high quality for users in the Web GIS, mobile GIS, or navigation industry.

We evaluated the compression efficiency of lossy compression including perceptual encryption, which is the final output of our algorithm. Table 4
                            summarizes the results of compressions without encryption, with position encryption, and with position and direction encryptions. From this table, it can be seen that the position encryption does not affect the compression efficiency because this encryption is similar to the permutation of mean distances of MCOs, and it does not cause the alteration of compressed data. However, the direction encryption in lossy compression produces low compressions ranging from 45.6% to 66.7%, which are still lower than lossy compression that includes position encryption. This is because the direction encryption that perceptually encrypts the deviation signs makes the compacted energy diffuse. Nevertheless, our algorithm shows better performance than other compression algorithms listed in Table 1.

In our experiments, we performed a subjective evaluation of our perceptual encryptions using different encryption algorithms including AES, DES, and XOR for encryption function 
                           
                              
                                 E
                              
                              
                                 P
                              
                           
                         in Eqs. (10) and (11) and using the same key. Fig. 14
                        (a) shows two layers of polylines (upper figure) and polygons (lower figure) of a downtown area. Figs. 14(b), 14(c), and 14(d) show perceptual encrypted layers using AES, DES, and XOR, respectively, in the process of compression. From these results, perceptual encrypted layers by three encryption algorithms are not perceptually different. In addition, none of the objects can be visually paired with original objects.

We also conducted a survey to compare the encryption efficiency of the cipher functions, asking the respondents two questions. The first was whether there were any patterns among Figs. 14(b), 14(c), and 14(d), or each encrypted pair of polygon and polyline layers. The second was whether they could find same object pairs in the encrypted layers in Figs. 14(b), 14(c), or 14(d) using the original layer in Fig. 14(a). The results of these two survey questions are listed in Table 5
                        . Only three members of the non-expert group answered that there appeared to be some patterns among Figs. 14(b), 14(c), and 14(d); no one found any pair of original and encrypted objects in Fig. 14. From these survey results, we conclude that there are no slight similarities or patterns among the results of the three cipher functions and all of the cipher functions can provide good perceptual encryptions for vector maps. Meanwhile, in general, encryption using only the XOR operator has lower complexity than that using AES or DES. Hence, we used the XOR operator that has low complexity under a perceptually similar encryption level.

Encrypted layers of the Coast city map and the downtown map are shown in Figs. 15 to 18
                        
                        
                        
                        . They show the two most important layers that are encrypted by perceptual position and direction encryptions. By examining the perceptual direction encrypted layers in Figs. 15(b), 16(b), 17(b), and 18(b), one can see that directions of vertices in each object are permuted while the position of the object is preserved. Because the position of the object is not changed, the whole shape of the layer can be similar to that of the original layer. Nonetheless, the fine parts of objects cannot be easily estimated in the case of only direction encryption because the inherent shape of the object can be changed. However, if any region such as population centers has a number of small objects, this region can be estimated to a small degree using the distribution of neighboring topographies. By examining the perceptual position encrypted layers in Figs. 16(c), 17(c), 18(c), and 19(c)
                        , one can see that all objects are permuted within their layer MBRs, but the whole shapes of layers are somewhat preserved. Therefore, the geographical features in specified regions can be estimated or the encryption key may be traced back further even though they are quite difficult. However, if perceptual position and direction encryptions are performed together, as shown in Figs. 16(d), 17(d), 18(d), and 19(d), all encrypted regions cannot be estimated without knowledge of the key.

We encrypted all layers of a map except the two layers of the counter-administrative boundary to visually compare an original map with encrypted maps, as shown in Fig. 19 and Fig. 20
                        . These figures show that many objects are well encrypted on the basis of contour and administrative boundary. To improve the perceptual security, the pseudo-color can be applied to the encrypted map. For example, the color can be removed randomly or permuted, or the pseudo-color can be painted randomly.

Our algorithm uses XOR cipher for two encrypting functions 
                           
                              
                                 E
                              
                              
                                 p
                              
                           
                           (
                           )
                           ,
                           
                              
                                 E
                              
                              
                                 D
                              
                           
                           (
                           )
                         in Eqs. (10) and (11) because of its simple complexity. The primary merits of XOR cipher are that it is simple to implement and that the XOR operation is computationally inexpensive. By itself, using a constant repeating key, a simple XOR cipher can trivially be broken using frequency analysis. However, our algorithm uses the random key stream that is generated by CTR-mode encryption and that is long enough. Furthermore, only the perceptual encrypted map with a number of encrypted objects is given to anyone, but an original map is not given to anyone or does not exist. Therefore, we found that our algorithm using XOR cipher is secure because of the entropy of perceptual encryption, discussed in Section 4.4.

We measured the processing time of our algorithm to evaluate the computational complexity and presented the results in Table 4. All of the processing steps are measured: SEC compression of precision level =1 and two perceptual encryptions with key generation. In our experiments, we used an Intel i7 Quad 3.5-GHz central processing unit, 8 GB of RAM, 64-bit Windows 7 operating system, and C++ on Visual Studio 10. Our results indicate that two perceptual encryptions do not significantly increase computational time because they perform XOR cipher on two compression parameters in the process of SEC compression and the processing time depends on the number of objects such as polylines or polygons in a layer. The average processing time per an object, 
                           O
                           (
                           t
                           )
                        , is 195.97 ns in only SEC compression, 200.70 ns in SEC compression with position encryption, and 212.89 ns in SEC compression with two encryptions. Thus, given N objects in a layer, it will take approximately 
                           N
                           ×
                           O
                           (
                           t
                           )
                            
                           ns
                         to generate the perceptual encrypted layer. We believe that this processing time is short enough.

Any pirate should recover all of the encrypted objects by the statistical attacks in the perceptual encrypted map without the knowledge of keys. If the randomness of perceptual encryption is very high, it will be very difficult to recover the encrypted object. Our two perceptual encryptions are based on two keys that are generated by CTR-mode encryption, which was added in NIST SP800-38A. We believe that our perceptual encryption is secure. However, we analyzed the entropy of perceptual encrypted maps to evaluate the perceptual randomness of encrypted objects, considering the randomness evaluation of perceptual hash functions [42–44].

The entropy 
                           h
                           (
                           X
                           )
                         of a random variable X that has a probability density function (pdf) 
                           p
                           (
                           x
                        ) in the support range Ω is defined as
                           
                              (14)
                              
                                 h
                                 (
                                 X
                                 )
                                 =
                                 −
                                 
                                    ∫
                                    Ω
                                 
                                 p
                                 (
                                 x
                                 )
                                 
                                    
                                       log
                                    
                                    
                                       2
                                    
                                 
                                 p
                                 (
                                 x
                                 )
                                 
                                 d
                                 x
                              
                           
                        
                     

If 
                           h
                           (
                           X
                           )
                         is high, the random quantity of an encrypted object will be high, which implies that many trials (
                           
                              
                                 α
                              
                              
                                 h
                                 (
                                 X
                                 )
                              
                           
                           ,
                           
                           α
                           >
                           1
                        ) are required to modulate an object. Assume that two keys 
                           
                              
                                 K
                              
                              
                                 P
                              
                           
                         and 
                           
                              
                                 K
                              
                              
                                 D
                              
                           
                         are uniformly distributed.

First look over an MCO code for an object 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        . Because we encrypt two perceptual encryptions independently, the pdf for 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         becomes 
                           p
                           (
                           x
                           ,
                           y
                           )
                           =
                           
                              
                                 p
                              
                              
                                 E
                                 (
                                 Δ
                                 
                                    
                                       z
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                              
                           
                           (
                           x
                           ,
                           y
                           )
                           
                              
                                 p
                              
                              
                                 E
                                 (
                                 S
                                 )
                              
                           
                           (
                           x
                           ,
                           y
                           )
                        . Moreover, all bold notations in this paper are 2D vectors for X, Y axes. Our scheme processes two variables on X, Y axes independently. Therefore, the joint pdf for any vector is the multiple of two pdfs.


                           
                              
                                 
                                    E
                                 
                                 
                                    P
                                 
                              
                            is used as an XOR-based CTR-mode encryption. Therefore, Eq. (10) can be rewritten as
                              
                                 (15)
                                 
                                    E
                                    
                                       (
                                       Δ
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                          
                                          
                                             +
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          E
                                       
                                       
                                          P
                                       
                                    
                                    (
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          P
                                       
                                    
                                    )
                                    Δ
                                    G
                                    +
                                    Δ
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                       
                                          +
                                       
                                    
                                    −
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    Δ
                                    G
                                    =
                                    (
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    ⊕
                                    
                                       
                                          K
                                       
                                       
                                          P
                                       
                                    
                                    −
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    Δ
                                    G
                                    +
                                    Δ
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                       
                                          +
                                       
                                    
                                    =
                                    a
                                    +
                                    z
                                 
                              
                            For simple notation, we denote the first term 
                              (
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              ⊕
                              
                                 
                                    K
                                 
                                 
                                    P
                                 
                              
                              −
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              )
                              Δ
                              G
                            as a and the second term 
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                            as z.

The range of index 
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                            is [
                              0
                              ,
                              max
                              (
                              ⌊
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                              /
                              Δ
                              G
                              ⌋
                              )
                           ] from Eq. (9). An index 
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                            can be represented by 
                              ⌈
                              
                                 
                                    log
                                 
                                 
                                    2
                                 
                              
                              (
                              max
                              (
                              ⌊
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                              /
                              Δ
                              G
                              ⌋
                              )
                              )
                              ⌉
                            bits. We know that the index is uniformly distributed because objects in most vector maps are distributed widely and uniformly. Therefore, we can estimate that 
                              (
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              ⊕
                              
                                 
                                    K
                                 
                                 
                                    P
                                 
                              
                              −
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              )
                              Δ
                              G
                            can be uniformly distributed on 
                              [
                              −
                              Δ
                              G
                              ×
                              max
                              (
                              ⌊
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                              /
                              Δ
                              G
                              ⌋
                              )
                              ,
                              Δ
                              G
                              ×
                              max
                              (
                              ⌊
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                              /
                              Δ
                              G
                              ⌋
                              )
                              ]
                           . The joint pdf 
                              
                                 
                                    p
                                 
                                 
                                    a
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                            of the first term 
                              a
                              =
                              (
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              ⊕
                              
                                 
                                    K
                                 
                                 
                                    P
                                 
                              
                              −
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              )
                              Δ
                              G
                            is
                              
                                 (16)
                                 
                                    
                                       
                                          p
                                       
                                       
                                          a
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    
                                       
                                          p
                                       
                                       
                                          a
                                       
                                    
                                    (
                                    x
                                    )
                                    
                                       
                                          p
                                       
                                       
                                          a
                                       
                                    
                                    (
                                    y
                                    )
                                    =
                                    
                                       1
                                       
                                          2
                                          Δ
                                          G
                                          x
                                          ×
                                          max
                                          (
                                          ⌊
                                          
                                             
                                                Δ
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      +
                                                   
                                                
                                                (
                                                x
                                                )
                                             
                                             
                                                Δ
                                                G
                                                x
                                             
                                          
                                          ⌋
                                          )
                                       
                                    
                                    
                                       1
                                       
                                          2
                                          Δ
                                          G
                                          y
                                          ×
                                          max
                                          (
                                          ⌊
                                          
                                             
                                                Δ
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      +
                                                   
                                                
                                                (
                                                y
                                                )
                                             
                                             
                                                Δ
                                                G
                                                y
                                             
                                          
                                          ⌋
                                          )
                                       
                                    
                                    ,
                                    
                                    for 
                                    x
                                    ,
                                    y
                                    >
                                    0
                                 
                              
                            where 
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                            is (
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                              (
                              x
                              )
                              ,
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                              (
                              y
                              )
                           ) for two axes. Similar to index distribution, the mean distance 
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                            of the second term approaches normal distribution by the central limit theorem because it is the average of uniform distributed distances. The joint pdf 
                              
                                 
                                    p
                                 
                                 
                                    z
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                            for 
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                            is
                              
                                 (17)
                                 
                                    
                                       
                                          p
                                       
                                       
                                          z
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    
                                       
                                          p
                                       
                                       
                                          z
                                       
                                    
                                    (
                                    x
                                    )
                                    
                                       
                                          p
                                       
                                       
                                          z
                                       
                                    
                                    (
                                    y
                                    )
                                    =
                                    N
                                    
                                       (
                                       
                                          
                                             m
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    N
                                    
                                       (
                                       
                                          
                                             m
                                          
                                          
                                             y
                                          
                                       
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                              
                            where 
                              
                                 
                                    m
                                 
                                 
                                    x
                                 
                              
                           , 
                              
                                 
                                    m
                                 
                                 
                                    y
                                 
                              
                            are averages of all 
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                              (
                              x
                              )
                            and 
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                              (
                              y
                              )
                            for 
                              i
                              ∈
                              [
                              1
                              ,
                              |
                              L
                              |
                              ]
                           , and 
                              
                                 
                                    σ
                                 
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                           , 
                              
                                 
                                    σ
                                 
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                            are variances of 
                              
                                 
                                    z
                                 
                                 
                                    i
                                    j
                                 
                              
                              −
                              
                                 
                                    B
                                 
                                 
                                    min
                                 
                              
                              (
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              )
                            for all 
                              i
                              ,
                              j
                            in Eq. (3).


                           
                              E
                              (
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                              )
                            is the sum of uniform variables and Gaussian variables. Because we process two variables on X, Y axes independently, the pdf 
                              
                                 
                                    p
                                 
                                 
                                    a
                                    +
                                    z
                                 
                              
                              (
                              u
                              ,
                              v
                              )
                            of 
                              E
                              (
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                              )
                            can be separated by 
                              
                                 
                                    p
                                 
                                 
                                    a
                                    +
                                    z
                                 
                              
                              (
                              u
                              )
                              
                                 
                                    p
                                 
                                 
                                    a
                                    +
                                    z
                                 
                              
                              (
                              v
                              )
                           .
                              
                                 (18)
                                 
                                    
                                       
                                          p
                                       
                                       
                                          a
                                          +
                                          z
                                       
                                    
                                    (
                                    u
                                    ,
                                    v
                                    )
                                    =
                                    
                                       
                                          p
                                       
                                       
                                          a
                                          +
                                          z
                                       
                                    
                                    (
                                    u
                                    )
                                    
                                       
                                          p
                                       
                                       
                                          a
                                          +
                                          z
                                       
                                    
                                    (
                                    v
                                    )
                                    =
                                    
                                       ∫
                                       0
                                       ∞
                                    
                                    
                                       
                                          p
                                       
                                       
                                          a
                                       
                                    
                                    (
                                    x
                                    )
                                    
                                       
                                          p
                                       
                                       
                                          z
                                       
                                    
                                    (
                                    u
                                    −
                                    x
                                    )
                                    
                                    d
                                    x
                                    
                                       ∫
                                       0
                                       ∞
                                    
                                    
                                       
                                          p
                                       
                                       
                                          a
                                       
                                    
                                    (
                                    y
                                    )
                                    
                                       
                                          p
                                       
                                       
                                          z
                                       
                                    
                                    (
                                    v
                                    −
                                    y
                                    )
                                    
                                    d
                                    y
                                    =
                                    
                                       1
                                       
                                          4
                                          
                                             
                                                b
                                             
                                             
                                                x
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          erf
                                       
                                       
                                          (
                                          
                                             
                                                u
                                                +
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      x
                                                   
                                                
                                                −
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                             
                                                
                                                   2
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          erf
                                       
                                       
                                          (
                                          
                                             
                                                u
                                                −
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      x
                                                   
                                                
                                                −
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                             
                                                
                                                   2
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    
                                       1
                                       
                                          4
                                          
                                             
                                                b
                                             
                                             
                                                y
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          erf
                                       
                                       
                                          (
                                          
                                             
                                                v
                                                +
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      y
                                                   
                                                
                                                −
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                             
                                                
                                                   2
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          erf
                                       
                                       
                                          (
                                          
                                             
                                                v
                                                −
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      y
                                                   
                                                
                                                −
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                             
                                                
                                                   2
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       )
                                    
                                 
                              
                            where 
                              
                                 
                                    b
                                 
                                 
                                    x
                                 
                              
                              =
                              Δ
                              G
                              x
                              ×
                              max
                              (
                              ⌊
                              
                                 
                                    Δ
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                       
                                          +
                                       
                                    
                                    (
                                    x
                                    )
                                 
                                 
                                    Δ
                                    G
                                    x
                                 
                              
                              ⌋
                              )
                            and 
                              
                                 
                                    b
                                 
                                 
                                    y
                                 
                              
                              =
                              Δ
                              G
                              y
                              ×
                              max
                              (
                              ⌊
                              
                                 
                                    Δ
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                       
                                          +
                                       
                                    
                                    (
                                    y
                                    )
                                 
                                 
                                    Δ
                                    G
                                    y
                                 
                              
                              ⌋
                              )
                           . The entropy 
                              H
                              a
                              +
                              z
                              (
                              x
                              ,
                              y
                              )
                            of 
                              E
                              (
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                              )
                            for an object is
                              
                                 (19)
                                 
                                    
                                       
                                          H
                                       
                                       
                                          a
                                          +
                                          z
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    −
                                    
                                       ∫
                                       0
                                       ∞
                                    
                                    
                                       ∫
                                       0
                                       ∞
                                    
                                    
                                       
                                          p
                                       
                                       
                                          a
                                          +
                                          z
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    
                                       
                                          log
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             a
                                             +
                                             z
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       )
                                    
                                    
                                    d
                                    x
                                    
                                    d
                                    y
                                    =
                                    −
                                    
                                       ∫
                                       0
                                       ∞
                                    
                                    
                                       ∫
                                       0
                                       ∞
                                    
                                    
                                       
                                          p
                                       
                                       
                                          a
                                          +
                                          z
                                       
                                    
                                    (
                                    x
                                    )
                                    
                                       
                                          p
                                       
                                       
                                          a
                                          +
                                          z
                                       
                                    
                                    (
                                    y
                                    )
                                    
                                       
                                          log
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             a
                                             +
                                             z
                                          
                                       
                                       (
                                       x
                                       )
                                       
                                          
                                             p
                                          
                                          
                                             a
                                             +
                                             z
                                          
                                       
                                       (
                                       y
                                       )
                                       )
                                    
                                    
                                    d
                                    x
                                    
                                    d
                                    y
                                    =
                                    −
                                    
                                       ∫
                                       0
                                       ∞
                                    
                                    
                                       
                                          p
                                       
                                       
                                          a
                                          +
                                          z
                                       
                                    
                                    (
                                    x
                                    )
                                    
                                       
                                          log
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             a
                                             +
                                             z
                                          
                                       
                                       (
                                       x
                                       )
                                       )
                                    
                                    
                                    d
                                    x
                                    
                                       ∫
                                       0
                                       ∞
                                    
                                    
                                       
                                          p
                                       
                                       
                                          a
                                          +
                                          z
                                       
                                    
                                    (
                                    y
                                    )
                                    
                                    d
                                    y
                                    −
                                    
                                       ∫
                                       0
                                       ∞
                                    
                                    
                                       
                                          p
                                       
                                       
                                          a
                                          +
                                          z
                                       
                                    
                                    (
                                    y
                                    )
                                    
                                       
                                          log
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             a
                                             +
                                             z
                                          
                                       
                                       (
                                       y
                                       )
                                       )
                                    
                                    
                                    d
                                    y
                                    
                                       ∫
                                       0
                                       ∞
                                    
                                    
                                       
                                          p
                                       
                                       
                                          a
                                          +
                                          z
                                       
                                    
                                    (
                                    x
                                    )
                                    
                                    d
                                    x
                                 
                              
                            Assuming that the MBR of a layer is rectangular on two axes, 
                              
                                 
                                    p
                                 
                                 
                                    a
                                    +
                                    z
                                 
                              
                              (
                              x
                              )
                            become the same as 
                              
                                 
                                    p
                                 
                                 
                                    a
                                    +
                                    z
                                 
                              
                              (
                              y
                              )
                           . Hereby, the entropy 
                              H
                              a
                              +
                              z
                              (
                              x
                              ,
                              y
                              )
                            is
                              
                                 (20)
                                 
                                    
                                       
                                          H
                                       
                                       
                                          a
                                          +
                                          z
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    −
                                    2
                                    
                                       ∫
                                       0
                                       ∞
                                    
                                    
                                       
                                          p
                                       
                                       
                                          a
                                          +
                                          z
                                       
                                    
                                    (
                                    x
                                    )
                                    
                                       
                                          log
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             a
                                             +
                                             z
                                          
                                       
                                       (
                                       x
                                       )
                                       )
                                    
                                    
                                    d
                                    x
                                    
                                       ∫
                                       0
                                       ∞
                                    
                                    
                                       
                                          p
                                       
                                       
                                          a
                                          +
                                          z
                                       
                                    
                                    (
                                    x
                                    )
                                    
                                    d
                                    x
                                 
                              
                            where
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          a
                                          +
                                          z
                                       
                                    
                                    (
                                    x
                                    )
                                    =
                                    
                                       1
                                       
                                          4
                                          
                                             
                                                b
                                             
                                             
                                                x
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          erf
                                       
                                       
                                          (
                                          
                                             
                                                x
                                                +
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      x
                                                   
                                                
                                                −
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                             
                                                
                                                   2
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          erf
                                       
                                       
                                          (
                                          
                                             
                                                x
                                                −
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      x
                                                   
                                                
                                                −
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                             
                                                
                                                   2
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       )
                                    
                                 
                              
                            and
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          x
                                       
                                    
                                    =
                                    Δ
                                    G
                                    x
                                    ×
                                    max
                                    
                                       (
                                       
                                          ⌊
                                          
                                             
                                                Δ
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      +
                                                   
                                                
                                                (
                                                x
                                                )
                                             
                                             
                                                Δ
                                                G
                                                x
                                             
                                          
                                          ⌋
                                       
                                       )
                                    
                                    .
                                 
                              
                            We compute numerically and approximately 
                              
                                 
                                    H
                                 
                                 
                                    a
                                    +
                                    z
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                            in the discrete sense:
                              
                                 (21)
                                 
                                    
                                       
                                          H
                                       
                                       
                                          a
                                          +
                                          z
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    ≈
                                    −
                                    2
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       
                                          p
                                       
                                       
                                          a
                                          +
                                          z
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    
                                       
                                          log
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             a
                                             +
                                             
                                                
                                                   z
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       )
                                    
                                    Δ
                                    x
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       
                                          p
                                       
                                       
                                          a
                                          +
                                          z
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    Δ
                                    x
                                    ,
                                    
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    j
                                    Δ
                                    x
                                 
                              
                            
                           
                              
                                 
                                    H
                                 
                                 
                                    a
                                    +
                                    z
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                            depends mainly on the size of the GLA 
                              Δ
                              G
                              x
                              ×
                              Δ
                              G
                              y
                            and the maximum of 
                              {
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                              }
                            in a map.

Perceptual direction encryption performs a bitwise XOR operator of deviation signs 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                            and direction binary key 
                              
                                 
                                    K
                                 
                                 
                                    D
                                 
                              
                            in Eq. (11).
                              
                                 (22)
                                 
                                    E
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    ⊕
                                    
                                       
                                          K
                                       
                                       
                                          D
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          E
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                s
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          ⊕
                                          
                                             
                                                k
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          |
                                       
                                       j
                                       ∈
                                       
                                          [
                                          1
                                          ,
                                          |
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          ]
                                       
                                       }
                                    
                                 
                              
                            Thus, the probability mass function 
                              
                                 
                                    p
                                 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              )
                            of encrypted deviation signs 
                              E
                              (
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              )
                            is
                              
                                 (23)
                                 
                                    
                                       
                                          p
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          p
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    
                                       
                                          p
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    =
                                    
                                       1
                                       
                                          
                                             2
                                          
                                          
                                             2
                                             |
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             |
                                          
                                       
                                    
                                    
                                    for 
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                              
                            The entropy 
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              )
                            of 
                              E
                              (
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              )
                            for an object is
                              
                                 (24)
                                 
                                    
                                       
                                          H
                                       
                                       
                                          S
                                       
                                    
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    =
                                    −
                                    
                                       
                                          log
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          1
                                          
                                             
                                                2
                                             
                                             
                                                2
                                                |
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      i
                                                   
                                                
                                                |
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    2
                                    |
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    |
                                 
                              
                            
                           
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              )
                            depends on the number of vertices in an object 
                              |
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              |
                           . In general 
                              |
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              |
                            is from 10 to 20. Hereby, 
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              )
                            is from 20 to 40.

The entropy of an MCO code for an object is the sum of two entropies 
                              
                                 
                                    H
                                 
                                 
                                    a
                                    +
                                    z
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                            and 
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              )
                           . We normalize a layer MBR (
                              
                                 
                                    B
                                 
                                 
                                    min
                                 
                              
                              (
                              L
                              )
                              ,
                              
                                 
                                    B
                                 
                                 
                                    max
                                 
                              
                              (
                              L
                              )
                           ) to 
                              
                                 
                                    10
                                 
                                 
                                    3
                                 
                              
                              ×
                              
                                 
                                    10
                                 
                                 
                                    3
                                 
                              
                            and obtain 
                              
                                 
                                    2
                                 
                                 
                                    8
                                 
                              
                              ×
                              
                                 
                                    2
                                 
                                 
                                    8
                                 
                              
                            GLAs [
                              N
                              =
                              8
                            in Eq. (8)]. Then we compute the mean and variance of 
                              {
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                              }
                            in all test maps and compute 
                              
                                 
                                    H
                                 
                                 
                                    a
                                    +
                                    z
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                            varying on the maximum of 
                              {
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                              }
                           . Fig. 21
                            shows the results of 
                              
                                 
                                    H
                                 
                                 
                                    a
                                    +
                                    z
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                            on the maximum of 
                              {
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                              }
                            and 
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              )
                            on 
                              |
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              |
                           . 
                              
                                 
                                    H
                                 
                                 
                                    a
                                    +
                                    z
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                            is from 121 to 328 on the maximum of 
                              {
                              Δ
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                              }
                           . In general, the entropy of an MCO code for an object, 
                              
                                 
                                    H
                                 
                                 
                                    a
                                    +
                                    z
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              +
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              )
                           , is from 141 to 348. It is more secure than a 128-bit key.


                           
                              
                                 
                                    H
                                 
                                 
                                    a
                                    +
                                    z
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              +
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              )
                            is the entropy for only an object. Consider entropies for two perceptual encryptions for all of the objects in a map. Because all of the objects are processed independently, the pdf of the encrypted mean distance for all objects in a map is 
                              
                                 
                                    ∏
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    |
                                    L
                                    |
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    a
                                    +
                                    z
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              =
                              
                                 
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          a
                                          +
                                          z
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    )
                                 
                                 
                                    |
                                    L
                                    |
                                 
                              
                            and the pdf of the encrypted deviation signs for all objects is 
                              
                                 
                                    ∏
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    |
                                    L
                                    |
                                 
                              
                              
                                 1
                                 
                                    
                                       2
                                    
                                    
                                       2
                                       |
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       |
                                    
                                 
                              
                           . Two entropies of these pdfs are extremely high.

@&#CONCLUSIONS@&#

In this paper, we focused on the issue of realizing perceptual encryption of vector maps with low complexity and object indexing in the compressed domain. We proposed vector compression with lossless and hierarchical precision as well as two perceptual encryption algorithms for position and direction of polyline and polygon objects. The position perceptual encryption changes all positions of polyline and polygon objects by encrypting mean points of objects. The direction perceptual encryption changes the shape of geographical feature objects by encrypting the deviation signs of vertices in objects. The encryption algorithm is used as a simple XOR cipher to minimize the complexity of a large volume of map datasets. Experimental results showed that the proposed algorithm is very effective in the perceptual encryption of a large volume of map datasets. Our algorithm can be applied to various file formats or standard vector maps because only polyline and polygon objects were encrypted and can be used for map database security of map services online/offline as well as of mobile GIS services. Furthermore, our algorithm can be applied to various vector contents such as CAD, computer graphics, and 3D content fields.

@&#ACKNOWLEDGEMENTS@&#

This work was supported under the framework of international cooperation program managed by National Research Foundation of Korea (2012K2A1A2032979) and by a grant from a Strategic Research Project (Development of Flood Warning and Snowfall Estimation Platform using Hydrological Radars) funded by the Korea Institute of Construction Technology.

@&#REFERENCES@&#

