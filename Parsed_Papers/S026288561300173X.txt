@&#MAIN-TITLE@&#Two-dimensional multi-pixel anisotropic Gaussian filter for edge-line segment (ELS) detection

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A multi-pixel anisotropic Gaussian filter is proposed for edge detection.


                        
                        
                           
                           The aim is to detect multiple edge pixels or edge-line segment within a window.


                        
                        
                           
                           The filter fully takes advantage of structural information of a boundary.


                        
                        
                           
                           The proposed filter can achieve better performance than several existing edge-detection methods.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Edge detection

Continuity

Elongation

Anisotropy

Edge-line segment

Multi-pixel anisotropic Gaussian filter

@&#ABSTRACT@&#


               Graphical abstract
               
                  
                     
                        
                           
                        
                     
                  
               
            

Burns et al. [56] empirically discovered the fact that connected regions with common gradient orientation would almost always coincide with straight edges. Recently, reference [57] showed that a complex boundary of image can be split into one or more straight line segments. Moreover, our observation shows that a straight line segment must be constructed by several (at least three) adjacent edge pixels. Such a straight line segment will be called edge-linear segment (ELS)that represents an image region or a line-support region whose points share roughly the same image gradient direction [56–58]. More importantly, an ELS possesses useful geometry-structural information that includes three characteristics [1,2]:
                        
                           Anisotropy: The presence of an edge implies that the image variation within a neighborhood around this edge pixel is anisotropic. More accurately speaking, image variation within such neighborhood is fast and slow across and along this edge, respectively.

Continuity: Multiple closely-related edges should exhibit a continuity that reflects the nature of the boundary in the physical environment. Most physical boundaries of interest are continuous in nature. Such continuity implies that there is not any isolated edge pixel.

Elongation: An image boundary is formed by a contiguous chain of edge pixels, and can be well approximated by multiple ELS, where each ELS should consist of several (at least three) edge pixels. Assume that the shortest distance between two adjacent pixels is δ, then the length of a short ELS is larger than or equal to 2δ, which is called elongation of an ELS. Such elongation shows that each edge pixel must belong to an ELS, and we should simultaneously detect multiple (at least three) related edge pixels.

The first characteristic above means that a good convolution kernel designed for edge detection should be anisotropic in order to well match the image within a neighborhood around an edge pixel. This characteristic has been extensively used in many state-of-the-art edge detectors [3]. The second characteristic above implies that if an edge pixel derived by a detector is isolated, it should be taken as the removable candidate of false positive edge pixels. The third characteristic above indicates that a size-appropriate neighborhood around each edge pixel certainly includes multiple edge pixels that can approximately form, at least, an ELS. Thus, among the multiple closely-related edges, there must be both continuity and elongation of a boundary (CEB). The CEB has been widely exploited in chain of edge points into curves [56–59].

Image edges usually convey the most relevant information [4,5] and their detection is an essential goal in computer vision and image processing [6,7]. Although identifying and localizing edges have been researched for more than 50years, they are still a very challenging task in a variety of applications [8]. Hence, the detection of edges in an image is still an important topic until now. Edge detection is the process which detects the presence and locations of these intensity transitions [9]. Giuseppe and Nicolai [3] presented a thorough overview of various edge and contour detection approaches that have been proposed in the last two decades. The reference [3] makes these approaches to be divided into global and local operators.

The global operators [3] include mainly three classes: contour saliency, grouping of pixels together in contours, and active contours. The first two classes first start from the edge strength map gotten by local operators [4,5,22]. Then, in the first class [3], contour detection uses the surrounding context and is performed by inhibiting and enhancing the edge strength map; in the second class [3,10], edge pixels are grouped together into contours in the light of the Gestalt laws of proximity, good continuation, closure, and symmetry. Especially, it is worth pointing out that several available methods [56–59] for detecting linear segments belong to the second class. Hough transform is a standard method for extraction of line segments. Many methods make edge points to be chained into curves and then cut the chains into multiple ELS by a straightness criterion [60]. Other methods make this oriented gradient response of edge map to be thresholded to detect line segments. In particular, without the edge detection step, the third class (also called snakes or deformable models) performs together both edge detection and contour extraction [3,11]. More interestingly, active contours based on the variational principle have been considered the three desirable characteristics of an ELS. They implement both contour localization and interactive contour detection with higher robustness to image degradations. However, a drawback of active contours is their higher computational complexity [3]. Another drawback of active contours is that once their cost function is non-convex, a local minimum might be reached instead of the global one. Due to the above two drawbacks, this paper will emphasize on the local methods.

The computationally simple local operators mainly include the differentiation-based methods [12], the Gaussian-based methods [13–27], multi-scale methods based on wavelets [28–32], computational neural networks [33–36], fuzzy reasoning systems [37–41], Gabor filters [42–47], and two-dimensional matched filter (TDMF) [48,49]. It is especially worth mentioning that Canny developed the isotropic operator [22] with an almost optimal vertical filter that is very well approximated by the first order derivative of a Gaussian filter. Moreover, Canny operator is computationally highly effective. However, since the isotropic Gaussian filter (IGF) [22] does not make full use of the anisotropy of image edges, IGF may not efficiently prevent edges from blurring [23].

In order to efficiently exploit the anisotropy of image edges, the so-called anisotropic filter is extensively studied in references [19,21,42–49,23–27]. Very interestingly, many existing anisotropic operators for detecting edges can be achieved by the framework of steerable filters [19,21,23–25]. In addition, the decomposition of the anisotropic Gaussian filter into a 1-D Gauss filter in the x-direction and a 1-D filter in a non-orthogonal direction φ was given by Geusebroek [26]. Furthermore, the available fast algorithms [27] were established to fast calculate the orientation-smoothed image and its derivatives. However, the first disadvantage of the anisotropic analysis [23,24] may sometimes obtain no exact basis for rotating an anisotropic Gaussian [25]. The second disadvantage is that estimating φ may be difficult in practice. The third disadvantage is that although various methods for the anisotropic analysis can sufficiently exploit anisotropy of edges, they may not fully utilize CEB.

In order to more fully exploit all the three characteristics of edges and the advantages of Canny operator, we heuristically design a new 2-D edge detection operator that satisfies the following three elementary requirements: ① The first derivative of 1-D Gaussian function should be selected as 1-D filter perpendicular to an ELS, because it is a good approximation to the optimal vertical operator. ② Due to the anisotropic nature of edges, the 2-D edge detection operator should be anisotropic so that it can effectively prevent edges from blurring. ③ The 1-D filter along an ELS should further take use of the CEB. It is worth mentioning that the proposed 2-D edge detection operator keeps the above three requirements, while some state-of-the-art methods such as the optimal steerable filters [25] usually hold the first two requirements. Hence, we expect that edges detected by the proposed methods have higher localization accuracy and stronger continuity [1]. This paper includes the following three main contributions. 1) We propose a new multi-pixel anisotropic Gaussian filter kernel to detect edges or edge-line segments, which can more efficiently use the CEB to reduce false positive rate and improve true positive rate. 2) To considerably decrease computational volume, the isotropic Gaussian filter is utilized for fast computing an initial direction along an edge, and our filter is further used to more accurately seek edge-line segment direction by a few of directional filter masks only near such initial direction. 3) Compared with the isotropic Gaussian filter, the improvement factors of the proposed filter are analyzed theoretically in 2-D space.

The remainder of this paper is organized as follows: Section 2 introduces the related works. Section 3 proposes the multi-pixel anisotropic Gaussian filter (MAGF) to exploit the three characteristics of the image near an edge as sufficiently as possible. Section 4 presents the numerical implementation of the proposed MAGF. Section 5 compares our proposed edge-detection algorithm with several existing edge-detection methods. Section 6 concludes this paper.

@&#RELATED WORKS@&#

In this section, we will first define the concept of CEB, and then briefly review Canny filter, anisotropic Gaussian filters, Gabor filters, two-dimensional matched filters, and three classes of steerable filters.

Since the key contribution of this paper is that the proposed edge detector uses CEB, we here give the definition of CEB as early as possible. Let a digital image ū(i, j) for i
                        =l,⋯,M and j=l,⋯,N have the same horizontal and vertical sampling interval δ, then the shortest distance between two adjacent pixels should be equal to δ. Conventionally, since the normalized sampling interval of a digital image is taken as 1, the smallest distance between two adjacent pixels equals 1. Edge-linear segment, continuity and elongation of boundary are defined as follows.
                           Definition 2.1
                           (ELS 
                              [56–59]): Edge-linear segment (ELS)is defined as an image region or a line-support region whose points share roughly the same gradient.

An ELS is usually characterized by a rectangle determined by its center point, angle, length, and width [57]. Let averaging directional angle and amplitude of all gradients in the line-support region be 
                           
                              θ
                              ¯
                           
                         and 
                           
                              α
                              ¯
                           
                        , respectively, and let the corresponding thresholds of directional angle and amplitude be 
                           
                              Δ
                              
                                 θ
                                 ¯
                              
                           
                         and 
                           
                              Δ
                              
                                 α
                                 ¯
                              
                           
                        , respectively. Then, the line-support region of the ELS is produced by some well-known region-growing methods for image segmentation.
                           Definition 2.2
                           Continuity


                           Assume that center pixel (m,n) for m
                              =2.,⋯,M
                              −1and n
                              =2,⋯,N
                              −1 is an edge one, then continuity of boundary means that there is at least one edge pixel in its eight adjacent pixels (m
                              −1,n), (m
                              −1,n
                              −1), (m,n
                              −1). (m
                              +1, n
                              −1), (m
                              +1, n), (m
                              +1, n
                              +1), (m,n
                              +1) and (m
                              −1,n
                              +1).

Then elongation of boundary implies that length of a short ELS is not less than 2δ.

Let a 3×3 window is formed by 9pixels (m
                        −1,n
                        −1), (m,n
                        −1), (m
                        +1, n
                        −1), (m
                        −1,n), (m, n), (m
                        +1, n), (m
                        −1,n
                        +1), (m,n
                        +1) and (m,n
                        +1), (m
                        +1,n
                        +1). Then there may be four short ELS across the center pixel (m, n), where a horizontal ELS consists of 3pixels (m
                        −1, n), (m, n) and (m
                        +1, n). A vertical ELS is formed by 3pixels (M, n
                        −1), (m, n) and (m, n+1). Two slant ELS are constructed by 3pixels (m
                        −1, n
                        −1), (m, n) and (m
                        +1, n
                        +1), and 3pixels (m
                        +1, n
                        −1), (m, n) and (m
                        −1, n
                        +1). It is obvious that the normalized length of the horizontal and vertical short ELS is 2, while the normalized length of two slant ELS is equal to 
                           
                              2
                              
                                 2
                              
                           
                        . Therefore, for detecting the short ELS of a digital image, it is reasonable to let the parallel filter of a convolution kernel have a flat region with length 2, where the flat region denotes a connected domain in which the parallel filter has the identical value. Both continuity and elongation of boundary are called CEB for short.

Let x and y be the horizontal and vertical coordinates of image, respectively. Moreover, let u and v be the Cartesian coordinates of a two-dimensional convolution kernel, then we expect that u and v are along and across an edge, respectively. Further, let orientation θ be denoted by the anti-clockwise angle between x and u. Then, u and v can be computed from x and y and are expressed as
                           
                              (2.1a)
                              
                                 
                                    u
                                    =
                                    x
                                    cos
                                    θ
                                    +
                                    y
                                    sin
                                    θ
                                 
                              
                           
                        
                        
                           
                              (2.1b)
                              
                                 
                                    v
                                    =
                                    −
                                    x
                                    sin
                                    θ
                                    +
                                    y
                                    cos
                                    θ
                                    .
                                 
                              
                           
                        
                     

An anisotropic filter kernel tuned to orientation θ is easily described as a function with respect to u and v.

Since Canny filter is isotropic, it only needs to be described by coordinates x and y. Given one dimensional image ξ(x), Canny evaluated an edge detection filter by the following three criteria:
                           
                              1)
                              Good detection. It is expected that at abscissa x
                                 =0, the signal-to-noise ratio (SNR) should be as high as possible. The criterion is described by
                                    
                                       (2.2)
                                       
                                          
                                             SNR
                                             =
                                             
                                                
                                                   
                                                      ∫
                                                      
                                                         −
                                                         ω
                                                      
                                                      ω
                                                   
                                                   
                                                      ξ
                                                      
                                                         
                                                            −
                                                            x
                                                         
                                                      
                                                      f
                                                      
                                                         x
                                                      
                                                      dx
                                                   
                                                
                                             
                                             /
                                             
                                                n
                                                0
                                             
                                             
                                                
                                                   
                                                      ∫
                                                      
                                                         −
                                                         ω
                                                      
                                                      ω
                                                   
                                                   
                                                      
                                                         f
                                                         2
                                                      
                                                      
                                                         x
                                                      
                                                      dx
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              

Good localization. The good localization criterion is defined as:
                                    
                                       (2.3)
                                       
                                          
                                             GL
                                             =
                                             
                                                
                                                   
                                                      ∫
                                                      
                                                         −
                                                         ω
                                                      
                                                      ω
                                                   
                                                   
                                                      
                                                         ξ
                                                         ′
                                                      
                                                      
                                                         
                                                            −
                                                            x
                                                         
                                                      
                                                      
                                                         f
                                                         ′
                                                      
                                                      
                                                         x
                                                      
                                                      dx
                                                   
                                                
                                             
                                             /
                                             
                                                n
                                                0
                                             
                                             
                                                
                                                   
                                                      ∫
                                                      
                                                         −
                                                         ω
                                                      
                                                      ω
                                                   
                                                   
                                                      
                                                         
                                                            f
                                                            ′
                                                         
                                                         2
                                                      
                                                      
                                                         x
                                                      
                                                      dx
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              

Only one response to a single edge. It is defined by the mean distance between two noise maxima
                                    
                                       (2.4)
                                       
                                          
                                             
                                                x
                                                max
                                             
                                             
                                                f
                                             
                                             =
                                             π
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∫
                                                            
                                                               −
                                                               ∞
                                                            
                                                            
                                                               +
                                                               ∞
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  f
                                                                  ′
                                                               
                                                               2
                                                            
                                                            
                                                               x
                                                            
                                                            dx
                                                         
                                                      
                                                      /
                                                      
                                                         
                                                            ∫
                                                            
                                                               −
                                                               ∞
                                                            
                                                            
                                                               +
                                                               ∞
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  f
                                                                  ″
                                                               
                                                               2
                                                            
                                                            
                                                               x
                                                            
                                                            dx
                                                         
                                                      
                                                   
                                                
                                                
                                                   1
                                                   /
                                                   2
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              

Based on the above three criteria, Canny derived an optimal vertical filter f (x), which can be well approximated by the first derivative of a Gaussian function G (x) exp (−x
                        2/(2σ2)). It is well-known that Canny simply took Gaussian function G (y)=exp (−y2/(2σ2))as the parallel filter that is not optimized, where direction of y is parallel to an edge. Canny filter is expressible as
                           
                              (2.5)
                              
                                 
                                    
                                       f
                                       IGF
                                    
                                    
                                       x
                                       y
                                    
                                    =
                                    −
                                    
                                       
                                          x
                                          /
                                          
                                             σ
                                             2
                                          
                                       
                                    
                                    exp
                                    
                                       
                                          −
                                          
                                             
                                                
                                                   x
                                                   2
                                                
                                                +
                                                
                                                   y
                                                   2
                                                
                                             
                                          
                                          /
                                          
                                             
                                                2
                                                
                                                   σ
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        which is just the first derivative of the IGF G(x, y)=G(x)G(y)=exp (−(x
                        2
                        +y2)/2σ2) with respect to x. Since IGF is isotropic, its gradient can be very easily computed by
                           
                              (2.6)
                              
                                 
                                    ∇
                                    G
                                    
                                       x
                                       y
                                    
                                    =
                                    
                                       
                                          
                                             
                                                −
                                                
                                                   
                                                      x
                                                      /
                                                      
                                                         σ
                                                         2
                                                      
                                                   
                                                
                                                exp
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            
                                                               x
                                                               2
                                                            
                                                            +
                                                            
                                                               y
                                                               2
                                                            
                                                         
                                                      
                                                      /
                                                      
                                                         
                                                            2
                                                            
                                                               σ
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                −
                                                
                                                   
                                                      y
                                                      /
                                                      
                                                         σ
                                                         2
                                                      
                                                   
                                                
                                                exp
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            
                                                               x
                                                               2
                                                            
                                                            +
                                                            
                                                               y
                                                               2
                                                            
                                                         
                                                      
                                                      /
                                                      
                                                         
                                                            2
                                                            
                                                               σ
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                   IGF
                                                
                                                
                                                   x
                                                   y
                                                
                                             
                                          
                                          
                                             
                                                
                                                   f
                                                   IGF
                                                
                                                
                                                   y
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Further, the gradient field is obtained by convolution of image with the gradient function (2.6).
                           Remark 2.1
                           It should be seen that the IGF does not deal with the anisotropic information of the image data near an edge, and also not fully exploit CEB. In some cases, the IGF is not sufficient. For example, isotropic smoothing causes that two parallel lines are blurred into one single line, and crossing lines are not well detected [26]. Hence, edge detection should take advantage of the anisotropic nature of edges. This is achieved by the so-called orientation analysis in which edge orientation property is sampled by multiple suitable rotated versions of an anisotropic filter.

Two-dimensional matched filters (TDMF) are anisotropic, and have been established in [48,49]. Like Canny filter, the filter perpendicular to an edge is taken as the Gaussian function G(u)=exp(−
                        u
                        2/2σ2). Like the well-known Prewitt operator and Sobel operator but unlike Canny filter, the filter function parallel to an ELS is taken as a gate function GT(v)=1for |v|≤
                        L and GT(v)=0 for |v|>
                        L. Hence, TDMF and their corresponding partial derivatives with respect to u are, respectively, described by
                           
                              (2.7a)
                              
                                 
                                    
                                       F
                                       TDMF
                                    
                                    
                                       u
                                       v
                                    
                                    =
                                    G
                                    
                                       u
                                    
                                    GT
                                    
                                       v
                                    
                                 
                              
                           
                        
                        
                           
                              (2.7b)
                              
                                 
                                    
                                       
                                          ∂
                                          
                                             F
                                             TDMF
                                          
                                          
                                             u
                                             v
                                          
                                       
                                       
                                          ∂
                                          u
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          u
                                          /
                                          
                                             σ
                                             2
                                          
                                       
                                    
                                    exp
                                    
                                       
                                          −
                                          
                                             u
                                             2
                                          
                                          /
                                          
                                             
                                                2
                                                
                                                   σ
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    GT
                                    
                                       v
                                    
                                    .
                                 
                              
                           
                        
                     

Similarly, trail at (u,v)∉[−3σ, 3σ]×[−
                        L, L] is truncated for increasing computational efficiency.

Inserting Eq. (2.1) into Eq. (2.7) yields the directional convolution kernel of TDMF as follows:
                           
                              (2.8a)
                              
                                 
                                    
                                       F
                                       TDMF
                                    
                                    
                                       θ
                                       x
                                       y
                                    
                                    =
                                    G
                                    
                                       
                                          x
                                          cos
                                          θ
                                          +
                                          y
                                          sin
                                          θ
                                       
                                    
                                    GT
                                    
                                       
                                          −
                                          x
                                          sin
                                          θ
                                          +
                                          y
                                          cos
                                          θ
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2.8b)
                              
                                 
                                    
                                       
                                          ∂
                                          
                                             F
                                             TDMF
                                          
                                          
                                             θ
                                             x
                                             y
                                          
                                       
                                       
                                          ∂
                                          u
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                   /
                                                   
                                                      σ
                                                      2
                                                   
                                                
                                             
                                             exp
                                             
                                                
                                                   −
                                                   
                                                      u
                                                      2
                                                   
                                                   /
                                                   
                                                      
                                                         2
                                                         
                                                            σ
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          u
                                          =
                                          x
                                          cos
                                          θ
                                          +
                                          y
                                          sin
                                          θ
                                       
                                    
                                    GT
                                    
                                       
                                          −
                                          x
                                          sin
                                          θ
                                          +
                                          y
                                          cos
                                          θ
                                       
                                    
                                 
                              
                           
                        where expression (2.8b) is the directional derivative of convolution kernel (2.8a) along u. Further, the edge map is obtained by convolution of image with the functions (2.8b) with multiple orientations θ.
                           Remark 2.2
                           It can be seen that TDMF basically exploit all the structural information of an ELS. It is convenient that TDMF are used for extracting features of biological image [48,49], because many features of biological image have the approximately known structures. However, TDMF applied to the natural image may not be convenient, since their parameters such as length 2L are usually unknown beforehand. In addition, it is well known that GT(v) is also called rectangular window function, and its frequency spectrum has very high sidelobes [12] that should be usually suppressed by adopting other window functions such as the Hanning or Hamming window functions.

An oriented anisotropic Gaussian filter (AGF) and its derivative with respect to u are defined as
                           
                              (2.9a)
                              
                                 
                                    
                                       F
                                       AGF
                                    
                                    
                                       u
                                       v
                                    
                                    =
                                    exp
                                    
                                       
                                          −
                                          
                                             u
                                             2
                                          
                                          /
                                          2
                                          
                                             σ
                                             1
                                             2
                                          
                                       
                                    
                                    exp
                                    
                                       
                                          −
                                          
                                             v
                                             2
                                          
                                          /
                                          2
                                          
                                             σ
                                             2
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2.9b)
                              
                                 
                                    
                                       
                                          ∂
                                          
                                             F
                                             AGF
                                          
                                          
                                             u
                                             v
                                          
                                       
                                       
                                          ∂
                                          u
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          u
                                          /
                                          
                                             σ
                                             1
                                             2
                                          
                                       
                                    
                                    exp
                                    
                                       
                                          −
                                          
                                             u
                                             2
                                          
                                          /
                                          2
                                          
                                             σ
                                             1
                                             2
                                          
                                       
                                    
                                    exp
                                    
                                       
                                          −
                                          
                                             v
                                             2
                                          
                                          /
                                          2
                                          
                                             σ
                                             2
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        where σ1 and σ2(σ1<σ2) are two standard deviations. Theoretically, Gaussian function has infinitely long double-sided trails. Trail at (u,v)∉[−3σ
                        1, 3σ
                        1]×[−3σ
                        2, 3σ
                        2] is small and should be often truncated for enhancing computational efficiency.

If expressions (2.1) are substituted into (2.9), the filtered kernel with orientation θ, and the corresponding kernel for calculating the directional derivative of the filtered image are given by, respectively,
                           
                              (2.10a)
                              
                                 
                                    
                                       F
                                       AGF
                                    
                                    
                                       θ
                                       x
                                       y
                                    
                                    =
                                    
                                       
                                          
                                             exp
                                             
                                                
                                                   −
                                                   
                                                      u
                                                      2
                                                   
                                                   /
                                                   2
                                                   
                                                      σ
                                                      1
                                                      2
                                                   
                                                
                                             
                                             exp
                                             
                                                
                                                   −
                                                   
                                                      v
                                                      2
                                                   
                                                   /
                                                   2
                                                   
                                                      σ
                                                      2
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                u
                                                =
                                                x
                                                cos
                                                θ
                                                +
                                                y
                                                sin
                                                θ
                                             
                                          
                                          
                                             
                                                v
                                                =
                                                −
                                                x
                                                sin
                                                θ
                                                +
                                                y
                                                cos
                                                θ
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2.10b)
                              
                                 
                                    
                                       
                                          ∂
                                          
                                             F
                                             AGF
                                          
                                          
                                             θ
                                             x
                                             y
                                          
                                       
                                       
                                          ∂
                                          u
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                   /
                                                   
                                                      σ
                                                      1
                                                      2
                                                   
                                                
                                             
                                             exp
                                             
                                                
                                                   −
                                                   
                                                      u
                                                      2
                                                   
                                                   /
                                                   2
                                                   
                                                      σ
                                                      1
                                                      2
                                                   
                                                
                                             
                                             exp
                                             
                                                
                                                   −
                                                   
                                                      v
                                                      2
                                                   
                                                   /
                                                   2
                                                   
                                                      σ
                                                      2
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                u
                                                =
                                                x
                                                cos
                                                θ
                                                +
                                                y
                                                sin
                                                θ
                                             
                                          
                                          
                                             
                                                v
                                                =
                                                −
                                                x
                                                sin
                                                θ
                                                +
                                                y
                                                cos
                                                θ
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Further, the edge map is obtained via convolution of image with the functions (2.10b) with several orientations θ.
                           Remark 2.3
                           The AGF has efficiently exploited anisotropic information of the image data near an edge, and preserves the first two elementary requirements just described in Section 1. However, it does not fully consider CEB.

Typical Gabor filters (GF) have been applied widely in image processing, compute vision, biological information processing [42–47]. In particular, GF have been very successfully used for texture segmentation. The two-dimensional GF associated with orientation θ is expressible as the following formula
                           
                              (2.11)
                              
                                 
                                    
                                       f
                                       GF
                                    
                                    
                                       θ
                                       x
                                       y
                                    
                                    =
                                    
                                       
                                          
                                             exp
                                             
                                                
                                                   −
                                                   
                                                      u
                                                      2
                                                   
                                                   /
                                                   2
                                                   
                                                      σ
                                                      1
                                                      2
                                                   
                                                
                                             
                                             exp
                                             
                                                
                                                   −
                                                   
                                                      v
                                                      2
                                                   
                                                   /
                                                   2
                                                   
                                                      σ
                                                      2
                                                      2
                                                   
                                                
                                             
                                             exp
                                             
                                                
                                                   j
                                                   2
                                                   π
                                                   u
                                                   /
                                                   λ
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                u
                                                =
                                                x
                                                cos
                                                θ
                                                +
                                                y
                                                sin
                                                θ
                                             
                                          
                                          
                                             
                                                v
                                                =
                                                −
                                                x
                                                sin
                                                θ
                                                +
                                                y
                                                cos
                                                θ
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The above convolution kernels can be also used as extracting edge map.
                           Remark 2.4
                           It is especially worth mentioning that the real parts exp(−
                              u
                              2/2σ
                              1
                              2)exp(−
                              v
                              2/2σ
                              2
                              2)cos(2πu/λ) of GF can be simply called even GF, and are very similar to the LoG operator and closely associated with the so-called receptive profiles of simple cortical cells. The imagine parts exp(−
                              u
                              2/2σ
                              1
                              2)exp(−
                              v
                              2/2σ
                              2
                              2)sin(2πu/λ) of GF are simply called odd GF and very similar to the AGF. Obviously, the parallel filters of GF are the same as AGF. It can be anticipated that very similarly to the LoG operator, the even Gabor filters may be also sensitive to image noise. In addition, since GF adopt the same parallel filters as the AGF, they may not fully utilize CEB.

As shown in Eqs. (2.8b), (2.10b) and (2.11), the anisotropic filters can be applied in the so-called orientation analysis [19,21–26]: accurate estimation for gradient direction of an edge is implemented by continuously tuning anisotropic filters to all possible orientations, convoluting image with all possible orientation filters, and producing all possible directional responses. Unfortunately, such accurate orientation analysis is computationally intensive [21]. Thus, ones usually adopt the following approximate orientation analysis.

Let f (θ; x, y) for θ ∈[0,π) represent an arbitrary anisotropic filter as shown in Eqs. (2.8b), (2.10b) and (2.11). Give N discrete orientations θ
                        1
                        =0, θ
                        2
                        =π/N,⋯, θN
                        
                        =(N−1)π/N and the corresponding set of filter kernels f (θi
                        ; x, y) for i
                        =1,⋯,N, then a set of the responses are defined as 
                           
                              
                                 R
                                 ¯
                              
                              
                                 
                                    θ
                                    i
                                 
                                 x
                                 y
                              
                              =
                              
                                 u
                                 ¯
                              
                              
                                 x
                                 y
                              
                              ⊗
                              f
                              
                                 
                                    θ
                                    i
                                 
                                 x
                                 y
                              
                           
                         for i
                        =1,⋯,N, where ū(x, y) is an image and symbol ⊗ denotes convolution operation. Moreover, the orientation analysis includes the following gradient field derived by
                           
                              (2.12)
                              
                                 
                                    A
                                    
                                       x
                                       y
                                    
                                    =
                                    
                                       max
                                       
                                          θ
                                          i
                                       
                                    
                                    
                                       
                                          
                                             
                                                R
                                                ¯
                                             
                                             
                                                
                                                   θ
                                                   1
                                                
                                                x
                                                y
                                             
                                          
                                       
                                       ⋯
                                       
                                          
                                             
                                                R
                                                ¯
                                             
                                             
                                                
                                                   θ
                                                   N
                                                
                                                x
                                                y
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2.13)
                              
                                 
                                    θ
                                    
                                       x
                                       y
                                    
                                    =
                                    arg
                                    
                                       max
                                       
                                          θ
                                          i
                                       
                                    
                                    
                                       
                                          
                                             
                                                R
                                                ¯
                                             
                                             
                                                
                                                   θ
                                                   1
                                                
                                                x
                                                y
                                             
                                          
                                       
                                       ⋯
                                       
                                          
                                             
                                                R
                                                ¯
                                             
                                             
                                                
                                                   θ
                                                   N
                                                
                                                x
                                                y
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

It is obvious that the maximum quantization error of direction map is equal to π/(2N). Here, a more accurate way is followed. With respect to angle θ, a set of responses 
                           
                              
                                 R
                                 ¯
                              
                              
                                 
                                    θ
                                    i
                                 
                                 x
                                 y
                              
                           
                         for i
                        =l,⋯,N are first interpolated into the continuous function
                           
                              (2.14)
                              
                                 
                                    
                                       R
                                       ¯
                                    
                                    
                                       θ
                                       x
                                       y
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             n
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          
                                             ϕ
                                             n
                                          
                                          
                                             θ
                                          
                                          
                                             R
                                             ¯
                                          
                                          
                                             
                                                θ
                                                n
                                             
                                             x
                                             y
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        where ϕ
                        
                           n
                        (θ) for n
                        =l,⋯, N are a set of appropriate interpolation functions such as the third order spline functions, and should be equal to 1 and 0 for n
                        =
                        m and n
                        ≠
                        m, respectively. Then gradient field of image is derived by
                           
                              (2.15)
                              
                                 
                                    A
                                    
                                       x
                                       y
                                    
                                    =
                                    
                                       max
                                       θ
                                    
                                    
                                       
                                          
                                             R
                                             ¯
                                          
                                          
                                             θ
                                             x
                                             y
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2.16)
                              
                                 
                                    θ
                                    
                                       x
                                       y
                                    
                                    =
                                    arg
                                    
                                       max
                                       θ
                                    
                                    
                                       
                                          
                                             R
                                             ¯
                                          
                                          
                                             θ
                                             x
                                             y
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Noticeably, although the results obtained by the above way may be better, they are not accurate.

Steerable filters [23] represent a class of spatial oriented filters in which a filter 
                           
                              
                                 h
                                 ¯
                              
                              
                                 θ
                                 x
                                 y
                              
                           
                         of arbitrary orientation can be expressed as linear combinations of a fixed set of basis filters 
                           
                              
                                 
                                    h
                                    ¯
                                 
                                 m
                              
                              
                                 x
                                 y
                              
                           
                         for m
                        =1, ⋯, M. This shows that 
                           
                              
                                 h
                                 ¯
                              
                              
                                 θ
                                 x
                                 y
                              
                              =
                              
                                 
                                    ∑
                                    
                                       m
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    
                                       w
                                       m
                                    
                                    
                                       θ
                                    
                                 
                              
                              
                                 
                                    h
                                    ¯
                                 
                                 m
                              
                              
                                 x
                                 y
                              
                           
                        , where w
                        
                           m
                        (θ) for m
                        =1, ⋯, M are a set of weight functions. Letting basis filters 
                           
                              
                                 
                                    h
                                    ¯
                                 
                                 m
                              
                              
                                 x
                                 y
                              
                           
                         for m
                        =1, ⋯, M be convoluted with an image 
                           
                              
                                 u
                                 ¯
                              
                              
                                 x
                                 y
                              
                           
                         yields their responses 
                           
                              
                                 o
                                 m
                              
                              
                                 x
                                 y
                              
                              =
                              
                                 u
                                 ¯
                              
                              
                                 x
                                 y
                              
                              ⊗
                              
                                 
                                    h
                                    ¯
                                 
                                 m
                              
                              
                                 x
                                 y
                              
                           
                        . Very interestingly, since convolution is linear, the output o(θ;x,y) of an anisotropic filter 
                           
                              
                                 h
                                 ¯
                              
                              
                                 θ
                                 x
                                 y
                              
                           
                         tuned to any desired orientation is gained by the linear combination of the responses of the basis filters, which implies that there is relation 
                           
                              o
                              
                                 θ
                                 x
                                 y
                              
                              =
                              
                                 
                                    ∑
                                    
                                       m
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    
                                       φ
                                       m
                                    
                                    
                                       θ
                                    
                                 
                              
                              
                                 o
                                 m
                              
                              
                                 x
                                 y
                              
                           
                        . If an oriented filter 
                           
                              
                                 h
                                 ¯
                              
                              
                                 θ
                                 x
                                 y
                              
                           
                         is steerable, then its orientation analysis is accurately achieved by
                           
                              (2.17)
                              
                                 
                                    A
                                    
                                       x
                                       y
                                    
                                    =
                                    
                                       max
                                       θ
                                    
                                    
                                       
                                          o
                                          
                                             θ
                                             x
                                             y
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2.18)
                              
                                 
                                    θ
                                    
                                       x
                                       y
                                    
                                    =
                                    arg
                                    
                                       max
                                       θ
                                    
                                    
                                       
                                          o
                                          
                                             θ
                                             x
                                             y
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Thus, the orientation analysis can be also approached by a framework of steerable filters.
                           Remark 2.5
                           It is easily seen that expressions (2.17) and (2.18) are very similar to those of Eqs. (2.15) and (2.16). Clearly, since an edge can be along arbitrary direction, the gradient field obtained by steerable filters is also approximate in theory.

Various steerable filters were developed in [9,21,23–26]. Here, the three typical classes of steerable filters [19,21,25] are mainly reviewed as follows. In the complex derivative filters (CDF) [19], the complex analysis was introduced into the framework of 2-D steerable filters. Reference [19] showed that 2-D steerable filters are achieved more efficiently by complex analysis than by real analysis. In particular, compared with real derivatives, complex derivatives have a major advantage: a rotation changes the derivative just by a multiplication with a complex unit number. In addition, reference [19] also showed that Gauss–Laguerre transform is produced by complex derivatives of Gaussian functions, and can be used as an optimal signal representation for locally smooth images. It was further shown that the elegant analytical form of a filter kernel for anisotropic blurring can locally control the shape and orientation of the kernel by one single complex parameter.

In optimal steerable filters (OSF) [25], 2-D optimal filters for 2-D edge detection were expressed as the linear combinations of a set of basis filters, and all the optimal weight functions associated with a basis filter were achieved by optimizing a single objective that combines the three Canny-like criteria. Since OSF are expanded by a fixed set of basis filters, their optimization is converted into searching multiple orientation-dependent weight functions. Unlike the design method adopted by Canny and others, the approach for designing OSF is truly 2-D and gives the filters with closed-form expressions. Moreover, OSF have a better orientation-selective feature than Gaussian Gradient. In fact, the linear representation of OSF by a fixed set of basis filters makes their optimization design in 2-D space to be possible.

It is well-known that Hermite–Gauss filters (HGF) are an important family of wavelets. They can be expressible as the product of Hermite polynomials with an isotropic Gaussian term, and are closely related to derivatives of Gaussian functions. Unlike isotropic Hermite–Gauss filters (HGF), the elongated HGF (e-HGF) [21] are a good convolution kernel for edge detection but they are not steerable with respect to rotations. This means that the family of rotated e-HGF is an infinite set of steering functions to be exactly represented. In [21], new families of eigenfunctions of the 2-D Fourier transform are found. The new steering functions that best approximate to e-HGF are derived analytically and will be simply called Fourier eigenfunction steerable filters (FESF). These functions can be efficiently implemented by the recursive formula obtained in [21]. In order to improve the location accuracy and the noise rejection ability, FESF can be used to estimate the gradient in edge detection.
                           Remark 2.6
                           Via the analysis in Subsection 2.1, we have known that in order to efficiently exploit CEB, the parallel filter of a convolution kernel should have a flat region whose length is not less than 2. However, it is easily shown by drawing graphic display that the parallel filters of the OSF [25], Gauss–Laguerre functions [19] and the e-HGF [21] do not have the flat regions over length 2.

In order to more fully utilize CEB, a separable 2-D anisotropic filter called simply MAGF will be proposed by organically combining IGF and TDMF. Like separable IGF, AGF, GF and TDMF, we make the MAGF to be separated into the product between a vertical filter and a parallel filter perpendicular to and parallel to an ELS, respectively. Since the first derivative of a Gaussian filter [22] is an approximately optimal vertical filter, it should be chosen as the 1-D filter perpendicular to an ELS.

Wang [14] has pointed out that the restriction of the 1-D filter parallel to the edge is not very strict. Hence, it is reasonable that the 1-D parallel filter is designed on the basis of the three characteristics of an ELS. With the above analysis, we give the following 2-D filter
                        
                           (3.1a)
                           
                              
                                 dG
                                 
                                    u
                                 
                                 /
                                 du
                                 =
                                 −
                                 
                                    
                                       u
                                       /
                                       
                                          σ
                                          1
                                          2
                                       
                                    
                                 
                                 exp
                                 
                                    
                                       −
                                       
                                          u
                                          2
                                       
                                       /
                                       
                                          
                                             2
                                             
                                                σ
                                                1
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (3.1b)
                           
                              
                                 
                                    f
                                    MAGF
                                 
                                 
                                    u
                                    v
                                 
                                 =
                                 
                                    
                                       dG
                                       
                                          u
                                       
                                       /
                                       du
                                    
                                 
                                 H
                                 
                                    v
                                 
                              
                           
                        
                     where G (u) and H (v) are a Gaussian filter and a 1-D filter perpendicular to and parallel to an ELS, respectively. Below, we will concentrate on how the 1-D parallel filter H (v) is determined.


                     Fig. 1
                      shows four typical edge structures [2]. It can be seen from Fig. 1 that there exists no isolated edge pixel and an ELS includes, at least, three edge pixels. In order to take advantage of the structure information of an ELS, the proposed MAGF needs to simultaneously judge at least 3pixels to determine whether they are edge pixels or form an ELS. For simplicity and without the loss of generality, this paper only considers the simultaneous detection of three edge pixels, since a long ELS can consist of multiple short ELS formed only by three edge pixels. This provides convenience for detecting an ELS of the natural image.

Fortunately, if the first derivative of a two-dimensional Gaussian filter is used to extract the horizontal ELS, as shown in Fig. 2(a), the three gradient-magnitudes at three adjacent edge pixels (i, j), (i, j
                     +
                     1) and (i, j
                     −
                     1), and their sum are easily obtained by
                        
                           (3.2a)
                           
                              
                                 
                                    M
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 exp
                                 
                                    
                                       −
                                       1
                                       /
                                       
                                          
                                             2
                                             
                                                σ
                                                1
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                       
                                          n
                                          =
                                          −
                                          2
                                       
                                       2
                                    
                                    
                                       exp
                                       
                                          
                                             −
                                             
                                                n
                                                2
                                             
                                             /
                                             
                                                
                                                   2
                                                   
                                                      σ
                                                      1
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                             
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   j
                                                   +
                                                   n
                                                
                                             
                                             −
                                             
                                                u
                                                ¯
                                             
                                             
                                                
                                                   i
                                                   −
                                                   1
                                                   ,
                                                   j
                                                   +
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (3.2b)
                           
                              
                                 
                                    M
                                    
                                       
                                          i
                                          ,
                                          j
                                          +
                                          1
                                       
                                    
                                 
                                 =
                                 exp
                                 
                                    
                                       −
                                       1
                                       /
                                       
                                          
                                             2
                                             
                                                σ
                                                1
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                       
                                          n
                                          =
                                          −
                                          1
                                       
                                       3
                                    
                                    
                                       exp
                                       
                                          
                                             −
                                             
                                                
                                                   
                                                      n
                                                      −
                                                      1
                                                   
                                                
                                                2
                                             
                                             /
                                             
                                                
                                                   2
                                                   
                                                      σ
                                                      1
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                             
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   j
                                                   +
                                                   n
                                                
                                             
                                             −
                                             
                                                u
                                                ¯
                                             
                                             
                                                
                                                   i
                                                   −
                                                   1
                                                   ,
                                                   j
                                                   +
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (3.2c)
                           
                              
                                 
                                    M
                                    
                                       
                                          i
                                          ,
                                          j
                                          −
                                          1
                                       
                                    
                                 
                                 =
                                 exp
                                 
                                    
                                       −
                                       1
                                       /
                                       
                                          
                                             2
                                             
                                                σ
                                                1
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                       
                                          n
                                          =
                                          −
                                          3
                                       
                                       1
                                    
                                    
                                       exp
                                       
                                          
                                             −
                                             
                                                
                                                   
                                                      n
                                                      +
                                                      1
                                                   
                                                
                                                2
                                             
                                             /
                                             
                                                
                                                   2
                                                   
                                                      σ
                                                      1
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                             
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   j
                                                   +
                                                   n
                                                
                                             
                                             −
                                             
                                                u
                                                ¯
                                             
                                             
                                                
                                                   i
                                                   −
                                                   1
                                                   ,
                                                   j
                                                   +
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (3.2d)
                           
                              
                                 SU
                                 
                                    M
                                    G
                                 
                                 =
                                 
                                    M
                                    
                                       i
                                       j
                                    
                                 
                                 +
                                 
                                    M
                                    
                                       
                                          i
                                          ,
                                          j
                                          −
                                          1
                                       
                                    
                                 
                                 +
                                 
                                    M
                                    
                                       
                                          i
                                          ,
                                          j
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                        
                     where the 
                        
                           
                              u
                              ¯
                           
                           
                              x
                              y
                           
                        
                      denotes an image function and σ
                     1 is the standard deviation of the 2-D Gaussian filter. These three 1-D Gaussian filters for computing the three gradient-magnitudes at the three adjacent edge pixels behave to be arranged along the horizontal ELS, as shown in Fig. 2(b). We heuristically design the parallel H(v) such that the single gradient-magnitude obtained by a mask of filter (3.1b) and at pixel (i,j) can well approximate the sum (3.2d) of the three gradient-magnitudes (3.2a)–(3.2c). In other words, we let the effect of a single mask of filter (3.1b) to be almost equivalent to that of three closely-related 1-D Gaussian filters. Hence, in order to increase probability and decrease false alarm rate for detecting an edge, the three edge pixels should be together detected by comparing such single gradient-magnitude at pixel (i,j) with threshold value. Once the single gradient-magnitude at pixel (i,j) is over the threshold value, all the 3pixels are declared to be edge pixels, and can form the shortest ELS; otherwise they do not construct any ELS.

The heuristically designed function H(v) is shown in Fig. 2, and formulated as
                        
                           (3.3)
                           
                              
                                 H
                                 
                                    v
                                 
                                 =
                                 
                                    
                                       
                                          
                                             exp
                                             (
                                             −
                                             
                                                
                                                   
                                                      v
                                                      −
                                                      h
                                                   
                                                
                                                2
                                             
                                             /
                                             (
                                             2
                                             
                                                σ
                                                2
                                                2
                                             
                                             )
                                             )
                                             
                                             h
                                             <
                                             v
                                             <
                                             ∞
                                          
                                       
                                       
                                          
                                             1
                                             
                                             −
                                             h
                                             ≤
                                             v
                                             ≤
                                             h
                                          
                                       
                                       
                                          
                                             exp
                                             (
                                             −
                                             
                                                
                                                   
                                                      v
                                                      +
                                                      h
                                                   
                                                
                                                2
                                             
                                             /
                                             (
                                             2
                                             
                                                σ
                                                2
                                                2
                                             
                                             )
                                             )
                                             
                                             −
                                             ∞
                                             <
                                             v
                                             <
                                             −
                                             h
                                          
                                       
                                    
                                 
                              
                           
                        
                     where h
                     ≥0 denotes integer, and can be fixed as 1 for extracting the shortest ELS of a digital image and σ
                     2 indicates another standard deviation. Unlike GT(v), we expect that the frequency response of H(v) has low side lobes.

Therefore, the MAGF is completely represented by
                        
                           (3.4)
                           
                              
                                 
                                    f
                                    MAGF
                                 
                                 
                                    u
                                    v
                                 
                                 =
                                 
                                    
                                       
                                          
                                             −
                                             
                                                
                                                   u
                                                   /
                                                   
                                                      σ
                                                      1
                                                      2
                                                   
                                                
                                             
                                             exp
                                             
                                                
                                                   −
                                                   
                                                      u
                                                      2
                                                   
                                                   /
                                                   
                                                      
                                                         2
                                                         
                                                            σ
                                                            1
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             exp
                                             
                                                
                                                   −
                                                   
                                                      
                                                         
                                                            v
                                                            −
                                                            h
                                                         
                                                      
                                                      2
                                                   
                                                   /
                                                   
                                                      
                                                         2
                                                         
                                                            σ
                                                            2
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                             h
                                             <
                                             v
                                             <
                                             ∞
                                             
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   u
                                                   /
                                                   
                                                      σ
                                                      1
                                                      2
                                                   
                                                
                                             
                                             exp
                                             
                                                
                                                   −
                                                   
                                                      u
                                                      2
                                                   
                                                   /
                                                   
                                                      
                                                         2
                                                         
                                                            σ
                                                            1
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                             −
                                             h
                                             ≤
                                             v
                                             ≤
                                             h
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   u
                                                   /
                                                   
                                                      σ
                                                      1
                                                      2
                                                   
                                                
                                             
                                             exp
                                             
                                                
                                                   −
                                                   
                                                      u
                                                      2
                                                   
                                                   /
                                                   
                                                      
                                                         2
                                                         
                                                            σ
                                                            1
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             exp
                                             
                                                
                                                   −
                                                   
                                                      
                                                         
                                                            v
                                                            +
                                                            h
                                                         
                                                      
                                                      2
                                                   
                                                   /
                                                   
                                                      
                                                         2
                                                         
                                                            σ
                                                            2
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                             −
                                             ∞
                                             <
                                             v
                                             <
                                             −
                                             h
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     
                  

Inserting Eq. (2.1) into Eq. (3.4) directly yields the oriented convolution kernel f
                     
                        MAGF
                     (θ;u,v) in coordinate system x and y. Based on the above MAGF with parameters h
                     =1 and σ
                     2
                     =
                     σ
                     1, the single gradient-magnitude at pixel (i,j) is given by
                        
                           (3.5)
                           
                              
                                 
                                    
                                       
                                          G
                                          
                                             MAGF
                                             
                                                i
                                                j
                                             
                                          
                                       
                                       =
                                       exp
                                       
                                          
                                             −
                                             1
                                             /
                                             
                                                
                                                   2
                                                   
                                                      σ
                                                      1
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             ∑
                                             
                                                m
                                                =
                                                −
                                                1
                                             
                                             1
                                          
                                          
                                             
                                                u
                                                ¯
                                             
                                             
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   j
                                                   +
                                                   m
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             ∑
                                             
                                                m
                                                =
                                                −
                                                1
                                             
                                             1
                                          
                                          
                                             
                                                u
                                                ¯
                                             
                                             
                                                
                                                   i
                                                   −
                                                   1
                                                   ,
                                                   j
                                                   +
                                                   m
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       +
                                       exp
                                       
                                          
                                             −
                                             
                                                1
                                                2
                                             
                                             /
                                             
                                                
                                                   2
                                                   
                                                      σ
                                                      1
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                             
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   j
                                                   +
                                                   2
                                                
                                             
                                             +
                                             
                                                u
                                                ¯
                                             
                                             
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   j
                                                   −
                                                   2
                                                
                                             
                                             −
                                             
                                                u
                                                ¯
                                             
                                             
                                                
                                                   i
                                                   −
                                                   1
                                                   ,
                                                   j
                                                   −
                                                   2
                                                
                                             
                                             −
                                             
                                                u
                                                ¯
                                             
                                             
                                                
                                                   i
                                                   −
                                                   1
                                                   ,
                                                   j
                                                   +
                                                   2
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                                 
                                    
                                       
                                       +
                                       exp
                                       
                                          
                                             −
                                             
                                                2
                                                2
                                             
                                             /
                                             
                                                
                                                   2
                                                   
                                                      σ
                                                      1
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                             
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   j
                                                   +
                                                   3
                                                
                                             
                                             +
                                             
                                                u
                                                ¯
                                             
                                             
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   j
                                                   −
                                                   3
                                                
                                             
                                             −
                                             
                                                u
                                                ¯
                                             
                                             
                                                
                                                   i
                                                   −
                                                   1
                                                   ,
                                                   j
                                                   +
                                                   3
                                                
                                             
                                             −
                                             
                                                u
                                                ¯
                                             
                                             
                                                
                                                   i
                                                   −
                                                   1
                                                   ,
                                                   j
                                                   −
                                                   3
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     
                  

It can be seen from Eq. (3.5) that the computation of G
                     
                        MAGF(i,j) uses the same neighborhood pixels (14pixels) as Eq. (3.2). According to the definition of a gradient, neighborhood pixels (i
                     −1, j
                     −1), (i
                     −1, j), (i
                     −1, j
                     +1), (i
                     +1, j
                     −1), (i
                     +1, j) and (i
                     +1, j
                     +1) play an important role in computing the three gradient-magnitudes at pixels (i,j), (i
                     −1, j) and (i
                     +1, j). These neighborhood pixels have the same weight values in both Eqs. (3.5) and (3.2). Therefore, the sum of the three gradient-magnitudes at pixels (i,j), (i
                     −1, j) and (i
                     +1, j) can be well approximated by G
                     
                        MAGF(i,j). Nalwa [5] claimed that for a given support interval along a locally straight edge, Gaussian smoothing is less effective than simple averaging. In other words, our parallel filter H(v) should be more advantageous than G(v) in IGF and AGF. Both Gaussian smoothing and simple averaging are combined in the proposed filter, as shown in Fig. 2(c). Hence, the MAGF should also be over IGF for suppressing noise.
                        Remark 3.1
                        Since function f
                           
                              MAGF
                           (u,v) has infinitely long double-sided trails, its trail at (u,v)∉[−3σ
                           1, 3σ
                           1]×[−
                           h
                           −3σ
                           2, h
                           +3σ
                           2] is very small and can be truncated for decreasing computational load. The parameter h plays a key role in our filter, since the fatness of H(v) is linearly increased with increasing h. Moreover, when h is equal to zero and σ
                           2
                           =
                           σ
                           1, the MAGF is reduced to the IGF and has the same effect as the 2-D Canny filter. If h
                           ≥1, the proposed 2-D edge detection operator represents the anisotropic filter and can be used for detecting a short ELS. A significant difference of our approach from other anisotropic filters [26,50–53] is that our filter can simultaneously judge at least 3pixels to determine whether they are edge pixels or ELS. It can be easily found that 2
                           h should be equal to the length of ELS.

Here, we mainly compare the SNR and GL of the IGF with our filter, and let σ
                     2
                     =
                     σ
                     1. We first consider the following edge model [22,28]
                     
                        
                           (3.6)
                           
                              
                                 
                                    u
                                    ¯
                                 
                                 
                                    x
                                    y
                                 
                                 =
                                 
                                    
                                       
                                          
                                             0
                                             
                                             for
                                             
                                             x
                                             <
                                             0
                                             ,
                                             −
                                             ∞
                                             ≤
                                             y
                                             ≤
                                             +
                                             ∞
                                          
                                       
                                       
                                          
                                             A
                                             
                                             for
                                             
                                             x
                                             ≥
                                             0
                                             ,
                                             −
                                             ∞
                                             ≤
                                             y
                                             ≤
                                             +
                                             ∞
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     
                  

Here, the SNR of IGF and the SNR of the proposed filter are derived in Appendix A. The ratio of SNR
                     
                        MAGF
                      to SNR
                     
                        IGF
                      is called improvement factor of SNR, and given by
                        
                           (3.7)
                           
                              
                                 I
                                 
                                    P
                                    SNR
                                 
                                 =
                                 
                                    
                                       SN
                                       
                                          R
                                          MAGF
                                       
                                       /
                                       SN
                                       
                                          R
                                          IGF
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                       +
                                       
                                          
                                             2
                                             /
                                             π
                                          
                                       
                                       
                                          
                                             h
                                             /
                                             
                                                σ
                                                1
                                             
                                          
                                       
                                    
                                 
                                 /
                                 
                                    
                                       1
                                       +
                                       
                                          
                                             2
                                             /
                                             
                                                π
                                             
                                          
                                       
                                       
                                          
                                             h
                                             /
                                             
                                                σ
                                                1
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     
                  

Moreover, the GL of the IGF and the GL of our filter are derived in Appendix B. The ratio of GL
                     
                        MAGF
                      to GL
                     
                        IGF
                      is called improvement factor of GL, and described as
                        
                           (3.8)
                           
                              
                                 I
                                 
                                    P
                                    GL
                                 
                                 =
                                 
                                    
                                       G
                                       
                                          L
                                          MAGF
                                       
                                       /
                                       G
                                       
                                          L
                                          IGF
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          π
                                       
                                       +
                                       γ
                                       
                                          2
                                       
                                    
                                 
                                 /
                                 
                                    
                                       
                                          π
                                          +
                                          2
                                          γ
                                          
                                             π
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     
                  

It is easily verified that if h
                     ≥1 is chosen, the above IP
                     
                        SNR
                      and IP
                     
                        GL
                      are larger than 1. This shows that MAGF is over IGF.

@&#IMPLEMENTATION@&#

In order to achieve a numerical approximation to the proposed filter, the rotation method and the interpolation method are adopted.

Let the center pixel of our mask be marked as (i,j), and the positions of other pixels expressed as (i
                        +
                        n, j
                        +
                        m) in the Cartesian coordinates of the image, where i and j are nonnegative integers, and n and m indicate integers. The rotation of our mask is shown in Fig. 3
                        . Obviously, Fig. 3(a) shows a 7×3 mask defined as a mother mask. In Fig. 3(b), α
                        0 and α are the normal orientations of the mother mask and inclining mask, respectively, θ is the angle difference between α
                        0 and α, and θ
                        =
                        α for α
                        0
                        =0. Therefore, the inclining mask can be obtained by rotating the mother mask through an angle θ around the center pixel (i,j). There are relations
                           
                              (4.1)
                              
                                 
                                    
                                       
                                          
                                             
                                                i
                                                ′
                                             
                                             =
                                             i
                                             +
                                             n
                                             cos
                                             
                                                θ
                                             
                                             +
                                             m
                                             sin
                                             (
                                             θ
                                             )
                                          
                                       
                                       
                                          
                                             
                                                j
                                                ′
                                             
                                             =
                                             j
                                             +
                                             m
                                             cos
                                             
                                                θ
                                             
                                             −
                                             n
                                             sin
                                             (
                                             θ
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        where (i
                        +
                        n, j
                        +
                        m) are the coordinates before the rotation transform and (i′,j′) denote the coordinates after the rotation transform. The gradient-magnitude at the pixel (i,j) in the direction of θ is given by
                           
                              (4.2)
                              
                                 
                                    
                                       g
                                       θ
                                    
                                    
                                       i
                                       j
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             n
                                             =
                                             −
                                             
                                                
                                                   2
                                                   +
                                                   h
                                                
                                             
                                          
                                          
                                             n
                                             =
                                             2
                                             +
                                             h
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   m
                                                   =
                                                   −
                                                   1
                                                
                                                
                                                   m
                                                   =
                                                   1
                                                
                                             
                                             
                                                
                                                   f
                                                   MAGF
                                                
                                                
                                                   n
                                                   m
                                                
                                                
                                                   u
                                                   ¯
                                                
                                                
                                                   
                                                      i
                                                      ′
                                                   
                                                   
                                                      j
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where f
                        
                           MAGF
                        (x,y) is our 2-D anisotropic filter and 
                           
                              
                                 u
                                 ¯
                              
                              
                                 i
                                 j
                              
                           
                         is the input image. If both i′ and j′ are integers, the 
                           
                              
                                 u
                                 ¯
                              
                              
                                 
                                    i
                                    ′
                                 
                                 
                                    j
                                    ′
                                 
                              
                           
                         represents the gray value at pixel (i′,j′). Otherwise, the interpolation method is necessary to compute the gray value of 
                           
                              
                                 u
                                 ¯
                              
                              
                                 
                                    i
                                    ′
                                 
                                 
                                    j
                                    ′
                                 
                              
                           
                        , as shown in Fig. 3(c).

This paper uses double linear interpolation method [51] which balances accuracy and efficiency. When (i′,j′) is a pixel in the rectangular sub-region [x, x
                        +1]×[y, y
                        +1], then 
                           
                              
                                 u
                                 ¯
                              
                              
                                 
                                    i
                                    ′
                                 
                                 
                                    j
                                    ′
                                 
                              
                           
                         is gotten by linear interpolation expression
                           
                              (4.3)
                              
                                 
                                    
                                       u
                                       ¯
                                    
                                    
                                       
                                          i
                                          ′
                                       
                                       
                                          j
                                          ′
                                       
                                    
                                    =
                                    
                                       1
                                       d
                                    
                                    
                                       
                                          
                                             d
                                             1
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             u
                                             ¯
                                          
                                          
                                             x
                                             y
                                          
                                          +
                                          
                                             d
                                             2
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             u
                                             ¯
                                          
                                          
                                             
                                                x
                                                ,
                                                y
                                                +
                                                1
                                             
                                          
                                          +
                                          
                                             d
                                             3
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             u
                                             ¯
                                          
                                          
                                             
                                                x
                                                +
                                                1
                                                ,
                                                y
                                             
                                          
                                          +
                                          
                                             d
                                             4
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             u
                                             ¯
                                          
                                          
                                             
                                                x
                                                +
                                                1
                                                ,
                                                y
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 d
                                 1
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                i
                                                ′
                                             
                                             −
                                             x
                                          
                                       
                                       2
                                    
                                    +
                                    
                                       
                                          
                                             
                                                j
                                                ′
                                             
                                             −
                                             y
                                          
                                       
                                       2
                                    
                                 
                              
                           
                        , 
                           
                              
                                 d
                                 2
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                i
                                                ′
                                             
                                             −
                                             x
                                          
                                       
                                       2
                                    
                                    +
                                    
                                       
                                          
                                             
                                                j
                                                ′
                                             
                                             −
                                             
                                                
                                                   y
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       2
                                    
                                 
                              
                           
                        , 
                           
                              
                                 d
                                 3
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                i
                                                ′
                                             
                                             −
                                             
                                                
                                                   x
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       2
                                    
                                    +
                                    
                                       
                                          
                                             
                                                j
                                                ′
                                             
                                             −
                                             y
                                          
                                       
                                       2
                                    
                                 
                              
                           
                        , 
                           
                              
                                 d
                                 4
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                i
                                                ′
                                             
                                             −
                                             
                                                
                                                   x
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       2
                                    
                                    +
                                    
                                       
                                          
                                             
                                                j
                                                ′
                                             
                                             −
                                             
                                                
                                                   y
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       2
                                    
                                 
                              
                           
                         and d
                        =
                        d
                        1
                        −1
                        +
                        d
                        2
                        −1
                        +
                        d
                        3
                        −1
                        +
                        d
                        4
                        −1.

The implementation of the MAGF can be summarized into the following seven steps:
                           
                              1)
                              A 2-D Gaussian filter is used for estimating an approximate direction 
                                    
                                       θ
                                       ¯
                                    
                                  of an edge. For example, Fig. 4(a) shows two brain magnetic resonance imaging (MRI) images. Fig. 4(b) represents the approximate estimation of edge orientation 
                                    
                                       θ
                                       ¯
                                    
                                 .

Compute the maximal gradient-magnitude near 
                                    
                                       θ
                                       ¯
                                    
                                 .

Perform non-maxima suppression.

Obtain the locations of pixels (i, j
                                 −1) and (i, j
                                 +1) after rotating θ. The coordinates (i
                                 −sin(θ), j
                                 −cos(θ)) and (i
                                 +sin(θ), j
                                 +cos(θ)) are associated with the coordinates of pixels (i, j
                                 −1) and (i, j
                                 +1), respectively, after rotating θ using Eq. (4.1). For simplicity, we let P and P′ denote (i
                                 −sin(θ), j
                                 −cos(θ)) and (i
                                 +sin(θ), j
                                 +cos(θ)) respectively.

Compare g
                                 max(i,j) with a high threshold. If pixel (i,j) is not marked as an edge pixel and g
                                 max(i,j) is above the high threshold, then the 3pixels (P, P′, (i,j)) are marked as edge pixels or ELS. The procedure is applied repeatedly for each pixel in the input image. Finally, the high threshold edge map e
                                 
                                    h
                                 (i,j) is obtained.

Compare g
                                 max(i,j) with a low threshold. If pixel (i,j) is not marked as an edge pixel and g
                                 max(i,j) is above the low threshold, then the 3pixels (P, P′, (i,j)) are marked as edge pixels or ELS. The procedure is applied repeatedly for each pixel in the gradient-magnitude map. Finally, the low threshold edge map e
                                 
                                    l
                                 (i,j) is obtained.

Perform edge connecter based on e
                                 
                                    h
                                 (i,j) and e
                                 
                                    l
                                 (i,j). The union of e
                                 
                                    h
                                 (i,j) and e
                                 
                                    l
                                 (i,j) is the edge map of the image.

@&#EXPERIMENTAL RESULTS@&#

This section will first compare the experimental results of the MAGF-based edge-detection algorithm with some conventional edge-detection algorithms. Then, the performance evaluation of these edge-detection algorithms will be compared. For a fair comparison among all the anisotropic filters AGF, MAGF, FESF, OSF and CDF, their vertical filters should be taken as the same as that of IGF, and the corresponding parameters should be appropriately selected such that their effective support areas are identical and marked as S
                     
                        ESA
                     . This implies that there are the following relations:
                        
                           (5.1)
                           
                              
                                 
                                    
                                       
                                          S
                                          ESA
                                       
                                       =
                                       
                                          
                                             ∫
                                             
                                                −
                                                ∞
                                             
                                             ∞
                                          
                                          
                                             
                                                
                                                   ∫
                                                   
                                                      −
                                                      ∞
                                                   
                                                   ∞
                                                
                                                
                                                   
                                                      
                                                         
                                                            f
                                                            AGF
                                                         
                                                         
                                                            x
                                                            y
                                                         
                                                      
                                                   
                                                   dxdy
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             ∫
                                             
                                                −
                                                ∞
                                             
                                             ∞
                                          
                                          
                                             
                                                
                                                   ∫
                                                   
                                                      −
                                                      ∞
                                                   
                                                   ∞
                                                
                                                
                                                   
                                                      
                                                         
                                                            f
                                                            MAGF
                                                         
                                                         
                                                            x
                                                            y
                                                         
                                                      
                                                   
                                                   dxdy
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             ∫
                                             
                                                −
                                                ∞
                                             
                                             ∞
                                          
                                          
                                             
                                                
                                                   ∫
                                                   
                                                      −
                                                      ∞
                                                   
                                                   ∞
                                                
                                                
                                                   
                                                      
                                                         
                                                            f
                                                            FESF
                                                         
                                                         
                                                            x
                                                            y
                                                         
                                                      
                                                   
                                                   dxdy
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       =
                                       
                                          
                                             ∫
                                             
                                                −
                                                ∞
                                             
                                             ∞
                                          
                                          
                                             
                                                
                                                   ∫
                                                   
                                                      −
                                                      ∞
                                                   
                                                   ∞
                                                
                                                
                                                   
                                                      
                                                         
                                                            f
                                                            OSF
                                                         
                                                         
                                                            x
                                                            y
                                                         
                                                      
                                                   
                                                   dxdy
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             ∫
                                             
                                                −
                                                ∞
                                             
                                             ∞
                                          
                                          
                                             
                                                
                                                   ∫
                                                   
                                                      −
                                                      ∞
                                                   
                                                   ∞
                                                
                                                
                                                   
                                                      
                                                         
                                                            f
                                                            CDF
                                                         
                                                         
                                                            x
                                                            y
                                                         
                                                      
                                                   
                                                   dxdy
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where f
                     
                        FESF
                     (x,y), f
                     
                        OSF
                     (x,y) and f
                     
                        CDF
                     (x,y) are the filters associated with FESF, OSF and CDF, respectively. Notice that if the effective support area of IGF is also equal to S
                     
                        ESA
                     , then its vertical filter must have larger effective support width, which shows that there exists no pair comparison between IGF and the anisotropic filters.

All edge-detection algorithms are very sensitive to the selection of the threshold. Let T
                     
                        IGF
                     , T
                     
                        AGF
                     , T
                     
                        MAGF
                     , T
                     
                        FESF
                     , T
                     
                        OSF
                      and T
                     
                        CDF
                      be the thresholds of IGF, AGF, MAGF, FESF, OSF and CDF, respectively, then we can obtain the five relations of T
                     
                        IGF
                      to T
                     
                        AGF
                     , T
                     
                        MAGF
                     , T
                     
                        FESF
                     , T
                     
                        OSF
                      and T
                     
                        CDF
                     . Relations (5.1) show that T
                     
                        AGF
                     
                     =
                     T
                     
                        MAGF
                     
                     =
                     T
                     
                        FESF
                     
                     =
                     T
                     
                        OSF
                     
                     =
                     T
                     
                        CDF
                     . Hence, we easily have
                        
                           (5.2)
                           
                              
                                 
                                    
                                       
                                          T
                                          AGF
                                       
                                       /
                                       
                                          T
                                          IGF
                                       
                                       =
                                       
                                          T
                                          MAGF
                                       
                                       /
                                       
                                          T
                                          IGF
                                       
                                       =
                                       
                                          T
                                          FESF
                                       
                                       /
                                       
                                          T
                                          IGF
                                       
                                       =
                                       
                                          T
                                          OSF
                                       
                                       /
                                       
                                          T
                                          IGF
                                       
                                       =
                                       
                                          T
                                          CDF
                                       
                                       /
                                       
                                          T
                                          IGF
                                       
                                    
                                 
                                 
                                    
                                       =
                                       
                                          
                                             
                                                ∫
                                                
                                                   −
                                                   ∞
                                                
                                                
                                                   
                                                   ∞
                                                
                                             
                                             
                                                
                                                   
                                                      ∫
                                                      
                                                         −
                                                         ∞
                                                      
                                                      
                                                         
                                                         ∞
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                               AGF
                                                            
                                                            
                                                               x
                                                               y
                                                            
                                                         
                                                      
                                                      dxdy
                                                   
                                                
                                             
                                          
                                       
                                       /
                                       
                                          
                                             
                                                ∫
                                                
                                                   −
                                                   ∞
                                                
                                                
                                                   
                                                   ∞
                                                
                                             
                                             
                                                
                                                   
                                                      ∫
                                                      
                                                         −
                                                         ∞
                                                      
                                                      
                                                         
                                                         ∞
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                               IGF
                                                            
                                                            
                                                               x
                                                               y
                                                            
                                                         
                                                      
                                                      dxdy
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where σ
                     1
                     =
                     σ. The IGF algorithm utilizes a histogram of the filter response to determine threshold adaptively. Therefore, once getting T
                     
                        IGF
                     , the thresholds of the AGF, MAGF, FESF, OSF and CDF are easily obtained by relations (5.2).

From Figs. 5–7
                        
                        
                        , we compare the gradient estimation of our filter with that of three recently introduced anisotropic steerable filters, namely, FESF, OSF and CDF. For the input images of Fig. 5, results are shown in Fig. 6, where crops are displayed to highlight the performances of the considered filters at a higher level of detail. Fig. 7 shows the results of other input images. From Fig. 6 we can see that the proposed method outperforms the other three methods in term of better rendering texture details (see the tire texture and bear tooth), contour location (see the nose contour of goat), and contour continuity (see the handle of basket).


                        Fig. 7 shows that with OSF (second row) and CDF (third row) the gradient maps are blurred; with the FESF (fourth row), the gradient maps are clear, but the locations are poor; with the proposed method (fifth row), the results are clearer and have better location.

The proposed algorithm can together detect multiple edge pixels or an ELS within a window, which improves the continuity and location accuracy of detected edges. The proposed method can better preserve contour and suppress noise because of smaller smoothing across the edge direction and larger smoothing along the edge direction.

Some examples of the edge maps of the related algorithms are shown in Fig. 8
                        . As we can see, the outputs of the region-based active contour (second column) miss some significant edges. The grouping pixel method (third column) can detect and preserve the low contrast edges, but the continuity of edge maps is poor. The proposed approach (fourth column) gives the most complete contours.


                        Fig. 9
                         shows some of the edge maps produced by AGF (second row), Canny operator (third row), region-based active contour [11] (fourth row), adaptive pseudo-dilation [10] (APD, fifth row) and the proposed approach (sixth row). These results show that the best edge maps produced by the proposed approach are superior to the other methods. Noticeably, the images, as shown in the Figs. 8 and 9, come from the Berkeley image database.


                        NOMENCLATURE: EE
                         implies that edge pixel in the image is detected correctly as an edge pixel; ENE means that edge pixel is detected incorrectly as nonedge pixel; NEE denotes that nonedge pixel is detected incorrectly as an edge pixel; NENE indicates that nonedge pixel is detected correctly as a nonedge pixel.

To accurately evaluate the performance of the proposed method, the algorithm performance is quantified in terms of good detection (SNR), good localization (GL), the product of SNR and GL, and the receiver operating characteristic (ROC) curve [54,55]. In the discrete case, the SNR can be approximated by
                           
                              (5.3)
                              
                                 
                                    SNR
                                    =
                                    
                                       
                                          
                                             N
                                             r
                                          
                                          /
                                          
                                             N
                                             e
                                          
                                       
                                    
                                    
                                       
                                          
                                             N
                                             ne
                                          
                                          /
                                          
                                             
                                                
                                                   N
                                                   f
                                                
                                                +
                                                0.1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where N
                        
                           r
                         and N
                        
                           f
                         denote the number of EE and NEE, respectively, N
                        
                           e
                         and N
                        
                           ne
                         are the number of edge pixels and non-edge pixels, respectively. In the discrete case, the GL 
                        [52,53] is defined as
                           
                              (5.4)
                              
                                 
                                    GL
                                    =
                                    
                                       
                                          1
                                          /
                                          max
                                          
                                             N
                                             
                                                N
                                                d
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          1
                                          /
                                          
                                             
                                                1
                                                +
                                                
                                                   d
                                                   i
                                                   2
                                                
                                                e
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where N and N
                        
                           d
                        
                        =
                        N
                        
                           r
                        
                        +
                        N
                        
                           f
                         are real and detected edge pixels, respectively, d
                        
                           i
                         is the Euclidean distance between the ith detected edge pixel and the nearest real edge pixel, and e is a constant typically set to 1/9. GL ranges between 0 and 1.


                        Fig. 10
                         shows the performance criterion of the IGF, AGF, and MAGF with a single threshold for synthetic images in ten experiments. In each experiment, we control the Gaussian noise level by setting different normalized variance (ranging from 0.05 to 0.5). Fig. 11
                         illustrates the performance criterion of the three algorithms with double thresholds for synthetic images corrupted by Gaussian noise with zero-mean and normalized variance ranging from 0.05 to 0.5. From the experimental results (Figs. 10 and 11), it can be seen that the MAGF outperforms the other two algorithms, and the AGF is slightly better than the IGF. The similarity between a binary edge map b(r) and the ground truth b
                        
                           GT
                        (r) is measured by means of the well-established Pratt fig. of merit F [21], which is defined as:
                           
                              (5.5)
                              
                                 
                                    F
                                    =
                                    
                                       1
                                       
                                          max
                                          
                                             
                                                
                                                   ∑
                                                   r
                                                
                                                
                                                   b
                                                   
                                                      r
                                                   
                                                   ,
                                                   
                                                      
                                                         ∑
                                                         r
                                                      
                                                      
                                                         
                                                            b
                                                            GT
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                          r
                                       
                                       
                                          
                                             
                                                b
                                                
                                                   r
                                                
                                             
                                             
                                                1
                                                +
                                                
                                                   
                                                      
                                                         d
                                                         GT
                                                         2
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   
                                                      σ
                                                      err
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where d
                        
                           GT
                        (r) is the distance transform of b
                        
                           GT
                        (r) and σ
                        
                           err
                        
                        =1. For each considered filter, statistic of its performances F on the entire data set of 40 images is shown in Fig. 12
                         for noise-free, after optimization of its input parameters that have been kept constant across the entire input data set. The proposed filter outperforms the other three methods.

The well known performance indicators [3,10] are referred to as R
                        =card{DC
                        ∩
                        GT}/card{GT} and P
                        =card{DC
                        ∩
                        GT}/card{DC}, which relate the number of correctly detected edge pixels to the number of ground truth (GT) pixels and the number of edge pixels that are actually detected by an algorithm (DC). The paper [10] evaluates the performance in terms of the so-called F-measure, defined as the harmonic mean of P and R, F
                        =2PR/(P
                        +
                        R). The higher the value of F, the better the result.


                        Fig. 13
                         shows the value of F computed on RuG database (20 images were selected) [10], for IGF, APD and MAGF. The average values of IGF, APD and MAGF are 0.35, 0.39 and 0.45, respectively.

The receiver-operating-characteristic curve (ROC curve) [54,55] can evaluate the accuracy of the different edge-detection algorithms, based on the ground truth (GT). For every pixel in an image, there are four possible edge-detection results, as shown in the Nomenclature. Hence, the ROC curve can be used to reflect the relationship between the true-positive (TP) and the false-positive (FP) rates of an edge-detection algorithm, where TP and FP are defined as follows: TP
                        =
                        n
                        
                           EE
                        /(n
                        
                           EE
                        
                        +
                        n
                        
                           ENE
                        ) and FP
                        =
                        n
                        
                           NEE
                        /(n
                        
                           NEE
                        
                        +
                        n
                        
                           NENE
                        ), where n
                        
                           EE
                        , n
                        
                           ENE
                        , n
                        
                           NEE
                        , and n
                        
                           NENE
                         are the number of pixels associated with EE, ENE, NEE, and NENE, respectively.


                        Fig. 14(a) shows the original image corrupted by Gaussian noise with zero-mean and 0.1 normalized variance. Fig. 14(b) illustrates the corresponding ground truth which was manually created. In the GT, the black pixels are edge pixels, the gray regions are no-edge regions, and the white are “don't count” regions in which the pixels are not specified as either an edge or a non-edge pixels. In the experiment, it is found that the edge map with FP
                        >0.1 suffers from too many spurious edge pixels. Hence, the value of FP is restricted within 0≤
                        FP
                        ≤0.1. Fig. 14(c) shows the ROC curves of our filter (MAGF), IGF, the Sobel edge detector, and the LoG edge detector. We can see that the FP rate of our proposed algorithm increases more sharply than that of the other three methods.

@&#CONCLUSION@&#

This paper proposes a 2-D multi-pixel anisotropic Gaussian filter (MAGF) by using an isotropic Gaussian filter and three characteristics of edges. The MAGF can be separated into two one-dimension filters. One is a 1-D parallel filter along the boundary, which is designed on the basis of three characteristics of edges. The other filter is a 1-D Gaussian derivative filter perpendicular to the boundary. Our theoretical analysis shows that the location precision and SNR of MAGF are over those of IGF. The proposed filter can simultaneously judge 2
                     h
                     +1 pixels to determine whether they are edge pixels or an ELS, which improves the continuity of detected edges. To enhance the robustness of our algorithm, the threshold relation between the MAGF and the IGF is used to estimate the threshold of MAGF. A decrease of the computational complexity of MAGF has been achieved by combing IGF and MAGF. The experimental results have demonstrated that the proposed filter has superior performance when compared with the other methods.

In our method large h is suitable for detecting long ELS, while small h is suitable for short ELS. One of our future works is to estimate the value of h based on the local characters of an image.

@&#ACKNOWLEDGMENTS@&#

The authors would like to thank the two anonymous reviewers very much for their valuable comments and suggestions that have significantly improved the manuscript. This work was supported by the Natural Science Foundation of China (no. 61271293).

In this appendix, we derive the SNR of IGF and the SNR of our filter. By using formula (2.5) and considering that f
                     
                        MAGF
                     (x,y) is two-dimensional, the SNR of Canny filter is changed into
                        
                           (A.1)
                           
                              
                                 SN
                                 
                                    R
                                    IGF
                                 
                                 =
                                 A
                                 
                                    ∫
                                    ∫
                                    
                                       
                                          u
                                          ¯
                                       
                                       
                                          
                                             −
                                             x
                                             ,
                                             −
                                             y
                                          
                                       
                                       
                                          f
                                          IGF
                                       
                                       
                                          x
                                          y
                                       
                                       dxdy
                                    
                                 
                                 /
                                 
                                    
                                       
                                          n
                                          0
                                       
                                       
                                          
                                             ∫
                                             ∫
                                             
                                                
                                                   f
                                                   IGF
                                                   2
                                                
                                                
                                                   x
                                                   y
                                                
                                                dxdy
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where n
                     0
                     2 is the mean-squared noise amplitude per unit length, 
                        
                           
                              u
                              ¯
                           
                           
                              x
                              y
                           
                        
                      is the edge function defined in Eq. (3.6).

Next, the numerator and denominator of Eq. (A.1), respectively, are computed by
                        
                           (A.2)
                           
                              
                                 A
                                 
                                    ∫
                                    
                                       
                                          
                                             ∫
                                             
                                                −
                                                ∞
                                             
                                             0
                                          
                                          
                                             
                                                u
                                                ¯
                                             
                                             
                                                
                                                   −
                                                   x
                                                   ,
                                                   −
                                                   y
                                                
                                             
                                             
                                                f
                                                IGF
                                             
                                             
                                                x
                                                y
                                             
                                             dxdy
                                          
                                       
                                    
                                 
                                 =
                                 A
                                 
                                    ∫
                                    
                                       exp
                                       
                                          
                                             −
                                             
                                                y
                                                2
                                             
                                             /
                                             
                                                
                                                   2
                                                   
                                                      σ
                                                      1
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 dy
                                 
                                    
                                       ∫
                                       
                                          −
                                          ∞
                                       
                                       0
                                    
                                    
                                       −
                                       
                                          x
                                          
                                             σ
                                             1
                                             2
                                          
                                       
                                       exp
                                       
                                          
                                             −
                                             
                                                x
                                                2
                                             
                                             /
                                             
                                                
                                                   2
                                                   
                                                      σ
                                                      1
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       dx
                                    
                                 
                                 =
                                 
                                    
                                       2
                                       π
                                    
                                 
                                 
                                    σ
                                    1
                                 
                                 A
                                 
                              
                           
                        
                     
                     
                        
                           (A.3)
                           
                              
                                 
                                    n
                                    0
                                 
                                 
                                    
                                       ∫
                                       ∫
                                       
                                          
                                             f
                                             IGF
                                             2
                                          
                                          
                                             x
                                             y
                                          
                                          dxdy
                                       
                                    
                                 
                                 =
                                 
                                    n
                                    0
                                 
                                 
                                    
                                       
                                          ∫
                                          
                                             exp
                                             
                                                
                                                   −
                                                   
                                                      y
                                                      2
                                                   
                                                   /
                                                   
                                                      σ
                                                      1
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       dy
                                       
                                          ∫
                                          
                                             
                                                
                                                   x
                                                   2
                                                
                                                
                                                   σ
                                                   1
                                                   4
                                                
                                             
                                             exp
                                             
                                                
                                                   −
                                                   
                                                      x
                                                      2
                                                   
                                                   /
                                                   
                                                      σ
                                                      1
                                                      2
                                                   
                                                
                                             
                                             dx
                                          
                                       
                                    
                                 
                                 =
                                 
                                    n
                                    0
                                 
                                 
                                    
                                       π
                                       /
                                       2
                                    
                                 
                              
                           
                        
                     
                  

Now, combining Eqs. (A.2) and (A.3) gives
                        
                           (A.4)
                           
                              
                                 SN
                                 
                                    R
                                    IGF
                                 
                                 =
                                 A
                                 
                                    σ
                                    1
                                 
                                 
                                    
                                       2
                                       π
                                    
                                 
                                 /
                                 
                                    
                                       
                                          n
                                          0
                                       
                                       
                                          
                                             π
                                             /
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 2
                                 
                                    σ
                                    1
                                 
                                 A
                                 /
                                 
                                    n
                                    0
                                 
                              
                           
                        
                     
                  

For brevity sake, let C(x)=(x
                     2/σ
                     1
                     4)exp(−
                     x
                     2/σ
                     1
                     2). Similarly, the SNR of the proposed 2-D filter is
                        
                           (A.5)
                           
                              
                                 SN
                                 
                                    R
                                    MAGF
                                 
                                 =
                                 A
                                 
                                    ∫
                                    ∫
                                    
                                       
                                          u
                                          ¯
                                       
                                       
                                          
                                             −
                                             x
                                             ,
                                             −
                                             y
                                          
                                       
                                       
                                          f
                                          MAGF
                                       
                                       
                                          x
                                          y
                                       
                                       dxdy
                                    
                                 
                                 /
                                 
                                    
                                       
                                          n
                                          0
                                       
                                       
                                          
                                             ∫
                                             ∫
                                             
                                                
                                                   f
                                                   MAGF
                                                   2
                                                
                                                
                                                   x
                                                   y
                                                
                                                dxdy
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     
                  

The numerator and denominator of Eq. (A.5) are also computed respectively:
                        
                           (A.6)
                           
                              
                                 
                                    
                                       A
                                       
                                          ∫
                                          
                                             
                                                
                                                   ∫
                                                   
                                                      −
                                                      ∞
                                                   
                                                   0
                                                
                                                
                                                   
                                                      u
                                                      ¯
                                                   
                                                   
                                                      
                                                         −
                                                         x
                                                         ,
                                                         −
                                                         y
                                                      
                                                   
                                                   
                                                      f
                                                      MAGF
                                                   
                                                   
                                                      x
                                                      y
                                                   
                                                   dxdy
                                                
                                             
                                          
                                       
                                       =
                                       A
                                       (
                                       
                                          
                                             ∫
                                             
                                                −
                                                ∞
                                             
                                             
                                                −
                                                h
                                             
                                          
                                          
                                             exp
                                             
                                                
                                                   −
                                                   
                                                      
                                                         y
                                                         +
                                                         h
                                                      
                                                   
                                                   /
                                                   
                                                      
                                                         2
                                                         
                                                            σ
                                                            1
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             dy
                                          
                                       
                                       +
                                       
                                          
                                             ∫
                                             
                                                −
                                                h
                                             
                                             h
                                          
                                          
                                             dy
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       +
                                       
                                          
                                             ∫
                                             h
                                             
                                                +
                                                ∞
                                             
                                          
                                          
                                             exp
                                             
                                                
                                                   −
                                                   
                                                      
                                                         
                                                            y
                                                            −
                                                            h
                                                         
                                                      
                                                      2
                                                   
                                                   /
                                                   
                                                      
                                                         2
                                                         
                                                            σ
                                                            1
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       dy
                                       )
                                    
                                 
                                 
                                    
                                       
                                       =
                                       A
                                       
                                          
                                             
                                                σ
                                                1
                                             
                                             
                                                
                                                   2
                                                   π
                                                
                                             
                                             +
                                             2
                                             h
                                          
                                       
                                       .
                                    
                                 
                                 
                                    
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (A.7)
                           
                              
                                 
                                    
                                       
                                          n
                                          0
                                       
                                       
                                          
                                             ∫
                                             ∫
                                             
                                                
                                                   f
                                                   MAGF
                                                   2
                                                
                                                
                                                   x
                                                   y
                                                
                                                dxdy
                                             
                                          
                                       
                                       =
                                       
                                          n
                                          0
                                       
                                       
                                          
                                             
                                                ∫
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∫
                                                               
                                                                  −
                                                                  ∞
                                                               
                                                               
                                                                  −
                                                                  h
                                                               
                                                            
                                                            
                                                               C
                                                               
                                                                  x
                                                               
                                                               exp
                                                               
                                                                  
                                                                     −
                                                                     
                                                                        
                                                                           
                                                                              y
                                                                              +
                                                                              h
                                                                           
                                                                        
                                                                        2
                                                                     
                                                                     /
                                                                     
                                                                        σ
                                                                        1
                                                                        2
                                                                     
                                                                  
                                                               
                                                               dy
                                                               +
                                                            
                                                         
                                                         
                                                            
                                                               ∫
                                                               
                                                                  −
                                                                  h
                                                               
                                                               h
                                                            
                                                            
                                                               C
                                                               
                                                                  x
                                                               
                                                               dy
                                                               +
                                                               
                                                                  
                                                                     ∫
                                                                     h
                                                                     
                                                                        +
                                                                        ∞
                                                                     
                                                                  
                                                                  
                                                                     C
                                                                     
                                                                        x
                                                                     
                                                                     exp
                                                                     
                                                                        
                                                                           −
                                                                           
                                                                              
                                                                                 
                                                                                    y
                                                                                    −
                                                                                    h
                                                                                 
                                                                              
                                                                              2
                                                                           
                                                                           /
                                                                           
                                                                              σ
                                                                              1
                                                                              2
                                                                           
                                                                        
                                                                     
                                                                     dy
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             dx
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       =
                                       
                                          n
                                          0
                                       
                                       
                                          
                                             
                                                ∫
                                                
                                                   C
                                                   
                                                      x
                                                   
                                                   dx
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         σ
                                                         1
                                                      
                                                      
                                                         π
                                                      
                                                      +
                                                      2
                                                      h
                                                   
                                                
                                             
                                          
                                       
                                       =
                                       
                                          n
                                          0
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      π
                                                   
                                                   /
                                                   2
                                                   
                                                      σ
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      σ
                                                      1
                                                   
                                                   
                                                      π
                                                   
                                                   +
                                                   2
                                                   h
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        
                     
                  

Combining Eqs. (A.6) and (A.7), we have
                        
                           
                              
                                 SN
                                 
                                    R
                                    MAGF
                                 
                                 =
                                 A
                                 
                                    
                                       
                                          σ
                                          1
                                       
                                       
                                          
                                             2
                                             π
                                          
                                       
                                       +
                                       2
                                       h
                                    
                                 
                                 /
                                 
                                    
                                       
                                          n
                                          0
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      σ
                                                      1
                                                   
                                                   
                                                      π
                                                   
                                                   +
                                                   2
                                                   h
                                                
                                             
                                             
                                                π
                                             
                                             /
                                             2
                                             
                                                σ
                                                1
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     
                  

Hence, the ratio of SNR
                     
                        MAGF
                      to SNR
                     
                        GF
                      is determined as follows:
                        
                           (A.8)
                           
                              
                                 
                                    
                                       SN
                                       
                                          R
                                          MAGF
                                       
                                       /
                                       SN
                                       
                                          R
                                          IGF
                                       
                                    
                                 
                                 =
                                 A
                                 
                                    
                                       
                                          σ
                                          1
                                       
                                       
                                          
                                             2
                                             π
                                          
                                       
                                       +
                                       2
                                       h
                                    
                                 
                                 /
                                 
                                    
                                       
                                          n
                                          0
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      σ
                                                      1
                                                   
                                                   
                                                      π
                                                   
                                                   +
                                                   2
                                                   h
                                                
                                             
                                             
                                                π
                                             
                                             /
                                             2
                                             
                                                σ
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          n
                                          0
                                       
                                       /
                                       
                                          
                                             2
                                             
                                                σ
                                                1
                                             
                                             A
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                       +
                                       γ
                                       
                                          
                                             2
                                             /
                                             π
                                          
                                       
                                    
                                 
                                 /
                                 
                                    
                                       1
                                       +
                                       2
                                       γ
                                       /
                                       
                                          π
                                       
                                    
                                 
                              
                           
                        
                     where γ
                     =
                     h/σ
                     1. If γ
                     >0, it can be seen that 
                        
                           
                              
                                 
                                    1
                                    +
                                    γ
                                    
                                       
                                          2
                                          /
                                          π
                                       
                                    
                                 
                              
                              2
                           
                           −
                           1
                           −
                           2
                           γ
                           /
                           
                              π
                           
                           =
                           2
                           γ
                           
                              
                                 
                                    2
                                 
                                 −
                                 1
                              
                           
                           /
                           
                              π
                           
                           +
                           2
                           
                              γ
                              2
                           
                           /
                           π
                        
                     , which shows that SNR
                     
                        MAGF
                     /SNR
                     
                        IGF
                     
                     >1. The above result indicates that MAGF has higher SNR.

In this appendix, we derive the GL of IGF and the GL of our filter. If a two-dimensional edge is modeled by formula (3.6) and the corresponding two-dimensional filter f(x,y), then the location criterion (2.3) should be changed into the following form
                        
                           (B.1)
                           
                              
                                 GL
                                 =
                                 
                                    
                                       ∫
                                       
                                          
                                             ∫
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         u
                                                         ¯
                                                      
                                                      
                                                         x
                                                         y
                                                      
                                                      /
                                                      ∂
                                                      x
                                                   
                                                
                                                
                                                   
                                                      ∂
                                                      f
                                                      
                                                         x
                                                         y
                                                      
                                                      /
                                                      ∂
                                                      x
                                                   
                                                
                                                dxdy
                                             
                                          
                                       
                                    
                                 
                                 /
                                 
                                    n
                                    0
                                 
                                 
                                    
                                       ∫
                                       
                                          
                                             ∫
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         f
                                                         
                                                            x
                                                            y
                                                         
                                                         /
                                                         ∂
                                                         x
                                                      
                                                   
                                                   2
                                                
                                                dxdy
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Since 
                        
                           
                              
                                 ∂
                                 
                                    u
                                    ¯
                                 
                                 
                                    x
                                    y
                                 
                                 /
                                 ∂
                                 x
                              
                           
                           =
                           Aδ
                           
                              x
                           
                        
                     , and there are formula (B.1) and f
                     
                        IGF
                     (x,y) defined in Eq. (2.5), the GL of the 2-D Canny filter is defined as
                        
                           (B.2)
                           
                              
                                 G
                                 
                                    L
                                    IGF
                                 
                                 =
                                 
                                    
                                       A
                                       
                                          ∫
                                          
                                             ∂
                                             
                                                f
                                                IGF
                                             
                                             
                                                x
                                                y
                                             
                                             /
                                             ∂
                                             x
                                             
                                                
                                                   
                                                   
                                                      x
                                                      =
                                                      0
                                                   
                                                
                                             
                                             dy
                                          
                                       
                                    
                                 
                                 /
                                 
                                    
                                       
                                          n
                                          0
                                       
                                       
                                          
                                             ∫
                                             
                                                
                                                   ∫
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                               
                                                                  f
                                                                  IGF
                                                               
                                                               
                                                                  x
                                                                  y
                                                               
                                                               /
                                                               ∂
                                                               x
                                                            
                                                         
                                                         2
                                                      
                                                      dxdy
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Since (∂f
                     
                        IGF
                     (x,y)/∂x)=(x
                     2/σ
                     1
                     4
                     −1/σ
                     1
                     2)exp(−(x
                     2
                     +
                     y
                     2)/(2σ
                     1
                     2)), then the numerator of GL
                     
                        IGF
                      is given by
                        
                           (B.3)
                           
                              
                                 
                                    
                                       A
                                       
                                          
                                             ∫
                                             
                                                ∂
                                                
                                                   f
                                                   IGF
                                                
                                                
                                                   x
                                                   y
                                                
                                                /
                                                ∂
                                                x
                                                
                                                   
                                                      
                                                      
                                                         x
                                                         =
                                                         0
                                                      
                                                   
                                                
                                                dy
                                             
                                          
                                       
                                       =
                                       A
                                       
                                          
                                             ∫
                                             
                                                
                                                   
                                                      
                                                         x
                                                         2
                                                      
                                                      /
                                                      
                                                         σ
                                                         1
                                                         4
                                                      
                                                      −
                                                      1
                                                      /
                                                      
                                                         σ
                                                         1
                                                         2
                                                      
                                                   
                                                
                                                exp
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            
                                                               x
                                                               2
                                                            
                                                            +
                                                            
                                                               y
                                                               2
                                                            
                                                         
                                                      
                                                      /
                                                      
                                                         
                                                            2
                                                            
                                                               σ
                                                               1
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                      
                                                         x
                                                         =
                                                         0
                                                      
                                                   
                                                
                                                dy
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       =
                                       A
                                       
                                          
                                             2
                                             π
                                          
                                       
                                       /
                                       
                                          σ
                                          1
                                       
                                    
                                 
                              
                           
                        
                     
                  

The denominator of GL
                     
                        IGF
                      can be written as
                        
                           (B.4)
                           
                              
                                 
                                    
                                       
                                          n
                                          0
                                       
                                       
                                          
                                             
                                                ∫
                                                ∫
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            
                                                               f
                                                               IGF
                                                            
                                                            
                                                               x
                                                               y
                                                            
                                                            /
                                                            ∂
                                                            x
                                                         
                                                      
                                                      2
                                                   
                                                
                                             
                                             dxdy
                                          
                                       
                                       =
                                       
                                          n
                                          0
                                       
                                       
                                          
                                             ∫
                                             ∫
                                             
                                                exp
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            
                                                               y
                                                               2
                                                            
                                                            +
                                                            
                                                               x
                                                               2
                                                            
                                                         
                                                      
                                                      /
                                                      
                                                         σ
                                                         1
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         x
                                                         4
                                                      
                                                      /
                                                      
                                                         σ
                                                         1
                                                         8
                                                      
                                                      +
                                                      1
                                                      /
                                                      
                                                         σ
                                                         1
                                                         4
                                                      
                                                      −
                                                      2
                                                      
                                                         x
                                                         2
                                                      
                                                      /
                                                      
                                                         σ
                                                         1
                                                         6
                                                      
                                                   
                                                
                                                dxdy
                                             
                                          
                                       
                                       
                                    
                                 
                                 
                                    
                                       
                                       =
                                       
                                          n
                                          0
                                       
                                       
                                          
                                             3
                                             π
                                             /
                                             
                                                
                                                   4
                                                   
                                                      σ
                                                      1
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                    
                                 
                              
                           
                        
                     
                  

Inserting Eqs. (B.3) and (B.4) into Eq. (B.2), we have
                        
                           (B.5)
                           
                              
                                 G
                                 
                                    L
                                    IGF
                                 
                                 =
                                 
                                    
                                       A
                                       
                                          
                                             2
                                             π
                                          
                                       
                                       /
                                       
                                          σ
                                          1
                                       
                                    
                                 
                                 /
                                 
                                    
                                       
                                          n
                                          0
                                       
                                       
                                          
                                             3
                                             π
                                             /
                                             
                                                
                                                   4
                                                   
                                                      σ
                                                      1
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       8
                                       /
                                       3
                                    
                                 
                                 
                                    
                                       A
                                       /
                                       
                                          n
                                          0
                                       
                                    
                                 
                              
                           
                        
                     
                  

According to Eq. (B.1), we can similarly define the GL of the MAGF as follows:
                        
                           (B.6)
                           
                              
                                 G
                                 
                                    L
                                    MAGF
                                 
                                 =
                                 
                                    
                                       A
                                       
                                          ∫
                                          
                                             ∂
                                             
                                                f
                                                MAGF
                                             
                                             
                                                x
                                                y
                                             
                                             /
                                             ∂
                                             x
                                             
                                                
                                                   
                                                   
                                                      x
                                                      =
                                                      0
                                                   
                                                
                                             
                                             dy
                                          
                                       
                                    
                                 
                                 /
                                 
                                    n
                                    0
                                 
                                 
                                    
                                       ∫
                                       
                                          
                                             ∫
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         
                                                            f
                                                            MAGF
                                                         
                                                         
                                                            x
                                                            y
                                                         
                                                         /
                                                         ∂
                                                         x
                                                      
                                                   
                                                   2
                                                
                                                dxdy
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

For brevity sake, let D(x)=(x
                     2/σ
                     1
                     4
                     −1/σ
                     1
                     2)exp(−
                     x
                     2/2σ
                     1
                     2), then the ∂f
                     
                        MAGF
                     (x,y)/∂x is given by
                        
                           (B.7)
                           
                              
                                 
                                    
                                       ∂
                                       
                                          f
                                          MAGF
                                       
                                       
                                          x
                                          y
                                       
                                       /
                                       ∂
                                       x
                                    
                                 
                                 =
                                 D
                                 
                                    x
                                 
                                 H
                                 
                                    y
                                 
                                 =
                                 
                                    
                                       
                                          
                                             D
                                             
                                                x
                                             
                                             exp
                                             (
                                             −
                                             (
                                             y
                                             −
                                             h
                                             )
                                             
                                                
                                                2
                                             
                                             /
                                             (
                                             2
                                             
                                                σ
                                                1
                                                2
                                             
                                             )
                                             )
                                             
                                             h
                                             <
                                             y
                                             <
                                             ∞
                                          
                                       
                                       
                                          
                                             D
                                             
                                                x
                                             
                                             
                                             −
                                             h
                                             ≤
                                             y
                                             ≤
                                             h
                                          
                                       
                                       
                                          
                                             D
                                             
                                                x
                                             
                                             exp
                                             (
                                             −
                                             (
                                             y
                                             +
                                             h
                                             )
                                             
                                                
                                                2
                                             
                                             /
                                             (
                                             2
                                             
                                                σ
                                                1
                                                2
                                             
                                             )
                                             )
                                             
                                             −
                                             ∞
                                             <
                                             y
                                             <
                                             −
                                             h
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

According to Eqs. (B.6) and (B.7), the numerator and denominator of GL
                     
                        MAGF
                      are as follows:
                        
                           (B.8)
                           
                              
                                 A
                                 
                                    
                                       
                                          
                                             ∫
                                             
                                                ∂
                                                
                                                   f
                                                   MAGF
                                                
                                                
                                                   x
                                                   y
                                                
                                                /
                                                ∂
                                                x
                                                
                                                   
                                                      
                                                      
                                                         x
                                                         =
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                          dy
                                       
                                    
                                 
                                 =
                                 
                                    
                                       A
                                       /
                                       
                                          σ
                                          1
                                          2
                                       
                                    
                                 
                                 
                                    ∫
                                    
                                       H
                                       
                                          y
                                       
                                    
                                 
                                 dy
                                 =
                                 A
                                 
                                    
                                       2
                                       h
                                       +
                                       
                                          
                                             2
                                             π
                                          
                                       
                                       
                                          σ
                                          1
                                       
                                    
                                 
                                 /
                                 
                                    σ
                                    1
                                    2
                                 
                              
                           
                        
                     
                     
                        
                           (B.9)
                           
                              
                                 
                                    
                                       
                                          n
                                          0
                                       
                                       
                                          
                                             ∫
                                             ∫
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         
                                                            f
                                                            MAGF
                                                         
                                                         
                                                            x
                                                            y
                                                         
                                                         /
                                                         ∂
                                                         x
                                                      
                                                   
                                                   2
                                                
                                                dxdy
                                             
                                          
                                       
                                       =
                                       
                                          n
                                          0
                                       
                                       
                                          
                                             
                                                
                                                   ∫
                                                   
                                                      
                                                         D
                                                         2
                                                      
                                                      
                                                         x
                                                      
                                                      dx
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∫
                                                         
                                                            −
                                                            ∞
                                                         
                                                         
                                                            −
                                                            h
                                                         
                                                      
                                                      
                                                         exp
                                                         
                                                            
                                                               −
                                                               
                                                                  
                                                                     
                                                                        y
                                                                        −
                                                                        h
                                                                     
                                                                  
                                                                  2
                                                               
                                                               /
                                                               
                                                                  σ
                                                                  1
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   dy
                                                   +
                                                   
                                                      
                                                         ∫
                                                         
                                                            −
                                                            h
                                                         
                                                         h
                                                      
                                                      
                                                         dy
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         ∫
                                                         h
                                                         
                                                            +
                                                            ∞
                                                         
                                                      
                                                      
                                                         exp
                                                         
                                                            
                                                               −
                                                               
                                                                  
                                                                     
                                                                        y
                                                                        +
                                                                        h
                                                                     
                                                                  
                                                                  2
                                                               
                                                               /
                                                               
                                                                  σ
                                                                  1
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   dy
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    
                                       
                                       =
                                       
                                          n
                                          0
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      σ
                                                      1
                                                   
                                                   
                                                      π
                                                   
                                                   +
                                                   2
                                                   h
                                                
                                             
                                             
                                                
                                                   3
                                                   
                                                      π
                                                   
                                                   /
                                                   4
                                                   
                                                      σ
                                                      1
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Now, substituting Eqs. (B.8) and (B.9) into Eq. (B.6) gives
                        
                           (B.10)
                           
                              
                                 
                                    
                                       G
                                       
                                          L
                                          MAGF
                                       
                                       =
                                       
                                          
                                             A
                                             
                                                
                                                   2
                                                   h
                                                   +
                                                   
                                                      
                                                         2
                                                         π
                                                      
                                                   
                                                   
                                                      σ
                                                      1
                                                   
                                                
                                             
                                             /
                                             
                                                σ
                                                1
                                                2
                                             
                                          
                                       
                                       /
                                       
                                          
                                             
                                                n
                                                0
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            σ
                                                            1
                                                         
                                                         
                                                            π
                                                         
                                                         +
                                                         2
                                                         h
                                                      
                                                   
                                                   3
                                                   
                                                      π
                                                   
                                                   /
                                                   4
                                                   
                                                      σ
                                                      1
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       =
                                       A
                                       
                                          
                                             2
                                             
                                                
                                                   2
                                                   π
                                                
                                             
                                             +
                                             4
                                             γ
                                          
                                       
                                       /
                                       
                                          
                                             
                                                n
                                                0
                                             
                                             
                                                
                                                   3
                                                   
                                                      π
                                                   
                                                   
                                                      
                                                         
                                                            π
                                                         
                                                         +
                                                         2
                                                         γ
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           
                        
                     where γ
                     =
                     h/σ
                     1. Moreover, noting that the ratio of GL
                     
                        MAGF
                      to GL
                     
                        GF
                      is
                        
                           (B.11)
                           
                              
                                 
                                    
                                       G
                                       
                                          L
                                          MAGF
                                       
                                       /
                                       G
                                       
                                          L
                                          IGF
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          π
                                       
                                       +
                                       
                                          2
                                       
                                       γ
                                    
                                 
                                 /
                                 
                                    
                                       
                                          π
                                       
                                       
                                          
                                             
                                                π
                                             
                                             +
                                             2
                                             γ
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          π
                                       
                                       +
                                       γ
                                       
                                          2
                                       
                                    
                                 
                                 /
                                 
                                    
                                       π
                                       +
                                       2
                                       γ
                                       
                                          π
                                       
                                    
                                 
                              
                           
                        
                     
                  

Assume that γ
                     >0, it is obvious that 
                        
                           
                              
                                 
                                    
                                       π
                                    
                                    +
                                    γ
                                    
                                       2
                                    
                                 
                              
                              2
                           
                           −
                           π
                           −
                           2
                           γ
                           
                              π
                           
                           =
                           2
                           
                              γ
                              2
                           
                           +
                           2
                           γ
                           
                              π
                           
                           
                              
                                 
                                    2
                                 
                                 −
                                 1
                              
                           
                           >
                           0
                        
                     , which shows that GL
                     
                        MAGF
                     /GL
                     
                        IGF
                     
                     >1, if γ
                     >0. The above result demonstrates that MAGF has better location precision.

@&#REFERENCES@&#

