@&#MAIN-TITLE@&#Color constancy for visual compensation of projector displayed image

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We model the sensed image by human eye.


                        
                        
                           
                           We explore the color constancy to reduce the screen effects on the projected image.


                        
                        
                           
                           We argue that the proposed model goes further than the von Kries theory.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Computational color constancy

Image display

Projector

Viewing conditions

Projection screen

Von Kries

@&#ABSTRACT@&#


               
               
                  The color of a displayed image by a projector can be distorted by features of the device, the ambient light, the projection screen, and also the observer. This has raised the need to correct the image during the display to eliminate these effects and to ensure a constancy of the color appearances. In this paper, we propose models for controlling the appearance of the displayed image. We argue that depending on the target application, the computational color constancy can be specified at different steps of the formation scheme of the sensed image by a human. Based on that observation and the image formation models, we reformulate the problem of the color constancy and we show that the resulting transformations cannot be explained by von Kries theory. Two compensation algorithms are deduced. The first allows preserving the appearance of the original image, and it can be used for the constancy of the acquired image whatever the environment conditions. The second algorithm allows to simulate appearances of a sensed image in a specific conditions. It can be used for the compensation of the screen reflectance or to create special effects or the camouflage. In addition, we propose a complementary operation for the contrast compensation which is derived from the Weber’s law. Experimental results show the merits of the proposed models and algorithms.
               
            

@&#INTRODUCTION@&#

Projectors become more proliferate and integrated in multiple areas. However, the quality of the displayed image can be adversely affected by the device used and the real viewing conditions. The displayed image under bright conditions may appear with washed colors and attenuated contrast. The appearance of an image captured under illuminant D65, will be also affected when it is perceived under another illuminant. The mismatch between the display environmental illuminant and the illuminant of the image acquisition may influence the perception of the image. In addition, the displayed image onto an ordinary surface will be affected, where its appearance will be modulated by the color and the geometry of the surface. The projector features could also affect the quality of the displayed image. The transfer function, and the embedded color signal processing influence the color generation. Moreover, the sensed image quality depends on the spectral abilities of the human visual system (HVS). As it is characterized by its nonlinear response to the intensity of the ambient light [1], this means that the perceived contrast of the image will be necessarily affected.

The use of a projector anywhere is a challenging task that requires controlling the appearance of the sensed image. Indeed, we need for some applications, an image appears for a normal viewer the same regardless of the display conditions. Similarity is desired between the image as it was created and its sensed version. For other applications, we prefer to control the display conditions in order to cancel out or to create some distortion effects such as in cases of visual effects or digital art.

Controlling effects of the viewing conditions can be done through two approaches: material and computational. The materiel approach consists in monitoring the projector settings according to the environmental features, such as the ambient light which can be measured by a photometer [2,3]. Some specific screens are designed in the manner that the ambient light will be reflected out of the observer direction [4], the area where viewers can be placed needs to be specified during the installation phase. In the materiel based approach, the concern is the measure of the light present in the environment rather than its perceptual impact [2], where the compensation is considered as a global phenomena. However, the local compensation of the ambient light intensity, the light color, and the projection screen are not available. This is the basis of the computational approach [5–11]. Our work falls within the last approach, in which we propose the transformation of the image according to the viewing conditions before sending it to the projector. The viewing conditions can be recovered through acquiring images of the projection screen. Indeed, the modified image displayed by the projector can create the desired appearance by interacting with the environmental parameters.

This paper is organized as it follows. In the next section, we present the problem statement. After, in Section 3 we detail our proposed models of the compensation of viewing conditions. Then, Section 4 provides details on the method used in parameters estimation. In Section 5, the experimental results are presented. Finally, we conclude this paper with a summary of the work.

As it is indicated above, several factors influence the appearance of the displayed image, among them, there is the projection surface and the surrounding lights. Consequently, the projected image will undergo two transformations noted S and L, respectively. Furthermore, the effect generated by a projector can be represented by a transformation D. Moreover, we note the effects due to HVS by a transformation O. Indeed, for an original image I that will be displayed by a projector, its corresponding image sensed by a viewer noted 
                        
                           
                              
                                 I
                              
                              
                                 O
                              
                           
                        
                     , can be written as:
                        
                           (1)
                           
                              
                                 
                                    I
                                 
                                 
                                    O
                                 
                              
                              =
                              O
                              (
                              L
                              (
                              S
                              (
                              D
                              (
                              I
                              )
                              )
                              )
                              )
                              .
                           
                        
                     
                  

We note that the limitations of the HVS in terms of contrast perception and ambient conditions should be considered. Therefore, a correlation can be deduced between the intensity of the surrounding light, the response of the human eye and the perceived contrast. This can be expressed by a model which will be described later. Indeed, controlling the desired appearance of an image requires to be aware of all effects of viewing conditions that adversely influence the appearance.

In this paper, we address the control of the viewing conditions for projector-based display system through the color constancy concept. The goal is to make the displayed images invariant to some factors depending on the use purpose. In the literature, the von Kries theory based computational color constancy has been widely studied for a chromatic adaptation and for white balancing [12]. But, to the best of our knowledge, it was never explicitly broached for projector-based display systems. For images displayed by a projector and viewed by a normal viewer, we show that the color constancy concept can be extended and used in different ways. As it is shown in Fig. 1
                     , we categorize applications into two possible scenarios; (1) preservation of the image appearance and (2) simulation of the image appearance as it will be detailed later. By the first scenario, we propose to preserve the appearance of the displayed image sensed by a viewer to appear similar to the original image as it was created. Consequently, the sensed image should be invariant to the response of the projector, the ambient light, the projection screen and also the response of the viewer. For example, we can perceive a sunset image as it was captured by a camera independently of how or where it is displayed. By the second scenario, we were interested to make two images viewed under two different conditions appear identical. This scenario was particularly designed in the perspective of simulation, whereby, we can simulate other effects that can be produced under specific environments of visualization. For example, this can be used for visual arts and camouflage, where we can create some artistic effects. Therefore, the illuminant of the display environment and the target illuminant are introduced by the proposed model for this scenario, similar to the current and the target screen reflectance. In addition, aiming to produce the desired visual contrast of the displayed image under bright conditions, the Weber law is used for the image contrast enhancement according to the intensity of the surrounding light.

In the field of the environmental conditions compensation, there exist in literature two families of methods: the heuristic methods and the image formation based methods. These methods were designed principally in order to reduce some effects of the environmental conditions, where the above transformations have been studied. For the heuristic methods, works [10,9,13] proposed frameworks considering the preceding transformations separately. In [11], the method was based on power law function to map the input range to the output range, considering the contrast enhancement. We note that the compensation algorithms based on heuristic arguments are different from ours. For image formation based methods, all are designed to deal with the color constancy between the original image and the image captured by a camera (first scenario). The transformation S is considered in [6,5], and L in [5]. They [6,5] proposed a set of parameters higher to a matrix 3×3 of color mixing for every pixel of the image. Authors in [7] proposed a method based on one color mixing matrix for the entire image. However, in a dark environment, this matrix is eliminated in [14] by using a color filter for both the projector and the camera. Note that the second scenario described above is not tackled before. Unlike these approaches, the one we propose deals with both scenarios in addition to the use of one global estimated matrix 3×3 for all images. More precisely, Table 1
                      summarized the similarities and differences between different approaches including ours. We can resume contributions of the paper as the followings. (1) We reformulate and exploit the computational color constancy concept for projector systems which can be seen as a fundamental founding; (2) we propose models for both scenarios that are appearance preserving and appearance simulation; and (3) we take into account four transformations.

In this section, we provide details of each model corresponding to two scenarios described above, by modeling the spectral response of the projector, the screen reflectance, the surrounding lights and the spectral response of the viewer. Transformations could be linear [5,6,8,10] or nonlinear [11]. In this work, we consider all transformations as linear.

To this end, we need to further develop the model of the sensed image formation in Eq. (1). Then, we will explain how we can employ the color constancy between the sensed image and the original image (scenario 1), as well as two sensed images under two different environments (scenario 2). After that, as the HVS is affected by the surrounding light, it becomes harder to see details of the displayed image in bright conditions. Consequently, the visual contrast of the sensed image will be attenuated. To overcome this limitation, we propose a method to enhance the contrast of the displayed image according to the surrounding light intensity. Note that the projector has three-color channels 
                        
                           R
                           ,
                           G
                        
                      and B.

The projector input pixel 
                        
                           
                              
                                 I
                              
                              
                                 k
                              
                           
                        
                      of the 
                        
                           k
                        
                     
                     th band of an image is modulated by its spectral response 
                        
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           (
                           λ
                           )
                        
                     , which includes all spectral responses of the projector optical components such as the lens and the physical processing operations. The 
                        
                           k
                        
                     
                     th light band 
                        
                           
                              
                                 E
                              
                              
                                 k
                              
                           
                           (
                           λ
                           )
                        
                      generated by the projector through its lens is given by Eq. (2) 
                     [5,6], where 
                        
                           λ
                        
                      represents the wavelength of the visible spectrum. A linear transformation D is considered, since the DLP projectors used are assumed digital linear systems [7,15].
                        
                           (2)
                           
                              
                                 
                                    E
                                 
                                 
                                    k
                                 
                              
                              (
                              λ
                              )
                              =
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                              (
                              λ
                              )
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              (
                              λ
                              )
                              .
                           
                        
                     
                  

Note that the colored point of the projection screen has a spectral reflectance represented by 
                        
                           
                              
                                 ρ
                              
                              
                                 kc
                              
                           
                           (
                           λ
                           )
                        
                     , where k in 
                        
                           {
                           R
                           ,
                           G
                           ,
                           B
                           }
                        
                     , it is considered as the color channel of the screen. Let 
                        
                           
                              
                                 l
                              
                              
                                 a
                              
                           
                           (
                           λ
                           )
                        
                      be the spectral distribution of the actual surrounding illumination. The human eye receives a mixture of lights that are reflected by the projection screen. These lights come from the projector and the surrounding illumination. Yet the radiance 
                        
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                        
                      of the scene point in the direction of the viewer’s eye is written as it follows:
                        
                           (3)
                           
                              
                                 
                                    R
                                 
                                 
                                    k
                                 
                              
                              (
                              λ
                              )
                              =
                              
                                 
                                    
                                       
                                          I
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    λ
                                    )
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    λ
                                    )
                                    +
                                    
                                       
                                          l
                                       
                                       
                                          a
                                          k
                                       
                                    
                                    (
                                    λ
                                    )
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    kc
                                 
                              
                              (
                              λ
                              )
                              .
                           
                        
                     
                  

Let 
                        
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                           (
                           λ
                           )
                        
                      be the spectral perceptual abilities of the viewer when the eye has adapted to the surrounding light 
                        
                           
                              
                                 l
                              
                              
                                 a
                              
                           
                        
                     . The effects of eyes optics can be considered as encoded in 
                        
                           
                              
                                 I
                              
                              
                                 k
                              
                           
                        
                     . Under the above conditions, the sensed image 
                        
                           
                              
                                 A
                              
                              
                                 k
                              
                           
                        
                      by the viewer can be written as
                        
                           (4)
                           
                              
                                 
                                    A
                                 
                                 
                                    k
                                 
                              
                              =
                              ∫
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       λ
                                       )
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       λ
                                       )
                                       +
                                       
                                          
                                             l
                                          
                                          
                                             ak
                                          
                                       
                                       (
                                       λ
                                       )
                                    
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    kc
                                 
                              
                              (
                              λ
                              )
                              
                                 
                                    s
                                 
                                 
                                    k
                                 
                              
                              (
                              λ
                              )
                              d
                              λ
                              .
                           
                        
                     
                  

Note that this is a defined integral in the range of visible spectrum. Now, as we indicated before, we can make two different color constants depending to the application purpose. In what follows, we will demonstrate the use of each one.

The aim is to make two images sensed under two different environments appear identical. Let 
                           
                              
                                 
                                    l
                                 
                                 
                                    b
                                 
                              
                           
                         be the spectral distribution of another illumination and 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    kw
                                 
                              
                              (
                              λ
                              )
                           
                         be the spectral reflectance of a white screen point. For the original pixel I, if the viewer is adapted to the visualization environment, the displayed image onto a white screen and under the illumination 
                           
                              
                                 
                                    l
                                 
                                 
                                    b
                                 
                              
                           
                        , will be sensed. It can be written as:
                           
                              (5)
                              
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 ∫
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          λ
                                          )
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          λ
                                          )
                                          +
                                          
                                             
                                                l
                                             
                                             
                                                bk
                                             
                                          
                                          (
                                          λ
                                          )
                                       
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       kw
                                    
                                 
                                 (
                                 λ
                                 )
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 λ
                                 )
                                 d
                                 λ
                                 .
                              
                           
                        
                     

Our main interests is to make it possible that under the first conditions (i.e. the colorful screen and the illumination 
                           
                              
                                 
                                    l
                                 
                                 
                                    a
                                 
                              
                           
                        ), the projected image appears the same as it appears under the second conditions (i.e. the white screen and the illumination 
                           
                              
                                 
                                    l
                                 
                                 
                                    b
                                 
                              
                           
                        ). To make this point clear, we refer to the example in Fig. 1(b). As we are interested by the HVS, the constancy concerns the images sensed by the retina of the human eye. We want the sensed image (A) to be similar by a viewer under the first conditions to the one sensed (B) under the second conditions. However, since the two environments are different, the equality between the two appearances could be done by modifying the original image under the first conditions, before sending it to the projector, where a transformation T will be applied to the original image that takes into account transformations due to the first conditions. This is can be expressed as
                           
                              (6)
                              
                                 B
                                 (
                                 I
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       b
                                    
                                 
                                 ,
                                 screen
                                 2
                                 )
                                 =
                                 B
                                 (
                                 T
                                 (
                                 I
                                 )
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       a
                                    
                                 
                                 ,
                                 screen
                                 1
                                 )
                                 .
                              
                           
                        Formally and using Eqs. (4) and (5), the equality in Eq. (6) can be written as
                           
                              (7)
                              
                                 ∫
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          λ
                                          )
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          λ
                                          )
                                          +
                                          
                                             
                                                l
                                             
                                             
                                                bk
                                             
                                          
                                          (
                                          λ
                                          )
                                       
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       kw
                                    
                                 
                                 (
                                 λ
                                 )
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 λ
                                 )
                                 d
                                 λ
                                 =
                                 ∫
                                 
                                    
                                       
                                          T
                                          (
                                          
                                             
                                                I
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          λ
                                          )
                                          )
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          λ
                                          )
                                          +
                                          
                                             
                                                l
                                             
                                             
                                                ak
                                             
                                          
                                          (
                                          λ
                                          )
                                       
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       kc
                                    
                                 
                                 (
                                 λ
                                 )
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 λ
                                 )
                                 d
                                 λ
                                 .
                              
                           
                        
                     

The goal is to find the transformation T by solving this integral equation. Let us consider that the function in Eq. (3) is continuous in the visible spectrum. This assumption is realistic because the quantities involved are of physical nature produced by electronic components or they go trough the lenses of the camera and the projector. In this case, under the assumption that 
                           
                              s
                              (
                              λ
                              )
                           
                         is the Dirac, the Lebesgue integral with respect to this measure allows to rewrite the previous equation as:
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          λ
                                          )
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          λ
                                          )
                                          +
                                          
                                             
                                                l
                                             
                                             
                                                bk
                                             
                                          
                                          (
                                          λ
                                          )
                                       
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       kw
                                    
                                 
                                 (
                                 λ
                                 )
                                 =
                                 
                                    
                                       
                                          T
                                          (
                                          
                                             
                                                I
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          λ
                                          )
                                          )
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          λ
                                          )
                                          +
                                          
                                             
                                                l
                                             
                                             
                                                ak
                                             
                                          
                                          (
                                          λ
                                          )
                                       
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       kc
                                    
                                 
                                 (
                                 λ
                                 )
                                 .
                              
                           
                        Which yields
                           
                              (9)
                              
                                 T
                                 (
                                 
                                    
                                       I
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             kw
                                          
                                       
                                    
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             kc
                                          
                                       
                                    
                                 
                                 
                                    
                                       I
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                ak
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      kw
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      kc
                                                   
                                                
                                             
                                          
                                          
                                             
                                                l
                                             
                                             
                                                bk
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Further we will explain how we overcome the Dirac assumption. For three-color channels, Eq. (9) leads to be written in matrix form as:
                           
                              (10)
                              
                                 M
                                 =
                                 PI
                                 -
                                 Λ
                                 ∇
                                 L
                                 ,
                              
                           
                        where
                           
                              
                                 M
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         G
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 I
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         G
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       l
                                    
                                    
                                       a
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         aR
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         aG
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         aB
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       l
                                    
                                    
                                       b
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         bR
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         bG
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         bB
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 Λ
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Λ
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Λ
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Λ
                                                      
                                                      
                                                         13
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Λ
                                                      
                                                      
                                                         21
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Λ
                                                      
                                                      
                                                         22
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Λ
                                                      
                                                      
                                                         23
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Λ
                                                      
                                                      
                                                         31
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Λ
                                                      
                                                      
                                                         32
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Λ
                                                      
                                                      
                                                         33
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 P
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ρ
                                                            
                                                            
                                                               Rw
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ρ
                                                            
                                                            
                                                               Rc
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ρ
                                                            
                                                            
                                                               Gw
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ρ
                                                            
                                                            
                                                               Gc
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ρ
                                                            
                                                            
                                                               Bw
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ρ
                                                            
                                                            
                                                               Bc
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 and
                                 
                                 ∇
                                 L
                                 =
                                 
                                    
                                       l
                                    
                                    
                                       a
                                    
                                 
                                 -
                                 
                                    
                                       Pl
                                    
                                    
                                       b
                                    
                                 
                                 .
                              
                           
                        The compensated, and the original images are noted by M and I. The image M is sent to the projector, which produces the desired appearance. The matrix 
                           
                              Λ
                           
                         captures the spectral responses of the projector for three-color channels. Like [16], to overtake the assumption considering 
                           
                              s
                              (
                              λ
                              )
                           
                         as Dirac, we consider a full matrix 
                           
                              Λ
                           
                        . Otherwise, the channels 
                           
                              R
                              ,
                              G
                           
                         and B are often correlated, hence, the use of a full matrix 
                           
                              Λ
                           
                         allows taking into consideration the correlation between them. The relationship between the current and the desired projection screen is given by the matrix P. In addition, the term 
                           
                              ∇
                              L
                           
                         represents the difference between the current and the target illuminant according to screens’ reflectance.

In the previous scenario, the compensation is done for images sensed by the human’s retina. However, in some applications, we need to preserve the appearance of an original image when it is sensed. For example, in a picture of sunset, the colors may not appear the same when it is displayed in some conditions. The image need to be invariant to the viewing condition and the display device used. This could be done by verifying the color constancy between the sensed image and the original image. The goal is to make it possible that under specific conditions (i.e. the colorful screen and the illumination 
                           
                              
                                 
                                    l
                                 
                                 
                                    a
                                 
                              
                           
                        ), the displayed image appears identical to its original image, as in Fig. 1(a). Therefore, we want the sensed image (A) to be similar by a viewer to the original image (I). Consequently, the equality between the two appearances could be done by modifying the original image under these conditions, before sending it to the projector. This could be done since a transformation 
                           
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                           
                         will be applied to the original image that takes into account transformations due to the display environment.

In the same manner as before, the transformation can be written as:
                           
                              (11)
                              
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       I
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             ck
                                          
                                       
                                    
                                 
                                 
                                    
                                       I
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       k
                                    
                                 
                                 .
                              
                           
                        For three-color channels, the compensation is given by
                           
                              (12)
                              
                                 
                                    
                                       M
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 Λ
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 I
                                 -
                                 
                                    
                                       Λ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       a
                                    
                                 
                                 .
                              
                           
                        
                     

The compensated, and the original images are noted by 
                           
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                           
                         and I. The matrix 
                           
                              Λ
                           
                         captures the spectral responses of the projector and the viewer for three-color channels. Similarly, a full matrix 
                           
                              Λ
                           
                         is considered to overcome the assumption taking 
                           
                              s
                              (
                              λ
                              )
                           
                         as Dirac. The matrix 
                           
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                           
                         allows to compensate the effects of the projection screen. We note that 
                           
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                           
                         will be equal to P if the desired screen is white. In addition, the surrounding light is given by the vector 
                           
                              
                                 
                                    l
                                 
                                 
                                    a
                                 
                              
                           
                        .

We notice that Eq. (12) compensates all effects due to the surrounding lights, the projection screen, the spectral response of the projector and the spectral response of the viewer. These two spectral responses are compensated by the same matrix 
                           
                              Λ
                           
                        .

Now, considering the models in Eqs. (10) and (12), one important issue concerns the identification of images that can be displayed and screens that can be used. We will derive the constraint from Eq. (10), the case of Eq. (12) is similar. Since the color image M, is encoded by 24 bits (8 bits per channel), then values of each color channel vary between zero and 255. The following two constraints must be fulfilled. If the compensated image contains values above the maximal brightness or below the black level of the projector, artifacts will occur. To overcome this limitation, the compensation image is controlled by the first constraint:
                           
                              (13)
                              
                                 
                                    
                                       Λ
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 PI
                                 ⩾
                                 ∇
                                 L
                                 ⩾
                                 
                                    
                                       Λ
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 (
                                 PI
                                 -
                                 255
                                 )
                                 .
                              
                           
                        The second constraint relies on the reflectance values of the target screen and the current screen, it gives the relationship between them, where (
                           
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                              >
                              0
                           
                        ):
                           
                              (14)
                              
                                 0
                                 ⩽
                                 
                                    
                                       ρ
                                    
                                    
                                       kw
                                    
                                 
                                 ⩽
                                 255
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             kc
                                          
                                       
                                    
                                    
                                       
                                          
                                             I
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Another important issue is the link between the derived transform and the von Kries transform. Let us recall that the von Kries based computational color constancy is a linear transformation, which depends on the scene illuminant (target) and the illuminant of the environment. Unlike von Kries, the linear transformation in Eq. (10) depends on both lights, projector, spectral sensitivity of human’s retina, and reflectances. Note that, von Kries model can be deduced from Eq. (8), if the ambient light is multiplicative (i.e., 
                           
                              
                                 
                                    l
                                 
                                 
                                    ak
                                 
                              
                           
                         and 
                           
                              
                                 
                                    l
                                 
                                 
                                    bk
                                 
                              
                           
                         are multiplied by 
                           
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                           
                         term). However, this is not true because it means that under a dark environment (i.e., 
                           
                              
                                 
                                    l
                                 
                                 
                                    ak
                                 
                              
                              =
                              0
                           
                         or 
                           
                              
                                 
                                    l
                                 
                                 
                                    bk
                                 
                              
                              =
                              0
                           
                        ) the displayed image is dark. It follows that von Kries transform is not suitable for the projector based display.

Let us now focus on the additive term in Eq. (10). This term is free from the image content. It describes the light variation according to the relationship between target and current screen reflectances, and also, the transmittance ratio of the projector. According to the image formation model presented in Eq. (4), it can be seen as the change of the environment light when some specific image is displayed. From the human perception side, a change of the surrounding lights causes changes in the smallest perceptible contrast (Stevens law), saturation [3], and hue (Bezold–Brücke law) of the perceived image. Therefore, both chromaticity and contrast of the perceived image change. The contrast enhancement when lights change has been studied [17–19]. In this work, based on the performed experiments presented in Section 5 we find that: (1) chromaticity is compensated by Eq. (10) or Eq. (12) depending on the target application; (2) the contrast adaptation is achieved by Eq. (18), which will be detailed later on; and (3) the saturation component of the original image should be maintained for the compensated image before performing the contrast adaptation.

Concerning the equation that guides the sensitivity of the HVS to the luminance changes and its impacts, we deal with the Weber law to derive this equation that increases the contrast. The local contrast of a single target depends on the surrounding luminance. It is given by the Weber fraction as [20]:
                           
                              (15)
                              
                                 C
                                 =
                                 
                                    
                                       Δ
                                       L
                                    
                                    
                                       L
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              Δ
                              L
                           
                         is increasing or decreasing in the target luminance from the surrounding luminance L. If the intensity of the ambient light increases, it could be possible that the contrast variation of the sensed image will not be perceptible. Adding the surrounding light to the displayed image, reduces the visual contrast of the image. Therefore, the lower the environmental lights are, the higher the contrast of the image will be. Thus, to achieve a visible contrast enhancement, higher luminance patterns need a higher contrast increase [17]. Different measures of contrast exist [17]. We propose the use of the Laplacian transformation, which has been used with some success for the X-ray image enhancement in [21]. We define the local contrast C of an image to be proportional to the local Laplacian 
                           
                              
                                 
                                    L
                                 
                                 
                                    T
                                 
                              
                           
                         of the luminance component y of the image M. In other words,
                           
                              (16)
                              
                                 C
                                 ∝
                                 
                                    
                                       L
                                    
                                    
                                       T
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       y
                                    
                                 
                                 )
                                 .
                              
                           
                        Eq. (16) indicates that to achieve the same perceived increase in contrast across an image, the values of the Laplacian transformation need to be stretched. In fact, according to Weber’s law, the stretching should be performed in such a manner that the contrast increasing is proportional to the surrounding luminance. Consequently, this can be done by stretching the Laplacian values of the resulted compensated images. It is given by the following equation [21]:
                           
                              (17)
                              
                                 
                                    
                                       Y
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       M
                                    
                                    
                                       y
                                    
                                 
                                 +
                                 
                                    
                                       aL
                                    
                                    
                                       T
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       y
                                    
                                 
                                 )
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    Y
                                 
                                 
                                    ′
                                 
                              
                           
                         represents the enhanced contrast result. Notice a is a constant of the model, its value is determined experimentally (
                           
                              a
                              =
                              0.2
                           
                        ). We observed that the contrast enhancement given by Eq. (17) is proportional to the Laplacian transformation of the image, which depends on the surrounding lights 
                           
                              Δ
                              L
                           
                        .

We noted that the compensation of the image is done in the RGB color space, except the contrast correction, which is performed by the luminance component of the YCbCr color space. The compensation has been tested with other color spaces, and it turns out that color spaces used are the ones giving a better colors.

The model parameters of each scenario are estimated in the same manner. n this section, we will present only the parameters estimated for the scenario 2 in Eq. (10).

Recovering parameters in Eq. (10) consists in finding the matrices 
                        
                           Λ
                        
                      and P. We noted that the matrix 
                        
                           Λ
                        
                      is valid for the entire image. However, it could also be estimated for different areas of the image such as: edges, lines, and textures. We will show how a global matrix can be estimated. It is estimated only once, and it is constant for every environment conditions. The matrix P is estimated for every pixel to compensate spatial distortion of color. We note that the method used for the parameters estimation is based on the environment simulation, and it relies on the human perception. The viewer uses its perceptual capabilities to decide when some displayed images under different conditions are similar. These displayed images are then acquired by an embedded camera and used to estimate the parameters as it will be discussed later. Consequently, a step of geometric calibration of the projector and the camera is necessary, for mapping projector pixels with their corresponding camera pixels. We propose the use of the presented method in [22], where the calibration is performed by exploiting the homography between the projected slide and the camera image. For accuracy, we aligned the projector and the camera to the projection screen (i.e. the optical axis of the projector and, the camera are perpendicular to the projection screen).

Primarily, we estimated the matrix 
                        
                           Λ
                        
                     . It can be estimated by a learning process. For this purpose, we were interested to compensate only the surrounding lights effects, when, we use a white planar screen (i.e., 
                        
                           
                              
                                 ρ
                              
                              
                                 kc
                              
                           
                           =
                           
                              
                                 ρ
                              
                              
                                 kw
                              
                           
                           =
                           1
                        
                      and P is the identity). The case when two reflectances are not equal is presented later. Therefore, Eq. (10) becomes:
                        
                           (18)
                           
                              M
                              =
                              I
                              -
                              Λ
                              (
                              
                                 
                                    l
                                 
                                 
                                    a
                                 
                              
                              -
                              
                                 
                                    l
                                 
                                 
                                    b
                                 
                              
                              )
                              .
                           
                        
                     According to Eq. (18), for estimating the matrix 
                        
                           Λ
                        
                     , three images are required. Two images corresponding to the two surrounding lights, are obtained by capturing the projection screen under the lights noted 
                        
                           
                              
                                 l
                              
                              
                                 a
                              
                           
                        
                      and 
                        
                           
                              
                                 l
                              
                              
                                 b
                              
                           
                        
                     . The third image corresponds to the compensated image M, which is displayed under the light 
                        
                           
                              
                                 l
                              
                              
                                 a
                              
                           
                        
                     , and it appears to be similar to the original image I displayed under the light 
                        
                           
                              
                                 l
                              
                              
                                 b
                              
                           
                        
                     . This image is constructed by using a coloring graphical user interface, a similar protocol is used in [23]. An original image is displayed by the projector under the light 
                        
                           
                              
                                 l
                              
                              
                                 b
                              
                           
                        
                      and its appearance which represents a target appearance, is captured by the camera. Then, under the light 
                        
                           
                              
                                 l
                              
                              
                                 a
                              
                           
                        
                     , the same original image is displayed by the projector, their colors are modified until getting the target appearance. The obtained appearance is captured by the camera. For accuracy, the two appearances obtained under 
                        
                           
                              
                                 l
                              
                              
                                 a
                              
                           
                        
                      and 
                        
                           
                              
                                 l
                              
                              
                                 b
                              
                           
                        
                      are captured by the camera and similarity between the two images is verified using image color similarity metrics (e.g., S_CIELAB). Indeed, the modified image that produces the desired appearance represents the image M, which will be used in the estimation of the matrix 
                        
                           Λ
                        
                     . Note that S_CIELAB is a standard metric widely used for color measuring [24].

Therefore, once three images are acquired, the matrix 
                        
                           Λ
                        
                      is obtained from Eq. (18) as:
                        
                           (19)
                           
                              
                                 
                                    
                                       
                                          I
                                          -
                                          M
                                          =
                                          Λ
                                          (
                                          
                                             
                                                l
                                             
                                             
                                                a
                                             
                                          
                                          -
                                          
                                             
                                                l
                                             
                                             
                                                b
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          F
                                          =
                                          Λ
                                          V
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where
                        
                           
                              F
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      1
                                                      R
                                                   
                                                
                                                -
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      1
                                                      R
                                                   
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      nR
                                                   
                                                
                                                -
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      nR
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      1
                                                      G
                                                   
                                                
                                                -
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      1
                                                      G
                                                   
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      nG
                                                   
                                                
                                                -
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      nG
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      1
                                                      B
                                                   
                                                
                                                -
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      1
                                                      B
                                                   
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      nB
                                                   
                                                
                                                -
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      nB
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                              
                              V
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      a
                                                      1
                                                      R
                                                   
                                                
                                                -
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      b
                                                      1
                                                      R
                                                   
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      anR
                                                   
                                                
                                                -
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      bnR
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      a
                                                      1
                                                      G
                                                   
                                                
                                                -
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      b
                                                      1
                                                      G
                                                   
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      anG
                                                   
                                                
                                                -
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      bnG
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      a
                                                      1
                                                      B
                                                   
                                                
                                                -
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      b
                                                      1
                                                      B
                                                   
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      anB
                                                   
                                                
                                                -
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      bnB
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     Then, the matrix 
                        
                           Λ
                        
                      is estimated using the Moore–Penrose pseudo-inverse technique [25] as:
                        
                           (20)
                           
                              
                                 
                                    Λ
                                 
                                 
                                    ̃
                                 
                              
                              =
                              (
                              
                                 
                                    FV
                                 
                                 
                                    T
                                 
                              
                              )
                              
                                 
                                    (
                                    
                                       
                                          VV
                                       
                                       
                                          T
                                       
                                    
                                    )
                                 
                                 
                                    -
                                    1
                                 
                              
                              .
                           
                        
                     
                  

Now, we will deal with the case of two screens which have a different reflectance. To simplify the estimation of the matrix P, we chose a fully dark environment to avoid the compensation of the surrounding lights. However, the matrix P can also be estimated with a bright environment. At no light, Eq. (12) will be written as follows:
                        
                           (21)
                           
                              M
                              =
                              PI
                              ,
                           
                        
                     
                  


                     M and I represent the images acquired by the camera with the white and the colored projection screen. We noticed that Eq. (21) can be written as:
                        
                           (22)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      G
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      B
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      G
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      B
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     Consequently, for every point of the projection screen, its matrix P is given as:
                        
                           (23)
                           
                              P
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            G
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            G
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  

Due to the ratio between the target and the used screen reflectance expressed by the matrix P in Eq. (10), the compensation of an image depends on the analysis of the screen used and the image content that will be compensated.

@&#EXPERIMENTAL RESULTS@&#

In this section we will focus on scenario 2. However, the interested reader can find all the scores related to scenario 1 in [26].

We present the informal user study carried out to validate the increasing of the perceived visual improvement that can be gained by the proposed method. We have made four psychophysical experiments, which have been evaluated by seventeen human subjects (three females and fourteen males). All subjects had a normal vision. They had to pass the test of Ishihara color deficiency [27]. Furthermore, before the beginning of each experiment, the subjects were fully adapted to the environmental conditions (illumination or darkness). For bright and dark surroundings, the human eyes adapted since the subjects waited for three and over 20min respectively [28].

The first experiment focuses on measuring the appreciation of the subjects on the obtained images of the surrounding lights compensation compared to the uncompensated one. The second experiment concerns the compensation of the projection screen, in which we measured the similarity between the appearance of the compensated image displayed onto a colorful screen and the appearance of the original image displayed onto a white screen. By the third experiment, we were interested to control the appearance of the displayed image according the screen used. When an image is displayed onto a colorful screen noted screen 1, its appearance perceived by the viewer is modulated by the color and the texture of the screen. Using another screen noted screen 2, we looked to acquire the same appearance obtained by using the screen 1. This could be done by projecting a compensated image onto screen 2. The similarity between these appearances is measured through this experiment. Finally, in the last experiment, we examine the validity of the proposed model by measuring the appreciation of the subjects on the provided images of our method for the compensation of both projection screen and surrounding lights.

We noted that the first and the fourth experiments were performed in an illuminated room unlike the second and the third ones which were performed in a dark room because they focused mainly on the projection screen. For the illuminated room, the surrounding lights are a mixture of fluorescent lamps of the room and the sunlight coming through the windows. The intensity of the light fell on the projection screen was measured in the center of the screen. This was done before starting each experiment using an INS Digital Illumination meter DX-200. The first experiment was performed in bright conditions where the measured intensity of the surrounding light was 650 Lux. For the fourth experiment, the measured intensity varied according to the tested images as it will be explained later, it was between 92.7 Lux and 330 Lux. However, except the work [29], which performed experiments under an intensity of 13.4 Lux, the other works [5,7–10,13] do not indicate it.

In order to quantify the obtained results, the RMS and the S_CIELAB metrics of the digital values were calculated. The RMS error is widely used for the image quality assessment and it was shown that it is close to the well known SSIM criterion [30]. For this reason, we found that the use of a prevalent criterion as 
                        
                           Δ
                           
                              
                                 E
                              
                              
                                 ab
                              
                              
                                 ∗
                              
                           
                        
                      that was used in [13], is recommended to the perceptible color difference. In our work, we chose the S_CIELAB metric, it is a spatial extension of the CIELAB color metric that is useful for measuring color reproduction errors of digital images [31]. Since the evaluation methodologies were specifically different for all experiments, we will explain separately the methodology adopted for each experiment.

For the experimental setup, two DLP projectors (Nec NP40) and the camera Nikon D40 were used. In the second and third experiment, the two projectors were juxtaposed at the same horizontal level, one on the left and the other on the right. We noted that the projectors should be colorimetrically calibrated. A commercial projection screen was used as an approximate of the perfect diffused white screen. Several colorful posters were also used for the test screens, three of them are illustrated by Fig. 2
                     . The proposed method was tested with a set of different static camera images, some of them are shown in the figures below. Keep in mind that examples illustrated in this section, the compensation results are shown as camera photographs of the compensated images projected onto the individual screens in the illuminated or the dark room. Therefore, differences between the original images and the capture of the compensated images can be attributed to the intrinsic and extrinsic parameters of the camera (response, resolution, angle, distance, and so on), the surrounding illumination under which the figures are seen by the reader, the printer, the screen or other devices used in the visualization.

It should be noted that in a dark environment (i.e. the second and third experiments), the images are compensated by Eq. (10). However, in bright environments (i.e. the first and fourth experiments), the images are compensated by Eqs. (10) and (17) as it is explained before.

Let us now focus on the first experiment. Our objective through this experiment is to evaluate the validity of the proposed model by compensating the sunlight effects on the quality of perceived images. More specifically, this experiment examines whether the visual impression of the compensated images which are displayed under sunlight is better than the original images displayed under the same light. It should be noted that we used a white screen because we are interested in the surrounding light compensation.

For the experimental protocol, it can be summarized as follow. Subjects are asked to rank each of the perceived images (i.e., compensated and uncompensated) using a scale ranging from one to five, which represent a very bad and a very good image quality. The images are displayed consecutively and randomly onto a flat white screen, the subjects did not know if it was the original or the compensated image which was projected. Next, for every displayed image, the subject could only see it for a few seconds (10–15s). After, he/she gave the evaluation ranking.


                     Fig. 3
                      illustrates a projection of the original images (Fig. 3a) under bright surrounding light. The uncompensated projections (Fig. 3b) mean that the surrounding lights have adversely influenced the appearances of the perceived images, where the colors are faded and saturated, and the brightness and the contrast are attenuated. Consequently, the obtained ranking by subjects was 1/5 for all images. In (Fig. 3c), the obtained images by our method of the surrounding light compensation are shown. These images were displayed in such condition, and the perceived images by the viewer are given in (Fig. 3d). Their brightness was increased and the visual contrast was enhanced according to the surroundings. Therefore, the images were more appreciated by the subjects, since the given ranking were 3.85/5, 4.02/5, 3.70 and 4.10/5 for the four images.

The RMS and S_CIELAB errors were calculated for both: (original image, uncompensated image) and (original image, the compensated appearance) as listed in Table 2
                     . As seen from the quantities, the errors (RMS and S_CIELAB) of the digital values for the uncompensated images are larger, when the appearances are distorted by the surrounding light. However, these quantities are reduced for the compensated images, which means that the proposed framework was resistant to the effects of the surrounding light. Consequently, the compensated images were better perceived, which means that our method improved the quality of the displayed images.

In the second experiment, we were interested to measure the validity of the proposed method for compensating the effects of the projection screen reflectance on the quality of the perceived image. The experimental protocol of this experiment consists to evaluate whether the visual impression of the compensated images displayed onto a colorful screen is kept at the same as the original images displayed onto a white screen. The subjects were asked to rank the similarity between the two appearances using a scale ranging from one to five, where five and one represent high and low similarity respectively. The first projector displayed the original image onto a flat white screen on the left side, and the other projector displayed the compensated image onto the colorful screen on the right side. Next, the displayed images were seen by the subject for a few seconds (10–15s). After that, he/she judged the similarity between the appearances of both images.

For illustration purpose, four images were tested with three screens. Figs. 4–7
                     
                     
                     
                      show the obtained results for the second experiment. Their corresponding metrics calculation are cited in Tables 4–6 for screens “patches”, “butterfly”, and “flowers” respectively. Moreover, the subjects’ scores of the similarity are given by Table 3
                     .


                     Fig. 4 demonstrates an example of a projection (Fig. 4d) onto the “patches” screen (Fig. 2a). An uncompensated projection (Fig. 4b) indicates that the perceived appearance is modulated by the colorful patches, and it is clear that this appearance looks different from the original one. In (Fig. 4c), the result image of the compensation of the “patches” screen is shown. This compensated image is considered to be displayed onto the “patches” screen to eliminate its effect, which allows to preserve the appearance of the original image. Therefore, the projection of the compensated image produces an appearance (Fig. 4d) similar to the desired image (Fig. 4a). For the scores of the similarity ranking, viewers gave 3.97/5 for the projection (Fig. 4d).


                     Figs. 5–7 illustrate other examples of projection onto the concerned screens. The projections (Figs. 5b, 6b, and 7b) represent the displaying of the images (Figs. 5a, 6a, and 7a) onto the “flowers”, “butterfly”, and “patches” screens. The underlying surfaces were clearly visible for the uncompensated images as in (Figs. 5b, 6b, and 7b) for three images. Consequently, and due to the appearance modulation by the texture of the screen, the display of the uncompensated image was far from being similar to the desired appearance. In (Figs. 5c, 6c, and 7c), we show the obtained images by our method of the screen reflectance compensation for these images before using the projector. However, the display of the compensated images (Figs. 5c, 6c, and 7c) onto the corresponding screens, allows to conceal the screen effect as illustrated by the images (Figs. 5d, 6d, and 7d). Hence for the similarity ranking, the scores given by subjects were 2.94, 3.20/5 and 4.01/5 for (Figs. 5d, 6d, and 7d) as it is shown in Table 3.

In order to quantitatively evaluate these results, Tables 4–6
                     
                     
                      show the obtained quantities (RMS and S_CIELAB), that were calculated for both: (the original image, the uncompensated appearance), and (the original image, the compensated appearance). The RMS values for the uncompensated images are larger. Therefore, the perceptible color differences (S_CIELAB) were significant. However, applying our framework, both RMS and S_CIELAB values are decreased significantly. The compensation for the color surface was appreciated since their RMS and S_CIELAB values were small. The obtained images corresponding to the compensation of the “patches” and “butterfly” surfaces were more similar to the desired images than the same images projected on “flower” surfaces, where they were more appreciated by the subjects. Hence, a caution inspection of the resulted images was done. We found that the differences were mainly contributed by the sharp edges mostly contained in the image. In other words, when the screen has remarkable edges, even by projecting the compensated images, these edges could be easily detected by the viewer since the human eyes are more sensitive to variations and discontinuities. However, all depends on the image content. For example, the edges are less noticeable for no bright gray image (Fig. 7j), otherwise other images like (Fig. 5j).

The results of our study show that our method increases the quality of the compensated projection compared to the uncompensated projection. It depends particularly on the screen used. An image can be perfectly compensated, when the projection of its compensation produces an appearance meticulously similar to the desired one, as shown by the images displayed onto the “patches” and “butterfly” screens. However, the same images can be compensated in the manner that its projection contains some mismatches, as illustrated previously for the “flowers” screen. Consequently, the smoothed reflectance screens are better compensated than screens with remarkable edges.

For the third experiment, we focus on using our method in simulating projection screens. The idea consists to cover-up the screen used. In other words, we are interested to eliminate the effect of the screen used by creating other effects which are supposed to be created by a target screen. Therefore, the experimental protocol of this experiment consists to evaluate whether the visual impression of the compensated images displayed onto a colorful used screen is kept the same as the original images displayed onto a colorful target screen. The subjects were asked to rank the similarity between the two appearances using again scale ranging from one to five. The first projector displayed the original image onto the target screen on the left side, and the other projector displayed the compensated image onto the screen used on the right side. Next, the displayed images were seen by the subject for few seconds (10–15s). After that, he/she judged the similarity between both images appearance.


                     Fig. 8
                      illustrates an example of “flowers” screen simulation by using a “patches” screen. The projection (Fig. 8b) is considered as the desired appearance which represents the display of the original image (Fig. 8a) onto the target “flowers” screen. The projection (Fig. 8c) represents the display of the original image onto the used “patches” screen. However, projecting the compensated image (Fig. 8d) onto the screen used, allows to simulate the effect of the target screen as illustrated by the images (Fig. 8e), which is similar to the desired image. For the similarity ranking, subjects gave 4.23/5. Fig. 8 illustrates another example of “butterfly” screen simulation by using “patches” screen as explained before for Fig. 8. The similarity score given by subjects is 3.98/5.

The obtained results are very convincing, therefore, they are promising. The measured metrics are illustrated by Table 7
                     .

The fourth experiment investigates the validity of the compensation of the surrounding light and the projection screen. The experiment examines whether in illuminated rooms, the compensation of the surrounding lights and the projection screen are more convincing for the viewer. The protocol adopted for this experiment is the following: the projection screen and the original image were shown to the viewer. Next, the image was displayed onto a screen to illustrate the effect of the light and the screen on the appearance of the image. Afterwards, we projected the compensated image under such conditions. Then, the subject was asked to determine if there was an improvement of the appearance of the projected image, and at which level the compensated image reduces the contextual factors. The subject was asked to rank the appreciation of this improvement using a scale ranging from one to five (see Fig. 9
                     ).


                     Fig. 10
                      demonstrates the examples obtained by our framework, where the surrounding light and the projection screen are compensated. In an illuminated room, the images (Fig. 10a and e) were projected onto the “patches” screen. Their projections are shown in (Fig. 10b and f). Obviously, they are modulated by the color and the texture of the screen used, and their brightness and visual contrast are attenuated by the surrounding light. Consequently, the underlying surfaces became more noticeable with the contrast enhancement according to the surrounding, our algorithm produces a brighter image with enhanced contrast, and a reduced screen effect compared to the uncompensated projections. The subjects judged that the projected compensations were more appreciated than the uncompensated ones, and they gave 3.76, 3.51/5 for the ranking of the two images. The two images were tested under two different intensities, the intensity of the surrounding lights were 195 and 92.7 Lux for the (Fig. 10a and e). Theses intensities are enough for such images; the bright image (Fig. 10a and e) and the gray image (Fig. 10e). The reason is that when the surrounding light are high, the compensation of the surrounding light is done by increasing the brightness and the contrast of the image. However, the obtained bright image will be sensitive to the screen color, as it was verified by our experiments.


                     Fig. 11
                      illustrates other examples obtained by our framework, where the surrounding light and the projection screen are compensated. In an illuminated room and under an intensity of 330 Lux, the images (Fig. 11a and e) were projected onto the “butterfly” and “flowers” screens. Their projections are shown in (Fig. 11b and f). It is clear that their appearances are modulated by the color and the texture of the screen used, especially when the underlying screens were more visible under such surrounding lights. The compensated images given in (Fig. 11c and g) were displayed under such conditions, and the result is illustrated by (Fig. 11d and h) for the two images. We notice that these images become brighter with enhanced contrast, the effect due to the screen is greatly reduced compared to the uncompensated projections. The subjects judged that the projected compensations were more appreciated than the uncompensated ones, and they gave 3.44, 3.27/5 for the ranking of the two images. It should also be noted that the surrounding lights reflected from the surrounding objects toward the subjects’ eyes can influence their ranking.

While analyzing the obtained scores, we found that the screens used do not entirely diffuse surfaces (since they are printed papers, some areas have a specular reflection due to the ink of the printer). This influenced the appearance of the displayed images. Therefore, it influenced the viewer ranking. The captured images in (Fig. 11d and h) show some effects caused by the natural specular reflection of the screen. We verified that these appearances change according to the view angles.

Most of the scores are satisfactory, and it is obvious that the compensated images displayed under such conditions (illuminated rooms and patterned screen) are better perceived than the uncompensated images seen in the same conditions. This is confirmed by Table 8
                     , which shows the quantities obtained after RMS and S_CIELAB computing.

@&#CONCLUSION@&#

In this paper, we have formulated the problem of the color correction for images displayed by a projector on a non-white screen and under bright conditions. This has been addressed using the model of the sensed image and extending the von Kries color constancy concept. Guided by the potential applications, we propose two scenarios. In the first, we make the sensed image invariant to the viewing conditions and the display device used. For the second scenario, the target illuminant and the illuminant of the display environment, and similarly, the target and the screen used, were introduced into the model to simulate others environments effects for some applications. By using this image model and the color constancy requirement between sensed images, we deduce a linear transform that allows to compensate the surrounding light by a single matrix multiplication. Furthermore, the compensation of the reflectance of the screen is expressed by a ratio of the target and the current screen reflectance. Through validation studies, we show that our method reduces the surrounding lights affecting the quality of sensed images. Therefore, the visual impression is kept. Moreover, our method compensates even the color of the projection screens. As a result, the viewers get a great visual impression as if the image is projected onto a white screen. In addition, we have conceived a simple technique to estimate how much the perceived contrast is altered. A straightforward function is then used to adjust the contrast of images based on the surrounding lights. This produces the correct perception of contrast. Furthermore, we have shown that the second method can be used to cover-up the screen effects as well as simulate other screen effects. This work can be extended by taking into account the view angle and the no-flat screens.

@&#REFERENCES@&#

