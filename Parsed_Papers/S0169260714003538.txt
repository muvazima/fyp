@&#MAIN-TITLE@&#FDTD-based Transcranial Magnetic Stimulation model applied to specific neurodegenerative disorders

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Magnetic propagation in Transcranial Magnetic Stimulation (TMS) for neurodegenerative diseases is modelled by FDTD.


                        
                        
                           
                           A computing tool for the current underdeveloped TMS dosimetry in its emerging clinical application to AD and PD is presented.


                        
                        
                           
                           A realistic high-resolution three-dimensional human head mesh is used.


                        
                        
                           
                           Two realistic magnetic source models are employed: a circular and a figure-8 coil.


                        
                        
                           
                           Results show the electrical field distribution when magnetic stimulation is supplied to those brain areas of specific interest for each particular disease.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

FDTD

Transcranial Magnetic Stimulation

Circular coil

Figure-8 coil

Alzheimer disease

Parkinson disease

@&#ABSTRACT@&#


               
               
                  Non-invasive treatment of neurodegenerative diseases is particularly challenging in Western countries, where the population age is increasing. In this work, magnetic propagation in human head is modelled by Finite-Difference Time-Domain (FDTD) method, taking into account specific characteristics of Transcranial Magnetic Stimulation (TMS) in neurodegenerative diseases. It uses a realistic high-resolution three-dimensional human head mesh. The numerical method is applied to the analysis of magnetic radiation distribution in the brain using two realistic magnetic source models: a circular coil and a figure-8 coil commonly employed in TMS. The complete model was applied to the study of magnetic stimulation in Alzheimer and Parkinson Diseases (AD, PD). The results show the electrical field distribution when magnetic stimulation is supplied to those brain areas of specific interest for each particular disease. Thereby the current approach entails a high potential for the establishment of the current underdeveloped TMS dosimetry in its emerging application to AD and PD.
               
            

@&#INTRODUCTION@&#

The study of neurodegenerative processes and the development of techniques for their treatment are nowadays an area of great relevance. This is due to their enormous impact, not only from a medical point of view, but also due to their intrinsic social and economic aspects. The increasing trend of global ageing has intensified the need to find effective solutions to diseases strongly related to ageing, such as Alzheimer (AD) or Parkinson (PD) diseases [1]. Emerging therapeutics for these disorders include those that employ energy sources of different nature (electrical, magnetical, optical) to stimulate specific functional brain regions that have been altered during the neurodegeneration process [2]. Among them, Transcranial Magnetic Stimulation (TMS) is one of the most explored due to its capacity for the neuromodulation of specific neural networks with therapeutic purposes and the subsequent promising results obtained in several clinical trials with AD and PD patients [3,4]. In the last years a growing number of studies have showed promising effects of TMS over an increasing number of pathologies. The clinical trials database by the U.S. National Institute of Health (NIH) shows a significant number of studies (both finished and currently recruiting participants) related to TMS, which is a clear indicator of the potential offered by this non-invasive treatment technique. These studies include neurodegenerative diseases which have nowadays no cure. However, despite its high potential for its future clinical implantation, some controversies related to the proper TMS dosimetry remain unsolved due to the lack of reproducibility in certain clinical trials, the complexity of neuronal activity, the great amount of factors that can affect the response to the magnetic stimulation and the lack of multi-centre trials with a larger number of patients [5]. The development of predictive models constitutes a valuable tool to establish the adequate dosimetric parameters to get a certain therapeutic benefit or to design and analyze scientific studies based on TMS experiments with both diagnostic and research purposes [6]. This requires an accurate computation of the induced electrical field within the brain as well as the dielectric properties of the brain tissues [7]. Early studies in this area were mostly based on spherical models [8], whereas the most recent ones employ a high-resolution model of human head and numerical methods such as the finite element method (FEM) [9,10]. These last ones have allowed a precise calculus of the field induced by common TMS coils in the human head. However the previous studies, such as one of the same authors [11], have not been focused on the electrical field induced by coils precisely positioned over functional brain regions that have been identified as pinpoint targets to treat the main symptoms associated with neurodegenerative diseases. Up to now coil positioning to deal with a specific disorder was taken into account only for depression using an impedance method [12].

We present a Finite-Difference Time-Domain (FDTD)-based TMS model, which is applied to specific dysfunctions associated with AD and PD in order to predict the electromagnetic propagation in a realistic model of adult human head. A specific FDTD method is used for modelling low-frequency magnetic propagation in a brain undergoing TMS with single and double stimulation coils positioned over functional areas of interest for both types of disorder. The results enable to observe the main characteristics of each type of stimulation. The analysis performed in this work constitutes the first approach towards the development of comprehensive predictive models that could enable to determine the magnetic radiation distribution in the brain, in order to appropriately control radiation parameters for enhancing and optimizing the stimulation process.

Section 2 describes the theoretical foundation underlying the FDTD-based TMS model, which includes a brief review of the well-known FDTD method, as well as the implementation and positioning of two types of coils commonly used in the ongoing clinical trials involving neurodegenerative diseases. In Section 3 the model previously described is particularized for magnetic propagation during TMS in AD and PD. Results in Section 4 show the electric field induced in the brain regions of interest for both diseases using a single and a double coil with variable orientation. Finally, the main conclusions are presented in Section 5.

This section describes the theoretical foundation underlying the FDTD-based TMS model which includes a brief review of the FDTD method as well as the implementation and positioning of two types of coils commonly used in the ongoing clinical trials involving neurodegenerative diseases.

The FDTD method is a widely used approach for numerically solving electromagnetic propagation through different types of media. FDTD method exhibits very high accuracy and versatility, which makes it an essential tool for electromagnetic studies in many applications. In particular, it has been demonstrated that FDTD is a robust and efficient computational method for the calculation of magnetic propagation in biological tissues [13,14]. One example of its wide application is in [14], where FDTD was used to investigate the cerebral fields induced in a head model undergoing a different brain stimulation technique, electrical stimulation (Transcranial alternating current stimulation (tACs)). tAC directly applies current by stimulating electrodes, on the contrary of magnetic stimulation, which is applied by means of the magnetic coils employed in TMS to induce the desired cortical currents. Although at neuron level TMS excites the neurons with the same mechanism as electrical stimulation, the former is non-invasive. Previous works show that FDTD is a robust and efficient computational method for the calculation of magnetic propagation in biological tissues. However, as it is explained later in Section 3, devoted to the model application, its use for the study of magnetic propagation in human head for brain stimulation at low frequencies greatly increases the computational load. In this case, the computation problem can be solved by a frequency scaling method. In this section we present a concise description of the FDTD method, introducing the essential concepts and including all the fundamental equations involved in the process except the source model, which will be discussed in the next two subsections.

FDTD method constitutes a direct implementation of Maxwell's equations in the time domain. This approach for solving Maxwell's equations may present limitations in terms of accuracy. Although these limitations can be overcome by means of adequately choosing the grid parameters and the temporal step [15]. In the present work, the spatial grid was chosen so as to cope with stability conditions, taking into account the geometry of the problem and the wavelength of the electromagnetic radiation. Therefore firstly a spatial discretization is performed using a rectangular mesh of (N
                        
                           x
                        , N
                        
                           y
                        , N
                        
                           z
                        ) cubes with a constant cell size characterized by the edge length Δ
                        
                           ijk
                        . Numerical stability conditions impose a minimum number of 20 cells per wavelength. As a consequence, the approach is valid under the stability conditions point of view. The basic element of the spatial mesh is given by the Yee lattice, in which the electromagnetic field vectors involved in the FDTD method have been depicted.

Along with spatial discretization by a rectangular mesh, time is also discretized with a temporal step Δt. Stability conditions impose a maximum time step defined by Eq. (1), where c
                        max is the highest electromagnetic wave propagation speed in the medium.
                           
                              (1)
                              
                                 
                                    
                                       Δ
                                    
                                    t
                                    ≤
                                    
                                       1
                                       
                                          
                                             c
                                             
                                                max
                                             
                                          
                                          
                                             
                                                3
                                                /
                                                
                                                   Δ
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

From Maxwell's equations, and adapting partial derivatives to the spatial and temporal discretization described above, the equations for calculating the electric and magnetic fields for each position and time instant are obtained [13]. In particular, the magnetic field components H
                        
                           x
                        , H
                        
                           y
                         and H
                        
                           z
                         (defined in the face centre of each cube, whose cell identifier is denoted by the subscript) are obtained for the intervals between two consecutive time instants (denoted by the superscript) by the Eqs. (2)–(4), where the coefficients 
                           
                              
                                 H
                                 1
                                 x
                              
                           
                         and 
                           
                              
                                 H
                                 2
                                 x
                              
                           
                         are respectively given by Eqs. (5) and (6).
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                   x
                                                
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       
                                          n
                                          +
                                          1
                                          /
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                   1
                                                   x
                                                
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                   x
                                                
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       
                                          n
                                          −
                                          1
                                          /
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                   2
                                                   x
                                                
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         E
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                                +
                                                1
                                             
                                             n
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         E
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                             n
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         E
                                                         z
                                                      
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                             n
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         E
                                                         z
                                                      
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                +
                                                1
                                                ,
                                                k
                                             
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                   y
                                                
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       
                                          n
                                          +
                                          1
                                          /
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                   1
                                                   y
                                                
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                   y
                                                
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       
                                          n
                                          −
                                          1
                                          /
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                   2
                                                   y
                                                
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         E
                                                         z
                                                      
                                                   
                                                
                                             
                                             
                                                i
                                                +
                                                1
                                                ,
                                                j
                                                ,
                                                k
                                             
                                             n
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         E
                                                         z
                                                      
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                             n
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         E
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                             n
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         E
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                                +
                                                1
                                             
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                   z
                                                
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       
                                          n
                                          +
                                          1
                                          /
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                   1
                                                   z
                                                
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                   z
                                                
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       
                                          n
                                          −
                                          1
                                          /
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                   2
                                                   z
                                                
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         E
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                +
                                                1
                                                ,
                                                k
                                             
                                             n
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         E
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                             n
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         E
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                             n
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         E
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                i
                                                +
                                                1
                                                ,
                                                j
                                                ,
                                                k
                                             
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                   1
                                                   x
                                                
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          1
                                          −
                                          
                                             ρ
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                             x
                                          
                                          
                                             Δ
                                          
                                          t
                                          
                                             
                                                (
                                                2
                                                
                                                   μ
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                   x
                                                
                                                )
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          1
                                          +
                                          
                                             ρ
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                             x
                                          
                                          
                                             Δ
                                          
                                          t
                                          
                                             
                                                (
                                                2
                                                
                                                   μ
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                   x
                                                
                                                )
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                   2
                                                   x
                                                
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             Δ
                                          
                                          t
                                          
                                             
                                                (
                                                
                                                   Δ
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                
                                                   μ
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                   x
                                                
                                                )
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          1
                                          +
                                          
                                             ρ
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                             x
                                          
                                          
                                             Δ
                                          
                                          t
                                          
                                             
                                                (
                                                2
                                                
                                                   μ
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                   x
                                                
                                                )
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The remaining coefficients (
                           
                              
                                 H
                                 1
                                 y
                              
                           
                        , 
                           
                              
                                 H
                                 2
                                 y
                              
                           
                        , 
                           
                              
                                 H
                                 1
                                 z
                              
                           
                         and 
                           
                              
                                 H
                                 2
                                 z
                              
                           
                        ) are analogously defined. Magnetic permeability μ and magnetic losses ρ are defined in the cube nodes. If the medium is inhomogeneous, it is necessary to obtain the effective properties in order to ensure the continuity of the tangent field components. Therefore, the effective magnetic permeability and magnetic losses for the calculation of the field components along the x direction are calculated by Eqs. (7) and (8) respectively.
                           
                              (7)
                              
                                 
                                    
                                       μ
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       x
                                    
                                    =
                                    
                                       
                                          
                                             μ
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          +
                                          
                                             μ
                                             
                                                i
                                                ,
                                                j
                                                +
                                                1
                                                ,
                                                k
                                             
                                          
                                          +
                                          
                                             μ
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                                +
                                                1
                                             
                                          
                                          +
                                          
                                             μ
                                             
                                                i
                                                ,
                                                j
                                                +
                                                1
                                                ,
                                                k
                                                +
                                                1
                                             
                                          
                                       
                                       4
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       ρ
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       x
                                    
                                    =
                                    
                                       
                                          
                                             ρ
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          +
                                          
                                             ρ
                                             
                                                i
                                                ,
                                                j
                                                +
                                                1
                                                ,
                                                k
                                             
                                          
                                          +
                                          
                                             ρ
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                                +
                                                1
                                             
                                          
                                          +
                                          
                                             ρ
                                             
                                                i
                                                ,
                                                j
                                                +
                                                1
                                                ,
                                                k
                                                +
                                                1
                                             
                                          
                                       
                                       4
                                    
                                 
                              
                           
                        
                     

The equations for the remaining directions, and those for the electric field, can be obtained in the same way [13].

Finally, it is necessary to fix the Absorbing Boundary Conditions (ABCs) in order to avoid reflections and calculation errors in the edges of the spatial mesh. There are several methods widely used for this purpose [15]. In this work, we have used Mur's ABCs improved by the superabsorption method [16]. The first order Mur's ABCs are given for the electric field. Specifically, in the particular case of the ABCs for the z component of the electric field in the xy plane, the conditions imposed by the first-order Mur's ABCs are those expressed in Eq. (9) which are implemented in the FDTD method as in Eq. (10).
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            
                                                               E
                                                               z
                                                            
                                                         
                                                         
                                                            ∂
                                                            t
                                                         
                                                      
                                                      −
                                                      
                                                         c
                                                         0
                                                      
                                                      
                                                         
                                                            ∂
                                                            
                                                               E
                                                               z
                                                            
                                                         
                                                         
                                                            ∂
                                                            x
                                                         
                                                      
                                                      =
                                                      0
                                                      ,
                                                       
                                                      z
                                                      =
                                                      
                                                         z
                                                         
                                                            min
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            
                                                               E
                                                               z
                                                            
                                                         
                                                         
                                                            ∂
                                                            t
                                                         
                                                      
                                                      +
                                                      
                                                         c
                                                         0
                                                      
                                                      
                                                         
                                                            ∂
                                                            
                                                               E
                                                               z
                                                            
                                                         
                                                         
                                                            ∂
                                                            x
                                                         
                                                      
                                                      =
                                                      0
                                                      ,
                                                       
                                                      z
                                                      =
                                                      
                                                         z
                                                         
                                                            max
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         E
                                                         
                                                            z
                                                            1
                                                            ,
                                                            j
                                                            ,
                                                            k
                                                         
                                                         
                                                            n
                                                            +
                                                            1
                                                         
                                                      
                                                      =
                                                      
                                                         E
                                                         
                                                            z
                                                            2
                                                            ,
                                                            j
                                                            ,
                                                            k
                                                         
                                                         n
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               c
                                                               0
                                                            
                                                            
                                                               Δ
                                                            
                                                            t
                                                            −
                                                            
                                                               Δ
                                                               
                                                                  i
                                                                  j
                                                                  k
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               c
                                                               0
                                                            
                                                            
                                                               Δ
                                                            
                                                            t
                                                            +
                                                            
                                                               Δ
                                                               
                                                                  i
                                                                  j
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         E
                                                         
                                                            z
                                                            2
                                                            ,
                                                            j
                                                            ,
                                                            k
                                                         
                                                         
                                                            n
                                                            +
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         E
                                                         
                                                            z
                                                            1
                                                            ,
                                                            j
                                                            ,
                                                            k
                                                         
                                                         n
                                                      
                                                      )
                                                      ,
                                                       
                                                      j
                                                      =
                                                      1
                                                      :
                                                      
                                                         N
                                                         y
                                                      
                                                      +
                                                      1
                                                      ,
                                                         
                                                      k
                                                      =
                                                      1
                                                      :
                                                      
                                                         N
                                                         z
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         E
                                                         
                                                            z
                                                            
                                                               N
                                                               x
                                                            
                                                            +
                                                            1
                                                            ,
                                                            j
                                                            ,
                                                            k
                                                         
                                                         
                                                            n
                                                            +
                                                            1
                                                         
                                                      
                                                      =
                                                      
                                                         E
                                                         
                                                            z
                                                            
                                                               N
                                                               x
                                                            
                                                            ,
                                                            j
                                                            ,
                                                            k
                                                         
                                                         n
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               c
                                                               0
                                                            
                                                            
                                                               Δ
                                                            
                                                            t
                                                            −
                                                            
                                                               Δ
                                                               
                                                                  i
                                                                  j
                                                                  k
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               c
                                                               0
                                                            
                                                            
                                                               Δ
                                                            
                                                            t
                                                            +
                                                            
                                                               Δ
                                                               
                                                                  i
                                                                  j
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         E
                                                         
                                                            z
                                                            
                                                               N
                                                               x
                                                            
                                                            ,
                                                            j
                                                            ,
                                                            k
                                                         
                                                         
                                                            n
                                                            +
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         E
                                                         
                                                            z
                                                            
                                                               N
                                                               x
                                                            
                                                            +
                                                            1
                                                            ,
                                                            j
                                                            ,
                                                            k
                                                         
                                                         n
                                                      
                                                      )
                                                      ,
                                                       
                                                      j
                                                      =
                                                      1
                                                      :
                                                      
                                                         N
                                                         y
                                                      
                                                      +
                                                      1
                                                      ,
                                                         
                                                      k
                                                      =
                                                      1
                                                      :
                                                      
                                                         N
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The equations above can be straightforwardly extended to the remaining components of the electric field with minor changes of the subscripts. Regarding the superabsorption conditions, they constitute an improvement of Mur's ABCs in terms of robustness and accuracy. The essential aim of superabsorption conditions is to compensate inconsistencies that are present in the boundary magnetic fields components due to residual errors in the electric field components calculated by Mur's ABCs. If we consider the y component of the magnetic field, the first step in the superabsorption method is to calculate H
                        
                           y
                         in the boundaries using the basic equations of the FDTD method, which yields 
                           
                              
                                 H
                                 
                                    y
                                    1
                                    ,
                                    j
                                    ,
                                    k
                                 
                                 
                                    n
                                    +
                                    1
                                    /
                                    2
                                    (
                                    1
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 H
                                 
                                    y
                                    
                                       N
                                       x
                                    
                                    ,
                                    j
                                    ,
                                    k
                                 
                                 
                                    n
                                    +
                                    1
                                    /
                                    2
                                    (
                                    1
                                    )
                                 
                              
                           
                        . After that, Mur's ABCs are applied to H
                        
                           y
                        , which gives 
                           
                              
                                 H
                                 
                                    y
                                    1
                                    ,
                                    j
                                    ,
                                    k
                                 
                                 
                                    n
                                    +
                                    1
                                    /
                                    2
                                    (
                                    2
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 H
                                 
                                    y
                                    
                                       N
                                       x
                                    
                                    ,
                                    j
                                    ,
                                    k
                                 
                                 
                                    n
                                    +
                                    1
                                    /
                                    2
                                    (
                                    2
                                    )
                                 
                              
                           
                        . Subsequently, the final value of H
                        
                           y
                         in the boundaries is given by Eq. (11).
                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         H
                                                         
                                                            y
                                                            1
                                                            ,
                                                            j
                                                            ,
                                                            k
                                                         
                                                         
                                                            n
                                                            +
                                                            1
                                                            /
                                                            2
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            
                                                               H
                                                               
                                                                  y
                                                                  1
                                                                  ,
                                                                  j
                                                                  ,
                                                                  k
                                                               
                                                               
                                                                  n
                                                                  +
                                                                  1
                                                                  /
                                                                  2
                                                                  (
                                                                  1
                                                                  )
                                                               
                                                            
                                                            +
                                                            (
                                                            
                                                               c
                                                               0
                                                            
                                                            
                                                               Δ
                                                            
                                                            t
                                                            /
                                                            
                                                               Δ
                                                               
                                                                  i
                                                                  j
                                                                  k
                                                               
                                                            
                                                            )
                                                            
                                                               H
                                                               
                                                                  y
                                                                  1
                                                                  ,
                                                                  j
                                                                  ,
                                                                  k
                                                               
                                                               
                                                                  n
                                                                  +
                                                                  1
                                                                  /
                                                                  2
                                                                  (
                                                                  2
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            1
                                                            +
                                                            (
                                                            
                                                               c
                                                               0
                                                            
                                                            Δ
                                                            t
                                                            /
                                                            
                                                               Δ
                                                               
                                                                  i
                                                                  j
                                                                  k
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      ,
                                                       
                                                      j
                                                      =
                                                      1
                                                      :
                                                      
                                                         N
                                                         y
                                                      
                                                      +
                                                      1
                                                      ,
                                                         
                                                      k
                                                      =
                                                      1
                                                      :
                                                      
                                                         N
                                                         z
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         H
                                                         
                                                            y
                                                            
                                                               N
                                                               x
                                                            
                                                            ,
                                                            j
                                                            ,
                                                            k
                                                         
                                                         
                                                            n
                                                            +
                                                            
                                                               1
                                                               /
                                                               2
                                                            
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            
                                                               H
                                                               
                                                                  y
                                                                  
                                                                     N
                                                                     x
                                                                  
                                                                  ,
                                                                  j
                                                                  ,
                                                                  k
                                                               
                                                               
                                                                  n
                                                                  +
                                                                  
                                                                     1
                                                                     /
                                                                     
                                                                        2
                                                                        
                                                                           1
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            (
                                                            
                                                               c
                                                               0
                                                            
                                                            Δ
                                                            t
                                                            /
                                                            
                                                               Δ
                                                               
                                                                  i
                                                                  j
                                                                  k
                                                               
                                                            
                                                            )
                                                            
                                                               H
                                                               
                                                                  y
                                                                  
                                                                     N
                                                                     x
                                                                  
                                                                  ,
                                                                  j
                                                                  ,
                                                                  k
                                                               
                                                               
                                                                  n
                                                                  +
                                                                  
                                                                     1
                                                                     /
                                                                     
                                                                        2
                                                                        
                                                                           2
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            1
                                                            +
                                                            (
                                                            
                                                               c
                                                               0
                                                            
                                                            Δ
                                                            t
                                                            /
                                                            
                                                               Δ
                                                               
                                                                  i
                                                                  j
                                                                  k
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      ,
                                                       
                                                      j
                                                      =
                                                      1
                                                      :
                                                      
                                                         N
                                                         y
                                                      
                                                      +
                                                      1
                                                      ,
                                                         
                                                      k
                                                      =
                                                      1
                                                      :
                                                      
                                                         N
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

This section describes the modelling of two magnetic sources (i.e. circular-shaped and figure-8 coils) commonly used in TMS that were used in the previous FDTD method.

In this Section, we summarize a method for modelling a circular coil as an ensemble of simple dipoles. It has been shown that the electromagnetic field induced by a circular coil can be modelled by the superposition of the fields produced by several dipoles located at specific positions [17]. In particular, the approach firstly requires dividing the coil area into subregions, and subsequently locating a dipole in the centre of each of them. In that way, the normal component of the magnetic field (denoted as B(r, β) in two dimensional polar coordinates, where r is the radius and β the angle) is approximated by the weighted sum in Eq. (12).
                              
                                 (12)
                                 
                                    
                                       
                                          ∫
                                          0
                                          
                                             
                                                r
                                                b
                                             
                                          
                                       
                                       
                                          
                                             ∫
                                             0
                                             
                                                2
                                                π
                                             
                                          
                                          
                                             B
                                             (
                                             r
                                             ,
                                             β
                                             )
                                             r
                                             ⋅
                                             d
                                             r
                                             ⋅
                                             d
                                             β
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          
                                             p
                                             k
                                          
                                          B
                                          (
                                          
                                             r
                                             k
                                          
                                          ,
                                          
                                             β
                                             k
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        

In Eq. (12) 
                           N is the number of dipoles, p
                           
                              k
                            is the weight associated with each of them and B(r
                           
                              k
                           , β
                           
                              k
                           ) is the magnetic field for each dipole located at the corresponding polar coordinates. The determination of the weight and the position associated with each dipole is carried out by numerical solving of systems of nonlinear equations [18]. Here we consider the modelling of a circular coil by 12 magnetic dipoles, as shown in Fig. 1
                           a). This model has a satisfactory degree of accuracy for coils to within approximately 60–80mm, depending on several spatial parameters [8]. In this case, the parameters employed are listed in Table 1
                           .

Each magnetic dipole can be modelled using a small-sized coil without magnetic core comprising a coil with a cross section A and N turns whose magnetic moment is expressed in Eq. (13), where i(t) is the current pulse that excites the coil.
                              
                                 (13)
                                 
                                    
                                       
                                          M
                                          z
                                       
                                       (
                                       t
                                       )
                                       =
                                       A
                                       Ni
                                       (
                                       t
                                       )
                                    
                                 
                              
                           
                        

Here we use Gaussian pulses as described by the Eq. (14).
                              
                                 (14)
                                 
                                    
                                       
                                          i
                                          s
                                       
                                       (
                                       t
                                       )
                                       =
                                       
                                          I
                                          0
                                       
                                       
                                          
                                             t
                                             −
                                             
                                                t
                                                0
                                             
                                          
                                          τ
                                       
                                        
                                       exp
                                       
                                          
                                             −
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               t
                                                               −
                                                               
                                                                  t
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                      2
                                                   
                                                
                                                
                                                   2
                                                   
                                                      τ
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The parameter τ determines the centre frequency of the pulse, given by f
                           
                              c
                           
                           =0.16/τ, and the 3dB bandwidth, that is BW
                           =1.15f
                           
                              c
                           . FDTD simulations were carried out at 1MHz, using the dielectric parameters for the brain layers at the desired frequency and applying a posterior scaling method to the results [13].

The initial position of the dipoles that model the coil is in the plane yz located in the right side of the head. Afterwards they are rotated in the space by the method described below.

The position of each dipole in the yz plane specified in the reference system x
                           0
                           y
                           0
                           z
                           0 can be expressed by means of Eqs. (15)–(17). Where r
                           
                              k
                            and β
                           
                              k
                            are the radius and the angle for the k-dipole respectively, whose values were reported in Table 1.
                              
                                 (15)
                                 
                                    
                                       
                                          x
                                          k
                                          0
                                       
                                       =
                                       
                                          s
                                          b
                                       
                                    
                                 
                              
                           
                           
                              
                                 (16)
                                 
                                    
                                       
                                          y
                                          k
                                          0
                                       
                                       =
                                       
                                          r
                                          k
                                       
                                        
                                       cos
                                       (
                                       
                                          β
                                          k
                                       
                                       )
                                    
                                 
                              
                           
                           
                              
                                 (17)
                                 
                                    
                                       
                                          z
                                          k
                                          0
                                       
                                       =
                                       
                                          r
                                          k
                                       
                                        
                                       sin
                                       (
                                       
                                          β
                                          k
                                       
                                       )
                                    
                                 
                              
                           
                        

The implementation of each magnetic dipole in the FDTD method is performed by the double-closed current loop model [19]. According to this method, the total current density for each of the two loops that model the magnetic moment of the dipole can be expressed as in Eq. (18).
                              
                                 (18)
                                 
                                    
                                       
                                          J
                                          s
                                       
                                       (
                                       t
                                       )
                                       =
                                       
                                          
                                             A
                                             N
                                          
                                          
                                             2
                                             
                                                Δ
                                                
                                                   i
                                                   j
                                                   k
                                                
                                                4
                                             
                                          
                                       
                                       i
                                       (
                                       t
                                       )
                                    
                                 
                              
                           
                        

In this case, the current density should be weighted by the weight associated to each dipole according to the values in Table 1 and the expression (19). So the moment of the magnetic dipole can be approximated by the weighted sum shown in Eq. (20) in an analogous way to the magnetic field.
                              
                                 (19)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      J
                                                      s
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          k
                                       
                                       =
                                       
                                          p
                                          k
                                       
                                       
                                          J
                                          s
                                       
                                       (
                                       t
                                       )
                                    
                                 
                              
                           
                           
                              
                                 (20)
                                 
                                    
                                       
                                          J
                                          s
                                       
                                       (
                                       t
                                       )
                                       =
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          
                                             p
                                             k
                                          
                                          
                                             J
                                             s
                                          
                                          (
                                          t
                                          )
                                       
                                    
                                 
                              
                           
                        

This section addresses the model of a figure-8 coil from the extension of the circular coil model previously described. In this case a figure-8 coil can be modelled by means of 24 dipoles (12 for each of the two circular coils that comprise it) as it is depicted in Fig. 1b). Taking into account the structure of the figure-8 coil, two new parameters should be considered: the margin between the coils (m), which fixes the spacing between them, and the orientation of the coil axis (ψ).

As in the case of the circular coil, the position of the dipoles is initially specified in the yz plane of the head reference system. In this case, the position of the 12 dipoles that model the first circular coil shape is given by Eqs. (21)–(23).
                              
                                 (21)
                                 
                                    
                                       
                                          x
                                          k
                                          0
                                       
                                       =
                                       
                                          s
                                          b
                                       
                                    
                                 
                              
                           
                           
                              
                                 (22)
                                 
                                    
                                       
                                          y
                                          k
                                          0
                                       
                                       =
                                       
                                          r
                                          k
                                       
                                        
                                       cos
                                       (
                                       
                                          β
                                          k
                                       
                                       )
                                       +
                                       
                                          
                                             
                                                r
                                                b
                                             
                                             +
                                             
                                                1
                                                2
                                             
                                             m
                                          
                                       
                                       cos
                                       (
                                       ψ
                                       )
                                    
                                 
                              
                           
                           
                              
                                 (23)
                                 
                                    
                                       
                                          z
                                          k
                                          0
                                       
                                       =
                                       
                                          r
                                          k
                                       
                                        
                                       sin
                                       (
                                       
                                          β
                                          k
                                       
                                       )
                                       +
                                       
                                          
                                             
                                                r
                                                b
                                             
                                             +
                                             
                                                1
                                                2
                                             
                                             m
                                          
                                       
                                       sin
                                       (
                                       ψ
                                       )
                                    
                                 
                              
                           
                        

The position of the remaining 12 dipoles for the second circular coil can be determined by the Eqs. (24)–(26).
                              
                                 (24)
                                 
                                    
                                       
                                          x
                                          k
                                          0
                                       
                                       =
                                       
                                          s
                                          b
                                       
                                    
                                 
                              
                           
                           
                              
                                 (25)
                                 
                                    
                                       
                                          y
                                          k
                                          0
                                       
                                       =
                                       
                                          r
                                          k
                                       
                                        
                                       cos
                                       (
                                       
                                          β
                                          k
                                       
                                       )
                                       −
                                       
                                          
                                             
                                                r
                                                b
                                             
                                             +
                                             
                                                1
                                                2
                                             
                                             m
                                          
                                       
                                       cos
                                       (
                                       ψ
                                       )
                                    
                                 
                              
                           
                           
                              
                                 (26)
                                 
                                    
                                       
                                          z
                                          k
                                          0
                                       
                                       =
                                       
                                          r
                                          k
                                       
                                        
                                       sin
                                       (
                                       
                                          β
                                          k
                                       
                                       )
                                       −
                                       
                                          
                                             
                                                r
                                                b
                                             
                                             +
                                             
                                                1
                                                2
                                             
                                             m
                                          
                                       
                                       sin
                                       (
                                       ψ
                                       )
                                    
                                 
                              
                           
                        

Finally, the current density is set to opposite sign for the two circular coils as it is expressed in Eq. (27).
                              
                                 (27)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      J
                                                      s
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             12
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   −
                                                   
                                                      J
                                                      s
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          
                                             k
                                             =
                                             13
                                             ,
                                             …
                                             ,
                                             24
                                          
                                       
                                    
                                 
                              
                           
                        

The rest of parameters involved are the same that those used in the modelling of a simple coil, therefore the weight and the position of each individual dipole is obtained once again from the values listed in Table 1.

This section describes the method used to place the coil at any point in the space and therefore to apply the magnetic radiation in the required position and at the desired distance of the head. For this purpose it is necessary to set the reference system. First the head reference system x
                           0
                           y
                           0
                           z
                           0 whose origin matches the centre of the brain mesh is defined as it is shown in Fig. 2
                           .

According to this scheme, the central position of the source can be uniquely defined in spherical coordinates in this reference system by means of three parameters: the polar angle θ
                           
                              b
                           , the azimuthal angle φ
                           
                              b
                            and the radius s
                           
                              b
                           . The Talairach coordinates {x
                           
                              T
                           , y
                           
                              T
                           , z
                           
                              T
                           } of the source are directly related to the spherical coordinates by means of Eqs. (28)–(30).
                              
                                 (28)
                                 
                                    
                                       
                                          x
                                          T
                                       
                                       =
                                       
                                          s
                                          b
                                       
                                        
                                       sin
                                       (
                                       
                                          θ
                                          b
                                       
                                       )
                                       cos
                                       (
                                       
                                          φ
                                          b
                                       
                                       )
                                    
                                 
                              
                           
                           
                              
                                 (29)
                                 
                                    
                                       
                                          y
                                          T
                                       
                                       =
                                       
                                          s
                                          b
                                       
                                        
                                       sin
                                       (
                                       
                                          θ
                                          b
                                       
                                       )
                                       sin
                                       (
                                       
                                          φ
                                          b
                                       
                                       )
                                    
                                 
                              
                           
                           
                              
                                 (30)
                                 
                                    
                                       
                                          z
                                          T
                                       
                                       =
                                       
                                          s
                                          b
                                       
                                        
                                       cos
                                       (
                                       
                                          θ
                                          b
                                       
                                       )
                                    
                                 
                              
                           
                        

The three coordinates define the position vector 
                              
                                 
                                    
                                       s
                                       →
                                    
                                    k
                                    0
                                 
                              
                            expressed in Eq. (31).
                              
                                 (31)
                                 
                                    
                                       
                                          
                                             s
                                             →
                                          
                                          k
                                          0
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                            k
                                                            0
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            y
                                                            k
                                                            0
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            z
                                                            k
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Once we know each dipole position, it is necessary to rotate the position vectors to place them at the final position specified by the polar angle θ
                           
                              b
                            and the azimuthal angle φ
                           
                              b
                           . Such three-dimensional rotation can be carried out by means of two consecutive rotations. First, a rotation over the axis y
                           0 is described by the matrix in Eq. (32), where the rotation angle α
                           
                              y
                            is directly related to the polar angle according to Eq. (33).
                              
                                 (32)
                                 
                                    
                                       
                                          R
                                          y
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         cos
                                                         (
                                                         
                                                            α
                                                            y
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         sin
                                                         (
                                                         
                                                            α
                                                            y
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         sin
                                                         (
                                                         
                                                            α
                                                            y
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         cos
                                                         (
                                                         
                                                            α
                                                            y
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (33)
                                 
                                    
                                       
                                          α
                                          y
                                       
                                       =
                                       −
                                       
                                          
                                             
                                                π
                                                2
                                             
                                             −
                                             
                                                θ
                                                b
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The second rotation is implemented over the axis z
                           0 as it is described by Eq. (34) where the rotation angle α
                           
                              z
                            is exactly the same as the defined azimuthal angle (α
                           
                              z
                           
                           =
                           φ
                           
                              b
                           ).
                              
                                 (34)
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             z
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         cos
                                                         (
                                                         
                                                            α
                                                            z
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         −
                                                         sin
                                                         (
                                                         
                                                            α
                                                            z
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      
                                                         sin
                                                         (
                                                         
                                                            α
                                                            z
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         cos
                                                         (
                                                         
                                                            α
                                                            z
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The concatenation of these two rotation operations over the initial position vector 
                              
                                 
                                    
                                       
                                          s
                                       
                                       →
                                    
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                              
                            in the yz plane results in the position vector for each dipole in the source spatial position as expressed in Eq. (35).
                              
                                 (35)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                →
                                             
                                             ′
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       
                                          
                                             R
                                          
                                          
                                             z
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             y
                                          
                                       
                                       
                                          
                                             
                                                s
                                             
                                             →
                                          
                                          
                                             k
                                          
                                          O
                                       
                                    
                                 
                              
                           
                        

Finally, it is necessary to pass from the head reference system to the global coordinate system xyz. The position of the reference system origin x
                           0
                           y
                           0
                           z
                           0 is known as it is determined by the vector 
                              
                                 
                                    
                                       
                                          s
                                       
                                       →
                                    
                                    
                                       c
                                    
                                 
                              
                           . In the specific three-dimensional mesh of adult human head employed, the vector 
                              
                                 
                                    
                                       
                                          s
                                       
                                       →
                                    
                                    
                                       c
                                    
                                 
                              
                            is in Eq. (36).
                              
                                 (36)
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             →
                                          
                                          
                                             c
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         90.77
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         110.37
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         86.94
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The position 
                              
                                 
                                    
                                       
                                          s
                                       
                                       →
                                    
                                    
                                       k
                                    
                                 
                              
                            of each dipole in the global reference system is given by Eq. (37).
                              
                                 (37)
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             →
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                →
                                             
                                             ′
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       
                                          
                                             
                                                s
                                             
                                             →
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                              
                           
                        

The method described provides the positions of the dipoles that model a source located at any desired point in space. The orientation of these dipoles is orthogonal to the coil plane and characterized by the unit vector 
                              
                                 
                                    n
                                 
                                 →
                              
                            defined in Eq. (38), where 
                              
                                 
                                    
                                       
                                          n
                                          →
                                       
                                    
                                    0
                                 
                              
                            is given by Eq. (39).
                              
                                 (38)
                                 
                                    
                                       
                                          
                                             n
                                          
                                          →
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   →
                                                
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         →
                                                      
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (39)
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                             →
                                          
                                          0
                                       
                                       =
                                       −
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                            T
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            y
                                                            T
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            z
                                                            T
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

This section is devoted to the application of the model previously described to specific cases of Alzheimer and Parkinson disease subjected to TMS. Thus the selection of the parameters employed was obtained from the analysis of TMS clinical trials that have released beneficial effects over some dysfunctions associated with both neurodegenerative diseases. The parameters employed for the model of TMS in AD were obtained from [20], due to the fact that the authors observed an improvement in language dysfunction (auditory sentence comprehension) when they applied the magnetic stimulation over the left dorsolateral prefrontal cortex (DLPFC) in AD patients. Following their clinical setup, the magnetic stimulation in our model is applied over the Broadman area 8/9 with a Magstim double 70mm coil. We have also modelled a single coil in order to assess possible differences between both types of magnetic source.

Regarding the modelling of TMS in PD, the parameters selection was carried out taking into account the clinical trial in [21], where the magnetic stimulation over the supplementary motor area (SMA) provided a relief of motor symptoms in PD patients. Therefore the magnetic stimulation in our model is applied over the Broadman area 6 with a double 70mm coil and a single 70mm coil. Furthermore in the case of the single coil, two different coil orientations (ψ
                     =0° and ψ
                     =90°) were tested.

The FDTD method directly solves Maxwell's equations in the time domain. As a consequence, it is valid for arbitrary electromagnetic radiation. However, its application for the study of magnetic propagation in human head for brain stimulation at low frequency imposes some difficulties. The fact that the frequencies commonly used in TMS are very low (roughly between 0.1Hz and 10kHz, although the range is commonly restricted to 0.1–100Hz) makes it computationally unfeasible to perform a direct implementation of the FDTD method. In such situations, the problem can be solved by a frequency scaling method [13]. This method takes advantage of the quasi-static nature of the modelled situation. In particular, it is valid when the modelled volume is at least 10 times lower than the wavelength, and |σ
                     +
                     iωɛ|≫
                     ωɛ
                     0. Both conditions are verified for the case of brain tissue. According to such approach, the FDTD can be performed at a frequency f′ higher than the frequency of interest f, and subsequently perform the following scaling operation:
                        
                           (40)
                           
                              
                                 E
                                 (
                                 f
                                 )
                                 =
                                 
                                    f
                                    
                                       f
                                       ′
                                    
                                 
                                 
                                    E
                                    ′
                                 
                                 (
                                 
                                    f
                                    ′
                                 
                                 )
                                 .
                              
                           
                        
                     
                  

The dielectric properties included in the FDTD method are specified at frequency f. As well as that, modelling of low-frequency magnetic propagation in the human body converges in far less than a complete cycle, due to the small size of the modelled volume when compared to the wavelength. Taking into account this aspect can significantly reduce the computing time. It has been demonstrated that such approximation gives correct results for ratios of up to 1:200,000. In this work 100Hz stimulation was used due to the fact that it requires less computational load than lower frequencies providing similar results. These approximations are taken into account in our FDTD code. The method uses a three-dimensional realistic head mesh publicly available (namely Colin27 adult brain atlas FEM mesh Version 2) [22]. The total simulation volume is 212mm×240mm×208mm. Dielectric properties of the brain layers (skull, cerebrospinal fluid, grey matter and white matter) for the frequency considered in the FDTD simulations (100Hz) have been taken from the available literature [23], and are listed in Table 2
                     .

@&#RESULTS AND DISCUSSION@&#

The electric field distribution was obtained taking into account the TMS setup employed in clinical trials involving AD and PD patients with beneficial effects over characteristic alterations associated with the specific pathology. Thus the parameters employed in the model were chosen taking into account the geometry and position of the magnetic source over the functional brain regions of interest for both types of disorders as it was previously expressed. Fig. 3
                      compares the electric field distribution in the cortex of an AD patient undergoing TMS applied over the Broadmann area 8/9 (top left is the lateral view and top right is the medial view) with a single 70mm coil and a double 70mm coil (bottom left and right respectively). For both of them, the coil position in Talairach coordinates is {x
                     
                        T
                     , y
                     
                        T
                     , z
                     
                        T
                     }={0, 82.54, 47.65}mm and {θ
                     
                        b
                     , φ
                     
                        b
                     , s
                     
                        b
                     }={60°, 90°, 95.31mm} in spherical coordinates and its orientation is ψ
                     =0°. As it can be observed, both types of coil provide a clear confinement of the magnetic radiation in the desired cortex region to treat the language dysfunction associated with AD. As a consequence, possible secondary effects derived of an inaccurate confinement are avoided. The representation of the electric field distribution under the same scale for both coils allows us to observe an increment in the field intensity when the double coil is employed. These results prove the high potential of this last type of coil for providing a better treatment directivity.


                     Figs. 4 and 5
                     
                      show the results obtained from TMS modelling in PD. In both cases the region of interest is the Broadmann area 6 highlighted in the upper graph of Fig. 4. In this last figure, the lower graphs represent a transverse view of the stimulated cortex from the top of the head with a single 70mm coil and a double 70mm coil (left and right respectively). In both cases the coil orientation was ψ
                     =0° and the Talairach coordinates of the magnetic source were {x
                     
                        T
                     , y
                     
                        T
                     , z
                     
                        T
                     }={0, 50.87, 72.65}mm Once again, both types of coil provide a clear confinement of the magnetic radiation in the desired cortex region, the supplementary motor area (SMA), involved in the motor symptoms of PD patients.

Finally, the double coil orientation was modified in order to assess the coil orientation influence on the electric field distribution. The results obtained are shown in Fig. 5, where the graph on the left corresponds to the electric field distribution with a coil orientation of ψ
                     =0° and the graph on the right to an orientation of ψ
                     =90°. In this last case the Talairach coordinates of the magnetic source were {x
                     
                        T
                     , y
                     
                        T
                     , z
                     
                        T
                     }={0, 43.79, 75.85}mm. Comparing both results a directivity dependence with the coil orientation can be clearly appreciated. Taking into account these results, the double coil oriented ψ
                     =0° would provide higher treatment directivity. As a consequence, better limitation of the therapeutic effects over those brain areas related to the motor symptoms associated with PD would be obtained.

The significance of the induced electric field distribution has a direct relationship with the development of an accurate treatment dosimetry that allows to determine the proper position and orientation of the magnetic source to induce the electrical current that depolarizes the desired cortical axons and triggers action potentials in the functional brain areas suitable for treating a specific pathology. As stated before, the exact relationship between the induced magnetic field and the therapeutic effect remains unclear. Although the tissue – field interaction at neuron level remains without being completely understood, the total electric field is commonly considered as the determining quantity to induce depolarization of the neuron membrane to initiate the excitation effects. Therefore the electric field distribution obtained in this work or the proportional current density is commonly employed in modelling studies as the main parameter to predict the area of stimulation. Specific brain areas are identified as targets for the treatment of several pathologies. As a consequence, the analysis made in the manuscript exploits the actual knowledge about magnetic stimulation effects to provide a tool for treatment planning. And therefore, according to these results, the application of the current TMS model presents a great interest in order to estimate the optimal magnetic source configuration to deal with specific symptoms that are characteristic of a particular neurodegenerative disease. Therefore it constitutes a first approach for the future development of predictive clinical tools able to plan the optimal TMS dosimetry for each individual patient.

Unfortunately, although an adequate treatment planning requires an a priori knowledge of the field distribution in the brain, magnetic field distribution inside the brain, or inside any other tissue, is quite difficult to measure. As a consequence, the approaches employed rely on numerical models of electromagnetic radiation. In this work, we also followed this approach. In order to assure the accuracy of the results, we employed a well-known widely used FDTD approach. The approaches for coil modelling or frequency scaling were also previously employed in other applications. Comparing the results with other studies is difficult, as we are dealing with novel complex treatment strategies that are not usually considered in full. The high variability in the TMS setups, the patient variability and the use of unsuitable quantification metrics impede nowadays an accurate comparison with reproducible clinical results. The quantitative comparison with other published results, even with those that use a different numerical method, is also limited due to the great amount of factors that introduce variability in the final result. The qualitative analysis of the results obtained meets well-known aspects, such as the high confinement of the electrical field with TMS coils. A strict verification of results obtained would entail the measurement of the electric field distribution in a significant set of subjects, knowing for each particular subject both the electromagnetic and morphological brain tissue properties. However, as far as we know, TMS modelling until the date has only provided valuable insights into the location and spatial distribution of TMS stimulation, without a sufficiently proved clinically contrasted quantification of both the stimulation and activation areas. As a consequence, the validity of the well-known FDTD approach used in the model proposed and the consistency of the results obtained with the current data available contribute to the development of predictive clinical tools able to plan the optimal TMS dosimetry.

@&#CONCLUSIONS@&#

In this work, the FDTD method has been applied to a three-dimensional realistic adult head mesh for modelling the magnetic propagation in a human brain undergoing TMS. TMS was applied to functional brain areas associated with the language dysfunction in AD and with the motor symptoms in PD. The results show that the developed tool is able to predict the radiation distribution in the brain with high resolution for different magnetic source configurations. As a consequence the model outlined provides a valuable tool for the future identification of an accurate TMS dosimetry that facilitates an adequate therapy planning, taking into account the numerous factors that may affect the final treatment response.

There is no conflict of interest.

@&#ACKNOWLEDGEMENT@&#

This work has been carried out with the support of San Cándido Foundation.

@&#REFERENCES@&#

