@&#MAIN-TITLE@&#TEMPTING system: A hybrid method of rule and machine learning for temporal relation extraction in patient discharge summaries

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We developed rules and maximum entropy models for extracting temporal relation.


                        
                        
                           
                           We developed an algorithm to hybridize results of rules and maximum entropy models.


                        
                        
                           
                           We identified required knowledge and inference for temporal relations extraction.


                        
                        
                           
                           Clinical note sections within a discharge summary can help define temporal relations.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Temporal relation extraction

Natural language processing

Text mining

Hybrid method

Maximum entropy

@&#ABSTRACT@&#


               
               
                  Patient discharge summaries provide detailed medical information about individuals who have been hospitalized. To make a precise and legitimate assessment of the abundant data, a proper time layout of the sequence of relevant events should be compiled and used to drive a patient-specific timeline, which could further assist medical personnel in making clinical decisions. The process of identifying the chronological order of entities is called temporal relation extraction. In this paper, we propose a hybrid method to identify appropriate temporal links between a pair of entities. The method combines two approaches: one is rule-based and the other is based on the maximum entropy model. We develop an integration algorithm to fuse the results of the two approaches. All rules and the integration algorithm are formally stated so that one can easily reproduce the system and results. To optimize the system’s configuration, we used the 2012 i2b2 challenge TLINK track dataset and applied threefold cross validation to the training set. Then, we evaluated its performance on the training and test datasets. The experiment results show that the proposed TEMPTING (TEMPoral relaTion extractING) system (ranked seventh) achieved an F-score of 0.563, which was at least 30% better than that of the baseline system, which randomly selects TLINK candidates from all pairs and assigns the TLINK types. The TEMPTING system using the hybrid method also outperformed the stage-based TEMPTING system. Its F-scores were 3.51% and 0.97% better than those of the stage-based system on the training set and test set, respectively.
               
            

@&#INTRODUCTION@&#

Event and temporal information extraction from plain text is an essential task in natural language processing (NLP) research; and it has been used for many NLP applications, such as document summarization and question answering [4]. Document summarization must identify the key events in one or more stories to yield the best summary with the least extraneous information. Question answering must be able to answer queries about dates, the duration of events, and even relative times in the form of natural language or a set query type. The possible domains for temporal information extraction are numerous and varied, but it is especially useful for processing patient records in the medical domain. Such records contain valuable temporal data that is usually in the form of free text. Information about the sequence of events in patient records plays an essential role in clinical research because it can help solve diverse problems; for example, finding the correlations between treatments and outcomes or extracting information about adverse drug reactions. However, the knowledge that certain items are correlated may be worthless without knowing their temporal order. For example, if researchers are interested in the efficacy of the medicine vancomycin, realizing that the symptom of a disease changes after a patient takes vancomycin may be insufficient without learning that the change only occurs after three days of treatment. To improve the temporal extraction of patient information in the clinical domain, the Sixth Informatics for Integrating Biology and the Bedside (i2b2) NLP challenge [27] was held in 2012. The challenge involved automatically determining the temporal relations between events described in de-identified patient discharge summaries. Based on the TLINK, EVENT and TIMEX3 tags defined in TimeBank [17],
                        1
                        TimeBank is a hand-annotated corpus that conforms to the TimeML specification [18], which is an ISO standard for the annotation of events and temporal expressions, as well as anchoring and ordering the relations between them. In TimeBank, the TLINK tag represents the temporal relationship between events (the EVENT tag) or between an EVENT and a time expression (the TIMEX3 tag).
                     
                     
                        1
                      the challenge released a dataset annotated by Partners HealthCare and Beth Israel Deaconess Medical Center [22], and proposed three tracks: (1) EVENT/TIMEX3 track: recognize event and time expressions; (2) TLINK track: based on the given EVENT and TIMEX3 tags, identify their temporal relations; (3) End-to-End track: perform the above two tasks on raw discharge summaries. In the framework of the TLINK track, the actions, situations and descriptions in a discharge summary that are related to the patient’s timeline are annotated with the EVENT tag. Phrases in the summary that provide time-relevant knowledge are annotated with the TIMEX3 tags. Temporal links or TLINKs indicate the relations between pairs of EVENTs and TIMEX3s; and the attribute “type” of a TLINK indicates how temporal objects are related to each other. A TLINK track system must establish a TLINK link between the involved entities. It must also state their attribute type explicitly; that is, indicate if they are: “before”, “after”, “includes”, “is included”, “holds”, “simultaneous”, “immediately after”, “immediately before”, “begins”, “ends”, and so on.

Compared to general relation extraction tasks, identifying temporal relations in patient discharge summaries is more strenuous, and has motivated a great deal of NLP research in recent years [12,19,23]. Continuing with the vancomycin example above, the recognition of temporal phrases (e.g. after … three days) and event entities (e.g. vancomycin) are clearly prerequisites for understanding and interpreting the statement. However, the further temporal knowledge and inferences are more important and must be derived. First, the temporal aspects of the properties of entities must be properly assigned. Second, event descriptions involving entities and their time stamps must be extracted. Finally, the temporal order of the involved entities has to be inferred. In this paper, we focus on the TLINK track and propose a hybrid TEMPoral relaTion extractING (TEMPTING) system that combines rule-based and machine learning approaches to capture the above knowledge and inferences. Temporal relation extraction rules and the pseudocode for integrating the rule-based and machine learning results are formally described. To the best of our knowledge, many leading systems in i2b2 [6,24] do not consider some of the proposed rules or state them formally.

@&#MATERIAL AND METHODS@&#

Our objective is to extract temporally related entity pairs ei
                      and ej
                     , and their temporal relation, r, from a text as a TLINK tuple [ei
                     ,
                     r,
                     ej
                     ]. Fig. 1
                      shows the system architecture of TEMPTING, which is comprised of two key subsystems: the multi-stage rule-based temporal relation extraction system (the rule-based system) and the maximum entropy-based temporal relation extraction system (the machine learning-based system). For each discharge summary dk
                      in D
                     ={d
                     1,…,
                     dl
                     }, all entities E
                     ={e
                     1,
                     e
                     2,…,
                     em
                     } in dk
                      are first paired to form the candidate TLINK pair set P
                     ={p
                     1,…,
                     pn
                     }, where p
                     =〈ei
                     ,
                     ej
                     〉 is a TLINK pair constructed by the entities ei
                      and ej
                     . The candidate pair set P is then processed by both subsystems and the TLINKs they extract are fused by a TLINK integration algorithm to generate the final results.

In the rule-based system, we group several heuristic rules into three different stages to determine the type r of each p in P. Depending on the setting of the TLINK track, the type should be one of the following values: {“BEFORE”, “OVERLAP” and “AFTER”}. First, we apply the intra-sentence rules to extract the TLINKs in a sentence. Then, we exploit the inter-sentence extraction rules along with the co-reference and timeline concept to extract cross-sentence TLINKs. Finally, TLINKs are retrieved according to the clinical note sections, which are different portions of clinical notes that contain rich information about the patient during different stages, such as admission, treatment and discharge. These can be used to determine the TLINK types that each EVENT/TIMEX3 belongs to. In the Results section, we will show the performance of the proposed rules based on the combination of different stages.

In the machine learning-based system, an additional phase, TLINK detection, is implemented to filter out EVENT/TIMEX3 pairs that do not possess a TLINK. A supervised learning-based TLINK type classifier then predicts the type r of p. For each p, the feature extraction component extracts representative text features that are used by the TLINK detector/classifier. In the following subsections, we describe our two temporal relation extraction systems and the rules/features developed for the TLINK track.

The rule-based system is implemented as a series of rule-based models that exploit a number of linguistic rules to capture various temporal relation patterns. One or several deterministic rules represent a processing stage in the system. In the following subsections, we use four symbols to represent each rule: constants, variables, functions, and predicates. Constants represent objects in a discharge summary, such as a time entity “per day” or an event entity “levofloxacin”. Variables (e.g., i, j) range over the objects. Constants and variables may belong to specific types. Predicates represent the relationships between objects, or the attributes of objects. We use logical connectives and quantifiers to construct the rules recursively from constants or variables. The Boolean operations of logical conjunction, disjunction and negation are denoted by “∧”, “∨”, and “
                           
                              ¬
                           
                        ” respectively; and the symbol “
                           
                              ⇒
                           
                        ” means “implies”. For instance, 
                           
                              A
                              ⇒
                              B
                           
                         means that if A is true, then B is also true; however, if A is false, nothing is said about B. Parentheses may be used to enforce the precedence.

This stage determines the default TLINK types of the TLINK pairs found in the same sentence. Fig. 2
                            shows an example where two OVERLAP TLINKs should be extracted from the sentence. One is constructed by two EVENT entities, e
                           1 and e
                           2; and the other is comprised of e
                           2 and the time expression (TIMEX3) entity t
                           1. Note that we use different variable symbols to represent different types of entities. For EVENT entities, the variable eti
                            is used; and the ti
                            symbol is used for TIMEX3 entities.

In the training set of the i2b2 TLINK track, we observed that the probability of two EVENT entities in the same sentence having a TLINK type of OVERLAP is 61.8%. Therefore, in the first stage, we developed the following rule to assign the OVERLAP link between two event entities found in the same sentence.
                              
                                 
                                    R
                                    .
                                    1
                                    .
                                    1
                                    
                                    isTheSameSentence
                                    (
                                    
                                       
                                          et
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          et
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    ⇒
                                    
                                       
                                          TLINK
                                       
                                       
                                          OVERLAP
                                       
                                    
                                    (
                                    
                                       
                                          et
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          et
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              
                           
                        

Furthermore, based on our analysis on the training set, we believe there is a high probability that an EVENT entity will establish an OVERLAP TLINK with the nearest co-occurring TIMEX3 in the same sentence. Accordingly, the following rule is used to construct the OVERLAP link between an EVENT entity and its nearest TIMEX3 entity.
                              
                                 
                                    R
                                    .
                                    1
                                    .
                                    2
                                    
                                    isTheSameSentence
                                    (
                                    
                                       
                                          e
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    ∧
                                    isTheNearestTime
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          e
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ⇒
                                    
                                       
                                          TLINK
                                       
                                       
                                          OVERLAP
                                       
                                    
                                    (
                                    
                                       
                                          e
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              
                           
                        

To discover the relationships between time expressions or events across sentences, we employ two strategies in this stage. The first uses the co-reference resolution model developed in our previous work [8] to uncover EVENTs that literally imply the same concept. The second exploits timeline-dependent information to determine the type of the TLINK between the EVENT and TIMEX3 entities.

Co-reference resolution involves determining whether two noun phrases are used to refer to the same thing. We used the co-reference resolution method developed for the co-reference resolution track in the 2011 i2b2/VA/Cincinnati Challenge to determine the co-referential relationship between entities. The following rule captures the idea that if two EVENTs are co-reference pairs, a TLINK with type attribute “OVERLAP” should be established between them because they should indicate the same incident.
                                 
                                    
                                       R
                                       .
                                       2
                                       .
                                       1
                                       
                                       isCoreference
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             e
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       ⇒
                                       
                                          
                                             TLINK
                                          
                                          
                                             OVERLAP
                                          
                                       
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             e
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                 
                              
                           

To discover the relationships between time expressions or events across sentences, we developed a timeline-dependent algorithm that is implemented in two steps. First, all time expressions in a discharge summary are collected and denoted as T
                              ={t
                              1,
                              t
                              2,…
                              to
                              }. Second, the TLINK types among the collected expressions are determined based on their descriptions.

Unfortunately, a wide variety of phrases and expressions can be used to state temporal information. For example, December 25, 2010 can be expressed in different ways, such as 2010-12-25, 12/25/2010, and 25/12/2010. Different temporal phrases that refer to the same event must be normalized so that they can be processed easily. In this work, the normalization information provided with the TLINK track dataset was used. For example, the normalized format for a calendar date is [YYYY]-[MM]-[DD]; and in the sentence “The patient was brought to the operating room on 03/30/1999” the normalized time expression for “03/30/1999” is 1999-03-30. After using common sense rules to compare the normalized temporal description, the TLINK type is assigned to any ti
                               and tj
                               in T. For instance, the TLINK tuple [ti
                              ,“AFTER”,
                              tj
                              ] is generated if ti
                              ’s normalized value is after tj
                              ’s value, and the “OVERLAP” type is assigned if their values are the same.

After constructing the timeline for all t in T, the algorithm looks for the set of overlapping tuples. A set consists of entities whose temporal type is OVERLAP with their corresponding time expressions in T, e.g., R.1.2 may represent an overlapping tuple {〈et
                              1,“OVERLAP”,
                              t
                              1〉, 〈et
                              3,“OVERLAP”,
                              t
                              2〉}. Using the constructed timeline, the algorithm then applies the following rule to determine the missing TLINK types among entities in the overlapping tuple.
                                 
                                    
                                       R
                                       .
                                       2
                                       .
                                       2
                                       
                                       [
                                       
                                          
                                             TLINK
                                          
                                          
                                             OVERLAP
                                          
                                       
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       ∨
                                       
                                          
                                             TLINK
                                          
                                          
                                             BEFORE
                                          
                                       
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       ]
                                       ∧
                                       [
                                       
                                          
                                             TLINK
                                          
                                          
                                             OVERLAP
                                          
                                       
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             l
                                          
                                       
                                       )
                                       ∨
                                       
                                          
                                             TLINK
                                          
                                          
                                             AFTER
                                          
                                       
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             l
                                          
                                       
                                       )
                                       ]
                                       ∧
                                       
                                          
                                             TLINK
                                          
                                          
                                             BEFORE
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             l
                                          
                                       
                                       )
                                       ⇒
                                       
                                          
                                             TLINK
                                          
                                          
                                             BEFORE
                                          
                                       
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             e
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                 
                              
                           

The above rule states that (1) if an entity ei
                               occurs on tk
                               or before tk
                              , (2) the occurrence time of another entity ej
                               is tl
                               (or after tl
                              ), and (3) tl
                               is after tk
                              , then the TLINK tuple 〈ei
                              ,“BEFORE”,
                              ej
                              〉 should be generated. We also use the following rule, which is based on a similar principle.
                                 
                                    
                                       R
                                       .
                                       2
                                       .
                                       3
                                       
                                       
                                          
                                             TLINK
                                          
                                          
                                             OVERLAP
                                          
                                       
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       ∧
                                       
                                          
                                             TLINK
                                          
                                          
                                             OVERLAP
                                          
                                       
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             l
                                          
                                       
                                       )
                                       ∧
                                       
                                          
                                             TLINK
                                          
                                          
                                             OVERLAP
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             l
                                          
                                       
                                       )
                                       ⇒
                                       
                                          
                                             TLINK
                                          
                                          
                                             OVERLAP
                                          
                                       
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             e
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                 
                              
                           

When it is known that an entity ei
                               overlaps with the time tk
                              , and the occurrence time of another entity ej
                               is tl
                              , with the additional knowledge that tk
                               and tl
                               overlap, R.2.3 establishes a TLINK tuple 〈ei
                              ,“OVERLAP”,
                              ej
                              〉.
                                 
                                    
                                       R
                                       .
                                       2
                                       .
                                       4
                                       
                                       
                                          
                                             TLINK
                                          
                                          
                                             BEFORE
                                          
                                       
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       ∧
                                       
                                          
                                             TLINK
                                          
                                          
                                             AFTER
                                          
                                       
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             l
                                          
                                       
                                       )
                                       ∧
                                       
                                          
                                             TLINK
                                          
                                          
                                             OVERLAP
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             l
                                          
                                       
                                       )
                                       ⇒
                                       
                                          
                                             TLINK
                                          
                                          
                                             AFTER
                                          
                                       
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                           

Based on the timeline concept and the logic shown on the left-hand side of R.2.4 it is reasonable to conclude that entity ei
                               occurred before entity ej
                               because of the overlap between tk
                               and tl
                              . Hence, a TLINK tuple 〈ej
                              ,“AFTER”,
                              ei
                              〉 is derived.

In this stage, we use several rules to determine the type of TLINKs between the time expressions of “admission date” or “discharge date”, and the entities found in certain clinical note sections of a discharge summary. We divide a discharge summary into five parts: clinical history, admission, course of treatment, discharge, and other clinical note sections. Fig. 3
                            shows the timeline of the five parts.

We assign the section time of the admission note-section as the date of admission. In addition, the clinical history note-section, which usually contains information about the patient’s physical status as well as his/her psychological, social, and sexual statuses, is set as the time before the admission date. The section times of the course of treatment, discharge and other note-sections are defined in a similar manner. The clinical note section-based timeline information can be used to determine the TLINK types of the entities in the different note-sections. We illustrate the concept in Fig. 4
                           .

In this summary, it is obvious that the admission date t
                           1 is “05/09/2000”, and the discharge date t
                           2 is “05/30/2000” because they are listed in the “ADMISSION DATE” and “DISCHARGE DATE” note-sections, respectively. Therefore, the occurrence times of entities found in the “HISTORY OF PRESENT ILLNESS” note-section should be BEFORE t
                           1 and t
                           2, because this note-section details the illness history of the patient. Similarly, the occurrence times of entities in the “COURSE of TREATMENT” note-section, should be “AFTER t
                           1, but BEFORE t
                           2”.

One of the key steps in this stage is to determine the clinical note sections of the discharge summary. Clinical records are usually in a consistent format. For example, a discharge summary is divided into different clinical note sections with each section title printed in upper case letters with a colon at the end [13]. We exploit this property and employ a string matching method to recognize the corresponding sections. Table 1
                            shows the keywords used and the corresponding clinical note sections.

Based on the clinical note sections in a discharge summary and the timeline information, we delineate the following rules. For example, R.3.1 sets the occurrence times of all EVENT entities in the course of treatment note-section as “AFTER” and “BEFORE” the admission date and the discharge date respectively.
                              
                                 
                                    R
                                    .
                                    3
                                    .
                                    1
                                    
                                    isHospitalCourseSection
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ∧
                                    isInSection
                                    (
                                    
                                       
                                          et
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ⇒
                                    
                                       
                                          TLINK
                                       
                                       
                                          AFTER
                                       
                                    
                                    (
                                    
                                       
                                          et
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          admission
                                       
                                    
                                    )
                                    ∧
                                    
                                       
                                          TLINK
                                       
                                       
                                          BEFORE
                                       
                                    
                                    (
                                    
                                       
                                          et
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          discharge
                                       
                                    
                                    )
                                 
                              
                           
                           
                              
                                 
                                    R
                                    .
                                    3
                                    .
                                    2
                                    
                                    isHospitalCourseSection
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ∧
                                    isInSection
                                    (
                                    
                                       
                                          et
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ⇒
                                    
                                       
                                          TLINK
                                       
                                       
                                          BEFORE
                                       
                                    
                                    (
                                    
                                       
                                          et
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          admission
                                       
                                    
                                    )
                                    ∧
                                    
                                       
                                          TLINK
                                       
                                       
                                          BEFORE
                                       
                                    
                                    (
                                    
                                       
                                          et
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          discharge
                                       
                                    
                                    )
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             R
                                             .
                                             3
                                             .
                                             3
                                             
                                             isAdmissionSection
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             ∧
                                             isInSection
                                             (
                                             
                                                
                                                   et
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             ⇒
                                             
                                                
                                                   TLINK
                                                
                                                
                                                   OVERLAP
                                                
                                             
                                             (
                                             
                                                
                                                   et
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   admission
                                                
                                             
                                             )
                                             ∧
                                             
                                                
                                                   TLINK
                                                
                                                
                                                   BEFORE
                                                
                                             
                                             (
                                             
                                                
                                                   et
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   discharge
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             isDischargeSection
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             ∧
                                             isInSection
                                             (
                                             
                                                
                                                   et
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             ⇒
                                             
                                                
                                                   TLINK
                                                
                                                
                                                   AFTER
                                                
                                             
                                             (
                                             
                                                
                                                   et
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   admission
                                                
                                             
                                             )
                                             ∧
                                             
                                                
                                                   TLINK
                                                
                                                
                                                   OVERLAP
                                                
                                             
                                             (
                                             
                                                
                                                   et
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   discharge
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    R
                                    .
                                    3
                                    .
                                    4
                                    
                                    isOtherSection
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ∧
                                    isInSection
                                    (
                                    
                                       
                                          et
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ⇒
                                    
                                       
                                          TLINK
                                       
                                       
                                          AFTER
                                       
                                    
                                    (
                                    
                                       
                                          et
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          discharge
                                       
                                    
                                    )
                                 
                              
                           
                        


                        Fig. 5
                         shows the flow chart of the proposed supervised learning temporal relation extraction system, which is comprised of two key subsystems: the TLINK detector and the TLINK type classifier. In contrast to the rule-based system described in Section 2.1, which treats all pairs in the candidate TLINK pair set P
                        ={p
                        1,…,
                        pn
                        } as possible candidates, the proposed system first filters the set with the TLINK detector. For each pair p′ in the filtered pair set P′, the TLINK type classifier predicts its type to complete the TLINK tuple. For example, in the sentence “A peripheral intravenous line was started on Labor Day in the a.m. No respiratory distress was noted…” from 101.xml in the training dataset, three candidate TLINK pairs {〈et
                        24,
                        t
                        7〉, 〈et
                        24,
                        et
                        221〉, 〈et
                        221,
                        t
                        7〉} are generated, where et24, t7, and et221 represent “A peripheral intravenous line”, “Labor Day”, and “distress” respectively. After TLINK detection, only two TLINK pairs {〈e
                        24,
                        t
                        7〉, 〈e
                        221,
                        t
                        7〉} remain. Finally, the TLINK type classifier infers the TLINK types, and generates the TLINK tuples {[e
                        24,“AFTER”,
                        t
                        7], [e221,“OVERLAP”,
                        t
                        7]}.

In this work, we formulate the TLINK detection and TLINK type classification tasks as binary and multi-class classification problems, respectively. Furthermore, we utilize the maximum entropy classification method [2] to construct a logistic regression-based statistical model for each task. Let TP denote a candidate TLINK pair. The maximum entropy method classifies a candidate TLINK pair in terms of the following conditional probability:
                           
                              (1)
                              
                                 P
                                 (
                                 TP
                                 |
                                 
                                    
                                       cp
                                    
                                    
                                       l
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       Z
                                       (
                                       
                                          
                                             cp
                                          
                                          
                                             l
                                          
                                       
                                       )
                                    
                                 
                                 exp
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                j
                                             
                                          
                                          ∗
                                          
                                             
                                                f
                                             
                                             
                                                j
                                             
                                          
                                          (
                                          TP
                                          ,
                                          
                                             
                                                cp
                                             
                                             
                                                l
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 Z
                                 (
                                 
                                    
                                       cp
                                    
                                    
                                       l
                                    
                                 
                                 )
                                 =
                                 exp
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                j
                                             
                                          
                                          ∗
                                          
                                             
                                                f
                                             
                                             
                                                j
                                             
                                          
                                          (
                                          TP
                                          ,
                                          
                                             
                                                cp
                                             
                                             
                                                l
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                k
                                             
                                          
                                          ∗
                                          
                                             
                                                f
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          ¬
                                          TP
                                          ,
                                          
                                             
                                                cp
                                             
                                             
                                                l
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                        where fj
                         is a feature function and wj
                         is its weight. A feature function indicates a specific condition between TP and cpl
                        ; and Z(cpl
                        ) is a smoothing factor that is used to normalize P(TP|cpl
                        ) within the range [0,1]. Given a training dataset, the weights of the feature functions can be derived by the conditional maximum likelihood estimation method. The learned weights are then used by Eq. (1) for the TLINK detection and TLINK type classification tasks. Usually, the syntactic information between two entities is important for constructing a TLINK in a sentence. We utilize the subsets of lexical features proposed in [3,5,7] for TLINK detection and TLINK type prediction. Table 2
                         shows some of the lexical features. In the table, we use the candidate TLINK pairs, p
                        1
                        =〈e
                        24,
                        t
                        7〉=〈“A peripheral intravenous line”,“Labor Day”〉, and p
                        2
                        =〈e
                        24,
                        e
                        221〉 shown in Fig. 5 as an example to explain the developed features.


                        Fig. 6
                         shows the proposed TLINK integration algorithm, which is designed to favor the TLINK tuples generated by the rule-based system over those of the machine learning-based system because cross validation indicates that the former system outperformed the latter on the training set. We discuss the performance of both systems in the next section. In the first loop, the algorithm checks the tuples generated by the machine learning-based system to determine whether the entity pair 〈el
                        ,
                        em
                        〉 in the tuple also exists in the tuple set RMRTS
                         generated by the rule-based system. If the pair is found in RMRTS
                        , but with a different TLINK type, the algorithm will accept the TLINK type determined by the machine learning-based method. The algorithm will only accept the rule-based system’s TLINK type when the system updates the TLINK type value after Stage 1 (see Section 2.1.1). We designed the algorithm in this way because the precision of Stages 2 and 3 in the rule-based system (see Sections 2.1.2 and 2.1.3) are better than those of the machine learning-based system (see Table 3
                         in the Results and Discussion section). In addition, if the entity pair is not involved in any tuples generated by the rule-based system, the tuple containing the pair will be accepted and added to the final tuple set.

In the second loop, the algorithm checks for the remaining tuple set of the rule-based system, which was not added to the final tuple set. From the perspective of the machine learning-based system, the tuples in the remaining tuple set should be filtered out by the TLINK detector. However, because we prefer to accept the results of the rule-based system, the algorithm only rejects the entity pair 〈el
                        ,
                        em
                        〉 whose TLINK detector score is less than the threshold τ. In this work, we set the value of τ at 0.3.

@&#RESULTS@&#

We used the training set released by the i2b2 TLINK track as our dataset to develop the rules used by the rule-based system (MRTS). For the machine learning-based system (METS), we performed threefold cross validation on the same dataset to select efficient features for TLINK detection and TLINK type classification in the sequential forward feature selection method [26]. We also performed threefold cross validation on the proposed stage-based system and the ME-based system to compare their performance. Then, we averaged the results of the three runs to obtain the global performance. Table 3 shows the performance of each stage of MRTS and METS using the official evaluation script provided by the i2b2 TLINK track. The evaluation metrics are the Precision, Recall, and F-measure.

The first three rows show the performance of the stages of MRTS. It is noteworthy that Stage 3 achieves the highest precision, which demonstrates the capability of the proposed clinical note section-based TLINK extraction method. The precision of METS is lower than that in MRTS-Stage 2 and Stage 3, but it is better than the score of MRTS-Stage 1. Accordingly, our TLINK integration algorithm only accepts the TLINK type determined by METS if its type remains the same after Stage 1 of MRTS (indicated by the third IF in Fig. 6). The results in the fourth row show that, the performance of METS was not significantly better than that of MRTS. This is probably due to the low inter-annotator agreement (kappa value: 0.3 reported by the organizers [27]) and the inability of syntactic features alone to discriminate between temporal relations. To achieve better results, supplementary context information and semantic features should also be considered.


                     Table 4
                      compares the results derived by different configurations on the training set. The first configuration only uses the rules defined in MRTS-Stage 1. Based on the results of MRTSstage1, the second configuration integrates the rules in MRTS-Stage 2 to modify the generated TLINK types. MRTSstage1+2+3 includes all the stages developed for MRTS. Finally, the MRTSstage1+2+3
                     +METS configuration uses the proposed TLINK integration algorithm to fuse all the TLINK tuples generated by MRTS and METS. In addition, as a baseline for the evaluation, we use a naive method (Baselinerandom), which randomly selects TLINK candidates from all pairs and assigns the TLINK types. Comparison of MRTSstage1 with MRTSstage1+2+3 shows that the proposed stages improve the overall performance of temporal relation extraction, and they clearly outperform the baseline method. Incorporating Stage 2 into MRTS improves the F-score by 9.84%. The full MRTS system achieves an F-score of 52.01% on the cross validation dataset. The final hybrid system, which uses the TLINK integration algorithm to incorporate the results of METS with MRTS, improves the F-score by 20.18%.

Finally, Table 5
                      shows the average scores of the three runs we submitted for the i2b2 TLINK test dataset. In line with our observation in the training set, the hybrid system (Run 3) achieves the best performance, which demonstrates that the proposed TLINK integration algorithm is robust. The TEMPTING system also outperforms the baseline, which applies a random method on the test dataset.

@&#DISCUSSION@&#

Compared to general relation extraction tasks, identifying temporal relations in discharge summaries requires temporal knowledge and inference. To assess the effectiveness of the proposed rules for different TLINK types, we preserve the TLINK type that we want to evaluate for each discharge summary, and select rules based on their target TLINK types for evaluating the individual TLINK type performance on the training and test sets. For instance, we remove TLINK types AFTER and OVERLAP from the dataset, and only use rules related to the BEFORE link (denoted as MRTSBEFORE) when we evaluate the BEFORE TLINK. The results show that the TEMPTING system achieves the best performance on the OVERLAP TLINKs, and the worst performance on the TLINK type AFTER. The reason that the AFTER TLINK is much harder than others is that the distribution of AFTER TLINKs in the i2b2 dataset is much less than that of the others, as shown in Fig. 7
                     . The phenomenon prevents us from devising useful rules and learning meaningful feature weights; hence the recognition task is more complicated.

Furthermore, after carefully examining the cases with incorrect AFTER TLINKs, we found that the developed rules based on the identified clinical note sections and their timeline information of MRTSAFTER are incapable of discriminating between EVENT entities. For instance, R.3.1 sets the occurrence time of all EVENT entities in the course of treatment note-section as “AFTER” the admission date due to the difficulty in identifying the clinical note sections, leading to the unsatisfactory performance by MRTSAFTER.

Our analysis of the test dataset shows that the TEMPTING system can achieve approximately 76.0% accuracy in identifying the TLINK between EVENT and TIMEX3 entities. Specifically, the accuracy are 90.5% for “BEFORE”, 71.4% for “OVERLAP”, and 66.7% for “AFTER”. However, the system’s performance in recognizing the TLINK between EVENT and SECTIME is poor with only 20% accuracy on average. In our system, the development of this type of TLINK is based solely on the clinical note section that the EVENT belongs to. Because the chronological relations between note-sections are not closely examined, some of the TLINKs are incorrect. In addition, through the intense discussion of the TLINK track of the i2b2 2012 challenge Google group, the cognition of existing TLINKs varied among the annotators and participants. Disagreements between the annotators caused some complications, especially when applying the machine learning approach. Similarly, determining the cases where two EVENTs/TIMEX3s should be linked with a TLINK is also a challenging task, and may result in lost or redundant TLINKs. Based on the above analysis, we should prioritize improving the performance of detecting TLINKs between EVENT and SECTIME in the future and improve the efficiency of TEMPTING in retrieving TLINKs.

In addition, our results show that MRTSBEFORE achieves a high precision, but a low recall. Our analysis of the experimental data shows that BEFORE links are usually constructed by an EVENT entity and a TIMEX3 entity; hence, the rule that sets the occurrence time of all EVENT entities in the clinical history note-section to “BEFORE” the admission date and the discharge date (see R.3.1, R.3.2, and R.3.3) yields a very high detection precision because the clinical history note-section is much easier to identify by using the proposed keywords (see Table 1). However, because our clinical note section identification method based on string matching has difficulty determining the corresponding note-sections, its recall is low.

For the machine learning-based system comprised of two subsystems, i.e., the TLINK detector and the TLINK type classifier, we conducted an additional experiment to verify the usability of the TLINK detector. The results are shown in Table 6
                     . The first configuration (denoted as METSone-stage) excludes the TLINK detector, but the second configuration adds it in MRTSstage1 (denoted as METS). In MRTSstage1+2+3 and MRTSstage1+2+3
                     +METS, based on the results of MRTSstage1 and MRTSstage1+2, we use the TLINK integration algorithm to fuse all TLINK tuples generated by the rule-based system.

By comparing different configurations, we find that adding the TLINK detector improves the precision at the expense of the recall. Although adding the TLINK detector yields the lowest F-score, it improves the precision and F-score when we use the fusion algorithm to combine the outputs of the rule-based and machine learning-based systems through the fusing algorithm, while it still maintained a satisfied recall. Based on the results, we conclude that the TLINK detection step must be executed before predicting TLINK types.

@&#RELATED WORK@&#

Regardless of the specific details of target temporal relations, most researchers have approached the problem in a rule-based manner or a pattern-based manner. Many existing temporal relation extraction systems link events directly to associated timestamps [9,21,16], This is a simple and practical approach, but it is used at the expense of the recall because many events do not have an associated timestamp. The principle behind rule-based methods is to design a number of rules for classifying the types of temporal relations as shown by our rule-based system. In most works, these manually defined rules are based on Allen’s interval algebra [1], which is a calculus developed for temporal reasoning. One usage of these rules is to enlarge the training set [14], and another is to ascertain the predicted temporal relations [21,25]. Pattern-based methods extract some generic lexical syntactic patterns for the co-occurrence of events. Extraction of such patterns can be performed manually or automatically. The major drawback of extracting patterns manually is that it tends to result in a high recall but a low precision, as shown by our results in Tables 3 and 4. Several heuristics that are similar to our hybrid method have been proposed to resolve the low precision problem [5,25].

Our maximum entropy-based system is an example of a machine learning-based approach that attempts to learn a classifier from an annotated corpus, and tries to improve the classification accuracy by feature engineering. Another example is Mani et al.’s ME classifier [14], which assigns each pair of events to one of the six relations in an augmented TimeBank corpus. The classifier relies on perfect features that were hand-tagged in the corpus, namely, the tense, aspect, modality, polarity and event class. Pairwise agreement on grammatical tenses and aspect were also included. Lapata and Lascarides [11], whose learner is based on syntax and clausal ordering features, trained an event classifier for inter-sentence events and built a corpus by saving sentences that contained two events, one of which is triggered by a key time word (e.g. after or before).

There was a large variation in the machine learning methods explored by the i2b2 TLINK track participants, ranging from maximum entropy, Bayesian, and support vector machine methods to conditional random field approaches. For example, Roberts et al. [20] proposed two supervised methods. The first uses conditional random fields to find relevant word sequences; and the second uses support vector machines to perform binary and multi-class classification. Their official results reported an overall temporal link detection F-score of 55.94%. Cherry et al. [6] proposed several features, such as syntactic, semantic, and structural features, and developed a temporal reasoning module to further infer the temporal relations between entities. Some participants also incorporated heuristics and rule-based components into their systems. For example, Tang et al. [24] used heuristics to select candidate entity pairs for assigning TLINKs. Nikfarjam et al. [15] also combined machine learning and a graph driven approach to extract TLINKs. The graph-based approach creates a temporal graph of a sentence based on parse tree dependencies of the simplified sentences, along with some additional frequent patterns. Some teams divided the tasks into more specific sub-tasks to improve the performance [10,28]. Other hybrid systems in the 2012 i2b2 TLINK track used simple rules to merge the TLINK results of multiple classifiers, e.g., by removing contradictory sentence-across TLINKS from the same sentences [24]. By contrast, we developed a fusion algorithm that integrates the results of two systems based on their performance on the dataset. The best configuration of our hybrid system achieved an F-score of 0.56, which ranked in the seventh place out of the top 10 teams.

Temporal information is crucial in electronic medical records and related clinical manuscripts. Hence, discovering the temporal relationships between entities in patient’s medical data may help medical personnel make clinical decisions, as well as facilitate data modeling and biomedical research. Most of the approaches used in the 2012 i2b2 TLINK track were hybrid methods that combined supervised, unsupervised, and rule-based methods to extract temporal relations. In this paper, we describe several rules and present an algorithm that integrates the results of rule-based and supervised learning systems. Our experiment results demonstrate the efficacy of the proposed approach. Nevertheless, we believe our system could be improved by incorporating of additional linguistic and domain knowledge. In the future, we will employ more sophisticated features to strengthen the system. We will also investigate advanced machine learning algorithms, such as Markov logic network [29], which can extract temporal relation tuples accurately. Our objective is to further enhance the performance of temporal representation and reasoning in medical natural language processing.

@&#ACKNOWLEDGMENTS@&#

This research was supported by Informatics for Integrating Biology and the Bedside (i2b2), award number 2U54LM008748 from the NIH/National Library of Medicine (NLM); by the National Heart, Lung and Blood Institute (NHLBI); and by award number1R13LM01141101 from the NIH NLM. The content is solely the responsibility of the authors and does not necessarily reflect the official views of the NLM, NHLBI, or the National Institutes of Health. The study was conducted under the “III Innovative and Prospective Technologies Project” of the Institute for Information Industry, which is subsidized by the Ministry of Economic Affairs of the Republic of China. Moreover, this research was also supported by the National Science Council of Taiwan under Grant NSC 101-2319-B-010-002, NSC 102-2319-B-010-002, and NSC-102-2218-E-038-001, the research Grant TMU101-AE1-B55 of Taipei Medical University.

@&#REFERENCES@&#

